[0m18:52:06.352389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72ccb9af0050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72ccbbe9b950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72ccb98385d0>]}


============================== 18:52:06.356077 | f5354b01-b7b3-4bc5-8cd9-fdf31314330e ==============================
[0m18:52:06.356077 [info ] [MainThread]: Running with dbt=1.6.18
[0m18:52:06.356369 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/workspaces/varengold_data_analyst_case/transformation', 'debug': 'False', 'warn_error': 'None', 'log_path': '/workspaces/varengold_data_analyst_case/transformation/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run-operation explore_schemas', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:52:06.420506 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f5354b01-b7b3-4bc5-8cd9-fdf31314330e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72ccb97a8610>]}
[0m18:52:06.428092 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f5354b01-b7b3-4bc5-8cd9-fdf31314330e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72ccb97c4890>]}
[0m18:52:06.428627 [info ] [MainThread]: Registered adapter: duckdb=1.6.2
[0m18:52:06.429087 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found 3 package(s) specified in packages.yml, but only 0 package(s) installed in dbt_packages. Run "dbt deps" to install package dependencies.
[0m18:52:06.429409 [debug] [MainThread]: Command `dbt run-operation` failed at 18:52:06.429327 after 0.08 seconds
[0m18:52:06.429618 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72ccb996f090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72ccb97d8c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72ccbdf4f490>]}
[0m18:52:06.429807 [debug] [MainThread]: Flushing usage events
[0m18:52:15.617398 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a6bc72b6ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a6bc7492d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a6bc8002510>]}


============================== 18:52:15.621063 | c663f173-4a3e-4d5f-89f6-cab108857431 ==============================
[0m18:52:15.621063 [info ] [MainThread]: Running with dbt=1.6.18
[0m18:52:15.621500 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/workspaces/varengold_data_analyst_case/transformation', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/workspaces/varengold_data_analyst_case/transformation/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt deps', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m18:52:15.642314 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c663f173-4a3e-4d5f-89f6-cab108857431', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a6bc75e7990>]}
[0m18:52:15.649640 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-71nztet0'
[0m18:52:15.650055 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m18:52:15.823766 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m18:52:15.824773 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/codegen.json
[0m18:52:15.959547 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/codegen.json 200
[0m18:52:15.962783 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m18:52:16.137204 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m18:52:16.143710 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/godatadriven/dbt_date.json
[0m18:52:16.295233 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/godatadriven/dbt_date.json 200
[0m18:52:16.303416 [info ] [MainThread]: Installing dbt-labs/codegen
[0m18:52:16.601431 [info ] [MainThread]: Installed from version 0.13.1
[0m18:52:16.601691 [info ] [MainThread]: Up to date!
[0m18:52:16.601888 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'c663f173-4a3e-4d5f-89f6-cab108857431', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a6bc75e4650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a6bc7608dd0>]}
[0m18:52:16.602090 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m18:52:16.983586 [info ] [MainThread]: Installed from version 1.3.0
[0m18:52:16.983891 [info ] [MainThread]: Up to date!
[0m18:52:16.984122 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'c663f173-4a3e-4d5f-89f6-cab108857431', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a6bc75e4650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a6bc7001ed0>]}
[0m18:52:16.984365 [info ] [MainThread]: Installing godatadriven/dbt_date
[0m18:52:17.709923 [info ] [MainThread]: Installed from version 0.11.0
[0m18:52:17.710384 [info ] [MainThread]: Updated version available: 0.14.1
[0m18:52:17.710679 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'c663f173-4a3e-4d5f-89f6-cab108857431', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a6bc72b4b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a6bc7677e10>]}
[0m18:52:17.710984 [info ] [MainThread]: 
[0m18:52:17.711217 [info ] [MainThread]: Updates available for packages: ['godatadriven/dbt_date']                 
Update your versions in packages.yml, then run dbt deps
[0m18:52:17.711844 [debug] [MainThread]: Command `dbt deps` succeeded at 18:52:17.711730 after 2.10 seconds
[0m18:52:17.712077 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a6bc72d4090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a6bc7675510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a6bc770bb10>]}
[0m18:52:17.712270 [debug] [MainThread]: Flushing usage events
[0m18:52:23.851101 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x765de2d0fc10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x765de2cb8ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x765de2d16650>]}


============================== 18:52:23.854154 | 2d606c17-1fe9-458d-9d84-4ef8f8b9e6ac ==============================
[0m18:52:23.854154 [info ] [MainThread]: Running with dbt=1.6.18
[0m18:52:23.854742 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/workspaces/varengold_data_analyst_case/transformation', 'log_path': '/workspaces/varengold_data_analyst_case/transformation/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run-operation explore_schemas', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:52:23.914068 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2d606c17-1fe9-458d-9d84-4ef8f8b9e6ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x765ddf30d190>]}
[0m18:52:23.922027 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2d606c17-1fe9-458d-9d84-4ef8f8b9e6ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x765de2e6eed0>]}
[0m18:52:23.922486 [info ] [MainThread]: Registered adapter: duckdb=1.6.2
[0m18:52:23.942658 [debug] [MainThread]: checksum: 7b9fab86a08e9e96a48a825af743c566d95b877e068b8c6d0dbafbf714447189, vars: {}, profile: , target: , version: 1.6.18
[0m18:52:23.943127 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m18:52:23.943349 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '2d606c17-1fe9-458d-9d84-4ef8f8b9e6ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x765de2fc7f10>]}
[0m18:52:24.850098 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.vg_casestudy.main
- models.vg_casestudy.reporting
- models.vg_casestudy.marts
[0m18:52:24.855354 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2d606c17-1fe9-458d-9d84-4ef8f8b9e6ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x765de2a32ed0>]}
[0m18:52:24.875330 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2d606c17-1fe9-458d-9d84-4ef8f8b9e6ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x765dd7a1fe50>]}
[0m18:52:24.875700 [info ] [MainThread]: Found 11 models, 1 analysis, 2 seeds, 71 tests, 5 sources, 0 exposures, 0 metrics, 632 macros, 0 groups, 0 semantic models
[0m18:52:24.875918 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2d606c17-1fe9-458d-9d84-4ef8f8b9e6ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x765de2cb8810>]}
[0m18:52:24.876386 [debug] [MainThread]: Acquiring new duckdb connection 'macro_explore_schemas'
[0m18:52:24.876573 [debug] [MainThread]: Using duckdb connection "macro_explore_schemas"
[0m18:52:24.876730 [debug] [MainThread]: On macro_explore_schemas: BEGIN
[0m18:52:24.876886 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:52:27.905884 [debug] [MainThread]: SQL status: OK in 3.0 seconds
[0m18:52:27.906214 [debug] [MainThread]: On macro_explore_schemas: COMMIT
[0m18:52:27.906396 [debug] [MainThread]: Using duckdb connection "macro_explore_schemas"
[0m18:52:27.906555 [debug] [MainThread]: On macro_explore_schemas: COMMIT
[0m18:52:27.906943 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m18:52:27.913046 [debug] [MainThread]: Using duckdb connection "macro_explore_schemas"
[0m18:52:27.913278 [debug] [MainThread]: On macro_explore_schemas: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "macro_explore_schemas"} */

    
        SELECT schema_name FROM information_schema.schemata
    
  
[0m18:52:27.914572 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m18:52:27.915410 [debug] [MainThread]: On macro_explore_schemas: Close
[0m18:52:27.917609 [debug] [MainThread]: Command `dbt run-operation` succeeded at 18:52:27.917532 after 4.07 seconds
[0m18:52:27.917792 [debug] [MainThread]: Connection 'macro_explore_schemas' was properly closed.
[0m18:52:27.917970 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x765de2e6cf50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x765de2c69ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x765ddf327250>]}
[0m18:52:27.918188 [debug] [MainThread]: Flushing usage events
[0m18:53:26.187163 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b1d5bb88650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b1d5b8b72d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b1d5bb989d0>]}


============================== 18:53:26.190083 | 26ed4d6c-702e-48e7-83cc-bce0d51bf469 ==============================
[0m18:53:26.190083 [info ] [MainThread]: Running with dbt=1.6.18
[0m18:53:26.190682 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/workspaces/varengold_data_analyst_case/transformation', 'debug': 'False', 'version_check': 'True', 'log_path': '/workspaces/varengold_data_analyst_case/transformation/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': "dbt run-operation explore_tables --args {'schema_name' : 'raw'}", 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:53:26.251440 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '26ed4d6c-702e-48e7-83cc-bce0d51bf469', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b1d5b5c5650>]}
[0m18:53:26.259247 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '26ed4d6c-702e-48e7-83cc-bce0d51bf469', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b1d5b59a010>]}
[0m18:53:26.259702 [info ] [MainThread]: Registered adapter: duckdb=1.6.2
[0m18:53:26.272305 [debug] [MainThread]: checksum: 7b9fab86a08e9e96a48a825af743c566d95b877e068b8c6d0dbafbf714447189, vars: {}, profile: , target: , version: 1.6.18
[0m18:53:26.294126 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:53:26.294421 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:53:26.295207 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.vg_casestudy.main
- models.vg_casestudy.reporting
- models.vg_casestudy.marts
[0m18:53:26.299437 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '26ed4d6c-702e-48e7-83cc-bce0d51bf469', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b1d5b8b4b90>]}
[0m18:53:26.314631 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '26ed4d6c-702e-48e7-83cc-bce0d51bf469', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b1d57ec7010>]}
[0m18:53:26.314988 [info ] [MainThread]: Found 11 models, 1 analysis, 2 seeds, 71 tests, 5 sources, 0 exposures, 0 metrics, 632 macros, 0 groups, 0 semantic models
[0m18:53:26.315185 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '26ed4d6c-702e-48e7-83cc-bce0d51bf469', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b1d5b5e5790>]}
[0m18:53:26.315632 [debug] [MainThread]: Acquiring new duckdb connection 'macro_explore_tables'
[0m18:53:26.315817 [debug] [MainThread]: Using duckdb connection "macro_explore_tables"
[0m18:53:26.315981 [debug] [MainThread]: On macro_explore_tables: BEGIN
[0m18:53:26.316119 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:53:26.325444 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m18:53:26.325742 [debug] [MainThread]: On macro_explore_tables: COMMIT
[0m18:53:26.325913 [debug] [MainThread]: Using duckdb connection "macro_explore_tables"
[0m18:53:26.326072 [debug] [MainThread]: On macro_explore_tables: COMMIT
[0m18:53:26.326410 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m18:53:26.332538 [debug] [MainThread]: Using duckdb connection "macro_explore_tables"
[0m18:53:26.332776 [debug] [MainThread]: On macro_explore_tables: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "macro_explore_tables"} */

    
        SELECT table_name 
        FROM information_schema.tables 
        WHERE table_schema = 'raw'
    
  
[0m18:53:26.339938 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m18:53:26.340801 [debug] [MainThread]: On macro_explore_tables: Close
[0m18:53:26.343896 [debug] [MainThread]: Command `dbt run-operation` succeeded at 18:53:26.343802 after 0.16 seconds
[0m18:53:26.344141 [debug] [MainThread]: Connection 'macro_explore_tables' was properly closed.
[0m18:53:26.344364 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b1d57ecd5d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b1d5bb67d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b1d5b8b6f90>]}
[0m18:53:26.344599 [debug] [MainThread]: Flushing usage events
[0m02:27:08.041012 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x717358bc7610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x717358bb6d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x717358d18210>]}


============================== 02:27:08.045130 | d4135266-a19c-465d-ae63-59b65a852018 ==============================
[0m02:27:08.045130 [info ] [MainThread]: Running with dbt=1.6.18
[0m02:27:08.045442 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/workspaces/varengold_data_analyst_case/transformation/logs', 'version_check': 'True', 'profiles_dir': '/workspaces/varengold_data_analyst_case/transformation', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt deps', 'send_anonymous_usage_stats': 'True'}
[0m02:27:08.067870 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd4135266-a19c-465d-ae63-59b65a852018', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71735875d890>]}
[0m02:27:08.068495 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-91g19c8v'
[0m02:27:08.068837 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m02:27:08.253751 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m02:27:08.254993 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/codegen.json
[0m02:27:08.406604 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/codegen.json 200
[0m02:27:08.409110 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m02:27:08.574758 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m02:27:08.578811 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/godatadriven/dbt_date.json
[0m02:27:08.739389 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/godatadriven/dbt_date.json 200
[0m02:27:08.749471 [info ] [MainThread]: Installing dbt-labs/codegen
[0m02:27:09.073166 [info ] [MainThread]: Installed from version 0.13.1
[0m02:27:09.073426 [info ] [MainThread]: Up to date!
[0m02:27:09.073617 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'd4135266-a19c-465d-ae63-59b65a852018', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x717358d09fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7173589ec950>]}
[0m02:27:09.073811 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m02:27:09.422227 [info ] [MainThread]: Installed from version 1.3.0
[0m02:27:09.422499 [info ] [MainThread]: Up to date!
[0m02:27:09.422702 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'd4135266-a19c-465d-ae63-59b65a852018', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7173589d8550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x717358d09fd0>]}
[0m02:27:09.422915 [info ] [MainThread]: Installing godatadriven/dbt_date
[0m02:27:09.805247 [info ] [MainThread]: Installed from version 0.11.0
[0m02:27:09.805530 [info ] [MainThread]: Updated version available: 0.14.1
[0m02:27:09.805745 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'd4135266-a19c-465d-ae63-59b65a852018', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71735873b190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x717358722c10>]}
[0m02:27:09.805963 [info ] [MainThread]: 
[0m02:27:09.806147 [info ] [MainThread]: Updates available for packages: ['godatadriven/dbt_date']                 
Update your versions in packages.yml, then run dbt deps
[0m02:27:09.806596 [debug] [MainThread]: Command `dbt deps` succeeded at 02:27:09.806503 after 1.77 seconds
[0m02:27:09.806815 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71735d278e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71735d304bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71735d305d90>]}
[0m02:27:09.807002 [debug] [MainThread]: Flushing usage events
[0m02:27:14.933237 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7185c65e2890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7185c65cc550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7185c6463310>]}


============================== 02:27:14.936286 | 0b0329fb-cf28-4293-b1b2-c45dbb3ba5b0 ==============================
[0m02:27:14.936286 [info ] [MainThread]: Running with dbt=1.6.18
[0m02:27:14.936685 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/workspaces/varengold_data_analyst_case/transformation', 'debug': 'False', 'version_check': 'True', 'log_path': '/workspaces/varengold_data_analyst_case/transformation/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m02:27:14.992584 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0b0329fb-cf28-4293-b1b2-c45dbb3ba5b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7185c62b24d0>]}
[0m02:27:15.000546 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0b0329fb-cf28-4293-b1b2-c45dbb3ba5b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7185c65dbd90>]}
[0m02:27:15.001089 [info ] [MainThread]: Registered adapter: duckdb=1.6.2
[0m02:27:15.014964 [debug] [MainThread]: checksum: 7b9fab86a08e9e96a48a825af743c566d95b877e068b8c6d0dbafbf714447189, vars: {}, profile: , target: , version: 1.6.18
[0m02:27:15.027368 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m02:27:15.027712 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '0b0329fb-cf28-4293-b1b2-c45dbb3ba5b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7185c2908310>]}
[0m02:27:15.936691 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.vg_casestudy.main
- models.vg_casestudy.reporting
- models.vg_casestudy.marts
[0m02:27:15.940370 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0b0329fb-cf28-4293-b1b2-c45dbb3ba5b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7185c1e31c50>]}
[0m02:27:15.953459 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0b0329fb-cf28-4293-b1b2-c45dbb3ba5b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7185bb1e7e90>]}
[0m02:27:15.953808 [info ] [MainThread]: Found 11 models, 1 analysis, 2 seeds, 71 tests, 5 sources, 0 exposures, 0 metrics, 632 macros, 0 groups, 0 semantic models
[0m02:27:15.954012 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0b0329fb-cf28-4293-b1b2-c45dbb3ba5b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7185bb1a8d90>]}
[0m02:27:15.955909 [info ] [MainThread]: 
[0m02:27:15.956381 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m02:27:15.958002 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_casestudy'
[0m02:27:15.968384 [debug] [ThreadPool]: Using duckdb connection "list_casestudy"
[0m02:27:15.968611 [debug] [ThreadPool]: On list_casestudy: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"casestudy"'
    
  
  
[0m02:27:15.968782 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:27:20.478374 [debug] [ThreadPool]: SQL status: OK in 5.0 seconds
[0m02:27:20.479364 [debug] [ThreadPool]: On list_casestudy: Close
[0m02:27:20.484855 [debug] [ThreadPool]: Using duckdb connection "list_casestudy"
[0m02:27:20.485150 [debug] [ThreadPool]: On list_casestudy: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"casestudy"'
    
  
  
[0m02:27:20.485322 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:27:20.492625 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m02:27:20.493344 [debug] [ThreadPool]: On list_casestudy: Close
[0m02:27:20.494779 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy, now create_casestudy_staging)
[0m02:27:20.495189 [debug] [ThreadPool]: Creating schema "database: "casestudy"
schema: "staging"
"
[0m02:27:20.497714 [debug] [ThreadPool]: Using duckdb connection "create_casestudy_staging"
[0m02:27:20.497908 [debug] [ThreadPool]: On create_casestudy_staging: BEGIN
[0m02:27:20.498062 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:27:20.504335 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m02:27:20.504527 [debug] [ThreadPool]: Using duckdb connection "create_casestudy_staging"
[0m02:27:20.504694 [debug] [ThreadPool]: On create_casestudy_staging: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "create_casestudy_staging"} */
create schema if not exists "casestudy"."staging"
[0m02:27:20.504959 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m02:27:20.505452 [debug] [ThreadPool]: On create_casestudy_staging: COMMIT
[0m02:27:20.505623 [debug] [ThreadPool]: Using duckdb connection "create_casestudy_staging"
[0m02:27:20.505780 [debug] [ThreadPool]: On create_casestudy_staging: COMMIT
[0m02:27:20.506017 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m02:27:20.506196 [debug] [ThreadPool]: On create_casestudy_staging: Close
[0m02:27:20.507663 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_casestudy_staging, now create_casestudy_intermediate)
[0m02:27:20.508040 [debug] [ThreadPool]: Creating schema "database: "casestudy"
schema: "intermediate"
"
[0m02:27:20.509184 [debug] [ThreadPool]: Using duckdb connection "create_casestudy_intermediate"
[0m02:27:20.509418 [debug] [ThreadPool]: On create_casestudy_intermediate: BEGIN
[0m02:27:20.509571 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:27:20.515771 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m02:27:20.515962 [debug] [ThreadPool]: Using duckdb connection "create_casestudy_intermediate"
[0m02:27:20.516133 [debug] [ThreadPool]: On create_casestudy_intermediate: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "create_casestudy_intermediate"} */
create schema if not exists "casestudy"."intermediate"
[0m02:27:20.516412 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m02:27:20.516859 [debug] [ThreadPool]: On create_casestudy_intermediate: COMMIT
[0m02:27:20.517032 [debug] [ThreadPool]: Using duckdb connection "create_casestudy_intermediate"
[0m02:27:20.517195 [debug] [ThreadPool]: On create_casestudy_intermediate: COMMIT
[0m02:27:20.517438 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m02:27:20.517607 [debug] [ThreadPool]: On create_casestudy_intermediate: Close
[0m02:27:20.519969 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_casestudy_intermediate, now list_casestudy_staging)
[0m02:27:20.525942 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_staging"
[0m02:27:20.526303 [debug] [ThreadPool]: On list_casestudy_staging: BEGIN
[0m02:27:20.526583 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:27:20.536110 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m02:27:20.536311 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_staging"
[0m02:27:20.536484 [debug] [ThreadPool]: On list_casestudy_staging: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_staging"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'staging'
    and table_catalog = 'casestudy'
  
[0m02:27:20.543182 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m02:27:20.543980 [debug] [ThreadPool]: On list_casestudy_staging: ROLLBACK
[0m02:27:20.544472 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_staging'
[0m02:27:20.544646 [debug] [ThreadPool]: On list_casestudy_staging: Close
[0m02:27:20.546059 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy_staging, now list_casestudy_intermediate)
[0m02:27:20.547712 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_intermediate"
[0m02:27:20.547893 [debug] [ThreadPool]: On list_casestudy_intermediate: BEGIN
[0m02:27:20.548046 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:27:20.554311 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m02:27:20.554503 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_intermediate"
[0m02:27:20.554678 [debug] [ThreadPool]: On list_casestudy_intermediate: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_intermediate"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'intermediate'
    and table_catalog = 'casestudy'
  
[0m02:27:20.561570 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m02:27:20.562480 [debug] [ThreadPool]: On list_casestudy_intermediate: ROLLBACK
[0m02:27:20.562776 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_intermediate'
[0m02:27:20.562941 [debug] [ThreadPool]: On list_casestudy_intermediate: Close
[0m02:27:20.564562 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy_intermediate, now list_casestudy_raw)
[0m02:27:20.566812 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_raw"
[0m02:27:20.566987 [debug] [ThreadPool]: On list_casestudy_raw: BEGIN
[0m02:27:20.567132 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:27:20.573717 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m02:27:20.573900 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_raw"
[0m02:27:20.574054 [debug] [ThreadPool]: On list_casestudy_raw: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_raw"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'raw'
    and table_catalog = 'casestudy'
  
[0m02:27:20.580469 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m02:27:20.581176 [debug] [ThreadPool]: On list_casestudy_raw: ROLLBACK
[0m02:27:20.581442 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_raw'
[0m02:27:20.581595 [debug] [ThreadPool]: On list_casestudy_raw: Close
[0m02:27:20.583969 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0b0329fb-cf28-4293-b1b2-c45dbb3ba5b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7185c1dab0d0>]}
[0m02:27:20.584531 [debug] [MainThread]: Using duckdb connection "master"
[0m02:27:20.584884 [debug] [MainThread]: On master: BEGIN
[0m02:27:20.585221 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:27:20.592872 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m02:27:20.593063 [debug] [MainThread]: On master: COMMIT
[0m02:27:20.593233 [debug] [MainThread]: Using duckdb connection "master"
[0m02:27:20.593380 [debug] [MainThread]: On master: COMMIT
[0m02:27:20.593621 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m02:27:20.593787 [debug] [MainThread]: On master: Close
[0m02:27:20.595034 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:27:20.595253 [info ] [MainThread]: 
[0m02:27:20.606495 [debug] [Thread-1 (]: Began running node model.vg_casestudy.stg_raw_staging__accounts
[0m02:27:20.607257 [info ] [Thread-1 (]: 1 of 11 START sql view model staging.stg_raw_staging__accounts ................. [RUN]
[0m02:27:20.608139 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.vg_casestudy.stg_raw_staging__accounts'
[0m02:27:20.608437 [debug] [Thread-1 (]: Began compiling node model.vg_casestudy.stg_raw_staging__accounts
[0m02:27:20.613678 [debug] [Thread-1 (]: Writing injected SQL for node "model.vg_casestudy.stg_raw_staging__accounts"
[0m02:27:20.614257 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.stg_raw_staging__accounts (compile): 02:27:20.608578 => 02:27:20.614090
[0m02:27:20.614487 [debug] [Thread-1 (]: Began executing node model.vg_casestudy.stg_raw_staging__accounts
[0m02:27:20.633739 [debug] [Thread-1 (]: Writing runtime sql for node "model.vg_casestudy.stg_raw_staging__accounts"
[0m02:27:20.634264 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_raw_staging__accounts"
[0m02:27:20.634463 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__accounts: BEGIN
[0m02:27:20.634638 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m02:27:20.644326 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:27:20.644577 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_raw_staging__accounts"
[0m02:27:20.644813 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__accounts: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_raw_staging__accounts"} */

  
  create view "casestudy"."staging"."stg_raw_staging__accounts__dbt_tmp" as (
    with source as (
    select * from "casestudy"."raw"."accounts"
),

renamed as (
    select
        account_id,
        customer_id,
        account_type,
        
CASE
    -- First try DD.MM.YYYY format (German format with dots)
    WHEN REGEXP_MATCHES(account_opening_date, '^\d{1,2}\.\d{1,2}\.\d{4}$') 
        THEN TRY_CAST(STRPTIME(account_opening_date, '%d.%m.%Y') AS DATE)
        
    -- Then try DD/MM/YYYY format (with slashes)
    WHEN REGEXP_MATCHES(account_opening_date, '^\d{1,2}/\d{1,2}/\d{4}$')
        AND CAST(SPLIT_PART(account_opening_date, '/', 1) AS INTEGER) <= 31 
        AND CAST(SPLIT_PART(account_opening_date, '/', 2) AS INTEGER) <= 12 
        THEN TRY_CAST(STRPTIME(account_opening_date, '%d/%m/%Y') AS DATE)
        
    -- Try MM/DD/YYYY format (US format with slashes)
    WHEN REGEXP_MATCHES(account_opening_date, '^\d{1,2}/\d{1,2}/\d{4}$')
        AND CAST(SPLIT_PART(account_opening_date, '/', 1) AS INTEGER) <= 12 
        THEN TRY_CAST(STRPTIME(account_opening_date, '%m/%d/%Y') AS DATE)
        
    -- Try YYYY-MM-DD format (ISO format)
    WHEN REGEXP_MATCHES(account_opening_date, '^\d{4}-\d{1,2}-\d{1,2}$')
        THEN TRY_CAST(STRPTIME(account_opening_date, '%Y-%m-%d') AS DATE)
        
    -- Try generic date parsing as last resort
    ELSE TRY_CAST(account_opening_date AS DATE)
END
 as account_opening_date,
        account_opening_date as account_opening_date_raw
    from source
    where account_type is not null and account_type != '' and account_type != '-'
),

final as (
    select
        account_id,
        customer_id,
        account_type,
        account_opening_date,
        -- Flag records with date parsing issues
        CASE WHEN account_opening_date IS NULL AND account_opening_date_raw IS NOT NULL
             THEN TRUE ELSE FALSE 
        END as has_date_parsing_error
    from renamed
)

select * from final
  );

[0m02:27:20.645843 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:27:20.649463 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_raw_staging__accounts"
[0m02:27:20.649687 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__accounts: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_raw_staging__accounts"} */
alter view "casestudy"."staging"."stg_raw_staging__accounts" rename to "stg_raw_staging__accounts__dbt_backup"
[0m02:27:20.650052 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:27:20.651552 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_raw_staging__accounts"
[0m02:27:20.651767 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__accounts: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_raw_staging__accounts"} */
alter view "casestudy"."staging"."stg_raw_staging__accounts__dbt_tmp" rename to "stg_raw_staging__accounts"
[0m02:27:20.652102 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:27:20.661033 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__accounts: COMMIT
[0m02:27:20.661248 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_raw_staging__accounts"
[0m02:27:20.661425 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__accounts: COMMIT
[0m02:27:20.662742 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:27:20.665360 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_raw_staging__accounts"
[0m02:27:20.665560 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__accounts: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_raw_staging__accounts"} */
drop view if exists "casestudy"."staging"."stg_raw_staging__accounts__dbt_backup" cascade
[0m02:27:20.666418 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:27:20.667190 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.stg_raw_staging__accounts (execute): 02:27:20.614622 => 02:27:20.667053
[0m02:27:20.667415 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__accounts: Close
[0m02:27:20.678400 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b0329fb-cf28-4293-b1b2-c45dbb3ba5b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7185c1d85dd0>]}
[0m02:27:20.679048 [info ] [Thread-1 (]: 1 of 11 OK created sql view model staging.stg_raw_staging__accounts ............ [[32mOK[0m in 0.07s]
[0m02:27:20.679494 [debug] [Thread-1 (]: Finished running node model.vg_casestudy.stg_raw_staging__accounts
[0m02:27:20.679798 [debug] [Thread-1 (]: Began running node model.vg_casestudy.stg_raw_staging__customers
[0m02:27:20.680340 [info ] [Thread-1 (]: 2 of 11 START sql view model staging.stg_raw_staging__customers ................ [RUN]
[0m02:27:20.680793 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.vg_casestudy.stg_raw_staging__accounts, now model.vg_casestudy.stg_raw_staging__customers)
[0m02:27:20.680989 [debug] [Thread-1 (]: Began compiling node model.vg_casestudy.stg_raw_staging__customers
[0m02:27:20.682745 [debug] [Thread-1 (]: Writing injected SQL for node "model.vg_casestudy.stg_raw_staging__customers"
[0m02:27:20.683088 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.stg_raw_staging__customers (compile): 02:27:20.681111 => 02:27:20.682978
[0m02:27:20.683285 [debug] [Thread-1 (]: Began executing node model.vg_casestudy.stg_raw_staging__customers
[0m02:27:20.685541 [debug] [Thread-1 (]: Writing runtime sql for node "model.vg_casestudy.stg_raw_staging__customers"
[0m02:27:20.685877 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_raw_staging__customers"
[0m02:27:20.686066 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__customers: BEGIN
[0m02:27:20.686241 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:27:20.695978 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:27:20.696258 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_raw_staging__customers"
[0m02:27:20.696459 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__customers: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_raw_staging__customers"} */

  
  create view "casestudy"."staging"."stg_raw_staging__customers__dbt_tmp" as (
    with source as (
    select * from "casestudy"."raw"."customers"
),

renamed as (
    select distinct
        customer_id,
        trim(firstname) as firstname,
        trim(lastname) as lastname,
        Age as age,
        branch_id
    from source
)

select * from renamed
  );

[0m02:27:20.697030 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:27:20.699086 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_raw_staging__customers"
[0m02:27:20.699333 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__customers: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_raw_staging__customers"} */
alter view "casestudy"."staging"."stg_raw_staging__customers" rename to "stg_raw_staging__customers__dbt_backup"
[0m02:27:20.699727 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:27:20.701548 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_raw_staging__customers"
[0m02:27:20.701767 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__customers: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_raw_staging__customers"} */
alter view "casestudy"."staging"."stg_raw_staging__customers__dbt_tmp" rename to "stg_raw_staging__customers"
[0m02:27:20.702128 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:27:20.703101 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__customers: COMMIT
[0m02:27:20.703321 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_raw_staging__customers"
[0m02:27:20.703499 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__customers: COMMIT
[0m02:27:20.705706 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:27:20.708295 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_raw_staging__customers"
[0m02:27:20.708525 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__customers: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_raw_staging__customers"} */
drop view if exists "casestudy"."staging"."stg_raw_staging__customers__dbt_backup" cascade
[0m02:27:20.709537 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:27:20.710464 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.stg_raw_staging__customers (execute): 02:27:20.683411 => 02:27:20.710360
[0m02:27:20.710675 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__customers: Close
[0m02:27:20.723084 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b0329fb-cf28-4293-b1b2-c45dbb3ba5b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7185baf2b8d0>]}
[0m02:27:20.723841 [info ] [Thread-1 (]: 2 of 11 OK created sql view model staging.stg_raw_staging__customers ........... [[32mOK[0m in 0.04s]
[0m02:27:20.724541 [debug] [Thread-1 (]: Finished running node model.vg_casestudy.stg_raw_staging__customers
[0m02:27:20.725031 [debug] [Thread-1 (]: Began running node model.vg_casestudy.stg_raw_staging__fx_rates
[0m02:27:20.725777 [info ] [Thread-1 (]: 3 of 11 START sql view model staging.stg_raw_staging__fx_rates ................. [RUN]
[0m02:27:20.726634 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.vg_casestudy.stg_raw_staging__customers, now model.vg_casestudy.stg_raw_staging__fx_rates)
[0m02:27:20.726833 [debug] [Thread-1 (]: Began compiling node model.vg_casestudy.stg_raw_staging__fx_rates
[0m02:27:20.728962 [debug] [Thread-1 (]: Writing injected SQL for node "model.vg_casestudy.stg_raw_staging__fx_rates"
[0m02:27:20.729325 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.stg_raw_staging__fx_rates (compile): 02:27:20.726953 => 02:27:20.729210
[0m02:27:20.729512 [debug] [Thread-1 (]: Began executing node model.vg_casestudy.stg_raw_staging__fx_rates
[0m02:27:20.731701 [debug] [Thread-1 (]: Writing runtime sql for node "model.vg_casestudy.stg_raw_staging__fx_rates"
[0m02:27:20.732009 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_raw_staging__fx_rates"
[0m02:27:20.732212 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__fx_rates: BEGIN
[0m02:27:20.732384 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:27:20.739788 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:27:20.740079 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_raw_staging__fx_rates"
[0m02:27:20.740348 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__fx_rates: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_raw_staging__fx_rates"} */

  
  create view "casestudy"."staging"."stg_raw_staging__fx_rates__dbt_tmp" as (
    with source as (
    select * from "casestudy"."raw"."fx_rates"
),

renamed as (
    select
        trim(currency_iso_code) as currency_iso_code,
        
CASE
    WHEN fx_rate IS NULL THEN NULL
    -- If the value is already a valid number
    WHEN TRY_CAST(fx_rate AS DOUBLE) IS NOT NULL 
        THEN TRY_CAST(fx_rate AS DOUBLE)
    -- If contains both dot and comma (German notation)
    WHEN POSITION('.' IN fx_rate) > 0 AND POSITION(',' IN fx_rate) > 0 
        THEN TRY_CAST(REPLACE(REPLACE(TRIM(fx_rate), '.', ''), ',', '.') AS DOUBLE)
    -- If only contains comma, treat as decimal point
    WHEN POSITION(',' IN fx_rate) > 0 
        THEN TRY_CAST(REPLACE(TRIM(fx_rate), ',', '.') AS DOUBLE)
    -- If only contains dots, likely thousands separator
    WHEN POSITION('.' IN fx_rate) > 0 
        THEN TRY_CAST(REPLACE(TRIM(fx_rate), '.', '') AS DOUBLE)
    ELSE NULL
END
 as fx_rate,
        
CASE
    -- First try DD.MM.YYYY format (German format with dots)
    WHEN REGEXP_MATCHES(date, '^\d{1,2}\.\d{1,2}\.\d{4}$') 
        THEN TRY_CAST(STRPTIME(date, '%d.%m.%Y') AS DATE)
        
    -- Then try DD/MM/YYYY format (with slashes)
    WHEN REGEXP_MATCHES(date, '^\d{1,2}/\d{1,2}/\d{4}$')
        AND CAST(SPLIT_PART(date, '/', 1) AS INTEGER) <= 31 
        AND CAST(SPLIT_PART(date, '/', 2) AS INTEGER) <= 12 
        THEN TRY_CAST(STRPTIME(date, '%d/%m/%Y') AS DATE)
        
    -- Try MM/DD/YYYY format (US format with slashes)
    WHEN REGEXP_MATCHES(date, '^\d{1,2}/\d{1,2}/\d{4}$')
        AND CAST(SPLIT_PART(date, '/', 1) AS INTEGER) <= 12 
        THEN TRY_CAST(STRPTIME(date, '%m/%d/%Y') AS DATE)
        
    -- Try YYYY-MM-DD format (ISO format)
    WHEN REGEXP_MATCHES(date, '^\d{4}-\d{1,2}-\d{1,2}$')
        THEN TRY_CAST(STRPTIME(date, '%Y-%m-%d') AS DATE)
        
    -- Try generic date parsing as last resort
    ELSE TRY_CAST(date AS DATE)
END
 as fx_rate_date,
        date as fx_rate_date_raw
    from source
    where currency_iso_code is not null and trim(currency_iso_code) not in  ('(none)', '')
),

final as (
    select
        currency_iso_code,
        fx_rate,
        fx_rate_date,
        -- Flag records with date parsing issues
        CASE WHEN fx_rate_date IS NULL AND fx_rate_date_raw IS NOT NULL
             THEN TRUE ELSE FALSE 
        END as has_date_parsing_error
    from renamed
)

select * from final
  );

[0m02:27:20.741543 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:27:20.744164 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_raw_staging__fx_rates"
[0m02:27:20.744382 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__fx_rates: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_raw_staging__fx_rates"} */
alter view "casestudy"."staging"."stg_raw_staging__fx_rates" rename to "stg_raw_staging__fx_rates__dbt_backup"
[0m02:27:20.744768 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:27:20.746405 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_raw_staging__fx_rates"
[0m02:27:20.746615 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__fx_rates: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_raw_staging__fx_rates"} */
alter view "casestudy"."staging"."stg_raw_staging__fx_rates__dbt_tmp" rename to "stg_raw_staging__fx_rates"
[0m02:27:20.746968 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:27:20.747882 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__fx_rates: COMMIT
[0m02:27:20.748086 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_raw_staging__fx_rates"
[0m02:27:20.748270 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__fx_rates: COMMIT
[0m02:27:20.749617 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:27:20.751021 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_raw_staging__fx_rates"
[0m02:27:20.751234 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__fx_rates: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_raw_staging__fx_rates"} */
drop view if exists "casestudy"."staging"."stg_raw_staging__fx_rates__dbt_backup" cascade
[0m02:27:20.752255 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:27:20.753026 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.stg_raw_staging__fx_rates (execute): 02:27:20.729638 => 02:27:20.752919
[0m02:27:20.753239 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__fx_rates: Close
[0m02:27:20.764105 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b0329fb-cf28-4293-b1b2-c45dbb3ba5b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7185bb192150>]}
[0m02:27:20.764472 [info ] [Thread-1 (]: 3 of 11 OK created sql view model staging.stg_raw_staging__fx_rates ............ [[32mOK[0m in 0.04s]
[0m02:27:20.764765 [debug] [Thread-1 (]: Finished running node model.vg_casestudy.stg_raw_staging__fx_rates
[0m02:27:20.764985 [debug] [Thread-1 (]: Began running node model.vg_casestudy.stg_raw_staging__loans
[0m02:27:20.765209 [info ] [Thread-1 (]: 4 of 11 START sql view model staging.stg_raw_staging__loans .................... [RUN]
[0m02:27:20.765723 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.vg_casestudy.stg_raw_staging__fx_rates, now model.vg_casestudy.stg_raw_staging__loans)
[0m02:27:20.765917 [debug] [Thread-1 (]: Began compiling node model.vg_casestudy.stg_raw_staging__loans
[0m02:27:20.767956 [debug] [Thread-1 (]: Writing injected SQL for node "model.vg_casestudy.stg_raw_staging__loans"
[0m02:27:20.768304 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.stg_raw_staging__loans (compile): 02:27:20.766028 => 02:27:20.768191
[0m02:27:20.768518 [debug] [Thread-1 (]: Began executing node model.vg_casestudy.stg_raw_staging__loans
[0m02:27:20.770721 [debug] [Thread-1 (]: Writing runtime sql for node "model.vg_casestudy.stg_raw_staging__loans"
[0m02:27:20.771009 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_raw_staging__loans"
[0m02:27:20.771196 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__loans: BEGIN
[0m02:27:20.771360 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:27:20.780935 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:27:20.781251 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_raw_staging__loans"
[0m02:27:20.781545 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__loans: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_raw_staging__loans"} */

  
  create view "casestudy"."staging"."stg_raw_staging__loans__dbt_tmp" as (
    with source as (
    select * from "casestudy"."raw"."loans"
),

renamed as (
    select
        customer_id,
        loan_id,
        
CASE
    WHEN loan_amount IS NULL THEN NULL
    -- If the value is already a valid number
    WHEN TRY_CAST(loan_amount AS DOUBLE) IS NOT NULL 
        THEN TRY_CAST(loan_amount AS DOUBLE)
    -- If contains both dot and comma (German notation)
    WHEN POSITION('.' IN loan_amount) > 0 AND POSITION(',' IN loan_amount) > 0 
        THEN TRY_CAST(REPLACE(REPLACE(TRIM(loan_amount), '.', ''), ',', '.') AS DOUBLE)
    -- If only contains comma, treat as decimal point
    WHEN POSITION(',' IN loan_amount) > 0 
        THEN TRY_CAST(REPLACE(TRIM(loan_amount), ',', '.') AS DOUBLE)
    -- If only contains dots, likely thousands separator
    WHEN POSITION('.' IN loan_amount) > 0 
        THEN TRY_CAST(REPLACE(TRIM(loan_amount), '.', '') AS DOUBLE)
    ELSE NULL
END
 as loan_amount,
        loant_type,
        
CASE
    WHEN interest_rate IS NULL THEN NULL
    -- If the value is already a valid number
    WHEN TRY_CAST(interest_rate AS DOUBLE) IS NOT NULL 
        THEN TRY_CAST(interest_rate AS DOUBLE)
    -- If contains both dot and comma (German notation)
    WHEN POSITION('.' IN interest_rate) > 0 AND POSITION(',' IN interest_rate) > 0 
        THEN TRY_CAST(REPLACE(REPLACE(TRIM(interest_rate), '.', ''), ',', '.') AS DOUBLE)
    -- If only contains comma, treat as decimal point
    WHEN POSITION(',' IN interest_rate) > 0 
        THEN TRY_CAST(REPLACE(TRIM(interest_rate), ',', '.') AS DOUBLE)
    -- If only contains dots, likely thousands separator
    WHEN POSITION('.' IN interest_rate) > 0 
        THEN TRY_CAST(REPLACE(TRIM(interest_rate), '.', '') AS DOUBLE)
    ELSE NULL
END
 as interest_rate,
        loan_term,
        
CASE
    -- First try DD.MM.YYYY format (German format with dots)
    WHEN REGEXP_MATCHES(approval_rejection_date, '^\d{1,2}\.\d{1,2}\.\d{4}$') 
        THEN TRY_CAST(STRPTIME(approval_rejection_date, '%d.%m.%Y') AS DATE)
        
    -- Then try DD/MM/YYYY format (with slashes)
    WHEN REGEXP_MATCHES(approval_rejection_date, '^\d{1,2}/\d{1,2}/\d{4}$')
        AND CAST(SPLIT_PART(approval_rejection_date, '/', 1) AS INTEGER) <= 31 
        AND CAST(SPLIT_PART(approval_rejection_date, '/', 2) AS INTEGER) <= 12 
        THEN TRY_CAST(STRPTIME(approval_rejection_date, '%d/%m/%Y') AS DATE)
        
    -- Try MM/DD/YYYY format (US format with slashes)
    WHEN REGEXP_MATCHES(approval_rejection_date, '^\d{1,2}/\d{1,2}/\d{4}$')
        AND CAST(SPLIT_PART(approval_rejection_date, '/', 1) AS INTEGER) <= 12 
        THEN TRY_CAST(STRPTIME(approval_rejection_date, '%m/%d/%Y') AS DATE)
        
    -- Try YYYY-MM-DD format (ISO format)
    WHEN REGEXP_MATCHES(approval_rejection_date, '^\d{4}-\d{1,2}-\d{1,2}$')
        THEN TRY_CAST(STRPTIME(approval_rejection_date, '%Y-%m-%d') AS DATE)
        
    -- Try generic date parsing as last resort
    ELSE TRY_CAST(approval_rejection_date AS DATE)
END
 as approval_rejection_date,
        approval_rejection_date as approval_rejection_date_raw,
        loan_status
    from source
),

final as (
    select
        customer_id,
        loan_id,
        loan_amount,
        loant_type as loan_type,
        interest_rate,
        loan_term,
        approval_rejection_date,
        loan_status,
        -- Flag records with date parsing issues
        CASE WHEN approval_rejection_date IS NULL AND approval_rejection_date_raw IS NOT NULL
             THEN TRUE ELSE FALSE 
        END as has_date_parsing_error
    from renamed
)

select * from final
  );

[0m02:27:20.783080 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:27:20.786451 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_raw_staging__loans"
[0m02:27:20.786709 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__loans: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_raw_staging__loans"} */
alter view "casestudy"."staging"."stg_raw_staging__loans" rename to "stg_raw_staging__loans__dbt_backup"
[0m02:27:20.787195 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:27:20.789993 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_raw_staging__loans"
[0m02:27:20.790226 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__loans: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_raw_staging__loans"} */
alter view "casestudy"."staging"."stg_raw_staging__loans__dbt_tmp" rename to "stg_raw_staging__loans"
[0m02:27:20.790603 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:27:20.791525 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__loans: COMMIT
[0m02:27:20.791730 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_raw_staging__loans"
[0m02:27:20.791910 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__loans: COMMIT
[0m02:27:20.793313 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:27:20.794571 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_raw_staging__loans"
[0m02:27:20.794780 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__loans: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_raw_staging__loans"} */
drop view if exists "casestudy"."staging"."stg_raw_staging__loans__dbt_backup" cascade
[0m02:27:20.795656 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:27:20.796382 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.stg_raw_staging__loans (execute): 02:27:20.768682 => 02:27:20.796284
[0m02:27:20.796575 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__loans: Close
[0m02:27:20.807139 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b0329fb-cf28-4293-b1b2-c45dbb3ba5b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7185baf51b10>]}
[0m02:27:20.807486 [info ] [Thread-1 (]: 4 of 11 OK created sql view model staging.stg_raw_staging__loans ............... [[32mOK[0m in 0.04s]
[0m02:27:20.807777 [debug] [Thread-1 (]: Finished running node model.vg_casestudy.stg_raw_staging__loans
[0m02:27:20.807985 [debug] [Thread-1 (]: Began running node model.vg_casestudy.stg_raw_staging__transactions
[0m02:27:20.808206 [info ] [Thread-1 (]: 5 of 11 START sql view model staging.stg_raw_staging__transactions ............. [RUN]
[0m02:27:20.808632 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.vg_casestudy.stg_raw_staging__loans, now model.vg_casestudy.stg_raw_staging__transactions)
[0m02:27:20.808899 [debug] [Thread-1 (]: Began compiling node model.vg_casestudy.stg_raw_staging__transactions
[0m02:27:20.810856 [debug] [Thread-1 (]: Writing injected SQL for node "model.vg_casestudy.stg_raw_staging__transactions"
[0m02:27:20.811180 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.stg_raw_staging__transactions (compile): 02:27:20.809020 => 02:27:20.811070
[0m02:27:20.811360 [debug] [Thread-1 (]: Began executing node model.vg_casestudy.stg_raw_staging__transactions
[0m02:27:20.813395 [debug] [Thread-1 (]: Writing runtime sql for node "model.vg_casestudy.stg_raw_staging__transactions"
[0m02:27:20.813669 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_raw_staging__transactions"
[0m02:27:20.813851 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__transactions: BEGIN
[0m02:27:20.814015 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:27:20.825772 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:27:20.826070 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_raw_staging__transactions"
[0m02:27:20.826318 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__transactions: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_raw_staging__transactions"} */

  
  create view "casestudy"."staging"."stg_raw_staging__transactions__dbt_tmp" as (
    with source as (
    select * from "casestudy"."raw"."transactions"
),

renamed as (
    select
        transaction_id,
        
CASE
    -- First try DD.MM.YYYY format (German format with dots)
    WHEN REGEXP_MATCHES(transaction_date, '^\d{1,2}\.\d{1,2}\.\d{4}$') 
        THEN TRY_CAST(STRPTIME(transaction_date, '%d.%m.%Y') AS DATE)
        
    -- Then try DD/MM/YYYY format (with slashes)
    WHEN REGEXP_MATCHES(transaction_date, '^\d{1,2}/\d{1,2}/\d{4}$')
        AND CAST(SPLIT_PART(transaction_date, '/', 1) AS INTEGER) <= 31 
        AND CAST(SPLIT_PART(transaction_date, '/', 2) AS INTEGER) <= 12 
        THEN TRY_CAST(STRPTIME(transaction_date, '%d/%m/%Y') AS DATE)
        
    -- Try MM/DD/YYYY format (US format with slashes)
    WHEN REGEXP_MATCHES(transaction_date, '^\d{1,2}/\d{1,2}/\d{4}$')
        AND CAST(SPLIT_PART(transaction_date, '/', 1) AS INTEGER) <= 12 
        THEN TRY_CAST(STRPTIME(transaction_date, '%m/%d/%Y') AS DATE)
        
    -- Try YYYY-MM-DD format (ISO format)
    WHEN REGEXP_MATCHES(transaction_date, '^\d{4}-\d{1,2}-\d{1,2}$')
        THEN TRY_CAST(STRPTIME(transaction_date, '%Y-%m-%d') AS DATE)
        
    -- Try generic date parsing as last resort
    ELSE TRY_CAST(transaction_date AS DATE)
END
 as transaction_date,
        transaction_date as transaction_date_raw,
        account_id,
        trim(transaction_type) as transaction_type,
        
CASE
    WHEN transaction_amount IS NULL THEN NULL
    -- If the value is already a valid number
    WHEN TRY_CAST(transaction_amount AS DOUBLE) IS NOT NULL 
        THEN TRY_CAST(transaction_amount AS DOUBLE)
    -- If contains both dot and comma (German notation)
    WHEN POSITION('.' IN transaction_amount) > 0 AND POSITION(',' IN transaction_amount) > 0 
        THEN TRY_CAST(REPLACE(REPLACE(TRIM(transaction_amount), '.', ''), ',', '.') AS DOUBLE)
    -- If only contains comma, treat as decimal point
    WHEN POSITION(',' IN transaction_amount) > 0 
        THEN TRY_CAST(REPLACE(TRIM(transaction_amount), ',', '.') AS DOUBLE)
    -- If only contains dots, likely thousands separator
    WHEN POSITION('.' IN transaction_amount) > 0 
        THEN TRY_CAST(REPLACE(TRIM(transaction_amount), '.', '') AS DOUBLE)
    ELSE NULL
END
 as transaction_amount,
        trim(transaction_currency) as transaction_currency
    from source
),

final as (
    select
        transaction_id,
        transaction_date,
        account_id,
        transaction_type,
        transaction_amount,
        transaction_currency,
        -- Flag records with date parsing issues
        CASE WHEN transaction_date IS NULL AND transaction_date_raw IS NOT NULL
             THEN TRUE ELSE FALSE 
        END as has_date_parsing_error
    from renamed
)

select * from final
  );

[0m02:27:20.827503 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:27:20.829382 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_raw_staging__transactions"
[0m02:27:20.829581 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__transactions: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_raw_staging__transactions"} */
alter view "casestudy"."staging"."stg_raw_staging__transactions" rename to "stg_raw_staging__transactions__dbt_backup"
[0m02:27:20.829936 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:27:20.831415 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_raw_staging__transactions"
[0m02:27:20.831612 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__transactions: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_raw_staging__transactions"} */
alter view "casestudy"."staging"."stg_raw_staging__transactions__dbt_tmp" rename to "stg_raw_staging__transactions"
[0m02:27:20.831936 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:27:20.832784 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__transactions: COMMIT
[0m02:27:20.832976 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_raw_staging__transactions"
[0m02:27:20.833146 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__transactions: COMMIT
[0m02:27:20.834775 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:27:20.836044 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_raw_staging__transactions"
[0m02:27:20.836246 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__transactions: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_raw_staging__transactions"} */
drop view if exists "casestudy"."staging"."stg_raw_staging__transactions__dbt_backup" cascade
[0m02:27:20.837315 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:27:20.838015 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.stg_raw_staging__transactions (execute): 02:27:20.811476 => 02:27:20.837918
[0m02:27:20.838211 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__transactions: Close
[0m02:27:20.848695 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b0329fb-cf28-4293-b1b2-c45dbb3ba5b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7185baf53ad0>]}
[0m02:27:20.849036 [info ] [Thread-1 (]: 5 of 11 OK created sql view model staging.stg_raw_staging__transactions ........ [[32mOK[0m in 0.04s]
[0m02:27:20.849342 [debug] [Thread-1 (]: Finished running node model.vg_casestudy.stg_raw_staging__transactions
[0m02:27:20.849558 [debug] [Thread-1 (]: Began running node model.vg_casestudy.stg_staging_intermediate__currencies
[0m02:27:20.849772 [info ] [Thread-1 (]: 6 of 11 START sql table model intermediate.stg_staging_intermediate__currencies  [RUN]
[0m02:27:20.850296 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.vg_casestudy.stg_raw_staging__transactions, now model.vg_casestudy.stg_staging_intermediate__currencies)
[0m02:27:20.850482 [debug] [Thread-1 (]: Began compiling node model.vg_casestudy.stg_staging_intermediate__currencies
[0m02:27:20.852098 [debug] [Thread-1 (]: Writing injected SQL for node "model.vg_casestudy.stg_staging_intermediate__currencies"
[0m02:27:20.852459 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.stg_staging_intermediate__currencies (compile): 02:27:20.850597 => 02:27:20.852351
[0m02:27:20.852637 [debug] [Thread-1 (]: Began executing node model.vg_casestudy.stg_staging_intermediate__currencies
[0m02:27:20.863987 [debug] [Thread-1 (]: Writing runtime sql for node "model.vg_casestudy.stg_staging_intermediate__currencies"
[0m02:27:20.864480 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__currencies"
[0m02:27:20.864673 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__currencies: BEGIN
[0m02:27:20.864849 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:27:20.872376 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:27:20.872701 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__currencies"
[0m02:27:20.872896 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__currencies: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_staging_intermediate__currencies"} */

  
    
    

    create  table
      "casestudy"."intermediate"."stg_staging_intermediate__currencies__dbt_tmp"
  
    as (
      with staging as (
    select * from "casestudy"."raw"."currencies"
),
cleaned as (
    select distinct
        trim(currency) as currency,
        trim(currency_iso_code) as currency_iso_code,
    from staging
    where currency_iso_code is not null and trim(currency_iso_code) != '(none)'
)

select * from cleaned
    );
  
  
[0m02:27:20.877516 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.stg_staging_intermediate__currencies (execute): 02:27:20.852754 => 02:27:20.877384
[0m02:27:20.877721 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__currencies: ROLLBACK
[0m02:27:20.879593 [debug] [Thread-1 (]: Failed to rollback 'model.vg_casestudy.stg_staging_intermediate__currencies'
[0m02:27:20.879802 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__currencies: Close
[0m02:27:20.882191 [debug] [Thread-1 (]: Runtime Error in model stg_staging_intermediate__currencies (models/intermediate/stg_staging_intermediate__currencies.sql)
  Catalog Error: Table with name currencies does not exist!
  Did you mean "staging.currencies"?
  
  LINE 12:     select * from "casestudy"."raw"."currencies"
                             ^
[0m02:27:20.882474 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b0329fb-cf28-4293-b1b2-c45dbb3ba5b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7185bafabb10>]}
[0m02:27:20.882802 [error] [Thread-1 (]: 6 of 11 ERROR creating sql table model intermediate.stg_staging_intermediate__currencies  [[31mERROR[0m in 0.03s]
[0m02:27:20.883113 [debug] [Thread-1 (]: Finished running node model.vg_casestudy.stg_staging_intermediate__currencies
[0m02:27:20.883342 [debug] [Thread-1 (]: Began running node model.vg_casestudy.stg_staging_intermediate__accounts
[0m02:27:20.884453 [info ] [Thread-1 (]: 7 of 11 START sql table model intermediate.stg_staging_intermediate__accounts .. [RUN]
[0m02:27:20.884782 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.vg_casestudy.stg_staging_intermediate__currencies, now model.vg_casestudy.stg_staging_intermediate__accounts)
[0m02:27:20.884962 [debug] [Thread-1 (]: Began compiling node model.vg_casestudy.stg_staging_intermediate__accounts
[0m02:27:20.886719 [debug] [Thread-1 (]: Writing injected SQL for node "model.vg_casestudy.stg_staging_intermediate__accounts"
[0m02:27:20.887054 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.stg_staging_intermediate__accounts (compile): 02:27:20.885073 => 02:27:20.886946
[0m02:27:20.887255 [debug] [Thread-1 (]: Began executing node model.vg_casestudy.stg_staging_intermediate__accounts
[0m02:27:20.889240 [debug] [Thread-1 (]: Writing runtime sql for node "model.vg_casestudy.stg_staging_intermediate__accounts"
[0m02:27:20.889526 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__accounts"
[0m02:27:20.889715 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__accounts: BEGIN
[0m02:27:20.889882 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:27:20.897399 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:27:20.897926 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__accounts"
[0m02:27:20.898139 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__accounts: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_staging_intermediate__accounts"} */

  
    
    

    create  table
      "casestudy"."intermediate"."stg_staging_intermediate__accounts__dbt_tmp"
  
    as (
      with staging as (
    select * from "casestudy"."staging"."stg_raw_staging__accounts"
), 
filtered as (
    select 
        account_id,
        customer_id,
        account_type,
        account_opening_date,
     from staging
    where not has_date_parsing_error
)

select * from filtered
    );
  
  
[0m02:27:20.904099 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:27:20.906335 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__accounts"
[0m02:27:20.906575 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__accounts: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_staging_intermediate__accounts"} */
alter table "casestudy"."intermediate"."stg_staging_intermediate__accounts" rename to "stg_staging_intermediate__accounts__dbt_backup"
[0m02:27:20.906993 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:27:20.908593 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__accounts"
[0m02:27:20.908797 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__accounts: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_staging_intermediate__accounts"} */
alter table "casestudy"."intermediate"."stg_staging_intermediate__accounts__dbt_tmp" rename to "stg_staging_intermediate__accounts"
[0m02:27:20.909131 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:27:20.912009 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__accounts: COMMIT
[0m02:27:20.912228 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__accounts"
[0m02:27:20.912404 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__accounts: COMMIT
[0m02:27:20.914005 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:27:20.915368 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__accounts"
[0m02:27:20.915577 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__accounts: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_staging_intermediate__accounts"} */
drop table if exists "casestudy"."intermediate"."stg_staging_intermediate__accounts__dbt_backup" cascade
[0m02:27:20.916477 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:27:20.917211 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.stg_staging_intermediate__accounts (execute): 02:27:20.887376 => 02:27:20.917101
[0m02:27:20.917443 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__accounts: Close
[0m02:27:20.931394 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b0329fb-cf28-4293-b1b2-c45dbb3ba5b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7185bb18ead0>]}
[0m02:27:20.932024 [info ] [Thread-1 (]: 7 of 11 OK created sql table model intermediate.stg_staging_intermediate__accounts  [[32mOK[0m in 0.05s]
[0m02:27:20.932554 [debug] [Thread-1 (]: Finished running node model.vg_casestudy.stg_staging_intermediate__accounts
[0m02:27:20.932834 [debug] [Thread-1 (]: Began running node model.vg_casestudy.stg_staging_intermediate__customers
[0m02:27:20.933209 [info ] [Thread-1 (]: 8 of 11 START sql table model intermediate.stg_staging_intermediate__customers . [RUN]
[0m02:27:20.933633 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.vg_casestudy.stg_staging_intermediate__accounts, now model.vg_casestudy.stg_staging_intermediate__customers)
[0m02:27:20.933865 [debug] [Thread-1 (]: Began compiling node model.vg_casestudy.stg_staging_intermediate__customers
[0m02:27:20.935587 [debug] [Thread-1 (]: Writing injected SQL for node "model.vg_casestudy.stg_staging_intermediate__customers"
[0m02:27:20.935930 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.stg_staging_intermediate__customers (compile): 02:27:20.933995 => 02:27:20.935819
[0m02:27:20.936114 [debug] [Thread-1 (]: Began executing node model.vg_casestudy.stg_staging_intermediate__customers
[0m02:27:20.938259 [debug] [Thread-1 (]: Writing runtime sql for node "model.vg_casestudy.stg_staging_intermediate__customers"
[0m02:27:20.938557 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__customers"
[0m02:27:20.938745 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__customers: BEGIN
[0m02:27:20.938917 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:27:20.947048 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:27:20.947293 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__customers"
[0m02:27:20.947490 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__customers: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_staging_intermediate__customers"} */

  
    
    

    create  table
      "casestudy"."intermediate"."stg_staging_intermediate__customers__dbt_tmp"
  
    as (
      with staging as (
    select * from "casestudy"."staging"."stg_raw_staging__customers"
)

select * from staging
    );
  
  
[0m02:27:20.952704 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:27:20.954639 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__customers"
[0m02:27:20.954876 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__customers: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_staging_intermediate__customers"} */
alter table "casestudy"."intermediate"."stg_staging_intermediate__customers" rename to "stg_staging_intermediate__customers__dbt_backup"
[0m02:27:20.955284 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:27:20.957227 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__customers"
[0m02:27:20.957460 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__customers: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_staging_intermediate__customers"} */
alter table "casestudy"."intermediate"."stg_staging_intermediate__customers__dbt_tmp" rename to "stg_staging_intermediate__customers"
[0m02:27:20.957877 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:27:20.960817 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__customers: COMMIT
[0m02:27:20.961036 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__customers"
[0m02:27:20.961231 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__customers: COMMIT
[0m02:27:20.963294 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:27:20.964647 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__customers"
[0m02:27:20.964861 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__customers: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_staging_intermediate__customers"} */
drop table if exists "casestudy"."intermediate"."stg_staging_intermediate__customers__dbt_backup" cascade
[0m02:27:20.965782 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:27:20.966535 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.stg_staging_intermediate__customers (execute): 02:27:20.936258 => 02:27:20.966435
[0m02:27:20.966736 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__customers: Close
[0m02:27:20.982153 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b0329fb-cf28-4293-b1b2-c45dbb3ba5b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7185bb02d5d0>]}
[0m02:27:20.982605 [info ] [Thread-1 (]: 8 of 11 OK created sql table model intermediate.stg_staging_intermediate__customers  [[32mOK[0m in 0.05s]
[0m02:27:20.982940 [debug] [Thread-1 (]: Finished running node model.vg_casestudy.stg_staging_intermediate__customers
[0m02:27:20.983175 [debug] [Thread-1 (]: Began running node model.vg_casestudy.stg_staging_intermediate__fx_rates
[0m02:27:20.983521 [info ] [Thread-1 (]: 9 of 11 START sql table model intermediate.stg_staging_intermediate__fx_rates .. [RUN]
[0m02:27:20.983874 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.vg_casestudy.stg_staging_intermediate__customers, now model.vg_casestudy.stg_staging_intermediate__fx_rates)
[0m02:27:20.984067 [debug] [Thread-1 (]: Began compiling node model.vg_casestudy.stg_staging_intermediate__fx_rates
[0m02:27:20.985844 [debug] [Thread-1 (]: Writing injected SQL for node "model.vg_casestudy.stg_staging_intermediate__fx_rates"
[0m02:27:20.986189 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.stg_staging_intermediate__fx_rates (compile): 02:27:20.984201 => 02:27:20.986073
[0m02:27:20.986401 [debug] [Thread-1 (]: Began executing node model.vg_casestudy.stg_staging_intermediate__fx_rates
[0m02:27:20.988557 [debug] [Thread-1 (]: Writing runtime sql for node "model.vg_casestudy.stg_staging_intermediate__fx_rates"
[0m02:27:20.988842 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__fx_rates"
[0m02:27:20.989023 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__fx_rates: BEGIN
[0m02:27:20.989206 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:27:20.996631 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:27:20.997065 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__fx_rates"
[0m02:27:20.997288 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__fx_rates: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_staging_intermediate__fx_rates"} */

  
    
    

    create  table
      "casestudy"."intermediate"."stg_staging_intermediate__fx_rates__dbt_tmp"
  
    as (
      with staging as (
    select * from "casestudy"."staging"."stg_raw_staging__fx_rates"
),

filtered as (
    select
        currency_iso_code,
        fx_rate,
        fx_rate_date
    from staging
    where not has_date_parsing_error
)

select * from filtered
    );
  
  
[0m02:27:20.999717 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:27:21.001525 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__fx_rates"
[0m02:27:21.001750 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__fx_rates: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_staging_intermediate__fx_rates"} */
alter table "casestudy"."intermediate"."stg_staging_intermediate__fx_rates" rename to "stg_staging_intermediate__fx_rates__dbt_backup"
[0m02:27:21.002110 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:27:21.003785 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__fx_rates"
[0m02:27:21.004034 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__fx_rates: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_staging_intermediate__fx_rates"} */
alter table "casestudy"."intermediate"."stg_staging_intermediate__fx_rates__dbt_tmp" rename to "stg_staging_intermediate__fx_rates"
[0m02:27:21.004395 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:27:21.005426 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__fx_rates: COMMIT
[0m02:27:21.005646 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__fx_rates"
[0m02:27:21.005834 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__fx_rates: COMMIT
[0m02:27:21.007308 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:27:21.008698 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__fx_rates"
[0m02:27:21.008917 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__fx_rates: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_staging_intermediate__fx_rates"} */
drop table if exists "casestudy"."intermediate"."stg_staging_intermediate__fx_rates__dbt_backup" cascade
[0m02:27:21.009857 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:27:21.010606 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.stg_staging_intermediate__fx_rates (execute): 02:27:20.986526 => 02:27:21.010506
[0m02:27:21.010809 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__fx_rates: Close
[0m02:27:21.022003 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b0329fb-cf28-4293-b1b2-c45dbb3ba5b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7185bb02cf90>]}
[0m02:27:21.022387 [info ] [Thread-1 (]: 9 of 11 OK created sql table model intermediate.stg_staging_intermediate__fx_rates  [[32mOK[0m in 0.04s]
[0m02:27:21.022702 [debug] [Thread-1 (]: Finished running node model.vg_casestudy.stg_staging_intermediate__fx_rates
[0m02:27:21.022924 [debug] [Thread-1 (]: Began running node model.vg_casestudy.stg_staging_intermediate__loans
[0m02:27:21.023440 [info ] [Thread-1 (]: 10 of 11 START sql table model intermediate.stg_staging_intermediate__loans .... [RUN]
[0m02:27:21.024340 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.vg_casestudy.stg_staging_intermediate__fx_rates, now model.vg_casestudy.stg_staging_intermediate__loans)
[0m02:27:21.024810 [debug] [Thread-1 (]: Began compiling node model.vg_casestudy.stg_staging_intermediate__loans
[0m02:27:21.027337 [debug] [Thread-1 (]: Writing injected SQL for node "model.vg_casestudy.stg_staging_intermediate__loans"
[0m02:27:21.027645 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.stg_staging_intermediate__loans (compile): 02:27:21.025103 => 02:27:21.027544
[0m02:27:21.027823 [debug] [Thread-1 (]: Began executing node model.vg_casestudy.stg_staging_intermediate__loans
[0m02:27:21.029816 [debug] [Thread-1 (]: Writing runtime sql for node "model.vg_casestudy.stg_staging_intermediate__loans"
[0m02:27:21.030109 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__loans"
[0m02:27:21.030313 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__loans: BEGIN
[0m02:27:21.030490 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:27:21.037801 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:27:21.038256 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__loans"
[0m02:27:21.038524 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__loans: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_staging_intermediate__loans"} */

  
    
    

    create  table
      "casestudy"."intermediate"."stg_staging_intermediate__loans__dbt_tmp"
  
    as (
      with staging as (
    select * from "casestudy"."staging"."stg_raw_staging__loans"
),

filtered as (
    select
        customer_id,
        loan_id,
        loan_amount,
        loan_type,
        interest_rate,
        loan_term,
        approval_rejection_date,
        loan_status
    from staging
    where not has_date_parsing_error
)

select * from filtered
    );
  
  
[0m02:27:21.047716 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:27:21.049690 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__loans"
[0m02:27:21.049918 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__loans: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_staging_intermediate__loans"} */
alter table "casestudy"."intermediate"."stg_staging_intermediate__loans" rename to "stg_staging_intermediate__loans__dbt_backup"
[0m02:27:21.050300 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:27:21.053199 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__loans"
[0m02:27:21.053422 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__loans: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_staging_intermediate__loans"} */
alter table "casestudy"."intermediate"."stg_staging_intermediate__loans__dbt_tmp" rename to "stg_staging_intermediate__loans"
[0m02:27:21.053784 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:27:21.054848 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__loans: COMMIT
[0m02:27:21.055058 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__loans"
[0m02:27:21.055245 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__loans: COMMIT
[0m02:27:21.057298 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:27:21.058743 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__loans"
[0m02:27:21.058960 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__loans: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_staging_intermediate__loans"} */
drop table if exists "casestudy"."intermediate"."stg_staging_intermediate__loans__dbt_backup" cascade
[0m02:27:21.060983 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:27:21.061846 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.stg_staging_intermediate__loans (execute): 02:27:21.027939 => 02:27:21.061739
[0m02:27:21.062048 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__loans: Close
[0m02:27:21.079968 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b0329fb-cf28-4293-b1b2-c45dbb3ba5b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7185bb0358d0>]}
[0m02:27:21.080476 [info ] [Thread-1 (]: 10 of 11 OK created sql table model intermediate.stg_staging_intermediate__loans  [[32mOK[0m in 0.06s]
[0m02:27:21.080873 [debug] [Thread-1 (]: Finished running node model.vg_casestudy.stg_staging_intermediate__loans
[0m02:27:21.081149 [debug] [Thread-1 (]: Began running node model.vg_casestudy.stg_staging_intermediate__transactions
[0m02:27:21.081473 [info ] [Thread-1 (]: 11 of 11 START sql table model intermediate.stg_staging_intermediate__transactions  [RUN]
[0m02:27:21.081869 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.vg_casestudy.stg_staging_intermediate__loans, now model.vg_casestudy.stg_staging_intermediate__transactions)
[0m02:27:21.082076 [debug] [Thread-1 (]: Began compiling node model.vg_casestudy.stg_staging_intermediate__transactions
[0m02:27:21.084085 [debug] [Thread-1 (]: Writing injected SQL for node "model.vg_casestudy.stg_staging_intermediate__transactions"
[0m02:27:21.084555 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.stg_staging_intermediate__transactions (compile): 02:27:21.082210 => 02:27:21.084403
[0m02:27:21.084754 [debug] [Thread-1 (]: Began executing node model.vg_casestudy.stg_staging_intermediate__transactions
[0m02:27:21.088067 [debug] [Thread-1 (]: Writing runtime sql for node "model.vg_casestudy.stg_staging_intermediate__transactions"
[0m02:27:21.088855 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__transactions"
[0m02:27:21.089298 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__transactions: BEGIN
[0m02:27:21.089669 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:27:21.106581 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:27:21.107484 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__transactions"
[0m02:27:21.107791 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__transactions: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_staging_intermediate__transactions"} */

  
    
    

    create  table
      "casestudy"."intermediate"."stg_staging_intermediate__transactions__dbt_tmp"
  
    as (
      with staging as (
    select * from "casestudy"."staging"."stg_raw_staging__transactions"
),

filtered as (
    select
        transaction_id,
        transaction_date,
        account_id,
        transaction_type,
        transaction_amount,
        transaction_currency
    from staging
    where not has_date_parsing_error
)

select * from filtered
    );
  
  
[0m02:27:21.147469 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:27:21.149798 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__transactions"
[0m02:27:21.150036 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__transactions: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_staging_intermediate__transactions"} */
alter table "casestudy"."intermediate"."stg_staging_intermediate__transactions" rename to "stg_staging_intermediate__transactions__dbt_backup"
[0m02:27:21.150537 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:27:21.152231 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__transactions"
[0m02:27:21.152438 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__transactions: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_staging_intermediate__transactions"} */
alter table "casestudy"."intermediate"."stg_staging_intermediate__transactions__dbt_tmp" rename to "stg_staging_intermediate__transactions"
[0m02:27:21.152818 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:27:21.153780 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__transactions: COMMIT
[0m02:27:21.153980 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__transactions"
[0m02:27:21.154158 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__transactions: COMMIT
[0m02:27:21.159053 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:27:21.160450 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__transactions"
[0m02:27:21.160650 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__transactions: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_staging_intermediate__transactions"} */
drop table if exists "casestudy"."intermediate"."stg_staging_intermediate__transactions__dbt_backup" cascade
[0m02:27:21.161544 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:27:21.162335 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.stg_staging_intermediate__transactions (execute): 02:27:21.084905 => 02:27:21.162239
[0m02:27:21.162526 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__transactions: Close
[0m02:27:21.185757 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b0329fb-cf28-4293-b1b2-c45dbb3ba5b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7185c1d2c210>]}
[0m02:27:21.186190 [info ] [Thread-1 (]: 11 of 11 OK created sql table model intermediate.stg_staging_intermediate__transactions  [[32mOK[0m in 0.10s]
[0m02:27:21.186509 [debug] [Thread-1 (]: Finished running node model.vg_casestudy.stg_staging_intermediate__transactions
[0m02:27:21.188739 [debug] [MainThread]: Using duckdb connection "master"
[0m02:27:21.189277 [debug] [MainThread]: On master: BEGIN
[0m02:27:21.189456 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:27:21.197283 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m02:27:21.197498 [debug] [MainThread]: On master: COMMIT
[0m02:27:21.197651 [debug] [MainThread]: Using duckdb connection "master"
[0m02:27:21.197793 [debug] [MainThread]: On master: COMMIT
[0m02:27:21.198024 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m02:27:21.198199 [debug] [MainThread]: On master: Close
[0m02:27:21.199530 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:27:21.199736 [debug] [MainThread]: Connection 'list_casestudy_raw' was properly closed.
[0m02:27:21.199883 [debug] [MainThread]: Connection 'model.vg_casestudy.stg_staging_intermediate__transactions' was properly closed.
[0m02:27:21.200094 [info ] [MainThread]: 
[0m02:27:21.200286 [info ] [MainThread]: Finished running 5 view models, 6 table models in 0 hours 0 minutes and 5.24 seconds (5.24s).
[0m02:27:21.201154 [debug] [MainThread]: Command end result
[0m02:27:21.261516 [info ] [MainThread]: 
[0m02:27:21.261839 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m02:27:21.262014 [info ] [MainThread]: 
[0m02:27:21.262185 [error] [MainThread]:   Runtime Error in model stg_staging_intermediate__currencies (models/intermediate/stg_staging_intermediate__currencies.sql)
  Catalog Error: Table with name currencies does not exist!
  Did you mean "staging.currencies"?
  
  LINE 12:     select * from "casestudy"."raw"."currencies"
                             ^
[0m02:27:21.262355 [info ] [MainThread]: 
[0m02:27:21.262518 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=1 SKIP=0 TOTAL=11
[0m02:27:21.262790 [debug] [MainThread]: Command `dbt run` failed at 02:27:21.262728 after 6.33 seconds
[0m02:27:21.263007 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7185cabe1910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7185c1eb2510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7185c1eb2150>]}
[0m02:27:21.263207 [debug] [MainThread]: Flushing usage events
[0m02:28:22.088727 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x790a58ecab50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x790a58be0110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x790a590b46d0>]}


============================== 02:28:22.091872 | 8b2ca433-5e5e-4da7-936b-b82859d29cb1 ==============================
[0m02:28:22.091872 [info ] [MainThread]: Running with dbt=1.6.18
[0m02:28:22.092507 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/workspaces/varengold_data_analyst_case/transformation', 'log_path': '/workspaces/varengold_data_analyst_case/transformation/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt seed', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m02:28:22.148637 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8b2ca433-5e5e-4da7-936b-b82859d29cb1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x790a58f046d0>]}
[0m02:28:22.156521 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8b2ca433-5e5e-4da7-936b-b82859d29cb1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x790a58a50f10>]}
[0m02:28:22.156957 [info ] [MainThread]: Registered adapter: duckdb=1.6.2
[0m02:28:22.170046 [debug] [MainThread]: checksum: 7b9fab86a08e9e96a48a825af743c566d95b877e068b8c6d0dbafbf714447189, vars: {}, profile: , target: , version: 1.6.18
[0m02:28:22.192751 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m02:28:22.193031 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m02:28:22.193760 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.vg_casestudy.marts
- models.vg_casestudy.main
- models.vg_casestudy.reporting
[0m02:28:22.197780 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8b2ca433-5e5e-4da7-936b-b82859d29cb1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x790a548f6a90>]}
[0m02:28:22.213582 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8b2ca433-5e5e-4da7-936b-b82859d29cb1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x790a589167d0>]}
[0m02:28:22.213924 [info ] [MainThread]: Found 11 models, 1 analysis, 2 seeds, 71 tests, 5 sources, 0 exposures, 0 metrics, 632 macros, 0 groups, 0 semantic models
[0m02:28:22.214118 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8b2ca433-5e5e-4da7-936b-b82859d29cb1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x790a5465bed0>]}
[0m02:28:22.215703 [info ] [MainThread]: 
[0m02:28:22.216147 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m02:28:22.217351 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_casestudy'
[0m02:28:22.227749 [debug] [ThreadPool]: Using duckdb connection "list_casestudy"
[0m02:28:22.227984 [debug] [ThreadPool]: On list_casestudy: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"casestudy"'
    
  
  
[0m02:28:22.228153 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:28:22.237530 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m02:28:22.238372 [debug] [ThreadPool]: On list_casestudy: Close
[0m02:28:22.241285 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy, now create_casestudy_raw)
[0m02:28:22.241710 [debug] [ThreadPool]: Creating schema "database: "casestudy"
schema: "raw"
"
[0m02:28:22.245030 [debug] [ThreadPool]: Using duckdb connection "create_casestudy_raw"
[0m02:28:22.245235 [debug] [ThreadPool]: On create_casestudy_raw: BEGIN
[0m02:28:22.245385 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:28:22.252178 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m02:28:22.252373 [debug] [ThreadPool]: Using duckdb connection "create_casestudy_raw"
[0m02:28:22.252523 [debug] [ThreadPool]: On create_casestudy_raw: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "create_casestudy_raw"} */
create schema if not exists "casestudy"."raw"
[0m02:28:22.252877 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m02:28:22.253395 [debug] [ThreadPool]: On create_casestudy_raw: COMMIT
[0m02:28:22.253557 [debug] [ThreadPool]: Using duckdb connection "create_casestudy_raw"
[0m02:28:22.253693 [debug] [ThreadPool]: On create_casestudy_raw: COMMIT
[0m02:28:22.253931 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m02:28:22.254091 [debug] [ThreadPool]: On create_casestudy_raw: Close
[0m02:28:22.257471 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_casestudy_raw, now list_casestudy_raw)
[0m02:28:22.262069 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_raw"
[0m02:28:22.262285 [debug] [ThreadPool]: On list_casestudy_raw: BEGIN
[0m02:28:22.262442 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:28:22.269344 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m02:28:22.269546 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_raw"
[0m02:28:22.269714 [debug] [ThreadPool]: On list_casestudy_raw: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_raw"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'raw'
    and table_catalog = 'casestudy'
  
[0m02:28:22.277022 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m02:28:22.277854 [debug] [ThreadPool]: On list_casestudy_raw: ROLLBACK
[0m02:28:22.278298 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_raw'
[0m02:28:22.278472 [debug] [ThreadPool]: On list_casestudy_raw: Close
[0m02:28:22.280249 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy_raw, now list_casestudy_staging)
[0m02:28:22.282031 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_staging"
[0m02:28:22.282230 [debug] [ThreadPool]: On list_casestudy_staging: BEGIN
[0m02:28:22.282381 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:28:22.289237 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m02:28:22.289436 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_staging"
[0m02:28:22.289603 [debug] [ThreadPool]: On list_casestudy_staging: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_staging"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'staging'
    and table_catalog = 'casestudy'
  
[0m02:28:22.296489 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m02:28:22.297279 [debug] [ThreadPool]: On list_casestudy_staging: ROLLBACK
[0m02:28:22.297566 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_staging'
[0m02:28:22.297729 [debug] [ThreadPool]: On list_casestudy_staging: Close
[0m02:28:22.299282 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy_staging, now list_casestudy_intermediate)
[0m02:28:22.301649 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_intermediate"
[0m02:28:22.301836 [debug] [ThreadPool]: On list_casestudy_intermediate: BEGIN
[0m02:28:22.301984 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:28:22.308739 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m02:28:22.308931 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_intermediate"
[0m02:28:22.309097 [debug] [ThreadPool]: On list_casestudy_intermediate: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_intermediate"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'intermediate'
    and table_catalog = 'casestudy'
  
[0m02:28:22.316749 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m02:28:22.317474 [debug] [ThreadPool]: On list_casestudy_intermediate: ROLLBACK
[0m02:28:22.317745 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_intermediate'
[0m02:28:22.317896 [debug] [ThreadPool]: On list_casestudy_intermediate: Close
[0m02:28:22.320393 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8b2ca433-5e5e-4da7-936b-b82859d29cb1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x790a588f9e10>]}
[0m02:28:22.320917 [debug] [MainThread]: Using duckdb connection "master"
[0m02:28:22.321274 [debug] [MainThread]: On master: BEGIN
[0m02:28:22.321589 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:28:22.329476 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m02:28:22.329672 [debug] [MainThread]: On master: COMMIT
[0m02:28:22.329820 [debug] [MainThread]: Using duckdb connection "master"
[0m02:28:22.329957 [debug] [MainThread]: On master: COMMIT
[0m02:28:22.330184 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m02:28:22.330343 [debug] [MainThread]: On master: Close
[0m02:28:22.331487 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:28:22.331684 [info ] [MainThread]: 
[0m02:28:22.333023 [debug] [Thread-1 (]: Began running node seed.vg_casestudy.currencies
[0m02:28:22.333550 [info ] [Thread-1 (]: 1 of 2 START seed file raw.currencies .......................................... [RUN]
[0m02:28:22.334597 [debug] [Thread-1 (]: Acquiring new duckdb connection 'seed.vg_casestudy.currencies'
[0m02:28:22.334995 [debug] [Thread-1 (]: Began compiling node seed.vg_casestudy.currencies
[0m02:28:22.335454 [debug] [Thread-1 (]: Timing info for seed.vg_casestudy.currencies (compile): 02:28:22.335253 => 02:28:22.335256
[0m02:28:22.335790 [debug] [Thread-1 (]: Began executing node seed.vg_casestudy.currencies
[0m02:28:22.350794 [debug] [Thread-1 (]: Using duckdb connection "seed.vg_casestudy.currencies"
[0m02:28:22.351094 [debug] [Thread-1 (]: On seed.vg_casestudy.currencies: BEGIN
[0m02:28:22.351285 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m02:28:22.360011 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:28:22.360259 [debug] [Thread-1 (]: Using duckdb connection "seed.vg_casestudy.currencies"
[0m02:28:22.360433 [debug] [Thread-1 (]: On seed.vg_casestudy.currencies: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "seed.vg_casestudy.currencies"} */

    create table "casestudy"."raw"."currencies" ("currency" text,"currency_iso_code" text)
  
[0m02:28:22.360848 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:28:22.366843 [debug] [Thread-1 (]: Using duckdb connection "seed.vg_casestudy.currencies"
[0m02:28:22.367069 [debug] [Thread-1 (]: On seed.vg_casestudy.currencies: 
          COPY "casestudy"."raw"."currencies" FROM '/workspaces/varengold_data_analyst_case/transformation/seeds/currencies.csv' (FORMAT CSV, HEADER TRUE)
        ...
[0m02:28:22.370793 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:28:22.373888 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.vg_casestudy.currencies"
[0m02:28:22.383348 [debug] [Thread-1 (]: On seed.vg_casestudy.currencies: COMMIT
[0m02:28:22.383565 [debug] [Thread-1 (]: Using duckdb connection "seed.vg_casestudy.currencies"
[0m02:28:22.383740 [debug] [Thread-1 (]: On seed.vg_casestudy.currencies: COMMIT
[0m02:28:22.391441 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:28:22.392024 [debug] [Thread-1 (]: Timing info for seed.vg_casestudy.currencies (execute): 02:28:22.336015 => 02:28:22.391925
[0m02:28:22.392226 [debug] [Thread-1 (]: On seed.vg_casestudy.currencies: Close
[0m02:28:22.406329 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8b2ca433-5e5e-4da7-936b-b82859d29cb1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x790a5894d510>]}
[0m02:28:22.407047 [info ] [Thread-1 (]: 1 of 2 OK loaded seed file raw.currencies ...................................... [[32mINSERT 158[0m in 0.07s]
[0m02:28:22.407582 [debug] [Thread-1 (]: Finished running node seed.vg_casestudy.currencies
[0m02:28:22.407953 [debug] [Thread-1 (]: Began running node seed.vg_casestudy.dbt_project_evaluator_exceptions
[0m02:28:22.408521 [info ] [Thread-1 (]: 2 of 2 START seed file raw.dbt_project_evaluator_exceptions .................... [RUN]
[0m02:28:22.409250 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.vg_casestudy.currencies, now seed.vg_casestudy.dbt_project_evaluator_exceptions)
[0m02:28:22.409504 [debug] [Thread-1 (]: Began compiling node seed.vg_casestudy.dbt_project_evaluator_exceptions
[0m02:28:22.409748 [debug] [Thread-1 (]: Timing info for seed.vg_casestudy.dbt_project_evaluator_exceptions (compile): 02:28:22.409640 => 02:28:22.409642
[0m02:28:22.409929 [debug] [Thread-1 (]: Began executing node seed.vg_casestudy.dbt_project_evaluator_exceptions
[0m02:28:22.412379 [debug] [Thread-1 (]: Using duckdb connection "seed.vg_casestudy.dbt_project_evaluator_exceptions"
[0m02:28:22.412597 [debug] [Thread-1 (]: On seed.vg_casestudy.dbt_project_evaluator_exceptions: BEGIN
[0m02:28:22.412765 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:28:22.419685 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:28:22.420023 [debug] [Thread-1 (]: Using duckdb connection "seed.vg_casestudy.dbt_project_evaluator_exceptions"
[0m02:28:22.420250 [debug] [Thread-1 (]: On seed.vg_casestudy.dbt_project_evaluator_exceptions: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "seed.vg_casestudy.dbt_project_evaluator_exceptions"} */

    create table "casestudy"."raw"."dbt_project_evaluator_exceptions" ("fct_name" text,"column_name" text,"id_to_exclude" text,"comment" text)
  
[0m02:28:22.420797 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:28:22.421631 [debug] [Thread-1 (]: Using duckdb connection "seed.vg_casestudy.dbt_project_evaluator_exceptions"
[0m02:28:22.421850 [debug] [Thread-1 (]: On seed.vg_casestudy.dbt_project_evaluator_exceptions: 
          COPY "casestudy"."raw"."dbt_project_evaluator_exceptions" FROM '/workspaces/varengold_data_analyst_case/transformation/seeds/dbt_project_evaluator_exceptions.csv' (FORMAT CSV, HEADER TRUE)
        ...
[0m02:28:22.424687 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:28:22.425224 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.vg_casestudy.dbt_project_evaluator_exceptions"
[0m02:28:22.426401 [debug] [Thread-1 (]: On seed.vg_casestudy.dbt_project_evaluator_exceptions: COMMIT
[0m02:28:22.426631 [debug] [Thread-1 (]: Using duckdb connection "seed.vg_casestudy.dbt_project_evaluator_exceptions"
[0m02:28:22.426801 [debug] [Thread-1 (]: On seed.vg_casestudy.dbt_project_evaluator_exceptions: COMMIT
[0m02:28:22.428146 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:28:22.428695 [debug] [Thread-1 (]: Timing info for seed.vg_casestudy.dbt_project_evaluator_exceptions (execute): 02:28:22.410049 => 02:28:22.428597
[0m02:28:22.428882 [debug] [Thread-1 (]: On seed.vg_casestudy.dbt_project_evaluator_exceptions: Close
[0m02:28:22.440840 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8b2ca433-5e5e-4da7-936b-b82859d29cb1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x790a5893b810>]}
[0m02:28:22.441203 [info ] [Thread-1 (]: 2 of 2 OK loaded seed file raw.dbt_project_evaluator_exceptions ................ [[32mINSERT 2[0m in 0.03s]
[0m02:28:22.441519 [debug] [Thread-1 (]: Finished running node seed.vg_casestudy.dbt_project_evaluator_exceptions
[0m02:28:22.442743 [debug] [MainThread]: Using duckdb connection "master"
[0m02:28:22.442943 [debug] [MainThread]: On master: BEGIN
[0m02:28:22.443090 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:28:22.450807 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m02:28:22.451048 [debug] [MainThread]: On master: COMMIT
[0m02:28:22.451216 [debug] [MainThread]: Using duckdb connection "master"
[0m02:28:22.451365 [debug] [MainThread]: On master: COMMIT
[0m02:28:22.451607 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m02:28:22.451784 [debug] [MainThread]: On master: Close
[0m02:28:22.453454 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:28:22.453654 [debug] [MainThread]: Connection 'list_casestudy_intermediate' was properly closed.
[0m02:28:22.453789 [debug] [MainThread]: Connection 'seed.vg_casestudy.dbt_project_evaluator_exceptions' was properly closed.
[0m02:28:22.454010 [info ] [MainThread]: 
[0m02:28:22.454196 [info ] [MainThread]: Finished running 2 seeds in 0 hours 0 minutes and 0.24 seconds (0.24s).
[0m02:28:22.454624 [debug] [MainThread]: Command end result
[0m02:28:22.503959 [info ] [MainThread]: 
[0m02:28:22.504264 [info ] [MainThread]: [32mCompleted successfully[0m
[0m02:28:22.504436 [info ] [MainThread]: 
[0m02:28:22.504603 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m02:28:22.504864 [debug] [MainThread]: Command `dbt seed` succeeded at 02:28:22.504802 after 0.42 seconds
[0m02:28:22.505059 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x790a59d33dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x790a58c40cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x790a58c40710>]}
[0m02:28:22.505271 [debug] [MainThread]: Flushing usage events
[0m02:28:26.616898 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x740a744f23d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x740a74afacd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x740a7475fb10>]}


============================== 02:28:26.619875 | 3aeec56f-ff13-44f7-96b5-c78c6b5fd01e ==============================
[0m02:28:26.619875 [info ] [MainThread]: Running with dbt=1.6.18
[0m02:28:26.620419 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/workspaces/varengold_data_analyst_case/transformation', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/workspaces/varengold_data_analyst_case/transformation/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m02:28:26.676907 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3aeec56f-ff13-44f7-96b5-c78c6b5fd01e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x740a74517e90>]}
[0m02:28:26.684641 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3aeec56f-ff13-44f7-96b5-c78c6b5fd01e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x740a74823050>]}
[0m02:28:26.685068 [info ] [MainThread]: Registered adapter: duckdb=1.6.2
[0m02:28:26.697698 [debug] [MainThread]: checksum: 7b9fab86a08e9e96a48a825af743c566d95b877e068b8c6d0dbafbf714447189, vars: {}, profile: , target: , version: 1.6.18
[0m02:28:26.720445 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m02:28:26.720757 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m02:28:26.721462 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.vg_casestudy.marts
- models.vg_casestudy.reporting
- models.vg_casestudy.main
[0m02:28:26.725422 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3aeec56f-ff13-44f7-96b5-c78c6b5fd01e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x740a70386a90>]}
[0m02:28:26.738906 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3aeec56f-ff13-44f7-96b5-c78c6b5fd01e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x740a703702d0>]}
[0m02:28:26.739264 [info ] [MainThread]: Found 11 models, 1 analysis, 2 seeds, 71 tests, 5 sources, 0 exposures, 0 metrics, 632 macros, 0 groups, 0 semantic models
[0m02:28:26.739465 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3aeec56f-ff13-44f7-96b5-c78c6b5fd01e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x740a7027ff10>]}
[0m02:28:26.741270 [info ] [MainThread]: 
[0m02:28:26.741723 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m02:28:26.742837 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_casestudy'
[0m02:28:26.752811 [debug] [ThreadPool]: Using duckdb connection "list_casestudy"
[0m02:28:26.753024 [debug] [ThreadPool]: On list_casestudy: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"casestudy"'
    
  
  
[0m02:28:26.753214 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:28:26.764312 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m02:28:26.765291 [debug] [ThreadPool]: On list_casestudy: Close
[0m02:28:26.770491 [debug] [ThreadPool]: Using duckdb connection "list_casestudy"
[0m02:28:26.770772 [debug] [ThreadPool]: On list_casestudy: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"casestudy"'
    
  
  
[0m02:28:26.770937 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:28:26.778369 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m02:28:26.779260 [debug] [ThreadPool]: On list_casestudy: Close
[0m02:28:26.781198 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy, now create_casestudy_staging)
[0m02:28:26.781598 [debug] [ThreadPool]: Creating schema "database: "casestudy"
schema: "staging"
"
[0m02:28:26.784303 [debug] [ThreadPool]: Using duckdb connection "create_casestudy_staging"
[0m02:28:26.784488 [debug] [ThreadPool]: On create_casestudy_staging: BEGIN
[0m02:28:26.784639 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:28:26.791334 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m02:28:26.791553 [debug] [ThreadPool]: Using duckdb connection "create_casestudy_staging"
[0m02:28:26.791707 [debug] [ThreadPool]: On create_casestudy_staging: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "create_casestudy_staging"} */
create schema if not exists "casestudy"."staging"
[0m02:28:26.791981 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m02:28:26.792909 [debug] [ThreadPool]: On create_casestudy_staging: COMMIT
[0m02:28:26.793352 [debug] [ThreadPool]: Using duckdb connection "create_casestudy_staging"
[0m02:28:26.793642 [debug] [ThreadPool]: On create_casestudy_staging: COMMIT
[0m02:28:26.794209 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m02:28:26.794527 [debug] [ThreadPool]: On create_casestudy_staging: Close
[0m02:28:26.796871 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_casestudy_staging, now create_casestudy_intermediate)
[0m02:28:26.797264 [debug] [ThreadPool]: Creating schema "database: "casestudy"
schema: "intermediate"
"
[0m02:28:26.798558 [debug] [ThreadPool]: Using duckdb connection "create_casestudy_intermediate"
[0m02:28:26.798741 [debug] [ThreadPool]: On create_casestudy_intermediate: BEGIN
[0m02:28:26.798884 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:28:26.805490 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m02:28:26.805689 [debug] [ThreadPool]: Using duckdb connection "create_casestudy_intermediate"
[0m02:28:26.805841 [debug] [ThreadPool]: On create_casestudy_intermediate: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "create_casestudy_intermediate"} */
create schema if not exists "casestudy"."intermediate"
[0m02:28:26.806111 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m02:28:26.806624 [debug] [ThreadPool]: On create_casestudy_intermediate: COMMIT
[0m02:28:26.806791 [debug] [ThreadPool]: Using duckdb connection "create_casestudy_intermediate"
[0m02:28:26.806934 [debug] [ThreadPool]: On create_casestudy_intermediate: COMMIT
[0m02:28:26.807191 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m02:28:26.807356 [debug] [ThreadPool]: On create_casestudy_intermediate: Close
[0m02:28:26.809850 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_casestudy_intermediate, now list_casestudy_raw)
[0m02:28:26.815730 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_raw"
[0m02:28:26.815913 [debug] [ThreadPool]: On list_casestudy_raw: BEGIN
[0m02:28:26.816059 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:28:26.822608 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m02:28:26.822791 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_raw"
[0m02:28:26.822944 [debug] [ThreadPool]: On list_casestudy_raw: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_raw"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'raw'
    and table_catalog = 'casestudy'
  
[0m02:28:26.831442 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m02:28:26.832250 [debug] [ThreadPool]: On list_casestudy_raw: ROLLBACK
[0m02:28:26.832699 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_raw'
[0m02:28:26.832884 [debug] [ThreadPool]: On list_casestudy_raw: Close
[0m02:28:26.834423 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy_raw, now list_casestudy_staging)
[0m02:28:26.836965 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_staging"
[0m02:28:26.837149 [debug] [ThreadPool]: On list_casestudy_staging: BEGIN
[0m02:28:26.837291 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:28:26.843712 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m02:28:26.843893 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_staging"
[0m02:28:26.844050 [debug] [ThreadPool]: On list_casestudy_staging: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_staging"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'staging'
    and table_catalog = 'casestudy'
  
[0m02:28:26.850822 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m02:28:26.851545 [debug] [ThreadPool]: On list_casestudy_staging: ROLLBACK
[0m02:28:26.851808 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_staging'
[0m02:28:26.851953 [debug] [ThreadPool]: On list_casestudy_staging: Close
[0m02:28:26.854204 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy_staging, now list_casestudy_intermediate)
[0m02:28:26.857128 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_intermediate"
[0m02:28:26.857359 [debug] [ThreadPool]: On list_casestudy_intermediate: BEGIN
[0m02:28:26.857490 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:28:26.867876 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m02:28:26.868061 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_intermediate"
[0m02:28:26.868617 [debug] [ThreadPool]: On list_casestudy_intermediate: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_intermediate"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'intermediate'
    and table_catalog = 'casestudy'
  
[0m02:28:26.880010 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m02:28:26.880747 [debug] [ThreadPool]: On list_casestudy_intermediate: ROLLBACK
[0m02:28:26.881028 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_intermediate'
[0m02:28:26.881186 [debug] [ThreadPool]: On list_casestudy_intermediate: Close
[0m02:28:26.883399 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3aeec56f-ff13-44f7-96b5-c78c6b5fd01e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x740a7497acd0>]}
[0m02:28:26.883679 [debug] [MainThread]: Using duckdb connection "master"
[0m02:28:26.883832 [debug] [MainThread]: On master: BEGIN
[0m02:28:26.883969 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:28:26.891171 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m02:28:26.891361 [debug] [MainThread]: On master: COMMIT
[0m02:28:26.891510 [debug] [MainThread]: Using duckdb connection "master"
[0m02:28:26.891650 [debug] [MainThread]: On master: COMMIT
[0m02:28:26.891880 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m02:28:26.892046 [debug] [MainThread]: On master: Close
[0m02:28:26.893745 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:28:26.893993 [info ] [MainThread]: 
[0m02:28:26.895583 [debug] [Thread-1 (]: Began running node model.vg_casestudy.stg_raw_staging__accounts
[0m02:28:26.895854 [info ] [Thread-1 (]: 1 of 11 START sql view model staging.stg_raw_staging__accounts ................. [RUN]
[0m02:28:26.896262 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.vg_casestudy.stg_raw_staging__accounts'
[0m02:28:26.896459 [debug] [Thread-1 (]: Began compiling node model.vg_casestudy.stg_raw_staging__accounts
[0m02:28:26.901643 [debug] [Thread-1 (]: Writing injected SQL for node "model.vg_casestudy.stg_raw_staging__accounts"
[0m02:28:26.902021 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.stg_raw_staging__accounts (compile): 02:28:26.896579 => 02:28:26.901905
[0m02:28:26.902232 [debug] [Thread-1 (]: Began executing node model.vg_casestudy.stg_raw_staging__accounts
[0m02:28:26.920650 [debug] [Thread-1 (]: Writing runtime sql for node "model.vg_casestudy.stg_raw_staging__accounts"
[0m02:28:26.921071 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_raw_staging__accounts"
[0m02:28:26.921275 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__accounts: BEGIN
[0m02:28:26.921442 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m02:28:26.930008 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:28:26.930258 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_raw_staging__accounts"
[0m02:28:26.930476 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__accounts: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_raw_staging__accounts"} */

  
  create view "casestudy"."staging"."stg_raw_staging__accounts__dbt_tmp" as (
    with source as (
    select * from "casestudy"."raw"."accounts"
),

renamed as (
    select
        account_id,
        customer_id,
        account_type,
        
CASE
    -- First try DD.MM.YYYY format (German format with dots)
    WHEN REGEXP_MATCHES(account_opening_date, '^\d{1,2}\.\d{1,2}\.\d{4}$') 
        THEN TRY_CAST(STRPTIME(account_opening_date, '%d.%m.%Y') AS DATE)
        
    -- Then try DD/MM/YYYY format (with slashes)
    WHEN REGEXP_MATCHES(account_opening_date, '^\d{1,2}/\d{1,2}/\d{4}$')
        AND CAST(SPLIT_PART(account_opening_date, '/', 1) AS INTEGER) <= 31 
        AND CAST(SPLIT_PART(account_opening_date, '/', 2) AS INTEGER) <= 12 
        THEN TRY_CAST(STRPTIME(account_opening_date, '%d/%m/%Y') AS DATE)
        
    -- Try MM/DD/YYYY format (US format with slashes)
    WHEN REGEXP_MATCHES(account_opening_date, '^\d{1,2}/\d{1,2}/\d{4}$')
        AND CAST(SPLIT_PART(account_opening_date, '/', 1) AS INTEGER) <= 12 
        THEN TRY_CAST(STRPTIME(account_opening_date, '%m/%d/%Y') AS DATE)
        
    -- Try YYYY-MM-DD format (ISO format)
    WHEN REGEXP_MATCHES(account_opening_date, '^\d{4}-\d{1,2}-\d{1,2}$')
        THEN TRY_CAST(STRPTIME(account_opening_date, '%Y-%m-%d') AS DATE)
        
    -- Try generic date parsing as last resort
    ELSE TRY_CAST(account_opening_date AS DATE)
END
 as account_opening_date,
        account_opening_date as account_opening_date_raw
    from source
    where account_type is not null and account_type != '' and account_type != '-'
),

final as (
    select
        account_id,
        customer_id,
        account_type,
        account_opening_date,
        -- Flag records with date parsing issues
        CASE WHEN account_opening_date IS NULL AND account_opening_date_raw IS NOT NULL
             THEN TRUE ELSE FALSE 
        END as has_date_parsing_error
    from renamed
)

select * from final
  );

[0m02:28:26.931481 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:28:26.971385 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_raw_staging__accounts"
[0m02:28:26.971666 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__accounts: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_raw_staging__accounts"} */
alter view "casestudy"."staging"."stg_raw_staging__accounts" rename to "stg_raw_staging__accounts__dbt_backup"
[0m02:28:26.972330 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:28:26.974061 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_raw_staging__accounts"
[0m02:28:26.974305 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__accounts: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_raw_staging__accounts"} */
alter view "casestudy"."staging"."stg_raw_staging__accounts__dbt_tmp" rename to "stg_raw_staging__accounts"
[0m02:28:26.974737 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:28:26.983867 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__accounts: COMMIT
[0m02:28:26.984097 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_raw_staging__accounts"
[0m02:28:26.984281 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__accounts: COMMIT
[0m02:28:26.986331 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:28:26.989025 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_raw_staging__accounts"
[0m02:28:26.989236 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__accounts: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_raw_staging__accounts"} */
drop view if exists "casestudy"."staging"."stg_raw_staging__accounts__dbt_backup" cascade
[0m02:28:26.990714 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:28:26.991528 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.stg_raw_staging__accounts (execute): 02:28:26.902355 => 02:28:26.991432
[0m02:28:26.991725 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__accounts: Close
[0m02:28:27.003690 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3aeec56f-ff13-44f7-96b5-c78c6b5fd01e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x740a702baf90>]}
[0m02:28:27.004042 [info ] [Thread-1 (]: 1 of 11 OK created sql view model staging.stg_raw_staging__accounts ............ [[32mOK[0m in 0.11s]
[0m02:28:27.004358 [debug] [Thread-1 (]: Finished running node model.vg_casestudy.stg_raw_staging__accounts
[0m02:28:27.004567 [debug] [Thread-1 (]: Began running node model.vg_casestudy.stg_raw_staging__customers
[0m02:28:27.004944 [info ] [Thread-1 (]: 2 of 11 START sql view model staging.stg_raw_staging__customers ................ [RUN]
[0m02:28:27.005305 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.vg_casestudy.stg_raw_staging__accounts, now model.vg_casestudy.stg_raw_staging__customers)
[0m02:28:27.005500 [debug] [Thread-1 (]: Began compiling node model.vg_casestudy.stg_raw_staging__customers
[0m02:28:27.007059 [debug] [Thread-1 (]: Writing injected SQL for node "model.vg_casestudy.stg_raw_staging__customers"
[0m02:28:27.007400 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.stg_raw_staging__customers (compile): 02:28:27.005618 => 02:28:27.007288
[0m02:28:27.007584 [debug] [Thread-1 (]: Began executing node model.vg_casestudy.stg_raw_staging__customers
[0m02:28:27.009570 [debug] [Thread-1 (]: Writing runtime sql for node "model.vg_casestudy.stg_raw_staging__customers"
[0m02:28:27.009872 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_raw_staging__customers"
[0m02:28:27.010056 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__customers: BEGIN
[0m02:28:27.010243 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:28:27.021644 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:28:27.022033 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_raw_staging__customers"
[0m02:28:27.022253 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__customers: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_raw_staging__customers"} */

  
  create view "casestudy"."staging"."stg_raw_staging__customers__dbt_tmp" as (
    with source as (
    select * from "casestudy"."raw"."customers"
),

renamed as (
    select distinct
        customer_id,
        trim(firstname) as firstname,
        trim(lastname) as lastname,
        Age as age,
        branch_id
    from source
)

select * from renamed
  );

[0m02:28:27.022925 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:28:27.025137 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_raw_staging__customers"
[0m02:28:27.025377 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__customers: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_raw_staging__customers"} */
alter view "casestudy"."staging"."stg_raw_staging__customers" rename to "stg_raw_staging__customers__dbt_backup"
[0m02:28:27.025732 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:28:27.027375 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_raw_staging__customers"
[0m02:28:27.027580 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__customers: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_raw_staging__customers"} */
alter view "casestudy"."staging"."stg_raw_staging__customers__dbt_tmp" rename to "stg_raw_staging__customers"
[0m02:28:27.028040 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:28:27.028909 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__customers: COMMIT
[0m02:28:27.029105 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_raw_staging__customers"
[0m02:28:27.029275 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__customers: COMMIT
[0m02:28:27.030657 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:28:27.032077 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_raw_staging__customers"
[0m02:28:27.032279 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__customers: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_raw_staging__customers"} */
drop view if exists "casestudy"."staging"."stg_raw_staging__customers__dbt_backup" cascade
[0m02:28:27.033161 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:28:27.033882 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.stg_raw_staging__customers (execute): 02:28:27.007703 => 02:28:27.033781
[0m02:28:27.034065 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__customers: Close
[0m02:28:27.044583 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3aeec56f-ff13-44f7-96b5-c78c6b5fd01e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x740a702c4c50>]}
[0m02:28:27.044938 [info ] [Thread-1 (]: 2 of 11 OK created sql view model staging.stg_raw_staging__customers ........... [[32mOK[0m in 0.04s]
[0m02:28:27.045251 [debug] [Thread-1 (]: Finished running node model.vg_casestudy.stg_raw_staging__customers
[0m02:28:27.045477 [debug] [Thread-1 (]: Began running node model.vg_casestudy.stg_raw_staging__fx_rates
[0m02:28:27.045765 [info ] [Thread-1 (]: 3 of 11 START sql view model staging.stg_raw_staging__fx_rates ................. [RUN]
[0m02:28:27.046169 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.vg_casestudy.stg_raw_staging__customers, now model.vg_casestudy.stg_raw_staging__fx_rates)
[0m02:28:27.046371 [debug] [Thread-1 (]: Began compiling node model.vg_casestudy.stg_raw_staging__fx_rates
[0m02:28:27.050106 [debug] [Thread-1 (]: Writing injected SQL for node "model.vg_casestudy.stg_raw_staging__fx_rates"
[0m02:28:27.050465 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.stg_raw_staging__fx_rates (compile): 02:28:27.046491 => 02:28:27.050351
[0m02:28:27.050649 [debug] [Thread-1 (]: Began executing node model.vg_casestudy.stg_raw_staging__fx_rates
[0m02:28:27.052603 [debug] [Thread-1 (]: Writing runtime sql for node "model.vg_casestudy.stg_raw_staging__fx_rates"
[0m02:28:27.052894 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_raw_staging__fx_rates"
[0m02:28:27.053071 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__fx_rates: BEGIN
[0m02:28:27.053249 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:28:27.060171 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:28:27.060492 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_raw_staging__fx_rates"
[0m02:28:27.060735 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__fx_rates: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_raw_staging__fx_rates"} */

  
  create view "casestudy"."staging"."stg_raw_staging__fx_rates__dbt_tmp" as (
    with source as (
    select * from "casestudy"."raw"."fx_rates"
),

renamed as (
    select
        trim(currency_iso_code) as currency_iso_code,
        
CASE
    WHEN fx_rate IS NULL THEN NULL
    -- If the value is already a valid number
    WHEN TRY_CAST(fx_rate AS DOUBLE) IS NOT NULL 
        THEN TRY_CAST(fx_rate AS DOUBLE)
    -- If contains both dot and comma (German notation)
    WHEN POSITION('.' IN fx_rate) > 0 AND POSITION(',' IN fx_rate) > 0 
        THEN TRY_CAST(REPLACE(REPLACE(TRIM(fx_rate), '.', ''), ',', '.') AS DOUBLE)
    -- If only contains comma, treat as decimal point
    WHEN POSITION(',' IN fx_rate) > 0 
        THEN TRY_CAST(REPLACE(TRIM(fx_rate), ',', '.') AS DOUBLE)
    -- If only contains dots, likely thousands separator
    WHEN POSITION('.' IN fx_rate) > 0 
        THEN TRY_CAST(REPLACE(TRIM(fx_rate), '.', '') AS DOUBLE)
    ELSE NULL
END
 as fx_rate,
        
CASE
    -- First try DD.MM.YYYY format (German format with dots)
    WHEN REGEXP_MATCHES(date, '^\d{1,2}\.\d{1,2}\.\d{4}$') 
        THEN TRY_CAST(STRPTIME(date, '%d.%m.%Y') AS DATE)
        
    -- Then try DD/MM/YYYY format (with slashes)
    WHEN REGEXP_MATCHES(date, '^\d{1,2}/\d{1,2}/\d{4}$')
        AND CAST(SPLIT_PART(date, '/', 1) AS INTEGER) <= 31 
        AND CAST(SPLIT_PART(date, '/', 2) AS INTEGER) <= 12 
        THEN TRY_CAST(STRPTIME(date, '%d/%m/%Y') AS DATE)
        
    -- Try MM/DD/YYYY format (US format with slashes)
    WHEN REGEXP_MATCHES(date, '^\d{1,2}/\d{1,2}/\d{4}$')
        AND CAST(SPLIT_PART(date, '/', 1) AS INTEGER) <= 12 
        THEN TRY_CAST(STRPTIME(date, '%m/%d/%Y') AS DATE)
        
    -- Try YYYY-MM-DD format (ISO format)
    WHEN REGEXP_MATCHES(date, '^\d{4}-\d{1,2}-\d{1,2}$')
        THEN TRY_CAST(STRPTIME(date, '%Y-%m-%d') AS DATE)
        
    -- Try generic date parsing as last resort
    ELSE TRY_CAST(date AS DATE)
END
 as fx_rate_date,
        date as fx_rate_date_raw
    from source
    where currency_iso_code is not null and trim(currency_iso_code) not in  ('(none)', '')
),

final as (
    select
        currency_iso_code,
        fx_rate,
        fx_rate_date,
        -- Flag records with date parsing issues
        CASE WHEN fx_rate_date IS NULL AND fx_rate_date_raw IS NOT NULL
             THEN TRUE ELSE FALSE 
        END as has_date_parsing_error
    from renamed
)

select * from final
  );

[0m02:28:27.062157 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:28:27.064223 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_raw_staging__fx_rates"
[0m02:28:27.064429 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__fx_rates: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_raw_staging__fx_rates"} */
alter view "casestudy"."staging"."stg_raw_staging__fx_rates" rename to "stg_raw_staging__fx_rates__dbt_backup"
[0m02:28:27.064794 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:28:27.066413 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_raw_staging__fx_rates"
[0m02:28:27.066613 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__fx_rates: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_raw_staging__fx_rates"} */
alter view "casestudy"."staging"."stg_raw_staging__fx_rates__dbt_tmp" rename to "stg_raw_staging__fx_rates"
[0m02:28:27.067137 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:28:27.067984 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__fx_rates: COMMIT
[0m02:28:27.068178 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_raw_staging__fx_rates"
[0m02:28:27.068344 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__fx_rates: COMMIT
[0m02:28:27.069752 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:28:27.071020 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_raw_staging__fx_rates"
[0m02:28:27.071224 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__fx_rates: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_raw_staging__fx_rates"} */
drop view if exists "casestudy"."staging"."stg_raw_staging__fx_rates__dbt_backup" cascade
[0m02:28:27.072101 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:28:27.072811 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.stg_raw_staging__fx_rates (execute): 02:28:27.050768 => 02:28:27.072714
[0m02:28:27.072995 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__fx_rates: Close
[0m02:28:27.084480 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3aeec56f-ff13-44f7-96b5-c78c6b5fd01e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x740a74536b10>]}
[0m02:28:27.085194 [info ] [Thread-1 (]: 3 of 11 OK created sql view model staging.stg_raw_staging__fx_rates ............ [[32mOK[0m in 0.04s]
[0m02:28:27.085686 [debug] [Thread-1 (]: Finished running node model.vg_casestudy.stg_raw_staging__fx_rates
[0m02:28:27.085973 [debug] [Thread-1 (]: Began running node model.vg_casestudy.stg_raw_staging__loans
[0m02:28:27.086379 [info ] [Thread-1 (]: 4 of 11 START sql view model staging.stg_raw_staging__loans .................... [RUN]
[0m02:28:27.086847 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.vg_casestudy.stg_raw_staging__fx_rates, now model.vg_casestudy.stg_raw_staging__loans)
[0m02:28:27.087092 [debug] [Thread-1 (]: Began compiling node model.vg_casestudy.stg_raw_staging__loans
[0m02:28:27.089224 [debug] [Thread-1 (]: Writing injected SQL for node "model.vg_casestudy.stg_raw_staging__loans"
[0m02:28:27.089577 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.stg_raw_staging__loans (compile): 02:28:27.087224 => 02:28:27.089460
[0m02:28:27.089756 [debug] [Thread-1 (]: Began executing node model.vg_casestudy.stg_raw_staging__loans
[0m02:28:27.091861 [debug] [Thread-1 (]: Writing runtime sql for node "model.vg_casestudy.stg_raw_staging__loans"
[0m02:28:27.092172 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_raw_staging__loans"
[0m02:28:27.092359 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__loans: BEGIN
[0m02:28:27.092519 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:28:27.100097 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:28:27.100397 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_raw_staging__loans"
[0m02:28:27.100665 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__loans: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_raw_staging__loans"} */

  
  create view "casestudy"."staging"."stg_raw_staging__loans__dbt_tmp" as (
    with source as (
    select * from "casestudy"."raw"."loans"
),

renamed as (
    select
        customer_id,
        loan_id,
        
CASE
    WHEN loan_amount IS NULL THEN NULL
    -- If the value is already a valid number
    WHEN TRY_CAST(loan_amount AS DOUBLE) IS NOT NULL 
        THEN TRY_CAST(loan_amount AS DOUBLE)
    -- If contains both dot and comma (German notation)
    WHEN POSITION('.' IN loan_amount) > 0 AND POSITION(',' IN loan_amount) > 0 
        THEN TRY_CAST(REPLACE(REPLACE(TRIM(loan_amount), '.', ''), ',', '.') AS DOUBLE)
    -- If only contains comma, treat as decimal point
    WHEN POSITION(',' IN loan_amount) > 0 
        THEN TRY_CAST(REPLACE(TRIM(loan_amount), ',', '.') AS DOUBLE)
    -- If only contains dots, likely thousands separator
    WHEN POSITION('.' IN loan_amount) > 0 
        THEN TRY_CAST(REPLACE(TRIM(loan_amount), '.', '') AS DOUBLE)
    ELSE NULL
END
 as loan_amount,
        loant_type,
        
CASE
    WHEN interest_rate IS NULL THEN NULL
    -- If the value is already a valid number
    WHEN TRY_CAST(interest_rate AS DOUBLE) IS NOT NULL 
        THEN TRY_CAST(interest_rate AS DOUBLE)
    -- If contains both dot and comma (German notation)
    WHEN POSITION('.' IN interest_rate) > 0 AND POSITION(',' IN interest_rate) > 0 
        THEN TRY_CAST(REPLACE(REPLACE(TRIM(interest_rate), '.', ''), ',', '.') AS DOUBLE)
    -- If only contains comma, treat as decimal point
    WHEN POSITION(',' IN interest_rate) > 0 
        THEN TRY_CAST(REPLACE(TRIM(interest_rate), ',', '.') AS DOUBLE)
    -- If only contains dots, likely thousands separator
    WHEN POSITION('.' IN interest_rate) > 0 
        THEN TRY_CAST(REPLACE(TRIM(interest_rate), '.', '') AS DOUBLE)
    ELSE NULL
END
 as interest_rate,
        loan_term,
        
CASE
    -- First try DD.MM.YYYY format (German format with dots)
    WHEN REGEXP_MATCHES(approval_rejection_date, '^\d{1,2}\.\d{1,2}\.\d{4}$') 
        THEN TRY_CAST(STRPTIME(approval_rejection_date, '%d.%m.%Y') AS DATE)
        
    -- Then try DD/MM/YYYY format (with slashes)
    WHEN REGEXP_MATCHES(approval_rejection_date, '^\d{1,2}/\d{1,2}/\d{4}$')
        AND CAST(SPLIT_PART(approval_rejection_date, '/', 1) AS INTEGER) <= 31 
        AND CAST(SPLIT_PART(approval_rejection_date, '/', 2) AS INTEGER) <= 12 
        THEN TRY_CAST(STRPTIME(approval_rejection_date, '%d/%m/%Y') AS DATE)
        
    -- Try MM/DD/YYYY format (US format with slashes)
    WHEN REGEXP_MATCHES(approval_rejection_date, '^\d{1,2}/\d{1,2}/\d{4}$')
        AND CAST(SPLIT_PART(approval_rejection_date, '/', 1) AS INTEGER) <= 12 
        THEN TRY_CAST(STRPTIME(approval_rejection_date, '%m/%d/%Y') AS DATE)
        
    -- Try YYYY-MM-DD format (ISO format)
    WHEN REGEXP_MATCHES(approval_rejection_date, '^\d{4}-\d{1,2}-\d{1,2}$')
        THEN TRY_CAST(STRPTIME(approval_rejection_date, '%Y-%m-%d') AS DATE)
        
    -- Try generic date parsing as last resort
    ELSE TRY_CAST(approval_rejection_date AS DATE)
END
 as approval_rejection_date,
        approval_rejection_date as approval_rejection_date_raw,
        loan_status
    from source
),

final as (
    select
        customer_id,
        loan_id,
        loan_amount,
        loant_type as loan_type,
        interest_rate,
        loan_term,
        approval_rejection_date,
        loan_status,
        -- Flag records with date parsing issues
        CASE WHEN approval_rejection_date IS NULL AND approval_rejection_date_raw IS NOT NULL
             THEN TRUE ELSE FALSE 
        END as has_date_parsing_error
    from renamed
)

select * from final
  );

[0m02:28:27.102116 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:28:27.104114 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_raw_staging__loans"
[0m02:28:27.104335 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__loans: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_raw_staging__loans"} */
alter view "casestudy"."staging"."stg_raw_staging__loans" rename to "stg_raw_staging__loans__dbt_backup"
[0m02:28:27.104708 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:28:27.106250 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_raw_staging__loans"
[0m02:28:27.106449 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__loans: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_raw_staging__loans"} */
alter view "casestudy"."staging"."stg_raw_staging__loans__dbt_tmp" rename to "stg_raw_staging__loans"
[0m02:28:27.106788 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:28:27.107682 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__loans: COMMIT
[0m02:28:27.107875 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_raw_staging__loans"
[0m02:28:27.108036 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__loans: COMMIT
[0m02:28:27.109810 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:28:27.112117 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_raw_staging__loans"
[0m02:28:27.112326 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__loans: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_raw_staging__loans"} */
drop view if exists "casestudy"."staging"."stg_raw_staging__loans__dbt_backup" cascade
[0m02:28:27.113266 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:28:27.113984 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.stg_raw_staging__loans (execute): 02:28:27.089873 => 02:28:27.113886
[0m02:28:27.114171 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__loans: Close
[0m02:28:27.125408 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3aeec56f-ff13-44f7-96b5-c78c6b5fd01e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x740a703b7ed0>]}
[0m02:28:27.125935 [info ] [Thread-1 (]: 4 of 11 OK created sql view model staging.stg_raw_staging__loans ............... [[32mOK[0m in 0.04s]
[0m02:28:27.126411 [debug] [Thread-1 (]: Finished running node model.vg_casestudy.stg_raw_staging__loans
[0m02:28:27.126661 [debug] [Thread-1 (]: Began running node model.vg_casestudy.stg_raw_staging__transactions
[0m02:28:27.126942 [info ] [Thread-1 (]: 5 of 11 START sql view model staging.stg_raw_staging__transactions ............. [RUN]
[0m02:28:27.127348 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.vg_casestudy.stg_raw_staging__loans, now model.vg_casestudy.stg_raw_staging__transactions)
[0m02:28:27.127528 [debug] [Thread-1 (]: Began compiling node model.vg_casestudy.stg_raw_staging__transactions
[0m02:28:27.129509 [debug] [Thread-1 (]: Writing injected SQL for node "model.vg_casestudy.stg_raw_staging__transactions"
[0m02:28:27.129851 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.stg_raw_staging__transactions (compile): 02:28:27.127640 => 02:28:27.129737
[0m02:28:27.130030 [debug] [Thread-1 (]: Began executing node model.vg_casestudy.stg_raw_staging__transactions
[0m02:28:27.132007 [debug] [Thread-1 (]: Writing runtime sql for node "model.vg_casestudy.stg_raw_staging__transactions"
[0m02:28:27.132306 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_raw_staging__transactions"
[0m02:28:27.132484 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__transactions: BEGIN
[0m02:28:27.132642 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:28:27.139475 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:28:27.139715 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_raw_staging__transactions"
[0m02:28:27.139953 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__transactions: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_raw_staging__transactions"} */

  
  create view "casestudy"."staging"."stg_raw_staging__transactions__dbt_tmp" as (
    with source as (
    select * from "casestudy"."raw"."transactions"
),

renamed as (
    select
        transaction_id,
        
CASE
    -- First try DD.MM.YYYY format (German format with dots)
    WHEN REGEXP_MATCHES(transaction_date, '^\d{1,2}\.\d{1,2}\.\d{4}$') 
        THEN TRY_CAST(STRPTIME(transaction_date, '%d.%m.%Y') AS DATE)
        
    -- Then try DD/MM/YYYY format (with slashes)
    WHEN REGEXP_MATCHES(transaction_date, '^\d{1,2}/\d{1,2}/\d{4}$')
        AND CAST(SPLIT_PART(transaction_date, '/', 1) AS INTEGER) <= 31 
        AND CAST(SPLIT_PART(transaction_date, '/', 2) AS INTEGER) <= 12 
        THEN TRY_CAST(STRPTIME(transaction_date, '%d/%m/%Y') AS DATE)
        
    -- Try MM/DD/YYYY format (US format with slashes)
    WHEN REGEXP_MATCHES(transaction_date, '^\d{1,2}/\d{1,2}/\d{4}$')
        AND CAST(SPLIT_PART(transaction_date, '/', 1) AS INTEGER) <= 12 
        THEN TRY_CAST(STRPTIME(transaction_date, '%m/%d/%Y') AS DATE)
        
    -- Try YYYY-MM-DD format (ISO format)
    WHEN REGEXP_MATCHES(transaction_date, '^\d{4}-\d{1,2}-\d{1,2}$')
        THEN TRY_CAST(STRPTIME(transaction_date, '%Y-%m-%d') AS DATE)
        
    -- Try generic date parsing as last resort
    ELSE TRY_CAST(transaction_date AS DATE)
END
 as transaction_date,
        transaction_date as transaction_date_raw,
        account_id,
        trim(transaction_type) as transaction_type,
        
CASE
    WHEN transaction_amount IS NULL THEN NULL
    -- If the value is already a valid number
    WHEN TRY_CAST(transaction_amount AS DOUBLE) IS NOT NULL 
        THEN TRY_CAST(transaction_amount AS DOUBLE)
    -- If contains both dot and comma (German notation)
    WHEN POSITION('.' IN transaction_amount) > 0 AND POSITION(',' IN transaction_amount) > 0 
        THEN TRY_CAST(REPLACE(REPLACE(TRIM(transaction_amount), '.', ''), ',', '.') AS DOUBLE)
    -- If only contains comma, treat as decimal point
    WHEN POSITION(',' IN transaction_amount) > 0 
        THEN TRY_CAST(REPLACE(TRIM(transaction_amount), ',', '.') AS DOUBLE)
    -- If only contains dots, likely thousands separator
    WHEN POSITION('.' IN transaction_amount) > 0 
        THEN TRY_CAST(REPLACE(TRIM(transaction_amount), '.', '') AS DOUBLE)
    ELSE NULL
END
 as transaction_amount,
        trim(transaction_currency) as transaction_currency
    from source
),

final as (
    select
        transaction_id,
        transaction_date,
        account_id,
        transaction_type,
        transaction_amount,
        transaction_currency,
        -- Flag records with date parsing issues
        CASE WHEN transaction_date IS NULL AND transaction_date_raw IS NOT NULL
             THEN TRUE ELSE FALSE 
        END as has_date_parsing_error
    from renamed
)

select * from final
  );

[0m02:28:27.141007 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:28:27.143016 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_raw_staging__transactions"
[0m02:28:27.143253 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__transactions: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_raw_staging__transactions"} */
alter view "casestudy"."staging"."stg_raw_staging__transactions" rename to "stg_raw_staging__transactions__dbt_backup"
[0m02:28:27.143696 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:28:27.145425 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_raw_staging__transactions"
[0m02:28:27.145630 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__transactions: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_raw_staging__transactions"} */
alter view "casestudy"."staging"."stg_raw_staging__transactions__dbt_tmp" rename to "stg_raw_staging__transactions"
[0m02:28:27.145970 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:28:27.146831 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__transactions: COMMIT
[0m02:28:27.147022 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_raw_staging__transactions"
[0m02:28:27.147193 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__transactions: COMMIT
[0m02:28:27.149225 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:28:27.150558 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_raw_staging__transactions"
[0m02:28:27.150754 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__transactions: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_raw_staging__transactions"} */
drop view if exists "casestudy"."staging"."stg_raw_staging__transactions__dbt_backup" cascade
[0m02:28:27.151631 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:28:27.152353 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.stg_raw_staging__transactions (execute): 02:28:27.130158 => 02:28:27.152257
[0m02:28:27.152540 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__transactions: Close
[0m02:28:27.164850 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3aeec56f-ff13-44f7-96b5-c78c6b5fd01e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x740a703bef90>]}
[0m02:28:27.165377 [info ] [Thread-1 (]: 5 of 11 OK created sql view model staging.stg_raw_staging__transactions ........ [[32mOK[0m in 0.04s]
[0m02:28:27.165809 [debug] [Thread-1 (]: Finished running node model.vg_casestudy.stg_raw_staging__transactions
[0m02:28:27.166118 [debug] [Thread-1 (]: Began running node model.vg_casestudy.stg_staging_intermediate__currencies
[0m02:28:27.166541 [info ] [Thread-1 (]: 6 of 11 START sql table model intermediate.stg_staging_intermediate__currencies  [RUN]
[0m02:28:27.166907 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.vg_casestudy.stg_raw_staging__transactions, now model.vg_casestudy.stg_staging_intermediate__currencies)
[0m02:28:27.167102 [debug] [Thread-1 (]: Began compiling node model.vg_casestudy.stg_staging_intermediate__currencies
[0m02:28:27.168795 [debug] [Thread-1 (]: Writing injected SQL for node "model.vg_casestudy.stg_staging_intermediate__currencies"
[0m02:28:27.169144 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.stg_staging_intermediate__currencies (compile): 02:28:27.167238 => 02:28:27.169022
[0m02:28:27.169330 [debug] [Thread-1 (]: Began executing node model.vg_casestudy.stg_staging_intermediate__currencies
[0m02:28:27.179730 [debug] [Thread-1 (]: Writing runtime sql for node "model.vg_casestudy.stg_staging_intermediate__currencies"
[0m02:28:27.180105 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__currencies"
[0m02:28:27.180316 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__currencies: BEGIN
[0m02:28:27.180489 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:28:27.187886 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:28:27.188153 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__currencies"
[0m02:28:27.188344 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__currencies: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_staging_intermediate__currencies"} */

  
    
    

    create  table
      "casestudy"."intermediate"."stg_staging_intermediate__currencies__dbt_tmp"
  
    as (
      with staging as (
    select * from "casestudy"."raw"."currencies"
),
cleaned as (
    select distinct
        trim(currency) as currency,
        trim(currency_iso_code) as currency_iso_code,
    from staging
    where currency_iso_code is not null and trim(currency_iso_code) != '(none)'
)

select * from cleaned
    );
  
  
[0m02:28:27.190506 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:28:27.192295 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__currencies"
[0m02:28:27.192501 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__currencies: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_staging_intermediate__currencies"} */
alter table "casestudy"."intermediate"."stg_staging_intermediate__currencies" rename to "stg_staging_intermediate__currencies__dbt_backup"
[0m02:28:27.192836 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:28:27.195272 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__currencies"
[0m02:28:27.195478 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__currencies: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_staging_intermediate__currencies"} */
alter table "casestudy"."intermediate"."stg_staging_intermediate__currencies__dbt_tmp" rename to "stg_staging_intermediate__currencies"
[0m02:28:27.195889 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:28:27.198766 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__currencies: COMMIT
[0m02:28:27.198973 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__currencies"
[0m02:28:27.199159 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__currencies: COMMIT
[0m02:28:27.200552 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:28:27.201857 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__currencies"
[0m02:28:27.202055 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__currencies: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_staging_intermediate__currencies"} */
drop table if exists "casestudy"."intermediate"."stg_staging_intermediate__currencies__dbt_backup" cascade
[0m02:28:27.203010 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:28:27.203717 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.stg_staging_intermediate__currencies (execute): 02:28:27.169448 => 02:28:27.203621
[0m02:28:27.203903 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__currencies: Close
[0m02:28:27.217949 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3aeec56f-ff13-44f7-96b5-c78c6b5fd01e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x740a70074390>]}
[0m02:28:27.218318 [info ] [Thread-1 (]: 6 of 11 OK created sql table model intermediate.stg_staging_intermediate__currencies  [[32mOK[0m in 0.05s]
[0m02:28:27.218619 [debug] [Thread-1 (]: Finished running node model.vg_casestudy.stg_staging_intermediate__currencies
[0m02:28:27.218828 [debug] [Thread-1 (]: Began running node model.vg_casestudy.stg_staging_intermediate__accounts
[0m02:28:27.219130 [info ] [Thread-1 (]: 7 of 11 START sql table model intermediate.stg_staging_intermediate__accounts .. [RUN]
[0m02:28:27.219459 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.vg_casestudy.stg_staging_intermediate__currencies, now model.vg_casestudy.stg_staging_intermediate__accounts)
[0m02:28:27.219646 [debug] [Thread-1 (]: Began compiling node model.vg_casestudy.stg_staging_intermediate__accounts
[0m02:28:27.221303 [debug] [Thread-1 (]: Writing injected SQL for node "model.vg_casestudy.stg_staging_intermediate__accounts"
[0m02:28:27.221641 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.stg_staging_intermediate__accounts (compile): 02:28:27.219763 => 02:28:27.221529
[0m02:28:27.221821 [debug] [Thread-1 (]: Began executing node model.vg_casestudy.stg_staging_intermediate__accounts
[0m02:28:27.223796 [debug] [Thread-1 (]: Writing runtime sql for node "model.vg_casestudy.stg_staging_intermediate__accounts"
[0m02:28:27.224088 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__accounts"
[0m02:28:27.224287 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__accounts: BEGIN
[0m02:28:27.224450 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:28:27.231737 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:28:27.232110 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__accounts"
[0m02:28:27.232365 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__accounts: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_staging_intermediate__accounts"} */

  
    
    

    create  table
      "casestudy"."intermediate"."stg_staging_intermediate__accounts__dbt_tmp"
  
    as (
      with staging as (
    select * from "casestudy"."staging"."stg_raw_staging__accounts"
), 
filtered as (
    select 
        account_id,
        customer_id,
        account_type,
        account_opening_date,
     from staging
    where not has_date_parsing_error
)

select * from filtered
    );
  
  
[0m02:28:27.236328 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:28:27.238421 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__accounts"
[0m02:28:27.238636 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__accounts: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_staging_intermediate__accounts"} */
alter table "casestudy"."intermediate"."stg_staging_intermediate__accounts" rename to "stg_staging_intermediate__accounts__dbt_backup"
[0m02:28:27.238992 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:28:27.240584 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__accounts"
[0m02:28:27.240797 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__accounts: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_staging_intermediate__accounts"} */
alter table "casestudy"."intermediate"."stg_staging_intermediate__accounts__dbt_tmp" rename to "stg_staging_intermediate__accounts"
[0m02:28:27.241191 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:28:27.242155 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__accounts: COMMIT
[0m02:28:27.242357 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__accounts"
[0m02:28:27.242536 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__accounts: COMMIT
[0m02:28:27.244038 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:28:27.245385 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__accounts"
[0m02:28:27.245587 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__accounts: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_staging_intermediate__accounts"} */
drop table if exists "casestudy"."intermediate"."stg_staging_intermediate__accounts__dbt_backup" cascade
[0m02:28:27.246521 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:28:27.247292 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.stg_staging_intermediate__accounts (execute): 02:28:27.221935 => 02:28:27.247188
[0m02:28:27.247489 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__accounts: Close
[0m02:28:27.259816 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3aeec56f-ff13-44f7-96b5-c78c6b5fd01e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x740a70427710>]}
[0m02:28:27.260238 [info ] [Thread-1 (]: 7 of 11 OK created sql table model intermediate.stg_staging_intermediate__accounts  [[32mOK[0m in 0.04s]
[0m02:28:27.260558 [debug] [Thread-1 (]: Finished running node model.vg_casestudy.stg_staging_intermediate__accounts
[0m02:28:27.260790 [debug] [Thread-1 (]: Began running node model.vg_casestudy.stg_staging_intermediate__customers
[0m02:28:27.261101 [info ] [Thread-1 (]: 8 of 11 START sql table model intermediate.stg_staging_intermediate__customers . [RUN]
[0m02:28:27.261467 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.vg_casestudy.stg_staging_intermediate__accounts, now model.vg_casestudy.stg_staging_intermediate__customers)
[0m02:28:27.261672 [debug] [Thread-1 (]: Began compiling node model.vg_casestudy.stg_staging_intermediate__customers
[0m02:28:27.263528 [debug] [Thread-1 (]: Writing injected SQL for node "model.vg_casestudy.stg_staging_intermediate__customers"
[0m02:28:27.263908 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.stg_staging_intermediate__customers (compile): 02:28:27.261796 => 02:28:27.263785
[0m02:28:27.264089 [debug] [Thread-1 (]: Began executing node model.vg_casestudy.stg_staging_intermediate__customers
[0m02:28:27.266187 [debug] [Thread-1 (]: Writing runtime sql for node "model.vg_casestudy.stg_staging_intermediate__customers"
[0m02:28:27.266495 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__customers"
[0m02:28:27.266689 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__customers: BEGIN
[0m02:28:27.266877 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:28:27.274276 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:28:27.274519 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__customers"
[0m02:28:27.274708 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__customers: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_staging_intermediate__customers"} */

  
    
    

    create  table
      "casestudy"."intermediate"."stg_staging_intermediate__customers__dbt_tmp"
  
    as (
      with staging as (
    select * from "casestudy"."staging"."stg_raw_staging__customers"
)

select * from staging
    );
  
  
[0m02:28:27.279828 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:28:27.282751 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__customers"
[0m02:28:27.282966 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__customers: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_staging_intermediate__customers"} */
alter table "casestudy"."intermediate"."stg_staging_intermediate__customers" rename to "stg_staging_intermediate__customers__dbt_backup"
[0m02:28:27.283332 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:28:27.284903 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__customers"
[0m02:28:27.285114 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__customers: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_staging_intermediate__customers"} */
alter table "casestudy"."intermediate"."stg_staging_intermediate__customers__dbt_tmp" rename to "stg_staging_intermediate__customers"
[0m02:28:27.285501 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:28:27.286458 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__customers: COMMIT
[0m02:28:27.286657 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__customers"
[0m02:28:27.286829 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__customers: COMMIT
[0m02:28:27.288684 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:28:27.290111 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__customers"
[0m02:28:27.290377 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__customers: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_staging_intermediate__customers"} */
drop table if exists "casestudy"."intermediate"."stg_staging_intermediate__customers__dbt_backup" cascade
[0m02:28:27.291695 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:28:27.292474 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.stg_staging_intermediate__customers (execute): 02:28:27.264217 => 02:28:27.292375
[0m02:28:27.292671 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__customers: Close
[0m02:28:27.311926 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3aeec56f-ff13-44f7-96b5-c78c6b5fd01e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x740a70095ed0>]}
[0m02:28:27.312353 [info ] [Thread-1 (]: 8 of 11 OK created sql table model intermediate.stg_staging_intermediate__customers  [[32mOK[0m in 0.05s]
[0m02:28:27.312669 [debug] [Thread-1 (]: Finished running node model.vg_casestudy.stg_staging_intermediate__customers
[0m02:28:27.312889 [debug] [Thread-1 (]: Began running node model.vg_casestudy.stg_staging_intermediate__fx_rates
[0m02:28:27.313188 [info ] [Thread-1 (]: 9 of 11 START sql table model intermediate.stg_staging_intermediate__fx_rates .. [RUN]
[0m02:28:27.313541 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.vg_casestudy.stg_staging_intermediate__customers, now model.vg_casestudy.stg_staging_intermediate__fx_rates)
[0m02:28:27.313733 [debug] [Thread-1 (]: Began compiling node model.vg_casestudy.stg_staging_intermediate__fx_rates
[0m02:28:27.315456 [debug] [Thread-1 (]: Writing injected SQL for node "model.vg_casestudy.stg_staging_intermediate__fx_rates"
[0m02:28:27.315800 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.stg_staging_intermediate__fx_rates (compile): 02:28:27.313851 => 02:28:27.315686
[0m02:28:27.315983 [debug] [Thread-1 (]: Began executing node model.vg_casestudy.stg_staging_intermediate__fx_rates
[0m02:28:27.317996 [debug] [Thread-1 (]: Writing runtime sql for node "model.vg_casestudy.stg_staging_intermediate__fx_rates"
[0m02:28:27.318298 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__fx_rates"
[0m02:28:27.318478 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__fx_rates: BEGIN
[0m02:28:27.318640 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:28:27.326050 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:28:27.326380 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__fx_rates"
[0m02:28:27.326598 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__fx_rates: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_staging_intermediate__fx_rates"} */

  
    
    

    create  table
      "casestudy"."intermediate"."stg_staging_intermediate__fx_rates__dbt_tmp"
  
    as (
      with staging as (
    select * from "casestudy"."staging"."stg_raw_staging__fx_rates"
),

filtered as (
    select
        currency_iso_code,
        fx_rate,
        fx_rate_date
    from staging
    where not has_date_parsing_error
)

select * from filtered
    );
  
  
[0m02:28:27.328999 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:28:27.330871 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__fx_rates"
[0m02:28:27.331080 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__fx_rates: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_staging_intermediate__fx_rates"} */
alter table "casestudy"."intermediate"."stg_staging_intermediate__fx_rates" rename to "stg_staging_intermediate__fx_rates__dbt_backup"
[0m02:28:27.331498 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:28:27.333080 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__fx_rates"
[0m02:28:27.333295 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__fx_rates: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_staging_intermediate__fx_rates"} */
alter table "casestudy"."intermediate"."stg_staging_intermediate__fx_rates__dbt_tmp" rename to "stg_staging_intermediate__fx_rates"
[0m02:28:27.333628 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:28:27.334583 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__fx_rates: COMMIT
[0m02:28:27.334782 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__fx_rates"
[0m02:28:27.334954 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__fx_rates: COMMIT
[0m02:28:27.336413 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:28:27.337792 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__fx_rates"
[0m02:28:27.337994 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__fx_rates: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_staging_intermediate__fx_rates"} */
drop table if exists "casestudy"."intermediate"."stg_staging_intermediate__fx_rates__dbt_backup" cascade
[0m02:28:27.339192 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:28:27.339927 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.stg_staging_intermediate__fx_rates (execute): 02:28:27.316100 => 02:28:27.339828
[0m02:28:27.340119 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__fx_rates: Close
[0m02:28:27.352291 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3aeec56f-ff13-44f7-96b5-c78c6b5fd01e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x740a70559110>]}
[0m02:28:27.352684 [info ] [Thread-1 (]: 9 of 11 OK created sql table model intermediate.stg_staging_intermediate__fx_rates  [[32mOK[0m in 0.04s]
[0m02:28:27.352987 [debug] [Thread-1 (]: Finished running node model.vg_casestudy.stg_staging_intermediate__fx_rates
[0m02:28:27.353207 [debug] [Thread-1 (]: Began running node model.vg_casestudy.stg_staging_intermediate__loans
[0m02:28:27.353498 [info ] [Thread-1 (]: 10 of 11 START sql table model intermediate.stg_staging_intermediate__loans .... [RUN]
[0m02:28:27.353840 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.vg_casestudy.stg_staging_intermediate__fx_rates, now model.vg_casestudy.stg_staging_intermediate__loans)
[0m02:28:27.354029 [debug] [Thread-1 (]: Began compiling node model.vg_casestudy.stg_staging_intermediate__loans
[0m02:28:27.355741 [debug] [Thread-1 (]: Writing injected SQL for node "model.vg_casestudy.stg_staging_intermediate__loans"
[0m02:28:27.356079 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.stg_staging_intermediate__loans (compile): 02:28:27.354158 => 02:28:27.355965
[0m02:28:27.356268 [debug] [Thread-1 (]: Began executing node model.vg_casestudy.stg_staging_intermediate__loans
[0m02:28:27.359332 [debug] [Thread-1 (]: Writing runtime sql for node "model.vg_casestudy.stg_staging_intermediate__loans"
[0m02:28:27.359629 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__loans"
[0m02:28:27.359808 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__loans: BEGIN
[0m02:28:27.359968 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:28:27.366972 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:28:27.367216 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__loans"
[0m02:28:27.367409 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__loans: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_staging_intermediate__loans"} */

  
    
    

    create  table
      "casestudy"."intermediate"."stg_staging_intermediate__loans__dbt_tmp"
  
    as (
      with staging as (
    select * from "casestudy"."staging"."stg_raw_staging__loans"
),

filtered as (
    select
        customer_id,
        loan_id,
        loan_amount,
        loan_type,
        interest_rate,
        loan_term,
        approval_rejection_date,
        loan_status
    from staging
    where not has_date_parsing_error
)

select * from filtered
    );
  
  
[0m02:28:27.376255 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:28:27.378504 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__loans"
[0m02:28:27.378753 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__loans: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_staging_intermediate__loans"} */
alter table "casestudy"."intermediate"."stg_staging_intermediate__loans" rename to "stg_staging_intermediate__loans__dbt_backup"
[0m02:28:27.379158 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:28:27.380754 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__loans"
[0m02:28:27.380959 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__loans: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_staging_intermediate__loans"} */
alter table "casestudy"."intermediate"."stg_staging_intermediate__loans__dbt_tmp" rename to "stg_staging_intermediate__loans"
[0m02:28:27.381301 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:28:27.382252 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__loans: COMMIT
[0m02:28:27.382462 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__loans"
[0m02:28:27.382637 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__loans: COMMIT
[0m02:28:27.384456 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:28:27.385853 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__loans"
[0m02:28:27.386058 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__loans: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_staging_intermediate__loans"} */
drop table if exists "casestudy"."intermediate"."stg_staging_intermediate__loans__dbt_backup" cascade
[0m02:28:27.386972 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:28:27.387697 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.stg_staging_intermediate__loans (execute): 02:28:27.356385 => 02:28:27.387600
[0m02:28:27.387889 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__loans: Close
[0m02:28:27.401998 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3aeec56f-ff13-44f7-96b5-c78c6b5fd01e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x740a70076c50>]}
[0m02:28:27.402403 [info ] [Thread-1 (]: 10 of 11 OK created sql table model intermediate.stg_staging_intermediate__loans  [[32mOK[0m in 0.05s]
[0m02:28:27.402709 [debug] [Thread-1 (]: Finished running node model.vg_casestudy.stg_staging_intermediate__loans
[0m02:28:27.402924 [debug] [Thread-1 (]: Began running node model.vg_casestudy.stg_staging_intermediate__transactions
[0m02:28:27.403217 [info ] [Thread-1 (]: 11 of 11 START sql table model intermediate.stg_staging_intermediate__transactions  [RUN]
[0m02:28:27.403551 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.vg_casestudy.stg_staging_intermediate__loans, now model.vg_casestudy.stg_staging_intermediate__transactions)
[0m02:28:27.403741 [debug] [Thread-1 (]: Began compiling node model.vg_casestudy.stg_staging_intermediate__transactions
[0m02:28:27.405445 [debug] [Thread-1 (]: Writing injected SQL for node "model.vg_casestudy.stg_staging_intermediate__transactions"
[0m02:28:27.405793 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.stg_staging_intermediate__transactions (compile): 02:28:27.403858 => 02:28:27.405679
[0m02:28:27.405971 [debug] [Thread-1 (]: Began executing node model.vg_casestudy.stg_staging_intermediate__transactions
[0m02:28:27.407899 [debug] [Thread-1 (]: Writing runtime sql for node "model.vg_casestudy.stg_staging_intermediate__transactions"
[0m02:28:27.408209 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__transactions"
[0m02:28:27.408395 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__transactions: BEGIN
[0m02:28:27.408554 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:28:27.416330 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:28:27.416658 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__transactions"
[0m02:28:27.416861 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__transactions: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_staging_intermediate__transactions"} */

  
    
    

    create  table
      "casestudy"."intermediate"."stg_staging_intermediate__transactions__dbt_tmp"
  
    as (
      with staging as (
    select * from "casestudy"."staging"."stg_raw_staging__transactions"
),

filtered as (
    select
        transaction_id,
        transaction_date,
        account_id,
        transaction_type,
        transaction_amount,
        transaction_currency
    from staging
    where not has_date_parsing_error
)

select * from filtered
    );
  
  
[0m02:28:27.455847 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:28:27.458099 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__transactions"
[0m02:28:27.458324 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__transactions: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_staging_intermediate__transactions"} */
alter table "casestudy"."intermediate"."stg_staging_intermediate__transactions" rename to "stg_staging_intermediate__transactions__dbt_backup"
[0m02:28:27.458760 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:28:27.460480 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__transactions"
[0m02:28:27.460775 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__transactions: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_staging_intermediate__transactions"} */
alter table "casestudy"."intermediate"."stg_staging_intermediate__transactions__dbt_tmp" rename to "stg_staging_intermediate__transactions"
[0m02:28:27.461232 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:28:27.462253 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__transactions: COMMIT
[0m02:28:27.462449 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__transactions"
[0m02:28:27.462617 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__transactions: COMMIT
[0m02:28:27.467662 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:28:27.469100 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__transactions"
[0m02:28:27.469309 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__transactions: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_staging_intermediate__transactions"} */
drop table if exists "casestudy"."intermediate"."stg_staging_intermediate__transactions__dbt_backup" cascade
[0m02:28:27.470257 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:28:27.471001 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.stg_staging_intermediate__transactions (execute): 02:28:27.406085 => 02:28:27.470903
[0m02:28:27.471194 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__transactions: Close
[0m02:28:27.494900 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3aeec56f-ff13-44f7-96b5-c78c6b5fd01e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x740a70077850>]}
[0m02:28:27.495278 [info ] [Thread-1 (]: 11 of 11 OK created sql table model intermediate.stg_staging_intermediate__transactions  [[32mOK[0m in 0.09s]
[0m02:28:27.495577 [debug] [Thread-1 (]: Finished running node model.vg_casestudy.stg_staging_intermediate__transactions
[0m02:28:27.496658 [debug] [MainThread]: Using duckdb connection "master"
[0m02:28:27.496834 [debug] [MainThread]: On master: BEGIN
[0m02:28:27.496974 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:28:27.504383 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m02:28:27.504584 [debug] [MainThread]: On master: COMMIT
[0m02:28:27.504731 [debug] [MainThread]: Using duckdb connection "master"
[0m02:28:27.504867 [debug] [MainThread]: On master: COMMIT
[0m02:28:27.505183 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m02:28:27.505350 [debug] [MainThread]: On master: Close
[0m02:28:27.506805 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:28:27.506983 [debug] [MainThread]: Connection 'list_casestudy_intermediate' was properly closed.
[0m02:28:27.507121 [debug] [MainThread]: Connection 'model.vg_casestudy.stg_staging_intermediate__transactions' was properly closed.
[0m02:28:27.507346 [info ] [MainThread]: 
[0m02:28:27.507523 [info ] [MainThread]: Finished running 5 view models, 6 table models in 0 hours 0 minutes and 0.77 seconds (0.77s).
[0m02:28:27.508433 [debug] [MainThread]: Command end result
[0m02:28:27.519635 [info ] [MainThread]: 
[0m02:28:27.519924 [info ] [MainThread]: [32mCompleted successfully[0m
[0m02:28:27.520090 [info ] [MainThread]: 
[0m02:28:27.520262 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=0 SKIP=0 TOTAL=11
[0m02:28:27.520519 [debug] [MainThread]: Command `dbt run` succeeded at 02:28:27.520460 after 0.91 seconds
[0m02:28:27.520712 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x740a7909da50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x740a7909c990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x740a7909dbd0>]}
[0m02:28:27.520899 [debug] [MainThread]: Flushing usage events
[0m02:30:08.370277 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c7a2fe22050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c7a3015bb10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c7a301921d0>]}


============================== 02:30:08.373198 | f9c6553f-5fe9-4ba1-91f8-90d6cbeef8c8 ==============================
[0m02:30:08.373198 [info ] [MainThread]: Running with dbt=1.6.18
[0m02:30:08.373791 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/workspaces/varengold_data_analyst_case/transformation/logs', 'profiles_dir': '/workspaces/varengold_data_analyst_case/transformation', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --full-refresh', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m02:30:08.431087 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f9c6553f-5fe9-4ba1-91f8-90d6cbeef8c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c7a3017d9d0>]}
[0m02:30:08.439068 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f9c6553f-5fe9-4ba1-91f8-90d6cbeef8c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c7a2fe38910>]}
[0m02:30:08.439522 [info ] [MainThread]: Registered adapter: duckdb=1.6.2
[0m02:30:08.452314 [debug] [MainThread]: checksum: 7b9fab86a08e9e96a48a825af743c566d95b877e068b8c6d0dbafbf714447189, vars: {}, profile: , target: , version: 1.6.18
[0m02:30:08.474361 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m02:30:08.474642 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m02:30:08.475348 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.vg_casestudy.reporting
- models.vg_casestudy.marts
- models.vg_casestudy.main
[0m02:30:08.479227 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f9c6553f-5fe9-4ba1-91f8-90d6cbeef8c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c7a2fbc8350>]}
[0m02:30:08.494021 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f9c6553f-5fe9-4ba1-91f8-90d6cbeef8c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c7a2c4d2850>]}
[0m02:30:08.494400 [info ] [MainThread]: Found 11 models, 1 analysis, 2 seeds, 71 tests, 5 sources, 0 exposures, 0 metrics, 632 macros, 0 groups, 0 semantic models
[0m02:30:08.494601 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f9c6553f-5fe9-4ba1-91f8-90d6cbeef8c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c7a2b97bd50>]}
[0m02:30:08.496366 [info ] [MainThread]: 
[0m02:30:08.496819 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m02:30:08.498164 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_casestudy'
[0m02:30:08.511218 [debug] [ThreadPool]: Using duckdb connection "list_casestudy"
[0m02:30:08.511459 [debug] [ThreadPool]: On list_casestudy: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"casestudy"'
    
  
  
[0m02:30:08.511628 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:30:08.521724 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m02:30:08.522630 [debug] [ThreadPool]: On list_casestudy: Close
[0m02:30:08.526828 [debug] [ThreadPool]: Using duckdb connection "list_casestudy"
[0m02:30:08.527145 [debug] [ThreadPool]: On list_casestudy: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"casestudy"'
    
  
  
[0m02:30:08.527345 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:30:08.534731 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m02:30:08.535548 [debug] [ThreadPool]: On list_casestudy: Close
[0m02:30:08.538415 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy, now create_casestudy_intermediate)
[0m02:30:08.538937 [debug] [ThreadPool]: Creating schema "database: "casestudy"
schema: "intermediate"
"
[0m02:30:08.541668 [debug] [ThreadPool]: Using duckdb connection "create_casestudy_intermediate"
[0m02:30:08.541854 [debug] [ThreadPool]: On create_casestudy_intermediate: BEGIN
[0m02:30:08.541995 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:30:08.548718 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m02:30:08.548913 [debug] [ThreadPool]: Using duckdb connection "create_casestudy_intermediate"
[0m02:30:08.549067 [debug] [ThreadPool]: On create_casestudy_intermediate: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "create_casestudy_intermediate"} */
create schema if not exists "casestudy"."intermediate"
[0m02:30:08.549412 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m02:30:08.549905 [debug] [ThreadPool]: On create_casestudy_intermediate: COMMIT
[0m02:30:08.550069 [debug] [ThreadPool]: Using duckdb connection "create_casestudy_intermediate"
[0m02:30:08.550218 [debug] [ThreadPool]: On create_casestudy_intermediate: COMMIT
[0m02:30:08.550460 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m02:30:08.550621 [debug] [ThreadPool]: On create_casestudy_intermediate: Close
[0m02:30:08.552510 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_casestudy_intermediate, now create_casestudy_staging)
[0m02:30:08.552898 [debug] [ThreadPool]: Creating schema "database: "casestudy"
schema: "staging"
"
[0m02:30:08.554388 [debug] [ThreadPool]: Using duckdb connection "create_casestudy_staging"
[0m02:30:08.554906 [debug] [ThreadPool]: On create_casestudy_staging: BEGIN
[0m02:30:08.555174 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:30:08.561856 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m02:30:08.562048 [debug] [ThreadPool]: Using duckdb connection "create_casestudy_staging"
[0m02:30:08.562210 [debug] [ThreadPool]: On create_casestudy_staging: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "create_casestudy_staging"} */
create schema if not exists "casestudy"."staging"
[0m02:30:08.562491 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m02:30:08.562983 [debug] [ThreadPool]: On create_casestudy_staging: COMMIT
[0m02:30:08.563152 [debug] [ThreadPool]: Using duckdb connection "create_casestudy_staging"
[0m02:30:08.563295 [debug] [ThreadPool]: On create_casestudy_staging: COMMIT
[0m02:30:08.563537 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m02:30:08.563705 [debug] [ThreadPool]: On create_casestudy_staging: Close
[0m02:30:08.566593 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_casestudy_staging, now list_casestudy_intermediate)
[0m02:30:08.572175 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_intermediate"
[0m02:30:08.572357 [debug] [ThreadPool]: On list_casestudy_intermediate: BEGIN
[0m02:30:08.572500 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:30:08.578954 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m02:30:08.579147 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_intermediate"
[0m02:30:08.579306 [debug] [ThreadPool]: On list_casestudy_intermediate: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_intermediate"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'intermediate'
    and table_catalog = 'casestudy'
  
[0m02:30:08.586172 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m02:30:08.586950 [debug] [ThreadPool]: On list_casestudy_intermediate: ROLLBACK
[0m02:30:08.587388 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_intermediate'
[0m02:30:08.587555 [debug] [ThreadPool]: On list_casestudy_intermediate: Close
[0m02:30:08.590271 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy_intermediate, now list_casestudy_raw)
[0m02:30:08.593699 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_raw"
[0m02:30:08.594041 [debug] [ThreadPool]: On list_casestudy_raw: BEGIN
[0m02:30:08.594326 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:30:08.603506 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m02:30:08.603748 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_raw"
[0m02:30:08.603917 [debug] [ThreadPool]: On list_casestudy_raw: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_raw"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'raw'
    and table_catalog = 'casestudy'
  
[0m02:30:08.609661 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m02:30:08.610445 [debug] [ThreadPool]: On list_casestudy_raw: ROLLBACK
[0m02:30:08.610733 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_raw'
[0m02:30:08.610894 [debug] [ThreadPool]: On list_casestudy_raw: Close
[0m02:30:08.612942 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy_raw, now list_casestudy_staging)
[0m02:30:08.615566 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_staging"
[0m02:30:08.615737 [debug] [ThreadPool]: On list_casestudy_staging: BEGIN
[0m02:30:08.615875 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:30:08.622815 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m02:30:08.623004 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_staging"
[0m02:30:08.623169 [debug] [ThreadPool]: On list_casestudy_staging: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_staging"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'staging'
    and table_catalog = 'casestudy'
  
[0m02:30:08.629909 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m02:30:08.630612 [debug] [ThreadPool]: On list_casestudy_staging: ROLLBACK
[0m02:30:08.630864 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_staging'
[0m02:30:08.631011 [debug] [ThreadPool]: On list_casestudy_staging: Close
[0m02:30:08.633982 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f9c6553f-5fe9-4ba1-91f8-90d6cbeef8c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c7a3016d590>]}
[0m02:30:08.634541 [debug] [MainThread]: Using duckdb connection "master"
[0m02:30:08.634889 [debug] [MainThread]: On master: BEGIN
[0m02:30:08.635220 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:30:08.643064 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m02:30:08.643268 [debug] [MainThread]: On master: COMMIT
[0m02:30:08.643421 [debug] [MainThread]: Using duckdb connection "master"
[0m02:30:08.643564 [debug] [MainThread]: On master: COMMIT
[0m02:30:08.643789 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m02:30:08.643951 [debug] [MainThread]: On master: Close
[0m02:30:08.645310 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:30:08.645514 [info ] [MainThread]: 
[0m02:30:08.646997 [debug] [Thread-1 (]: Began running node model.vg_casestudy.stg_raw_staging__accounts
[0m02:30:08.647545 [info ] [Thread-1 (]: 1 of 11 START sql view model staging.stg_raw_staging__accounts ................. [RUN]
[0m02:30:08.648402 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.vg_casestudy.stg_raw_staging__accounts'
[0m02:30:08.648892 [debug] [Thread-1 (]: Began compiling node model.vg_casestudy.stg_raw_staging__accounts
[0m02:30:08.655436 [debug] [Thread-1 (]: Writing injected SQL for node "model.vg_casestudy.stg_raw_staging__accounts"
[0m02:30:08.655820 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.stg_raw_staging__accounts (compile): 02:30:08.649196 => 02:30:08.655706
[0m02:30:08.656015 [debug] [Thread-1 (]: Began executing node model.vg_casestudy.stg_raw_staging__accounts
[0m02:30:08.676423 [debug] [Thread-1 (]: Writing runtime sql for node "model.vg_casestudy.stg_raw_staging__accounts"
[0m02:30:08.676871 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_raw_staging__accounts"
[0m02:30:08.677094 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__accounts: BEGIN
[0m02:30:08.677286 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m02:30:08.685327 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:30:08.685568 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_raw_staging__accounts"
[0m02:30:08.685809 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__accounts: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_raw_staging__accounts"} */

  
  create view "casestudy"."staging"."stg_raw_staging__accounts__dbt_tmp" as (
    with source as (
    select * from "casestudy"."raw"."accounts"
),

renamed as (
    select
        account_id,
        customer_id,
        account_type,
        
CASE
    -- First try DD.MM.YYYY format (German format with dots)
    WHEN REGEXP_MATCHES(account_opening_date, '^\d{1,2}\.\d{1,2}\.\d{4}$') 
        THEN TRY_CAST(STRPTIME(account_opening_date, '%d.%m.%Y') AS DATE)
        
    -- Then try DD/MM/YYYY format (with slashes)
    WHEN REGEXP_MATCHES(account_opening_date, '^\d{1,2}/\d{1,2}/\d{4}$')
        AND CAST(SPLIT_PART(account_opening_date, '/', 1) AS INTEGER) <= 31 
        AND CAST(SPLIT_PART(account_opening_date, '/', 2) AS INTEGER) <= 12 
        THEN TRY_CAST(STRPTIME(account_opening_date, '%d/%m/%Y') AS DATE)
        
    -- Try MM/DD/YYYY format (US format with slashes)
    WHEN REGEXP_MATCHES(account_opening_date, '^\d{1,2}/\d{1,2}/\d{4}$')
        AND CAST(SPLIT_PART(account_opening_date, '/', 1) AS INTEGER) <= 12 
        THEN TRY_CAST(STRPTIME(account_opening_date, '%m/%d/%Y') AS DATE)
        
    -- Try YYYY-MM-DD format (ISO format)
    WHEN REGEXP_MATCHES(account_opening_date, '^\d{4}-\d{1,2}-\d{1,2}$')
        THEN TRY_CAST(STRPTIME(account_opening_date, '%Y-%m-%d') AS DATE)
        
    -- Try generic date parsing as last resort
    ELSE TRY_CAST(account_opening_date AS DATE)
END
 as account_opening_date,
        account_opening_date as account_opening_date_raw
    from source
    where account_type is not null and account_type != '' and account_type != '-'
),

final as (
    select
        account_id,
        customer_id,
        account_type,
        account_opening_date,
        -- Flag records with date parsing issues
        CASE WHEN account_opening_date IS NULL AND account_opening_date_raw IS NOT NULL
             THEN TRUE ELSE FALSE 
        END as has_date_parsing_error
    from renamed
)

select * from final
  );

[0m02:30:08.686816 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:30:08.728316 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_raw_staging__accounts"
[0m02:30:08.728654 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__accounts: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_raw_staging__accounts"} */
alter view "casestudy"."staging"."stg_raw_staging__accounts" rename to "stg_raw_staging__accounts__dbt_backup"
[0m02:30:08.729368 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:30:08.731361 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_raw_staging__accounts"
[0m02:30:08.731626 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__accounts: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_raw_staging__accounts"} */
alter view "casestudy"."staging"."stg_raw_staging__accounts__dbt_tmp" rename to "stg_raw_staging__accounts"
[0m02:30:08.732214 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:30:08.741888 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__accounts: COMMIT
[0m02:30:08.742182 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_raw_staging__accounts"
[0m02:30:08.742395 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__accounts: COMMIT
[0m02:30:08.744383 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:30:08.747319 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_raw_staging__accounts"
[0m02:30:08.747549 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__accounts: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_raw_staging__accounts"} */
drop view if exists "casestudy"."staging"."stg_raw_staging__accounts__dbt_backup" cascade
[0m02:30:08.748588 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:30:08.749486 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.stg_raw_staging__accounts (execute): 02:30:08.656145 => 02:30:08.749386
[0m02:30:08.749707 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__accounts: Close
[0m02:30:08.761876 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f9c6553f-5fe9-4ba1-91f8-90d6cbeef8c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c7a2b9bd190>]}
[0m02:30:08.762275 [info ] [Thread-1 (]: 1 of 11 OK created sql view model staging.stg_raw_staging__accounts ............ [[32mOK[0m in 0.11s]
[0m02:30:08.762605 [debug] [Thread-1 (]: Finished running node model.vg_casestudy.stg_raw_staging__accounts
[0m02:30:08.762839 [debug] [Thread-1 (]: Began running node model.vg_casestudy.stg_raw_staging__customers
[0m02:30:08.763073 [info ] [Thread-1 (]: 2 of 11 START sql view model staging.stg_raw_staging__customers ................ [RUN]
[0m02:30:08.763437 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.vg_casestudy.stg_raw_staging__accounts, now model.vg_casestudy.stg_raw_staging__customers)
[0m02:30:08.763757 [debug] [Thread-1 (]: Began compiling node model.vg_casestudy.stg_raw_staging__customers
[0m02:30:08.765482 [debug] [Thread-1 (]: Writing injected SQL for node "model.vg_casestudy.stg_raw_staging__customers"
[0m02:30:08.765866 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.stg_raw_staging__customers (compile): 02:30:08.763962 => 02:30:08.765744
[0m02:30:08.766065 [debug] [Thread-1 (]: Began executing node model.vg_casestudy.stg_raw_staging__customers
[0m02:30:08.768180 [debug] [Thread-1 (]: Writing runtime sql for node "model.vg_casestudy.stg_raw_staging__customers"
[0m02:30:08.768498 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_raw_staging__customers"
[0m02:30:08.768693 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__customers: BEGIN
[0m02:30:08.768875 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:30:08.776187 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:30:08.776591 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_raw_staging__customers"
[0m02:30:08.776897 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__customers: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_raw_staging__customers"} */

  
  create view "casestudy"."staging"."stg_raw_staging__customers__dbt_tmp" as (
    with source as (
    select * from "casestudy"."raw"."customers"
),

renamed as (
    select distinct
        customer_id,
        trim(firstname) as firstname,
        trim(lastname) as lastname,
        Age as age,
        branch_id
    from source
)

select * from renamed
  );

[0m02:30:08.777727 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:30:08.782710 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_raw_staging__customers"
[0m02:30:08.783305 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__customers: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_raw_staging__customers"} */
alter view "casestudy"."staging"."stg_raw_staging__customers" rename to "stg_raw_staging__customers__dbt_backup"
[0m02:30:08.784597 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:30:08.789133 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_raw_staging__customers"
[0m02:30:08.789688 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__customers: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_raw_staging__customers"} */
alter view "casestudy"."staging"."stg_raw_staging__customers__dbt_tmp" rename to "stg_raw_staging__customers"
[0m02:30:08.790974 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:30:08.793021 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__customers: COMMIT
[0m02:30:08.793478 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_raw_staging__customers"
[0m02:30:08.793844 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__customers: COMMIT
[0m02:30:08.796089 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:30:08.799014 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_raw_staging__customers"
[0m02:30:08.799449 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__customers: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_raw_staging__customers"} */
drop view if exists "casestudy"."staging"."stg_raw_staging__customers__dbt_backup" cascade
[0m02:30:08.801330 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:30:08.803242 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.stg_raw_staging__customers (execute): 02:30:08.766202 => 02:30:08.803016
[0m02:30:08.803663 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__customers: Close
[0m02:30:08.818072 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f9c6553f-5fe9-4ba1-91f8-90d6cbeef8c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c7a2fddf150>]}
[0m02:30:08.818470 [info ] [Thread-1 (]: 2 of 11 OK created sql view model staging.stg_raw_staging__customers ........... [[32mOK[0m in 0.05s]
[0m02:30:08.818781 [debug] [Thread-1 (]: Finished running node model.vg_casestudy.stg_raw_staging__customers
[0m02:30:08.819001 [debug] [Thread-1 (]: Began running node model.vg_casestudy.stg_raw_staging__fx_rates
[0m02:30:08.819424 [info ] [Thread-1 (]: 3 of 11 START sql view model staging.stg_raw_staging__fx_rates ................. [RUN]
[0m02:30:08.819786 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.vg_casestudy.stg_raw_staging__customers, now model.vg_casestudy.stg_raw_staging__fx_rates)
[0m02:30:08.819975 [debug] [Thread-1 (]: Began compiling node model.vg_casestudy.stg_raw_staging__fx_rates
[0m02:30:08.824030 [debug] [Thread-1 (]: Writing injected SQL for node "model.vg_casestudy.stg_raw_staging__fx_rates"
[0m02:30:08.824400 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.stg_raw_staging__fx_rates (compile): 02:30:08.820095 => 02:30:08.824284
[0m02:30:08.824582 [debug] [Thread-1 (]: Began executing node model.vg_casestudy.stg_raw_staging__fx_rates
[0m02:30:08.826696 [debug] [Thread-1 (]: Writing runtime sql for node "model.vg_casestudy.stg_raw_staging__fx_rates"
[0m02:30:08.827014 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_raw_staging__fx_rates"
[0m02:30:08.827211 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__fx_rates: BEGIN
[0m02:30:08.827383 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:30:08.834757 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:30:08.834990 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_raw_staging__fx_rates"
[0m02:30:08.835243 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__fx_rates: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_raw_staging__fx_rates"} */

  
  create view "casestudy"."staging"."stg_raw_staging__fx_rates__dbt_tmp" as (
    with source as (
    select * from "casestudy"."raw"."fx_rates"
),

renamed as (
    select
        trim(currency_iso_code) as currency_iso_code,
        
CASE
    WHEN fx_rate IS NULL THEN NULL
    -- If the value is already a valid number
    WHEN TRY_CAST(fx_rate AS DOUBLE) IS NOT NULL 
        THEN TRY_CAST(fx_rate AS DOUBLE)
    -- If contains both dot and comma (German notation)
    WHEN POSITION('.' IN fx_rate) > 0 AND POSITION(',' IN fx_rate) > 0 
        THEN TRY_CAST(REPLACE(REPLACE(TRIM(fx_rate), '.', ''), ',', '.') AS DOUBLE)
    -- If only contains comma, treat as decimal point
    WHEN POSITION(',' IN fx_rate) > 0 
        THEN TRY_CAST(REPLACE(TRIM(fx_rate), ',', '.') AS DOUBLE)
    -- If only contains dots, likely thousands separator
    WHEN POSITION('.' IN fx_rate) > 0 
        THEN TRY_CAST(REPLACE(TRIM(fx_rate), '.', '') AS DOUBLE)
    ELSE NULL
END
 as fx_rate,
        
CASE
    -- First try DD.MM.YYYY format (German format with dots)
    WHEN REGEXP_MATCHES(date, '^\d{1,2}\.\d{1,2}\.\d{4}$') 
        THEN TRY_CAST(STRPTIME(date, '%d.%m.%Y') AS DATE)
        
    -- Then try DD/MM/YYYY format (with slashes)
    WHEN REGEXP_MATCHES(date, '^\d{1,2}/\d{1,2}/\d{4}$')
        AND CAST(SPLIT_PART(date, '/', 1) AS INTEGER) <= 31 
        AND CAST(SPLIT_PART(date, '/', 2) AS INTEGER) <= 12 
        THEN TRY_CAST(STRPTIME(date, '%d/%m/%Y') AS DATE)
        
    -- Try MM/DD/YYYY format (US format with slashes)
    WHEN REGEXP_MATCHES(date, '^\d{1,2}/\d{1,2}/\d{4}$')
        AND CAST(SPLIT_PART(date, '/', 1) AS INTEGER) <= 12 
        THEN TRY_CAST(STRPTIME(date, '%m/%d/%Y') AS DATE)
        
    -- Try YYYY-MM-DD format (ISO format)
    WHEN REGEXP_MATCHES(date, '^\d{4}-\d{1,2}-\d{1,2}$')
        THEN TRY_CAST(STRPTIME(date, '%Y-%m-%d') AS DATE)
        
    -- Try generic date parsing as last resort
    ELSE TRY_CAST(date AS DATE)
END
 as fx_rate_date,
        date as fx_rate_date_raw
    from source
    where currency_iso_code is not null and trim(currency_iso_code) not in  ('(none)', '')
),

final as (
    select
        currency_iso_code,
        fx_rate,
        fx_rate_date,
        -- Flag records with date parsing issues
        CASE WHEN fx_rate_date IS NULL AND fx_rate_date_raw IS NOT NULL
             THEN TRUE ELSE FALSE 
        END as has_date_parsing_error
    from renamed
)

select * from final
  );

[0m02:30:08.836315 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:30:08.838250 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_raw_staging__fx_rates"
[0m02:30:08.838466 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__fx_rates: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_raw_staging__fx_rates"} */
alter view "casestudy"."staging"."stg_raw_staging__fx_rates" rename to "stg_raw_staging__fx_rates__dbt_backup"
[0m02:30:08.838862 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:30:08.840578 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_raw_staging__fx_rates"
[0m02:30:08.840795 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__fx_rates: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_raw_staging__fx_rates"} */
alter view "casestudy"."staging"."stg_raw_staging__fx_rates__dbt_tmp" rename to "stg_raw_staging__fx_rates"
[0m02:30:08.841165 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:30:08.842129 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__fx_rates: COMMIT
[0m02:30:08.842331 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_raw_staging__fx_rates"
[0m02:30:08.842506 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__fx_rates: COMMIT
[0m02:30:08.843979 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:30:08.845307 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_raw_staging__fx_rates"
[0m02:30:08.845506 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__fx_rates: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_raw_staging__fx_rates"} */
drop view if exists "casestudy"."staging"."stg_raw_staging__fx_rates__dbt_backup" cascade
[0m02:30:08.846538 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:30:08.847298 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.stg_raw_staging__fx_rates (execute): 02:30:08.824697 => 02:30:08.847201
[0m02:30:08.847489 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__fx_rates: Close
[0m02:30:08.859000 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f9c6553f-5fe9-4ba1-91f8-90d6cbeef8c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c7a2ba2cc50>]}
[0m02:30:08.859385 [info ] [Thread-1 (]: 3 of 11 OK created sql view model staging.stg_raw_staging__fx_rates ............ [[32mOK[0m in 0.04s]
[0m02:30:08.859687 [debug] [Thread-1 (]: Finished running node model.vg_casestudy.stg_raw_staging__fx_rates
[0m02:30:08.859905 [debug] [Thread-1 (]: Began running node model.vg_casestudy.stg_raw_staging__loans
[0m02:30:08.860334 [info ] [Thread-1 (]: 4 of 11 START sql view model staging.stg_raw_staging__loans .................... [RUN]
[0m02:30:08.860704 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.vg_casestudy.stg_raw_staging__fx_rates, now model.vg_casestudy.stg_raw_staging__loans)
[0m02:30:08.860901 [debug] [Thread-1 (]: Began compiling node model.vg_casestudy.stg_raw_staging__loans
[0m02:30:08.863066 [debug] [Thread-1 (]: Writing injected SQL for node "model.vg_casestudy.stg_raw_staging__loans"
[0m02:30:08.863434 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.stg_raw_staging__loans (compile): 02:30:08.861021 => 02:30:08.863315
[0m02:30:08.863621 [debug] [Thread-1 (]: Began executing node model.vg_casestudy.stg_raw_staging__loans
[0m02:30:08.865780 [debug] [Thread-1 (]: Writing runtime sql for node "model.vg_casestudy.stg_raw_staging__loans"
[0m02:30:08.866085 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_raw_staging__loans"
[0m02:30:08.866286 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__loans: BEGIN
[0m02:30:08.866457 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:30:08.874135 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:30:08.874488 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_raw_staging__loans"
[0m02:30:08.874763 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__loans: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_raw_staging__loans"} */

  
  create view "casestudy"."staging"."stg_raw_staging__loans__dbt_tmp" as (
    with source as (
    select * from "casestudy"."raw"."loans"
),

renamed as (
    select
        customer_id,
        loan_id,
        
CASE
    WHEN loan_amount IS NULL THEN NULL
    -- If the value is already a valid number
    WHEN TRY_CAST(loan_amount AS DOUBLE) IS NOT NULL 
        THEN TRY_CAST(loan_amount AS DOUBLE)
    -- If contains both dot and comma (German notation)
    WHEN POSITION('.' IN loan_amount) > 0 AND POSITION(',' IN loan_amount) > 0 
        THEN TRY_CAST(REPLACE(REPLACE(TRIM(loan_amount), '.', ''), ',', '.') AS DOUBLE)
    -- If only contains comma, treat as decimal point
    WHEN POSITION(',' IN loan_amount) > 0 
        THEN TRY_CAST(REPLACE(TRIM(loan_amount), ',', '.') AS DOUBLE)
    -- If only contains dots, likely thousands separator
    WHEN POSITION('.' IN loan_amount) > 0 
        THEN TRY_CAST(REPLACE(TRIM(loan_amount), '.', '') AS DOUBLE)
    ELSE NULL
END
 as loan_amount,
        loant_type,
        
CASE
    WHEN interest_rate IS NULL THEN NULL
    -- If the value is already a valid number
    WHEN TRY_CAST(interest_rate AS DOUBLE) IS NOT NULL 
        THEN TRY_CAST(interest_rate AS DOUBLE)
    -- If contains both dot and comma (German notation)
    WHEN POSITION('.' IN interest_rate) > 0 AND POSITION(',' IN interest_rate) > 0 
        THEN TRY_CAST(REPLACE(REPLACE(TRIM(interest_rate), '.', ''), ',', '.') AS DOUBLE)
    -- If only contains comma, treat as decimal point
    WHEN POSITION(',' IN interest_rate) > 0 
        THEN TRY_CAST(REPLACE(TRIM(interest_rate), ',', '.') AS DOUBLE)
    -- If only contains dots, likely thousands separator
    WHEN POSITION('.' IN interest_rate) > 0 
        THEN TRY_CAST(REPLACE(TRIM(interest_rate), '.', '') AS DOUBLE)
    ELSE NULL
END
 as interest_rate,
        loan_term,
        
CASE
    -- First try DD.MM.YYYY format (German format with dots)
    WHEN REGEXP_MATCHES(approval_rejection_date, '^\d{1,2}\.\d{1,2}\.\d{4}$') 
        THEN TRY_CAST(STRPTIME(approval_rejection_date, '%d.%m.%Y') AS DATE)
        
    -- Then try DD/MM/YYYY format (with slashes)
    WHEN REGEXP_MATCHES(approval_rejection_date, '^\d{1,2}/\d{1,2}/\d{4}$')
        AND CAST(SPLIT_PART(approval_rejection_date, '/', 1) AS INTEGER) <= 31 
        AND CAST(SPLIT_PART(approval_rejection_date, '/', 2) AS INTEGER) <= 12 
        THEN TRY_CAST(STRPTIME(approval_rejection_date, '%d/%m/%Y') AS DATE)
        
    -- Try MM/DD/YYYY format (US format with slashes)
    WHEN REGEXP_MATCHES(approval_rejection_date, '^\d{1,2}/\d{1,2}/\d{4}$')
        AND CAST(SPLIT_PART(approval_rejection_date, '/', 1) AS INTEGER) <= 12 
        THEN TRY_CAST(STRPTIME(approval_rejection_date, '%m/%d/%Y') AS DATE)
        
    -- Try YYYY-MM-DD format (ISO format)
    WHEN REGEXP_MATCHES(approval_rejection_date, '^\d{4}-\d{1,2}-\d{1,2}$')
        THEN TRY_CAST(STRPTIME(approval_rejection_date, '%Y-%m-%d') AS DATE)
        
    -- Try generic date parsing as last resort
    ELSE TRY_CAST(approval_rejection_date AS DATE)
END
 as approval_rejection_date,
        approval_rejection_date as approval_rejection_date_raw,
        loan_status
    from source
),

final as (
    select
        customer_id,
        loan_id,
        loan_amount,
        loant_type as loan_type,
        interest_rate,
        loan_term,
        approval_rejection_date,
        loan_status,
        -- Flag records with date parsing issues
        CASE WHEN approval_rejection_date IS NULL AND approval_rejection_date_raw IS NOT NULL
             THEN TRUE ELSE FALSE 
        END as has_date_parsing_error
    from renamed
)

select * from final
  );

[0m02:30:08.876293 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:30:08.878280 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_raw_staging__loans"
[0m02:30:08.878492 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__loans: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_raw_staging__loans"} */
alter view "casestudy"."staging"."stg_raw_staging__loans" rename to "stg_raw_staging__loans__dbt_backup"
[0m02:30:08.878871 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:30:08.880462 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_raw_staging__loans"
[0m02:30:08.880671 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__loans: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_raw_staging__loans"} */
alter view "casestudy"."staging"."stg_raw_staging__loans__dbt_tmp" rename to "stg_raw_staging__loans"
[0m02:30:08.881018 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:30:08.881941 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__loans: COMMIT
[0m02:30:08.882148 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_raw_staging__loans"
[0m02:30:08.882327 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__loans: COMMIT
[0m02:30:08.883673 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:30:08.885966 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_raw_staging__loans"
[0m02:30:08.886179 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__loans: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_raw_staging__loans"} */
drop view if exists "casestudy"."staging"."stg_raw_staging__loans__dbt_backup" cascade
[0m02:30:08.887057 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:30:08.887804 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.stg_raw_staging__loans (execute): 02:30:08.863742 => 02:30:08.887697
[0m02:30:08.887994 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__loans: Close
[0m02:30:08.898687 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f9c6553f-5fe9-4ba1-91f8-90d6cbeef8c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c7a2bab8090>]}
[0m02:30:08.899059 [info ] [Thread-1 (]: 4 of 11 OK created sql view model staging.stg_raw_staging__loans ............... [[32mOK[0m in 0.04s]
[0m02:30:08.899370 [debug] [Thread-1 (]: Finished running node model.vg_casestudy.stg_raw_staging__loans
[0m02:30:08.899581 [debug] [Thread-1 (]: Began running node model.vg_casestudy.stg_raw_staging__transactions
[0m02:30:08.899992 [info ] [Thread-1 (]: 5 of 11 START sql view model staging.stg_raw_staging__transactions ............. [RUN]
[0m02:30:08.900359 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.vg_casestudy.stg_raw_staging__loans, now model.vg_casestudy.stg_raw_staging__transactions)
[0m02:30:08.900544 [debug] [Thread-1 (]: Began compiling node model.vg_casestudy.stg_raw_staging__transactions
[0m02:30:08.902589 [debug] [Thread-1 (]: Writing injected SQL for node "model.vg_casestudy.stg_raw_staging__transactions"
[0m02:30:08.902942 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.stg_raw_staging__transactions (compile): 02:30:08.900655 => 02:30:08.902827
[0m02:30:08.903131 [debug] [Thread-1 (]: Began executing node model.vg_casestudy.stg_raw_staging__transactions
[0m02:30:08.905220 [debug] [Thread-1 (]: Writing runtime sql for node "model.vg_casestudy.stg_raw_staging__transactions"
[0m02:30:08.905525 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_raw_staging__transactions"
[0m02:30:08.905711 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__transactions: BEGIN
[0m02:30:08.905876 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:30:08.913138 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:30:08.913429 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_raw_staging__transactions"
[0m02:30:08.913684 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__transactions: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_raw_staging__transactions"} */

  
  create view "casestudy"."staging"."stg_raw_staging__transactions__dbt_tmp" as (
    with source as (
    select * from "casestudy"."raw"."transactions"
),

renamed as (
    select
        transaction_id,
        
CASE
    -- First try DD.MM.YYYY format (German format with dots)
    WHEN REGEXP_MATCHES(transaction_date, '^\d{1,2}\.\d{1,2}\.\d{4}$') 
        THEN TRY_CAST(STRPTIME(transaction_date, '%d.%m.%Y') AS DATE)
        
    -- Then try DD/MM/YYYY format (with slashes)
    WHEN REGEXP_MATCHES(transaction_date, '^\d{1,2}/\d{1,2}/\d{4}$')
        AND CAST(SPLIT_PART(transaction_date, '/', 1) AS INTEGER) <= 31 
        AND CAST(SPLIT_PART(transaction_date, '/', 2) AS INTEGER) <= 12 
        THEN TRY_CAST(STRPTIME(transaction_date, '%d/%m/%Y') AS DATE)
        
    -- Try MM/DD/YYYY format (US format with slashes)
    WHEN REGEXP_MATCHES(transaction_date, '^\d{1,2}/\d{1,2}/\d{4}$')
        AND CAST(SPLIT_PART(transaction_date, '/', 1) AS INTEGER) <= 12 
        THEN TRY_CAST(STRPTIME(transaction_date, '%m/%d/%Y') AS DATE)
        
    -- Try YYYY-MM-DD format (ISO format)
    WHEN REGEXP_MATCHES(transaction_date, '^\d{4}-\d{1,2}-\d{1,2}$')
        THEN TRY_CAST(STRPTIME(transaction_date, '%Y-%m-%d') AS DATE)
        
    -- Try generic date parsing as last resort
    ELSE TRY_CAST(transaction_date AS DATE)
END
 as transaction_date,
        transaction_date as transaction_date_raw,
        account_id,
        trim(transaction_type) as transaction_type,
        
CASE
    WHEN transaction_amount IS NULL THEN NULL
    -- If the value is already a valid number
    WHEN TRY_CAST(transaction_amount AS DOUBLE) IS NOT NULL 
        THEN TRY_CAST(transaction_amount AS DOUBLE)
    -- If contains both dot and comma (German notation)
    WHEN POSITION('.' IN transaction_amount) > 0 AND POSITION(',' IN transaction_amount) > 0 
        THEN TRY_CAST(REPLACE(REPLACE(TRIM(transaction_amount), '.', ''), ',', '.') AS DOUBLE)
    -- If only contains comma, treat as decimal point
    WHEN POSITION(',' IN transaction_amount) > 0 
        THEN TRY_CAST(REPLACE(TRIM(transaction_amount), ',', '.') AS DOUBLE)
    -- If only contains dots, likely thousands separator
    WHEN POSITION('.' IN transaction_amount) > 0 
        THEN TRY_CAST(REPLACE(TRIM(transaction_amount), '.', '') AS DOUBLE)
    ELSE NULL
END
 as transaction_amount,
        trim(transaction_currency) as transaction_currency
    from source
),

final as (
    select
        transaction_id,
        transaction_date,
        account_id,
        transaction_type,
        transaction_amount,
        transaction_currency,
        -- Flag records with date parsing issues
        CASE WHEN transaction_date IS NULL AND transaction_date_raw IS NOT NULL
             THEN TRUE ELSE FALSE 
        END as has_date_parsing_error
    from renamed
)

select * from final
  );

[0m02:30:08.914904 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:30:08.917276 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_raw_staging__transactions"
[0m02:30:08.917484 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__transactions: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_raw_staging__transactions"} */
alter view "casestudy"."staging"."stg_raw_staging__transactions" rename to "stg_raw_staging__transactions__dbt_backup"
[0m02:30:08.917861 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:30:08.919449 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_raw_staging__transactions"
[0m02:30:08.919656 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__transactions: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_raw_staging__transactions"} */
alter view "casestudy"."staging"."stg_raw_staging__transactions__dbt_tmp" rename to "stg_raw_staging__transactions"
[0m02:30:08.920013 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:30:08.920964 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__transactions: COMMIT
[0m02:30:08.921171 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_raw_staging__transactions"
[0m02:30:08.921358 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__transactions: COMMIT
[0m02:30:08.922776 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:30:08.924118 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_raw_staging__transactions"
[0m02:30:08.924323 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__transactions: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_raw_staging__transactions"} */
drop view if exists "casestudy"."staging"."stg_raw_staging__transactions__dbt_backup" cascade
[0m02:30:08.925214 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:30:08.925945 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.stg_raw_staging__transactions (execute): 02:30:08.903260 => 02:30:08.925843
[0m02:30:08.926144 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__transactions: Close
[0m02:30:08.938227 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f9c6553f-5fe9-4ba1-91f8-90d6cbeef8c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c7a2b9dd290>]}
[0m02:30:08.938591 [info ] [Thread-1 (]: 5 of 11 OK created sql view model staging.stg_raw_staging__transactions ........ [[32mOK[0m in 0.04s]
[0m02:30:08.938886 [debug] [Thread-1 (]: Finished running node model.vg_casestudy.stg_raw_staging__transactions
[0m02:30:08.939103 [debug] [Thread-1 (]: Began running node model.vg_casestudy.stg_staging_intermediate__currencies
[0m02:30:08.939513 [info ] [Thread-1 (]: 6 of 11 START sql table model intermediate.stg_staging_intermediate__currencies  [RUN]
[0m02:30:08.939873 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.vg_casestudy.stg_raw_staging__transactions, now model.vg_casestudy.stg_staging_intermediate__currencies)
[0m02:30:08.940065 [debug] [Thread-1 (]: Began compiling node model.vg_casestudy.stg_staging_intermediate__currencies
[0m02:30:08.941733 [debug] [Thread-1 (]: Writing injected SQL for node "model.vg_casestudy.stg_staging_intermediate__currencies"
[0m02:30:08.942076 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.stg_staging_intermediate__currencies (compile): 02:30:08.940193 => 02:30:08.941963
[0m02:30:08.942272 [debug] [Thread-1 (]: Began executing node model.vg_casestudy.stg_staging_intermediate__currencies
[0m02:30:08.953154 [debug] [Thread-1 (]: Writing runtime sql for node "model.vg_casestudy.stg_staging_intermediate__currencies"
[0m02:30:08.953633 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__currencies"
[0m02:30:08.953848 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__currencies: BEGIN
[0m02:30:08.954043 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:30:08.962090 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:30:08.962332 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__currencies"
[0m02:30:08.962534 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__currencies: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_staging_intermediate__currencies"} */

  
    
    

    create  table
      "casestudy"."intermediate"."stg_staging_intermediate__currencies__dbt_tmp"
  
    as (
      with staging as (
    select * from "casestudy"."raw"."currencies"
),
cleaned as (
    select distinct
        trim(currency) as currency,
        trim(currency_iso_code) as currency_iso_code,
    from staging
    where currency_iso_code is not null and trim(currency_iso_code) != '(none)'
)

select * from cleaned
    );
  
  
[0m02:30:08.965311 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:30:08.967198 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__currencies"
[0m02:30:08.967411 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__currencies: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_staging_intermediate__currencies"} */
alter table "casestudy"."intermediate"."stg_staging_intermediate__currencies" rename to "stg_staging_intermediate__currencies__dbt_backup"
[0m02:30:08.967766 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:30:08.970613 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__currencies"
[0m02:30:08.970833 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__currencies: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_staging_intermediate__currencies"} */
alter table "casestudy"."intermediate"."stg_staging_intermediate__currencies__dbt_tmp" rename to "stg_staging_intermediate__currencies"
[0m02:30:08.971170 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:30:08.973977 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__currencies: COMMIT
[0m02:30:08.974202 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__currencies"
[0m02:30:08.974384 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__currencies: COMMIT
[0m02:30:08.975857 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:30:08.977173 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__currencies"
[0m02:30:08.977379 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__currencies: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_staging_intermediate__currencies"} */
drop table if exists "casestudy"."intermediate"."stg_staging_intermediate__currencies__dbt_backup" cascade
[0m02:30:08.978218 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:30:08.978933 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.stg_staging_intermediate__currencies (execute): 02:30:08.942390 => 02:30:08.978829
[0m02:30:08.979121 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__currencies: Close
[0m02:30:08.993108 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f9c6553f-5fe9-4ba1-91f8-90d6cbeef8c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c7a2b771390>]}
[0m02:30:08.993497 [info ] [Thread-1 (]: 6 of 11 OK created sql table model intermediate.stg_staging_intermediate__currencies  [[32mOK[0m in 0.05s]
[0m02:30:08.993799 [debug] [Thread-1 (]: Finished running node model.vg_casestudy.stg_staging_intermediate__currencies
[0m02:30:08.994011 [debug] [Thread-1 (]: Began running node model.vg_casestudy.stg_staging_intermediate__accounts
[0m02:30:08.994329 [info ] [Thread-1 (]: 7 of 11 START sql table model intermediate.stg_staging_intermediate__accounts .. [RUN]
[0m02:30:08.994662 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.vg_casestudy.stg_staging_intermediate__currencies, now model.vg_casestudy.stg_staging_intermediate__accounts)
[0m02:30:08.994846 [debug] [Thread-1 (]: Began compiling node model.vg_casestudy.stg_staging_intermediate__accounts
[0m02:30:08.996492 [debug] [Thread-1 (]: Writing injected SQL for node "model.vg_casestudy.stg_staging_intermediate__accounts"
[0m02:30:08.996830 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.stg_staging_intermediate__accounts (compile): 02:30:08.994962 => 02:30:08.996719
[0m02:30:08.997007 [debug] [Thread-1 (]: Began executing node model.vg_casestudy.stg_staging_intermediate__accounts
[0m02:30:08.999012 [debug] [Thread-1 (]: Writing runtime sql for node "model.vg_casestudy.stg_staging_intermediate__accounts"
[0m02:30:08.999349 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__accounts"
[0m02:30:08.999532 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__accounts: BEGIN
[0m02:30:08.999694 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:30:09.007051 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:30:09.007379 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__accounts"
[0m02:30:09.007593 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__accounts: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_staging_intermediate__accounts"} */

  
    
    

    create  table
      "casestudy"."intermediate"."stg_staging_intermediate__accounts__dbt_tmp"
  
    as (
      with staging as (
    select * from "casestudy"."staging"."stg_raw_staging__accounts"
), 
filtered as (
    select 
        account_id,
        customer_id,
        account_type,
        account_opening_date,
     from staging
    where not has_date_parsing_error
)

select * from filtered
    );
  
  
[0m02:30:09.011880 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:30:09.013896 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__accounts"
[0m02:30:09.014136 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__accounts: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_staging_intermediate__accounts"} */
alter table "casestudy"."intermediate"."stg_staging_intermediate__accounts" rename to "stg_staging_intermediate__accounts__dbt_backup"
[0m02:30:09.014561 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:30:09.016365 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__accounts"
[0m02:30:09.016591 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__accounts: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_staging_intermediate__accounts"} */
alter table "casestudy"."intermediate"."stg_staging_intermediate__accounts__dbt_tmp" rename to "stg_staging_intermediate__accounts"
[0m02:30:09.017065 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:30:09.018113 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__accounts: COMMIT
[0m02:30:09.018344 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__accounts"
[0m02:30:09.018536 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__accounts: COMMIT
[0m02:30:09.020268 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:30:09.021854 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__accounts"
[0m02:30:09.022075 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__accounts: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_staging_intermediate__accounts"} */
drop table if exists "casestudy"."intermediate"."stg_staging_intermediate__accounts__dbt_backup" cascade
[0m02:30:09.023815 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:30:09.024664 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.stg_staging_intermediate__accounts (execute): 02:30:08.997120 => 02:30:09.024559
[0m02:30:09.024875 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__accounts: Close
[0m02:30:09.042577 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f9c6553f-5fe9-4ba1-91f8-90d6cbeef8c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c7a2c488990>]}
[0m02:30:09.043005 [info ] [Thread-1 (]: 7 of 11 OK created sql table model intermediate.stg_staging_intermediate__accounts  [[32mOK[0m in 0.05s]
[0m02:30:09.043353 [debug] [Thread-1 (]: Finished running node model.vg_casestudy.stg_staging_intermediate__accounts
[0m02:30:09.043599 [debug] [Thread-1 (]: Began running node model.vg_casestudy.stg_staging_intermediate__customers
[0m02:30:09.043970 [info ] [Thread-1 (]: 8 of 11 START sql table model intermediate.stg_staging_intermediate__customers . [RUN]
[0m02:30:09.044407 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.vg_casestudy.stg_staging_intermediate__accounts, now model.vg_casestudy.stg_staging_intermediate__customers)
[0m02:30:09.044653 [debug] [Thread-1 (]: Began compiling node model.vg_casestudy.stg_staging_intermediate__customers
[0m02:30:09.046401 [debug] [Thread-1 (]: Writing injected SQL for node "model.vg_casestudy.stg_staging_intermediate__customers"
[0m02:30:09.046750 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.stg_staging_intermediate__customers (compile): 02:30:09.044782 => 02:30:09.046634
[0m02:30:09.046930 [debug] [Thread-1 (]: Began executing node model.vg_casestudy.stg_staging_intermediate__customers
[0m02:30:09.049052 [debug] [Thread-1 (]: Writing runtime sql for node "model.vg_casestudy.stg_staging_intermediate__customers"
[0m02:30:09.049364 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__customers"
[0m02:30:09.049551 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__customers: BEGIN
[0m02:30:09.049713 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:30:09.056627 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:30:09.056853 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__customers"
[0m02:30:09.057031 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__customers: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_staging_intermediate__customers"} */

  
    
    

    create  table
      "casestudy"."intermediate"."stg_staging_intermediate__customers__dbt_tmp"
  
    as (
      with staging as (
    select * from "casestudy"."staging"."stg_raw_staging__customers"
)

select * from staging
    );
  
  
[0m02:30:09.062968 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:30:09.065941 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__customers"
[0m02:30:09.066178 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__customers: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_staging_intermediate__customers"} */
alter table "casestudy"."intermediate"."stg_staging_intermediate__customers" rename to "stg_staging_intermediate__customers__dbt_backup"
[0m02:30:09.066553 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:30:09.068116 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__customers"
[0m02:30:09.068342 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__customers: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_staging_intermediate__customers"} */
alter table "casestudy"."intermediate"."stg_staging_intermediate__customers__dbt_tmp" rename to "stg_staging_intermediate__customers"
[0m02:30:09.068669 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:30:09.069627 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__customers: COMMIT
[0m02:30:09.069829 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__customers"
[0m02:30:09.070002 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__customers: COMMIT
[0m02:30:09.072052 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:30:09.073397 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__customers"
[0m02:30:09.073649 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__customers: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_staging_intermediate__customers"} */
drop table if exists "casestudy"."intermediate"."stg_staging_intermediate__customers__dbt_backup" cascade
[0m02:30:09.074810 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:30:09.075579 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.stg_staging_intermediate__customers (execute): 02:30:09.047046 => 02:30:09.075475
[0m02:30:09.075779 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__customers: Close
[0m02:30:09.094529 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f9c6553f-5fe9-4ba1-91f8-90d6cbeef8c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c7a2b792f10>]}
[0m02:30:09.094950 [info ] [Thread-1 (]: 8 of 11 OK created sql table model intermediate.stg_staging_intermediate__customers  [[32mOK[0m in 0.05s]
[0m02:30:09.095274 [debug] [Thread-1 (]: Finished running node model.vg_casestudy.stg_staging_intermediate__customers
[0m02:30:09.095501 [debug] [Thread-1 (]: Began running node model.vg_casestudy.stg_staging_intermediate__fx_rates
[0m02:30:09.095845 [info ] [Thread-1 (]: 9 of 11 START sql table model intermediate.stg_staging_intermediate__fx_rates .. [RUN]
[0m02:30:09.096195 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.vg_casestudy.stg_staging_intermediate__customers, now model.vg_casestudy.stg_staging_intermediate__fx_rates)
[0m02:30:09.096383 [debug] [Thread-1 (]: Began compiling node model.vg_casestudy.stg_staging_intermediate__fx_rates
[0m02:30:09.098046 [debug] [Thread-1 (]: Writing injected SQL for node "model.vg_casestudy.stg_staging_intermediate__fx_rates"
[0m02:30:09.098400 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.stg_staging_intermediate__fx_rates (compile): 02:30:09.096497 => 02:30:09.098283
[0m02:30:09.098579 [debug] [Thread-1 (]: Began executing node model.vg_casestudy.stg_staging_intermediate__fx_rates
[0m02:30:09.100533 [debug] [Thread-1 (]: Writing runtime sql for node "model.vg_casestudy.stg_staging_intermediate__fx_rates"
[0m02:30:09.100826 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__fx_rates"
[0m02:30:09.101013 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__fx_rates: BEGIN
[0m02:30:09.101187 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:30:09.108494 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:30:09.108881 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__fx_rates"
[0m02:30:09.109079 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__fx_rates: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_staging_intermediate__fx_rates"} */

  
    
    

    create  table
      "casestudy"."intermediate"."stg_staging_intermediate__fx_rates__dbt_tmp"
  
    as (
      with staging as (
    select * from "casestudy"."staging"."stg_raw_staging__fx_rates"
),

filtered as (
    select
        currency_iso_code,
        fx_rate,
        fx_rate_date
    from staging
    where not has_date_parsing_error
)

select * from filtered
    );
  
  
[0m02:30:09.111575 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:30:09.113473 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__fx_rates"
[0m02:30:09.113679 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__fx_rates: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_staging_intermediate__fx_rates"} */
alter table "casestudy"."intermediate"."stg_staging_intermediate__fx_rates" rename to "stg_staging_intermediate__fx_rates__dbt_backup"
[0m02:30:09.114084 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:30:09.115657 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__fx_rates"
[0m02:30:09.115862 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__fx_rates: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_staging_intermediate__fx_rates"} */
alter table "casestudy"."intermediate"."stg_staging_intermediate__fx_rates__dbt_tmp" rename to "stg_staging_intermediate__fx_rates"
[0m02:30:09.116197 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:30:09.117159 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__fx_rates: COMMIT
[0m02:30:09.117355 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__fx_rates"
[0m02:30:09.117521 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__fx_rates: COMMIT
[0m02:30:09.118828 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:30:09.120152 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__fx_rates"
[0m02:30:09.120342 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__fx_rates: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_staging_intermediate__fx_rates"} */
drop table if exists "casestudy"."intermediate"."stg_staging_intermediate__fx_rates__dbt_backup" cascade
[0m02:30:09.121770 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:30:09.122571 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.stg_staging_intermediate__fx_rates (execute): 02:30:09.098692 => 02:30:09.122459
[0m02:30:09.122773 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__fx_rates: Close
[0m02:30:09.135950 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f9c6553f-5fe9-4ba1-91f8-90d6cbeef8c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c7a2b7b44d0>]}
[0m02:30:09.136737 [info ] [Thread-1 (]: 9 of 11 OK created sql table model intermediate.stg_staging_intermediate__fx_rates  [[32mOK[0m in 0.04s]
[0m02:30:09.137371 [debug] [Thread-1 (]: Finished running node model.vg_casestudy.stg_staging_intermediate__fx_rates
[0m02:30:09.137758 [debug] [Thread-1 (]: Began running node model.vg_casestudy.stg_staging_intermediate__loans
[0m02:30:09.138298 [info ] [Thread-1 (]: 10 of 11 START sql table model intermediate.stg_staging_intermediate__loans .... [RUN]
[0m02:30:09.138904 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.vg_casestudy.stg_staging_intermediate__fx_rates, now model.vg_casestudy.stg_staging_intermediate__loans)
[0m02:30:09.139096 [debug] [Thread-1 (]: Began compiling node model.vg_casestudy.stg_staging_intermediate__loans
[0m02:30:09.140849 [debug] [Thread-1 (]: Writing injected SQL for node "model.vg_casestudy.stg_staging_intermediate__loans"
[0m02:30:09.141199 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.stg_staging_intermediate__loans (compile): 02:30:09.139224 => 02:30:09.141079
[0m02:30:09.141380 [debug] [Thread-1 (]: Began executing node model.vg_casestudy.stg_staging_intermediate__loans
[0m02:30:09.144490 [debug] [Thread-1 (]: Writing runtime sql for node "model.vg_casestudy.stg_staging_intermediate__loans"
[0m02:30:09.144790 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__loans"
[0m02:30:09.144972 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__loans: BEGIN
[0m02:30:09.145148 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:30:09.152491 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:30:09.152811 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__loans"
[0m02:30:09.153006 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__loans: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_staging_intermediate__loans"} */

  
    
    

    create  table
      "casestudy"."intermediate"."stg_staging_intermediate__loans__dbt_tmp"
  
    as (
      with staging as (
    select * from "casestudy"."staging"."stg_raw_staging__loans"
),

filtered as (
    select
        customer_id,
        loan_id,
        loan_amount,
        loan_type,
        interest_rate,
        loan_term,
        approval_rejection_date,
        loan_status
    from staging
    where not has_date_parsing_error
)

select * from filtered
    );
  
  
[0m02:30:09.162375 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:30:09.164274 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__loans"
[0m02:30:09.164494 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__loans: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_staging_intermediate__loans"} */
alter table "casestudy"."intermediate"."stg_staging_intermediate__loans" rename to "stg_staging_intermediate__loans__dbt_backup"
[0m02:30:09.164851 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:30:09.166449 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__loans"
[0m02:30:09.166653 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__loans: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_staging_intermediate__loans"} */
alter table "casestudy"."intermediate"."stg_staging_intermediate__loans__dbt_tmp" rename to "stg_staging_intermediate__loans"
[0m02:30:09.166981 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:30:09.167918 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__loans: COMMIT
[0m02:30:09.168115 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__loans"
[0m02:30:09.168291 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__loans: COMMIT
[0m02:30:09.170180 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:30:09.171556 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__loans"
[0m02:30:09.171759 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__loans: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_staging_intermediate__loans"} */
drop table if exists "casestudy"."intermediate"."stg_staging_intermediate__loans__dbt_backup" cascade
[0m02:30:09.172736 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:30:09.173455 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.stg_staging_intermediate__loans (execute): 02:30:09.141495 => 02:30:09.173357
[0m02:30:09.173646 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__loans: Close
[0m02:30:09.187746 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f9c6553f-5fe9-4ba1-91f8-90d6cbeef8c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c7a2baab5d0>]}
[0m02:30:09.188138 [info ] [Thread-1 (]: 10 of 11 OK created sql table model intermediate.stg_staging_intermediate__loans  [[32mOK[0m in 0.05s]
[0m02:30:09.188455 [debug] [Thread-1 (]: Finished running node model.vg_casestudy.stg_staging_intermediate__loans
[0m02:30:09.188682 [debug] [Thread-1 (]: Began running node model.vg_casestudy.stg_staging_intermediate__transactions
[0m02:30:09.189003 [info ] [Thread-1 (]: 11 of 11 START sql table model intermediate.stg_staging_intermediate__transactions  [RUN]
[0m02:30:09.189371 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.vg_casestudy.stg_staging_intermediate__loans, now model.vg_casestudy.stg_staging_intermediate__transactions)
[0m02:30:09.189586 [debug] [Thread-1 (]: Began compiling node model.vg_casestudy.stg_staging_intermediate__transactions
[0m02:30:09.191298 [debug] [Thread-1 (]: Writing injected SQL for node "model.vg_casestudy.stg_staging_intermediate__transactions"
[0m02:30:09.191657 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.stg_staging_intermediate__transactions (compile): 02:30:09.189709 => 02:30:09.191535
[0m02:30:09.191850 [debug] [Thread-1 (]: Began executing node model.vg_casestudy.stg_staging_intermediate__transactions
[0m02:30:09.193835 [debug] [Thread-1 (]: Writing runtime sql for node "model.vg_casestudy.stg_staging_intermediate__transactions"
[0m02:30:09.194149 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__transactions"
[0m02:30:09.194348 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__transactions: BEGIN
[0m02:30:09.194519 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:30:09.203816 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:30:09.204288 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__transactions"
[0m02:30:09.204635 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__transactions: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_staging_intermediate__transactions"} */

  
    
    

    create  table
      "casestudy"."intermediate"."stg_staging_intermediate__transactions__dbt_tmp"
  
    as (
      with staging as (
    select * from "casestudy"."staging"."stg_raw_staging__transactions"
),

filtered as (
    select
        transaction_id,
        transaction_date,
        account_id,
        transaction_type,
        transaction_amount,
        transaction_currency
    from staging
    where not has_date_parsing_error
)

select * from filtered
    );
  
  
[0m02:30:09.242877 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:30:09.244876 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__transactions"
[0m02:30:09.245095 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__transactions: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_staging_intermediate__transactions"} */
alter table "casestudy"."intermediate"."stg_staging_intermediate__transactions" rename to "stg_staging_intermediate__transactions__dbt_backup"
[0m02:30:09.245513 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:30:09.247404 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__transactions"
[0m02:30:09.247630 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__transactions: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_staging_intermediate__transactions"} */
alter table "casestudy"."intermediate"."stg_staging_intermediate__transactions__dbt_tmp" rename to "stg_staging_intermediate__transactions"
[0m02:30:09.247996 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:30:09.248983 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__transactions: COMMIT
[0m02:30:09.249184 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__transactions"
[0m02:30:09.249359 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__transactions: COMMIT
[0m02:30:09.254721 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:30:09.256140 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__transactions"
[0m02:30:09.256341 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__transactions: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_staging_intermediate__transactions"} */
drop table if exists "casestudy"."intermediate"."stg_staging_intermediate__transactions__dbt_backup" cascade
[0m02:30:09.257285 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:30:09.258017 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.stg_staging_intermediate__transactions (execute): 02:30:09.191970 => 02:30:09.257918
[0m02:30:09.258220 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__transactions: Close
[0m02:30:09.281836 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f9c6553f-5fe9-4ba1-91f8-90d6cbeef8c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c7a2b74ab90>]}
[0m02:30:09.282586 [info ] [Thread-1 (]: 11 of 11 OK created sql table model intermediate.stg_staging_intermediate__transactions  [[32mOK[0m in 0.09s]
[0m02:30:09.283239 [debug] [Thread-1 (]: Finished running node model.vg_casestudy.stg_staging_intermediate__transactions
[0m02:30:09.284567 [debug] [MainThread]: Using duckdb connection "master"
[0m02:30:09.284758 [debug] [MainThread]: On master: BEGIN
[0m02:30:09.284908 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:30:09.292955 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m02:30:09.293191 [debug] [MainThread]: On master: COMMIT
[0m02:30:09.293345 [debug] [MainThread]: Using duckdb connection "master"
[0m02:30:09.293490 [debug] [MainThread]: On master: COMMIT
[0m02:30:09.293745 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m02:30:09.293909 [debug] [MainThread]: On master: Close
[0m02:30:09.297083 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:30:09.297526 [debug] [MainThread]: Connection 'list_casestudy_staging' was properly closed.
[0m02:30:09.297865 [debug] [MainThread]: Connection 'model.vg_casestudy.stg_staging_intermediate__transactions' was properly closed.
[0m02:30:09.298338 [info ] [MainThread]: 
[0m02:30:09.298726 [info ] [MainThread]: Finished running 5 view models, 6 table models in 0 hours 0 minutes and 0.80 seconds (0.80s).
[0m02:30:09.300402 [debug] [MainThread]: Command end result
[0m02:30:09.311205 [info ] [MainThread]: 
[0m02:30:09.311491 [info ] [MainThread]: [32mCompleted successfully[0m
[0m02:30:09.311656 [info ] [MainThread]: 
[0m02:30:09.311816 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=0 SKIP=0 TOTAL=11
[0m02:30:09.312064 [debug] [MainThread]: Command `dbt run` succeeded at 02:30:09.312006 after 0.95 seconds
[0m02:30:09.312269 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c7a30198d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c7a30303790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c7a3471da50>]}
[0m02:30:09.312457 [debug] [MainThread]: Flushing usage events
[0m02:30:23.684205 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x759a30087590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x759a2fceebd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x759a3256bfd0>]}


============================== 02:30:23.685778 | 679749e6-b802-4fdc-a30c-c04bccfe50f3 ==============================
[0m02:30:23.685778 [info ] [MainThread]: Running with dbt=1.6.18
[0m02:30:23.686062 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/workspaces/varengold_data_analyst_case/transformation', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/workspaces/varengold_data_analyst_case/transformation/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run-operation explore_schemas', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m02:30:23.740984 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '679749e6-b802-4fdc-a30c-c04bccfe50f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x759a2bb76910>]}
[0m02:30:23.748938 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '679749e6-b802-4fdc-a30c-c04bccfe50f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x759a30070f50>]}
[0m02:30:23.749391 [info ] [MainThread]: Registered adapter: duckdb=1.6.2
[0m02:30:23.762428 [debug] [MainThread]: checksum: 7b9fab86a08e9e96a48a825af743c566d95b877e068b8c6d0dbafbf714447189, vars: {}, profile: , target: , version: 1.6.18
[0m02:30:23.786227 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m02:30:23.786514 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m02:30:23.787255 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.vg_casestudy.reporting
- models.vg_casestudy.main
- models.vg_casestudy.marts
[0m02:30:23.792640 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '679749e6-b802-4fdc-a30c-c04bccfe50f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x759a2b95b610>]}
[0m02:30:23.808060 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '679749e6-b802-4fdc-a30c-c04bccfe50f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x759a2b9ab410>]}
[0m02:30:23.808409 [info ] [MainThread]: Found 11 models, 1 analysis, 2 seeds, 71 tests, 5 sources, 0 exposures, 0 metrics, 632 macros, 0 groups, 0 semantic models
[0m02:30:23.808606 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '679749e6-b802-4fdc-a30c-c04bccfe50f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x759a2fab9e50>]}
[0m02:30:23.809024 [debug] [MainThread]: Acquiring new duckdb connection 'macro_explore_schemas'
[0m02:30:23.809209 [debug] [MainThread]: Using duckdb connection "macro_explore_schemas"
[0m02:30:23.809352 [debug] [MainThread]: On macro_explore_schemas: BEGIN
[0m02:30:23.809486 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:30:23.818462 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m02:30:23.818757 [debug] [MainThread]: On macro_explore_schemas: COMMIT
[0m02:30:23.818921 [debug] [MainThread]: Using duckdb connection "macro_explore_schemas"
[0m02:30:23.819069 [debug] [MainThread]: On macro_explore_schemas: COMMIT
[0m02:30:23.819322 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m02:30:23.825150 [debug] [MainThread]: Using duckdb connection "macro_explore_schemas"
[0m02:30:23.825357 [debug] [MainThread]: On macro_explore_schemas: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "macro_explore_schemas"} */

    
        SELECT schema_name FROM information_schema.schemata
    
  
[0m02:30:23.826010 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m02:30:23.826822 [debug] [MainThread]: On macro_explore_schemas: Close
[0m02:30:23.829431 [debug] [MainThread]: Command `dbt run-operation` succeeded at 02:30:23.829352 after 0.15 seconds
[0m02:30:23.829620 [debug] [MainThread]: Connection 'macro_explore_schemas' was properly closed.
[0m02:30:23.829802 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x759a2b9aa410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x759a2b9a8e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x759a2b9a8550>]}
[0m02:30:23.830016 [debug] [MainThread]: Flushing usage events
[0m02:32:03.645803 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e9cad73d610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e9cad8f8850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e9cadd27f50>]}


============================== 02:32:03.649166 | 5f0c7093-2535-4b97-bc14-eac63ff1fdfe ==============================
[0m02:32:03.649166 [info ] [MainThread]: Running with dbt=1.6.18
[0m02:32:03.649531 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/workspaces/varengold_data_analyst_case/transformation', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/workspaces/varengold_data_analyst_case/transformation/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run-operation explore_schemas', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m02:32:03.701725 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5f0c7093-2535-4b97-bc14-eac63ff1fdfe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e9cad750d10>]}
[0m02:32:03.709527 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5f0c7093-2535-4b97-bc14-eac63ff1fdfe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e9cadd56850>]}
[0m02:32:03.709906 [info ] [MainThread]: Registered adapter: duckdb=1.6.2
[0m02:32:03.722599 [debug] [MainThread]: checksum: 7b9fab86a08e9e96a48a825af743c566d95b877e068b8c6d0dbafbf714447189, vars: {}, profile: , target: , version: 1.6.18
[0m02:32:03.744484 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m02:32:03.744787 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m02:32:03.745694 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.vg_casestudy.main
- models.vg_casestudy.reporting
- models.vg_casestudy.marts
[0m02:32:03.749680 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5f0c7093-2535-4b97-bc14-eac63ff1fdfe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e9ca96ac390>]}
[0m02:32:03.762663 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5f0c7093-2535-4b97-bc14-eac63ff1fdfe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e9cad78fa10>]}
[0m02:32:03.763018 [info ] [MainThread]: Found 11 models, 1 analysis, 2 seeds, 71 tests, 5 sources, 0 exposures, 0 metrics, 632 macros, 0 groups, 0 semantic models
[0m02:32:03.763229 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5f0c7093-2535-4b97-bc14-eac63ff1fdfe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e9cadd24490>]}
[0m02:32:03.763658 [debug] [MainThread]: Acquiring new duckdb connection 'macro_explore_schemas'
[0m02:32:03.763837 [debug] [MainThread]: Using duckdb connection "macro_explore_schemas"
[0m02:32:03.763986 [debug] [MainThread]: On macro_explore_schemas: BEGIN
[0m02:32:03.764129 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:32:03.773162 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m02:32:03.773429 [debug] [MainThread]: On macro_explore_schemas: COMMIT
[0m02:32:03.773594 [debug] [MainThread]: Using duckdb connection "macro_explore_schemas"
[0m02:32:03.773742 [debug] [MainThread]: On macro_explore_schemas: COMMIT
[0m02:32:03.773985 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m02:32:03.779948 [debug] [MainThread]: Using duckdb connection "macro_explore_schemas"
[0m02:32:03.780202 [debug] [MainThread]: On macro_explore_schemas: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "macro_explore_schemas"} */

    
        SELECT schema_name FROM information_schema.schemata
    
  
[0m02:32:03.781210 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m02:32:03.782183 [debug] [MainThread]: On macro_explore_schemas: Close
[0m02:32:03.785296 [debug] [MainThread]: Command `dbt run-operation` succeeded at 02:32:03.785217 after 0.14 seconds
[0m02:32:03.785497 [debug] [MainThread]: Connection 'macro_explore_schemas' was properly closed.
[0m02:32:03.785678 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e9cae31db50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e9cad75fdd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e9caa09fbd0>]}
[0m02:32:03.785883 [debug] [MainThread]: Flushing usage events
