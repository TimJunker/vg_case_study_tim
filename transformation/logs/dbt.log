[0m18:52:06.352389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72ccb9af0050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72ccbbe9b950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72ccb98385d0>]}


============================== 18:52:06.356077 | f5354b01-b7b3-4bc5-8cd9-fdf31314330e ==============================
[0m18:52:06.356077 [info ] [MainThread]: Running with dbt=1.6.18
[0m18:52:06.356369 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/workspaces/varengold_data_analyst_case/transformation', 'debug': 'False', 'warn_error': 'None', 'log_path': '/workspaces/varengold_data_analyst_case/transformation/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run-operation explore_schemas', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:52:06.420506 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f5354b01-b7b3-4bc5-8cd9-fdf31314330e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72ccb97a8610>]}
[0m18:52:06.428092 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f5354b01-b7b3-4bc5-8cd9-fdf31314330e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72ccb97c4890>]}
[0m18:52:06.428627 [info ] [MainThread]: Registered adapter: duckdb=1.6.2
[0m18:52:06.429087 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found 3 package(s) specified in packages.yml, but only 0 package(s) installed in dbt_packages. Run "dbt deps" to install package dependencies.
[0m18:52:06.429409 [debug] [MainThread]: Command `dbt run-operation` failed at 18:52:06.429327 after 0.08 seconds
[0m18:52:06.429618 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72ccb996f090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72ccb97d8c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72ccbdf4f490>]}
[0m18:52:06.429807 [debug] [MainThread]: Flushing usage events
[0m18:52:15.617398 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a6bc72b6ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a6bc7492d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a6bc8002510>]}


============================== 18:52:15.621063 | c663f173-4a3e-4d5f-89f6-cab108857431 ==============================
[0m18:52:15.621063 [info ] [MainThread]: Running with dbt=1.6.18
[0m18:52:15.621500 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/workspaces/varengold_data_analyst_case/transformation', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/workspaces/varengold_data_analyst_case/transformation/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt deps', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m18:52:15.642314 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c663f173-4a3e-4d5f-89f6-cab108857431', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a6bc75e7990>]}
[0m18:52:15.649640 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-71nztet0'
[0m18:52:15.650055 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m18:52:15.823766 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m18:52:15.824773 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/codegen.json
[0m18:52:15.959547 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/codegen.json 200
[0m18:52:15.962783 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m18:52:16.137204 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m18:52:16.143710 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/godatadriven/dbt_date.json
[0m18:52:16.295233 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/godatadriven/dbt_date.json 200
[0m18:52:16.303416 [info ] [MainThread]: Installing dbt-labs/codegen
[0m18:52:16.601431 [info ] [MainThread]: Installed from version 0.13.1
[0m18:52:16.601691 [info ] [MainThread]: Up to date!
[0m18:52:16.601888 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'c663f173-4a3e-4d5f-89f6-cab108857431', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a6bc75e4650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a6bc7608dd0>]}
[0m18:52:16.602090 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m18:52:16.983586 [info ] [MainThread]: Installed from version 1.3.0
[0m18:52:16.983891 [info ] [MainThread]: Up to date!
[0m18:52:16.984122 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'c663f173-4a3e-4d5f-89f6-cab108857431', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a6bc75e4650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a6bc7001ed0>]}
[0m18:52:16.984365 [info ] [MainThread]: Installing godatadriven/dbt_date
[0m18:52:17.709923 [info ] [MainThread]: Installed from version 0.11.0
[0m18:52:17.710384 [info ] [MainThread]: Updated version available: 0.14.1
[0m18:52:17.710679 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'c663f173-4a3e-4d5f-89f6-cab108857431', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a6bc72b4b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a6bc7677e10>]}
[0m18:52:17.710984 [info ] [MainThread]: 
[0m18:52:17.711217 [info ] [MainThread]: Updates available for packages: ['godatadriven/dbt_date']                 
Update your versions in packages.yml, then run dbt deps
[0m18:52:17.711844 [debug] [MainThread]: Command `dbt deps` succeeded at 18:52:17.711730 after 2.10 seconds
[0m18:52:17.712077 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a6bc72d4090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a6bc7675510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a6bc770bb10>]}
[0m18:52:17.712270 [debug] [MainThread]: Flushing usage events
[0m18:52:23.851101 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x765de2d0fc10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x765de2cb8ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x765de2d16650>]}


============================== 18:52:23.854154 | 2d606c17-1fe9-458d-9d84-4ef8f8b9e6ac ==============================
[0m18:52:23.854154 [info ] [MainThread]: Running with dbt=1.6.18
[0m18:52:23.854742 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/workspaces/varengold_data_analyst_case/transformation', 'log_path': '/workspaces/varengold_data_analyst_case/transformation/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run-operation explore_schemas', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:52:23.914068 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2d606c17-1fe9-458d-9d84-4ef8f8b9e6ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x765ddf30d190>]}
[0m18:52:23.922027 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2d606c17-1fe9-458d-9d84-4ef8f8b9e6ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x765de2e6eed0>]}
[0m18:52:23.922486 [info ] [MainThread]: Registered adapter: duckdb=1.6.2
[0m18:52:23.942658 [debug] [MainThread]: checksum: 7b9fab86a08e9e96a48a825af743c566d95b877e068b8c6d0dbafbf714447189, vars: {}, profile: , target: , version: 1.6.18
[0m18:52:23.943127 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m18:52:23.943349 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '2d606c17-1fe9-458d-9d84-4ef8f8b9e6ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x765de2fc7f10>]}
[0m18:52:24.850098 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.vg_casestudy.main
- models.vg_casestudy.reporting
- models.vg_casestudy.marts
[0m18:52:24.855354 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2d606c17-1fe9-458d-9d84-4ef8f8b9e6ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x765de2a32ed0>]}
[0m18:52:24.875330 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2d606c17-1fe9-458d-9d84-4ef8f8b9e6ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x765dd7a1fe50>]}
[0m18:52:24.875700 [info ] [MainThread]: Found 11 models, 1 analysis, 2 seeds, 71 tests, 5 sources, 0 exposures, 0 metrics, 632 macros, 0 groups, 0 semantic models
[0m18:52:24.875918 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2d606c17-1fe9-458d-9d84-4ef8f8b9e6ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x765de2cb8810>]}
[0m18:52:24.876386 [debug] [MainThread]: Acquiring new duckdb connection 'macro_explore_schemas'
[0m18:52:24.876573 [debug] [MainThread]: Using duckdb connection "macro_explore_schemas"
[0m18:52:24.876730 [debug] [MainThread]: On macro_explore_schemas: BEGIN
[0m18:52:24.876886 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:52:27.905884 [debug] [MainThread]: SQL status: OK in 3.0 seconds
[0m18:52:27.906214 [debug] [MainThread]: On macro_explore_schemas: COMMIT
[0m18:52:27.906396 [debug] [MainThread]: Using duckdb connection "macro_explore_schemas"
[0m18:52:27.906555 [debug] [MainThread]: On macro_explore_schemas: COMMIT
[0m18:52:27.906943 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m18:52:27.913046 [debug] [MainThread]: Using duckdb connection "macro_explore_schemas"
[0m18:52:27.913278 [debug] [MainThread]: On macro_explore_schemas: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "macro_explore_schemas"} */

    
        SELECT schema_name FROM information_schema.schemata
    
  
[0m18:52:27.914572 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m18:52:27.915410 [debug] [MainThread]: On macro_explore_schemas: Close
[0m18:52:27.917609 [debug] [MainThread]: Command `dbt run-operation` succeeded at 18:52:27.917532 after 4.07 seconds
[0m18:52:27.917792 [debug] [MainThread]: Connection 'macro_explore_schemas' was properly closed.
[0m18:52:27.917970 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x765de2e6cf50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x765de2c69ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x765ddf327250>]}
[0m18:52:27.918188 [debug] [MainThread]: Flushing usage events
[0m18:53:26.187163 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b1d5bb88650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b1d5b8b72d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b1d5bb989d0>]}


============================== 18:53:26.190083 | 26ed4d6c-702e-48e7-83cc-bce0d51bf469 ==============================
[0m18:53:26.190083 [info ] [MainThread]: Running with dbt=1.6.18
[0m18:53:26.190682 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/workspaces/varengold_data_analyst_case/transformation', 'debug': 'False', 'version_check': 'True', 'log_path': '/workspaces/varengold_data_analyst_case/transformation/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': "dbt run-operation explore_tables --args {'schema_name' : 'raw'}", 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:53:26.251440 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '26ed4d6c-702e-48e7-83cc-bce0d51bf469', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b1d5b5c5650>]}
[0m18:53:26.259247 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '26ed4d6c-702e-48e7-83cc-bce0d51bf469', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b1d5b59a010>]}
[0m18:53:26.259702 [info ] [MainThread]: Registered adapter: duckdb=1.6.2
[0m18:53:26.272305 [debug] [MainThread]: checksum: 7b9fab86a08e9e96a48a825af743c566d95b877e068b8c6d0dbafbf714447189, vars: {}, profile: , target: , version: 1.6.18
[0m18:53:26.294126 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:53:26.294421 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:53:26.295207 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.vg_casestudy.main
- models.vg_casestudy.reporting
- models.vg_casestudy.marts
[0m18:53:26.299437 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '26ed4d6c-702e-48e7-83cc-bce0d51bf469', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b1d5b8b4b90>]}
[0m18:53:26.314631 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '26ed4d6c-702e-48e7-83cc-bce0d51bf469', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b1d57ec7010>]}
[0m18:53:26.314988 [info ] [MainThread]: Found 11 models, 1 analysis, 2 seeds, 71 tests, 5 sources, 0 exposures, 0 metrics, 632 macros, 0 groups, 0 semantic models
[0m18:53:26.315185 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '26ed4d6c-702e-48e7-83cc-bce0d51bf469', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b1d5b5e5790>]}
[0m18:53:26.315632 [debug] [MainThread]: Acquiring new duckdb connection 'macro_explore_tables'
[0m18:53:26.315817 [debug] [MainThread]: Using duckdb connection "macro_explore_tables"
[0m18:53:26.315981 [debug] [MainThread]: On macro_explore_tables: BEGIN
[0m18:53:26.316119 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:53:26.325444 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m18:53:26.325742 [debug] [MainThread]: On macro_explore_tables: COMMIT
[0m18:53:26.325913 [debug] [MainThread]: Using duckdb connection "macro_explore_tables"
[0m18:53:26.326072 [debug] [MainThread]: On macro_explore_tables: COMMIT
[0m18:53:26.326410 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m18:53:26.332538 [debug] [MainThread]: Using duckdb connection "macro_explore_tables"
[0m18:53:26.332776 [debug] [MainThread]: On macro_explore_tables: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "macro_explore_tables"} */

    
        SELECT table_name 
        FROM information_schema.tables 
        WHERE table_schema = 'raw'
    
  
[0m18:53:26.339938 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m18:53:26.340801 [debug] [MainThread]: On macro_explore_tables: Close
[0m18:53:26.343896 [debug] [MainThread]: Command `dbt run-operation` succeeded at 18:53:26.343802 after 0.16 seconds
[0m18:53:26.344141 [debug] [MainThread]: Connection 'macro_explore_tables' was properly closed.
[0m18:53:26.344364 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b1d57ecd5d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b1d5bb67d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b1d5b8b6f90>]}
[0m18:53:26.344599 [debug] [MainThread]: Flushing usage events
[0m02:27:08.041012 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x717358bc7610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x717358bb6d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x717358d18210>]}


============================== 02:27:08.045130 | d4135266-a19c-465d-ae63-59b65a852018 ==============================
[0m02:27:08.045130 [info ] [MainThread]: Running with dbt=1.6.18
[0m02:27:08.045442 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/workspaces/varengold_data_analyst_case/transformation/logs', 'version_check': 'True', 'profiles_dir': '/workspaces/varengold_data_analyst_case/transformation', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt deps', 'send_anonymous_usage_stats': 'True'}
[0m02:27:08.067870 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd4135266-a19c-465d-ae63-59b65a852018', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71735875d890>]}
[0m02:27:08.068495 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-91g19c8v'
[0m02:27:08.068837 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m02:27:08.253751 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m02:27:08.254993 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/codegen.json
[0m02:27:08.406604 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/codegen.json 200
[0m02:27:08.409110 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m02:27:08.574758 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m02:27:08.578811 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/godatadriven/dbt_date.json
[0m02:27:08.739389 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/godatadriven/dbt_date.json 200
[0m02:27:08.749471 [info ] [MainThread]: Installing dbt-labs/codegen
[0m02:27:09.073166 [info ] [MainThread]: Installed from version 0.13.1
[0m02:27:09.073426 [info ] [MainThread]: Up to date!
[0m02:27:09.073617 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'd4135266-a19c-465d-ae63-59b65a852018', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x717358d09fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7173589ec950>]}
[0m02:27:09.073811 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m02:27:09.422227 [info ] [MainThread]: Installed from version 1.3.0
[0m02:27:09.422499 [info ] [MainThread]: Up to date!
[0m02:27:09.422702 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'd4135266-a19c-465d-ae63-59b65a852018', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7173589d8550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x717358d09fd0>]}
[0m02:27:09.422915 [info ] [MainThread]: Installing godatadriven/dbt_date
[0m02:27:09.805247 [info ] [MainThread]: Installed from version 0.11.0
[0m02:27:09.805530 [info ] [MainThread]: Updated version available: 0.14.1
[0m02:27:09.805745 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'd4135266-a19c-465d-ae63-59b65a852018', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71735873b190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x717358722c10>]}
[0m02:27:09.805963 [info ] [MainThread]: 
[0m02:27:09.806147 [info ] [MainThread]: Updates available for packages: ['godatadriven/dbt_date']                 
Update your versions in packages.yml, then run dbt deps
[0m02:27:09.806596 [debug] [MainThread]: Command `dbt deps` succeeded at 02:27:09.806503 after 1.77 seconds
[0m02:27:09.806815 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71735d278e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71735d304bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71735d305d90>]}
[0m02:27:09.807002 [debug] [MainThread]: Flushing usage events
[0m02:27:14.933237 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7185c65e2890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7185c65cc550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7185c6463310>]}


============================== 02:27:14.936286 | 0b0329fb-cf28-4293-b1b2-c45dbb3ba5b0 ==============================
[0m02:27:14.936286 [info ] [MainThread]: Running with dbt=1.6.18
[0m02:27:14.936685 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/workspaces/varengold_data_analyst_case/transformation', 'debug': 'False', 'version_check': 'True', 'log_path': '/workspaces/varengold_data_analyst_case/transformation/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m02:27:14.992584 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0b0329fb-cf28-4293-b1b2-c45dbb3ba5b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7185c62b24d0>]}
[0m02:27:15.000546 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0b0329fb-cf28-4293-b1b2-c45dbb3ba5b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7185c65dbd90>]}
[0m02:27:15.001089 [info ] [MainThread]: Registered adapter: duckdb=1.6.2
[0m02:27:15.014964 [debug] [MainThread]: checksum: 7b9fab86a08e9e96a48a825af743c566d95b877e068b8c6d0dbafbf714447189, vars: {}, profile: , target: , version: 1.6.18
[0m02:27:15.027368 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m02:27:15.027712 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '0b0329fb-cf28-4293-b1b2-c45dbb3ba5b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7185c2908310>]}
[0m02:27:15.936691 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.vg_casestudy.main
- models.vg_casestudy.reporting
- models.vg_casestudy.marts
[0m02:27:15.940370 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0b0329fb-cf28-4293-b1b2-c45dbb3ba5b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7185c1e31c50>]}
[0m02:27:15.953459 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0b0329fb-cf28-4293-b1b2-c45dbb3ba5b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7185bb1e7e90>]}
[0m02:27:15.953808 [info ] [MainThread]: Found 11 models, 1 analysis, 2 seeds, 71 tests, 5 sources, 0 exposures, 0 metrics, 632 macros, 0 groups, 0 semantic models
[0m02:27:15.954012 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0b0329fb-cf28-4293-b1b2-c45dbb3ba5b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7185bb1a8d90>]}
[0m02:27:15.955909 [info ] [MainThread]: 
[0m02:27:15.956381 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m02:27:15.958002 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_casestudy'
[0m02:27:15.968384 [debug] [ThreadPool]: Using duckdb connection "list_casestudy"
[0m02:27:15.968611 [debug] [ThreadPool]: On list_casestudy: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"casestudy"'
    
  
  
[0m02:27:15.968782 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:27:20.478374 [debug] [ThreadPool]: SQL status: OK in 5.0 seconds
[0m02:27:20.479364 [debug] [ThreadPool]: On list_casestudy: Close
[0m02:27:20.484855 [debug] [ThreadPool]: Using duckdb connection "list_casestudy"
[0m02:27:20.485150 [debug] [ThreadPool]: On list_casestudy: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"casestudy"'
    
  
  
[0m02:27:20.485322 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:27:20.492625 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m02:27:20.493344 [debug] [ThreadPool]: On list_casestudy: Close
[0m02:27:20.494779 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy, now create_casestudy_staging)
[0m02:27:20.495189 [debug] [ThreadPool]: Creating schema "database: "casestudy"
schema: "staging"
"
[0m02:27:20.497714 [debug] [ThreadPool]: Using duckdb connection "create_casestudy_staging"
[0m02:27:20.497908 [debug] [ThreadPool]: On create_casestudy_staging: BEGIN
[0m02:27:20.498062 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:27:20.504335 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m02:27:20.504527 [debug] [ThreadPool]: Using duckdb connection "create_casestudy_staging"
[0m02:27:20.504694 [debug] [ThreadPool]: On create_casestudy_staging: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "create_casestudy_staging"} */
create schema if not exists "casestudy"."staging"
[0m02:27:20.504959 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m02:27:20.505452 [debug] [ThreadPool]: On create_casestudy_staging: COMMIT
[0m02:27:20.505623 [debug] [ThreadPool]: Using duckdb connection "create_casestudy_staging"
[0m02:27:20.505780 [debug] [ThreadPool]: On create_casestudy_staging: COMMIT
[0m02:27:20.506017 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m02:27:20.506196 [debug] [ThreadPool]: On create_casestudy_staging: Close
[0m02:27:20.507663 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_casestudy_staging, now create_casestudy_intermediate)
[0m02:27:20.508040 [debug] [ThreadPool]: Creating schema "database: "casestudy"
schema: "intermediate"
"
[0m02:27:20.509184 [debug] [ThreadPool]: Using duckdb connection "create_casestudy_intermediate"
[0m02:27:20.509418 [debug] [ThreadPool]: On create_casestudy_intermediate: BEGIN
[0m02:27:20.509571 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:27:20.515771 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m02:27:20.515962 [debug] [ThreadPool]: Using duckdb connection "create_casestudy_intermediate"
[0m02:27:20.516133 [debug] [ThreadPool]: On create_casestudy_intermediate: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "create_casestudy_intermediate"} */
create schema if not exists "casestudy"."intermediate"
[0m02:27:20.516412 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m02:27:20.516859 [debug] [ThreadPool]: On create_casestudy_intermediate: COMMIT
[0m02:27:20.517032 [debug] [ThreadPool]: Using duckdb connection "create_casestudy_intermediate"
[0m02:27:20.517195 [debug] [ThreadPool]: On create_casestudy_intermediate: COMMIT
[0m02:27:20.517438 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m02:27:20.517607 [debug] [ThreadPool]: On create_casestudy_intermediate: Close
[0m02:27:20.519969 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_casestudy_intermediate, now list_casestudy_staging)
[0m02:27:20.525942 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_staging"
[0m02:27:20.526303 [debug] [ThreadPool]: On list_casestudy_staging: BEGIN
[0m02:27:20.526583 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:27:20.536110 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m02:27:20.536311 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_staging"
[0m02:27:20.536484 [debug] [ThreadPool]: On list_casestudy_staging: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_staging"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'staging'
    and table_catalog = 'casestudy'
  
[0m02:27:20.543182 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m02:27:20.543980 [debug] [ThreadPool]: On list_casestudy_staging: ROLLBACK
[0m02:27:20.544472 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_staging'
[0m02:27:20.544646 [debug] [ThreadPool]: On list_casestudy_staging: Close
[0m02:27:20.546059 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy_staging, now list_casestudy_intermediate)
[0m02:27:20.547712 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_intermediate"
[0m02:27:20.547893 [debug] [ThreadPool]: On list_casestudy_intermediate: BEGIN
[0m02:27:20.548046 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:27:20.554311 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m02:27:20.554503 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_intermediate"
[0m02:27:20.554678 [debug] [ThreadPool]: On list_casestudy_intermediate: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_intermediate"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'intermediate'
    and table_catalog = 'casestudy'
  
[0m02:27:20.561570 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m02:27:20.562480 [debug] [ThreadPool]: On list_casestudy_intermediate: ROLLBACK
[0m02:27:20.562776 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_intermediate'
[0m02:27:20.562941 [debug] [ThreadPool]: On list_casestudy_intermediate: Close
[0m02:27:20.564562 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy_intermediate, now list_casestudy_raw)
[0m02:27:20.566812 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_raw"
[0m02:27:20.566987 [debug] [ThreadPool]: On list_casestudy_raw: BEGIN
[0m02:27:20.567132 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:27:20.573717 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m02:27:20.573900 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_raw"
[0m02:27:20.574054 [debug] [ThreadPool]: On list_casestudy_raw: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_raw"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'raw'
    and table_catalog = 'casestudy'
  
[0m02:27:20.580469 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m02:27:20.581176 [debug] [ThreadPool]: On list_casestudy_raw: ROLLBACK
[0m02:27:20.581442 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_raw'
[0m02:27:20.581595 [debug] [ThreadPool]: On list_casestudy_raw: Close
[0m02:27:20.583969 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0b0329fb-cf28-4293-b1b2-c45dbb3ba5b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7185c1dab0d0>]}
[0m02:27:20.584531 [debug] [MainThread]: Using duckdb connection "master"
[0m02:27:20.584884 [debug] [MainThread]: On master: BEGIN
[0m02:27:20.585221 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:27:20.592872 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m02:27:20.593063 [debug] [MainThread]: On master: COMMIT
[0m02:27:20.593233 [debug] [MainThread]: Using duckdb connection "master"
[0m02:27:20.593380 [debug] [MainThread]: On master: COMMIT
[0m02:27:20.593621 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m02:27:20.593787 [debug] [MainThread]: On master: Close
[0m02:27:20.595034 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:27:20.595253 [info ] [MainThread]: 
[0m02:27:20.606495 [debug] [Thread-1 (]: Began running node model.vg_casestudy.stg_raw_staging__accounts
[0m02:27:20.607257 [info ] [Thread-1 (]: 1 of 11 START sql view model staging.stg_raw_staging__accounts ................. [RUN]
[0m02:27:20.608139 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.vg_casestudy.stg_raw_staging__accounts'
[0m02:27:20.608437 [debug] [Thread-1 (]: Began compiling node model.vg_casestudy.stg_raw_staging__accounts
[0m02:27:20.613678 [debug] [Thread-1 (]: Writing injected SQL for node "model.vg_casestudy.stg_raw_staging__accounts"
[0m02:27:20.614257 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.stg_raw_staging__accounts (compile): 02:27:20.608578 => 02:27:20.614090
[0m02:27:20.614487 [debug] [Thread-1 (]: Began executing node model.vg_casestudy.stg_raw_staging__accounts
[0m02:27:20.633739 [debug] [Thread-1 (]: Writing runtime sql for node "model.vg_casestudy.stg_raw_staging__accounts"
[0m02:27:20.634264 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_raw_staging__accounts"
[0m02:27:20.634463 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__accounts: BEGIN
[0m02:27:20.634638 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m02:27:20.644326 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:27:20.644577 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_raw_staging__accounts"
[0m02:27:20.644813 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__accounts: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_raw_staging__accounts"} */

  
  create view "casestudy"."staging"."stg_raw_staging__accounts__dbt_tmp" as (
    with source as (
    select * from "casestudy"."raw"."accounts"
),

renamed as (
    select
        account_id,
        customer_id,
        account_type,
        
CASE
    -- First try DD.MM.YYYY format (German format with dots)
    WHEN REGEXP_MATCHES(account_opening_date, '^\d{1,2}\.\d{1,2}\.\d{4}$') 
        THEN TRY_CAST(STRPTIME(account_opening_date, '%d.%m.%Y') AS DATE)
        
    -- Then try DD/MM/YYYY format (with slashes)
    WHEN REGEXP_MATCHES(account_opening_date, '^\d{1,2}/\d{1,2}/\d{4}$')
        AND CAST(SPLIT_PART(account_opening_date, '/', 1) AS INTEGER) <= 31 
        AND CAST(SPLIT_PART(account_opening_date, '/', 2) AS INTEGER) <= 12 
        THEN TRY_CAST(STRPTIME(account_opening_date, '%d/%m/%Y') AS DATE)
        
    -- Try MM/DD/YYYY format (US format with slashes)
    WHEN REGEXP_MATCHES(account_opening_date, '^\d{1,2}/\d{1,2}/\d{4}$')
        AND CAST(SPLIT_PART(account_opening_date, '/', 1) AS INTEGER) <= 12 
        THEN TRY_CAST(STRPTIME(account_opening_date, '%m/%d/%Y') AS DATE)
        
    -- Try YYYY-MM-DD format (ISO format)
    WHEN REGEXP_MATCHES(account_opening_date, '^\d{4}-\d{1,2}-\d{1,2}$')
        THEN TRY_CAST(STRPTIME(account_opening_date, '%Y-%m-%d') AS DATE)
        
    -- Try generic date parsing as last resort
    ELSE TRY_CAST(account_opening_date AS DATE)
END
 as account_opening_date,
        account_opening_date as account_opening_date_raw
    from source
    where account_type is not null and account_type != '' and account_type != '-'
),

final as (
    select
        account_id,
        customer_id,
        account_type,
        account_opening_date,
        -- Flag records with date parsing issues
        CASE WHEN account_opening_date IS NULL AND account_opening_date_raw IS NOT NULL
             THEN TRUE ELSE FALSE 
        END as has_date_parsing_error
    from renamed
)

select * from final
  );

[0m02:27:20.645843 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:27:20.649463 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_raw_staging__accounts"
[0m02:27:20.649687 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__accounts: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_raw_staging__accounts"} */
alter view "casestudy"."staging"."stg_raw_staging__accounts" rename to "stg_raw_staging__accounts__dbt_backup"
[0m02:27:20.650052 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:27:20.651552 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_raw_staging__accounts"
[0m02:27:20.651767 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__accounts: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_raw_staging__accounts"} */
alter view "casestudy"."staging"."stg_raw_staging__accounts__dbt_tmp" rename to "stg_raw_staging__accounts"
[0m02:27:20.652102 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:27:20.661033 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__accounts: COMMIT
[0m02:27:20.661248 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_raw_staging__accounts"
[0m02:27:20.661425 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__accounts: COMMIT
[0m02:27:20.662742 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:27:20.665360 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_raw_staging__accounts"
[0m02:27:20.665560 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__accounts: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_raw_staging__accounts"} */
drop view if exists "casestudy"."staging"."stg_raw_staging__accounts__dbt_backup" cascade
[0m02:27:20.666418 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:27:20.667190 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.stg_raw_staging__accounts (execute): 02:27:20.614622 => 02:27:20.667053
[0m02:27:20.667415 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__accounts: Close
[0m02:27:20.678400 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b0329fb-cf28-4293-b1b2-c45dbb3ba5b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7185c1d85dd0>]}
[0m02:27:20.679048 [info ] [Thread-1 (]: 1 of 11 OK created sql view model staging.stg_raw_staging__accounts ............ [[32mOK[0m in 0.07s]
[0m02:27:20.679494 [debug] [Thread-1 (]: Finished running node model.vg_casestudy.stg_raw_staging__accounts
[0m02:27:20.679798 [debug] [Thread-1 (]: Began running node model.vg_casestudy.stg_raw_staging__customers
[0m02:27:20.680340 [info ] [Thread-1 (]: 2 of 11 START sql view model staging.stg_raw_staging__customers ................ [RUN]
[0m02:27:20.680793 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.vg_casestudy.stg_raw_staging__accounts, now model.vg_casestudy.stg_raw_staging__customers)
[0m02:27:20.680989 [debug] [Thread-1 (]: Began compiling node model.vg_casestudy.stg_raw_staging__customers
[0m02:27:20.682745 [debug] [Thread-1 (]: Writing injected SQL for node "model.vg_casestudy.stg_raw_staging__customers"
[0m02:27:20.683088 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.stg_raw_staging__customers (compile): 02:27:20.681111 => 02:27:20.682978
[0m02:27:20.683285 [debug] [Thread-1 (]: Began executing node model.vg_casestudy.stg_raw_staging__customers
[0m02:27:20.685541 [debug] [Thread-1 (]: Writing runtime sql for node "model.vg_casestudy.stg_raw_staging__customers"
[0m02:27:20.685877 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_raw_staging__customers"
[0m02:27:20.686066 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__customers: BEGIN
[0m02:27:20.686241 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:27:20.695978 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:27:20.696258 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_raw_staging__customers"
[0m02:27:20.696459 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__customers: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_raw_staging__customers"} */

  
  create view "casestudy"."staging"."stg_raw_staging__customers__dbt_tmp" as (
    with source as (
    select * from "casestudy"."raw"."customers"
),

renamed as (
    select distinct
        customer_id,
        trim(firstname) as firstname,
        trim(lastname) as lastname,
        Age as age,
        branch_id
    from source
)

select * from renamed
  );

[0m02:27:20.697030 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:27:20.699086 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_raw_staging__customers"
[0m02:27:20.699333 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__customers: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_raw_staging__customers"} */
alter view "casestudy"."staging"."stg_raw_staging__customers" rename to "stg_raw_staging__customers__dbt_backup"
[0m02:27:20.699727 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:27:20.701548 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_raw_staging__customers"
[0m02:27:20.701767 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__customers: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_raw_staging__customers"} */
alter view "casestudy"."staging"."stg_raw_staging__customers__dbt_tmp" rename to "stg_raw_staging__customers"
[0m02:27:20.702128 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:27:20.703101 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__customers: COMMIT
[0m02:27:20.703321 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_raw_staging__customers"
[0m02:27:20.703499 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__customers: COMMIT
[0m02:27:20.705706 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:27:20.708295 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_raw_staging__customers"
[0m02:27:20.708525 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__customers: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_raw_staging__customers"} */
drop view if exists "casestudy"."staging"."stg_raw_staging__customers__dbt_backup" cascade
[0m02:27:20.709537 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:27:20.710464 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.stg_raw_staging__customers (execute): 02:27:20.683411 => 02:27:20.710360
[0m02:27:20.710675 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__customers: Close
[0m02:27:20.723084 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b0329fb-cf28-4293-b1b2-c45dbb3ba5b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7185baf2b8d0>]}
[0m02:27:20.723841 [info ] [Thread-1 (]: 2 of 11 OK created sql view model staging.stg_raw_staging__customers ........... [[32mOK[0m in 0.04s]
[0m02:27:20.724541 [debug] [Thread-1 (]: Finished running node model.vg_casestudy.stg_raw_staging__customers
[0m02:27:20.725031 [debug] [Thread-1 (]: Began running node model.vg_casestudy.stg_raw_staging__fx_rates
[0m02:27:20.725777 [info ] [Thread-1 (]: 3 of 11 START sql view model staging.stg_raw_staging__fx_rates ................. [RUN]
[0m02:27:20.726634 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.vg_casestudy.stg_raw_staging__customers, now model.vg_casestudy.stg_raw_staging__fx_rates)
[0m02:27:20.726833 [debug] [Thread-1 (]: Began compiling node model.vg_casestudy.stg_raw_staging__fx_rates
[0m02:27:20.728962 [debug] [Thread-1 (]: Writing injected SQL for node "model.vg_casestudy.stg_raw_staging__fx_rates"
[0m02:27:20.729325 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.stg_raw_staging__fx_rates (compile): 02:27:20.726953 => 02:27:20.729210
[0m02:27:20.729512 [debug] [Thread-1 (]: Began executing node model.vg_casestudy.stg_raw_staging__fx_rates
[0m02:27:20.731701 [debug] [Thread-1 (]: Writing runtime sql for node "model.vg_casestudy.stg_raw_staging__fx_rates"
[0m02:27:20.732009 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_raw_staging__fx_rates"
[0m02:27:20.732212 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__fx_rates: BEGIN
[0m02:27:20.732384 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:27:20.739788 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:27:20.740079 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_raw_staging__fx_rates"
[0m02:27:20.740348 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__fx_rates: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_raw_staging__fx_rates"} */

  
  create view "casestudy"."staging"."stg_raw_staging__fx_rates__dbt_tmp" as (
    with source as (
    select * from "casestudy"."raw"."fx_rates"
),

renamed as (
    select
        trim(currency_iso_code) as currency_iso_code,
        
CASE
    WHEN fx_rate IS NULL THEN NULL
    -- If the value is already a valid number
    WHEN TRY_CAST(fx_rate AS DOUBLE) IS NOT NULL 
        THEN TRY_CAST(fx_rate AS DOUBLE)
    -- If contains both dot and comma (German notation)
    WHEN POSITION('.' IN fx_rate) > 0 AND POSITION(',' IN fx_rate) > 0 
        THEN TRY_CAST(REPLACE(REPLACE(TRIM(fx_rate), '.', ''), ',', '.') AS DOUBLE)
    -- If only contains comma, treat as decimal point
    WHEN POSITION(',' IN fx_rate) > 0 
        THEN TRY_CAST(REPLACE(TRIM(fx_rate), ',', '.') AS DOUBLE)
    -- If only contains dots, likely thousands separator
    WHEN POSITION('.' IN fx_rate) > 0 
        THEN TRY_CAST(REPLACE(TRIM(fx_rate), '.', '') AS DOUBLE)
    ELSE NULL
END
 as fx_rate,
        
CASE
    -- First try DD.MM.YYYY format (German format with dots)
    WHEN REGEXP_MATCHES(date, '^\d{1,2}\.\d{1,2}\.\d{4}$') 
        THEN TRY_CAST(STRPTIME(date, '%d.%m.%Y') AS DATE)
        
    -- Then try DD/MM/YYYY format (with slashes)
    WHEN REGEXP_MATCHES(date, '^\d{1,2}/\d{1,2}/\d{4}$')
        AND CAST(SPLIT_PART(date, '/', 1) AS INTEGER) <= 31 
        AND CAST(SPLIT_PART(date, '/', 2) AS INTEGER) <= 12 
        THEN TRY_CAST(STRPTIME(date, '%d/%m/%Y') AS DATE)
        
    -- Try MM/DD/YYYY format (US format with slashes)
    WHEN REGEXP_MATCHES(date, '^\d{1,2}/\d{1,2}/\d{4}$')
        AND CAST(SPLIT_PART(date, '/', 1) AS INTEGER) <= 12 
        THEN TRY_CAST(STRPTIME(date, '%m/%d/%Y') AS DATE)
        
    -- Try YYYY-MM-DD format (ISO format)
    WHEN REGEXP_MATCHES(date, '^\d{4}-\d{1,2}-\d{1,2}$')
        THEN TRY_CAST(STRPTIME(date, '%Y-%m-%d') AS DATE)
        
    -- Try generic date parsing as last resort
    ELSE TRY_CAST(date AS DATE)
END
 as fx_rate_date,
        date as fx_rate_date_raw
    from source
    where currency_iso_code is not null and trim(currency_iso_code) not in  ('(none)', '')
),

final as (
    select
        currency_iso_code,
        fx_rate,
        fx_rate_date,
        -- Flag records with date parsing issues
        CASE WHEN fx_rate_date IS NULL AND fx_rate_date_raw IS NOT NULL
             THEN TRUE ELSE FALSE 
        END as has_date_parsing_error
    from renamed
)

select * from final
  );

[0m02:27:20.741543 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:27:20.744164 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_raw_staging__fx_rates"
[0m02:27:20.744382 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__fx_rates: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_raw_staging__fx_rates"} */
alter view "casestudy"."staging"."stg_raw_staging__fx_rates" rename to "stg_raw_staging__fx_rates__dbt_backup"
[0m02:27:20.744768 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:27:20.746405 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_raw_staging__fx_rates"
[0m02:27:20.746615 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__fx_rates: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_raw_staging__fx_rates"} */
alter view "casestudy"."staging"."stg_raw_staging__fx_rates__dbt_tmp" rename to "stg_raw_staging__fx_rates"
[0m02:27:20.746968 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:27:20.747882 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__fx_rates: COMMIT
[0m02:27:20.748086 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_raw_staging__fx_rates"
[0m02:27:20.748270 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__fx_rates: COMMIT
[0m02:27:20.749617 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:27:20.751021 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_raw_staging__fx_rates"
[0m02:27:20.751234 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__fx_rates: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_raw_staging__fx_rates"} */
drop view if exists "casestudy"."staging"."stg_raw_staging__fx_rates__dbt_backup" cascade
[0m02:27:20.752255 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:27:20.753026 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.stg_raw_staging__fx_rates (execute): 02:27:20.729638 => 02:27:20.752919
[0m02:27:20.753239 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__fx_rates: Close
[0m02:27:20.764105 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b0329fb-cf28-4293-b1b2-c45dbb3ba5b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7185bb192150>]}
[0m02:27:20.764472 [info ] [Thread-1 (]: 3 of 11 OK created sql view model staging.stg_raw_staging__fx_rates ............ [[32mOK[0m in 0.04s]
[0m02:27:20.764765 [debug] [Thread-1 (]: Finished running node model.vg_casestudy.stg_raw_staging__fx_rates
[0m02:27:20.764985 [debug] [Thread-1 (]: Began running node model.vg_casestudy.stg_raw_staging__loans
[0m02:27:20.765209 [info ] [Thread-1 (]: 4 of 11 START sql view model staging.stg_raw_staging__loans .................... [RUN]
[0m02:27:20.765723 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.vg_casestudy.stg_raw_staging__fx_rates, now model.vg_casestudy.stg_raw_staging__loans)
[0m02:27:20.765917 [debug] [Thread-1 (]: Began compiling node model.vg_casestudy.stg_raw_staging__loans
[0m02:27:20.767956 [debug] [Thread-1 (]: Writing injected SQL for node "model.vg_casestudy.stg_raw_staging__loans"
[0m02:27:20.768304 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.stg_raw_staging__loans (compile): 02:27:20.766028 => 02:27:20.768191
[0m02:27:20.768518 [debug] [Thread-1 (]: Began executing node model.vg_casestudy.stg_raw_staging__loans
[0m02:27:20.770721 [debug] [Thread-1 (]: Writing runtime sql for node "model.vg_casestudy.stg_raw_staging__loans"
[0m02:27:20.771009 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_raw_staging__loans"
[0m02:27:20.771196 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__loans: BEGIN
[0m02:27:20.771360 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:27:20.780935 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:27:20.781251 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_raw_staging__loans"
[0m02:27:20.781545 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__loans: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_raw_staging__loans"} */

  
  create view "casestudy"."staging"."stg_raw_staging__loans__dbt_tmp" as (
    with source as (
    select * from "casestudy"."raw"."loans"
),

renamed as (
    select
        customer_id,
        loan_id,
        
CASE
    WHEN loan_amount IS NULL THEN NULL
    -- If the value is already a valid number
    WHEN TRY_CAST(loan_amount AS DOUBLE) IS NOT NULL 
        THEN TRY_CAST(loan_amount AS DOUBLE)
    -- If contains both dot and comma (German notation)
    WHEN POSITION('.' IN loan_amount) > 0 AND POSITION(',' IN loan_amount) > 0 
        THEN TRY_CAST(REPLACE(REPLACE(TRIM(loan_amount), '.', ''), ',', '.') AS DOUBLE)
    -- If only contains comma, treat as decimal point
    WHEN POSITION(',' IN loan_amount) > 0 
        THEN TRY_CAST(REPLACE(TRIM(loan_amount), ',', '.') AS DOUBLE)
    -- If only contains dots, likely thousands separator
    WHEN POSITION('.' IN loan_amount) > 0 
        THEN TRY_CAST(REPLACE(TRIM(loan_amount), '.', '') AS DOUBLE)
    ELSE NULL
END
 as loan_amount,
        loant_type,
        
CASE
    WHEN interest_rate IS NULL THEN NULL
    -- If the value is already a valid number
    WHEN TRY_CAST(interest_rate AS DOUBLE) IS NOT NULL 
        THEN TRY_CAST(interest_rate AS DOUBLE)
    -- If contains both dot and comma (German notation)
    WHEN POSITION('.' IN interest_rate) > 0 AND POSITION(',' IN interest_rate) > 0 
        THEN TRY_CAST(REPLACE(REPLACE(TRIM(interest_rate), '.', ''), ',', '.') AS DOUBLE)
    -- If only contains comma, treat as decimal point
    WHEN POSITION(',' IN interest_rate) > 0 
        THEN TRY_CAST(REPLACE(TRIM(interest_rate), ',', '.') AS DOUBLE)
    -- If only contains dots, likely thousands separator
    WHEN POSITION('.' IN interest_rate) > 0 
        THEN TRY_CAST(REPLACE(TRIM(interest_rate), '.', '') AS DOUBLE)
    ELSE NULL
END
 as interest_rate,
        loan_term,
        
CASE
    -- First try DD.MM.YYYY format (German format with dots)
    WHEN REGEXP_MATCHES(approval_rejection_date, '^\d{1,2}\.\d{1,2}\.\d{4}$') 
        THEN TRY_CAST(STRPTIME(approval_rejection_date, '%d.%m.%Y') AS DATE)
        
    -- Then try DD/MM/YYYY format (with slashes)
    WHEN REGEXP_MATCHES(approval_rejection_date, '^\d{1,2}/\d{1,2}/\d{4}$')
        AND CAST(SPLIT_PART(approval_rejection_date, '/', 1) AS INTEGER) <= 31 
        AND CAST(SPLIT_PART(approval_rejection_date, '/', 2) AS INTEGER) <= 12 
        THEN TRY_CAST(STRPTIME(approval_rejection_date, '%d/%m/%Y') AS DATE)
        
    -- Try MM/DD/YYYY format (US format with slashes)
    WHEN REGEXP_MATCHES(approval_rejection_date, '^\d{1,2}/\d{1,2}/\d{4}$')
        AND CAST(SPLIT_PART(approval_rejection_date, '/', 1) AS INTEGER) <= 12 
        THEN TRY_CAST(STRPTIME(approval_rejection_date, '%m/%d/%Y') AS DATE)
        
    -- Try YYYY-MM-DD format (ISO format)
    WHEN REGEXP_MATCHES(approval_rejection_date, '^\d{4}-\d{1,2}-\d{1,2}$')
        THEN TRY_CAST(STRPTIME(approval_rejection_date, '%Y-%m-%d') AS DATE)
        
    -- Try generic date parsing as last resort
    ELSE TRY_CAST(approval_rejection_date AS DATE)
END
 as approval_rejection_date,
        approval_rejection_date as approval_rejection_date_raw,
        loan_status
    from source
),

final as (
    select
        customer_id,
        loan_id,
        loan_amount,
        loant_type as loan_type,
        interest_rate,
        loan_term,
        approval_rejection_date,
        loan_status,
        -- Flag records with date parsing issues
        CASE WHEN approval_rejection_date IS NULL AND approval_rejection_date_raw IS NOT NULL
             THEN TRUE ELSE FALSE 
        END as has_date_parsing_error
    from renamed
)

select * from final
  );

[0m02:27:20.783080 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:27:20.786451 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_raw_staging__loans"
[0m02:27:20.786709 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__loans: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_raw_staging__loans"} */
alter view "casestudy"."staging"."stg_raw_staging__loans" rename to "stg_raw_staging__loans__dbt_backup"
[0m02:27:20.787195 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:27:20.789993 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_raw_staging__loans"
[0m02:27:20.790226 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__loans: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_raw_staging__loans"} */
alter view "casestudy"."staging"."stg_raw_staging__loans__dbt_tmp" rename to "stg_raw_staging__loans"
[0m02:27:20.790603 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:27:20.791525 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__loans: COMMIT
[0m02:27:20.791730 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_raw_staging__loans"
[0m02:27:20.791910 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__loans: COMMIT
[0m02:27:20.793313 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:27:20.794571 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_raw_staging__loans"
[0m02:27:20.794780 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__loans: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_raw_staging__loans"} */
drop view if exists "casestudy"."staging"."stg_raw_staging__loans__dbt_backup" cascade
[0m02:27:20.795656 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:27:20.796382 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.stg_raw_staging__loans (execute): 02:27:20.768682 => 02:27:20.796284
[0m02:27:20.796575 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__loans: Close
[0m02:27:20.807139 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b0329fb-cf28-4293-b1b2-c45dbb3ba5b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7185baf51b10>]}
[0m02:27:20.807486 [info ] [Thread-1 (]: 4 of 11 OK created sql view model staging.stg_raw_staging__loans ............... [[32mOK[0m in 0.04s]
[0m02:27:20.807777 [debug] [Thread-1 (]: Finished running node model.vg_casestudy.stg_raw_staging__loans
[0m02:27:20.807985 [debug] [Thread-1 (]: Began running node model.vg_casestudy.stg_raw_staging__transactions
[0m02:27:20.808206 [info ] [Thread-1 (]: 5 of 11 START sql view model staging.stg_raw_staging__transactions ............. [RUN]
[0m02:27:20.808632 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.vg_casestudy.stg_raw_staging__loans, now model.vg_casestudy.stg_raw_staging__transactions)
[0m02:27:20.808899 [debug] [Thread-1 (]: Began compiling node model.vg_casestudy.stg_raw_staging__transactions
[0m02:27:20.810856 [debug] [Thread-1 (]: Writing injected SQL for node "model.vg_casestudy.stg_raw_staging__transactions"
[0m02:27:20.811180 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.stg_raw_staging__transactions (compile): 02:27:20.809020 => 02:27:20.811070
[0m02:27:20.811360 [debug] [Thread-1 (]: Began executing node model.vg_casestudy.stg_raw_staging__transactions
[0m02:27:20.813395 [debug] [Thread-1 (]: Writing runtime sql for node "model.vg_casestudy.stg_raw_staging__transactions"
[0m02:27:20.813669 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_raw_staging__transactions"
[0m02:27:20.813851 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__transactions: BEGIN
[0m02:27:20.814015 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:27:20.825772 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:27:20.826070 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_raw_staging__transactions"
[0m02:27:20.826318 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__transactions: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_raw_staging__transactions"} */

  
  create view "casestudy"."staging"."stg_raw_staging__transactions__dbt_tmp" as (
    with source as (
    select * from "casestudy"."raw"."transactions"
),

renamed as (
    select
        transaction_id,
        
CASE
    -- First try DD.MM.YYYY format (German format with dots)
    WHEN REGEXP_MATCHES(transaction_date, '^\d{1,2}\.\d{1,2}\.\d{4}$') 
        THEN TRY_CAST(STRPTIME(transaction_date, '%d.%m.%Y') AS DATE)
        
    -- Then try DD/MM/YYYY format (with slashes)
    WHEN REGEXP_MATCHES(transaction_date, '^\d{1,2}/\d{1,2}/\d{4}$')
        AND CAST(SPLIT_PART(transaction_date, '/', 1) AS INTEGER) <= 31 
        AND CAST(SPLIT_PART(transaction_date, '/', 2) AS INTEGER) <= 12 
        THEN TRY_CAST(STRPTIME(transaction_date, '%d/%m/%Y') AS DATE)
        
    -- Try MM/DD/YYYY format (US format with slashes)
    WHEN REGEXP_MATCHES(transaction_date, '^\d{1,2}/\d{1,2}/\d{4}$')
        AND CAST(SPLIT_PART(transaction_date, '/', 1) AS INTEGER) <= 12 
        THEN TRY_CAST(STRPTIME(transaction_date, '%m/%d/%Y') AS DATE)
        
    -- Try YYYY-MM-DD format (ISO format)
    WHEN REGEXP_MATCHES(transaction_date, '^\d{4}-\d{1,2}-\d{1,2}$')
        THEN TRY_CAST(STRPTIME(transaction_date, '%Y-%m-%d') AS DATE)
        
    -- Try generic date parsing as last resort
    ELSE TRY_CAST(transaction_date AS DATE)
END
 as transaction_date,
        transaction_date as transaction_date_raw,
        account_id,
        trim(transaction_type) as transaction_type,
        
CASE
    WHEN transaction_amount IS NULL THEN NULL
    -- If the value is already a valid number
    WHEN TRY_CAST(transaction_amount AS DOUBLE) IS NOT NULL 
        THEN TRY_CAST(transaction_amount AS DOUBLE)
    -- If contains both dot and comma (German notation)
    WHEN POSITION('.' IN transaction_amount) > 0 AND POSITION(',' IN transaction_amount) > 0 
        THEN TRY_CAST(REPLACE(REPLACE(TRIM(transaction_amount), '.', ''), ',', '.') AS DOUBLE)
    -- If only contains comma, treat as decimal point
    WHEN POSITION(',' IN transaction_amount) > 0 
        THEN TRY_CAST(REPLACE(TRIM(transaction_amount), ',', '.') AS DOUBLE)
    -- If only contains dots, likely thousands separator
    WHEN POSITION('.' IN transaction_amount) > 0 
        THEN TRY_CAST(REPLACE(TRIM(transaction_amount), '.', '') AS DOUBLE)
    ELSE NULL
END
 as transaction_amount,
        trim(transaction_currency) as transaction_currency
    from source
),

final as (
    select
        transaction_id,
        transaction_date,
        account_id,
        transaction_type,
        transaction_amount,
        transaction_currency,
        -- Flag records with date parsing issues
        CASE WHEN transaction_date IS NULL AND transaction_date_raw IS NOT NULL
             THEN TRUE ELSE FALSE 
        END as has_date_parsing_error
    from renamed
)

select * from final
  );

[0m02:27:20.827503 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:27:20.829382 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_raw_staging__transactions"
[0m02:27:20.829581 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__transactions: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_raw_staging__transactions"} */
alter view "casestudy"."staging"."stg_raw_staging__transactions" rename to "stg_raw_staging__transactions__dbt_backup"
[0m02:27:20.829936 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:27:20.831415 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_raw_staging__transactions"
[0m02:27:20.831612 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__transactions: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_raw_staging__transactions"} */
alter view "casestudy"."staging"."stg_raw_staging__transactions__dbt_tmp" rename to "stg_raw_staging__transactions"
[0m02:27:20.831936 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:27:20.832784 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__transactions: COMMIT
[0m02:27:20.832976 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_raw_staging__transactions"
[0m02:27:20.833146 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__transactions: COMMIT
[0m02:27:20.834775 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:27:20.836044 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_raw_staging__transactions"
[0m02:27:20.836246 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__transactions: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_raw_staging__transactions"} */
drop view if exists "casestudy"."staging"."stg_raw_staging__transactions__dbt_backup" cascade
[0m02:27:20.837315 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:27:20.838015 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.stg_raw_staging__transactions (execute): 02:27:20.811476 => 02:27:20.837918
[0m02:27:20.838211 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__transactions: Close
[0m02:27:20.848695 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b0329fb-cf28-4293-b1b2-c45dbb3ba5b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7185baf53ad0>]}
[0m02:27:20.849036 [info ] [Thread-1 (]: 5 of 11 OK created sql view model staging.stg_raw_staging__transactions ........ [[32mOK[0m in 0.04s]
[0m02:27:20.849342 [debug] [Thread-1 (]: Finished running node model.vg_casestudy.stg_raw_staging__transactions
[0m02:27:20.849558 [debug] [Thread-1 (]: Began running node model.vg_casestudy.stg_staging_intermediate__currencies
[0m02:27:20.849772 [info ] [Thread-1 (]: 6 of 11 START sql table model intermediate.stg_staging_intermediate__currencies  [RUN]
[0m02:27:20.850296 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.vg_casestudy.stg_raw_staging__transactions, now model.vg_casestudy.stg_staging_intermediate__currencies)
[0m02:27:20.850482 [debug] [Thread-1 (]: Began compiling node model.vg_casestudy.stg_staging_intermediate__currencies
[0m02:27:20.852098 [debug] [Thread-1 (]: Writing injected SQL for node "model.vg_casestudy.stg_staging_intermediate__currencies"
[0m02:27:20.852459 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.stg_staging_intermediate__currencies (compile): 02:27:20.850597 => 02:27:20.852351
[0m02:27:20.852637 [debug] [Thread-1 (]: Began executing node model.vg_casestudy.stg_staging_intermediate__currencies
[0m02:27:20.863987 [debug] [Thread-1 (]: Writing runtime sql for node "model.vg_casestudy.stg_staging_intermediate__currencies"
[0m02:27:20.864480 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__currencies"
[0m02:27:20.864673 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__currencies: BEGIN
[0m02:27:20.864849 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:27:20.872376 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:27:20.872701 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__currencies"
[0m02:27:20.872896 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__currencies: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_staging_intermediate__currencies"} */

  
    
    

    create  table
      "casestudy"."intermediate"."stg_staging_intermediate__currencies__dbt_tmp"
  
    as (
      with staging as (
    select * from "casestudy"."raw"."currencies"
),
cleaned as (
    select distinct
        trim(currency) as currency,
        trim(currency_iso_code) as currency_iso_code,
    from staging
    where currency_iso_code is not null and trim(currency_iso_code) != '(none)'
)

select * from cleaned
    );
  
  
[0m02:27:20.877516 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.stg_staging_intermediate__currencies (execute): 02:27:20.852754 => 02:27:20.877384
[0m02:27:20.877721 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__currencies: ROLLBACK
[0m02:27:20.879593 [debug] [Thread-1 (]: Failed to rollback 'model.vg_casestudy.stg_staging_intermediate__currencies'
[0m02:27:20.879802 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__currencies: Close
[0m02:27:20.882191 [debug] [Thread-1 (]: Runtime Error in model stg_staging_intermediate__currencies (models/intermediate/stg_staging_intermediate__currencies.sql)
  Catalog Error: Table with name currencies does not exist!
  Did you mean "staging.currencies"?
  
  LINE 12:     select * from "casestudy"."raw"."currencies"
                             ^
[0m02:27:20.882474 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b0329fb-cf28-4293-b1b2-c45dbb3ba5b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7185bafabb10>]}
[0m02:27:20.882802 [error] [Thread-1 (]: 6 of 11 ERROR creating sql table model intermediate.stg_staging_intermediate__currencies  [[31mERROR[0m in 0.03s]
[0m02:27:20.883113 [debug] [Thread-1 (]: Finished running node model.vg_casestudy.stg_staging_intermediate__currencies
[0m02:27:20.883342 [debug] [Thread-1 (]: Began running node model.vg_casestudy.stg_staging_intermediate__accounts
[0m02:27:20.884453 [info ] [Thread-1 (]: 7 of 11 START sql table model intermediate.stg_staging_intermediate__accounts .. [RUN]
[0m02:27:20.884782 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.vg_casestudy.stg_staging_intermediate__currencies, now model.vg_casestudy.stg_staging_intermediate__accounts)
[0m02:27:20.884962 [debug] [Thread-1 (]: Began compiling node model.vg_casestudy.stg_staging_intermediate__accounts
[0m02:27:20.886719 [debug] [Thread-1 (]: Writing injected SQL for node "model.vg_casestudy.stg_staging_intermediate__accounts"
[0m02:27:20.887054 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.stg_staging_intermediate__accounts (compile): 02:27:20.885073 => 02:27:20.886946
[0m02:27:20.887255 [debug] [Thread-1 (]: Began executing node model.vg_casestudy.stg_staging_intermediate__accounts
[0m02:27:20.889240 [debug] [Thread-1 (]: Writing runtime sql for node "model.vg_casestudy.stg_staging_intermediate__accounts"
[0m02:27:20.889526 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__accounts"
[0m02:27:20.889715 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__accounts: BEGIN
[0m02:27:20.889882 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:27:20.897399 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:27:20.897926 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__accounts"
[0m02:27:20.898139 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__accounts: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_staging_intermediate__accounts"} */

  
    
    

    create  table
      "casestudy"."intermediate"."stg_staging_intermediate__accounts__dbt_tmp"
  
    as (
      with staging as (
    select * from "casestudy"."staging"."stg_raw_staging__accounts"
), 
filtered as (
    select 
        account_id,
        customer_id,
        account_type,
        account_opening_date,
     from staging
    where not has_date_parsing_error
)

select * from filtered
    );
  
  
[0m02:27:20.904099 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:27:20.906335 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__accounts"
[0m02:27:20.906575 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__accounts: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_staging_intermediate__accounts"} */
alter table "casestudy"."intermediate"."stg_staging_intermediate__accounts" rename to "stg_staging_intermediate__accounts__dbt_backup"
[0m02:27:20.906993 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:27:20.908593 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__accounts"
[0m02:27:20.908797 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__accounts: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_staging_intermediate__accounts"} */
alter table "casestudy"."intermediate"."stg_staging_intermediate__accounts__dbt_tmp" rename to "stg_staging_intermediate__accounts"
[0m02:27:20.909131 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:27:20.912009 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__accounts: COMMIT
[0m02:27:20.912228 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__accounts"
[0m02:27:20.912404 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__accounts: COMMIT
[0m02:27:20.914005 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:27:20.915368 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__accounts"
[0m02:27:20.915577 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__accounts: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_staging_intermediate__accounts"} */
drop table if exists "casestudy"."intermediate"."stg_staging_intermediate__accounts__dbt_backup" cascade
[0m02:27:20.916477 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:27:20.917211 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.stg_staging_intermediate__accounts (execute): 02:27:20.887376 => 02:27:20.917101
[0m02:27:20.917443 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__accounts: Close
[0m02:27:20.931394 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b0329fb-cf28-4293-b1b2-c45dbb3ba5b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7185bb18ead0>]}
[0m02:27:20.932024 [info ] [Thread-1 (]: 7 of 11 OK created sql table model intermediate.stg_staging_intermediate__accounts  [[32mOK[0m in 0.05s]
[0m02:27:20.932554 [debug] [Thread-1 (]: Finished running node model.vg_casestudy.stg_staging_intermediate__accounts
[0m02:27:20.932834 [debug] [Thread-1 (]: Began running node model.vg_casestudy.stg_staging_intermediate__customers
[0m02:27:20.933209 [info ] [Thread-1 (]: 8 of 11 START sql table model intermediate.stg_staging_intermediate__customers . [RUN]
[0m02:27:20.933633 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.vg_casestudy.stg_staging_intermediate__accounts, now model.vg_casestudy.stg_staging_intermediate__customers)
[0m02:27:20.933865 [debug] [Thread-1 (]: Began compiling node model.vg_casestudy.stg_staging_intermediate__customers
[0m02:27:20.935587 [debug] [Thread-1 (]: Writing injected SQL for node "model.vg_casestudy.stg_staging_intermediate__customers"
[0m02:27:20.935930 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.stg_staging_intermediate__customers (compile): 02:27:20.933995 => 02:27:20.935819
[0m02:27:20.936114 [debug] [Thread-1 (]: Began executing node model.vg_casestudy.stg_staging_intermediate__customers
[0m02:27:20.938259 [debug] [Thread-1 (]: Writing runtime sql for node "model.vg_casestudy.stg_staging_intermediate__customers"
[0m02:27:20.938557 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__customers"
[0m02:27:20.938745 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__customers: BEGIN
[0m02:27:20.938917 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:27:20.947048 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:27:20.947293 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__customers"
[0m02:27:20.947490 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__customers: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_staging_intermediate__customers"} */

  
    
    

    create  table
      "casestudy"."intermediate"."stg_staging_intermediate__customers__dbt_tmp"
  
    as (
      with staging as (
    select * from "casestudy"."staging"."stg_raw_staging__customers"
)

select * from staging
    );
  
  
[0m02:27:20.952704 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:27:20.954639 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__customers"
[0m02:27:20.954876 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__customers: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_staging_intermediate__customers"} */
alter table "casestudy"."intermediate"."stg_staging_intermediate__customers" rename to "stg_staging_intermediate__customers__dbt_backup"
[0m02:27:20.955284 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:27:20.957227 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__customers"
[0m02:27:20.957460 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__customers: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_staging_intermediate__customers"} */
alter table "casestudy"."intermediate"."stg_staging_intermediate__customers__dbt_tmp" rename to "stg_staging_intermediate__customers"
[0m02:27:20.957877 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:27:20.960817 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__customers: COMMIT
[0m02:27:20.961036 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__customers"
[0m02:27:20.961231 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__customers: COMMIT
[0m02:27:20.963294 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:27:20.964647 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__customers"
[0m02:27:20.964861 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__customers: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_staging_intermediate__customers"} */
drop table if exists "casestudy"."intermediate"."stg_staging_intermediate__customers__dbt_backup" cascade
[0m02:27:20.965782 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:27:20.966535 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.stg_staging_intermediate__customers (execute): 02:27:20.936258 => 02:27:20.966435
[0m02:27:20.966736 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__customers: Close
[0m02:27:20.982153 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b0329fb-cf28-4293-b1b2-c45dbb3ba5b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7185bb02d5d0>]}
[0m02:27:20.982605 [info ] [Thread-1 (]: 8 of 11 OK created sql table model intermediate.stg_staging_intermediate__customers  [[32mOK[0m in 0.05s]
[0m02:27:20.982940 [debug] [Thread-1 (]: Finished running node model.vg_casestudy.stg_staging_intermediate__customers
[0m02:27:20.983175 [debug] [Thread-1 (]: Began running node model.vg_casestudy.stg_staging_intermediate__fx_rates
[0m02:27:20.983521 [info ] [Thread-1 (]: 9 of 11 START sql table model intermediate.stg_staging_intermediate__fx_rates .. [RUN]
[0m02:27:20.983874 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.vg_casestudy.stg_staging_intermediate__customers, now model.vg_casestudy.stg_staging_intermediate__fx_rates)
[0m02:27:20.984067 [debug] [Thread-1 (]: Began compiling node model.vg_casestudy.stg_staging_intermediate__fx_rates
[0m02:27:20.985844 [debug] [Thread-1 (]: Writing injected SQL for node "model.vg_casestudy.stg_staging_intermediate__fx_rates"
[0m02:27:20.986189 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.stg_staging_intermediate__fx_rates (compile): 02:27:20.984201 => 02:27:20.986073
[0m02:27:20.986401 [debug] [Thread-1 (]: Began executing node model.vg_casestudy.stg_staging_intermediate__fx_rates
[0m02:27:20.988557 [debug] [Thread-1 (]: Writing runtime sql for node "model.vg_casestudy.stg_staging_intermediate__fx_rates"
[0m02:27:20.988842 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__fx_rates"
[0m02:27:20.989023 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__fx_rates: BEGIN
[0m02:27:20.989206 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:27:20.996631 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:27:20.997065 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__fx_rates"
[0m02:27:20.997288 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__fx_rates: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_staging_intermediate__fx_rates"} */

  
    
    

    create  table
      "casestudy"."intermediate"."stg_staging_intermediate__fx_rates__dbt_tmp"
  
    as (
      with staging as (
    select * from "casestudy"."staging"."stg_raw_staging__fx_rates"
),

filtered as (
    select
        currency_iso_code,
        fx_rate,
        fx_rate_date
    from staging
    where not has_date_parsing_error
)

select * from filtered
    );
  
  
[0m02:27:20.999717 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:27:21.001525 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__fx_rates"
[0m02:27:21.001750 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__fx_rates: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_staging_intermediate__fx_rates"} */
alter table "casestudy"."intermediate"."stg_staging_intermediate__fx_rates" rename to "stg_staging_intermediate__fx_rates__dbt_backup"
[0m02:27:21.002110 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:27:21.003785 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__fx_rates"
[0m02:27:21.004034 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__fx_rates: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_staging_intermediate__fx_rates"} */
alter table "casestudy"."intermediate"."stg_staging_intermediate__fx_rates__dbt_tmp" rename to "stg_staging_intermediate__fx_rates"
[0m02:27:21.004395 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:27:21.005426 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__fx_rates: COMMIT
[0m02:27:21.005646 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__fx_rates"
[0m02:27:21.005834 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__fx_rates: COMMIT
[0m02:27:21.007308 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:27:21.008698 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__fx_rates"
[0m02:27:21.008917 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__fx_rates: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_staging_intermediate__fx_rates"} */
drop table if exists "casestudy"."intermediate"."stg_staging_intermediate__fx_rates__dbt_backup" cascade
[0m02:27:21.009857 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:27:21.010606 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.stg_staging_intermediate__fx_rates (execute): 02:27:20.986526 => 02:27:21.010506
[0m02:27:21.010809 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__fx_rates: Close
[0m02:27:21.022003 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b0329fb-cf28-4293-b1b2-c45dbb3ba5b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7185bb02cf90>]}
[0m02:27:21.022387 [info ] [Thread-1 (]: 9 of 11 OK created sql table model intermediate.stg_staging_intermediate__fx_rates  [[32mOK[0m in 0.04s]
[0m02:27:21.022702 [debug] [Thread-1 (]: Finished running node model.vg_casestudy.stg_staging_intermediate__fx_rates
[0m02:27:21.022924 [debug] [Thread-1 (]: Began running node model.vg_casestudy.stg_staging_intermediate__loans
[0m02:27:21.023440 [info ] [Thread-1 (]: 10 of 11 START sql table model intermediate.stg_staging_intermediate__loans .... [RUN]
[0m02:27:21.024340 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.vg_casestudy.stg_staging_intermediate__fx_rates, now model.vg_casestudy.stg_staging_intermediate__loans)
[0m02:27:21.024810 [debug] [Thread-1 (]: Began compiling node model.vg_casestudy.stg_staging_intermediate__loans
[0m02:27:21.027337 [debug] [Thread-1 (]: Writing injected SQL for node "model.vg_casestudy.stg_staging_intermediate__loans"
[0m02:27:21.027645 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.stg_staging_intermediate__loans (compile): 02:27:21.025103 => 02:27:21.027544
[0m02:27:21.027823 [debug] [Thread-1 (]: Began executing node model.vg_casestudy.stg_staging_intermediate__loans
[0m02:27:21.029816 [debug] [Thread-1 (]: Writing runtime sql for node "model.vg_casestudy.stg_staging_intermediate__loans"
[0m02:27:21.030109 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__loans"
[0m02:27:21.030313 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__loans: BEGIN
[0m02:27:21.030490 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:27:21.037801 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:27:21.038256 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__loans"
[0m02:27:21.038524 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__loans: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_staging_intermediate__loans"} */

  
    
    

    create  table
      "casestudy"."intermediate"."stg_staging_intermediate__loans__dbt_tmp"
  
    as (
      with staging as (
    select * from "casestudy"."staging"."stg_raw_staging__loans"
),

filtered as (
    select
        customer_id,
        loan_id,
        loan_amount,
        loan_type,
        interest_rate,
        loan_term,
        approval_rejection_date,
        loan_status
    from staging
    where not has_date_parsing_error
)

select * from filtered
    );
  
  
[0m02:27:21.047716 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:27:21.049690 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__loans"
[0m02:27:21.049918 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__loans: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_staging_intermediate__loans"} */
alter table "casestudy"."intermediate"."stg_staging_intermediate__loans" rename to "stg_staging_intermediate__loans__dbt_backup"
[0m02:27:21.050300 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:27:21.053199 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__loans"
[0m02:27:21.053422 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__loans: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_staging_intermediate__loans"} */
alter table "casestudy"."intermediate"."stg_staging_intermediate__loans__dbt_tmp" rename to "stg_staging_intermediate__loans"
[0m02:27:21.053784 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:27:21.054848 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__loans: COMMIT
[0m02:27:21.055058 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__loans"
[0m02:27:21.055245 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__loans: COMMIT
[0m02:27:21.057298 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:27:21.058743 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__loans"
[0m02:27:21.058960 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__loans: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_staging_intermediate__loans"} */
drop table if exists "casestudy"."intermediate"."stg_staging_intermediate__loans__dbt_backup" cascade
[0m02:27:21.060983 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:27:21.061846 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.stg_staging_intermediate__loans (execute): 02:27:21.027939 => 02:27:21.061739
[0m02:27:21.062048 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__loans: Close
[0m02:27:21.079968 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b0329fb-cf28-4293-b1b2-c45dbb3ba5b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7185bb0358d0>]}
[0m02:27:21.080476 [info ] [Thread-1 (]: 10 of 11 OK created sql table model intermediate.stg_staging_intermediate__loans  [[32mOK[0m in 0.06s]
[0m02:27:21.080873 [debug] [Thread-1 (]: Finished running node model.vg_casestudy.stg_staging_intermediate__loans
[0m02:27:21.081149 [debug] [Thread-1 (]: Began running node model.vg_casestudy.stg_staging_intermediate__transactions
[0m02:27:21.081473 [info ] [Thread-1 (]: 11 of 11 START sql table model intermediate.stg_staging_intermediate__transactions  [RUN]
[0m02:27:21.081869 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.vg_casestudy.stg_staging_intermediate__loans, now model.vg_casestudy.stg_staging_intermediate__transactions)
[0m02:27:21.082076 [debug] [Thread-1 (]: Began compiling node model.vg_casestudy.stg_staging_intermediate__transactions
[0m02:27:21.084085 [debug] [Thread-1 (]: Writing injected SQL for node "model.vg_casestudy.stg_staging_intermediate__transactions"
[0m02:27:21.084555 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.stg_staging_intermediate__transactions (compile): 02:27:21.082210 => 02:27:21.084403
[0m02:27:21.084754 [debug] [Thread-1 (]: Began executing node model.vg_casestudy.stg_staging_intermediate__transactions
[0m02:27:21.088067 [debug] [Thread-1 (]: Writing runtime sql for node "model.vg_casestudy.stg_staging_intermediate__transactions"
[0m02:27:21.088855 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__transactions"
[0m02:27:21.089298 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__transactions: BEGIN
[0m02:27:21.089669 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:27:21.106581 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:27:21.107484 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__transactions"
[0m02:27:21.107791 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__transactions: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_staging_intermediate__transactions"} */

  
    
    

    create  table
      "casestudy"."intermediate"."stg_staging_intermediate__transactions__dbt_tmp"
  
    as (
      with staging as (
    select * from "casestudy"."staging"."stg_raw_staging__transactions"
),

filtered as (
    select
        transaction_id,
        transaction_date,
        account_id,
        transaction_type,
        transaction_amount,
        transaction_currency
    from staging
    where not has_date_parsing_error
)

select * from filtered
    );
  
  
[0m02:27:21.147469 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:27:21.149798 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__transactions"
[0m02:27:21.150036 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__transactions: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_staging_intermediate__transactions"} */
alter table "casestudy"."intermediate"."stg_staging_intermediate__transactions" rename to "stg_staging_intermediate__transactions__dbt_backup"
[0m02:27:21.150537 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:27:21.152231 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__transactions"
[0m02:27:21.152438 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__transactions: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_staging_intermediate__transactions"} */
alter table "casestudy"."intermediate"."stg_staging_intermediate__transactions__dbt_tmp" rename to "stg_staging_intermediate__transactions"
[0m02:27:21.152818 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:27:21.153780 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__transactions: COMMIT
[0m02:27:21.153980 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__transactions"
[0m02:27:21.154158 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__transactions: COMMIT
[0m02:27:21.159053 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:27:21.160450 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__transactions"
[0m02:27:21.160650 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__transactions: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_staging_intermediate__transactions"} */
drop table if exists "casestudy"."intermediate"."stg_staging_intermediate__transactions__dbt_backup" cascade
[0m02:27:21.161544 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:27:21.162335 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.stg_staging_intermediate__transactions (execute): 02:27:21.084905 => 02:27:21.162239
[0m02:27:21.162526 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__transactions: Close
[0m02:27:21.185757 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b0329fb-cf28-4293-b1b2-c45dbb3ba5b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7185c1d2c210>]}
[0m02:27:21.186190 [info ] [Thread-1 (]: 11 of 11 OK created sql table model intermediate.stg_staging_intermediate__transactions  [[32mOK[0m in 0.10s]
[0m02:27:21.186509 [debug] [Thread-1 (]: Finished running node model.vg_casestudy.stg_staging_intermediate__transactions
[0m02:27:21.188739 [debug] [MainThread]: Using duckdb connection "master"
[0m02:27:21.189277 [debug] [MainThread]: On master: BEGIN
[0m02:27:21.189456 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:27:21.197283 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m02:27:21.197498 [debug] [MainThread]: On master: COMMIT
[0m02:27:21.197651 [debug] [MainThread]: Using duckdb connection "master"
[0m02:27:21.197793 [debug] [MainThread]: On master: COMMIT
[0m02:27:21.198024 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m02:27:21.198199 [debug] [MainThread]: On master: Close
[0m02:27:21.199530 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:27:21.199736 [debug] [MainThread]: Connection 'list_casestudy_raw' was properly closed.
[0m02:27:21.199883 [debug] [MainThread]: Connection 'model.vg_casestudy.stg_staging_intermediate__transactions' was properly closed.
[0m02:27:21.200094 [info ] [MainThread]: 
[0m02:27:21.200286 [info ] [MainThread]: Finished running 5 view models, 6 table models in 0 hours 0 minutes and 5.24 seconds (5.24s).
[0m02:27:21.201154 [debug] [MainThread]: Command end result
[0m02:27:21.261516 [info ] [MainThread]: 
[0m02:27:21.261839 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m02:27:21.262014 [info ] [MainThread]: 
[0m02:27:21.262185 [error] [MainThread]:   Runtime Error in model stg_staging_intermediate__currencies (models/intermediate/stg_staging_intermediate__currencies.sql)
  Catalog Error: Table with name currencies does not exist!
  Did you mean "staging.currencies"?
  
  LINE 12:     select * from "casestudy"."raw"."currencies"
                             ^
[0m02:27:21.262355 [info ] [MainThread]: 
[0m02:27:21.262518 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=1 SKIP=0 TOTAL=11
[0m02:27:21.262790 [debug] [MainThread]: Command `dbt run` failed at 02:27:21.262728 after 6.33 seconds
[0m02:27:21.263007 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7185cabe1910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7185c1eb2510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7185c1eb2150>]}
[0m02:27:21.263207 [debug] [MainThread]: Flushing usage events
[0m02:28:22.088727 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x790a58ecab50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x790a58be0110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x790a590b46d0>]}


============================== 02:28:22.091872 | 8b2ca433-5e5e-4da7-936b-b82859d29cb1 ==============================
[0m02:28:22.091872 [info ] [MainThread]: Running with dbt=1.6.18
[0m02:28:22.092507 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/workspaces/varengold_data_analyst_case/transformation', 'log_path': '/workspaces/varengold_data_analyst_case/transformation/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt seed', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m02:28:22.148637 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8b2ca433-5e5e-4da7-936b-b82859d29cb1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x790a58f046d0>]}
[0m02:28:22.156521 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8b2ca433-5e5e-4da7-936b-b82859d29cb1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x790a58a50f10>]}
[0m02:28:22.156957 [info ] [MainThread]: Registered adapter: duckdb=1.6.2
[0m02:28:22.170046 [debug] [MainThread]: checksum: 7b9fab86a08e9e96a48a825af743c566d95b877e068b8c6d0dbafbf714447189, vars: {}, profile: , target: , version: 1.6.18
[0m02:28:22.192751 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m02:28:22.193031 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m02:28:22.193760 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.vg_casestudy.marts
- models.vg_casestudy.main
- models.vg_casestudy.reporting
[0m02:28:22.197780 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8b2ca433-5e5e-4da7-936b-b82859d29cb1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x790a548f6a90>]}
[0m02:28:22.213582 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8b2ca433-5e5e-4da7-936b-b82859d29cb1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x790a589167d0>]}
[0m02:28:22.213924 [info ] [MainThread]: Found 11 models, 1 analysis, 2 seeds, 71 tests, 5 sources, 0 exposures, 0 metrics, 632 macros, 0 groups, 0 semantic models
[0m02:28:22.214118 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8b2ca433-5e5e-4da7-936b-b82859d29cb1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x790a5465bed0>]}
[0m02:28:22.215703 [info ] [MainThread]: 
[0m02:28:22.216147 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m02:28:22.217351 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_casestudy'
[0m02:28:22.227749 [debug] [ThreadPool]: Using duckdb connection "list_casestudy"
[0m02:28:22.227984 [debug] [ThreadPool]: On list_casestudy: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"casestudy"'
    
  
  
[0m02:28:22.228153 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:28:22.237530 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m02:28:22.238372 [debug] [ThreadPool]: On list_casestudy: Close
[0m02:28:22.241285 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy, now create_casestudy_raw)
[0m02:28:22.241710 [debug] [ThreadPool]: Creating schema "database: "casestudy"
schema: "raw"
"
[0m02:28:22.245030 [debug] [ThreadPool]: Using duckdb connection "create_casestudy_raw"
[0m02:28:22.245235 [debug] [ThreadPool]: On create_casestudy_raw: BEGIN
[0m02:28:22.245385 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:28:22.252178 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m02:28:22.252373 [debug] [ThreadPool]: Using duckdb connection "create_casestudy_raw"
[0m02:28:22.252523 [debug] [ThreadPool]: On create_casestudy_raw: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "create_casestudy_raw"} */
create schema if not exists "casestudy"."raw"
[0m02:28:22.252877 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m02:28:22.253395 [debug] [ThreadPool]: On create_casestudy_raw: COMMIT
[0m02:28:22.253557 [debug] [ThreadPool]: Using duckdb connection "create_casestudy_raw"
[0m02:28:22.253693 [debug] [ThreadPool]: On create_casestudy_raw: COMMIT
[0m02:28:22.253931 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m02:28:22.254091 [debug] [ThreadPool]: On create_casestudy_raw: Close
[0m02:28:22.257471 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_casestudy_raw, now list_casestudy_raw)
[0m02:28:22.262069 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_raw"
[0m02:28:22.262285 [debug] [ThreadPool]: On list_casestudy_raw: BEGIN
[0m02:28:22.262442 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:28:22.269344 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m02:28:22.269546 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_raw"
[0m02:28:22.269714 [debug] [ThreadPool]: On list_casestudy_raw: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_raw"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'raw'
    and table_catalog = 'casestudy'
  
[0m02:28:22.277022 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m02:28:22.277854 [debug] [ThreadPool]: On list_casestudy_raw: ROLLBACK
[0m02:28:22.278298 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_raw'
[0m02:28:22.278472 [debug] [ThreadPool]: On list_casestudy_raw: Close
[0m02:28:22.280249 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy_raw, now list_casestudy_staging)
[0m02:28:22.282031 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_staging"
[0m02:28:22.282230 [debug] [ThreadPool]: On list_casestudy_staging: BEGIN
[0m02:28:22.282381 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:28:22.289237 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m02:28:22.289436 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_staging"
[0m02:28:22.289603 [debug] [ThreadPool]: On list_casestudy_staging: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_staging"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'staging'
    and table_catalog = 'casestudy'
  
[0m02:28:22.296489 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m02:28:22.297279 [debug] [ThreadPool]: On list_casestudy_staging: ROLLBACK
[0m02:28:22.297566 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_staging'
[0m02:28:22.297729 [debug] [ThreadPool]: On list_casestudy_staging: Close
[0m02:28:22.299282 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy_staging, now list_casestudy_intermediate)
[0m02:28:22.301649 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_intermediate"
[0m02:28:22.301836 [debug] [ThreadPool]: On list_casestudy_intermediate: BEGIN
[0m02:28:22.301984 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:28:22.308739 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m02:28:22.308931 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_intermediate"
[0m02:28:22.309097 [debug] [ThreadPool]: On list_casestudy_intermediate: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_intermediate"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'intermediate'
    and table_catalog = 'casestudy'
  
[0m02:28:22.316749 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m02:28:22.317474 [debug] [ThreadPool]: On list_casestudy_intermediate: ROLLBACK
[0m02:28:22.317745 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_intermediate'
[0m02:28:22.317896 [debug] [ThreadPool]: On list_casestudy_intermediate: Close
[0m02:28:22.320393 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8b2ca433-5e5e-4da7-936b-b82859d29cb1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x790a588f9e10>]}
[0m02:28:22.320917 [debug] [MainThread]: Using duckdb connection "master"
[0m02:28:22.321274 [debug] [MainThread]: On master: BEGIN
[0m02:28:22.321589 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:28:22.329476 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m02:28:22.329672 [debug] [MainThread]: On master: COMMIT
[0m02:28:22.329820 [debug] [MainThread]: Using duckdb connection "master"
[0m02:28:22.329957 [debug] [MainThread]: On master: COMMIT
[0m02:28:22.330184 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m02:28:22.330343 [debug] [MainThread]: On master: Close
[0m02:28:22.331487 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:28:22.331684 [info ] [MainThread]: 
[0m02:28:22.333023 [debug] [Thread-1 (]: Began running node seed.vg_casestudy.currencies
[0m02:28:22.333550 [info ] [Thread-1 (]: 1 of 2 START seed file raw.currencies .......................................... [RUN]
[0m02:28:22.334597 [debug] [Thread-1 (]: Acquiring new duckdb connection 'seed.vg_casestudy.currencies'
[0m02:28:22.334995 [debug] [Thread-1 (]: Began compiling node seed.vg_casestudy.currencies
[0m02:28:22.335454 [debug] [Thread-1 (]: Timing info for seed.vg_casestudy.currencies (compile): 02:28:22.335253 => 02:28:22.335256
[0m02:28:22.335790 [debug] [Thread-1 (]: Began executing node seed.vg_casestudy.currencies
[0m02:28:22.350794 [debug] [Thread-1 (]: Using duckdb connection "seed.vg_casestudy.currencies"
[0m02:28:22.351094 [debug] [Thread-1 (]: On seed.vg_casestudy.currencies: BEGIN
[0m02:28:22.351285 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m02:28:22.360011 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:28:22.360259 [debug] [Thread-1 (]: Using duckdb connection "seed.vg_casestudy.currencies"
[0m02:28:22.360433 [debug] [Thread-1 (]: On seed.vg_casestudy.currencies: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "seed.vg_casestudy.currencies"} */

    create table "casestudy"."raw"."currencies" ("currency" text,"currency_iso_code" text)
  
[0m02:28:22.360848 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:28:22.366843 [debug] [Thread-1 (]: Using duckdb connection "seed.vg_casestudy.currencies"
[0m02:28:22.367069 [debug] [Thread-1 (]: On seed.vg_casestudy.currencies: 
          COPY "casestudy"."raw"."currencies" FROM '/workspaces/varengold_data_analyst_case/transformation/seeds/currencies.csv' (FORMAT CSV, HEADER TRUE)
        ...
[0m02:28:22.370793 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:28:22.373888 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.vg_casestudy.currencies"
[0m02:28:22.383348 [debug] [Thread-1 (]: On seed.vg_casestudy.currencies: COMMIT
[0m02:28:22.383565 [debug] [Thread-1 (]: Using duckdb connection "seed.vg_casestudy.currencies"
[0m02:28:22.383740 [debug] [Thread-1 (]: On seed.vg_casestudy.currencies: COMMIT
[0m02:28:22.391441 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:28:22.392024 [debug] [Thread-1 (]: Timing info for seed.vg_casestudy.currencies (execute): 02:28:22.336015 => 02:28:22.391925
[0m02:28:22.392226 [debug] [Thread-1 (]: On seed.vg_casestudy.currencies: Close
[0m02:28:22.406329 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8b2ca433-5e5e-4da7-936b-b82859d29cb1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x790a5894d510>]}
[0m02:28:22.407047 [info ] [Thread-1 (]: 1 of 2 OK loaded seed file raw.currencies ...................................... [[32mINSERT 158[0m in 0.07s]
[0m02:28:22.407582 [debug] [Thread-1 (]: Finished running node seed.vg_casestudy.currencies
[0m02:28:22.407953 [debug] [Thread-1 (]: Began running node seed.vg_casestudy.dbt_project_evaluator_exceptions
[0m02:28:22.408521 [info ] [Thread-1 (]: 2 of 2 START seed file raw.dbt_project_evaluator_exceptions .................... [RUN]
[0m02:28:22.409250 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.vg_casestudy.currencies, now seed.vg_casestudy.dbt_project_evaluator_exceptions)
[0m02:28:22.409504 [debug] [Thread-1 (]: Began compiling node seed.vg_casestudy.dbt_project_evaluator_exceptions
[0m02:28:22.409748 [debug] [Thread-1 (]: Timing info for seed.vg_casestudy.dbt_project_evaluator_exceptions (compile): 02:28:22.409640 => 02:28:22.409642
[0m02:28:22.409929 [debug] [Thread-1 (]: Began executing node seed.vg_casestudy.dbt_project_evaluator_exceptions
[0m02:28:22.412379 [debug] [Thread-1 (]: Using duckdb connection "seed.vg_casestudy.dbt_project_evaluator_exceptions"
[0m02:28:22.412597 [debug] [Thread-1 (]: On seed.vg_casestudy.dbt_project_evaluator_exceptions: BEGIN
[0m02:28:22.412765 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:28:22.419685 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:28:22.420023 [debug] [Thread-1 (]: Using duckdb connection "seed.vg_casestudy.dbt_project_evaluator_exceptions"
[0m02:28:22.420250 [debug] [Thread-1 (]: On seed.vg_casestudy.dbt_project_evaluator_exceptions: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "seed.vg_casestudy.dbt_project_evaluator_exceptions"} */

    create table "casestudy"."raw"."dbt_project_evaluator_exceptions" ("fct_name" text,"column_name" text,"id_to_exclude" text,"comment" text)
  
[0m02:28:22.420797 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:28:22.421631 [debug] [Thread-1 (]: Using duckdb connection "seed.vg_casestudy.dbt_project_evaluator_exceptions"
[0m02:28:22.421850 [debug] [Thread-1 (]: On seed.vg_casestudy.dbt_project_evaluator_exceptions: 
          COPY "casestudy"."raw"."dbt_project_evaluator_exceptions" FROM '/workspaces/varengold_data_analyst_case/transformation/seeds/dbt_project_evaluator_exceptions.csv' (FORMAT CSV, HEADER TRUE)
        ...
[0m02:28:22.424687 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:28:22.425224 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.vg_casestudy.dbt_project_evaluator_exceptions"
[0m02:28:22.426401 [debug] [Thread-1 (]: On seed.vg_casestudy.dbt_project_evaluator_exceptions: COMMIT
[0m02:28:22.426631 [debug] [Thread-1 (]: Using duckdb connection "seed.vg_casestudy.dbt_project_evaluator_exceptions"
[0m02:28:22.426801 [debug] [Thread-1 (]: On seed.vg_casestudy.dbt_project_evaluator_exceptions: COMMIT
[0m02:28:22.428146 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:28:22.428695 [debug] [Thread-1 (]: Timing info for seed.vg_casestudy.dbt_project_evaluator_exceptions (execute): 02:28:22.410049 => 02:28:22.428597
[0m02:28:22.428882 [debug] [Thread-1 (]: On seed.vg_casestudy.dbt_project_evaluator_exceptions: Close
[0m02:28:22.440840 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8b2ca433-5e5e-4da7-936b-b82859d29cb1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x790a5893b810>]}
[0m02:28:22.441203 [info ] [Thread-1 (]: 2 of 2 OK loaded seed file raw.dbt_project_evaluator_exceptions ................ [[32mINSERT 2[0m in 0.03s]
[0m02:28:22.441519 [debug] [Thread-1 (]: Finished running node seed.vg_casestudy.dbt_project_evaluator_exceptions
[0m02:28:22.442743 [debug] [MainThread]: Using duckdb connection "master"
[0m02:28:22.442943 [debug] [MainThread]: On master: BEGIN
[0m02:28:22.443090 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:28:22.450807 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m02:28:22.451048 [debug] [MainThread]: On master: COMMIT
[0m02:28:22.451216 [debug] [MainThread]: Using duckdb connection "master"
[0m02:28:22.451365 [debug] [MainThread]: On master: COMMIT
[0m02:28:22.451607 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m02:28:22.451784 [debug] [MainThread]: On master: Close
[0m02:28:22.453454 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:28:22.453654 [debug] [MainThread]: Connection 'list_casestudy_intermediate' was properly closed.
[0m02:28:22.453789 [debug] [MainThread]: Connection 'seed.vg_casestudy.dbt_project_evaluator_exceptions' was properly closed.
[0m02:28:22.454010 [info ] [MainThread]: 
[0m02:28:22.454196 [info ] [MainThread]: Finished running 2 seeds in 0 hours 0 minutes and 0.24 seconds (0.24s).
[0m02:28:22.454624 [debug] [MainThread]: Command end result
[0m02:28:22.503959 [info ] [MainThread]: 
[0m02:28:22.504264 [info ] [MainThread]: [32mCompleted successfully[0m
[0m02:28:22.504436 [info ] [MainThread]: 
[0m02:28:22.504603 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m02:28:22.504864 [debug] [MainThread]: Command `dbt seed` succeeded at 02:28:22.504802 after 0.42 seconds
[0m02:28:22.505059 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x790a59d33dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x790a58c40cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x790a58c40710>]}
[0m02:28:22.505271 [debug] [MainThread]: Flushing usage events
[0m02:28:26.616898 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x740a744f23d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x740a74afacd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x740a7475fb10>]}


============================== 02:28:26.619875 | 3aeec56f-ff13-44f7-96b5-c78c6b5fd01e ==============================
[0m02:28:26.619875 [info ] [MainThread]: Running with dbt=1.6.18
[0m02:28:26.620419 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/workspaces/varengold_data_analyst_case/transformation', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/workspaces/varengold_data_analyst_case/transformation/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m02:28:26.676907 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3aeec56f-ff13-44f7-96b5-c78c6b5fd01e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x740a74517e90>]}
[0m02:28:26.684641 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3aeec56f-ff13-44f7-96b5-c78c6b5fd01e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x740a74823050>]}
[0m02:28:26.685068 [info ] [MainThread]: Registered adapter: duckdb=1.6.2
[0m02:28:26.697698 [debug] [MainThread]: checksum: 7b9fab86a08e9e96a48a825af743c566d95b877e068b8c6d0dbafbf714447189, vars: {}, profile: , target: , version: 1.6.18
[0m02:28:26.720445 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m02:28:26.720757 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m02:28:26.721462 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.vg_casestudy.marts
- models.vg_casestudy.reporting
- models.vg_casestudy.main
[0m02:28:26.725422 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3aeec56f-ff13-44f7-96b5-c78c6b5fd01e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x740a70386a90>]}
[0m02:28:26.738906 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3aeec56f-ff13-44f7-96b5-c78c6b5fd01e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x740a703702d0>]}
[0m02:28:26.739264 [info ] [MainThread]: Found 11 models, 1 analysis, 2 seeds, 71 tests, 5 sources, 0 exposures, 0 metrics, 632 macros, 0 groups, 0 semantic models
[0m02:28:26.739465 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3aeec56f-ff13-44f7-96b5-c78c6b5fd01e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x740a7027ff10>]}
[0m02:28:26.741270 [info ] [MainThread]: 
[0m02:28:26.741723 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m02:28:26.742837 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_casestudy'
[0m02:28:26.752811 [debug] [ThreadPool]: Using duckdb connection "list_casestudy"
[0m02:28:26.753024 [debug] [ThreadPool]: On list_casestudy: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"casestudy"'
    
  
  
[0m02:28:26.753214 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:28:26.764312 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m02:28:26.765291 [debug] [ThreadPool]: On list_casestudy: Close
[0m02:28:26.770491 [debug] [ThreadPool]: Using duckdb connection "list_casestudy"
[0m02:28:26.770772 [debug] [ThreadPool]: On list_casestudy: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"casestudy"'
    
  
  
[0m02:28:26.770937 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:28:26.778369 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m02:28:26.779260 [debug] [ThreadPool]: On list_casestudy: Close
[0m02:28:26.781198 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy, now create_casestudy_staging)
[0m02:28:26.781598 [debug] [ThreadPool]: Creating schema "database: "casestudy"
schema: "staging"
"
[0m02:28:26.784303 [debug] [ThreadPool]: Using duckdb connection "create_casestudy_staging"
[0m02:28:26.784488 [debug] [ThreadPool]: On create_casestudy_staging: BEGIN
[0m02:28:26.784639 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:28:26.791334 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m02:28:26.791553 [debug] [ThreadPool]: Using duckdb connection "create_casestudy_staging"
[0m02:28:26.791707 [debug] [ThreadPool]: On create_casestudy_staging: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "create_casestudy_staging"} */
create schema if not exists "casestudy"."staging"
[0m02:28:26.791981 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m02:28:26.792909 [debug] [ThreadPool]: On create_casestudy_staging: COMMIT
[0m02:28:26.793352 [debug] [ThreadPool]: Using duckdb connection "create_casestudy_staging"
[0m02:28:26.793642 [debug] [ThreadPool]: On create_casestudy_staging: COMMIT
[0m02:28:26.794209 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m02:28:26.794527 [debug] [ThreadPool]: On create_casestudy_staging: Close
[0m02:28:26.796871 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_casestudy_staging, now create_casestudy_intermediate)
[0m02:28:26.797264 [debug] [ThreadPool]: Creating schema "database: "casestudy"
schema: "intermediate"
"
[0m02:28:26.798558 [debug] [ThreadPool]: Using duckdb connection "create_casestudy_intermediate"
[0m02:28:26.798741 [debug] [ThreadPool]: On create_casestudy_intermediate: BEGIN
[0m02:28:26.798884 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:28:26.805490 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m02:28:26.805689 [debug] [ThreadPool]: Using duckdb connection "create_casestudy_intermediate"
[0m02:28:26.805841 [debug] [ThreadPool]: On create_casestudy_intermediate: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "create_casestudy_intermediate"} */
create schema if not exists "casestudy"."intermediate"
[0m02:28:26.806111 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m02:28:26.806624 [debug] [ThreadPool]: On create_casestudy_intermediate: COMMIT
[0m02:28:26.806791 [debug] [ThreadPool]: Using duckdb connection "create_casestudy_intermediate"
[0m02:28:26.806934 [debug] [ThreadPool]: On create_casestudy_intermediate: COMMIT
[0m02:28:26.807191 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m02:28:26.807356 [debug] [ThreadPool]: On create_casestudy_intermediate: Close
[0m02:28:26.809850 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_casestudy_intermediate, now list_casestudy_raw)
[0m02:28:26.815730 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_raw"
[0m02:28:26.815913 [debug] [ThreadPool]: On list_casestudy_raw: BEGIN
[0m02:28:26.816059 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:28:26.822608 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m02:28:26.822791 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_raw"
[0m02:28:26.822944 [debug] [ThreadPool]: On list_casestudy_raw: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_raw"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'raw'
    and table_catalog = 'casestudy'
  
[0m02:28:26.831442 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m02:28:26.832250 [debug] [ThreadPool]: On list_casestudy_raw: ROLLBACK
[0m02:28:26.832699 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_raw'
[0m02:28:26.832884 [debug] [ThreadPool]: On list_casestudy_raw: Close
[0m02:28:26.834423 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy_raw, now list_casestudy_staging)
[0m02:28:26.836965 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_staging"
[0m02:28:26.837149 [debug] [ThreadPool]: On list_casestudy_staging: BEGIN
[0m02:28:26.837291 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:28:26.843712 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m02:28:26.843893 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_staging"
[0m02:28:26.844050 [debug] [ThreadPool]: On list_casestudy_staging: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_staging"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'staging'
    and table_catalog = 'casestudy'
  
[0m02:28:26.850822 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m02:28:26.851545 [debug] [ThreadPool]: On list_casestudy_staging: ROLLBACK
[0m02:28:26.851808 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_staging'
[0m02:28:26.851953 [debug] [ThreadPool]: On list_casestudy_staging: Close
[0m02:28:26.854204 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy_staging, now list_casestudy_intermediate)
[0m02:28:26.857128 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_intermediate"
[0m02:28:26.857359 [debug] [ThreadPool]: On list_casestudy_intermediate: BEGIN
[0m02:28:26.857490 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:28:26.867876 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m02:28:26.868061 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_intermediate"
[0m02:28:26.868617 [debug] [ThreadPool]: On list_casestudy_intermediate: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_intermediate"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'intermediate'
    and table_catalog = 'casestudy'
  
[0m02:28:26.880010 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m02:28:26.880747 [debug] [ThreadPool]: On list_casestudy_intermediate: ROLLBACK
[0m02:28:26.881028 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_intermediate'
[0m02:28:26.881186 [debug] [ThreadPool]: On list_casestudy_intermediate: Close
[0m02:28:26.883399 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3aeec56f-ff13-44f7-96b5-c78c6b5fd01e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x740a7497acd0>]}
[0m02:28:26.883679 [debug] [MainThread]: Using duckdb connection "master"
[0m02:28:26.883832 [debug] [MainThread]: On master: BEGIN
[0m02:28:26.883969 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:28:26.891171 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m02:28:26.891361 [debug] [MainThread]: On master: COMMIT
[0m02:28:26.891510 [debug] [MainThread]: Using duckdb connection "master"
[0m02:28:26.891650 [debug] [MainThread]: On master: COMMIT
[0m02:28:26.891880 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m02:28:26.892046 [debug] [MainThread]: On master: Close
[0m02:28:26.893745 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:28:26.893993 [info ] [MainThread]: 
[0m02:28:26.895583 [debug] [Thread-1 (]: Began running node model.vg_casestudy.stg_raw_staging__accounts
[0m02:28:26.895854 [info ] [Thread-1 (]: 1 of 11 START sql view model staging.stg_raw_staging__accounts ................. [RUN]
[0m02:28:26.896262 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.vg_casestudy.stg_raw_staging__accounts'
[0m02:28:26.896459 [debug] [Thread-1 (]: Began compiling node model.vg_casestudy.stg_raw_staging__accounts
[0m02:28:26.901643 [debug] [Thread-1 (]: Writing injected SQL for node "model.vg_casestudy.stg_raw_staging__accounts"
[0m02:28:26.902021 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.stg_raw_staging__accounts (compile): 02:28:26.896579 => 02:28:26.901905
[0m02:28:26.902232 [debug] [Thread-1 (]: Began executing node model.vg_casestudy.stg_raw_staging__accounts
[0m02:28:26.920650 [debug] [Thread-1 (]: Writing runtime sql for node "model.vg_casestudy.stg_raw_staging__accounts"
[0m02:28:26.921071 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_raw_staging__accounts"
[0m02:28:26.921275 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__accounts: BEGIN
[0m02:28:26.921442 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m02:28:26.930008 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:28:26.930258 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_raw_staging__accounts"
[0m02:28:26.930476 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__accounts: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_raw_staging__accounts"} */

  
  create view "casestudy"."staging"."stg_raw_staging__accounts__dbt_tmp" as (
    with source as (
    select * from "casestudy"."raw"."accounts"
),

renamed as (
    select
        account_id,
        customer_id,
        account_type,
        
CASE
    -- First try DD.MM.YYYY format (German format with dots)
    WHEN REGEXP_MATCHES(account_opening_date, '^\d{1,2}\.\d{1,2}\.\d{4}$') 
        THEN TRY_CAST(STRPTIME(account_opening_date, '%d.%m.%Y') AS DATE)
        
    -- Then try DD/MM/YYYY format (with slashes)
    WHEN REGEXP_MATCHES(account_opening_date, '^\d{1,2}/\d{1,2}/\d{4}$')
        AND CAST(SPLIT_PART(account_opening_date, '/', 1) AS INTEGER) <= 31 
        AND CAST(SPLIT_PART(account_opening_date, '/', 2) AS INTEGER) <= 12 
        THEN TRY_CAST(STRPTIME(account_opening_date, '%d/%m/%Y') AS DATE)
        
    -- Try MM/DD/YYYY format (US format with slashes)
    WHEN REGEXP_MATCHES(account_opening_date, '^\d{1,2}/\d{1,2}/\d{4}$')
        AND CAST(SPLIT_PART(account_opening_date, '/', 1) AS INTEGER) <= 12 
        THEN TRY_CAST(STRPTIME(account_opening_date, '%m/%d/%Y') AS DATE)
        
    -- Try YYYY-MM-DD format (ISO format)
    WHEN REGEXP_MATCHES(account_opening_date, '^\d{4}-\d{1,2}-\d{1,2}$')
        THEN TRY_CAST(STRPTIME(account_opening_date, '%Y-%m-%d') AS DATE)
        
    -- Try generic date parsing as last resort
    ELSE TRY_CAST(account_opening_date AS DATE)
END
 as account_opening_date,
        account_opening_date as account_opening_date_raw
    from source
    where account_type is not null and account_type != '' and account_type != '-'
),

final as (
    select
        account_id,
        customer_id,
        account_type,
        account_opening_date,
        -- Flag records with date parsing issues
        CASE WHEN account_opening_date IS NULL AND account_opening_date_raw IS NOT NULL
             THEN TRUE ELSE FALSE 
        END as has_date_parsing_error
    from renamed
)

select * from final
  );

[0m02:28:26.931481 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:28:26.971385 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_raw_staging__accounts"
[0m02:28:26.971666 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__accounts: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_raw_staging__accounts"} */
alter view "casestudy"."staging"."stg_raw_staging__accounts" rename to "stg_raw_staging__accounts__dbt_backup"
[0m02:28:26.972330 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:28:26.974061 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_raw_staging__accounts"
[0m02:28:26.974305 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__accounts: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_raw_staging__accounts"} */
alter view "casestudy"."staging"."stg_raw_staging__accounts__dbt_tmp" rename to "stg_raw_staging__accounts"
[0m02:28:26.974737 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:28:26.983867 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__accounts: COMMIT
[0m02:28:26.984097 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_raw_staging__accounts"
[0m02:28:26.984281 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__accounts: COMMIT
[0m02:28:26.986331 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:28:26.989025 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_raw_staging__accounts"
[0m02:28:26.989236 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__accounts: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_raw_staging__accounts"} */
drop view if exists "casestudy"."staging"."stg_raw_staging__accounts__dbt_backup" cascade
[0m02:28:26.990714 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:28:26.991528 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.stg_raw_staging__accounts (execute): 02:28:26.902355 => 02:28:26.991432
[0m02:28:26.991725 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__accounts: Close
[0m02:28:27.003690 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3aeec56f-ff13-44f7-96b5-c78c6b5fd01e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x740a702baf90>]}
[0m02:28:27.004042 [info ] [Thread-1 (]: 1 of 11 OK created sql view model staging.stg_raw_staging__accounts ............ [[32mOK[0m in 0.11s]
[0m02:28:27.004358 [debug] [Thread-1 (]: Finished running node model.vg_casestudy.stg_raw_staging__accounts
[0m02:28:27.004567 [debug] [Thread-1 (]: Began running node model.vg_casestudy.stg_raw_staging__customers
[0m02:28:27.004944 [info ] [Thread-1 (]: 2 of 11 START sql view model staging.stg_raw_staging__customers ................ [RUN]
[0m02:28:27.005305 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.vg_casestudy.stg_raw_staging__accounts, now model.vg_casestudy.stg_raw_staging__customers)
[0m02:28:27.005500 [debug] [Thread-1 (]: Began compiling node model.vg_casestudy.stg_raw_staging__customers
[0m02:28:27.007059 [debug] [Thread-1 (]: Writing injected SQL for node "model.vg_casestudy.stg_raw_staging__customers"
[0m02:28:27.007400 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.stg_raw_staging__customers (compile): 02:28:27.005618 => 02:28:27.007288
[0m02:28:27.007584 [debug] [Thread-1 (]: Began executing node model.vg_casestudy.stg_raw_staging__customers
[0m02:28:27.009570 [debug] [Thread-1 (]: Writing runtime sql for node "model.vg_casestudy.stg_raw_staging__customers"
[0m02:28:27.009872 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_raw_staging__customers"
[0m02:28:27.010056 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__customers: BEGIN
[0m02:28:27.010243 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:28:27.021644 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:28:27.022033 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_raw_staging__customers"
[0m02:28:27.022253 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__customers: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_raw_staging__customers"} */

  
  create view "casestudy"."staging"."stg_raw_staging__customers__dbt_tmp" as (
    with source as (
    select * from "casestudy"."raw"."customers"
),

renamed as (
    select distinct
        customer_id,
        trim(firstname) as firstname,
        trim(lastname) as lastname,
        Age as age,
        branch_id
    from source
)

select * from renamed
  );

[0m02:28:27.022925 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:28:27.025137 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_raw_staging__customers"
[0m02:28:27.025377 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__customers: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_raw_staging__customers"} */
alter view "casestudy"."staging"."stg_raw_staging__customers" rename to "stg_raw_staging__customers__dbt_backup"
[0m02:28:27.025732 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:28:27.027375 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_raw_staging__customers"
[0m02:28:27.027580 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__customers: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_raw_staging__customers"} */
alter view "casestudy"."staging"."stg_raw_staging__customers__dbt_tmp" rename to "stg_raw_staging__customers"
[0m02:28:27.028040 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:28:27.028909 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__customers: COMMIT
[0m02:28:27.029105 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_raw_staging__customers"
[0m02:28:27.029275 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__customers: COMMIT
[0m02:28:27.030657 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:28:27.032077 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_raw_staging__customers"
[0m02:28:27.032279 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__customers: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_raw_staging__customers"} */
drop view if exists "casestudy"."staging"."stg_raw_staging__customers__dbt_backup" cascade
[0m02:28:27.033161 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:28:27.033882 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.stg_raw_staging__customers (execute): 02:28:27.007703 => 02:28:27.033781
[0m02:28:27.034065 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__customers: Close
[0m02:28:27.044583 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3aeec56f-ff13-44f7-96b5-c78c6b5fd01e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x740a702c4c50>]}
[0m02:28:27.044938 [info ] [Thread-1 (]: 2 of 11 OK created sql view model staging.stg_raw_staging__customers ........... [[32mOK[0m in 0.04s]
[0m02:28:27.045251 [debug] [Thread-1 (]: Finished running node model.vg_casestudy.stg_raw_staging__customers
[0m02:28:27.045477 [debug] [Thread-1 (]: Began running node model.vg_casestudy.stg_raw_staging__fx_rates
[0m02:28:27.045765 [info ] [Thread-1 (]: 3 of 11 START sql view model staging.stg_raw_staging__fx_rates ................. [RUN]
[0m02:28:27.046169 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.vg_casestudy.stg_raw_staging__customers, now model.vg_casestudy.stg_raw_staging__fx_rates)
[0m02:28:27.046371 [debug] [Thread-1 (]: Began compiling node model.vg_casestudy.stg_raw_staging__fx_rates
[0m02:28:27.050106 [debug] [Thread-1 (]: Writing injected SQL for node "model.vg_casestudy.stg_raw_staging__fx_rates"
[0m02:28:27.050465 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.stg_raw_staging__fx_rates (compile): 02:28:27.046491 => 02:28:27.050351
[0m02:28:27.050649 [debug] [Thread-1 (]: Began executing node model.vg_casestudy.stg_raw_staging__fx_rates
[0m02:28:27.052603 [debug] [Thread-1 (]: Writing runtime sql for node "model.vg_casestudy.stg_raw_staging__fx_rates"
[0m02:28:27.052894 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_raw_staging__fx_rates"
[0m02:28:27.053071 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__fx_rates: BEGIN
[0m02:28:27.053249 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:28:27.060171 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:28:27.060492 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_raw_staging__fx_rates"
[0m02:28:27.060735 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__fx_rates: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_raw_staging__fx_rates"} */

  
  create view "casestudy"."staging"."stg_raw_staging__fx_rates__dbt_tmp" as (
    with source as (
    select * from "casestudy"."raw"."fx_rates"
),

renamed as (
    select
        trim(currency_iso_code) as currency_iso_code,
        
CASE
    WHEN fx_rate IS NULL THEN NULL
    -- If the value is already a valid number
    WHEN TRY_CAST(fx_rate AS DOUBLE) IS NOT NULL 
        THEN TRY_CAST(fx_rate AS DOUBLE)
    -- If contains both dot and comma (German notation)
    WHEN POSITION('.' IN fx_rate) > 0 AND POSITION(',' IN fx_rate) > 0 
        THEN TRY_CAST(REPLACE(REPLACE(TRIM(fx_rate), '.', ''), ',', '.') AS DOUBLE)
    -- If only contains comma, treat as decimal point
    WHEN POSITION(',' IN fx_rate) > 0 
        THEN TRY_CAST(REPLACE(TRIM(fx_rate), ',', '.') AS DOUBLE)
    -- If only contains dots, likely thousands separator
    WHEN POSITION('.' IN fx_rate) > 0 
        THEN TRY_CAST(REPLACE(TRIM(fx_rate), '.', '') AS DOUBLE)
    ELSE NULL
END
 as fx_rate,
        
CASE
    -- First try DD.MM.YYYY format (German format with dots)
    WHEN REGEXP_MATCHES(date, '^\d{1,2}\.\d{1,2}\.\d{4}$') 
        THEN TRY_CAST(STRPTIME(date, '%d.%m.%Y') AS DATE)
        
    -- Then try DD/MM/YYYY format (with slashes)
    WHEN REGEXP_MATCHES(date, '^\d{1,2}/\d{1,2}/\d{4}$')
        AND CAST(SPLIT_PART(date, '/', 1) AS INTEGER) <= 31 
        AND CAST(SPLIT_PART(date, '/', 2) AS INTEGER) <= 12 
        THEN TRY_CAST(STRPTIME(date, '%d/%m/%Y') AS DATE)
        
    -- Try MM/DD/YYYY format (US format with slashes)
    WHEN REGEXP_MATCHES(date, '^\d{1,2}/\d{1,2}/\d{4}$')
        AND CAST(SPLIT_PART(date, '/', 1) AS INTEGER) <= 12 
        THEN TRY_CAST(STRPTIME(date, '%m/%d/%Y') AS DATE)
        
    -- Try YYYY-MM-DD format (ISO format)
    WHEN REGEXP_MATCHES(date, '^\d{4}-\d{1,2}-\d{1,2}$')
        THEN TRY_CAST(STRPTIME(date, '%Y-%m-%d') AS DATE)
        
    -- Try generic date parsing as last resort
    ELSE TRY_CAST(date AS DATE)
END
 as fx_rate_date,
        date as fx_rate_date_raw
    from source
    where currency_iso_code is not null and trim(currency_iso_code) not in  ('(none)', '')
),

final as (
    select
        currency_iso_code,
        fx_rate,
        fx_rate_date,
        -- Flag records with date parsing issues
        CASE WHEN fx_rate_date IS NULL AND fx_rate_date_raw IS NOT NULL
             THEN TRUE ELSE FALSE 
        END as has_date_parsing_error
    from renamed
)

select * from final
  );

[0m02:28:27.062157 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:28:27.064223 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_raw_staging__fx_rates"
[0m02:28:27.064429 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__fx_rates: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_raw_staging__fx_rates"} */
alter view "casestudy"."staging"."stg_raw_staging__fx_rates" rename to "stg_raw_staging__fx_rates__dbt_backup"
[0m02:28:27.064794 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:28:27.066413 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_raw_staging__fx_rates"
[0m02:28:27.066613 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__fx_rates: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_raw_staging__fx_rates"} */
alter view "casestudy"."staging"."stg_raw_staging__fx_rates__dbt_tmp" rename to "stg_raw_staging__fx_rates"
[0m02:28:27.067137 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:28:27.067984 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__fx_rates: COMMIT
[0m02:28:27.068178 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_raw_staging__fx_rates"
[0m02:28:27.068344 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__fx_rates: COMMIT
[0m02:28:27.069752 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:28:27.071020 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_raw_staging__fx_rates"
[0m02:28:27.071224 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__fx_rates: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_raw_staging__fx_rates"} */
drop view if exists "casestudy"."staging"."stg_raw_staging__fx_rates__dbt_backup" cascade
[0m02:28:27.072101 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:28:27.072811 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.stg_raw_staging__fx_rates (execute): 02:28:27.050768 => 02:28:27.072714
[0m02:28:27.072995 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__fx_rates: Close
[0m02:28:27.084480 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3aeec56f-ff13-44f7-96b5-c78c6b5fd01e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x740a74536b10>]}
[0m02:28:27.085194 [info ] [Thread-1 (]: 3 of 11 OK created sql view model staging.stg_raw_staging__fx_rates ............ [[32mOK[0m in 0.04s]
[0m02:28:27.085686 [debug] [Thread-1 (]: Finished running node model.vg_casestudy.stg_raw_staging__fx_rates
[0m02:28:27.085973 [debug] [Thread-1 (]: Began running node model.vg_casestudy.stg_raw_staging__loans
[0m02:28:27.086379 [info ] [Thread-1 (]: 4 of 11 START sql view model staging.stg_raw_staging__loans .................... [RUN]
[0m02:28:27.086847 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.vg_casestudy.stg_raw_staging__fx_rates, now model.vg_casestudy.stg_raw_staging__loans)
[0m02:28:27.087092 [debug] [Thread-1 (]: Began compiling node model.vg_casestudy.stg_raw_staging__loans
[0m02:28:27.089224 [debug] [Thread-1 (]: Writing injected SQL for node "model.vg_casestudy.stg_raw_staging__loans"
[0m02:28:27.089577 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.stg_raw_staging__loans (compile): 02:28:27.087224 => 02:28:27.089460
[0m02:28:27.089756 [debug] [Thread-1 (]: Began executing node model.vg_casestudy.stg_raw_staging__loans
[0m02:28:27.091861 [debug] [Thread-1 (]: Writing runtime sql for node "model.vg_casestudy.stg_raw_staging__loans"
[0m02:28:27.092172 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_raw_staging__loans"
[0m02:28:27.092359 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__loans: BEGIN
[0m02:28:27.092519 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:28:27.100097 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:28:27.100397 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_raw_staging__loans"
[0m02:28:27.100665 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__loans: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_raw_staging__loans"} */

  
  create view "casestudy"."staging"."stg_raw_staging__loans__dbt_tmp" as (
    with source as (
    select * from "casestudy"."raw"."loans"
),

renamed as (
    select
        customer_id,
        loan_id,
        
CASE
    WHEN loan_amount IS NULL THEN NULL
    -- If the value is already a valid number
    WHEN TRY_CAST(loan_amount AS DOUBLE) IS NOT NULL 
        THEN TRY_CAST(loan_amount AS DOUBLE)
    -- If contains both dot and comma (German notation)
    WHEN POSITION('.' IN loan_amount) > 0 AND POSITION(',' IN loan_amount) > 0 
        THEN TRY_CAST(REPLACE(REPLACE(TRIM(loan_amount), '.', ''), ',', '.') AS DOUBLE)
    -- If only contains comma, treat as decimal point
    WHEN POSITION(',' IN loan_amount) > 0 
        THEN TRY_CAST(REPLACE(TRIM(loan_amount), ',', '.') AS DOUBLE)
    -- If only contains dots, likely thousands separator
    WHEN POSITION('.' IN loan_amount) > 0 
        THEN TRY_CAST(REPLACE(TRIM(loan_amount), '.', '') AS DOUBLE)
    ELSE NULL
END
 as loan_amount,
        loant_type,
        
CASE
    WHEN interest_rate IS NULL THEN NULL
    -- If the value is already a valid number
    WHEN TRY_CAST(interest_rate AS DOUBLE) IS NOT NULL 
        THEN TRY_CAST(interest_rate AS DOUBLE)
    -- If contains both dot and comma (German notation)
    WHEN POSITION('.' IN interest_rate) > 0 AND POSITION(',' IN interest_rate) > 0 
        THEN TRY_CAST(REPLACE(REPLACE(TRIM(interest_rate), '.', ''), ',', '.') AS DOUBLE)
    -- If only contains comma, treat as decimal point
    WHEN POSITION(',' IN interest_rate) > 0 
        THEN TRY_CAST(REPLACE(TRIM(interest_rate), ',', '.') AS DOUBLE)
    -- If only contains dots, likely thousands separator
    WHEN POSITION('.' IN interest_rate) > 0 
        THEN TRY_CAST(REPLACE(TRIM(interest_rate), '.', '') AS DOUBLE)
    ELSE NULL
END
 as interest_rate,
        loan_term,
        
CASE
    -- First try DD.MM.YYYY format (German format with dots)
    WHEN REGEXP_MATCHES(approval_rejection_date, '^\d{1,2}\.\d{1,2}\.\d{4}$') 
        THEN TRY_CAST(STRPTIME(approval_rejection_date, '%d.%m.%Y') AS DATE)
        
    -- Then try DD/MM/YYYY format (with slashes)
    WHEN REGEXP_MATCHES(approval_rejection_date, '^\d{1,2}/\d{1,2}/\d{4}$')
        AND CAST(SPLIT_PART(approval_rejection_date, '/', 1) AS INTEGER) <= 31 
        AND CAST(SPLIT_PART(approval_rejection_date, '/', 2) AS INTEGER) <= 12 
        THEN TRY_CAST(STRPTIME(approval_rejection_date, '%d/%m/%Y') AS DATE)
        
    -- Try MM/DD/YYYY format (US format with slashes)
    WHEN REGEXP_MATCHES(approval_rejection_date, '^\d{1,2}/\d{1,2}/\d{4}$')
        AND CAST(SPLIT_PART(approval_rejection_date, '/', 1) AS INTEGER) <= 12 
        THEN TRY_CAST(STRPTIME(approval_rejection_date, '%m/%d/%Y') AS DATE)
        
    -- Try YYYY-MM-DD format (ISO format)
    WHEN REGEXP_MATCHES(approval_rejection_date, '^\d{4}-\d{1,2}-\d{1,2}$')
        THEN TRY_CAST(STRPTIME(approval_rejection_date, '%Y-%m-%d') AS DATE)
        
    -- Try generic date parsing as last resort
    ELSE TRY_CAST(approval_rejection_date AS DATE)
END
 as approval_rejection_date,
        approval_rejection_date as approval_rejection_date_raw,
        loan_status
    from source
),

final as (
    select
        customer_id,
        loan_id,
        loan_amount,
        loant_type as loan_type,
        interest_rate,
        loan_term,
        approval_rejection_date,
        loan_status,
        -- Flag records with date parsing issues
        CASE WHEN approval_rejection_date IS NULL AND approval_rejection_date_raw IS NOT NULL
             THEN TRUE ELSE FALSE 
        END as has_date_parsing_error
    from renamed
)

select * from final
  );

[0m02:28:27.102116 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:28:27.104114 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_raw_staging__loans"
[0m02:28:27.104335 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__loans: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_raw_staging__loans"} */
alter view "casestudy"."staging"."stg_raw_staging__loans" rename to "stg_raw_staging__loans__dbt_backup"
[0m02:28:27.104708 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:28:27.106250 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_raw_staging__loans"
[0m02:28:27.106449 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__loans: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_raw_staging__loans"} */
alter view "casestudy"."staging"."stg_raw_staging__loans__dbt_tmp" rename to "stg_raw_staging__loans"
[0m02:28:27.106788 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:28:27.107682 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__loans: COMMIT
[0m02:28:27.107875 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_raw_staging__loans"
[0m02:28:27.108036 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__loans: COMMIT
[0m02:28:27.109810 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:28:27.112117 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_raw_staging__loans"
[0m02:28:27.112326 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__loans: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_raw_staging__loans"} */
drop view if exists "casestudy"."staging"."stg_raw_staging__loans__dbt_backup" cascade
[0m02:28:27.113266 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:28:27.113984 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.stg_raw_staging__loans (execute): 02:28:27.089873 => 02:28:27.113886
[0m02:28:27.114171 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__loans: Close
[0m02:28:27.125408 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3aeec56f-ff13-44f7-96b5-c78c6b5fd01e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x740a703b7ed0>]}
[0m02:28:27.125935 [info ] [Thread-1 (]: 4 of 11 OK created sql view model staging.stg_raw_staging__loans ............... [[32mOK[0m in 0.04s]
[0m02:28:27.126411 [debug] [Thread-1 (]: Finished running node model.vg_casestudy.stg_raw_staging__loans
[0m02:28:27.126661 [debug] [Thread-1 (]: Began running node model.vg_casestudy.stg_raw_staging__transactions
[0m02:28:27.126942 [info ] [Thread-1 (]: 5 of 11 START sql view model staging.stg_raw_staging__transactions ............. [RUN]
[0m02:28:27.127348 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.vg_casestudy.stg_raw_staging__loans, now model.vg_casestudy.stg_raw_staging__transactions)
[0m02:28:27.127528 [debug] [Thread-1 (]: Began compiling node model.vg_casestudy.stg_raw_staging__transactions
[0m02:28:27.129509 [debug] [Thread-1 (]: Writing injected SQL for node "model.vg_casestudy.stg_raw_staging__transactions"
[0m02:28:27.129851 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.stg_raw_staging__transactions (compile): 02:28:27.127640 => 02:28:27.129737
[0m02:28:27.130030 [debug] [Thread-1 (]: Began executing node model.vg_casestudy.stg_raw_staging__transactions
[0m02:28:27.132007 [debug] [Thread-1 (]: Writing runtime sql for node "model.vg_casestudy.stg_raw_staging__transactions"
[0m02:28:27.132306 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_raw_staging__transactions"
[0m02:28:27.132484 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__transactions: BEGIN
[0m02:28:27.132642 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:28:27.139475 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:28:27.139715 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_raw_staging__transactions"
[0m02:28:27.139953 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__transactions: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_raw_staging__transactions"} */

  
  create view "casestudy"."staging"."stg_raw_staging__transactions__dbt_tmp" as (
    with source as (
    select * from "casestudy"."raw"."transactions"
),

renamed as (
    select
        transaction_id,
        
CASE
    -- First try DD.MM.YYYY format (German format with dots)
    WHEN REGEXP_MATCHES(transaction_date, '^\d{1,2}\.\d{1,2}\.\d{4}$') 
        THEN TRY_CAST(STRPTIME(transaction_date, '%d.%m.%Y') AS DATE)
        
    -- Then try DD/MM/YYYY format (with slashes)
    WHEN REGEXP_MATCHES(transaction_date, '^\d{1,2}/\d{1,2}/\d{4}$')
        AND CAST(SPLIT_PART(transaction_date, '/', 1) AS INTEGER) <= 31 
        AND CAST(SPLIT_PART(transaction_date, '/', 2) AS INTEGER) <= 12 
        THEN TRY_CAST(STRPTIME(transaction_date, '%d/%m/%Y') AS DATE)
        
    -- Try MM/DD/YYYY format (US format with slashes)
    WHEN REGEXP_MATCHES(transaction_date, '^\d{1,2}/\d{1,2}/\d{4}$')
        AND CAST(SPLIT_PART(transaction_date, '/', 1) AS INTEGER) <= 12 
        THEN TRY_CAST(STRPTIME(transaction_date, '%m/%d/%Y') AS DATE)
        
    -- Try YYYY-MM-DD format (ISO format)
    WHEN REGEXP_MATCHES(transaction_date, '^\d{4}-\d{1,2}-\d{1,2}$')
        THEN TRY_CAST(STRPTIME(transaction_date, '%Y-%m-%d') AS DATE)
        
    -- Try generic date parsing as last resort
    ELSE TRY_CAST(transaction_date AS DATE)
END
 as transaction_date,
        transaction_date as transaction_date_raw,
        account_id,
        trim(transaction_type) as transaction_type,
        
CASE
    WHEN transaction_amount IS NULL THEN NULL
    -- If the value is already a valid number
    WHEN TRY_CAST(transaction_amount AS DOUBLE) IS NOT NULL 
        THEN TRY_CAST(transaction_amount AS DOUBLE)
    -- If contains both dot and comma (German notation)
    WHEN POSITION('.' IN transaction_amount) > 0 AND POSITION(',' IN transaction_amount) > 0 
        THEN TRY_CAST(REPLACE(REPLACE(TRIM(transaction_amount), '.', ''), ',', '.') AS DOUBLE)
    -- If only contains comma, treat as decimal point
    WHEN POSITION(',' IN transaction_amount) > 0 
        THEN TRY_CAST(REPLACE(TRIM(transaction_amount), ',', '.') AS DOUBLE)
    -- If only contains dots, likely thousands separator
    WHEN POSITION('.' IN transaction_amount) > 0 
        THEN TRY_CAST(REPLACE(TRIM(transaction_amount), '.', '') AS DOUBLE)
    ELSE NULL
END
 as transaction_amount,
        trim(transaction_currency) as transaction_currency
    from source
),

final as (
    select
        transaction_id,
        transaction_date,
        account_id,
        transaction_type,
        transaction_amount,
        transaction_currency,
        -- Flag records with date parsing issues
        CASE WHEN transaction_date IS NULL AND transaction_date_raw IS NOT NULL
             THEN TRUE ELSE FALSE 
        END as has_date_parsing_error
    from renamed
)

select * from final
  );

[0m02:28:27.141007 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:28:27.143016 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_raw_staging__transactions"
[0m02:28:27.143253 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__transactions: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_raw_staging__transactions"} */
alter view "casestudy"."staging"."stg_raw_staging__transactions" rename to "stg_raw_staging__transactions__dbt_backup"
[0m02:28:27.143696 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:28:27.145425 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_raw_staging__transactions"
[0m02:28:27.145630 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__transactions: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_raw_staging__transactions"} */
alter view "casestudy"."staging"."stg_raw_staging__transactions__dbt_tmp" rename to "stg_raw_staging__transactions"
[0m02:28:27.145970 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:28:27.146831 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__transactions: COMMIT
[0m02:28:27.147022 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_raw_staging__transactions"
[0m02:28:27.147193 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__transactions: COMMIT
[0m02:28:27.149225 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:28:27.150558 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_raw_staging__transactions"
[0m02:28:27.150754 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__transactions: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_raw_staging__transactions"} */
drop view if exists "casestudy"."staging"."stg_raw_staging__transactions__dbt_backup" cascade
[0m02:28:27.151631 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:28:27.152353 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.stg_raw_staging__transactions (execute): 02:28:27.130158 => 02:28:27.152257
[0m02:28:27.152540 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__transactions: Close
[0m02:28:27.164850 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3aeec56f-ff13-44f7-96b5-c78c6b5fd01e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x740a703bef90>]}
[0m02:28:27.165377 [info ] [Thread-1 (]: 5 of 11 OK created sql view model staging.stg_raw_staging__transactions ........ [[32mOK[0m in 0.04s]
[0m02:28:27.165809 [debug] [Thread-1 (]: Finished running node model.vg_casestudy.stg_raw_staging__transactions
[0m02:28:27.166118 [debug] [Thread-1 (]: Began running node model.vg_casestudy.stg_staging_intermediate__currencies
[0m02:28:27.166541 [info ] [Thread-1 (]: 6 of 11 START sql table model intermediate.stg_staging_intermediate__currencies  [RUN]
[0m02:28:27.166907 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.vg_casestudy.stg_raw_staging__transactions, now model.vg_casestudy.stg_staging_intermediate__currencies)
[0m02:28:27.167102 [debug] [Thread-1 (]: Began compiling node model.vg_casestudy.stg_staging_intermediate__currencies
[0m02:28:27.168795 [debug] [Thread-1 (]: Writing injected SQL for node "model.vg_casestudy.stg_staging_intermediate__currencies"
[0m02:28:27.169144 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.stg_staging_intermediate__currencies (compile): 02:28:27.167238 => 02:28:27.169022
[0m02:28:27.169330 [debug] [Thread-1 (]: Began executing node model.vg_casestudy.stg_staging_intermediate__currencies
[0m02:28:27.179730 [debug] [Thread-1 (]: Writing runtime sql for node "model.vg_casestudy.stg_staging_intermediate__currencies"
[0m02:28:27.180105 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__currencies"
[0m02:28:27.180316 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__currencies: BEGIN
[0m02:28:27.180489 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:28:27.187886 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:28:27.188153 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__currencies"
[0m02:28:27.188344 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__currencies: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_staging_intermediate__currencies"} */

  
    
    

    create  table
      "casestudy"."intermediate"."stg_staging_intermediate__currencies__dbt_tmp"
  
    as (
      with staging as (
    select * from "casestudy"."raw"."currencies"
),
cleaned as (
    select distinct
        trim(currency) as currency,
        trim(currency_iso_code) as currency_iso_code,
    from staging
    where currency_iso_code is not null and trim(currency_iso_code) != '(none)'
)

select * from cleaned
    );
  
  
[0m02:28:27.190506 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:28:27.192295 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__currencies"
[0m02:28:27.192501 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__currencies: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_staging_intermediate__currencies"} */
alter table "casestudy"."intermediate"."stg_staging_intermediate__currencies" rename to "stg_staging_intermediate__currencies__dbt_backup"
[0m02:28:27.192836 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:28:27.195272 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__currencies"
[0m02:28:27.195478 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__currencies: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_staging_intermediate__currencies"} */
alter table "casestudy"."intermediate"."stg_staging_intermediate__currencies__dbt_tmp" rename to "stg_staging_intermediate__currencies"
[0m02:28:27.195889 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:28:27.198766 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__currencies: COMMIT
[0m02:28:27.198973 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__currencies"
[0m02:28:27.199159 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__currencies: COMMIT
[0m02:28:27.200552 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:28:27.201857 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__currencies"
[0m02:28:27.202055 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__currencies: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_staging_intermediate__currencies"} */
drop table if exists "casestudy"."intermediate"."stg_staging_intermediate__currencies__dbt_backup" cascade
[0m02:28:27.203010 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:28:27.203717 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.stg_staging_intermediate__currencies (execute): 02:28:27.169448 => 02:28:27.203621
[0m02:28:27.203903 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__currencies: Close
[0m02:28:27.217949 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3aeec56f-ff13-44f7-96b5-c78c6b5fd01e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x740a70074390>]}
[0m02:28:27.218318 [info ] [Thread-1 (]: 6 of 11 OK created sql table model intermediate.stg_staging_intermediate__currencies  [[32mOK[0m in 0.05s]
[0m02:28:27.218619 [debug] [Thread-1 (]: Finished running node model.vg_casestudy.stg_staging_intermediate__currencies
[0m02:28:27.218828 [debug] [Thread-1 (]: Began running node model.vg_casestudy.stg_staging_intermediate__accounts
[0m02:28:27.219130 [info ] [Thread-1 (]: 7 of 11 START sql table model intermediate.stg_staging_intermediate__accounts .. [RUN]
[0m02:28:27.219459 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.vg_casestudy.stg_staging_intermediate__currencies, now model.vg_casestudy.stg_staging_intermediate__accounts)
[0m02:28:27.219646 [debug] [Thread-1 (]: Began compiling node model.vg_casestudy.stg_staging_intermediate__accounts
[0m02:28:27.221303 [debug] [Thread-1 (]: Writing injected SQL for node "model.vg_casestudy.stg_staging_intermediate__accounts"
[0m02:28:27.221641 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.stg_staging_intermediate__accounts (compile): 02:28:27.219763 => 02:28:27.221529
[0m02:28:27.221821 [debug] [Thread-1 (]: Began executing node model.vg_casestudy.stg_staging_intermediate__accounts
[0m02:28:27.223796 [debug] [Thread-1 (]: Writing runtime sql for node "model.vg_casestudy.stg_staging_intermediate__accounts"
[0m02:28:27.224088 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__accounts"
[0m02:28:27.224287 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__accounts: BEGIN
[0m02:28:27.224450 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:28:27.231737 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:28:27.232110 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__accounts"
[0m02:28:27.232365 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__accounts: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_staging_intermediate__accounts"} */

  
    
    

    create  table
      "casestudy"."intermediate"."stg_staging_intermediate__accounts__dbt_tmp"
  
    as (
      with staging as (
    select * from "casestudy"."staging"."stg_raw_staging__accounts"
), 
filtered as (
    select 
        account_id,
        customer_id,
        account_type,
        account_opening_date,
     from staging
    where not has_date_parsing_error
)

select * from filtered
    );
  
  
[0m02:28:27.236328 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:28:27.238421 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__accounts"
[0m02:28:27.238636 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__accounts: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_staging_intermediate__accounts"} */
alter table "casestudy"."intermediate"."stg_staging_intermediate__accounts" rename to "stg_staging_intermediate__accounts__dbt_backup"
[0m02:28:27.238992 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:28:27.240584 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__accounts"
[0m02:28:27.240797 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__accounts: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_staging_intermediate__accounts"} */
alter table "casestudy"."intermediate"."stg_staging_intermediate__accounts__dbt_tmp" rename to "stg_staging_intermediate__accounts"
[0m02:28:27.241191 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:28:27.242155 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__accounts: COMMIT
[0m02:28:27.242357 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__accounts"
[0m02:28:27.242536 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__accounts: COMMIT
[0m02:28:27.244038 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:28:27.245385 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__accounts"
[0m02:28:27.245587 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__accounts: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_staging_intermediate__accounts"} */
drop table if exists "casestudy"."intermediate"."stg_staging_intermediate__accounts__dbt_backup" cascade
[0m02:28:27.246521 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:28:27.247292 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.stg_staging_intermediate__accounts (execute): 02:28:27.221935 => 02:28:27.247188
[0m02:28:27.247489 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__accounts: Close
[0m02:28:27.259816 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3aeec56f-ff13-44f7-96b5-c78c6b5fd01e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x740a70427710>]}
[0m02:28:27.260238 [info ] [Thread-1 (]: 7 of 11 OK created sql table model intermediate.stg_staging_intermediate__accounts  [[32mOK[0m in 0.04s]
[0m02:28:27.260558 [debug] [Thread-1 (]: Finished running node model.vg_casestudy.stg_staging_intermediate__accounts
[0m02:28:27.260790 [debug] [Thread-1 (]: Began running node model.vg_casestudy.stg_staging_intermediate__customers
[0m02:28:27.261101 [info ] [Thread-1 (]: 8 of 11 START sql table model intermediate.stg_staging_intermediate__customers . [RUN]
[0m02:28:27.261467 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.vg_casestudy.stg_staging_intermediate__accounts, now model.vg_casestudy.stg_staging_intermediate__customers)
[0m02:28:27.261672 [debug] [Thread-1 (]: Began compiling node model.vg_casestudy.stg_staging_intermediate__customers
[0m02:28:27.263528 [debug] [Thread-1 (]: Writing injected SQL for node "model.vg_casestudy.stg_staging_intermediate__customers"
[0m02:28:27.263908 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.stg_staging_intermediate__customers (compile): 02:28:27.261796 => 02:28:27.263785
[0m02:28:27.264089 [debug] [Thread-1 (]: Began executing node model.vg_casestudy.stg_staging_intermediate__customers
[0m02:28:27.266187 [debug] [Thread-1 (]: Writing runtime sql for node "model.vg_casestudy.stg_staging_intermediate__customers"
[0m02:28:27.266495 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__customers"
[0m02:28:27.266689 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__customers: BEGIN
[0m02:28:27.266877 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:28:27.274276 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:28:27.274519 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__customers"
[0m02:28:27.274708 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__customers: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_staging_intermediate__customers"} */

  
    
    

    create  table
      "casestudy"."intermediate"."stg_staging_intermediate__customers__dbt_tmp"
  
    as (
      with staging as (
    select * from "casestudy"."staging"."stg_raw_staging__customers"
)

select * from staging
    );
  
  
[0m02:28:27.279828 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:28:27.282751 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__customers"
[0m02:28:27.282966 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__customers: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_staging_intermediate__customers"} */
alter table "casestudy"."intermediate"."stg_staging_intermediate__customers" rename to "stg_staging_intermediate__customers__dbt_backup"
[0m02:28:27.283332 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:28:27.284903 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__customers"
[0m02:28:27.285114 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__customers: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_staging_intermediate__customers"} */
alter table "casestudy"."intermediate"."stg_staging_intermediate__customers__dbt_tmp" rename to "stg_staging_intermediate__customers"
[0m02:28:27.285501 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:28:27.286458 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__customers: COMMIT
[0m02:28:27.286657 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__customers"
[0m02:28:27.286829 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__customers: COMMIT
[0m02:28:27.288684 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:28:27.290111 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__customers"
[0m02:28:27.290377 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__customers: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_staging_intermediate__customers"} */
drop table if exists "casestudy"."intermediate"."stg_staging_intermediate__customers__dbt_backup" cascade
[0m02:28:27.291695 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:28:27.292474 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.stg_staging_intermediate__customers (execute): 02:28:27.264217 => 02:28:27.292375
[0m02:28:27.292671 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__customers: Close
[0m02:28:27.311926 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3aeec56f-ff13-44f7-96b5-c78c6b5fd01e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x740a70095ed0>]}
[0m02:28:27.312353 [info ] [Thread-1 (]: 8 of 11 OK created sql table model intermediate.stg_staging_intermediate__customers  [[32mOK[0m in 0.05s]
[0m02:28:27.312669 [debug] [Thread-1 (]: Finished running node model.vg_casestudy.stg_staging_intermediate__customers
[0m02:28:27.312889 [debug] [Thread-1 (]: Began running node model.vg_casestudy.stg_staging_intermediate__fx_rates
[0m02:28:27.313188 [info ] [Thread-1 (]: 9 of 11 START sql table model intermediate.stg_staging_intermediate__fx_rates .. [RUN]
[0m02:28:27.313541 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.vg_casestudy.stg_staging_intermediate__customers, now model.vg_casestudy.stg_staging_intermediate__fx_rates)
[0m02:28:27.313733 [debug] [Thread-1 (]: Began compiling node model.vg_casestudy.stg_staging_intermediate__fx_rates
[0m02:28:27.315456 [debug] [Thread-1 (]: Writing injected SQL for node "model.vg_casestudy.stg_staging_intermediate__fx_rates"
[0m02:28:27.315800 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.stg_staging_intermediate__fx_rates (compile): 02:28:27.313851 => 02:28:27.315686
[0m02:28:27.315983 [debug] [Thread-1 (]: Began executing node model.vg_casestudy.stg_staging_intermediate__fx_rates
[0m02:28:27.317996 [debug] [Thread-1 (]: Writing runtime sql for node "model.vg_casestudy.stg_staging_intermediate__fx_rates"
[0m02:28:27.318298 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__fx_rates"
[0m02:28:27.318478 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__fx_rates: BEGIN
[0m02:28:27.318640 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:28:27.326050 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:28:27.326380 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__fx_rates"
[0m02:28:27.326598 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__fx_rates: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_staging_intermediate__fx_rates"} */

  
    
    

    create  table
      "casestudy"."intermediate"."stg_staging_intermediate__fx_rates__dbt_tmp"
  
    as (
      with staging as (
    select * from "casestudy"."staging"."stg_raw_staging__fx_rates"
),

filtered as (
    select
        currency_iso_code,
        fx_rate,
        fx_rate_date
    from staging
    where not has_date_parsing_error
)

select * from filtered
    );
  
  
[0m02:28:27.328999 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:28:27.330871 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__fx_rates"
[0m02:28:27.331080 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__fx_rates: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_staging_intermediate__fx_rates"} */
alter table "casestudy"."intermediate"."stg_staging_intermediate__fx_rates" rename to "stg_staging_intermediate__fx_rates__dbt_backup"
[0m02:28:27.331498 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:28:27.333080 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__fx_rates"
[0m02:28:27.333295 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__fx_rates: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_staging_intermediate__fx_rates"} */
alter table "casestudy"."intermediate"."stg_staging_intermediate__fx_rates__dbt_tmp" rename to "stg_staging_intermediate__fx_rates"
[0m02:28:27.333628 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:28:27.334583 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__fx_rates: COMMIT
[0m02:28:27.334782 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__fx_rates"
[0m02:28:27.334954 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__fx_rates: COMMIT
[0m02:28:27.336413 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:28:27.337792 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__fx_rates"
[0m02:28:27.337994 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__fx_rates: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_staging_intermediate__fx_rates"} */
drop table if exists "casestudy"."intermediate"."stg_staging_intermediate__fx_rates__dbt_backup" cascade
[0m02:28:27.339192 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:28:27.339927 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.stg_staging_intermediate__fx_rates (execute): 02:28:27.316100 => 02:28:27.339828
[0m02:28:27.340119 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__fx_rates: Close
[0m02:28:27.352291 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3aeec56f-ff13-44f7-96b5-c78c6b5fd01e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x740a70559110>]}
[0m02:28:27.352684 [info ] [Thread-1 (]: 9 of 11 OK created sql table model intermediate.stg_staging_intermediate__fx_rates  [[32mOK[0m in 0.04s]
[0m02:28:27.352987 [debug] [Thread-1 (]: Finished running node model.vg_casestudy.stg_staging_intermediate__fx_rates
[0m02:28:27.353207 [debug] [Thread-1 (]: Began running node model.vg_casestudy.stg_staging_intermediate__loans
[0m02:28:27.353498 [info ] [Thread-1 (]: 10 of 11 START sql table model intermediate.stg_staging_intermediate__loans .... [RUN]
[0m02:28:27.353840 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.vg_casestudy.stg_staging_intermediate__fx_rates, now model.vg_casestudy.stg_staging_intermediate__loans)
[0m02:28:27.354029 [debug] [Thread-1 (]: Began compiling node model.vg_casestudy.stg_staging_intermediate__loans
[0m02:28:27.355741 [debug] [Thread-1 (]: Writing injected SQL for node "model.vg_casestudy.stg_staging_intermediate__loans"
[0m02:28:27.356079 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.stg_staging_intermediate__loans (compile): 02:28:27.354158 => 02:28:27.355965
[0m02:28:27.356268 [debug] [Thread-1 (]: Began executing node model.vg_casestudy.stg_staging_intermediate__loans
[0m02:28:27.359332 [debug] [Thread-1 (]: Writing runtime sql for node "model.vg_casestudy.stg_staging_intermediate__loans"
[0m02:28:27.359629 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__loans"
[0m02:28:27.359808 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__loans: BEGIN
[0m02:28:27.359968 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:28:27.366972 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:28:27.367216 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__loans"
[0m02:28:27.367409 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__loans: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_staging_intermediate__loans"} */

  
    
    

    create  table
      "casestudy"."intermediate"."stg_staging_intermediate__loans__dbt_tmp"
  
    as (
      with staging as (
    select * from "casestudy"."staging"."stg_raw_staging__loans"
),

filtered as (
    select
        customer_id,
        loan_id,
        loan_amount,
        loan_type,
        interest_rate,
        loan_term,
        approval_rejection_date,
        loan_status
    from staging
    where not has_date_parsing_error
)

select * from filtered
    );
  
  
[0m02:28:27.376255 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:28:27.378504 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__loans"
[0m02:28:27.378753 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__loans: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_staging_intermediate__loans"} */
alter table "casestudy"."intermediate"."stg_staging_intermediate__loans" rename to "stg_staging_intermediate__loans__dbt_backup"
[0m02:28:27.379158 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:28:27.380754 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__loans"
[0m02:28:27.380959 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__loans: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_staging_intermediate__loans"} */
alter table "casestudy"."intermediate"."stg_staging_intermediate__loans__dbt_tmp" rename to "stg_staging_intermediate__loans"
[0m02:28:27.381301 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:28:27.382252 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__loans: COMMIT
[0m02:28:27.382462 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__loans"
[0m02:28:27.382637 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__loans: COMMIT
[0m02:28:27.384456 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:28:27.385853 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__loans"
[0m02:28:27.386058 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__loans: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_staging_intermediate__loans"} */
drop table if exists "casestudy"."intermediate"."stg_staging_intermediate__loans__dbt_backup" cascade
[0m02:28:27.386972 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:28:27.387697 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.stg_staging_intermediate__loans (execute): 02:28:27.356385 => 02:28:27.387600
[0m02:28:27.387889 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__loans: Close
[0m02:28:27.401998 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3aeec56f-ff13-44f7-96b5-c78c6b5fd01e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x740a70076c50>]}
[0m02:28:27.402403 [info ] [Thread-1 (]: 10 of 11 OK created sql table model intermediate.stg_staging_intermediate__loans  [[32mOK[0m in 0.05s]
[0m02:28:27.402709 [debug] [Thread-1 (]: Finished running node model.vg_casestudy.stg_staging_intermediate__loans
[0m02:28:27.402924 [debug] [Thread-1 (]: Began running node model.vg_casestudy.stg_staging_intermediate__transactions
[0m02:28:27.403217 [info ] [Thread-1 (]: 11 of 11 START sql table model intermediate.stg_staging_intermediate__transactions  [RUN]
[0m02:28:27.403551 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.vg_casestudy.stg_staging_intermediate__loans, now model.vg_casestudy.stg_staging_intermediate__transactions)
[0m02:28:27.403741 [debug] [Thread-1 (]: Began compiling node model.vg_casestudy.stg_staging_intermediate__transactions
[0m02:28:27.405445 [debug] [Thread-1 (]: Writing injected SQL for node "model.vg_casestudy.stg_staging_intermediate__transactions"
[0m02:28:27.405793 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.stg_staging_intermediate__transactions (compile): 02:28:27.403858 => 02:28:27.405679
[0m02:28:27.405971 [debug] [Thread-1 (]: Began executing node model.vg_casestudy.stg_staging_intermediate__transactions
[0m02:28:27.407899 [debug] [Thread-1 (]: Writing runtime sql for node "model.vg_casestudy.stg_staging_intermediate__transactions"
[0m02:28:27.408209 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__transactions"
[0m02:28:27.408395 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__transactions: BEGIN
[0m02:28:27.408554 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:28:27.416330 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:28:27.416658 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__transactions"
[0m02:28:27.416861 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__transactions: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_staging_intermediate__transactions"} */

  
    
    

    create  table
      "casestudy"."intermediate"."stg_staging_intermediate__transactions__dbt_tmp"
  
    as (
      with staging as (
    select * from "casestudy"."staging"."stg_raw_staging__transactions"
),

filtered as (
    select
        transaction_id,
        transaction_date,
        account_id,
        transaction_type,
        transaction_amount,
        transaction_currency
    from staging
    where not has_date_parsing_error
)

select * from filtered
    );
  
  
[0m02:28:27.455847 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:28:27.458099 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__transactions"
[0m02:28:27.458324 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__transactions: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_staging_intermediate__transactions"} */
alter table "casestudy"."intermediate"."stg_staging_intermediate__transactions" rename to "stg_staging_intermediate__transactions__dbt_backup"
[0m02:28:27.458760 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:28:27.460480 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__transactions"
[0m02:28:27.460775 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__transactions: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_staging_intermediate__transactions"} */
alter table "casestudy"."intermediate"."stg_staging_intermediate__transactions__dbt_tmp" rename to "stg_staging_intermediate__transactions"
[0m02:28:27.461232 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:28:27.462253 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__transactions: COMMIT
[0m02:28:27.462449 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__transactions"
[0m02:28:27.462617 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__transactions: COMMIT
[0m02:28:27.467662 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:28:27.469100 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__transactions"
[0m02:28:27.469309 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__transactions: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_staging_intermediate__transactions"} */
drop table if exists "casestudy"."intermediate"."stg_staging_intermediate__transactions__dbt_backup" cascade
[0m02:28:27.470257 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:28:27.471001 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.stg_staging_intermediate__transactions (execute): 02:28:27.406085 => 02:28:27.470903
[0m02:28:27.471194 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__transactions: Close
[0m02:28:27.494900 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3aeec56f-ff13-44f7-96b5-c78c6b5fd01e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x740a70077850>]}
[0m02:28:27.495278 [info ] [Thread-1 (]: 11 of 11 OK created sql table model intermediate.stg_staging_intermediate__transactions  [[32mOK[0m in 0.09s]
[0m02:28:27.495577 [debug] [Thread-1 (]: Finished running node model.vg_casestudy.stg_staging_intermediate__transactions
[0m02:28:27.496658 [debug] [MainThread]: Using duckdb connection "master"
[0m02:28:27.496834 [debug] [MainThread]: On master: BEGIN
[0m02:28:27.496974 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:28:27.504383 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m02:28:27.504584 [debug] [MainThread]: On master: COMMIT
[0m02:28:27.504731 [debug] [MainThread]: Using duckdb connection "master"
[0m02:28:27.504867 [debug] [MainThread]: On master: COMMIT
[0m02:28:27.505183 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m02:28:27.505350 [debug] [MainThread]: On master: Close
[0m02:28:27.506805 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:28:27.506983 [debug] [MainThread]: Connection 'list_casestudy_intermediate' was properly closed.
[0m02:28:27.507121 [debug] [MainThread]: Connection 'model.vg_casestudy.stg_staging_intermediate__transactions' was properly closed.
[0m02:28:27.507346 [info ] [MainThread]: 
[0m02:28:27.507523 [info ] [MainThread]: Finished running 5 view models, 6 table models in 0 hours 0 minutes and 0.77 seconds (0.77s).
[0m02:28:27.508433 [debug] [MainThread]: Command end result
[0m02:28:27.519635 [info ] [MainThread]: 
[0m02:28:27.519924 [info ] [MainThread]: [32mCompleted successfully[0m
[0m02:28:27.520090 [info ] [MainThread]: 
[0m02:28:27.520262 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=0 SKIP=0 TOTAL=11
[0m02:28:27.520519 [debug] [MainThread]: Command `dbt run` succeeded at 02:28:27.520460 after 0.91 seconds
[0m02:28:27.520712 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x740a7909da50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x740a7909c990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x740a7909dbd0>]}
[0m02:28:27.520899 [debug] [MainThread]: Flushing usage events
[0m02:30:08.370277 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c7a2fe22050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c7a3015bb10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c7a301921d0>]}


============================== 02:30:08.373198 | f9c6553f-5fe9-4ba1-91f8-90d6cbeef8c8 ==============================
[0m02:30:08.373198 [info ] [MainThread]: Running with dbt=1.6.18
[0m02:30:08.373791 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/workspaces/varengold_data_analyst_case/transformation/logs', 'profiles_dir': '/workspaces/varengold_data_analyst_case/transformation', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --full-refresh', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m02:30:08.431087 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f9c6553f-5fe9-4ba1-91f8-90d6cbeef8c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c7a3017d9d0>]}
[0m02:30:08.439068 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f9c6553f-5fe9-4ba1-91f8-90d6cbeef8c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c7a2fe38910>]}
[0m02:30:08.439522 [info ] [MainThread]: Registered adapter: duckdb=1.6.2
[0m02:30:08.452314 [debug] [MainThread]: checksum: 7b9fab86a08e9e96a48a825af743c566d95b877e068b8c6d0dbafbf714447189, vars: {}, profile: , target: , version: 1.6.18
[0m02:30:08.474361 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m02:30:08.474642 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m02:30:08.475348 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.vg_casestudy.reporting
- models.vg_casestudy.marts
- models.vg_casestudy.main
[0m02:30:08.479227 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f9c6553f-5fe9-4ba1-91f8-90d6cbeef8c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c7a2fbc8350>]}
[0m02:30:08.494021 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f9c6553f-5fe9-4ba1-91f8-90d6cbeef8c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c7a2c4d2850>]}
[0m02:30:08.494400 [info ] [MainThread]: Found 11 models, 1 analysis, 2 seeds, 71 tests, 5 sources, 0 exposures, 0 metrics, 632 macros, 0 groups, 0 semantic models
[0m02:30:08.494601 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f9c6553f-5fe9-4ba1-91f8-90d6cbeef8c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c7a2b97bd50>]}
[0m02:30:08.496366 [info ] [MainThread]: 
[0m02:30:08.496819 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m02:30:08.498164 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_casestudy'
[0m02:30:08.511218 [debug] [ThreadPool]: Using duckdb connection "list_casestudy"
[0m02:30:08.511459 [debug] [ThreadPool]: On list_casestudy: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"casestudy"'
    
  
  
[0m02:30:08.511628 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:30:08.521724 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m02:30:08.522630 [debug] [ThreadPool]: On list_casestudy: Close
[0m02:30:08.526828 [debug] [ThreadPool]: Using duckdb connection "list_casestudy"
[0m02:30:08.527145 [debug] [ThreadPool]: On list_casestudy: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"casestudy"'
    
  
  
[0m02:30:08.527345 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:30:08.534731 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m02:30:08.535548 [debug] [ThreadPool]: On list_casestudy: Close
[0m02:30:08.538415 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy, now create_casestudy_intermediate)
[0m02:30:08.538937 [debug] [ThreadPool]: Creating schema "database: "casestudy"
schema: "intermediate"
"
[0m02:30:08.541668 [debug] [ThreadPool]: Using duckdb connection "create_casestudy_intermediate"
[0m02:30:08.541854 [debug] [ThreadPool]: On create_casestudy_intermediate: BEGIN
[0m02:30:08.541995 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:30:08.548718 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m02:30:08.548913 [debug] [ThreadPool]: Using duckdb connection "create_casestudy_intermediate"
[0m02:30:08.549067 [debug] [ThreadPool]: On create_casestudy_intermediate: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "create_casestudy_intermediate"} */
create schema if not exists "casestudy"."intermediate"
[0m02:30:08.549412 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m02:30:08.549905 [debug] [ThreadPool]: On create_casestudy_intermediate: COMMIT
[0m02:30:08.550069 [debug] [ThreadPool]: Using duckdb connection "create_casestudy_intermediate"
[0m02:30:08.550218 [debug] [ThreadPool]: On create_casestudy_intermediate: COMMIT
[0m02:30:08.550460 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m02:30:08.550621 [debug] [ThreadPool]: On create_casestudy_intermediate: Close
[0m02:30:08.552510 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_casestudy_intermediate, now create_casestudy_staging)
[0m02:30:08.552898 [debug] [ThreadPool]: Creating schema "database: "casestudy"
schema: "staging"
"
[0m02:30:08.554388 [debug] [ThreadPool]: Using duckdb connection "create_casestudy_staging"
[0m02:30:08.554906 [debug] [ThreadPool]: On create_casestudy_staging: BEGIN
[0m02:30:08.555174 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:30:08.561856 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m02:30:08.562048 [debug] [ThreadPool]: Using duckdb connection "create_casestudy_staging"
[0m02:30:08.562210 [debug] [ThreadPool]: On create_casestudy_staging: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "create_casestudy_staging"} */
create schema if not exists "casestudy"."staging"
[0m02:30:08.562491 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m02:30:08.562983 [debug] [ThreadPool]: On create_casestudy_staging: COMMIT
[0m02:30:08.563152 [debug] [ThreadPool]: Using duckdb connection "create_casestudy_staging"
[0m02:30:08.563295 [debug] [ThreadPool]: On create_casestudy_staging: COMMIT
[0m02:30:08.563537 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m02:30:08.563705 [debug] [ThreadPool]: On create_casestudy_staging: Close
[0m02:30:08.566593 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_casestudy_staging, now list_casestudy_intermediate)
[0m02:30:08.572175 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_intermediate"
[0m02:30:08.572357 [debug] [ThreadPool]: On list_casestudy_intermediate: BEGIN
[0m02:30:08.572500 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:30:08.578954 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m02:30:08.579147 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_intermediate"
[0m02:30:08.579306 [debug] [ThreadPool]: On list_casestudy_intermediate: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_intermediate"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'intermediate'
    and table_catalog = 'casestudy'
  
[0m02:30:08.586172 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m02:30:08.586950 [debug] [ThreadPool]: On list_casestudy_intermediate: ROLLBACK
[0m02:30:08.587388 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_intermediate'
[0m02:30:08.587555 [debug] [ThreadPool]: On list_casestudy_intermediate: Close
[0m02:30:08.590271 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy_intermediate, now list_casestudy_raw)
[0m02:30:08.593699 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_raw"
[0m02:30:08.594041 [debug] [ThreadPool]: On list_casestudy_raw: BEGIN
[0m02:30:08.594326 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:30:08.603506 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m02:30:08.603748 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_raw"
[0m02:30:08.603917 [debug] [ThreadPool]: On list_casestudy_raw: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_raw"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'raw'
    and table_catalog = 'casestudy'
  
[0m02:30:08.609661 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m02:30:08.610445 [debug] [ThreadPool]: On list_casestudy_raw: ROLLBACK
[0m02:30:08.610733 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_raw'
[0m02:30:08.610894 [debug] [ThreadPool]: On list_casestudy_raw: Close
[0m02:30:08.612942 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy_raw, now list_casestudy_staging)
[0m02:30:08.615566 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_staging"
[0m02:30:08.615737 [debug] [ThreadPool]: On list_casestudy_staging: BEGIN
[0m02:30:08.615875 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:30:08.622815 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m02:30:08.623004 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_staging"
[0m02:30:08.623169 [debug] [ThreadPool]: On list_casestudy_staging: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_staging"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'staging'
    and table_catalog = 'casestudy'
  
[0m02:30:08.629909 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m02:30:08.630612 [debug] [ThreadPool]: On list_casestudy_staging: ROLLBACK
[0m02:30:08.630864 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_staging'
[0m02:30:08.631011 [debug] [ThreadPool]: On list_casestudy_staging: Close
[0m02:30:08.633982 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f9c6553f-5fe9-4ba1-91f8-90d6cbeef8c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c7a3016d590>]}
[0m02:30:08.634541 [debug] [MainThread]: Using duckdb connection "master"
[0m02:30:08.634889 [debug] [MainThread]: On master: BEGIN
[0m02:30:08.635220 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:30:08.643064 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m02:30:08.643268 [debug] [MainThread]: On master: COMMIT
[0m02:30:08.643421 [debug] [MainThread]: Using duckdb connection "master"
[0m02:30:08.643564 [debug] [MainThread]: On master: COMMIT
[0m02:30:08.643789 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m02:30:08.643951 [debug] [MainThread]: On master: Close
[0m02:30:08.645310 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:30:08.645514 [info ] [MainThread]: 
[0m02:30:08.646997 [debug] [Thread-1 (]: Began running node model.vg_casestudy.stg_raw_staging__accounts
[0m02:30:08.647545 [info ] [Thread-1 (]: 1 of 11 START sql view model staging.stg_raw_staging__accounts ................. [RUN]
[0m02:30:08.648402 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.vg_casestudy.stg_raw_staging__accounts'
[0m02:30:08.648892 [debug] [Thread-1 (]: Began compiling node model.vg_casestudy.stg_raw_staging__accounts
[0m02:30:08.655436 [debug] [Thread-1 (]: Writing injected SQL for node "model.vg_casestudy.stg_raw_staging__accounts"
[0m02:30:08.655820 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.stg_raw_staging__accounts (compile): 02:30:08.649196 => 02:30:08.655706
[0m02:30:08.656015 [debug] [Thread-1 (]: Began executing node model.vg_casestudy.stg_raw_staging__accounts
[0m02:30:08.676423 [debug] [Thread-1 (]: Writing runtime sql for node "model.vg_casestudy.stg_raw_staging__accounts"
[0m02:30:08.676871 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_raw_staging__accounts"
[0m02:30:08.677094 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__accounts: BEGIN
[0m02:30:08.677286 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m02:30:08.685327 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:30:08.685568 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_raw_staging__accounts"
[0m02:30:08.685809 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__accounts: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_raw_staging__accounts"} */

  
  create view "casestudy"."staging"."stg_raw_staging__accounts__dbt_tmp" as (
    with source as (
    select * from "casestudy"."raw"."accounts"
),

renamed as (
    select
        account_id,
        customer_id,
        account_type,
        
CASE
    -- First try DD.MM.YYYY format (German format with dots)
    WHEN REGEXP_MATCHES(account_opening_date, '^\d{1,2}\.\d{1,2}\.\d{4}$') 
        THEN TRY_CAST(STRPTIME(account_opening_date, '%d.%m.%Y') AS DATE)
        
    -- Then try DD/MM/YYYY format (with slashes)
    WHEN REGEXP_MATCHES(account_opening_date, '^\d{1,2}/\d{1,2}/\d{4}$')
        AND CAST(SPLIT_PART(account_opening_date, '/', 1) AS INTEGER) <= 31 
        AND CAST(SPLIT_PART(account_opening_date, '/', 2) AS INTEGER) <= 12 
        THEN TRY_CAST(STRPTIME(account_opening_date, '%d/%m/%Y') AS DATE)
        
    -- Try MM/DD/YYYY format (US format with slashes)
    WHEN REGEXP_MATCHES(account_opening_date, '^\d{1,2}/\d{1,2}/\d{4}$')
        AND CAST(SPLIT_PART(account_opening_date, '/', 1) AS INTEGER) <= 12 
        THEN TRY_CAST(STRPTIME(account_opening_date, '%m/%d/%Y') AS DATE)
        
    -- Try YYYY-MM-DD format (ISO format)
    WHEN REGEXP_MATCHES(account_opening_date, '^\d{4}-\d{1,2}-\d{1,2}$')
        THEN TRY_CAST(STRPTIME(account_opening_date, '%Y-%m-%d') AS DATE)
        
    -- Try generic date parsing as last resort
    ELSE TRY_CAST(account_opening_date AS DATE)
END
 as account_opening_date,
        account_opening_date as account_opening_date_raw
    from source
    where account_type is not null and account_type != '' and account_type != '-'
),

final as (
    select
        account_id,
        customer_id,
        account_type,
        account_opening_date,
        -- Flag records with date parsing issues
        CASE WHEN account_opening_date IS NULL AND account_opening_date_raw IS NOT NULL
             THEN TRUE ELSE FALSE 
        END as has_date_parsing_error
    from renamed
)

select * from final
  );

[0m02:30:08.686816 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:30:08.728316 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_raw_staging__accounts"
[0m02:30:08.728654 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__accounts: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_raw_staging__accounts"} */
alter view "casestudy"."staging"."stg_raw_staging__accounts" rename to "stg_raw_staging__accounts__dbt_backup"
[0m02:30:08.729368 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:30:08.731361 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_raw_staging__accounts"
[0m02:30:08.731626 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__accounts: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_raw_staging__accounts"} */
alter view "casestudy"."staging"."stg_raw_staging__accounts__dbt_tmp" rename to "stg_raw_staging__accounts"
[0m02:30:08.732214 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:30:08.741888 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__accounts: COMMIT
[0m02:30:08.742182 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_raw_staging__accounts"
[0m02:30:08.742395 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__accounts: COMMIT
[0m02:30:08.744383 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:30:08.747319 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_raw_staging__accounts"
[0m02:30:08.747549 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__accounts: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_raw_staging__accounts"} */
drop view if exists "casestudy"."staging"."stg_raw_staging__accounts__dbt_backup" cascade
[0m02:30:08.748588 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:30:08.749486 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.stg_raw_staging__accounts (execute): 02:30:08.656145 => 02:30:08.749386
[0m02:30:08.749707 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__accounts: Close
[0m02:30:08.761876 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f9c6553f-5fe9-4ba1-91f8-90d6cbeef8c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c7a2b9bd190>]}
[0m02:30:08.762275 [info ] [Thread-1 (]: 1 of 11 OK created sql view model staging.stg_raw_staging__accounts ............ [[32mOK[0m in 0.11s]
[0m02:30:08.762605 [debug] [Thread-1 (]: Finished running node model.vg_casestudy.stg_raw_staging__accounts
[0m02:30:08.762839 [debug] [Thread-1 (]: Began running node model.vg_casestudy.stg_raw_staging__customers
[0m02:30:08.763073 [info ] [Thread-1 (]: 2 of 11 START sql view model staging.stg_raw_staging__customers ................ [RUN]
[0m02:30:08.763437 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.vg_casestudy.stg_raw_staging__accounts, now model.vg_casestudy.stg_raw_staging__customers)
[0m02:30:08.763757 [debug] [Thread-1 (]: Began compiling node model.vg_casestudy.stg_raw_staging__customers
[0m02:30:08.765482 [debug] [Thread-1 (]: Writing injected SQL for node "model.vg_casestudy.stg_raw_staging__customers"
[0m02:30:08.765866 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.stg_raw_staging__customers (compile): 02:30:08.763962 => 02:30:08.765744
[0m02:30:08.766065 [debug] [Thread-1 (]: Began executing node model.vg_casestudy.stg_raw_staging__customers
[0m02:30:08.768180 [debug] [Thread-1 (]: Writing runtime sql for node "model.vg_casestudy.stg_raw_staging__customers"
[0m02:30:08.768498 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_raw_staging__customers"
[0m02:30:08.768693 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__customers: BEGIN
[0m02:30:08.768875 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:30:08.776187 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:30:08.776591 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_raw_staging__customers"
[0m02:30:08.776897 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__customers: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_raw_staging__customers"} */

  
  create view "casestudy"."staging"."stg_raw_staging__customers__dbt_tmp" as (
    with source as (
    select * from "casestudy"."raw"."customers"
),

renamed as (
    select distinct
        customer_id,
        trim(firstname) as firstname,
        trim(lastname) as lastname,
        Age as age,
        branch_id
    from source
)

select * from renamed
  );

[0m02:30:08.777727 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:30:08.782710 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_raw_staging__customers"
[0m02:30:08.783305 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__customers: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_raw_staging__customers"} */
alter view "casestudy"."staging"."stg_raw_staging__customers" rename to "stg_raw_staging__customers__dbt_backup"
[0m02:30:08.784597 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:30:08.789133 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_raw_staging__customers"
[0m02:30:08.789688 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__customers: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_raw_staging__customers"} */
alter view "casestudy"."staging"."stg_raw_staging__customers__dbt_tmp" rename to "stg_raw_staging__customers"
[0m02:30:08.790974 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:30:08.793021 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__customers: COMMIT
[0m02:30:08.793478 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_raw_staging__customers"
[0m02:30:08.793844 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__customers: COMMIT
[0m02:30:08.796089 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:30:08.799014 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_raw_staging__customers"
[0m02:30:08.799449 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__customers: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_raw_staging__customers"} */
drop view if exists "casestudy"."staging"."stg_raw_staging__customers__dbt_backup" cascade
[0m02:30:08.801330 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:30:08.803242 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.stg_raw_staging__customers (execute): 02:30:08.766202 => 02:30:08.803016
[0m02:30:08.803663 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__customers: Close
[0m02:30:08.818072 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f9c6553f-5fe9-4ba1-91f8-90d6cbeef8c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c7a2fddf150>]}
[0m02:30:08.818470 [info ] [Thread-1 (]: 2 of 11 OK created sql view model staging.stg_raw_staging__customers ........... [[32mOK[0m in 0.05s]
[0m02:30:08.818781 [debug] [Thread-1 (]: Finished running node model.vg_casestudy.stg_raw_staging__customers
[0m02:30:08.819001 [debug] [Thread-1 (]: Began running node model.vg_casestudy.stg_raw_staging__fx_rates
[0m02:30:08.819424 [info ] [Thread-1 (]: 3 of 11 START sql view model staging.stg_raw_staging__fx_rates ................. [RUN]
[0m02:30:08.819786 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.vg_casestudy.stg_raw_staging__customers, now model.vg_casestudy.stg_raw_staging__fx_rates)
[0m02:30:08.819975 [debug] [Thread-1 (]: Began compiling node model.vg_casestudy.stg_raw_staging__fx_rates
[0m02:30:08.824030 [debug] [Thread-1 (]: Writing injected SQL for node "model.vg_casestudy.stg_raw_staging__fx_rates"
[0m02:30:08.824400 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.stg_raw_staging__fx_rates (compile): 02:30:08.820095 => 02:30:08.824284
[0m02:30:08.824582 [debug] [Thread-1 (]: Began executing node model.vg_casestudy.stg_raw_staging__fx_rates
[0m02:30:08.826696 [debug] [Thread-1 (]: Writing runtime sql for node "model.vg_casestudy.stg_raw_staging__fx_rates"
[0m02:30:08.827014 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_raw_staging__fx_rates"
[0m02:30:08.827211 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__fx_rates: BEGIN
[0m02:30:08.827383 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:30:08.834757 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:30:08.834990 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_raw_staging__fx_rates"
[0m02:30:08.835243 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__fx_rates: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_raw_staging__fx_rates"} */

  
  create view "casestudy"."staging"."stg_raw_staging__fx_rates__dbt_tmp" as (
    with source as (
    select * from "casestudy"."raw"."fx_rates"
),

renamed as (
    select
        trim(currency_iso_code) as currency_iso_code,
        
CASE
    WHEN fx_rate IS NULL THEN NULL
    -- If the value is already a valid number
    WHEN TRY_CAST(fx_rate AS DOUBLE) IS NOT NULL 
        THEN TRY_CAST(fx_rate AS DOUBLE)
    -- If contains both dot and comma (German notation)
    WHEN POSITION('.' IN fx_rate) > 0 AND POSITION(',' IN fx_rate) > 0 
        THEN TRY_CAST(REPLACE(REPLACE(TRIM(fx_rate), '.', ''), ',', '.') AS DOUBLE)
    -- If only contains comma, treat as decimal point
    WHEN POSITION(',' IN fx_rate) > 0 
        THEN TRY_CAST(REPLACE(TRIM(fx_rate), ',', '.') AS DOUBLE)
    -- If only contains dots, likely thousands separator
    WHEN POSITION('.' IN fx_rate) > 0 
        THEN TRY_CAST(REPLACE(TRIM(fx_rate), '.', '') AS DOUBLE)
    ELSE NULL
END
 as fx_rate,
        
CASE
    -- First try DD.MM.YYYY format (German format with dots)
    WHEN REGEXP_MATCHES(date, '^\d{1,2}\.\d{1,2}\.\d{4}$') 
        THEN TRY_CAST(STRPTIME(date, '%d.%m.%Y') AS DATE)
        
    -- Then try DD/MM/YYYY format (with slashes)
    WHEN REGEXP_MATCHES(date, '^\d{1,2}/\d{1,2}/\d{4}$')
        AND CAST(SPLIT_PART(date, '/', 1) AS INTEGER) <= 31 
        AND CAST(SPLIT_PART(date, '/', 2) AS INTEGER) <= 12 
        THEN TRY_CAST(STRPTIME(date, '%d/%m/%Y') AS DATE)
        
    -- Try MM/DD/YYYY format (US format with slashes)
    WHEN REGEXP_MATCHES(date, '^\d{1,2}/\d{1,2}/\d{4}$')
        AND CAST(SPLIT_PART(date, '/', 1) AS INTEGER) <= 12 
        THEN TRY_CAST(STRPTIME(date, '%m/%d/%Y') AS DATE)
        
    -- Try YYYY-MM-DD format (ISO format)
    WHEN REGEXP_MATCHES(date, '^\d{4}-\d{1,2}-\d{1,2}$')
        THEN TRY_CAST(STRPTIME(date, '%Y-%m-%d') AS DATE)
        
    -- Try generic date parsing as last resort
    ELSE TRY_CAST(date AS DATE)
END
 as fx_rate_date,
        date as fx_rate_date_raw
    from source
    where currency_iso_code is not null and trim(currency_iso_code) not in  ('(none)', '')
),

final as (
    select
        currency_iso_code,
        fx_rate,
        fx_rate_date,
        -- Flag records with date parsing issues
        CASE WHEN fx_rate_date IS NULL AND fx_rate_date_raw IS NOT NULL
             THEN TRUE ELSE FALSE 
        END as has_date_parsing_error
    from renamed
)

select * from final
  );

[0m02:30:08.836315 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:30:08.838250 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_raw_staging__fx_rates"
[0m02:30:08.838466 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__fx_rates: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_raw_staging__fx_rates"} */
alter view "casestudy"."staging"."stg_raw_staging__fx_rates" rename to "stg_raw_staging__fx_rates__dbt_backup"
[0m02:30:08.838862 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:30:08.840578 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_raw_staging__fx_rates"
[0m02:30:08.840795 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__fx_rates: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_raw_staging__fx_rates"} */
alter view "casestudy"."staging"."stg_raw_staging__fx_rates__dbt_tmp" rename to "stg_raw_staging__fx_rates"
[0m02:30:08.841165 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:30:08.842129 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__fx_rates: COMMIT
[0m02:30:08.842331 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_raw_staging__fx_rates"
[0m02:30:08.842506 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__fx_rates: COMMIT
[0m02:30:08.843979 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:30:08.845307 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_raw_staging__fx_rates"
[0m02:30:08.845506 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__fx_rates: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_raw_staging__fx_rates"} */
drop view if exists "casestudy"."staging"."stg_raw_staging__fx_rates__dbt_backup" cascade
[0m02:30:08.846538 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:30:08.847298 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.stg_raw_staging__fx_rates (execute): 02:30:08.824697 => 02:30:08.847201
[0m02:30:08.847489 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__fx_rates: Close
[0m02:30:08.859000 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f9c6553f-5fe9-4ba1-91f8-90d6cbeef8c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c7a2ba2cc50>]}
[0m02:30:08.859385 [info ] [Thread-1 (]: 3 of 11 OK created sql view model staging.stg_raw_staging__fx_rates ............ [[32mOK[0m in 0.04s]
[0m02:30:08.859687 [debug] [Thread-1 (]: Finished running node model.vg_casestudy.stg_raw_staging__fx_rates
[0m02:30:08.859905 [debug] [Thread-1 (]: Began running node model.vg_casestudy.stg_raw_staging__loans
[0m02:30:08.860334 [info ] [Thread-1 (]: 4 of 11 START sql view model staging.stg_raw_staging__loans .................... [RUN]
[0m02:30:08.860704 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.vg_casestudy.stg_raw_staging__fx_rates, now model.vg_casestudy.stg_raw_staging__loans)
[0m02:30:08.860901 [debug] [Thread-1 (]: Began compiling node model.vg_casestudy.stg_raw_staging__loans
[0m02:30:08.863066 [debug] [Thread-1 (]: Writing injected SQL for node "model.vg_casestudy.stg_raw_staging__loans"
[0m02:30:08.863434 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.stg_raw_staging__loans (compile): 02:30:08.861021 => 02:30:08.863315
[0m02:30:08.863621 [debug] [Thread-1 (]: Began executing node model.vg_casestudy.stg_raw_staging__loans
[0m02:30:08.865780 [debug] [Thread-1 (]: Writing runtime sql for node "model.vg_casestudy.stg_raw_staging__loans"
[0m02:30:08.866085 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_raw_staging__loans"
[0m02:30:08.866286 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__loans: BEGIN
[0m02:30:08.866457 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:30:08.874135 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:30:08.874488 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_raw_staging__loans"
[0m02:30:08.874763 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__loans: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_raw_staging__loans"} */

  
  create view "casestudy"."staging"."stg_raw_staging__loans__dbt_tmp" as (
    with source as (
    select * from "casestudy"."raw"."loans"
),

renamed as (
    select
        customer_id,
        loan_id,
        
CASE
    WHEN loan_amount IS NULL THEN NULL
    -- If the value is already a valid number
    WHEN TRY_CAST(loan_amount AS DOUBLE) IS NOT NULL 
        THEN TRY_CAST(loan_amount AS DOUBLE)
    -- If contains both dot and comma (German notation)
    WHEN POSITION('.' IN loan_amount) > 0 AND POSITION(',' IN loan_amount) > 0 
        THEN TRY_CAST(REPLACE(REPLACE(TRIM(loan_amount), '.', ''), ',', '.') AS DOUBLE)
    -- If only contains comma, treat as decimal point
    WHEN POSITION(',' IN loan_amount) > 0 
        THEN TRY_CAST(REPLACE(TRIM(loan_amount), ',', '.') AS DOUBLE)
    -- If only contains dots, likely thousands separator
    WHEN POSITION('.' IN loan_amount) > 0 
        THEN TRY_CAST(REPLACE(TRIM(loan_amount), '.', '') AS DOUBLE)
    ELSE NULL
END
 as loan_amount,
        loant_type,
        
CASE
    WHEN interest_rate IS NULL THEN NULL
    -- If the value is already a valid number
    WHEN TRY_CAST(interest_rate AS DOUBLE) IS NOT NULL 
        THEN TRY_CAST(interest_rate AS DOUBLE)
    -- If contains both dot and comma (German notation)
    WHEN POSITION('.' IN interest_rate) > 0 AND POSITION(',' IN interest_rate) > 0 
        THEN TRY_CAST(REPLACE(REPLACE(TRIM(interest_rate), '.', ''), ',', '.') AS DOUBLE)
    -- If only contains comma, treat as decimal point
    WHEN POSITION(',' IN interest_rate) > 0 
        THEN TRY_CAST(REPLACE(TRIM(interest_rate), ',', '.') AS DOUBLE)
    -- If only contains dots, likely thousands separator
    WHEN POSITION('.' IN interest_rate) > 0 
        THEN TRY_CAST(REPLACE(TRIM(interest_rate), '.', '') AS DOUBLE)
    ELSE NULL
END
 as interest_rate,
        loan_term,
        
CASE
    -- First try DD.MM.YYYY format (German format with dots)
    WHEN REGEXP_MATCHES(approval_rejection_date, '^\d{1,2}\.\d{1,2}\.\d{4}$') 
        THEN TRY_CAST(STRPTIME(approval_rejection_date, '%d.%m.%Y') AS DATE)
        
    -- Then try DD/MM/YYYY format (with slashes)
    WHEN REGEXP_MATCHES(approval_rejection_date, '^\d{1,2}/\d{1,2}/\d{4}$')
        AND CAST(SPLIT_PART(approval_rejection_date, '/', 1) AS INTEGER) <= 31 
        AND CAST(SPLIT_PART(approval_rejection_date, '/', 2) AS INTEGER) <= 12 
        THEN TRY_CAST(STRPTIME(approval_rejection_date, '%d/%m/%Y') AS DATE)
        
    -- Try MM/DD/YYYY format (US format with slashes)
    WHEN REGEXP_MATCHES(approval_rejection_date, '^\d{1,2}/\d{1,2}/\d{4}$')
        AND CAST(SPLIT_PART(approval_rejection_date, '/', 1) AS INTEGER) <= 12 
        THEN TRY_CAST(STRPTIME(approval_rejection_date, '%m/%d/%Y') AS DATE)
        
    -- Try YYYY-MM-DD format (ISO format)
    WHEN REGEXP_MATCHES(approval_rejection_date, '^\d{4}-\d{1,2}-\d{1,2}$')
        THEN TRY_CAST(STRPTIME(approval_rejection_date, '%Y-%m-%d') AS DATE)
        
    -- Try generic date parsing as last resort
    ELSE TRY_CAST(approval_rejection_date AS DATE)
END
 as approval_rejection_date,
        approval_rejection_date as approval_rejection_date_raw,
        loan_status
    from source
),

final as (
    select
        customer_id,
        loan_id,
        loan_amount,
        loant_type as loan_type,
        interest_rate,
        loan_term,
        approval_rejection_date,
        loan_status,
        -- Flag records with date parsing issues
        CASE WHEN approval_rejection_date IS NULL AND approval_rejection_date_raw IS NOT NULL
             THEN TRUE ELSE FALSE 
        END as has_date_parsing_error
    from renamed
)

select * from final
  );

[0m02:30:08.876293 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:30:08.878280 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_raw_staging__loans"
[0m02:30:08.878492 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__loans: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_raw_staging__loans"} */
alter view "casestudy"."staging"."stg_raw_staging__loans" rename to "stg_raw_staging__loans__dbt_backup"
[0m02:30:08.878871 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:30:08.880462 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_raw_staging__loans"
[0m02:30:08.880671 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__loans: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_raw_staging__loans"} */
alter view "casestudy"."staging"."stg_raw_staging__loans__dbt_tmp" rename to "stg_raw_staging__loans"
[0m02:30:08.881018 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:30:08.881941 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__loans: COMMIT
[0m02:30:08.882148 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_raw_staging__loans"
[0m02:30:08.882327 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__loans: COMMIT
[0m02:30:08.883673 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:30:08.885966 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_raw_staging__loans"
[0m02:30:08.886179 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__loans: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_raw_staging__loans"} */
drop view if exists "casestudy"."staging"."stg_raw_staging__loans__dbt_backup" cascade
[0m02:30:08.887057 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:30:08.887804 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.stg_raw_staging__loans (execute): 02:30:08.863742 => 02:30:08.887697
[0m02:30:08.887994 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__loans: Close
[0m02:30:08.898687 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f9c6553f-5fe9-4ba1-91f8-90d6cbeef8c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c7a2bab8090>]}
[0m02:30:08.899059 [info ] [Thread-1 (]: 4 of 11 OK created sql view model staging.stg_raw_staging__loans ............... [[32mOK[0m in 0.04s]
[0m02:30:08.899370 [debug] [Thread-1 (]: Finished running node model.vg_casestudy.stg_raw_staging__loans
[0m02:30:08.899581 [debug] [Thread-1 (]: Began running node model.vg_casestudy.stg_raw_staging__transactions
[0m02:30:08.899992 [info ] [Thread-1 (]: 5 of 11 START sql view model staging.stg_raw_staging__transactions ............. [RUN]
[0m02:30:08.900359 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.vg_casestudy.stg_raw_staging__loans, now model.vg_casestudy.stg_raw_staging__transactions)
[0m02:30:08.900544 [debug] [Thread-1 (]: Began compiling node model.vg_casestudy.stg_raw_staging__transactions
[0m02:30:08.902589 [debug] [Thread-1 (]: Writing injected SQL for node "model.vg_casestudy.stg_raw_staging__transactions"
[0m02:30:08.902942 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.stg_raw_staging__transactions (compile): 02:30:08.900655 => 02:30:08.902827
[0m02:30:08.903131 [debug] [Thread-1 (]: Began executing node model.vg_casestudy.stg_raw_staging__transactions
[0m02:30:08.905220 [debug] [Thread-1 (]: Writing runtime sql for node "model.vg_casestudy.stg_raw_staging__transactions"
[0m02:30:08.905525 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_raw_staging__transactions"
[0m02:30:08.905711 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__transactions: BEGIN
[0m02:30:08.905876 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:30:08.913138 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:30:08.913429 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_raw_staging__transactions"
[0m02:30:08.913684 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__transactions: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_raw_staging__transactions"} */

  
  create view "casestudy"."staging"."stg_raw_staging__transactions__dbt_tmp" as (
    with source as (
    select * from "casestudy"."raw"."transactions"
),

renamed as (
    select
        transaction_id,
        
CASE
    -- First try DD.MM.YYYY format (German format with dots)
    WHEN REGEXP_MATCHES(transaction_date, '^\d{1,2}\.\d{1,2}\.\d{4}$') 
        THEN TRY_CAST(STRPTIME(transaction_date, '%d.%m.%Y') AS DATE)
        
    -- Then try DD/MM/YYYY format (with slashes)
    WHEN REGEXP_MATCHES(transaction_date, '^\d{1,2}/\d{1,2}/\d{4}$')
        AND CAST(SPLIT_PART(transaction_date, '/', 1) AS INTEGER) <= 31 
        AND CAST(SPLIT_PART(transaction_date, '/', 2) AS INTEGER) <= 12 
        THEN TRY_CAST(STRPTIME(transaction_date, '%d/%m/%Y') AS DATE)
        
    -- Try MM/DD/YYYY format (US format with slashes)
    WHEN REGEXP_MATCHES(transaction_date, '^\d{1,2}/\d{1,2}/\d{4}$')
        AND CAST(SPLIT_PART(transaction_date, '/', 1) AS INTEGER) <= 12 
        THEN TRY_CAST(STRPTIME(transaction_date, '%m/%d/%Y') AS DATE)
        
    -- Try YYYY-MM-DD format (ISO format)
    WHEN REGEXP_MATCHES(transaction_date, '^\d{4}-\d{1,2}-\d{1,2}$')
        THEN TRY_CAST(STRPTIME(transaction_date, '%Y-%m-%d') AS DATE)
        
    -- Try generic date parsing as last resort
    ELSE TRY_CAST(transaction_date AS DATE)
END
 as transaction_date,
        transaction_date as transaction_date_raw,
        account_id,
        trim(transaction_type) as transaction_type,
        
CASE
    WHEN transaction_amount IS NULL THEN NULL
    -- If the value is already a valid number
    WHEN TRY_CAST(transaction_amount AS DOUBLE) IS NOT NULL 
        THEN TRY_CAST(transaction_amount AS DOUBLE)
    -- If contains both dot and comma (German notation)
    WHEN POSITION('.' IN transaction_amount) > 0 AND POSITION(',' IN transaction_amount) > 0 
        THEN TRY_CAST(REPLACE(REPLACE(TRIM(transaction_amount), '.', ''), ',', '.') AS DOUBLE)
    -- If only contains comma, treat as decimal point
    WHEN POSITION(',' IN transaction_amount) > 0 
        THEN TRY_CAST(REPLACE(TRIM(transaction_amount), ',', '.') AS DOUBLE)
    -- If only contains dots, likely thousands separator
    WHEN POSITION('.' IN transaction_amount) > 0 
        THEN TRY_CAST(REPLACE(TRIM(transaction_amount), '.', '') AS DOUBLE)
    ELSE NULL
END
 as transaction_amount,
        trim(transaction_currency) as transaction_currency
    from source
),

final as (
    select
        transaction_id,
        transaction_date,
        account_id,
        transaction_type,
        transaction_amount,
        transaction_currency,
        -- Flag records with date parsing issues
        CASE WHEN transaction_date IS NULL AND transaction_date_raw IS NOT NULL
             THEN TRUE ELSE FALSE 
        END as has_date_parsing_error
    from renamed
)

select * from final
  );

[0m02:30:08.914904 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:30:08.917276 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_raw_staging__transactions"
[0m02:30:08.917484 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__transactions: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_raw_staging__transactions"} */
alter view "casestudy"."staging"."stg_raw_staging__transactions" rename to "stg_raw_staging__transactions__dbt_backup"
[0m02:30:08.917861 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:30:08.919449 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_raw_staging__transactions"
[0m02:30:08.919656 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__transactions: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_raw_staging__transactions"} */
alter view "casestudy"."staging"."stg_raw_staging__transactions__dbt_tmp" rename to "stg_raw_staging__transactions"
[0m02:30:08.920013 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:30:08.920964 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__transactions: COMMIT
[0m02:30:08.921171 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_raw_staging__transactions"
[0m02:30:08.921358 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__transactions: COMMIT
[0m02:30:08.922776 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:30:08.924118 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_raw_staging__transactions"
[0m02:30:08.924323 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__transactions: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_raw_staging__transactions"} */
drop view if exists "casestudy"."staging"."stg_raw_staging__transactions__dbt_backup" cascade
[0m02:30:08.925214 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:30:08.925945 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.stg_raw_staging__transactions (execute): 02:30:08.903260 => 02:30:08.925843
[0m02:30:08.926144 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__transactions: Close
[0m02:30:08.938227 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f9c6553f-5fe9-4ba1-91f8-90d6cbeef8c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c7a2b9dd290>]}
[0m02:30:08.938591 [info ] [Thread-1 (]: 5 of 11 OK created sql view model staging.stg_raw_staging__transactions ........ [[32mOK[0m in 0.04s]
[0m02:30:08.938886 [debug] [Thread-1 (]: Finished running node model.vg_casestudy.stg_raw_staging__transactions
[0m02:30:08.939103 [debug] [Thread-1 (]: Began running node model.vg_casestudy.stg_staging_intermediate__currencies
[0m02:30:08.939513 [info ] [Thread-1 (]: 6 of 11 START sql table model intermediate.stg_staging_intermediate__currencies  [RUN]
[0m02:30:08.939873 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.vg_casestudy.stg_raw_staging__transactions, now model.vg_casestudy.stg_staging_intermediate__currencies)
[0m02:30:08.940065 [debug] [Thread-1 (]: Began compiling node model.vg_casestudy.stg_staging_intermediate__currencies
[0m02:30:08.941733 [debug] [Thread-1 (]: Writing injected SQL for node "model.vg_casestudy.stg_staging_intermediate__currencies"
[0m02:30:08.942076 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.stg_staging_intermediate__currencies (compile): 02:30:08.940193 => 02:30:08.941963
[0m02:30:08.942272 [debug] [Thread-1 (]: Began executing node model.vg_casestudy.stg_staging_intermediate__currencies
[0m02:30:08.953154 [debug] [Thread-1 (]: Writing runtime sql for node "model.vg_casestudy.stg_staging_intermediate__currencies"
[0m02:30:08.953633 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__currencies"
[0m02:30:08.953848 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__currencies: BEGIN
[0m02:30:08.954043 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:30:08.962090 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:30:08.962332 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__currencies"
[0m02:30:08.962534 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__currencies: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_staging_intermediate__currencies"} */

  
    
    

    create  table
      "casestudy"."intermediate"."stg_staging_intermediate__currencies__dbt_tmp"
  
    as (
      with staging as (
    select * from "casestudy"."raw"."currencies"
),
cleaned as (
    select distinct
        trim(currency) as currency,
        trim(currency_iso_code) as currency_iso_code,
    from staging
    where currency_iso_code is not null and trim(currency_iso_code) != '(none)'
)

select * from cleaned
    );
  
  
[0m02:30:08.965311 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:30:08.967198 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__currencies"
[0m02:30:08.967411 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__currencies: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_staging_intermediate__currencies"} */
alter table "casestudy"."intermediate"."stg_staging_intermediate__currencies" rename to "stg_staging_intermediate__currencies__dbt_backup"
[0m02:30:08.967766 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:30:08.970613 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__currencies"
[0m02:30:08.970833 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__currencies: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_staging_intermediate__currencies"} */
alter table "casestudy"."intermediate"."stg_staging_intermediate__currencies__dbt_tmp" rename to "stg_staging_intermediate__currencies"
[0m02:30:08.971170 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:30:08.973977 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__currencies: COMMIT
[0m02:30:08.974202 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__currencies"
[0m02:30:08.974384 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__currencies: COMMIT
[0m02:30:08.975857 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:30:08.977173 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__currencies"
[0m02:30:08.977379 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__currencies: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_staging_intermediate__currencies"} */
drop table if exists "casestudy"."intermediate"."stg_staging_intermediate__currencies__dbt_backup" cascade
[0m02:30:08.978218 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:30:08.978933 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.stg_staging_intermediate__currencies (execute): 02:30:08.942390 => 02:30:08.978829
[0m02:30:08.979121 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__currencies: Close
[0m02:30:08.993108 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f9c6553f-5fe9-4ba1-91f8-90d6cbeef8c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c7a2b771390>]}
[0m02:30:08.993497 [info ] [Thread-1 (]: 6 of 11 OK created sql table model intermediate.stg_staging_intermediate__currencies  [[32mOK[0m in 0.05s]
[0m02:30:08.993799 [debug] [Thread-1 (]: Finished running node model.vg_casestudy.stg_staging_intermediate__currencies
[0m02:30:08.994011 [debug] [Thread-1 (]: Began running node model.vg_casestudy.stg_staging_intermediate__accounts
[0m02:30:08.994329 [info ] [Thread-1 (]: 7 of 11 START sql table model intermediate.stg_staging_intermediate__accounts .. [RUN]
[0m02:30:08.994662 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.vg_casestudy.stg_staging_intermediate__currencies, now model.vg_casestudy.stg_staging_intermediate__accounts)
[0m02:30:08.994846 [debug] [Thread-1 (]: Began compiling node model.vg_casestudy.stg_staging_intermediate__accounts
[0m02:30:08.996492 [debug] [Thread-1 (]: Writing injected SQL for node "model.vg_casestudy.stg_staging_intermediate__accounts"
[0m02:30:08.996830 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.stg_staging_intermediate__accounts (compile): 02:30:08.994962 => 02:30:08.996719
[0m02:30:08.997007 [debug] [Thread-1 (]: Began executing node model.vg_casestudy.stg_staging_intermediate__accounts
[0m02:30:08.999012 [debug] [Thread-1 (]: Writing runtime sql for node "model.vg_casestudy.stg_staging_intermediate__accounts"
[0m02:30:08.999349 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__accounts"
[0m02:30:08.999532 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__accounts: BEGIN
[0m02:30:08.999694 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:30:09.007051 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:30:09.007379 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__accounts"
[0m02:30:09.007593 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__accounts: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_staging_intermediate__accounts"} */

  
    
    

    create  table
      "casestudy"."intermediate"."stg_staging_intermediate__accounts__dbt_tmp"
  
    as (
      with staging as (
    select * from "casestudy"."staging"."stg_raw_staging__accounts"
), 
filtered as (
    select 
        account_id,
        customer_id,
        account_type,
        account_opening_date,
     from staging
    where not has_date_parsing_error
)

select * from filtered
    );
  
  
[0m02:30:09.011880 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:30:09.013896 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__accounts"
[0m02:30:09.014136 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__accounts: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_staging_intermediate__accounts"} */
alter table "casestudy"."intermediate"."stg_staging_intermediate__accounts" rename to "stg_staging_intermediate__accounts__dbt_backup"
[0m02:30:09.014561 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:30:09.016365 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__accounts"
[0m02:30:09.016591 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__accounts: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_staging_intermediate__accounts"} */
alter table "casestudy"."intermediate"."stg_staging_intermediate__accounts__dbt_tmp" rename to "stg_staging_intermediate__accounts"
[0m02:30:09.017065 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:30:09.018113 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__accounts: COMMIT
[0m02:30:09.018344 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__accounts"
[0m02:30:09.018536 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__accounts: COMMIT
[0m02:30:09.020268 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:30:09.021854 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__accounts"
[0m02:30:09.022075 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__accounts: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_staging_intermediate__accounts"} */
drop table if exists "casestudy"."intermediate"."stg_staging_intermediate__accounts__dbt_backup" cascade
[0m02:30:09.023815 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:30:09.024664 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.stg_staging_intermediate__accounts (execute): 02:30:08.997120 => 02:30:09.024559
[0m02:30:09.024875 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__accounts: Close
[0m02:30:09.042577 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f9c6553f-5fe9-4ba1-91f8-90d6cbeef8c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c7a2c488990>]}
[0m02:30:09.043005 [info ] [Thread-1 (]: 7 of 11 OK created sql table model intermediate.stg_staging_intermediate__accounts  [[32mOK[0m in 0.05s]
[0m02:30:09.043353 [debug] [Thread-1 (]: Finished running node model.vg_casestudy.stg_staging_intermediate__accounts
[0m02:30:09.043599 [debug] [Thread-1 (]: Began running node model.vg_casestudy.stg_staging_intermediate__customers
[0m02:30:09.043970 [info ] [Thread-1 (]: 8 of 11 START sql table model intermediate.stg_staging_intermediate__customers . [RUN]
[0m02:30:09.044407 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.vg_casestudy.stg_staging_intermediate__accounts, now model.vg_casestudy.stg_staging_intermediate__customers)
[0m02:30:09.044653 [debug] [Thread-1 (]: Began compiling node model.vg_casestudy.stg_staging_intermediate__customers
[0m02:30:09.046401 [debug] [Thread-1 (]: Writing injected SQL for node "model.vg_casestudy.stg_staging_intermediate__customers"
[0m02:30:09.046750 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.stg_staging_intermediate__customers (compile): 02:30:09.044782 => 02:30:09.046634
[0m02:30:09.046930 [debug] [Thread-1 (]: Began executing node model.vg_casestudy.stg_staging_intermediate__customers
[0m02:30:09.049052 [debug] [Thread-1 (]: Writing runtime sql for node "model.vg_casestudy.stg_staging_intermediate__customers"
[0m02:30:09.049364 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__customers"
[0m02:30:09.049551 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__customers: BEGIN
[0m02:30:09.049713 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:30:09.056627 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:30:09.056853 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__customers"
[0m02:30:09.057031 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__customers: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_staging_intermediate__customers"} */

  
    
    

    create  table
      "casestudy"."intermediate"."stg_staging_intermediate__customers__dbt_tmp"
  
    as (
      with staging as (
    select * from "casestudy"."staging"."stg_raw_staging__customers"
)

select * from staging
    );
  
  
[0m02:30:09.062968 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:30:09.065941 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__customers"
[0m02:30:09.066178 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__customers: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_staging_intermediate__customers"} */
alter table "casestudy"."intermediate"."stg_staging_intermediate__customers" rename to "stg_staging_intermediate__customers__dbt_backup"
[0m02:30:09.066553 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:30:09.068116 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__customers"
[0m02:30:09.068342 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__customers: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_staging_intermediate__customers"} */
alter table "casestudy"."intermediate"."stg_staging_intermediate__customers__dbt_tmp" rename to "stg_staging_intermediate__customers"
[0m02:30:09.068669 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:30:09.069627 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__customers: COMMIT
[0m02:30:09.069829 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__customers"
[0m02:30:09.070002 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__customers: COMMIT
[0m02:30:09.072052 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:30:09.073397 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__customers"
[0m02:30:09.073649 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__customers: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_staging_intermediate__customers"} */
drop table if exists "casestudy"."intermediate"."stg_staging_intermediate__customers__dbt_backup" cascade
[0m02:30:09.074810 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:30:09.075579 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.stg_staging_intermediate__customers (execute): 02:30:09.047046 => 02:30:09.075475
[0m02:30:09.075779 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__customers: Close
[0m02:30:09.094529 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f9c6553f-5fe9-4ba1-91f8-90d6cbeef8c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c7a2b792f10>]}
[0m02:30:09.094950 [info ] [Thread-1 (]: 8 of 11 OK created sql table model intermediate.stg_staging_intermediate__customers  [[32mOK[0m in 0.05s]
[0m02:30:09.095274 [debug] [Thread-1 (]: Finished running node model.vg_casestudy.stg_staging_intermediate__customers
[0m02:30:09.095501 [debug] [Thread-1 (]: Began running node model.vg_casestudy.stg_staging_intermediate__fx_rates
[0m02:30:09.095845 [info ] [Thread-1 (]: 9 of 11 START sql table model intermediate.stg_staging_intermediate__fx_rates .. [RUN]
[0m02:30:09.096195 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.vg_casestudy.stg_staging_intermediate__customers, now model.vg_casestudy.stg_staging_intermediate__fx_rates)
[0m02:30:09.096383 [debug] [Thread-1 (]: Began compiling node model.vg_casestudy.stg_staging_intermediate__fx_rates
[0m02:30:09.098046 [debug] [Thread-1 (]: Writing injected SQL for node "model.vg_casestudy.stg_staging_intermediate__fx_rates"
[0m02:30:09.098400 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.stg_staging_intermediate__fx_rates (compile): 02:30:09.096497 => 02:30:09.098283
[0m02:30:09.098579 [debug] [Thread-1 (]: Began executing node model.vg_casestudy.stg_staging_intermediate__fx_rates
[0m02:30:09.100533 [debug] [Thread-1 (]: Writing runtime sql for node "model.vg_casestudy.stg_staging_intermediate__fx_rates"
[0m02:30:09.100826 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__fx_rates"
[0m02:30:09.101013 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__fx_rates: BEGIN
[0m02:30:09.101187 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:30:09.108494 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:30:09.108881 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__fx_rates"
[0m02:30:09.109079 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__fx_rates: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_staging_intermediate__fx_rates"} */

  
    
    

    create  table
      "casestudy"."intermediate"."stg_staging_intermediate__fx_rates__dbt_tmp"
  
    as (
      with staging as (
    select * from "casestudy"."staging"."stg_raw_staging__fx_rates"
),

filtered as (
    select
        currency_iso_code,
        fx_rate,
        fx_rate_date
    from staging
    where not has_date_parsing_error
)

select * from filtered
    );
  
  
[0m02:30:09.111575 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:30:09.113473 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__fx_rates"
[0m02:30:09.113679 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__fx_rates: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_staging_intermediate__fx_rates"} */
alter table "casestudy"."intermediate"."stg_staging_intermediate__fx_rates" rename to "stg_staging_intermediate__fx_rates__dbt_backup"
[0m02:30:09.114084 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:30:09.115657 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__fx_rates"
[0m02:30:09.115862 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__fx_rates: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_staging_intermediate__fx_rates"} */
alter table "casestudy"."intermediate"."stg_staging_intermediate__fx_rates__dbt_tmp" rename to "stg_staging_intermediate__fx_rates"
[0m02:30:09.116197 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:30:09.117159 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__fx_rates: COMMIT
[0m02:30:09.117355 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__fx_rates"
[0m02:30:09.117521 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__fx_rates: COMMIT
[0m02:30:09.118828 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:30:09.120152 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__fx_rates"
[0m02:30:09.120342 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__fx_rates: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_staging_intermediate__fx_rates"} */
drop table if exists "casestudy"."intermediate"."stg_staging_intermediate__fx_rates__dbt_backup" cascade
[0m02:30:09.121770 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:30:09.122571 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.stg_staging_intermediate__fx_rates (execute): 02:30:09.098692 => 02:30:09.122459
[0m02:30:09.122773 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__fx_rates: Close
[0m02:30:09.135950 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f9c6553f-5fe9-4ba1-91f8-90d6cbeef8c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c7a2b7b44d0>]}
[0m02:30:09.136737 [info ] [Thread-1 (]: 9 of 11 OK created sql table model intermediate.stg_staging_intermediate__fx_rates  [[32mOK[0m in 0.04s]
[0m02:30:09.137371 [debug] [Thread-1 (]: Finished running node model.vg_casestudy.stg_staging_intermediate__fx_rates
[0m02:30:09.137758 [debug] [Thread-1 (]: Began running node model.vg_casestudy.stg_staging_intermediate__loans
[0m02:30:09.138298 [info ] [Thread-1 (]: 10 of 11 START sql table model intermediate.stg_staging_intermediate__loans .... [RUN]
[0m02:30:09.138904 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.vg_casestudy.stg_staging_intermediate__fx_rates, now model.vg_casestudy.stg_staging_intermediate__loans)
[0m02:30:09.139096 [debug] [Thread-1 (]: Began compiling node model.vg_casestudy.stg_staging_intermediate__loans
[0m02:30:09.140849 [debug] [Thread-1 (]: Writing injected SQL for node "model.vg_casestudy.stg_staging_intermediate__loans"
[0m02:30:09.141199 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.stg_staging_intermediate__loans (compile): 02:30:09.139224 => 02:30:09.141079
[0m02:30:09.141380 [debug] [Thread-1 (]: Began executing node model.vg_casestudy.stg_staging_intermediate__loans
[0m02:30:09.144490 [debug] [Thread-1 (]: Writing runtime sql for node "model.vg_casestudy.stg_staging_intermediate__loans"
[0m02:30:09.144790 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__loans"
[0m02:30:09.144972 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__loans: BEGIN
[0m02:30:09.145148 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:30:09.152491 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:30:09.152811 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__loans"
[0m02:30:09.153006 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__loans: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_staging_intermediate__loans"} */

  
    
    

    create  table
      "casestudy"."intermediate"."stg_staging_intermediate__loans__dbt_tmp"
  
    as (
      with staging as (
    select * from "casestudy"."staging"."stg_raw_staging__loans"
),

filtered as (
    select
        customer_id,
        loan_id,
        loan_amount,
        loan_type,
        interest_rate,
        loan_term,
        approval_rejection_date,
        loan_status
    from staging
    where not has_date_parsing_error
)

select * from filtered
    );
  
  
[0m02:30:09.162375 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:30:09.164274 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__loans"
[0m02:30:09.164494 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__loans: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_staging_intermediate__loans"} */
alter table "casestudy"."intermediate"."stg_staging_intermediate__loans" rename to "stg_staging_intermediate__loans__dbt_backup"
[0m02:30:09.164851 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:30:09.166449 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__loans"
[0m02:30:09.166653 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__loans: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_staging_intermediate__loans"} */
alter table "casestudy"."intermediate"."stg_staging_intermediate__loans__dbt_tmp" rename to "stg_staging_intermediate__loans"
[0m02:30:09.166981 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:30:09.167918 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__loans: COMMIT
[0m02:30:09.168115 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__loans"
[0m02:30:09.168291 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__loans: COMMIT
[0m02:30:09.170180 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:30:09.171556 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__loans"
[0m02:30:09.171759 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__loans: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_staging_intermediate__loans"} */
drop table if exists "casestudy"."intermediate"."stg_staging_intermediate__loans__dbt_backup" cascade
[0m02:30:09.172736 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:30:09.173455 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.stg_staging_intermediate__loans (execute): 02:30:09.141495 => 02:30:09.173357
[0m02:30:09.173646 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__loans: Close
[0m02:30:09.187746 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f9c6553f-5fe9-4ba1-91f8-90d6cbeef8c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c7a2baab5d0>]}
[0m02:30:09.188138 [info ] [Thread-1 (]: 10 of 11 OK created sql table model intermediate.stg_staging_intermediate__loans  [[32mOK[0m in 0.05s]
[0m02:30:09.188455 [debug] [Thread-1 (]: Finished running node model.vg_casestudy.stg_staging_intermediate__loans
[0m02:30:09.188682 [debug] [Thread-1 (]: Began running node model.vg_casestudy.stg_staging_intermediate__transactions
[0m02:30:09.189003 [info ] [Thread-1 (]: 11 of 11 START sql table model intermediate.stg_staging_intermediate__transactions  [RUN]
[0m02:30:09.189371 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.vg_casestudy.stg_staging_intermediate__loans, now model.vg_casestudy.stg_staging_intermediate__transactions)
[0m02:30:09.189586 [debug] [Thread-1 (]: Began compiling node model.vg_casestudy.stg_staging_intermediate__transactions
[0m02:30:09.191298 [debug] [Thread-1 (]: Writing injected SQL for node "model.vg_casestudy.stg_staging_intermediate__transactions"
[0m02:30:09.191657 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.stg_staging_intermediate__transactions (compile): 02:30:09.189709 => 02:30:09.191535
[0m02:30:09.191850 [debug] [Thread-1 (]: Began executing node model.vg_casestudy.stg_staging_intermediate__transactions
[0m02:30:09.193835 [debug] [Thread-1 (]: Writing runtime sql for node "model.vg_casestudy.stg_staging_intermediate__transactions"
[0m02:30:09.194149 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__transactions"
[0m02:30:09.194348 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__transactions: BEGIN
[0m02:30:09.194519 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:30:09.203816 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:30:09.204288 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__transactions"
[0m02:30:09.204635 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__transactions: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_staging_intermediate__transactions"} */

  
    
    

    create  table
      "casestudy"."intermediate"."stg_staging_intermediate__transactions__dbt_tmp"
  
    as (
      with staging as (
    select * from "casestudy"."staging"."stg_raw_staging__transactions"
),

filtered as (
    select
        transaction_id,
        transaction_date,
        account_id,
        transaction_type,
        transaction_amount,
        transaction_currency
    from staging
    where not has_date_parsing_error
)

select * from filtered
    );
  
  
[0m02:30:09.242877 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:30:09.244876 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__transactions"
[0m02:30:09.245095 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__transactions: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_staging_intermediate__transactions"} */
alter table "casestudy"."intermediate"."stg_staging_intermediate__transactions" rename to "stg_staging_intermediate__transactions__dbt_backup"
[0m02:30:09.245513 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:30:09.247404 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__transactions"
[0m02:30:09.247630 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__transactions: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_staging_intermediate__transactions"} */
alter table "casestudy"."intermediate"."stg_staging_intermediate__transactions__dbt_tmp" rename to "stg_staging_intermediate__transactions"
[0m02:30:09.247996 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:30:09.248983 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__transactions: COMMIT
[0m02:30:09.249184 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__transactions"
[0m02:30:09.249359 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__transactions: COMMIT
[0m02:30:09.254721 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:30:09.256140 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__transactions"
[0m02:30:09.256341 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__transactions: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_staging_intermediate__transactions"} */
drop table if exists "casestudy"."intermediate"."stg_staging_intermediate__transactions__dbt_backup" cascade
[0m02:30:09.257285 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:30:09.258017 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.stg_staging_intermediate__transactions (execute): 02:30:09.191970 => 02:30:09.257918
[0m02:30:09.258220 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__transactions: Close
[0m02:30:09.281836 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f9c6553f-5fe9-4ba1-91f8-90d6cbeef8c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c7a2b74ab90>]}
[0m02:30:09.282586 [info ] [Thread-1 (]: 11 of 11 OK created sql table model intermediate.stg_staging_intermediate__transactions  [[32mOK[0m in 0.09s]
[0m02:30:09.283239 [debug] [Thread-1 (]: Finished running node model.vg_casestudy.stg_staging_intermediate__transactions
[0m02:30:09.284567 [debug] [MainThread]: Using duckdb connection "master"
[0m02:30:09.284758 [debug] [MainThread]: On master: BEGIN
[0m02:30:09.284908 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:30:09.292955 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m02:30:09.293191 [debug] [MainThread]: On master: COMMIT
[0m02:30:09.293345 [debug] [MainThread]: Using duckdb connection "master"
[0m02:30:09.293490 [debug] [MainThread]: On master: COMMIT
[0m02:30:09.293745 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m02:30:09.293909 [debug] [MainThread]: On master: Close
[0m02:30:09.297083 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:30:09.297526 [debug] [MainThread]: Connection 'list_casestudy_staging' was properly closed.
[0m02:30:09.297865 [debug] [MainThread]: Connection 'model.vg_casestudy.stg_staging_intermediate__transactions' was properly closed.
[0m02:30:09.298338 [info ] [MainThread]: 
[0m02:30:09.298726 [info ] [MainThread]: Finished running 5 view models, 6 table models in 0 hours 0 minutes and 0.80 seconds (0.80s).
[0m02:30:09.300402 [debug] [MainThread]: Command end result
[0m02:30:09.311205 [info ] [MainThread]: 
[0m02:30:09.311491 [info ] [MainThread]: [32mCompleted successfully[0m
[0m02:30:09.311656 [info ] [MainThread]: 
[0m02:30:09.311816 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=0 SKIP=0 TOTAL=11
[0m02:30:09.312064 [debug] [MainThread]: Command `dbt run` succeeded at 02:30:09.312006 after 0.95 seconds
[0m02:30:09.312269 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c7a30198d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c7a30303790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c7a3471da50>]}
[0m02:30:09.312457 [debug] [MainThread]: Flushing usage events
[0m02:30:23.684205 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x759a30087590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x759a2fceebd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x759a3256bfd0>]}


============================== 02:30:23.685778 | 679749e6-b802-4fdc-a30c-c04bccfe50f3 ==============================
[0m02:30:23.685778 [info ] [MainThread]: Running with dbt=1.6.18
[0m02:30:23.686062 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/workspaces/varengold_data_analyst_case/transformation', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/workspaces/varengold_data_analyst_case/transformation/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run-operation explore_schemas', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m02:30:23.740984 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '679749e6-b802-4fdc-a30c-c04bccfe50f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x759a2bb76910>]}
[0m02:30:23.748938 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '679749e6-b802-4fdc-a30c-c04bccfe50f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x759a30070f50>]}
[0m02:30:23.749391 [info ] [MainThread]: Registered adapter: duckdb=1.6.2
[0m02:30:23.762428 [debug] [MainThread]: checksum: 7b9fab86a08e9e96a48a825af743c566d95b877e068b8c6d0dbafbf714447189, vars: {}, profile: , target: , version: 1.6.18
[0m02:30:23.786227 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m02:30:23.786514 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m02:30:23.787255 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.vg_casestudy.reporting
- models.vg_casestudy.main
- models.vg_casestudy.marts
[0m02:30:23.792640 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '679749e6-b802-4fdc-a30c-c04bccfe50f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x759a2b95b610>]}
[0m02:30:23.808060 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '679749e6-b802-4fdc-a30c-c04bccfe50f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x759a2b9ab410>]}
[0m02:30:23.808409 [info ] [MainThread]: Found 11 models, 1 analysis, 2 seeds, 71 tests, 5 sources, 0 exposures, 0 metrics, 632 macros, 0 groups, 0 semantic models
[0m02:30:23.808606 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '679749e6-b802-4fdc-a30c-c04bccfe50f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x759a2fab9e50>]}
[0m02:30:23.809024 [debug] [MainThread]: Acquiring new duckdb connection 'macro_explore_schemas'
[0m02:30:23.809209 [debug] [MainThread]: Using duckdb connection "macro_explore_schemas"
[0m02:30:23.809352 [debug] [MainThread]: On macro_explore_schemas: BEGIN
[0m02:30:23.809486 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:30:23.818462 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m02:30:23.818757 [debug] [MainThread]: On macro_explore_schemas: COMMIT
[0m02:30:23.818921 [debug] [MainThread]: Using duckdb connection "macro_explore_schemas"
[0m02:30:23.819069 [debug] [MainThread]: On macro_explore_schemas: COMMIT
[0m02:30:23.819322 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m02:30:23.825150 [debug] [MainThread]: Using duckdb connection "macro_explore_schemas"
[0m02:30:23.825357 [debug] [MainThread]: On macro_explore_schemas: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "macro_explore_schemas"} */

    
        SELECT schema_name FROM information_schema.schemata
    
  
[0m02:30:23.826010 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m02:30:23.826822 [debug] [MainThread]: On macro_explore_schemas: Close
[0m02:30:23.829431 [debug] [MainThread]: Command `dbt run-operation` succeeded at 02:30:23.829352 after 0.15 seconds
[0m02:30:23.829620 [debug] [MainThread]: Connection 'macro_explore_schemas' was properly closed.
[0m02:30:23.829802 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x759a2b9aa410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x759a2b9a8e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x759a2b9a8550>]}
[0m02:30:23.830016 [debug] [MainThread]: Flushing usage events
[0m02:32:03.645803 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e9cad73d610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e9cad8f8850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e9cadd27f50>]}


============================== 02:32:03.649166 | 5f0c7093-2535-4b97-bc14-eac63ff1fdfe ==============================
[0m02:32:03.649166 [info ] [MainThread]: Running with dbt=1.6.18
[0m02:32:03.649531 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/workspaces/varengold_data_analyst_case/transformation', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/workspaces/varengold_data_analyst_case/transformation/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run-operation explore_schemas', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m02:32:03.701725 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5f0c7093-2535-4b97-bc14-eac63ff1fdfe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e9cad750d10>]}
[0m02:32:03.709527 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5f0c7093-2535-4b97-bc14-eac63ff1fdfe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e9cadd56850>]}
[0m02:32:03.709906 [info ] [MainThread]: Registered adapter: duckdb=1.6.2
[0m02:32:03.722599 [debug] [MainThread]: checksum: 7b9fab86a08e9e96a48a825af743c566d95b877e068b8c6d0dbafbf714447189, vars: {}, profile: , target: , version: 1.6.18
[0m02:32:03.744484 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m02:32:03.744787 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m02:32:03.745694 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.vg_casestudy.main
- models.vg_casestudy.reporting
- models.vg_casestudy.marts
[0m02:32:03.749680 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5f0c7093-2535-4b97-bc14-eac63ff1fdfe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e9ca96ac390>]}
[0m02:32:03.762663 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5f0c7093-2535-4b97-bc14-eac63ff1fdfe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e9cad78fa10>]}
[0m02:32:03.763018 [info ] [MainThread]: Found 11 models, 1 analysis, 2 seeds, 71 tests, 5 sources, 0 exposures, 0 metrics, 632 macros, 0 groups, 0 semantic models
[0m02:32:03.763229 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5f0c7093-2535-4b97-bc14-eac63ff1fdfe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e9cadd24490>]}
[0m02:32:03.763658 [debug] [MainThread]: Acquiring new duckdb connection 'macro_explore_schemas'
[0m02:32:03.763837 [debug] [MainThread]: Using duckdb connection "macro_explore_schemas"
[0m02:32:03.763986 [debug] [MainThread]: On macro_explore_schemas: BEGIN
[0m02:32:03.764129 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:32:03.773162 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m02:32:03.773429 [debug] [MainThread]: On macro_explore_schemas: COMMIT
[0m02:32:03.773594 [debug] [MainThread]: Using duckdb connection "macro_explore_schemas"
[0m02:32:03.773742 [debug] [MainThread]: On macro_explore_schemas: COMMIT
[0m02:32:03.773985 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m02:32:03.779948 [debug] [MainThread]: Using duckdb connection "macro_explore_schemas"
[0m02:32:03.780202 [debug] [MainThread]: On macro_explore_schemas: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "macro_explore_schemas"} */

    
        SELECT schema_name FROM information_schema.schemata
    
  
[0m02:32:03.781210 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m02:32:03.782183 [debug] [MainThread]: On macro_explore_schemas: Close
[0m02:32:03.785296 [debug] [MainThread]: Command `dbt run-operation` succeeded at 02:32:03.785217 after 0.14 seconds
[0m02:32:03.785497 [debug] [MainThread]: Connection 'macro_explore_schemas' was properly closed.
[0m02:32:03.785678 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e9cae31db50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e9cad75fdd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e9caa09fbd0>]}
[0m02:32:03.785883 [debug] [MainThread]: Flushing usage events
[0m14:30:25.349156 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6eb1262850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6eb16cbf50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6eb1268410>]}


============================== 14:30:25.389227 | 10c491be-18e4-4a12-8795-1b3096a1cf7b ==============================
[0m14:30:25.389227 [info ] [MainThread]: Running with dbt=1.6.18
[0m14:30:25.399448 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/workspaces/vg_case_study_tim/transformation', 'log_path': '/workspaces/vg_case_study_tim/transformation/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt deps', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:30:25.706483 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '10c491be-18e4-4a12-8795-1b3096a1cf7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6eb1457510>]}
[0m14:30:25.710772 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-kslpa1n4'
[0m14:30:25.712165 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:30:25.890014 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:30:25.893902 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/codegen.json
[0m14:30:25.960719 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/codegen.json 200
[0m14:30:25.972383 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:30:26.077431 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:30:26.097437 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/godatadriven/dbt_date.json
[0m14:30:26.174948 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/godatadriven/dbt_date.json 200
[0m14:30:26.235557 [info ] [MainThread]: Installing dbt-labs/codegen
[0m14:30:26.517623 [info ] [MainThread]: Installed from version 0.13.1
[0m14:30:26.519153 [info ] [MainThread]: Up to date!
[0m14:30:26.520481 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '10c491be-18e4-4a12-8795-1b3096a1cf7b', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6eb15c7c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6eb1245d50>]}
[0m14:30:26.521702 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:30:26.955998 [info ] [MainThread]: Installed from version 1.3.0
[0m14:30:26.957086 [info ] [MainThread]: Up to date!
[0m14:30:26.958355 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '10c491be-18e4-4a12-8795-1b3096a1cf7b', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6eb33b6390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6eb15c7810>]}
[0m14:30:26.960848 [info ] [MainThread]: Installing godatadriven/dbt_date
[0m14:30:27.234634 [info ] [MainThread]: Installed from version 0.11.0
[0m14:30:27.235785 [info ] [MainThread]: Updated version available: 0.14.2
[0m14:30:27.236833 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '10c491be-18e4-4a12-8795-1b3096a1cf7b', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6eb1b17010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6eb0e28490>]}
[0m14:30:27.238098 [info ] [MainThread]: 
[0m14:30:27.239165 [info ] [MainThread]: Updates available for packages: ['godatadriven/dbt_date']                 
Update your versions in packages.yml, then run dbt deps
[0m14:30:27.241311 [debug] [MainThread]: Command `dbt deps` succeeded at 14:30:27.241037 after 1.96 seconds
[0m14:30:27.243549 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6eb5ad8e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6eb1b17310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6eb15b0410>]}
[0m14:30:27.246455 [debug] [MainThread]: Flushing usage events
[0m14:30:40.159773 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5723feafd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5723ffc410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f572404fbd0>]}


============================== 14:30:40.167020 | c40f80b7-3706-4ae1-bc2c-bbc76e981492 ==============================
[0m14:30:40.167020 [info ] [MainThread]: Running with dbt=1.6.18
[0m14:30:40.169108 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/workspaces/vg_case_study_tim/transformation/logs', 'version_check': 'True', 'profiles_dir': '/workspaces/vg_case_study_tim/transformation', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt debug', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:30:40.170674 [info ] [MainThread]: dbt version: 1.6.18
[0m14:30:40.172282 [info ] [MainThread]: python version: 3.11.6
[0m14:30:40.173814 [info ] [MainThread]: python path: /usr/local/bin/python
[0m14:30:40.175052 [info ] [MainThread]: os info: Linux-5.15.153.1-microsoft-standard-WSL2-x86_64-with-glibc2.31
[0m14:30:40.416650 [info ] [MainThread]: Using profiles dir at /workspaces/vg_case_study_tim/transformation
[0m14:30:40.418280 [info ] [MainThread]: Using profiles.yml file at /workspaces/vg_case_study_tim/transformation/profiles.yml
[0m14:30:40.419488 [info ] [MainThread]: Using dbt_project.yml file at /workspaces/vg_case_study_tim/transformation/dbt_project.yml
[0m14:30:40.421121 [info ] [MainThread]: adapter type: duckdb
[0m14:30:40.422123 [info ] [MainThread]: adapter version: 1.6.2
[0m14:30:40.545626 [info ] [MainThread]: Configuration:
[0m14:30:40.547961 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m14:30:40.549916 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m14:30:40.551939 [info ] [MainThread]: Required dependencies:
[0m14:30:40.558441 [debug] [MainThread]: Executing "git --help"
[0m14:30:40.566177 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m14:30:40.571903 [debug] [MainThread]: STDERR: "b''"
[0m14:30:40.573844 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m14:30:40.575284 [info ] [MainThread]: Connection:
[0m14:30:40.577207 [info ] [MainThread]:   database: casestudy
[0m14:30:40.578643 [info ] [MainThread]:   schema: main
[0m14:30:40.580031 [info ] [MainThread]:   path: casestudy.duckdb
[0m14:30:40.581359 [info ] [MainThread]:   config_options: None
[0m14:30:40.582685 [info ] [MainThread]:   extensions: ['icu']
[0m14:30:40.584389 [info ] [MainThread]:   settings: None
[0m14:30:40.594500 [info ] [MainThread]:   external_root: .
[0m14:30:40.596138 [info ] [MainThread]:   use_credential_provider: None
[0m14:30:40.597786 [info ] [MainThread]:   attach: None
[0m14:30:40.599171 [info ] [MainThread]:   filesystems: None
[0m14:30:40.600378 [info ] [MainThread]:   remote: None
[0m14:30:40.601695 [info ] [MainThread]:   plugins: None
[0m14:30:40.603234 [info ] [MainThread]:   disable_transactions: False
[0m14:30:40.616081 [info ] [MainThread]: Registered adapter: duckdb=1.6.2
[0m14:30:40.618707 [debug] [MainThread]: Acquiring new duckdb connection 'debug'
[0m14:30:40.620347 [debug] [MainThread]: Using duckdb connection "debug"
[0m14:30:40.621896 [debug] [MainThread]: On debug: select 1 as id
[0m14:30:40.623322 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:30:44.898579 [debug] [MainThread]: SQL status: OK in 4.0 seconds
[0m14:30:44.902311 [debug] [MainThread]: On debug: Close
[0m14:30:44.909643 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m14:30:44.911959 [info ] [MainThread]: [32mAll checks passed![0m
[0m14:30:44.914279 [debug] [MainThread]: Command `dbt debug` succeeded at 14:30:44.913715 after 4.78 seconds
[0m14:30:44.915616 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m14:30:44.917062 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5724533590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5723da78d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f57245ba2d0>]}
[0m14:30:44.918525 [debug] [MainThread]: Flushing usage events
[0m14:49:18.981596 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe4e1167d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe4e130c6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe4e0df6050>]}


============================== 14:49:18.987981 | 93be8bfe-df18-4822-892d-5fa1eef69cac ==============================
[0m14:49:18.987981 [info ] [MainThread]: Running with dbt=1.6.18
[0m14:49:18.988624 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/workspaces/vg_case_study_tim/transformation/logs', 'debug': 'False', 'profiles_dir': '/workspaces/vg_case_study_tim/transformation', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt docs generate', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:49:19.151766 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '93be8bfe-df18-4822-892d-5fa1eef69cac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe4dd48e550>]}
[0m14:49:19.166716 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '93be8bfe-df18-4822-892d-5fa1eef69cac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe4e0e171d0>]}
[0m14:49:19.167919 [info ] [MainThread]: Registered adapter: duckdb=1.6.2
[0m14:49:19.194569 [debug] [MainThread]: checksum: 7b9fab86a08e9e96a48a825af743c566d95b877e068b8c6d0dbafbf714447189, vars: {}, profile: , target: , version: 1.6.18
[0m14:49:19.258703 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:49:19.259150 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:49:19.260346 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.vg_casestudy.reporting
- models.vg_casestudy.marts
- models.vg_casestudy.main
[0m14:49:19.267822 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '93be8bfe-df18-4822-892d-5fa1eef69cac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe4e0e46b10>]}
[0m14:49:19.278567 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '93be8bfe-df18-4822-892d-5fa1eef69cac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe4dca569d0>]}
[0m14:49:19.279114 [info ] [MainThread]: Found 11 models, 1 analysis, 2 seeds, 71 tests, 5 sources, 0 exposures, 0 metrics, 632 macros, 0 groups, 0 semantic models
[0m14:49:19.279523 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '93be8bfe-df18-4822-892d-5fa1eef69cac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe4e0ea2d50>]}
[0m14:49:19.284499 [info ] [MainThread]: 
[0m14:49:19.285426 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:49:19.287035 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_casestudy_intermediate'
[0m14:49:19.297966 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_intermediate"
[0m14:49:19.298446 [debug] [ThreadPool]: On list_casestudy_intermediate: BEGIN
[0m14:49:19.298741 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:49:19.388166 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:49:19.388593 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_intermediate"
[0m14:49:19.388894 [debug] [ThreadPool]: On list_casestudy_intermediate: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_intermediate"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'intermediate'
    and table_catalog = 'casestudy'
  
[0m14:49:19.406079 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:49:19.407533 [debug] [ThreadPool]: On list_casestudy_intermediate: ROLLBACK
[0m14:49:19.409034 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_intermediate'
[0m14:49:19.409348 [debug] [ThreadPool]: On list_casestudy_intermediate: Close
[0m14:49:19.413645 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy_intermediate, now list_casestudy_raw)
[0m14:49:19.416006 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_raw"
[0m14:49:19.416353 [debug] [ThreadPool]: On list_casestudy_raw: BEGIN
[0m14:49:19.416683 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:49:19.428110 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:49:19.428676 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_raw"
[0m14:49:19.429026 [debug] [ThreadPool]: On list_casestudy_raw: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_raw"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'raw'
    and table_catalog = 'casestudy'
  
[0m14:49:19.439607 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:49:19.441047 [debug] [ThreadPool]: On list_casestudy_raw: ROLLBACK
[0m14:49:19.441535 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_raw'
[0m14:49:19.441814 [debug] [ThreadPool]: On list_casestudy_raw: Close
[0m14:49:19.444899 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy_raw, now list_casestudy_staging)
[0m14:49:19.447156 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_staging"
[0m14:49:19.447506 [debug] [ThreadPool]: On list_casestudy_staging: BEGIN
[0m14:49:19.447803 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:49:19.458114 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:49:19.458590 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_staging"
[0m14:49:19.458890 [debug] [ThreadPool]: On list_casestudy_staging: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_staging"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'staging'
    and table_catalog = 'casestudy'
  
[0m14:49:19.467676 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:49:19.468952 [debug] [ThreadPool]: On list_casestudy_staging: ROLLBACK
[0m14:49:19.469388 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_staging'
[0m14:49:19.469668 [debug] [ThreadPool]: On list_casestudy_staging: Close
[0m14:49:19.473397 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '93be8bfe-df18-4822-892d-5fa1eef69cac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe4e0ea2d50>]}
[0m14:49:19.474291 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:49:19.474744 [info ] [MainThread]: 
[0m14:49:19.485781 [debug] [Thread-1 (]: Began running node model.vg_casestudy.stg_raw_staging__accounts
[0m14:49:19.487020 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_casestudy_staging, now model.vg_casestudy.stg_raw_staging__accounts)
[0m14:49:19.487451 [debug] [Thread-1 (]: Began compiling node model.vg_casestudy.stg_raw_staging__accounts
[0m14:49:19.497819 [debug] [Thread-1 (]: Writing injected SQL for node "model.vg_casestudy.stg_raw_staging__accounts"
[0m14:49:19.498786 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.stg_raw_staging__accounts (compile): 14:49:19.487685 => 14:49:19.498560
[0m14:49:19.499159 [debug] [Thread-1 (]: Began executing node model.vg_casestudy.stg_raw_staging__accounts
[0m14:49:19.499575 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.stg_raw_staging__accounts (execute): 14:49:19.499410 => 14:49:19.499425
[0m14:49:19.500397 [debug] [Thread-1 (]: Finished running node model.vg_casestudy.stg_raw_staging__accounts
[0m14:49:19.500828 [debug] [Thread-1 (]: Began running node model.vg_casestudy.stg_raw_staging__customers
[0m14:49:19.501796 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.vg_casestudy.stg_raw_staging__accounts, now model.vg_casestudy.stg_raw_staging__customers)
[0m14:49:19.502175 [debug] [Thread-1 (]: Began compiling node model.vg_casestudy.stg_raw_staging__customers
[0m14:49:19.505278 [debug] [Thread-1 (]: Writing injected SQL for node "model.vg_casestudy.stg_raw_staging__customers"
[0m14:49:19.505891 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.stg_raw_staging__customers (compile): 14:49:19.502424 => 14:49:19.505704
[0m14:49:19.506218 [debug] [Thread-1 (]: Began executing node model.vg_casestudy.stg_raw_staging__customers
[0m14:49:19.506590 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.stg_raw_staging__customers (execute): 14:49:19.506435 => 14:49:19.506446
[0m14:49:19.507387 [debug] [Thread-1 (]: Finished running node model.vg_casestudy.stg_raw_staging__customers
[0m14:49:19.507759 [debug] [Thread-1 (]: Began running node model.vg_casestudy.stg_raw_staging__fx_rates
[0m14:49:19.508360 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.vg_casestudy.stg_raw_staging__customers, now model.vg_casestudy.stg_raw_staging__fx_rates)
[0m14:49:19.508691 [debug] [Thread-1 (]: Began compiling node model.vg_casestudy.stg_raw_staging__fx_rates
[0m14:49:19.515449 [debug] [Thread-1 (]: Writing injected SQL for node "model.vg_casestudy.stg_raw_staging__fx_rates"
[0m14:49:19.516195 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.stg_raw_staging__fx_rates (compile): 14:49:19.508910 => 14:49:19.515965
[0m14:49:19.516563 [debug] [Thread-1 (]: Began executing node model.vg_casestudy.stg_raw_staging__fx_rates
[0m14:49:19.516956 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.stg_raw_staging__fx_rates (execute): 14:49:19.516789 => 14:49:19.516799
[0m14:49:19.517715 [debug] [Thread-1 (]: Finished running node model.vg_casestudy.stg_raw_staging__fx_rates
[0m14:49:19.518077 [debug] [Thread-1 (]: Began running node model.vg_casestudy.stg_raw_staging__loans
[0m14:49:19.518679 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.vg_casestudy.stg_raw_staging__fx_rates, now model.vg_casestudy.stg_raw_staging__loans)
[0m14:49:19.518993 [debug] [Thread-1 (]: Began compiling node model.vg_casestudy.stg_raw_staging__loans
[0m14:49:19.522589 [debug] [Thread-1 (]: Writing injected SQL for node "model.vg_casestudy.stg_raw_staging__loans"
[0m14:49:19.523861 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.stg_raw_staging__loans (compile): 14:49:19.519213 => 14:49:19.523637
[0m14:49:19.524181 [debug] [Thread-1 (]: Began executing node model.vg_casestudy.stg_raw_staging__loans
[0m14:49:19.524568 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.stg_raw_staging__loans (execute): 14:49:19.524404 => 14:49:19.524414
[0m14:49:19.525283 [debug] [Thread-1 (]: Finished running node model.vg_casestudy.stg_raw_staging__loans
[0m14:49:19.525661 [debug] [Thread-1 (]: Began running node model.vg_casestudy.stg_raw_staging__transactions
[0m14:49:19.526229 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.vg_casestudy.stg_raw_staging__loans, now model.vg_casestudy.stg_raw_staging__transactions)
[0m14:49:19.526537 [debug] [Thread-1 (]: Began compiling node model.vg_casestudy.stg_raw_staging__transactions
[0m14:49:19.530015 [debug] [Thread-1 (]: Writing injected SQL for node "model.vg_casestudy.stg_raw_staging__transactions"
[0m14:49:19.531657 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.stg_raw_staging__transactions (compile): 14:49:19.526761 => 14:49:19.531393
[0m14:49:19.532001 [debug] [Thread-1 (]: Began executing node model.vg_casestudy.stg_raw_staging__transactions
[0m14:49:19.532386 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.stg_raw_staging__transactions (execute): 14:49:19.532226 => 14:49:19.532234
[0m14:49:19.533144 [debug] [Thread-1 (]: Finished running node model.vg_casestudy.stg_raw_staging__transactions
[0m14:49:19.533637 [debug] [Thread-1 (]: Began running node seed.vg_casestudy.currencies
[0m14:49:19.534203 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.vg_casestudy.stg_raw_staging__transactions, now seed.vg_casestudy.currencies)
[0m14:49:19.534525 [debug] [Thread-1 (]: Began compiling node seed.vg_casestudy.currencies
[0m14:49:19.536510 [debug] [Thread-1 (]: Timing info for seed.vg_casestudy.currencies (compile): 14:49:19.534748 => 14:49:19.536362
[0m14:49:19.536832 [debug] [Thread-1 (]: Began executing node seed.vg_casestudy.currencies
[0m14:49:19.537343 [debug] [Thread-1 (]: Timing info for seed.vg_casestudy.currencies (execute): 14:49:19.537177 => 14:49:19.537200
[0m14:49:19.538095 [debug] [Thread-1 (]: Finished running node seed.vg_casestudy.currencies
[0m14:49:19.538439 [debug] [Thread-1 (]: Began running node seed.vg_casestudy.dbt_project_evaluator_exceptions
[0m14:49:19.539012 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.vg_casestudy.currencies, now seed.vg_casestudy.dbt_project_evaluator_exceptions)
[0m14:49:19.539335 [debug] [Thread-1 (]: Began compiling node seed.vg_casestudy.dbt_project_evaluator_exceptions
[0m14:49:19.541111 [debug] [Thread-1 (]: Timing info for seed.vg_casestudy.dbt_project_evaluator_exceptions (compile): 14:49:19.539550 => 14:49:19.540938
[0m14:49:19.541441 [debug] [Thread-1 (]: Began executing node seed.vg_casestudy.dbt_project_evaluator_exceptions
[0m14:49:19.541850 [debug] [Thread-1 (]: Timing info for seed.vg_casestudy.dbt_project_evaluator_exceptions (execute): 14:49:19.541677 => 14:49:19.541684
[0m14:49:19.542584 [debug] [Thread-1 (]: Finished running node seed.vg_casestudy.dbt_project_evaluator_exceptions
[0m14:49:19.542943 [debug] [Thread-1 (]: Began running node model.vg_casestudy.stg_staging_intermediate__accounts
[0m14:49:19.543541 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.vg_casestudy.dbt_project_evaluator_exceptions, now model.vg_casestudy.stg_staging_intermediate__accounts)
[0m14:49:19.543856 [debug] [Thread-1 (]: Began compiling node model.vg_casestudy.stg_staging_intermediate__accounts
[0m14:49:19.546920 [debug] [Thread-1 (]: Writing injected SQL for node "model.vg_casestudy.stg_staging_intermediate__accounts"
[0m14:49:19.548476 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.stg_staging_intermediate__accounts (compile): 14:49:19.544063 => 14:49:19.548236
[0m14:49:19.548917 [debug] [Thread-1 (]: Began executing node model.vg_casestudy.stg_staging_intermediate__accounts
[0m14:49:19.549399 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.stg_staging_intermediate__accounts (execute): 14:49:19.549194 => 14:49:19.549204
[0m14:49:19.550408 [debug] [Thread-1 (]: Finished running node model.vg_casestudy.stg_staging_intermediate__accounts
[0m14:49:19.550917 [debug] [Thread-1 (]: Began running node test.vg_casestudy.accepted_values_stg_raw_staging__accounts_account_type__savings__current.8db4e271bb
[0m14:49:19.551720 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.vg_casestudy.stg_staging_intermediate__accounts, now test.vg_casestudy.accepted_values_stg_raw_staging__accounts_account_type__savings__current.8db4e271bb)
[0m14:49:19.552255 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.accepted_values_stg_raw_staging__accounts_account_type__savings__current.8db4e271bb
[0m14:49:19.564032 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.accepted_values_stg_raw_staging__accounts_account_type__savings__current.8db4e271bb"
[0m14:49:19.565763 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.accepted_values_stg_raw_staging__accounts_account_type__savings__current.8db4e271bb (compile): 14:49:19.552486 => 14:49:19.565526
[0m14:49:19.566130 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.accepted_values_stg_raw_staging__accounts_account_type__savings__current.8db4e271bb
[0m14:49:19.566548 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.accepted_values_stg_raw_staging__accounts_account_type__savings__current.8db4e271bb (execute): 14:49:19.566353 => 14:49:19.566363
[0m14:49:19.567381 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.accepted_values_stg_raw_staging__accounts_account_type__savings__current.8db4e271bb
[0m14:49:19.567795 [debug] [Thread-1 (]: Began running node test.vg_casestudy.date_is_past_stg_raw_staging__accounts_account_opening_date.b05801e56a
[0m14:49:19.568617 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.accepted_values_stg_raw_staging__accounts_account_type__savings__current.8db4e271bb, now test.vg_casestudy.date_is_past_stg_raw_staging__accounts_account_opening_date.b05801e56a)
[0m14:49:19.569134 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.date_is_past_stg_raw_staging__accounts_account_opening_date.b05801e56a
[0m14:49:19.574329 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.date_is_past_stg_raw_staging__accounts_account_opening_date.b05801e56a"
[0m14:49:19.574957 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.date_is_past_stg_raw_staging__accounts_account_opening_date.b05801e56a (compile): 14:49:19.569402 => 14:49:19.574758
[0m14:49:19.575285 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.date_is_past_stg_raw_staging__accounts_account_opening_date.b05801e56a
[0m14:49:19.575711 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.date_is_past_stg_raw_staging__accounts_account_opening_date.b05801e56a (execute): 14:49:19.575541 => 14:49:19.575548
[0m14:49:19.576474 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.date_is_past_stg_raw_staging__accounts_account_opening_date.b05801e56a
[0m14:49:19.576874 [debug] [Thread-1 (]: Began running node test.vg_casestudy.not_null_stg_raw_staging__accounts_account_id.c6fceee87c
[0m14:49:19.577635 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.date_is_past_stg_raw_staging__accounts_account_opening_date.b05801e56a, now test.vg_casestudy.not_null_stg_raw_staging__accounts_account_id.c6fceee87c)
[0m14:49:19.578040 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.not_null_stg_raw_staging__accounts_account_id.c6fceee87c
[0m14:49:19.587530 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.not_null_stg_raw_staging__accounts_account_id.c6fceee87c"
[0m14:49:19.588142 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_stg_raw_staging__accounts_account_id.c6fceee87c (compile): 14:49:19.578250 => 14:49:19.587935
[0m14:49:19.588480 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.not_null_stg_raw_staging__accounts_account_id.c6fceee87c
[0m14:49:19.588886 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_stg_raw_staging__accounts_account_id.c6fceee87c (execute): 14:49:19.588703 => 14:49:19.588710
[0m14:49:19.589601 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.not_null_stg_raw_staging__accounts_account_id.c6fceee87c
[0m14:49:19.589958 [debug] [Thread-1 (]: Began running node test.vg_casestudy.not_null_stg_raw_staging__accounts_account_type.298c80ded4
[0m14:49:19.590541 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.not_null_stg_raw_staging__accounts_account_id.c6fceee87c, now test.vg_casestudy.not_null_stg_raw_staging__accounts_account_type.298c80ded4)
[0m14:49:19.590885 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.not_null_stg_raw_staging__accounts_account_type.298c80ded4
[0m14:49:19.632263 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.not_null_stg_raw_staging__accounts_account_type.298c80ded4"
[0m14:49:19.632871 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_stg_raw_staging__accounts_account_type.298c80ded4 (compile): 14:49:19.591324 => 14:49:19.632692
[0m14:49:19.633262 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.not_null_stg_raw_staging__accounts_account_type.298c80ded4
[0m14:49:19.633676 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_stg_raw_staging__accounts_account_type.298c80ded4 (execute): 14:49:19.633513 => 14:49:19.633520
[0m14:49:19.634373 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.not_null_stg_raw_staging__accounts_account_type.298c80ded4
[0m14:49:19.634725 [debug] [Thread-1 (]: Began running node test.vg_casestudy.not_null_stg_raw_staging__accounts_customer_id.99ecced993
[0m14:49:19.635313 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.not_null_stg_raw_staging__accounts_account_type.298c80ded4, now test.vg_casestudy.not_null_stg_raw_staging__accounts_customer_id.99ecced993)
[0m14:49:19.635626 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.not_null_stg_raw_staging__accounts_customer_id.99ecced993
[0m14:49:19.639426 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.not_null_stg_raw_staging__accounts_customer_id.99ecced993"
[0m14:49:19.640172 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_stg_raw_staging__accounts_customer_id.99ecced993 (compile): 14:49:19.635848 => 14:49:19.639970
[0m14:49:19.640471 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.not_null_stg_raw_staging__accounts_customer_id.99ecced993
[0m14:49:19.640834 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_stg_raw_staging__accounts_customer_id.99ecced993 (execute): 14:49:19.640677 => 14:49:19.640683
[0m14:49:19.641515 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.not_null_stg_raw_staging__accounts_customer_id.99ecced993
[0m14:49:19.641869 [debug] [Thread-1 (]: Began running node test.vg_casestudy.unique_stg_raw_staging__accounts_account_id.cfe13a9c67
[0m14:49:19.642422 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.not_null_stg_raw_staging__accounts_customer_id.99ecced993, now test.vg_casestudy.unique_stg_raw_staging__accounts_account_id.cfe13a9c67)
[0m14:49:19.642821 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.unique_stg_raw_staging__accounts_account_id.cfe13a9c67
[0m14:49:19.649386 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.unique_stg_raw_staging__accounts_account_id.cfe13a9c67"
[0m14:49:19.649966 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.unique_stg_raw_staging__accounts_account_id.cfe13a9c67 (compile): 14:49:19.643224 => 14:49:19.649793
[0m14:49:19.650289 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.unique_stg_raw_staging__accounts_account_id.cfe13a9c67
[0m14:49:19.650700 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.unique_stg_raw_staging__accounts_account_id.cfe13a9c67 (execute): 14:49:19.650533 => 14:49:19.650540
[0m14:49:19.651410 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.unique_stg_raw_staging__accounts_account_id.cfe13a9c67
[0m14:49:19.651783 [debug] [Thread-1 (]: Began running node model.vg_casestudy.stg_staging_intermediate__customers
[0m14:49:19.652353 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.unique_stg_raw_staging__accounts_account_id.cfe13a9c67, now model.vg_casestudy.stg_staging_intermediate__customers)
[0m14:49:19.652688 [debug] [Thread-1 (]: Began compiling node model.vg_casestudy.stg_staging_intermediate__customers
[0m14:49:19.655370 [debug] [Thread-1 (]: Writing injected SQL for node "model.vg_casestudy.stg_staging_intermediate__customers"
[0m14:49:19.656141 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.stg_staging_intermediate__customers (compile): 14:49:19.652932 => 14:49:19.655904
[0m14:49:19.656440 [debug] [Thread-1 (]: Began executing node model.vg_casestudy.stg_staging_intermediate__customers
[0m14:49:19.656818 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.stg_staging_intermediate__customers (execute): 14:49:19.656660 => 14:49:19.656667
[0m14:49:19.657509 [debug] [Thread-1 (]: Finished running node model.vg_casestudy.stg_staging_intermediate__customers
[0m14:49:19.657877 [debug] [Thread-1 (]: Began running node test.vg_casestudy.not_null_stg_raw_staging__customers_age.402d2aacc9
[0m14:49:19.658434 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.vg_casestudy.stg_staging_intermediate__customers, now test.vg_casestudy.not_null_stg_raw_staging__customers_age.402d2aacc9)
[0m14:49:19.659236 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.not_null_stg_raw_staging__customers_age.402d2aacc9
[0m14:49:19.663091 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.not_null_stg_raw_staging__customers_age.402d2aacc9"
[0m14:49:19.664778 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_stg_raw_staging__customers_age.402d2aacc9 (compile): 14:49:19.659469 => 14:49:19.664558
[0m14:49:19.665090 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.not_null_stg_raw_staging__customers_age.402d2aacc9
[0m14:49:19.665464 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_stg_raw_staging__customers_age.402d2aacc9 (execute): 14:49:19.665307 => 14:49:19.665315
[0m14:49:19.666176 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.not_null_stg_raw_staging__customers_age.402d2aacc9
[0m14:49:19.666537 [debug] [Thread-1 (]: Began running node test.vg_casestudy.not_null_stg_raw_staging__customers_branch_id.96cc924db7
[0m14:49:19.667099 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.not_null_stg_raw_staging__customers_age.402d2aacc9, now test.vg_casestudy.not_null_stg_raw_staging__customers_branch_id.96cc924db7)
[0m14:49:19.667413 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.not_null_stg_raw_staging__customers_branch_id.96cc924db7
[0m14:49:19.671186 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.not_null_stg_raw_staging__customers_branch_id.96cc924db7"
[0m14:49:19.671896 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_stg_raw_staging__customers_branch_id.96cc924db7 (compile): 14:49:19.667642 => 14:49:19.671696
[0m14:49:19.672193 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.not_null_stg_raw_staging__customers_branch_id.96cc924db7
[0m14:49:19.672552 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_stg_raw_staging__customers_branch_id.96cc924db7 (execute): 14:49:19.672401 => 14:49:19.672408
[0m14:49:19.673260 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.not_null_stg_raw_staging__customers_branch_id.96cc924db7
[0m14:49:19.673674 [debug] [Thread-1 (]: Began running node test.vg_casestudy.not_null_stg_raw_staging__customers_customer_id.d27d30a04a
[0m14:49:19.674224 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.not_null_stg_raw_staging__customers_branch_id.96cc924db7, now test.vg_casestudy.not_null_stg_raw_staging__customers_customer_id.d27d30a04a)
[0m14:49:19.674883 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.not_null_stg_raw_staging__customers_customer_id.d27d30a04a
[0m14:49:19.678828 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.not_null_stg_raw_staging__customers_customer_id.d27d30a04a"
[0m14:49:19.679413 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_stg_raw_staging__customers_customer_id.d27d30a04a (compile): 14:49:19.675131 => 14:49:19.679230
[0m14:49:19.679715 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.not_null_stg_raw_staging__customers_customer_id.d27d30a04a
[0m14:49:19.680127 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_stg_raw_staging__customers_customer_id.d27d30a04a (execute): 14:49:19.679957 => 14:49:19.679980
[0m14:49:19.680880 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.not_null_stg_raw_staging__customers_customer_id.d27d30a04a
[0m14:49:19.681275 [debug] [Thread-1 (]: Began running node test.vg_casestudy.numeric_range_stg_raw_staging__customers_age__200__18.2b9231d3a8
[0m14:49:19.681896 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.not_null_stg_raw_staging__customers_customer_id.d27d30a04a, now test.vg_casestudy.numeric_range_stg_raw_staging__customers_age__200__18.2b9231d3a8)
[0m14:49:19.682230 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.numeric_range_stg_raw_staging__customers_age__200__18.2b9231d3a8
[0m14:49:19.688528 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.numeric_range_stg_raw_staging__customers_age__200__18.2b9231d3a8"
[0m14:49:19.689048 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.numeric_range_stg_raw_staging__customers_age__200__18.2b9231d3a8 (compile): 14:49:19.682463 => 14:49:19.688883
[0m14:49:19.689360 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.numeric_range_stg_raw_staging__customers_age__200__18.2b9231d3a8
[0m14:49:19.689748 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.numeric_range_stg_raw_staging__customers_age__200__18.2b9231d3a8 (execute): 14:49:19.689584 => 14:49:19.689592
[0m14:49:19.690530 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.numeric_range_stg_raw_staging__customers_age__200__18.2b9231d3a8
[0m14:49:19.690929 [debug] [Thread-1 (]: Began running node test.vg_casestudy.relationships_stg_raw_staging__accounts_customer_id__customer_id__ref_stg_raw_staging__customers_.87454c2c4c
[0m14:49:19.691497 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.numeric_range_stg_raw_staging__customers_age__200__18.2b9231d3a8, now test.vg_casestudy.relationships_stg_raw_staging__accounts_customer_id__customer_id__ref_stg_raw_staging__customers_.87454c2c4c)
[0m14:49:19.691830 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.relationships_stg_raw_staging__accounts_customer_id__customer_id__ref_stg_raw_staging__customers_.87454c2c4c
[0m14:49:19.700575 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.relationships_stg_raw_staging__accounts_customer_id__customer_id__ref_stg_raw_staging__customers_.87454c2c4c"
[0m14:49:19.701228 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.relationships_stg_raw_staging__accounts_customer_id__customer_id__ref_stg_raw_staging__customers_.87454c2c4c (compile): 14:49:19.692076 => 14:49:19.701005
[0m14:49:19.701550 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.relationships_stg_raw_staging__accounts_customer_id__customer_id__ref_stg_raw_staging__customers_.87454c2c4c
[0m14:49:19.701936 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.relationships_stg_raw_staging__accounts_customer_id__customer_id__ref_stg_raw_staging__customers_.87454c2c4c (execute): 14:49:19.701778 => 14:49:19.701785
[0m14:49:19.702636 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.relationships_stg_raw_staging__accounts_customer_id__customer_id__ref_stg_raw_staging__customers_.87454c2c4c
[0m14:49:19.702992 [debug] [Thread-1 (]: Began running node test.vg_casestudy.unique_stg_raw_staging__customers_customer_id.8cd8e9afb0
[0m14:49:19.703607 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.relationships_stg_raw_staging__accounts_customer_id__customer_id__ref_stg_raw_staging__customers_.87454c2c4c, now test.vg_casestudy.unique_stg_raw_staging__customers_customer_id.8cd8e9afb0)
[0m14:49:19.703952 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.unique_stg_raw_staging__customers_customer_id.8cd8e9afb0
[0m14:49:19.707704 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.unique_stg_raw_staging__customers_customer_id.8cd8e9afb0"
[0m14:49:19.708560 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.unique_stg_raw_staging__customers_customer_id.8cd8e9afb0 (compile): 14:49:19.704175 => 14:49:19.708321
[0m14:49:19.708869 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.unique_stg_raw_staging__customers_customer_id.8cd8e9afb0
[0m14:49:19.709247 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.unique_stg_raw_staging__customers_customer_id.8cd8e9afb0 (execute): 14:49:19.709089 => 14:49:19.709096
[0m14:49:19.709989 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.unique_stg_raw_staging__customers_customer_id.8cd8e9afb0
[0m14:49:19.710343 [debug] [Thread-1 (]: Began running node model.vg_casestudy.stg_staging_intermediate__fx_rates
[0m14:49:19.711162 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.unique_stg_raw_staging__customers_customer_id.8cd8e9afb0, now model.vg_casestudy.stg_staging_intermediate__fx_rates)
[0m14:49:19.711475 [debug] [Thread-1 (]: Began compiling node model.vg_casestudy.stg_staging_intermediate__fx_rates
[0m14:49:19.714139 [debug] [Thread-1 (]: Writing injected SQL for node "model.vg_casestudy.stg_staging_intermediate__fx_rates"
[0m14:49:19.714744 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.stg_staging_intermediate__fx_rates (compile): 14:49:19.711691 => 14:49:19.714527
[0m14:49:19.715110 [debug] [Thread-1 (]: Began executing node model.vg_casestudy.stg_staging_intermediate__fx_rates
[0m14:49:19.715489 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.stg_staging_intermediate__fx_rates (execute): 14:49:19.715337 => 14:49:19.715344
[0m14:49:19.716204 [debug] [Thread-1 (]: Finished running node model.vg_casestudy.stg_staging_intermediate__fx_rates
[0m14:49:19.716615 [debug] [Thread-1 (]: Began running node test.vg_casestudy.date_is_past_stg_raw_staging__fx_rates_fx_rate_date.7b2c6986f5
[0m14:49:19.717181 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.vg_casestudy.stg_staging_intermediate__fx_rates, now test.vg_casestudy.date_is_past_stg_raw_staging__fx_rates_fx_rate_date.7b2c6986f5)
[0m14:49:19.717489 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.date_is_past_stg_raw_staging__fx_rates_fx_rate_date.7b2c6986f5
[0m14:49:19.721062 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.date_is_past_stg_raw_staging__fx_rates_fx_rate_date.7b2c6986f5"
[0m14:49:19.722749 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.date_is_past_stg_raw_staging__fx_rates_fx_rate_date.7b2c6986f5 (compile): 14:49:19.717709 => 14:49:19.722495
[0m14:49:19.723120 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.date_is_past_stg_raw_staging__fx_rates_fx_rate_date.7b2c6986f5
[0m14:49:19.723560 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.date_is_past_stg_raw_staging__fx_rates_fx_rate_date.7b2c6986f5 (execute): 14:49:19.723382 => 14:49:19.723405
[0m14:49:19.724382 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.date_is_past_stg_raw_staging__fx_rates_fx_rate_date.7b2c6986f5
[0m14:49:19.724757 [debug] [Thread-1 (]: Began running node test.vg_casestudy.not_null_stg_raw_staging__fx_rates_currency_iso_code.6d09bdebaf
[0m14:49:19.725357 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.date_is_past_stg_raw_staging__fx_rates_fx_rate_date.7b2c6986f5, now test.vg_casestudy.not_null_stg_raw_staging__fx_rates_currency_iso_code.6d09bdebaf)
[0m14:49:19.725677 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.not_null_stg_raw_staging__fx_rates_currency_iso_code.6d09bdebaf
[0m14:49:19.729666 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.not_null_stg_raw_staging__fx_rates_currency_iso_code.6d09bdebaf"
[0m14:49:19.730379 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_stg_raw_staging__fx_rates_currency_iso_code.6d09bdebaf (compile): 14:49:19.725901 => 14:49:19.730160
[0m14:49:19.730687 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.not_null_stg_raw_staging__fx_rates_currency_iso_code.6d09bdebaf
[0m14:49:19.731056 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_stg_raw_staging__fx_rates_currency_iso_code.6d09bdebaf (execute): 14:49:19.730909 => 14:49:19.730916
[0m14:49:19.731761 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.not_null_stg_raw_staging__fx_rates_currency_iso_code.6d09bdebaf
[0m14:49:19.732139 [debug] [Thread-1 (]: Began running node test.vg_casestudy.not_null_stg_raw_staging__fx_rates_fx_rate.1c32f22fac
[0m14:49:19.732703 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.not_null_stg_raw_staging__fx_rates_currency_iso_code.6d09bdebaf, now test.vg_casestudy.not_null_stg_raw_staging__fx_rates_fx_rate.1c32f22fac)
[0m14:49:19.733031 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.not_null_stg_raw_staging__fx_rates_fx_rate.1c32f22fac
[0m14:49:19.736905 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.not_null_stg_raw_staging__fx_rates_fx_rate.1c32f22fac"
[0m14:49:19.737403 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_stg_raw_staging__fx_rates_fx_rate.1c32f22fac (compile): 14:49:19.733437 => 14:49:19.737250
[0m14:49:19.737713 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.not_null_stg_raw_staging__fx_rates_fx_rate.1c32f22fac
[0m14:49:19.738082 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_stg_raw_staging__fx_rates_fx_rate.1c32f22fac (execute): 14:49:19.737931 => 14:49:19.737937
[0m14:49:19.738931 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.not_null_stg_raw_staging__fx_rates_fx_rate.1c32f22fac
[0m14:49:19.739311 [debug] [Thread-1 (]: Began running node test.vg_casestudy.not_null_stg_raw_staging__fx_rates_has_date_parsing_error.2f51154c3b
[0m14:49:19.739904 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.not_null_stg_raw_staging__fx_rates_fx_rate.1c32f22fac, now test.vg_casestudy.not_null_stg_raw_staging__fx_rates_has_date_parsing_error.2f51154c3b)
[0m14:49:19.740230 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.not_null_stg_raw_staging__fx_rates_has_date_parsing_error.2f51154c3b
[0m14:49:19.744070 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.not_null_stg_raw_staging__fx_rates_has_date_parsing_error.2f51154c3b"
[0m14:49:19.744796 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_stg_raw_staging__fx_rates_has_date_parsing_error.2f51154c3b (compile): 14:49:19.740456 => 14:49:19.744594
[0m14:49:19.745098 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.not_null_stg_raw_staging__fx_rates_has_date_parsing_error.2f51154c3b
[0m14:49:19.745469 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_stg_raw_staging__fx_rates_has_date_parsing_error.2f51154c3b (execute): 14:49:19.745313 => 14:49:19.745319
[0m14:49:19.746146 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.not_null_stg_raw_staging__fx_rates_has_date_parsing_error.2f51154c3b
[0m14:49:19.746514 [debug] [Thread-1 (]: Began running node test.vg_casestudy.numeric_range_stg_raw_staging__fx_rates_fx_rate__0.ccd53e1d91
[0m14:49:19.747161 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.not_null_stg_raw_staging__fx_rates_has_date_parsing_error.2f51154c3b, now test.vg_casestudy.numeric_range_stg_raw_staging__fx_rates_fx_rate__0.ccd53e1d91)
[0m14:49:19.747481 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.numeric_range_stg_raw_staging__fx_rates_fx_rate__0.ccd53e1d91
[0m14:49:19.751143 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.numeric_range_stg_raw_staging__fx_rates_fx_rate__0.ccd53e1d91"
[0m14:49:19.751850 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.numeric_range_stg_raw_staging__fx_rates_fx_rate__0.ccd53e1d91 (compile): 14:49:19.747710 => 14:49:19.751652
[0m14:49:19.752148 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.numeric_range_stg_raw_staging__fx_rates_fx_rate__0.ccd53e1d91
[0m14:49:19.752524 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.numeric_range_stg_raw_staging__fx_rates_fx_rate__0.ccd53e1d91 (execute): 14:49:19.752368 => 14:49:19.752374
[0m14:49:19.753214 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.numeric_range_stg_raw_staging__fx_rates_fx_rate__0.ccd53e1d91
[0m14:49:19.753583 [debug] [Thread-1 (]: Began running node test.vg_casestudy.unique_stg_raw_staging__fx_rates_currency_iso_code.b1e6b26758
[0m14:49:19.754134 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.numeric_range_stg_raw_staging__fx_rates_fx_rate__0.ccd53e1d91, now test.vg_casestudy.unique_stg_raw_staging__fx_rates_currency_iso_code.b1e6b26758)
[0m14:49:19.754475 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.unique_stg_raw_staging__fx_rates_currency_iso_code.b1e6b26758
[0m14:49:19.758283 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.unique_stg_raw_staging__fx_rates_currency_iso_code.b1e6b26758"
[0m14:49:19.758906 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.unique_stg_raw_staging__fx_rates_currency_iso_code.b1e6b26758 (compile): 14:49:19.754764 => 14:49:19.758730
[0m14:49:19.759196 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.unique_stg_raw_staging__fx_rates_currency_iso_code.b1e6b26758
[0m14:49:19.759558 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.unique_stg_raw_staging__fx_rates_currency_iso_code.b1e6b26758 (execute): 14:49:19.759401 => 14:49:19.759407
[0m14:49:19.760261 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.unique_stg_raw_staging__fx_rates_currency_iso_code.b1e6b26758
[0m14:49:19.760636 [debug] [Thread-1 (]: Began running node model.vg_casestudy.stg_staging_intermediate__loans
[0m14:49:19.761220 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.unique_stg_raw_staging__fx_rates_currency_iso_code.b1e6b26758, now model.vg_casestudy.stg_staging_intermediate__loans)
[0m14:49:19.761534 [debug] [Thread-1 (]: Began compiling node model.vg_casestudy.stg_staging_intermediate__loans
[0m14:49:19.764291 [debug] [Thread-1 (]: Writing injected SQL for node "model.vg_casestudy.stg_staging_intermediate__loans"
[0m14:49:19.764975 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.stg_staging_intermediate__loans (compile): 14:49:19.761759 => 14:49:19.764776
[0m14:49:19.765287 [debug] [Thread-1 (]: Began executing node model.vg_casestudy.stg_staging_intermediate__loans
[0m14:49:19.765664 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.stg_staging_intermediate__loans (execute): 14:49:19.765503 => 14:49:19.765509
[0m14:49:19.766378 [debug] [Thread-1 (]: Finished running node model.vg_casestudy.stg_staging_intermediate__loans
[0m14:49:19.766743 [debug] [Thread-1 (]: Began running node test.vg_casestudy.accepted_values_stg_raw_staging__loans_loan_status__approved__rejected__closed.667473d6c1
[0m14:49:19.767304 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.vg_casestudy.stg_staging_intermediate__loans, now test.vg_casestudy.accepted_values_stg_raw_staging__loans_loan_status__approved__rejected__closed.667473d6c1)
[0m14:49:19.767631 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.accepted_values_stg_raw_staging__loans_loan_status__approved__rejected__closed.667473d6c1
[0m14:49:19.774833 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.accepted_values_stg_raw_staging__loans_loan_status__approved__rejected__closed.667473d6c1"
[0m14:49:19.776427 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.accepted_values_stg_raw_staging__loans_loan_status__approved__rejected__closed.667473d6c1 (compile): 14:49:19.767845 => 14:49:19.776207
[0m14:49:19.776752 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.accepted_values_stg_raw_staging__loans_loan_status__approved__rejected__closed.667473d6c1
[0m14:49:19.777136 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.accepted_values_stg_raw_staging__loans_loan_status__approved__rejected__closed.667473d6c1 (execute): 14:49:19.776976 => 14:49:19.776983
[0m14:49:19.777871 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.accepted_values_stg_raw_staging__loans_loan_status__approved__rejected__closed.667473d6c1
[0m14:49:19.778239 [debug] [Thread-1 (]: Began running node test.vg_casestudy.accepted_values_stg_raw_staging__loans_loan_term__12__24__36__48__60.88d346fe3c
[0m14:49:19.778811 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.accepted_values_stg_raw_staging__loans_loan_status__approved__rejected__closed.667473d6c1, now test.vg_casestudy.accepted_values_stg_raw_staging__loans_loan_term__12__24__36__48__60.88d346fe3c)
[0m14:49:19.779125 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.accepted_values_stg_raw_staging__loans_loan_term__12__24__36__48__60.88d346fe3c
[0m14:49:19.783169 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.accepted_values_stg_raw_staging__loans_loan_term__12__24__36__48__60.88d346fe3c"
[0m14:49:19.783942 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.accepted_values_stg_raw_staging__loans_loan_term__12__24__36__48__60.88d346fe3c (compile): 14:49:19.779349 => 14:49:19.783746
[0m14:49:19.784247 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.accepted_values_stg_raw_staging__loans_loan_term__12__24__36__48__60.88d346fe3c
[0m14:49:19.784618 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.accepted_values_stg_raw_staging__loans_loan_term__12__24__36__48__60.88d346fe3c (execute): 14:49:19.784464 => 14:49:19.784470
[0m14:49:19.785314 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.accepted_values_stg_raw_staging__loans_loan_term__12__24__36__48__60.88d346fe3c
[0m14:49:19.785698 [debug] [Thread-1 (]: Began running node test.vg_casestudy.accepted_values_stg_raw_staging__loans_loan_type__personal__mortgage__auto.f98f448e68
[0m14:49:19.786272 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.accepted_values_stg_raw_staging__loans_loan_term__12__24__36__48__60.88d346fe3c, now test.vg_casestudy.accepted_values_stg_raw_staging__loans_loan_type__personal__mortgage__auto.f98f448e68)
[0m14:49:19.786806 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.accepted_values_stg_raw_staging__loans_loan_type__personal__mortgage__auto.f98f448e68
[0m14:49:19.793413 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.accepted_values_stg_raw_staging__loans_loan_type__personal__mortgage__auto.f98f448e68"
[0m14:49:19.794042 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.accepted_values_stg_raw_staging__loans_loan_type__personal__mortgage__auto.f98f448e68 (compile): 14:49:19.787271 => 14:49:19.793848
[0m14:49:19.794389 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.accepted_values_stg_raw_staging__loans_loan_type__personal__mortgage__auto.f98f448e68
[0m14:49:19.794791 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.accepted_values_stg_raw_staging__loans_loan_type__personal__mortgage__auto.f98f448e68 (execute): 14:49:19.794621 => 14:49:19.794645
[0m14:49:19.795534 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.accepted_values_stg_raw_staging__loans_loan_type__personal__mortgage__auto.f98f448e68
[0m14:49:19.795907 [debug] [Thread-1 (]: Began running node test.vg_casestudy.date_is_past_stg_raw_staging__loans_approval_rejection_date.92db02c0aa
[0m14:49:19.796488 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.accepted_values_stg_raw_staging__loans_loan_type__personal__mortgage__auto.f98f448e68, now test.vg_casestudy.date_is_past_stg_raw_staging__loans_approval_rejection_date.92db02c0aa)
[0m14:49:19.796851 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.date_is_past_stg_raw_staging__loans_approval_rejection_date.92db02c0aa
[0m14:49:19.800551 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.date_is_past_stg_raw_staging__loans_approval_rejection_date.92db02c0aa"
[0m14:49:19.801068 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.date_is_past_stg_raw_staging__loans_approval_rejection_date.92db02c0aa (compile): 14:49:19.797176 => 14:49:19.800896
[0m14:49:19.801400 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.date_is_past_stg_raw_staging__loans_approval_rejection_date.92db02c0aa
[0m14:49:19.801777 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.date_is_past_stg_raw_staging__loans_approval_rejection_date.92db02c0aa (execute): 14:49:19.801606 => 14:49:19.801630
[0m14:49:19.802796 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.date_is_past_stg_raw_staging__loans_approval_rejection_date.92db02c0aa
[0m14:49:19.803211 [debug] [Thread-1 (]: Began running node test.vg_casestudy.not_null_stg_raw_staging__loans_approval_rejection_date.6c82d62e88
[0m14:49:19.803815 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.date_is_past_stg_raw_staging__loans_approval_rejection_date.92db02c0aa, now test.vg_casestudy.not_null_stg_raw_staging__loans_approval_rejection_date.6c82d62e88)
[0m14:49:19.804165 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.not_null_stg_raw_staging__loans_approval_rejection_date.6c82d62e88
[0m14:49:19.807913 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.not_null_stg_raw_staging__loans_approval_rejection_date.6c82d62e88"
[0m14:49:19.808560 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_stg_raw_staging__loans_approval_rejection_date.6c82d62e88 (compile): 14:49:19.804399 => 14:49:19.808380
[0m14:49:19.808844 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.not_null_stg_raw_staging__loans_approval_rejection_date.6c82d62e88
[0m14:49:19.809203 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_stg_raw_staging__loans_approval_rejection_date.6c82d62e88 (execute): 14:49:19.809049 => 14:49:19.809055
[0m14:49:19.809900 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.not_null_stg_raw_staging__loans_approval_rejection_date.6c82d62e88
[0m14:49:19.810266 [debug] [Thread-1 (]: Began running node test.vg_casestudy.not_null_stg_raw_staging__loans_interest_rate.af6bbce27a
[0m14:49:19.810832 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.not_null_stg_raw_staging__loans_approval_rejection_date.6c82d62e88, now test.vg_casestudy.not_null_stg_raw_staging__loans_interest_rate.af6bbce27a)
[0m14:49:19.811145 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.not_null_stg_raw_staging__loans_interest_rate.af6bbce27a
[0m14:49:19.815093 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.not_null_stg_raw_staging__loans_interest_rate.af6bbce27a"
[0m14:49:19.815733 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_stg_raw_staging__loans_interest_rate.af6bbce27a (compile): 14:49:19.811364 => 14:49:19.815555
[0m14:49:19.816036 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.not_null_stg_raw_staging__loans_interest_rate.af6bbce27a
[0m14:49:19.816419 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_stg_raw_staging__loans_interest_rate.af6bbce27a (execute): 14:49:19.816266 => 14:49:19.816272
[0m14:49:19.817098 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.not_null_stg_raw_staging__loans_interest_rate.af6bbce27a
[0m14:49:19.817461 [debug] [Thread-1 (]: Began running node test.vg_casestudy.not_null_stg_raw_staging__loans_loan_amount.9143c49752
[0m14:49:19.818041 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.not_null_stg_raw_staging__loans_interest_rate.af6bbce27a, now test.vg_casestudy.not_null_stg_raw_staging__loans_loan_amount.9143c49752)
[0m14:49:19.818509 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.not_null_stg_raw_staging__loans_loan_amount.9143c49752
[0m14:49:19.822362 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.not_null_stg_raw_staging__loans_loan_amount.9143c49752"
[0m14:49:19.822897 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_stg_raw_staging__loans_loan_amount.9143c49752 (compile): 14:49:19.818961 => 14:49:19.822723
[0m14:49:19.823253 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.not_null_stg_raw_staging__loans_loan_amount.9143c49752
[0m14:49:19.823645 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_stg_raw_staging__loans_loan_amount.9143c49752 (execute): 14:49:19.823472 => 14:49:19.823480
[0m14:49:19.824344 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.not_null_stg_raw_staging__loans_loan_amount.9143c49752
[0m14:49:19.824718 [debug] [Thread-1 (]: Began running node test.vg_casestudy.not_null_stg_raw_staging__loans_loan_id.2434a0af3b
[0m14:49:19.825333 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.not_null_stg_raw_staging__loans_loan_amount.9143c49752, now test.vg_casestudy.not_null_stg_raw_staging__loans_loan_id.2434a0af3b)
[0m14:49:19.825637 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.not_null_stg_raw_staging__loans_loan_id.2434a0af3b
[0m14:49:19.829217 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.not_null_stg_raw_staging__loans_loan_id.2434a0af3b"
[0m14:49:19.829714 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_stg_raw_staging__loans_loan_id.2434a0af3b (compile): 14:49:19.825838 => 14:49:19.829553
[0m14:49:19.830038 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.not_null_stg_raw_staging__loans_loan_id.2434a0af3b
[0m14:49:19.830402 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_stg_raw_staging__loans_loan_id.2434a0af3b (execute): 14:49:19.830253 => 14:49:19.830260
[0m14:49:19.831172 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.not_null_stg_raw_staging__loans_loan_id.2434a0af3b
[0m14:49:19.831538 [debug] [Thread-1 (]: Began running node test.vg_casestudy.not_null_stg_raw_staging__loans_loan_status.f4d3276dbd
[0m14:49:19.832103 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.not_null_stg_raw_staging__loans_loan_id.2434a0af3b, now test.vg_casestudy.not_null_stg_raw_staging__loans_loan_status.f4d3276dbd)
[0m14:49:19.832415 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.not_null_stg_raw_staging__loans_loan_status.f4d3276dbd
[0m14:49:19.838803 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.not_null_stg_raw_staging__loans_loan_status.f4d3276dbd"
[0m14:49:19.839370 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_stg_raw_staging__loans_loan_status.f4d3276dbd (compile): 14:49:19.832646 => 14:49:19.839192
[0m14:49:19.839696 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.not_null_stg_raw_staging__loans_loan_status.f4d3276dbd
[0m14:49:19.840064 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_stg_raw_staging__loans_loan_status.f4d3276dbd (execute): 14:49:19.839915 => 14:49:19.839922
[0m14:49:19.840786 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.not_null_stg_raw_staging__loans_loan_status.f4d3276dbd
[0m14:49:19.841136 [debug] [Thread-1 (]: Began running node test.vg_casestudy.not_null_stg_raw_staging__loans_loan_term.53fc5904d6
[0m14:49:19.841715 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.not_null_stg_raw_staging__loans_loan_status.f4d3276dbd, now test.vg_casestudy.not_null_stg_raw_staging__loans_loan_term.53fc5904d6)
[0m14:49:19.842030 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.not_null_stg_raw_staging__loans_loan_term.53fc5904d6
[0m14:49:19.845751 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.not_null_stg_raw_staging__loans_loan_term.53fc5904d6"
[0m14:49:19.846383 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_stg_raw_staging__loans_loan_term.53fc5904d6 (compile): 14:49:19.842268 => 14:49:19.846193
[0m14:49:19.846781 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.not_null_stg_raw_staging__loans_loan_term.53fc5904d6
[0m14:49:19.847159 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_stg_raw_staging__loans_loan_term.53fc5904d6 (execute): 14:49:19.847012 => 14:49:19.847018
[0m14:49:19.847870 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.not_null_stg_raw_staging__loans_loan_term.53fc5904d6
[0m14:49:19.848244 [debug] [Thread-1 (]: Began running node test.vg_casestudy.not_null_stg_raw_staging__loans_loan_type.a3d87b38a0
[0m14:49:19.848825 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.not_null_stg_raw_staging__loans_loan_term.53fc5904d6, now test.vg_casestudy.not_null_stg_raw_staging__loans_loan_type.a3d87b38a0)
[0m14:49:19.849149 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.not_null_stg_raw_staging__loans_loan_type.a3d87b38a0
[0m14:49:19.853324 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.not_null_stg_raw_staging__loans_loan_type.a3d87b38a0"
[0m14:49:19.853988 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_stg_raw_staging__loans_loan_type.a3d87b38a0 (compile): 14:49:19.849394 => 14:49:19.853781
[0m14:49:19.854332 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.not_null_stg_raw_staging__loans_loan_type.a3d87b38a0
[0m14:49:19.854785 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_stg_raw_staging__loans_loan_type.a3d87b38a0 (execute): 14:49:19.854553 => 14:49:19.854561
[0m14:49:19.855523 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.not_null_stg_raw_staging__loans_loan_type.a3d87b38a0
[0m14:49:19.855877 [debug] [Thread-1 (]: Began running node test.vg_casestudy.numeric_range_stg_raw_staging__loans_interest_rate__0.c62529af67
[0m14:49:19.856478 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.not_null_stg_raw_staging__loans_loan_type.a3d87b38a0, now test.vg_casestudy.numeric_range_stg_raw_staging__loans_interest_rate__0.c62529af67)
[0m14:49:19.856798 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.numeric_range_stg_raw_staging__loans_interest_rate__0.c62529af67
[0m14:49:19.860338 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.numeric_range_stg_raw_staging__loans_interest_rate__0.c62529af67"
[0m14:49:19.860997 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.numeric_range_stg_raw_staging__loans_interest_rate__0.c62529af67 (compile): 14:49:19.857021 => 14:49:19.860799
[0m14:49:19.861288 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.numeric_range_stg_raw_staging__loans_interest_rate__0.c62529af67
[0m14:49:19.861637 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.numeric_range_stg_raw_staging__loans_interest_rate__0.c62529af67 (execute): 14:49:19.861492 => 14:49:19.861498
[0m14:49:19.862484 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.numeric_range_stg_raw_staging__loans_interest_rate__0.c62529af67
[0m14:49:19.862871 [debug] [Thread-1 (]: Began running node test.vg_casestudy.numeric_range_stg_raw_staging__loans_loan_amount__0.d8b44433a4
[0m14:49:19.863500 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.numeric_range_stg_raw_staging__loans_interest_rate__0.c62529af67, now test.vg_casestudy.numeric_range_stg_raw_staging__loans_loan_amount__0.d8b44433a4)
[0m14:49:19.863830 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.numeric_range_stg_raw_staging__loans_loan_amount__0.d8b44433a4
[0m14:49:19.867525 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.numeric_range_stg_raw_staging__loans_loan_amount__0.d8b44433a4"
[0m14:49:19.868368 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.numeric_range_stg_raw_staging__loans_loan_amount__0.d8b44433a4 (compile): 14:49:19.864050 => 14:49:19.868132
[0m14:49:19.868670 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.numeric_range_stg_raw_staging__loans_loan_amount__0.d8b44433a4
[0m14:49:19.869050 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.numeric_range_stg_raw_staging__loans_loan_amount__0.d8b44433a4 (execute): 14:49:19.868890 => 14:49:19.868896
[0m14:49:19.869734 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.numeric_range_stg_raw_staging__loans_loan_amount__0.d8b44433a4
[0m14:49:19.870106 [debug] [Thread-1 (]: Began running node test.vg_casestudy.unique_stg_raw_staging__loans_loan_id.fdf57e988a
[0m14:49:19.870668 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.numeric_range_stg_raw_staging__loans_loan_amount__0.d8b44433a4, now test.vg_casestudy.unique_stg_raw_staging__loans_loan_id.fdf57e988a)
[0m14:49:19.870974 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.unique_stg_raw_staging__loans_loan_id.fdf57e988a
[0m14:49:19.874640 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.unique_stg_raw_staging__loans_loan_id.fdf57e988a"
[0m14:49:19.875459 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.unique_stg_raw_staging__loans_loan_id.fdf57e988a (compile): 14:49:19.871192 => 14:49:19.875225
[0m14:49:19.875750 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.unique_stg_raw_staging__loans_loan_id.fdf57e988a
[0m14:49:19.876118 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.unique_stg_raw_staging__loans_loan_id.fdf57e988a (execute): 14:49:19.875961 => 14:49:19.875967
[0m14:49:19.876811 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.unique_stg_raw_staging__loans_loan_id.fdf57e988a
[0m14:49:19.877173 [debug] [Thread-1 (]: Began running node model.vg_casestudy.stg_staging_intermediate__currencies
[0m14:49:19.877731 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.unique_stg_raw_staging__loans_loan_id.fdf57e988a, now model.vg_casestudy.stg_staging_intermediate__currencies)
[0m14:49:19.878042 [debug] [Thread-1 (]: Began compiling node model.vg_casestudy.stg_staging_intermediate__currencies
[0m14:49:19.880757 [debug] [Thread-1 (]: Writing injected SQL for node "model.vg_casestudy.stg_staging_intermediate__currencies"
[0m14:49:19.881554 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.stg_staging_intermediate__currencies (compile): 14:49:19.878283 => 14:49:19.881333
[0m14:49:19.881858 [debug] [Thread-1 (]: Began executing node model.vg_casestudy.stg_staging_intermediate__currencies
[0m14:49:19.882398 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.stg_staging_intermediate__currencies (execute): 14:49:19.882220 => 14:49:19.882228
[0m14:49:19.883143 [debug] [Thread-1 (]: Finished running node model.vg_casestudy.stg_staging_intermediate__currencies
[0m14:49:19.883543 [debug] [Thread-1 (]: Began running node model.vg_casestudy.stg_staging_intermediate__transactions
[0m14:49:19.884139 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.vg_casestudy.stg_staging_intermediate__currencies, now model.vg_casestudy.stg_staging_intermediate__transactions)
[0m14:49:19.884457 [debug] [Thread-1 (]: Began compiling node model.vg_casestudy.stg_staging_intermediate__transactions
[0m14:49:19.887161 [debug] [Thread-1 (]: Writing injected SQL for node "model.vg_casestudy.stg_staging_intermediate__transactions"
[0m14:49:19.888149 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.stg_staging_intermediate__transactions (compile): 14:49:19.884680 => 14:49:19.887898
[0m14:49:19.888501 [debug] [Thread-1 (]: Began executing node model.vg_casestudy.stg_staging_intermediate__transactions
[0m14:49:19.889014 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.stg_staging_intermediate__transactions (execute): 14:49:19.888724 => 14:49:19.888731
[0m14:49:19.889742 [debug] [Thread-1 (]: Finished running node model.vg_casestudy.stg_staging_intermediate__transactions
[0m14:49:19.890109 [debug] [Thread-1 (]: Began running node test.vg_casestudy.accepted_values_stg_raw_staging__transactions_transaction_type__transfer__deposit__withdrawal.9d791cc0ee
[0m14:49:19.890675 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.vg_casestudy.stg_staging_intermediate__transactions, now test.vg_casestudy.accepted_values_stg_raw_staging__transactions_transaction_type__transfer__deposit__withdrawal.9d791cc0ee)
[0m14:49:19.890986 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.accepted_values_stg_raw_staging__transactions_transaction_type__transfer__deposit__withdrawal.9d791cc0ee
[0m14:49:19.896210 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.accepted_values_stg_raw_staging__transactions_transaction_type__transfer__deposit__withdrawal.9d791cc0ee"
[0m14:49:19.898327 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.accepted_values_stg_raw_staging__transactions_transaction_type__transfer__deposit__withdrawal.9d791cc0ee (compile): 14:49:19.891214 => 14:49:19.897933
[0m14:49:19.898698 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.accepted_values_stg_raw_staging__transactions_transaction_type__transfer__deposit__withdrawal.9d791cc0ee
[0m14:49:19.899134 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.accepted_values_stg_raw_staging__transactions_transaction_type__transfer__deposit__withdrawal.9d791cc0ee (execute): 14:49:19.898946 => 14:49:19.898963
[0m14:49:19.900047 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.accepted_values_stg_raw_staging__transactions_transaction_type__transfer__deposit__withdrawal.9d791cc0ee
[0m14:49:19.900422 [debug] [Thread-1 (]: Began running node test.vg_casestudy.not_null_stg_raw_staging__transactions_account_id.52f5c093d5
[0m14:49:19.901013 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.accepted_values_stg_raw_staging__transactions_transaction_type__transfer__deposit__withdrawal.9d791cc0ee, now test.vg_casestudy.not_null_stg_raw_staging__transactions_account_id.52f5c093d5)
[0m14:49:19.901343 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.not_null_stg_raw_staging__transactions_account_id.52f5c093d5
[0m14:49:19.905358 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.not_null_stg_raw_staging__transactions_account_id.52f5c093d5"
[0m14:49:19.906139 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_stg_raw_staging__transactions_account_id.52f5c093d5 (compile): 14:49:19.901568 => 14:49:19.905906
[0m14:49:19.906441 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.not_null_stg_raw_staging__transactions_account_id.52f5c093d5
[0m14:49:19.906820 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_stg_raw_staging__transactions_account_id.52f5c093d5 (execute): 14:49:19.906659 => 14:49:19.906665
[0m14:49:19.907512 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.not_null_stg_raw_staging__transactions_account_id.52f5c093d5
[0m14:49:19.907880 [debug] [Thread-1 (]: Began running node test.vg_casestudy.not_null_stg_raw_staging__transactions_transaction_id.ebc02c3793
[0m14:49:19.910169 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.not_null_stg_raw_staging__transactions_account_id.52f5c093d5, now test.vg_casestudy.not_null_stg_raw_staging__transactions_transaction_id.ebc02c3793)
[0m14:49:19.910565 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.not_null_stg_raw_staging__transactions_transaction_id.ebc02c3793
[0m14:49:19.914536 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.not_null_stg_raw_staging__transactions_transaction_id.ebc02c3793"
[0m14:49:19.915420 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_stg_raw_staging__transactions_transaction_id.ebc02c3793 (compile): 14:49:19.910814 => 14:49:19.915209
[0m14:49:19.915729 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.not_null_stg_raw_staging__transactions_transaction_id.ebc02c3793
[0m14:49:19.916136 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_stg_raw_staging__transactions_transaction_id.ebc02c3793 (execute): 14:49:19.915945 => 14:49:19.915969
[0m14:49:19.916866 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.not_null_stg_raw_staging__transactions_transaction_id.ebc02c3793
[0m14:49:19.917218 [debug] [Thread-1 (]: Began running node test.vg_casestudy.not_null_stg_raw_staging__transactions_transaction_type.29e6a629e0
[0m14:49:19.917785 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.not_null_stg_raw_staging__transactions_transaction_id.ebc02c3793, now test.vg_casestudy.not_null_stg_raw_staging__transactions_transaction_type.29e6a629e0)
[0m14:49:19.918105 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.not_null_stg_raw_staging__transactions_transaction_type.29e6a629e0
[0m14:49:19.921857 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.not_null_stg_raw_staging__transactions_transaction_type.29e6a629e0"
[0m14:49:19.922544 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_stg_raw_staging__transactions_transaction_type.29e6a629e0 (compile): 14:49:19.918370 => 14:49:19.922349
[0m14:49:19.922840 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.not_null_stg_raw_staging__transactions_transaction_type.29e6a629e0
[0m14:49:19.923218 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_stg_raw_staging__transactions_transaction_type.29e6a629e0 (execute): 14:49:19.923052 => 14:49:19.923058
[0m14:49:19.923979 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.not_null_stg_raw_staging__transactions_transaction_type.29e6a629e0
[0m14:49:19.924346 [debug] [Thread-1 (]: Began running node test.vg_casestudy.relationships_stg_raw_staging__transactions_account_id__account_id__ref_stg_raw_staging__accounts_.e5e3cbe1a6
[0m14:49:19.925104 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.not_null_stg_raw_staging__transactions_transaction_type.29e6a629e0, now test.vg_casestudy.relationships_stg_raw_staging__transactions_account_id__account_id__ref_stg_raw_staging__accounts_.e5e3cbe1a6)
[0m14:49:19.925438 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.relationships_stg_raw_staging__transactions_account_id__account_id__ref_stg_raw_staging__accounts_.e5e3cbe1a6
[0m14:49:19.931832 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.relationships_stg_raw_staging__transactions_account_id__account_id__ref_stg_raw_staging__accounts_.e5e3cbe1a6"
[0m14:49:19.932653 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.relationships_stg_raw_staging__transactions_account_id__account_id__ref_stg_raw_staging__accounts_.e5e3cbe1a6 (compile): 14:49:19.925654 => 14:49:19.932328
[0m14:49:19.933376 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.relationships_stg_raw_staging__transactions_account_id__account_id__ref_stg_raw_staging__accounts_.e5e3cbe1a6
[0m14:49:19.934565 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.relationships_stg_raw_staging__transactions_account_id__account_id__ref_stg_raw_staging__accounts_.e5e3cbe1a6 (execute): 14:49:19.934081 => 14:49:19.934095
[0m14:49:19.936012 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.relationships_stg_raw_staging__transactions_account_id__account_id__ref_stg_raw_staging__accounts_.e5e3cbe1a6
[0m14:49:19.936453 [debug] [Thread-1 (]: Began running node test.vg_casestudy.unique_stg_raw_staging__transactions_transaction_id.e0f95cb9bb
[0m14:49:19.937219 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.relationships_stg_raw_staging__transactions_account_id__account_id__ref_stg_raw_staging__accounts_.e5e3cbe1a6, now test.vg_casestudy.unique_stg_raw_staging__transactions_transaction_id.e0f95cb9bb)
[0m14:49:19.937586 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.unique_stg_raw_staging__transactions_transaction_id.e0f95cb9bb
[0m14:49:19.941616 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.unique_stg_raw_staging__transactions_transaction_id.e0f95cb9bb"
[0m14:49:19.942266 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.unique_stg_raw_staging__transactions_transaction_id.e0f95cb9bb (compile): 14:49:19.937809 => 14:49:19.942078
[0m14:49:19.942608 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.unique_stg_raw_staging__transactions_transaction_id.e0f95cb9bb
[0m14:49:19.943001 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.unique_stg_raw_staging__transactions_transaction_id.e0f95cb9bb (execute): 14:49:19.942821 => 14:49:19.942830
[0m14:49:19.943827 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.unique_stg_raw_staging__transactions_transaction_id.e0f95cb9bb
[0m14:49:19.944198 [debug] [Thread-1 (]: Began running node test.vg_casestudy.date_is_past_stg_staging_intermediate__accounts_account_opening_date.f0a9449f31
[0m14:49:19.944811 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.unique_stg_raw_staging__transactions_transaction_id.e0f95cb9bb, now test.vg_casestudy.date_is_past_stg_staging_intermediate__accounts_account_opening_date.f0a9449f31)
[0m14:49:19.945224 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.date_is_past_stg_staging_intermediate__accounts_account_opening_date.f0a9449f31
[0m14:49:19.949226 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.date_is_past_stg_staging_intermediate__accounts_account_opening_date.f0a9449f31"
[0m14:49:19.951066 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.date_is_past_stg_staging_intermediate__accounts_account_opening_date.f0a9449f31 (compile): 14:49:19.945460 => 14:49:19.950774
[0m14:49:19.951414 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.date_is_past_stg_staging_intermediate__accounts_account_opening_date.f0a9449f31
[0m14:49:19.951786 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.date_is_past_stg_staging_intermediate__accounts_account_opening_date.f0a9449f31 (execute): 14:49:19.951627 => 14:49:19.951634
[0m14:49:19.952584 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.date_is_past_stg_staging_intermediate__accounts_account_opening_date.f0a9449f31
[0m14:49:19.952952 [debug] [Thread-1 (]: Began running node test.vg_casestudy.not_null_stg_staging_intermediate__accounts_account_id.ce9f8bf6f5
[0m14:49:19.953534 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.date_is_past_stg_staging_intermediate__accounts_account_opening_date.f0a9449f31, now test.vg_casestudy.not_null_stg_staging_intermediate__accounts_account_id.ce9f8bf6f5)
[0m14:49:19.953856 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.not_null_stg_staging_intermediate__accounts_account_id.ce9f8bf6f5
[0m14:49:19.957831 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.not_null_stg_staging_intermediate__accounts_account_id.ce9f8bf6f5"
[0m14:49:19.958546 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_stg_staging_intermediate__accounts_account_id.ce9f8bf6f5 (compile): 14:49:19.954093 => 14:49:19.958345
[0m14:49:19.958867 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.not_null_stg_staging_intermediate__accounts_account_id.ce9f8bf6f5
[0m14:49:19.959247 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_stg_staging_intermediate__accounts_account_id.ce9f8bf6f5 (execute): 14:49:19.959092 => 14:49:19.959098
[0m14:49:19.959954 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.not_null_stg_staging_intermediate__accounts_account_id.ce9f8bf6f5
[0m14:49:19.960302 [debug] [Thread-1 (]: Began running node test.vg_casestudy.not_null_stg_staging_intermediate__accounts_account_opening_date.14abf76bb5
[0m14:49:19.960999 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.not_null_stg_staging_intermediate__accounts_account_id.ce9f8bf6f5, now test.vg_casestudy.not_null_stg_staging_intermediate__accounts_account_opening_date.14abf76bb5)
[0m14:49:19.961352 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.not_null_stg_staging_intermediate__accounts_account_opening_date.14abf76bb5
[0m14:49:19.965325 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.not_null_stg_staging_intermediate__accounts_account_opening_date.14abf76bb5"
[0m14:49:19.966043 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_stg_staging_intermediate__accounts_account_opening_date.14abf76bb5 (compile): 14:49:19.961585 => 14:49:19.965837
[0m14:49:19.966346 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.not_null_stg_staging_intermediate__accounts_account_opening_date.14abf76bb5
[0m14:49:19.966726 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_stg_staging_intermediate__accounts_account_opening_date.14abf76bb5 (execute): 14:49:19.966570 => 14:49:19.966577
[0m14:49:19.967405 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.not_null_stg_staging_intermediate__accounts_account_opening_date.14abf76bb5
[0m14:49:19.967776 [debug] [Thread-1 (]: Began running node test.vg_casestudy.not_null_stg_staging_intermediate__accounts_customer_id.2a8ddb333d
[0m14:49:19.968330 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.not_null_stg_staging_intermediate__accounts_account_opening_date.14abf76bb5, now test.vg_casestudy.not_null_stg_staging_intermediate__accounts_customer_id.2a8ddb333d)
[0m14:49:19.968637 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.not_null_stg_staging_intermediate__accounts_customer_id.2a8ddb333d
[0m14:49:19.972407 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.not_null_stg_staging_intermediate__accounts_customer_id.2a8ddb333d"
[0m14:49:19.973107 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_stg_staging_intermediate__accounts_customer_id.2a8ddb333d (compile): 14:49:19.968895 => 14:49:19.972904
[0m14:49:19.973426 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.not_null_stg_staging_intermediate__accounts_customer_id.2a8ddb333d
[0m14:49:19.973808 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_stg_staging_intermediate__accounts_customer_id.2a8ddb333d (execute): 14:49:19.973650 => 14:49:19.973657
[0m14:49:19.974486 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.not_null_stg_staging_intermediate__accounts_customer_id.2a8ddb333d
[0m14:49:19.974841 [debug] [Thread-1 (]: Began running node test.vg_casestudy.unique_stg_staging_intermediate__accounts_account_id.b2f9fdea72
[0m14:49:19.975407 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.not_null_stg_staging_intermediate__accounts_customer_id.2a8ddb333d, now test.vg_casestudy.unique_stg_staging_intermediate__accounts_account_id.b2f9fdea72)
[0m14:49:19.975727 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.unique_stg_staging_intermediate__accounts_account_id.b2f9fdea72
[0m14:49:19.981524 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.unique_stg_staging_intermediate__accounts_account_id.b2f9fdea72"
[0m14:49:19.982145 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.unique_stg_staging_intermediate__accounts_account_id.b2f9fdea72 (compile): 14:49:19.975948 => 14:49:19.981941
[0m14:49:19.982457 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.unique_stg_staging_intermediate__accounts_account_id.b2f9fdea72
[0m14:49:19.982851 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.unique_stg_staging_intermediate__accounts_account_id.b2f9fdea72 (execute): 14:49:19.982689 => 14:49:19.982695
[0m14:49:19.983647 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.unique_stg_staging_intermediate__accounts_account_id.b2f9fdea72
[0m14:49:19.984025 [debug] [Thread-1 (]: Began running node test.vg_casestudy.not_null_stg_staging_intermediate__customers_branch_id.de895a293b
[0m14:49:19.984632 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.unique_stg_staging_intermediate__accounts_account_id.b2f9fdea72, now test.vg_casestudy.not_null_stg_staging_intermediate__customers_branch_id.de895a293b)
[0m14:49:19.984974 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.not_null_stg_staging_intermediate__customers_branch_id.de895a293b
[0m14:49:19.989055 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.not_null_stg_staging_intermediate__customers_branch_id.de895a293b"
[0m14:49:19.989891 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_stg_staging_intermediate__customers_branch_id.de895a293b (compile): 14:49:19.985244 => 14:49:19.989675
[0m14:49:19.990228 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.not_null_stg_staging_intermediate__customers_branch_id.de895a293b
[0m14:49:19.990637 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_stg_staging_intermediate__customers_branch_id.de895a293b (execute): 14:49:19.990465 => 14:49:19.990489
[0m14:49:19.991446 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.not_null_stg_staging_intermediate__customers_branch_id.de895a293b
[0m14:49:19.991838 [debug] [Thread-1 (]: Began running node test.vg_casestudy.not_null_stg_staging_intermediate__customers_customer_id.10f4ae76d7
[0m14:49:19.993084 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.not_null_stg_staging_intermediate__customers_branch_id.de895a293b, now test.vg_casestudy.not_null_stg_staging_intermediate__customers_customer_id.10f4ae76d7)
[0m14:49:19.993997 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.not_null_stg_staging_intermediate__customers_customer_id.10f4ae76d7
[0m14:49:19.998642 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.not_null_stg_staging_intermediate__customers_customer_id.10f4ae76d7"
[0m14:49:19.999312 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_stg_staging_intermediate__customers_customer_id.10f4ae76d7 (compile): 14:49:19.994310 => 14:49:19.999115
[0m14:49:19.999675 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.not_null_stg_staging_intermediate__customers_customer_id.10f4ae76d7
[0m14:49:20.000067 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_stg_staging_intermediate__customers_customer_id.10f4ae76d7 (execute): 14:49:19.999899 => 14:49:19.999923
[0m14:49:20.000846 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.not_null_stg_staging_intermediate__customers_customer_id.10f4ae76d7
[0m14:49:20.001246 [debug] [Thread-1 (]: Began running node test.vg_casestudy.relationships_stg_staging_intermediate__accounts_customer_id__customer_id__ref_stg_staging_intermediate__customers_.d3a09ede96
[0m14:49:20.001844 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.not_null_stg_staging_intermediate__customers_customer_id.10f4ae76d7, now test.vg_casestudy.relationships_stg_staging_intermediate__accounts_customer_id__customer_id__ref_stg_staging_intermediate__customers_.d3a09ede96)
[0m14:49:20.002203 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.relationships_stg_staging_intermediate__accounts_customer_id__customer_id__ref_stg_staging_intermediate__customers_.d3a09ede96
[0m14:49:20.008108 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.relationships_stg_staging_intermediate__accounts_customer_id__customer_id__ref_stg_staging_intermediate__customers_.d3a09ede96"
[0m14:49:20.008771 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.relationships_stg_staging_intermediate__accounts_customer_id__customer_id__ref_stg_staging_intermediate__customers_.d3a09ede96 (compile): 14:49:20.002501 => 14:49:20.008570
[0m14:49:20.009425 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.relationships_stg_staging_intermediate__accounts_customer_id__customer_id__ref_stg_staging_intermediate__customers_.d3a09ede96
[0m14:49:20.009914 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.relationships_stg_staging_intermediate__accounts_customer_id__customer_id__ref_stg_staging_intermediate__customers_.d3a09ede96 (execute): 14:49:20.009720 => 14:49:20.009729
[0m14:49:20.010754 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.relationships_stg_staging_intermediate__accounts_customer_id__customer_id__ref_stg_staging_intermediate__customers_.d3a09ede96
[0m14:49:20.011146 [debug] [Thread-1 (]: Began running node test.vg_casestudy.unique_stg_staging_intermediate__customers_customer_id.5bded562dd
[0m14:49:20.011915 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.relationships_stg_staging_intermediate__accounts_customer_id__customer_id__ref_stg_staging_intermediate__customers_.d3a09ede96, now test.vg_casestudy.unique_stg_staging_intermediate__customers_customer_id.5bded562dd)
[0m14:49:20.012271 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.unique_stg_staging_intermediate__customers_customer_id.5bded562dd
[0m14:49:20.016241 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.unique_stg_staging_intermediate__customers_customer_id.5bded562dd"
[0m14:49:20.016819 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.unique_stg_staging_intermediate__customers_customer_id.5bded562dd (compile): 14:49:20.012489 => 14:49:20.016634
[0m14:49:20.017152 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.unique_stg_staging_intermediate__customers_customer_id.5bded562dd
[0m14:49:20.017557 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.unique_stg_staging_intermediate__customers_customer_id.5bded562dd (execute): 14:49:20.017402 => 14:49:20.017409
[0m14:49:20.018299 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.unique_stg_staging_intermediate__customers_customer_id.5bded562dd
[0m14:49:20.018662 [debug] [Thread-1 (]: Began running node test.vg_casestudy.date_is_past_stg_staging_intermediate__fx_rates_fx_rate_date.6dd6ccf2e2
[0m14:49:20.019258 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.unique_stg_staging_intermediate__customers_customer_id.5bded562dd, now test.vg_casestudy.date_is_past_stg_staging_intermediate__fx_rates_fx_rate_date.6dd6ccf2e2)
[0m14:49:20.019605 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.date_is_past_stg_staging_intermediate__fx_rates_fx_rate_date.6dd6ccf2e2
[0m14:49:20.023108 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.date_is_past_stg_staging_intermediate__fx_rates_fx_rate_date.6dd6ccf2e2"
[0m14:49:20.023873 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.date_is_past_stg_staging_intermediate__fx_rates_fx_rate_date.6dd6ccf2e2 (compile): 14:49:20.019826 => 14:49:20.023670
[0m14:49:20.024174 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.date_is_past_stg_staging_intermediate__fx_rates_fx_rate_date.6dd6ccf2e2
[0m14:49:20.024561 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.date_is_past_stg_staging_intermediate__fx_rates_fx_rate_date.6dd6ccf2e2 (execute): 14:49:20.024391 => 14:49:20.024397
[0m14:49:20.025246 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.date_is_past_stg_staging_intermediate__fx_rates_fx_rate_date.6dd6ccf2e2
[0m14:49:20.025611 [debug] [Thread-1 (]: Began running node test.vg_casestudy.not_null_stg_staging_intermediate__fx_rates_currency_iso_code.95d2907ece
[0m14:49:20.026172 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.date_is_past_stg_staging_intermediate__fx_rates_fx_rate_date.6dd6ccf2e2, now test.vg_casestudy.not_null_stg_staging_intermediate__fx_rates_currency_iso_code.95d2907ece)
[0m14:49:20.026494 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.not_null_stg_staging_intermediate__fx_rates_currency_iso_code.95d2907ece
[0m14:49:20.030916 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.not_null_stg_staging_intermediate__fx_rates_currency_iso_code.95d2907ece"
[0m14:49:20.031890 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_stg_staging_intermediate__fx_rates_currency_iso_code.95d2907ece (compile): 14:49:20.026722 => 14:49:20.031671
[0m14:49:20.032281 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.not_null_stg_staging_intermediate__fx_rates_currency_iso_code.95d2907ece
[0m14:49:20.032685 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_stg_staging_intermediate__fx_rates_currency_iso_code.95d2907ece (execute): 14:49:20.032518 => 14:49:20.032525
[0m14:49:20.033427 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.not_null_stg_staging_intermediate__fx_rates_currency_iso_code.95d2907ece
[0m14:49:20.033788 [debug] [Thread-1 (]: Began running node test.vg_casestudy.not_null_stg_staging_intermediate__fx_rates_fx_rate.bec8509027
[0m14:49:20.034361 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.not_null_stg_staging_intermediate__fx_rates_currency_iso_code.95d2907ece, now test.vg_casestudy.not_null_stg_staging_intermediate__fx_rates_fx_rate.bec8509027)
[0m14:49:20.034675 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.not_null_stg_staging_intermediate__fx_rates_fx_rate.bec8509027
[0m14:49:20.038436 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.not_null_stg_staging_intermediate__fx_rates_fx_rate.bec8509027"
[0m14:49:20.039112 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_stg_staging_intermediate__fx_rates_fx_rate.bec8509027 (compile): 14:49:20.034900 => 14:49:20.038913
[0m14:49:20.039410 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.not_null_stg_staging_intermediate__fx_rates_fx_rate.bec8509027
[0m14:49:20.039769 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_stg_staging_intermediate__fx_rates_fx_rate.bec8509027 (execute): 14:49:20.039619 => 14:49:20.039625
[0m14:49:20.040444 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.not_null_stg_staging_intermediate__fx_rates_fx_rate.bec8509027
[0m14:49:20.040833 [debug] [Thread-1 (]: Began running node test.vg_casestudy.not_null_stg_staging_intermediate__fx_rates_fx_rate_date.0f5280bc57
[0m14:49:20.041391 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.not_null_stg_staging_intermediate__fx_rates_fx_rate.bec8509027, now test.vg_casestudy.not_null_stg_staging_intermediate__fx_rates_fx_rate_date.0f5280bc57)
[0m14:49:20.041701 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.not_null_stg_staging_intermediate__fx_rates_fx_rate_date.0f5280bc57
[0m14:49:20.045585 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.not_null_stg_staging_intermediate__fx_rates_fx_rate_date.0f5280bc57"
[0m14:49:20.046373 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_stg_staging_intermediate__fx_rates_fx_rate_date.0f5280bc57 (compile): 14:49:20.041921 => 14:49:20.046197
[0m14:49:20.046716 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.not_null_stg_staging_intermediate__fx_rates_fx_rate_date.0f5280bc57
[0m14:49:20.047107 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_stg_staging_intermediate__fx_rates_fx_rate_date.0f5280bc57 (execute): 14:49:20.046927 => 14:49:20.046934
[0m14:49:20.047836 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.not_null_stg_staging_intermediate__fx_rates_fx_rate_date.0f5280bc57
[0m14:49:20.048191 [debug] [Thread-1 (]: Began running node test.vg_casestudy.numeric_range_stg_staging_intermediate__fx_rates_fx_rate__0.2d4a929b3f
[0m14:49:20.048775 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.not_null_stg_staging_intermediate__fx_rates_fx_rate_date.0f5280bc57, now test.vg_casestudy.numeric_range_stg_staging_intermediate__fx_rates_fx_rate__0.2d4a929b3f)
[0m14:49:20.049096 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.numeric_range_stg_staging_intermediate__fx_rates_fx_rate__0.2d4a929b3f
[0m14:49:20.054408 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.numeric_range_stg_staging_intermediate__fx_rates_fx_rate__0.2d4a929b3f"
[0m14:49:20.055101 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.numeric_range_stg_staging_intermediate__fx_rates_fx_rate__0.2d4a929b3f (compile): 14:49:20.049318 => 14:49:20.054932
[0m14:49:20.055402 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.numeric_range_stg_staging_intermediate__fx_rates_fx_rate__0.2d4a929b3f
[0m14:49:20.055763 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.numeric_range_stg_staging_intermediate__fx_rates_fx_rate__0.2d4a929b3f (execute): 14:49:20.055608 => 14:49:20.055614
[0m14:49:20.056500 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.numeric_range_stg_staging_intermediate__fx_rates_fx_rate__0.2d4a929b3f
[0m14:49:20.056846 [debug] [Thread-1 (]: Began running node test.vg_casestudy.unique_stg_staging_intermediate__fx_rates_currency_iso_code.a28e4eee53
[0m14:49:20.057406 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.numeric_range_stg_staging_intermediate__fx_rates_fx_rate__0.2d4a929b3f, now test.vg_casestudy.unique_stg_staging_intermediate__fx_rates_currency_iso_code.a28e4eee53)
[0m14:49:20.057732 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.unique_stg_staging_intermediate__fx_rates_currency_iso_code.a28e4eee53
[0m14:49:20.061557 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.unique_stg_staging_intermediate__fx_rates_currency_iso_code.a28e4eee53"
[0m14:49:20.062351 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.unique_stg_staging_intermediate__fx_rates_currency_iso_code.a28e4eee53 (compile): 14:49:20.057950 => 14:49:20.062137
[0m14:49:20.062651 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.unique_stg_staging_intermediate__fx_rates_currency_iso_code.a28e4eee53
[0m14:49:20.063033 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.unique_stg_staging_intermediate__fx_rates_currency_iso_code.a28e4eee53 (execute): 14:49:20.062869 => 14:49:20.062875
[0m14:49:20.063861 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.unique_stg_staging_intermediate__fx_rates_currency_iso_code.a28e4eee53
[0m14:49:20.064222 [debug] [Thread-1 (]: Began running node analysis.vg_casestudy.sample_loan_data
[0m14:49:20.064807 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.unique_stg_staging_intermediate__fx_rates_currency_iso_code.a28e4eee53, now analysis.vg_casestudy.sample_loan_data)
[0m14:49:20.065117 [debug] [Thread-1 (]: Began compiling node analysis.vg_casestudy.sample_loan_data
[0m14:49:20.067812 [debug] [Thread-1 (]: Writing injected SQL for node "analysis.vg_casestudy.sample_loan_data"
[0m14:49:20.071720 [debug] [Thread-1 (]: Timing info for analysis.vg_casestudy.sample_loan_data (compile): 14:49:20.065338 => 14:49:20.071378
[0m14:49:20.072088 [debug] [Thread-1 (]: Began executing node analysis.vg_casestudy.sample_loan_data
[0m14:49:20.072455 [debug] [Thread-1 (]: Timing info for analysis.vg_casestudy.sample_loan_data (execute): 14:49:20.072300 => 14:49:20.072308
[0m14:49:20.073231 [debug] [Thread-1 (]: Finished running node analysis.vg_casestudy.sample_loan_data
[0m14:49:20.073588 [debug] [Thread-1 (]: Began running node test.vg_casestudy.accepted_values_stg_staging_intermediate__loans_loan_status__approved__rejected__closed.3143a4d227
[0m14:49:20.074150 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly analysis.vg_casestudy.sample_loan_data, now test.vg_casestudy.accepted_values_stg_staging_intermediate__loans_loan_status__approved__rejected__closed.3143a4d227)
[0m14:49:20.074466 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.accepted_values_stg_staging_intermediate__loans_loan_status__approved__rejected__closed.3143a4d227
[0m14:49:20.078584 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.accepted_values_stg_staging_intermediate__loans_loan_status__approved__rejected__closed.3143a4d227"
[0m14:49:20.079475 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.accepted_values_stg_staging_intermediate__loans_loan_status__approved__rejected__closed.3143a4d227 (compile): 14:49:20.074686 => 14:49:20.079257
[0m14:49:20.079928 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.accepted_values_stg_staging_intermediate__loans_loan_status__approved__rejected__closed.3143a4d227
[0m14:49:20.080328 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.accepted_values_stg_staging_intermediate__loans_loan_status__approved__rejected__closed.3143a4d227 (execute): 14:49:20.080163 => 14:49:20.080171
[0m14:49:20.081072 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.accepted_values_stg_staging_intermediate__loans_loan_status__approved__rejected__closed.3143a4d227
[0m14:49:20.081433 [debug] [Thread-1 (]: Began running node test.vg_casestudy.accepted_values_stg_staging_intermediate__loans_loan_term__12__24__36__48__60.5ea4cabc39
[0m14:49:20.082016 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.accepted_values_stg_staging_intermediate__loans_loan_status__approved__rejected__closed.3143a4d227, now test.vg_casestudy.accepted_values_stg_staging_intermediate__loans_loan_term__12__24__36__48__60.5ea4cabc39)
[0m14:49:20.082340 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.accepted_values_stg_staging_intermediate__loans_loan_term__12__24__36__48__60.5ea4cabc39
[0m14:49:20.086450 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.accepted_values_stg_staging_intermediate__loans_loan_term__12__24__36__48__60.5ea4cabc39"
[0m14:49:20.087179 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.accepted_values_stg_staging_intermediate__loans_loan_term__12__24__36__48__60.5ea4cabc39 (compile): 14:49:20.082568 => 14:49:20.086968
[0m14:49:20.087478 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.accepted_values_stg_staging_intermediate__loans_loan_term__12__24__36__48__60.5ea4cabc39
[0m14:49:20.087855 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.accepted_values_stg_staging_intermediate__loans_loan_term__12__24__36__48__60.5ea4cabc39 (execute): 14:49:20.087699 => 14:49:20.087706
[0m14:49:20.088582 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.accepted_values_stg_staging_intermediate__loans_loan_term__12__24__36__48__60.5ea4cabc39
[0m14:49:20.088949 [debug] [Thread-1 (]: Began running node test.vg_casestudy.date_is_past_stg_staging_intermediate__loans_approval_rejection_date.61c247afe7
[0m14:49:20.089503 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.accepted_values_stg_staging_intermediate__loans_loan_term__12__24__36__48__60.5ea4cabc39, now test.vg_casestudy.date_is_past_stg_staging_intermediate__loans_approval_rejection_date.61c247afe7)
[0m14:49:20.089830 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.date_is_past_stg_staging_intermediate__loans_approval_rejection_date.61c247afe7
[0m14:49:20.093642 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.date_is_past_stg_staging_intermediate__loans_approval_rejection_date.61c247afe7"
[0m14:49:20.094355 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.date_is_past_stg_staging_intermediate__loans_approval_rejection_date.61c247afe7 (compile): 14:49:20.090055 => 14:49:20.094171
[0m14:49:20.094698 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.date_is_past_stg_staging_intermediate__loans_approval_rejection_date.61c247afe7
[0m14:49:20.095062 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.date_is_past_stg_staging_intermediate__loans_approval_rejection_date.61c247afe7 (execute): 14:49:20.094902 => 14:49:20.094908
[0m14:49:20.095775 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.date_is_past_stg_staging_intermediate__loans_approval_rejection_date.61c247afe7
[0m14:49:20.096128 [debug] [Thread-1 (]: Began running node test.vg_casestudy.not_null_stg_staging_intermediate__loans_approval_rejection_date.28f5951b2f
[0m14:49:20.096775 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.date_is_past_stg_staging_intermediate__loans_approval_rejection_date.61c247afe7, now test.vg_casestudy.not_null_stg_staging_intermediate__loans_approval_rejection_date.28f5951b2f)
[0m14:49:20.097118 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.not_null_stg_staging_intermediate__loans_approval_rejection_date.28f5951b2f
[0m14:49:20.101072 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.not_null_stg_staging_intermediate__loans_approval_rejection_date.28f5951b2f"
[0m14:49:20.101778 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_stg_staging_intermediate__loans_approval_rejection_date.28f5951b2f (compile): 14:49:20.097347 => 14:49:20.101580
[0m14:49:20.102107 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.not_null_stg_staging_intermediate__loans_approval_rejection_date.28f5951b2f
[0m14:49:20.102483 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_stg_staging_intermediate__loans_approval_rejection_date.28f5951b2f (execute): 14:49:20.102325 => 14:49:20.102330
[0m14:49:20.103167 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.not_null_stg_staging_intermediate__loans_approval_rejection_date.28f5951b2f
[0m14:49:20.103557 [debug] [Thread-1 (]: Began running node test.vg_casestudy.not_null_stg_staging_intermediate__loans_interest_rate.290100bb78
[0m14:49:20.104121 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.not_null_stg_staging_intermediate__loans_approval_rejection_date.28f5951b2f, now test.vg_casestudy.not_null_stg_staging_intermediate__loans_interest_rate.290100bb78)
[0m14:49:20.104426 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.not_null_stg_staging_intermediate__loans_interest_rate.290100bb78
[0m14:49:20.108355 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.not_null_stg_staging_intermediate__loans_interest_rate.290100bb78"
[0m14:49:20.109274 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_stg_staging_intermediate__loans_interest_rate.290100bb78 (compile): 14:49:20.104697 => 14:49:20.109073
[0m14:49:20.109615 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.not_null_stg_staging_intermediate__loans_interest_rate.290100bb78
[0m14:49:20.110007 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_stg_staging_intermediate__loans_interest_rate.290100bb78 (execute): 14:49:20.109840 => 14:49:20.109847
[0m14:49:20.110711 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.not_null_stg_staging_intermediate__loans_interest_rate.290100bb78
[0m14:49:20.111063 [debug] [Thread-1 (]: Began running node test.vg_casestudy.not_null_stg_staging_intermediate__loans_loan_amount.3aa0f79ca3
[0m14:49:20.111683 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.not_null_stg_staging_intermediate__loans_interest_rate.290100bb78, now test.vg_casestudy.not_null_stg_staging_intermediate__loans_loan_amount.3aa0f79ca3)
[0m14:49:20.112006 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.not_null_stg_staging_intermediate__loans_loan_amount.3aa0f79ca3
[0m14:49:20.115837 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.not_null_stg_staging_intermediate__loans_loan_amount.3aa0f79ca3"
[0m14:49:20.116576 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_stg_staging_intermediate__loans_loan_amount.3aa0f79ca3 (compile): 14:49:20.112245 => 14:49:20.116371
[0m14:49:20.116884 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.not_null_stg_staging_intermediate__loans_loan_amount.3aa0f79ca3
[0m14:49:20.117250 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_stg_staging_intermediate__loans_loan_amount.3aa0f79ca3 (execute): 14:49:20.117094 => 14:49:20.117100
[0m14:49:20.117941 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.not_null_stg_staging_intermediate__loans_loan_amount.3aa0f79ca3
[0m14:49:20.118303 [debug] [Thread-1 (]: Began running node test.vg_casestudy.not_null_stg_staging_intermediate__loans_loan_id.bbf464e57e
[0m14:49:20.118872 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.not_null_stg_staging_intermediate__loans_loan_amount.3aa0f79ca3, now test.vg_casestudy.not_null_stg_staging_intermediate__loans_loan_id.bbf464e57e)
[0m14:49:20.119188 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.not_null_stg_staging_intermediate__loans_loan_id.bbf464e57e
[0m14:49:20.122978 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.not_null_stg_staging_intermediate__loans_loan_id.bbf464e57e"
[0m14:49:20.123693 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_stg_staging_intermediate__loans_loan_id.bbf464e57e (compile): 14:49:20.119412 => 14:49:20.123492
[0m14:49:20.123987 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.not_null_stg_staging_intermediate__loans_loan_id.bbf464e57e
[0m14:49:20.124449 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_stg_staging_intermediate__loans_loan_id.bbf464e57e (execute): 14:49:20.124238 => 14:49:20.124245
[0m14:49:20.125348 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.not_null_stg_staging_intermediate__loans_loan_id.bbf464e57e
[0m14:49:20.125715 [debug] [Thread-1 (]: Began running node test.vg_casestudy.not_null_stg_staging_intermediate__loans_loan_status.6519e56cae
[0m14:49:20.126320 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.not_null_stg_staging_intermediate__loans_loan_id.bbf464e57e, now test.vg_casestudy.not_null_stg_staging_intermediate__loans_loan_status.6519e56cae)
[0m14:49:20.126646 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.not_null_stg_staging_intermediate__loans_loan_status.6519e56cae
[0m14:49:20.132354 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.not_null_stg_staging_intermediate__loans_loan_status.6519e56cae"
[0m14:49:20.132903 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_stg_staging_intermediate__loans_loan_status.6519e56cae (compile): 14:49:20.126872 => 14:49:20.132738
[0m14:49:20.133208 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.not_null_stg_staging_intermediate__loans_loan_status.6519e56cae
[0m14:49:20.133638 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_stg_staging_intermediate__loans_loan_status.6519e56cae (execute): 14:49:20.133479 => 14:49:20.133486
[0m14:49:20.134365 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.not_null_stg_staging_intermediate__loans_loan_status.6519e56cae
[0m14:49:20.134738 [debug] [Thread-1 (]: Began running node test.vg_casestudy.not_null_stg_staging_intermediate__loans_loan_term.c98571f396
[0m14:49:20.135297 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.not_null_stg_staging_intermediate__loans_loan_status.6519e56cae, now test.vg_casestudy.not_null_stg_staging_intermediate__loans_loan_term.c98571f396)
[0m14:49:20.135622 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.not_null_stg_staging_intermediate__loans_loan_term.c98571f396
[0m14:49:20.139297 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.not_null_stg_staging_intermediate__loans_loan_term.c98571f396"
[0m14:49:20.139991 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_stg_staging_intermediate__loans_loan_term.c98571f396 (compile): 14:49:20.135847 => 14:49:20.139799
[0m14:49:20.140357 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.not_null_stg_staging_intermediate__loans_loan_term.c98571f396
[0m14:49:20.140859 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_stg_staging_intermediate__loans_loan_term.c98571f396 (execute): 14:49:20.140684 => 14:49:20.140691
[0m14:49:20.141625 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.not_null_stg_staging_intermediate__loans_loan_term.c98571f396
[0m14:49:20.141989 [debug] [Thread-1 (]: Began running node test.vg_casestudy.numeric_range_stg_staging_intermediate__loans_interest_rate__0.049a21d6b9
[0m14:49:20.142591 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.not_null_stg_staging_intermediate__loans_loan_term.c98571f396, now test.vg_casestudy.numeric_range_stg_staging_intermediate__loans_interest_rate__0.049a21d6b9)
[0m14:49:20.142919 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.numeric_range_stg_staging_intermediate__loans_interest_rate__0.049a21d6b9
[0m14:49:20.146658 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.numeric_range_stg_staging_intermediate__loans_interest_rate__0.049a21d6b9"
[0m14:49:20.147404 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.numeric_range_stg_staging_intermediate__loans_interest_rate__0.049a21d6b9 (compile): 14:49:20.143151 => 14:49:20.147203
[0m14:49:20.147710 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.numeric_range_stg_staging_intermediate__loans_interest_rate__0.049a21d6b9
[0m14:49:20.148091 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.numeric_range_stg_staging_intermediate__loans_interest_rate__0.049a21d6b9 (execute): 14:49:20.147930 => 14:49:20.147937
[0m14:49:20.148791 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.numeric_range_stg_staging_intermediate__loans_interest_rate__0.049a21d6b9
[0m14:49:20.149160 [debug] [Thread-1 (]: Began running node test.vg_casestudy.numeric_range_stg_staging_intermediate__loans_loan_amount__0.68f9ee0c26
[0m14:49:20.149729 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.numeric_range_stg_staging_intermediate__loans_interest_rate__0.049a21d6b9, now test.vg_casestudy.numeric_range_stg_staging_intermediate__loans_loan_amount__0.68f9ee0c26)
[0m14:49:20.150042 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.numeric_range_stg_staging_intermediate__loans_loan_amount__0.68f9ee0c26
[0m14:49:20.153795 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.numeric_range_stg_staging_intermediate__loans_loan_amount__0.68f9ee0c26"
[0m14:49:20.154500 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.numeric_range_stg_staging_intermediate__loans_loan_amount__0.68f9ee0c26 (compile): 14:49:20.150276 => 14:49:20.154296
[0m14:49:20.154808 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.numeric_range_stg_staging_intermediate__loans_loan_amount__0.68f9ee0c26
[0m14:49:20.155185 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.numeric_range_stg_staging_intermediate__loans_loan_amount__0.68f9ee0c26 (execute): 14:49:20.155026 => 14:49:20.155032
[0m14:49:20.156096 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.numeric_range_stg_staging_intermediate__loans_loan_amount__0.68f9ee0c26
[0m14:49:20.156481 [debug] [Thread-1 (]: Began running node test.vg_casestudy.unique_stg_staging_intermediate__loans_loan_id.7800e8cbcc
[0m14:49:20.157080 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.numeric_range_stg_staging_intermediate__loans_loan_amount__0.68f9ee0c26, now test.vg_casestudy.unique_stg_staging_intermediate__loans_loan_id.7800e8cbcc)
[0m14:49:20.157402 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.unique_stg_staging_intermediate__loans_loan_id.7800e8cbcc
[0m14:49:20.161067 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.unique_stg_staging_intermediate__loans_loan_id.7800e8cbcc"
[0m14:49:20.161885 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.unique_stg_staging_intermediate__loans_loan_id.7800e8cbcc (compile): 14:49:20.157635 => 14:49:20.161665
[0m14:49:20.162191 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.unique_stg_staging_intermediate__loans_loan_id.7800e8cbcc
[0m14:49:20.162554 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.unique_stg_staging_intermediate__loans_loan_id.7800e8cbcc (execute): 14:49:20.162397 => 14:49:20.162403
[0m14:49:20.163337 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.unique_stg_staging_intermediate__loans_loan_id.7800e8cbcc
[0m14:49:20.163760 [debug] [Thread-1 (]: Began running node test.vg_casestudy.not_null_stg_staging_intermediate__currencies_currency_iso_code.f7ebb4618b
[0m14:49:20.164333 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.unique_stg_staging_intermediate__loans_loan_id.7800e8cbcc, now test.vg_casestudy.not_null_stg_staging_intermediate__currencies_currency_iso_code.f7ebb4618b)
[0m14:49:20.164638 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.not_null_stg_staging_intermediate__currencies_currency_iso_code.f7ebb4618b
[0m14:49:20.168439 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.not_null_stg_staging_intermediate__currencies_currency_iso_code.f7ebb4618b"
[0m14:49:20.169161 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_stg_staging_intermediate__currencies_currency_iso_code.f7ebb4618b (compile): 14:49:20.164879 => 14:49:20.168953
[0m14:49:20.169460 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.not_null_stg_staging_intermediate__currencies_currency_iso_code.f7ebb4618b
[0m14:49:20.169831 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_stg_staging_intermediate__currencies_currency_iso_code.f7ebb4618b (execute): 14:49:20.169670 => 14:49:20.169676
[0m14:49:20.170524 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.not_null_stg_staging_intermediate__currencies_currency_iso_code.f7ebb4618b
[0m14:49:20.170889 [debug] [Thread-1 (]: Began running node test.vg_casestudy.unique_stg_staging_intermediate__currencies_currency_iso_code.4396247af3
[0m14:49:20.171623 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.not_null_stg_staging_intermediate__currencies_currency_iso_code.f7ebb4618b, now test.vg_casestudy.unique_stg_staging_intermediate__currencies_currency_iso_code.4396247af3)
[0m14:49:20.171991 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.unique_stg_staging_intermediate__currencies_currency_iso_code.4396247af3
[0m14:49:20.176509 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.unique_stg_staging_intermediate__currencies_currency_iso_code.4396247af3"
[0m14:49:20.177463 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.unique_stg_staging_intermediate__currencies_currency_iso_code.4396247af3 (compile): 14:49:20.172220 => 14:49:20.177231
[0m14:49:20.177778 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.unique_stg_staging_intermediate__currencies_currency_iso_code.4396247af3
[0m14:49:20.178159 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.unique_stg_staging_intermediate__currencies_currency_iso_code.4396247af3 (execute): 14:49:20.177996 => 14:49:20.178003
[0m14:49:20.178895 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.unique_stg_staging_intermediate__currencies_currency_iso_code.4396247af3
[0m14:49:20.179283 [debug] [Thread-1 (]: Began running node test.vg_casestudy.not_null_stg_staging_intermediate__transactions_transaction_amount.8dc65a17fe
[0m14:49:20.179854 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.unique_stg_staging_intermediate__currencies_currency_iso_code.4396247af3, now test.vg_casestudy.not_null_stg_staging_intermediate__transactions_transaction_amount.8dc65a17fe)
[0m14:49:20.180342 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.not_null_stg_staging_intermediate__transactions_transaction_amount.8dc65a17fe
[0m14:49:20.184603 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.not_null_stg_staging_intermediate__transactions_transaction_amount.8dc65a17fe"
[0m14:49:20.185168 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_stg_staging_intermediate__transactions_transaction_amount.8dc65a17fe (compile): 14:49:20.180578 => 14:49:20.184991
[0m14:49:20.185488 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.not_null_stg_staging_intermediate__transactions_transaction_amount.8dc65a17fe
[0m14:49:20.185858 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_stg_staging_intermediate__transactions_transaction_amount.8dc65a17fe (execute): 14:49:20.185701 => 14:49:20.185708
[0m14:49:20.186564 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.not_null_stg_staging_intermediate__transactions_transaction_amount.8dc65a17fe
[0m14:49:20.186938 [debug] [Thread-1 (]: Began running node test.vg_casestudy.not_null_stg_staging_intermediate__transactions_transaction_id.cb7402fe02
[0m14:49:20.187537 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.not_null_stg_staging_intermediate__transactions_transaction_amount.8dc65a17fe, now test.vg_casestudy.not_null_stg_staging_intermediate__transactions_transaction_id.cb7402fe02)
[0m14:49:20.187919 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.not_null_stg_staging_intermediate__transactions_transaction_id.cb7402fe02
[0m14:49:20.192367 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.not_null_stg_staging_intermediate__transactions_transaction_id.cb7402fe02"
[0m14:49:20.193286 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_stg_staging_intermediate__transactions_transaction_id.cb7402fe02 (compile): 14:49:20.188193 => 14:49:20.193008
[0m14:49:20.193610 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.not_null_stg_staging_intermediate__transactions_transaction_id.cb7402fe02
[0m14:49:20.194001 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_stg_staging_intermediate__transactions_transaction_id.cb7402fe02 (execute): 14:49:20.193834 => 14:49:20.193841
[0m14:49:20.194993 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.not_null_stg_staging_intermediate__transactions_transaction_id.cb7402fe02
[0m14:49:20.195366 [debug] [Thread-1 (]: Began running node test.vg_casestudy.numeric_range_stg_staging_intermediate__transactions_transaction_amount__0.789e7a4361
[0m14:49:20.195945 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.not_null_stg_staging_intermediate__transactions_transaction_id.cb7402fe02, now test.vg_casestudy.numeric_range_stg_staging_intermediate__transactions_transaction_amount__0.789e7a4361)
[0m14:49:20.196270 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.numeric_range_stg_staging_intermediate__transactions_transaction_amount__0.789e7a4361
[0m14:49:20.202339 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.numeric_range_stg_staging_intermediate__transactions_transaction_amount__0.789e7a4361"
[0m14:49:20.202953 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.numeric_range_stg_staging_intermediate__transactions_transaction_amount__0.789e7a4361 (compile): 14:49:20.196512 => 14:49:20.202772
[0m14:49:20.203325 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.numeric_range_stg_staging_intermediate__transactions_transaction_amount__0.789e7a4361
[0m14:49:20.203738 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.numeric_range_stg_staging_intermediate__transactions_transaction_amount__0.789e7a4361 (execute): 14:49:20.203570 => 14:49:20.203577
[0m14:49:20.204469 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.numeric_range_stg_staging_intermediate__transactions_transaction_amount__0.789e7a4361
[0m14:49:20.204866 [debug] [Thread-1 (]: Began running node test.vg_casestudy.unique_stg_staging_intermediate__transactions_transaction_id.dbfd7b9b66
[0m14:49:20.205437 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.numeric_range_stg_staging_intermediate__transactions_transaction_amount__0.789e7a4361, now test.vg_casestudy.unique_stg_staging_intermediate__transactions_transaction_id.dbfd7b9b66)
[0m14:49:20.205786 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.unique_stg_staging_intermediate__transactions_transaction_id.dbfd7b9b66
[0m14:49:20.209381 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.unique_stg_staging_intermediate__transactions_transaction_id.dbfd7b9b66"
[0m14:49:20.210090 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.unique_stg_staging_intermediate__transactions_transaction_id.dbfd7b9b66 (compile): 14:49:20.206012 => 14:49:20.209890
[0m14:49:20.210386 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.unique_stg_staging_intermediate__transactions_transaction_id.dbfd7b9b66
[0m14:49:20.210759 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.unique_stg_staging_intermediate__transactions_transaction_id.dbfd7b9b66 (execute): 14:49:20.210597 => 14:49:20.210603
[0m14:49:20.211450 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.unique_stg_staging_intermediate__transactions_transaction_id.dbfd7b9b66
[0m14:49:20.212985 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:49:20.213374 [debug] [MainThread]: Connection 'test.vg_casestudy.unique_stg_staging_intermediate__transactions_transaction_id.dbfd7b9b66' was properly closed.
[0m14:49:20.221244 [debug] [MainThread]: Command end result
[0m14:49:20.251939 [debug] [MainThread]: Acquiring new duckdb connection 'generate_catalog'
[0m14:49:20.252321 [info ] [MainThread]: Building catalog
[0m14:49:20.255124 [debug] [ThreadPool]: Acquiring new duckdb connection 'casestudy.information_schema'
[0m14:49:20.261222 [debug] [ThreadPool]: Using duckdb connection "casestudy.information_schema"
[0m14:49:20.261723 [debug] [ThreadPool]: On casestudy.information_schema: BEGIN
[0m14:49:20.262094 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:49:20.277125 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:49:20.277544 [debug] [ThreadPool]: Using duckdb connection "casestudy.information_schema"
[0m14:49:20.277840 [debug] [ThreadPool]: On casestudy.information_schema: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "casestudy.information_schema"} */
select
        'casestudy' as table_database,
        t.table_schema,
        t.table_name,
        t.table_type,
        '' as table_comment,
        c.column_name,
        c.ordinal_position as column_index,
        c.data_type column_type,
        '' as column_comment,
        '' as table_owner
    FROM information_schema.tables t JOIN information_schema.columns c ON t.table_schema = c.table_schema AND t.table_name = c.table_name
    WHERE (upper(t.table_schema) = upper('raw') or upper(t.table_schema) = upper('intermediate') or upper(t.table_schema) = upper('staging'))
    AND t.table_type IN ('BASE TABLE', 'VIEW')
    ORDER BY
        t.table_schema,
        t.table_name,
        c.ordinal_position
[0m14:49:20.295418 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:49:20.303601 [debug] [ThreadPool]: On casestudy.information_schema: ROLLBACK
[0m14:49:20.304147 [debug] [ThreadPool]: Failed to rollback 'casestudy.information_schema'
[0m14:49:20.304440 [debug] [ThreadPool]: On casestudy.information_schema: Close
[0m14:49:20.328673 [info ] [MainThread]: Catalog written to /workspaces/vg_case_study_tim/transformation/target/catalog.json
[0m14:49:20.329498 [debug] [MainThread]: Command `dbt docs generate` succeeded at 14:49:20.329380 after 1.36 seconds
[0m14:49:20.329816 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m14:49:20.330073 [debug] [MainThread]: Connection 'casestudy.information_schema' was properly closed.
[0m14:49:20.330374 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe4dcaf74d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe4e1b92650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe4dd4534d0>]}
[0m14:49:20.330758 [debug] [MainThread]: Flushing usage events
[0m14:49:31.275710 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f313e685710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f313e4cf690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f313e66e110>]}


============================== 14:49:31.278925 | 28a73fc8-4153-441a-9a86-d57f77d9be57 ==============================
[0m14:49:31.278925 [info ] [MainThread]: Running with dbt=1.6.18
[0m14:49:31.279586 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/workspaces/vg_case_study_tim/transformation/logs', 'debug': 'False', 'profiles_dir': '/workspaces/vg_case_study_tim/transformation', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt docs serve', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:49:31.396326 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '28a73fc8-4153-441a-9a86-d57f77d9be57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f313e4e7490>]}
[0m14:49:31.412376 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '28a73fc8-4153-441a-9a86-d57f77d9be57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3140147a90>]}
[0m03:35:53.257620 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7af32a9750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7af34102d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7af33d8150>]}


============================== 03:35:53.261900 | 89fa9f91-35ff-40cb-bc95-45ef446e59f7 ==============================
[0m03:35:53.261900 [info ] [MainThread]: Running with dbt=1.6.18
[0m03:35:53.262514 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/workspaces/vg_case_study_tim/transformation/logs', 'profiles_dir': '/workspaces/vg_case_study_tim/transformation', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt debug', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m03:35:53.262909 [info ] [MainThread]: dbt version: 1.6.18
[0m03:35:53.263272 [info ] [MainThread]: python version: 3.11.6
[0m03:35:53.263605 [info ] [MainThread]: python path: /usr/local/bin/python
[0m03:35:53.263913 [info ] [MainThread]: os info: Linux-5.15.153.1-microsoft-standard-WSL2-x86_64-with-glibc2.31
[0m03:35:53.382819 [info ] [MainThread]: Using profiles dir at /workspaces/vg_case_study_tim/transformation
[0m03:35:53.383317 [info ] [MainThread]: Using profiles.yml file at /workspaces/vg_case_study_tim/transformation/profiles.yml
[0m03:35:53.383671 [info ] [MainThread]: Using dbt_project.yml file at /workspaces/vg_case_study_tim/transformation/dbt_project.yml
[0m03:35:53.384625 [info ] [MainThread]: adapter type: duckdb
[0m03:35:53.384989 [info ] [MainThread]: adapter version: 1.6.2
[0m03:35:53.421016 [info ] [MainThread]: Configuration:
[0m03:35:53.421515 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m03:35:53.421870 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m03:35:53.422176 [info ] [MainThread]: Required dependencies:
[0m03:35:53.422560 [debug] [MainThread]: Executing "git --help"
[0m03:35:53.424463 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m03:35:53.424944 [debug] [MainThread]: STDERR: "b''"
[0m03:35:53.425262 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m03:35:53.425590 [info ] [MainThread]: Connection:
[0m03:35:53.425887 [info ] [MainThread]:   database: casestudy
[0m03:35:53.426197 [info ] [MainThread]:   schema: main
[0m03:35:53.426506 [info ] [MainThread]:   path: casestudy.duckdb
[0m03:35:53.426927 [info ] [MainThread]:   config_options: None
[0m03:35:53.427236 [info ] [MainThread]:   extensions: ['icu']
[0m03:35:53.427510 [info ] [MainThread]:   settings: None
[0m03:35:53.427802 [info ] [MainThread]:   external_root: .
[0m03:35:53.428121 [info ] [MainThread]:   use_credential_provider: None
[0m03:35:53.428511 [info ] [MainThread]:   attach: None
[0m03:35:53.428876 [info ] [MainThread]:   filesystems: None
[0m03:35:53.429300 [info ] [MainThread]:   remote: None
[0m03:35:53.429857 [info ] [MainThread]:   plugins: None
[0m03:35:53.430348 [info ] [MainThread]:   disable_transactions: False
[0m03:35:53.430846 [info ] [MainThread]: Registered adapter: duckdb=1.6.2
[0m03:35:53.431664 [debug] [MainThread]: Acquiring new duckdb connection 'debug'
[0m03:35:53.432031 [debug] [MainThread]: Using duckdb connection "debug"
[0m03:35:53.432418 [debug] [MainThread]: On debug: select 1 as id
[0m03:35:53.432824 [debug] [MainThread]: Opening a new connection, currently in state init
[0m03:35:53.561709 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m03:35:53.562996 [debug] [MainThread]: On debug: Close
[0m03:35:53.566971 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m03:35:53.567540 [info ] [MainThread]: [32mAll checks passed![0m
[0m03:35:53.568140 [debug] [MainThread]: Command `dbt debug` succeeded at 03:35:53.568004 after 0.32 seconds
[0m03:35:53.568567 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m03:35:53.568984 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7af3262bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7af79e5bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7af56253d0>]}
[0m03:35:53.569387 [debug] [MainThread]: Flushing usage events
[0m05:42:00.210869 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f24c2f815d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f24c2dd0890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f24c2afc150>]}


============================== 05:42:00.216117 | 5e6b65a8-9c36-4e9b-be9e-cc48704d7f3e ==============================
[0m05:42:00.216117 [info ] [MainThread]: Running with dbt=1.6.18
[0m05:42:00.216636 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/workspaces/vg_case_study_tim/transformation', 'log_path': '/workspaces/vg_case_study_tim/transformation/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt debug', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m05:42:00.217121 [info ] [MainThread]: dbt version: 1.6.18
[0m05:42:00.217485 [info ] [MainThread]: python version: 3.11.6
[0m05:42:00.217828 [info ] [MainThread]: python path: /usr/local/bin/python
[0m05:42:00.218240 [info ] [MainThread]: os info: Linux-5.15.153.1-microsoft-standard-WSL2-x86_64-with-glibc2.31
[0m05:42:00.339660 [info ] [MainThread]: Using profiles dir at /workspaces/vg_case_study_tim/transformation
[0m05:42:00.340179 [info ] [MainThread]: Using profiles.yml file at /workspaces/vg_case_study_tim/transformation/profiles.yml
[0m05:42:00.340577 [info ] [MainThread]: Using dbt_project.yml file at /workspaces/vg_case_study_tim/transformation/dbt_project.yml
[0m05:42:00.341637 [info ] [MainThread]: adapter type: duckdb
[0m05:42:00.342020 [info ] [MainThread]: adapter version: 1.6.2
[0m05:42:00.375136 [info ] [MainThread]: Configuration:
[0m05:42:00.375648 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m05:42:00.376089 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m05:42:00.376422 [info ] [MainThread]: Required dependencies:
[0m05:42:00.376734 [debug] [MainThread]: Executing "git --help"
[0m05:42:00.378442 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m05:42:00.378977 [debug] [MainThread]: STDERR: "b''"
[0m05:42:00.379301 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m05:42:00.379641 [info ] [MainThread]: Connection:
[0m05:42:00.379998 [info ] [MainThread]:   database: casestudy
[0m05:42:00.380384 [info ] [MainThread]:   schema: main
[0m05:42:00.380802 [info ] [MainThread]:   path: casestudy.duckdb
[0m05:42:00.381102 [info ] [MainThread]:   config_options: None
[0m05:42:00.381379 [info ] [MainThread]:   extensions: ['icu']
[0m05:42:00.381743 [info ] [MainThread]:   settings: None
[0m05:42:00.382174 [info ] [MainThread]:   external_root: .
[0m05:42:00.382582 [info ] [MainThread]:   use_credential_provider: None
[0m05:42:00.383016 [info ] [MainThread]:   attach: None
[0m05:42:00.383505 [info ] [MainThread]:   filesystems: None
[0m05:42:00.383993 [info ] [MainThread]:   remote: None
[0m05:42:00.384325 [info ] [MainThread]:   plugins: None
[0m05:42:00.384616 [info ] [MainThread]:   disable_transactions: False
[0m05:42:00.384996 [info ] [MainThread]: Registered adapter: duckdb=1.6.2
[0m05:42:00.385565 [debug] [MainThread]: Acquiring new duckdb connection 'debug'
[0m05:42:00.385877 [debug] [MainThread]: Using duckdb connection "debug"
[0m05:42:00.386185 [debug] [MainThread]: On debug: select 1 as id
[0m05:42:00.386464 [debug] [MainThread]: Opening a new connection, currently in state init
[0m05:42:00.512576 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m05:42:00.513666 [debug] [MainThread]: On debug: Close
[0m05:42:00.517118 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m05:42:00.517744 [info ] [MainThread]: [32mAll checks passed![0m
[0m05:42:00.518320 [debug] [MainThread]: Command `dbt debug` succeeded at 05:42:00.518210 after 0.32 seconds
[0m05:42:00.518680 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m05:42:00.519064 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f24c2cad490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f24c77b72d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f24c4915490>]}
[0m05:42:00.519469 [debug] [MainThread]: Flushing usage events
[0m09:30:40.601352 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee40feb810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee4108c910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee41319b10>]}


============================== 09:30:40.606898 | 88cf7907-557b-421f-b00a-ea7228b43b7e ==============================
[0m09:30:40.606898 [info ] [MainThread]: Running with dbt=1.6.18
[0m09:30:40.607475 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/workspaces/vg_case_study_tim/transformation/logs', 'profiles_dir': '/workspaces/vg_case_study_tim/transformation', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt seed --select fx_rates_full_history', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m09:30:40.811546 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '88cf7907-557b-421f-b00a-ea7228b43b7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee411d3010>]}
[0m09:30:40.826516 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '88cf7907-557b-421f-b00a-ea7228b43b7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee40d90b90>]}
[0m09:30:40.828085 [info ] [MainThread]: Registered adapter: duckdb=1.6.2
[0m09:30:40.857854 [debug] [MainThread]: checksum: 7b9fab86a08e9e96a48a825af743c566d95b877e068b8c6d0dbafbf714447189, vars: {}, profile: , target: , version: 1.6.18
[0m09:30:40.952478 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m09:30:40.953199 [debug] [MainThread]: Partial parsing: added file: vg_casestudy://seeds/fx_rates_full_history.csv
[0m09:30:40.998618 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.vg_casestudy.main
- models.vg_casestudy.marts
- models.vg_casestudy.reporting
[0m09:30:41.005350 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '88cf7907-557b-421f-b00a-ea7228b43b7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee40d8e050>]}
[0m09:30:41.073290 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '88cf7907-557b-421f-b00a-ea7228b43b7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee3d6ec4d0>]}
[0m09:30:41.073843 [info ] [MainThread]: Found 11 models, 1 analysis, 3 seeds, 71 tests, 5 sources, 0 exposures, 0 metrics, 632 macros, 0 groups, 0 semantic models
[0m09:30:41.074235 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '88cf7907-557b-421f-b00a-ea7228b43b7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee40d81310>]}
[0m09:30:41.076448 [info ] [MainThread]: 
[0m09:30:41.077233 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m09:30:41.078328 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_casestudy'
[0m09:30:41.091161 [debug] [ThreadPool]: Using duckdb connection "list_casestudy"
[0m09:30:41.091603 [debug] [ThreadPool]: On list_casestudy: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"casestudy"'
    
  
  
[0m09:30:41.091962 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:30:41.224718 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m09:30:41.226311 [debug] [ThreadPool]: On list_casestudy: Close
[0m09:30:41.230306 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy, now create_casestudy_raw)
[0m09:30:41.231072 [debug] [ThreadPool]: Creating schema "database: "casestudy"
schema: "raw"
"
[0m09:30:41.235565 [debug] [ThreadPool]: Using duckdb connection "create_casestudy_raw"
[0m09:30:41.235981 [debug] [ThreadPool]: On create_casestudy_raw: BEGIN
[0m09:30:41.236266 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:30:41.249391 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m09:30:41.249868 [debug] [ThreadPool]: Using duckdb connection "create_casestudy_raw"
[0m09:30:41.250163 [debug] [ThreadPool]: On create_casestudy_raw: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "create_casestudy_raw"} */
create schema if not exists "casestudy"."raw"
[0m09:30:41.250788 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m09:30:41.251708 [debug] [ThreadPool]: On create_casestudy_raw: COMMIT
[0m09:30:41.252026 [debug] [ThreadPool]: Using duckdb connection "create_casestudy_raw"
[0m09:30:41.252291 [debug] [ThreadPool]: On create_casestudy_raw: COMMIT
[0m09:30:41.252895 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m09:30:41.253232 [debug] [ThreadPool]: On create_casestudy_raw: Close
[0m09:30:41.258465 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_casestudy_raw, now list_casestudy_intermediate)
[0m09:30:41.264130 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_intermediate"
[0m09:30:41.264523 [debug] [ThreadPool]: On list_casestudy_intermediate: BEGIN
[0m09:30:41.264795 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:30:41.276180 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m09:30:41.276662 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_intermediate"
[0m09:30:41.276971 [debug] [ThreadPool]: On list_casestudy_intermediate: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_intermediate"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'intermediate'
    and table_catalog = 'casestudy'
  
[0m09:30:41.294107 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m09:30:41.295705 [debug] [ThreadPool]: On list_casestudy_intermediate: ROLLBACK
[0m09:30:41.297555 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_intermediate'
[0m09:30:41.297874 [debug] [ThreadPool]: On list_casestudy_intermediate: Close
[0m09:30:41.301023 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy_intermediate, now list_casestudy_staging)
[0m09:30:41.303186 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_staging"
[0m09:30:41.303524 [debug] [ThreadPool]: On list_casestudy_staging: BEGIN
[0m09:30:41.303837 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:30:41.314497 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m09:30:41.314927 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_staging"
[0m09:30:41.315213 [debug] [ThreadPool]: On list_casestudy_staging: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_staging"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'staging'
    and table_catalog = 'casestudy'
  
[0m09:30:41.323420 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m09:30:41.324836 [debug] [ThreadPool]: On list_casestudy_staging: ROLLBACK
[0m09:30:41.325334 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_staging'
[0m09:30:41.325604 [debug] [ThreadPool]: On list_casestudy_staging: Close
[0m09:30:41.328426 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy_staging, now list_casestudy_raw)
[0m09:30:41.330712 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_raw"
[0m09:30:41.331069 [debug] [ThreadPool]: On list_casestudy_raw: BEGIN
[0m09:30:41.331397 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:30:41.341962 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m09:30:41.342357 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_raw"
[0m09:30:41.342646 [debug] [ThreadPool]: On list_casestudy_raw: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_raw"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'raw'
    and table_catalog = 'casestudy'
  
[0m09:30:41.350743 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m09:30:41.352021 [debug] [ThreadPool]: On list_casestudy_raw: ROLLBACK
[0m09:30:41.352471 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_raw'
[0m09:30:41.352732 [debug] [ThreadPool]: On list_casestudy_raw: Close
[0m09:30:41.356783 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '88cf7907-557b-421f-b00a-ea7228b43b7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee41effa10>]}
[0m09:30:41.357330 [debug] [MainThread]: Using duckdb connection "master"
[0m09:30:41.357658 [debug] [MainThread]: On master: BEGIN
[0m09:30:41.357953 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:30:41.371181 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m09:30:41.371593 [debug] [MainThread]: On master: COMMIT
[0m09:30:41.371928 [debug] [MainThread]: Using duckdb connection "master"
[0m09:30:41.372192 [debug] [MainThread]: On master: COMMIT
[0m09:30:41.372755 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m09:30:41.373050 [debug] [MainThread]: On master: Close
[0m09:30:41.375536 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:30:41.375969 [info ] [MainThread]: 
[0m09:30:41.400237 [debug] [Thread-1 (]: Began running node seed.vg_casestudy.fx_rates_full_history
[0m09:30:41.400769 [info ] [Thread-1 (]: 1 of 1 START seed file raw.fx_rates_full_history ............................... [RUN]
[0m09:30:41.401557 [debug] [Thread-1 (]: Acquiring new duckdb connection 'seed.vg_casestudy.fx_rates_full_history'
[0m09:30:41.401978 [debug] [Thread-1 (]: Began compiling node seed.vg_casestudy.fx_rates_full_history
[0m09:30:41.402453 [debug] [Thread-1 (]: Timing info for seed.vg_casestudy.fx_rates_full_history (compile): 09:30:41.402260 => 09:30:41.402264
[0m09:30:41.402808 [debug] [Thread-1 (]: Began executing node seed.vg_casestudy.fx_rates_full_history
[0m09:30:41.445004 [debug] [Thread-1 (]: Using duckdb connection "seed.vg_casestudy.fx_rates_full_history"
[0m09:30:41.445432 [debug] [Thread-1 (]: On seed.vg_casestudy.fx_rates_full_history: BEGIN
[0m09:30:41.445757 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m09:30:41.458370 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:30:41.458798 [debug] [Thread-1 (]: Using duckdb connection "seed.vg_casestudy.fx_rates_full_history"
[0m09:30:41.459133 [debug] [Thread-1 (]: On seed.vg_casestudy.fx_rates_full_history: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "seed.vg_casestudy.fx_rates_full_history"} */

    create table "casestudy"."raw"."fx_rates_full_history" ("currency_iso_code" text,"fx_rate_date" date,"fx_rate" float8)
  
[0m09:30:41.459901 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:30:41.472758 [debug] [Thread-1 (]: Using duckdb connection "seed.vg_casestudy.fx_rates_full_history"
[0m09:30:41.473233 [debug] [Thread-1 (]: On seed.vg_casestudy.fx_rates_full_history: 
          COPY "casestudy"."raw"."fx_rates_full_history" FROM '/workspaces/vg_case_study_tim/transformation/seeds/fx_rates_full_history.csv' (FORMAT CSV, HEADER TRUE)
        ...
[0m09:30:41.534538 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:30:41.540037 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.vg_casestudy.fx_rates_full_history"
[0m09:30:41.555491 [debug] [Thread-1 (]: On seed.vg_casestudy.fx_rates_full_history: COMMIT
[0m09:30:41.555933 [debug] [Thread-1 (]: Using duckdb connection "seed.vg_casestudy.fx_rates_full_history"
[0m09:30:41.556244 [debug] [Thread-1 (]: On seed.vg_casestudy.fx_rates_full_history: COMMIT
[0m09:30:41.562599 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:30:41.563781 [debug] [Thread-1 (]: Timing info for seed.vg_casestudy.fx_rates_full_history (execute): 09:30:41.403049 => 09:30:41.563592
[0m09:30:41.564108 [debug] [Thread-1 (]: On seed.vg_casestudy.fx_rates_full_history: Close
[0m09:30:41.601896 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '88cf7907-557b-421f-b00a-ea7228b43b7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee4112ac90>]}
[0m09:30:41.602645 [info ] [Thread-1 (]: 1 of 1 OK loaded seed file raw.fx_rates_full_history ........................... [[32mINSERT 735[0m in 0.20s]
[0m09:30:41.603404 [debug] [Thread-1 (]: Finished running node seed.vg_casestudy.fx_rates_full_history
[0m09:30:41.605353 [debug] [MainThread]: Using duckdb connection "master"
[0m09:30:41.605793 [debug] [MainThread]: On master: BEGIN
[0m09:30:41.606114 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:30:41.620601 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m09:30:41.621269 [debug] [MainThread]: On master: COMMIT
[0m09:30:41.621734 [debug] [MainThread]: Using duckdb connection "master"
[0m09:30:41.622035 [debug] [MainThread]: On master: COMMIT
[0m09:30:41.622735 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m09:30:41.623093 [debug] [MainThread]: On master: Close
[0m09:30:41.625546 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:30:41.625900 [debug] [MainThread]: Connection 'list_casestudy_raw' was properly closed.
[0m09:30:41.626163 [debug] [MainThread]: Connection 'seed.vg_casestudy.fx_rates_full_history' was properly closed.
[0m09:30:41.626473 [info ] [MainThread]: 
[0m09:30:41.626808 [info ] [MainThread]: Finished running 1 seed in 0 hours 0 minutes and 0.55 seconds (0.55s).
[0m09:30:41.627402 [debug] [MainThread]: Command end result
[0m09:30:41.644342 [info ] [MainThread]: 
[0m09:30:41.644924 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:30:41.645333 [info ] [MainThread]: 
[0m09:30:41.645771 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m09:30:41.646373 [debug] [MainThread]: Command `dbt seed` succeeded at 09:30:41.646264 after 1.06 seconds
[0m09:30:41.646724 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee459eb210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee459ea250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee41318f90>]}
[0m09:30:41.647069 [debug] [MainThread]: Flushing usage events
[0m09:41:44.364147 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8be26f0050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8be26f3f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8be2727110>]}


============================== 09:41:44.370127 | 37d31229-dfa1-442b-9e0d-03a899165495 ==============================
[0m09:41:44.370127 [info ] [MainThread]: Running with dbt=1.6.18
[0m09:41:44.370713 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/workspaces/vg_case_study_tim/transformation', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/workspaces/vg_case_study_tim/transformation/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt seed --select fx_rates_full_history --full-refresh', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m09:41:44.585071 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '37d31229-dfa1-442b-9e0d-03a899165495', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8be28c6810>]}
[0m09:41:44.617478 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '37d31229-dfa1-442b-9e0d-03a899165495', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8be28bfb50>]}
[0m09:41:44.619243 [info ] [MainThread]: Registered adapter: duckdb=1.6.2
[0m09:41:44.675778 [debug] [MainThread]: checksum: 7b9fab86a08e9e96a48a825af743c566d95b877e068b8c6d0dbafbf714447189, vars: {}, profile: , target: , version: 1.6.18
[0m09:41:44.787554 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m09:41:44.788503 [debug] [MainThread]: Partial parsing: added file: vg_casestudy://seeds/fx_rates_full_history.yml
[0m09:41:44.900184 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.vg_casestudy.marts
- models.vg_casestudy.reporting
- models.vg_casestudy.main
[0m09:41:44.909175 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '37d31229-dfa1-442b-9e0d-03a899165495', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8be2a3bfd0>]}
[0m09:41:44.945389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '37d31229-dfa1-442b-9e0d-03a899165495', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8bde440090>]}
[0m09:41:44.946030 [info ] [MainThread]: Found 11 models, 1 analysis, 3 seeds, 74 tests, 5 sources, 0 exposures, 0 metrics, 632 macros, 0 groups, 0 semantic models
[0m09:41:44.946556 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '37d31229-dfa1-442b-9e0d-03a899165495', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8be2968d50>]}
[0m09:41:44.949461 [info ] [MainThread]: 
[0m09:41:44.950619 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m09:41:44.953755 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_casestudy'
[0m09:41:44.969226 [debug] [ThreadPool]: Using duckdb connection "list_casestudy"
[0m09:41:44.969697 [debug] [ThreadPool]: On list_casestudy: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"casestudy"'
    
  
  
[0m09:41:44.970012 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:41:45.102518 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m09:41:45.104200 [debug] [ThreadPool]: On list_casestudy: Close
[0m09:41:45.109892 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy, now create_casestudy_raw)
[0m09:41:45.110846 [debug] [ThreadPool]: Creating schema "database: "casestudy"
schema: "raw"
"
[0m09:41:45.116498 [debug] [ThreadPool]: Using duckdb connection "create_casestudy_raw"
[0m09:41:45.116968 [debug] [ThreadPool]: On create_casestudy_raw: BEGIN
[0m09:41:45.117320 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:41:45.129956 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m09:41:45.130420 [debug] [ThreadPool]: Using duckdb connection "create_casestudy_raw"
[0m09:41:45.130736 [debug] [ThreadPool]: On create_casestudy_raw: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "create_casestudy_raw"} */
create schema if not exists "casestudy"."raw"
[0m09:41:45.131415 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m09:41:45.132388 [debug] [ThreadPool]: On create_casestudy_raw: COMMIT
[0m09:41:45.132717 [debug] [ThreadPool]: Using duckdb connection "create_casestudy_raw"
[0m09:41:45.132987 [debug] [ThreadPool]: On create_casestudy_raw: COMMIT
[0m09:41:45.133724 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m09:41:45.134118 [debug] [ThreadPool]: On create_casestudy_raw: Close
[0m09:41:45.140013 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_casestudy_raw, now list_casestudy_raw)
[0m09:41:45.145899 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_raw"
[0m09:41:45.146395 [debug] [ThreadPool]: On list_casestudy_raw: BEGIN
[0m09:41:45.146730 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:41:45.159709 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m09:41:45.160162 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_raw"
[0m09:41:45.160491 [debug] [ThreadPool]: On list_casestudy_raw: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_raw"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'raw'
    and table_catalog = 'casestudy'
  
[0m09:41:45.175671 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m09:41:45.178102 [debug] [ThreadPool]: On list_casestudy_raw: ROLLBACK
[0m09:41:45.179860 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_raw'
[0m09:41:45.180646 [debug] [ThreadPool]: On list_casestudy_raw: Close
[0m09:41:45.184411 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy_raw, now list_casestudy_staging)
[0m09:41:45.189510 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_staging"
[0m09:41:45.189975 [debug] [ThreadPool]: On list_casestudy_staging: BEGIN
[0m09:41:45.190423 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:41:45.205210 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m09:41:45.205891 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_staging"
[0m09:41:45.206348 [debug] [ThreadPool]: On list_casestudy_staging: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_staging"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'staging'
    and table_catalog = 'casestudy'
  
[0m09:41:45.219660 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m09:41:45.221700 [debug] [ThreadPool]: On list_casestudy_staging: ROLLBACK
[0m09:41:45.222558 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_staging'
[0m09:41:45.223003 [debug] [ThreadPool]: On list_casestudy_staging: Close
[0m09:41:45.227029 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy_staging, now list_casestudy_intermediate)
[0m09:41:45.231370 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_intermediate"
[0m09:41:45.231877 [debug] [ThreadPool]: On list_casestudy_intermediate: BEGIN
[0m09:41:45.232381 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:41:45.248415 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m09:41:45.249072 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_intermediate"
[0m09:41:45.249601 [debug] [ThreadPool]: On list_casestudy_intermediate: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_intermediate"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'intermediate'
    and table_catalog = 'casestudy'
  
[0m09:41:45.260029 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m09:41:45.261792 [debug] [ThreadPool]: On list_casestudy_intermediate: ROLLBACK
[0m09:41:45.262686 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_intermediate'
[0m09:41:45.263043 [debug] [ThreadPool]: On list_casestudy_intermediate: Close
[0m09:41:45.267339 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '37d31229-dfa1-442b-9e0d-03a899165495', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8be2463f50>]}
[0m09:41:45.267975 [debug] [MainThread]: Using duckdb connection "master"
[0m09:41:45.268324 [debug] [MainThread]: On master: BEGIN
[0m09:41:45.268711 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:41:45.283808 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m09:41:45.284512 [debug] [MainThread]: On master: COMMIT
[0m09:41:45.285103 [debug] [MainThread]: Using duckdb connection "master"
[0m09:41:45.285567 [debug] [MainThread]: On master: COMMIT
[0m09:41:45.286324 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m09:41:45.286730 [debug] [MainThread]: On master: Close
[0m09:41:45.289632 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:41:45.290219 [info ] [MainThread]: 
[0m09:41:45.295766 [debug] [Thread-1 (]: Began running node seed.vg_casestudy.fx_rates_full_history
[0m09:41:45.296394 [info ] [Thread-1 (]: 1 of 1 START seed file raw.fx_rates_full_history ............................... [RUN]
[0m09:41:45.297633 [debug] [Thread-1 (]: Acquiring new duckdb connection 'seed.vg_casestudy.fx_rates_full_history'
[0m09:41:45.298326 [debug] [Thread-1 (]: Began compiling node seed.vg_casestudy.fx_rates_full_history
[0m09:41:45.299559 [debug] [Thread-1 (]: Timing info for seed.vg_casestudy.fx_rates_full_history (compile): 09:41:45.298870 => 09:41:45.298876
[0m09:41:45.300258 [debug] [Thread-1 (]: Began executing node seed.vg_casestudy.fx_rates_full_history
[0m09:41:45.347711 [debug] [Thread-1 (]: Using duckdb connection "seed.vg_casestudy.fx_rates_full_history"
[0m09:41:45.348191 [debug] [Thread-1 (]: On seed.vg_casestudy.fx_rates_full_history: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "seed.vg_casestudy.fx_rates_full_history"} */
drop table if exists "casestudy"."raw"."fx_rates_full_history" cascade
[0m09:41:45.348565 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m09:41:45.373944 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:41:45.386142 [debug] [Thread-1 (]: Using duckdb connection "seed.vg_casestudy.fx_rates_full_history"
[0m09:41:45.386647 [debug] [Thread-1 (]: On seed.vg_casestudy.fx_rates_full_history: BEGIN
[0m09:41:45.387475 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:41:45.387829 [debug] [Thread-1 (]: Using duckdb connection "seed.vg_casestudy.fx_rates_full_history"
[0m09:41:45.388133 [debug] [Thread-1 (]: On seed.vg_casestudy.fx_rates_full_history: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "seed.vg_casestudy.fx_rates_full_history"} */

    create table "casestudy"."raw"."fx_rates_full_history" ("currency_iso_code" text,"fx_rate_date" date,"fx_rate" float8)
  
[0m09:41:45.388802 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:41:45.400153 [debug] [Thread-1 (]: Using duckdb connection "seed.vg_casestudy.fx_rates_full_history"
[0m09:41:45.400720 [debug] [Thread-1 (]: On seed.vg_casestudy.fx_rates_full_history: 
          COPY "casestudy"."raw"."fx_rates_full_history" FROM '/workspaces/vg_case_study_tim/transformation/seeds/fx_rates_full_history.csv' (FORMAT CSV, HEADER TRUE)
        ...
[0m09:41:45.458121 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:41:45.463589 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.vg_casestudy.fx_rates_full_history"
[0m09:41:45.485914 [debug] [Thread-1 (]: On seed.vg_casestudy.fx_rates_full_history: COMMIT
[0m09:41:45.486380 [debug] [Thread-1 (]: Using duckdb connection "seed.vg_casestudy.fx_rates_full_history"
[0m09:41:45.486712 [debug] [Thread-1 (]: On seed.vg_casestudy.fx_rates_full_history: COMMIT
[0m09:41:45.492160 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:41:45.493259 [debug] [Thread-1 (]: Timing info for seed.vg_casestudy.fx_rates_full_history (execute): 09:41:45.300897 => 09:41:45.493049
[0m09:41:45.493664 [debug] [Thread-1 (]: On seed.vg_casestudy.fx_rates_full_history: Close
[0m09:41:45.522135 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '37d31229-dfa1-442b-9e0d-03a899165495', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8be2a45390>]}
[0m09:41:45.522806 [info ] [Thread-1 (]: 1 of 1 OK loaded seed file raw.fx_rates_full_history ........................... [[32mCREATE 735[0m in 0.23s]
[0m09:41:45.523409 [debug] [Thread-1 (]: Finished running node seed.vg_casestudy.fx_rates_full_history
[0m09:41:45.525404 [debug] [MainThread]: Using duckdb connection "master"
[0m09:41:45.525865 [debug] [MainThread]: On master: BEGIN
[0m09:41:45.526202 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:41:45.543539 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m09:41:45.544120 [debug] [MainThread]: On master: COMMIT
[0m09:41:45.544510 [debug] [MainThread]: Using duckdb connection "master"
[0m09:41:45.544860 [debug] [MainThread]: On master: COMMIT
[0m09:41:45.545595 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m09:41:45.545920 [debug] [MainThread]: On master: Close
[0m09:41:45.548614 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:41:45.549088 [debug] [MainThread]: Connection 'list_casestudy_intermediate' was properly closed.
[0m09:41:45.549382 [debug] [MainThread]: Connection 'seed.vg_casestudy.fx_rates_full_history' was properly closed.
[0m09:41:45.549768 [info ] [MainThread]: 
[0m09:41:45.550162 [info ] [MainThread]: Finished running 1 seed in 0 hours 0 minutes and 0.60 seconds (0.60s).
[0m09:41:45.550958 [debug] [MainThread]: Command end result
[0m09:41:45.571620 [info ] [MainThread]: 
[0m09:41:45.572311 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:41:45.572778 [info ] [MainThread]: 
[0m09:41:45.573239 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m09:41:45.573960 [debug] [MainThread]: Command `dbt seed` succeeded at 09:41:45.573802 after 1.22 seconds
[0m09:41:45.574478 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8be2b71190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8be244c550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8be4231350>]}
[0m09:41:45.574926 [debug] [MainThread]: Flushing usage events
[0m09:42:28.239016 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f038ac23350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f038ade6a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f038aaf0250>]}


============================== 09:42:28.241506 | e5d4e6d1-981f-4395-b1a8-58352a7213c6 ==============================
[0m09:42:28.241506 [info ] [MainThread]: Running with dbt=1.6.18
[0m09:42:28.242082 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/workspaces/vg_case_study_tim/transformation', 'log_path': '/workspaces/vg_case_study_tim/transformation/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test --select fx_rates_full_history', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m09:42:28.340384 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e5d4e6d1-981f-4395-b1a8-58352a7213c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f038adca550>]}
[0m09:42:28.354465 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e5d4e6d1-981f-4395-b1a8-58352a7213c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f038af15a50>]}
[0m09:42:28.355212 [info ] [MainThread]: Registered adapter: duckdb=1.6.2
[0m09:42:28.380013 [debug] [MainThread]: checksum: 7b9fab86a08e9e96a48a825af743c566d95b877e068b8c6d0dbafbf714447189, vars: {}, profile: , target: , version: 1.6.18
[0m09:42:28.425109 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:42:28.425549 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:42:28.426808 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.vg_casestudy.reporting
- models.vg_casestudy.main
- models.vg_casestudy.marts
[0m09:42:28.434281 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e5d4e6d1-981f-4395-b1a8-58352a7213c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f038adca150>]}
[0m09:42:28.463006 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e5d4e6d1-981f-4395-b1a8-58352a7213c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f03869e0c10>]}
[0m09:42:28.463560 [info ] [MainThread]: Found 11 models, 1 analysis, 3 seeds, 74 tests, 5 sources, 0 exposures, 0 metrics, 632 macros, 0 groups, 0 semantic models
[0m09:42:28.463968 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e5d4e6d1-981f-4395-b1a8-58352a7213c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f038abf39d0>]}
[0m09:42:28.466358 [info ] [MainThread]: 
[0m09:42:28.467300 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m09:42:28.469110 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_casestudy_raw'
[0m09:42:28.524544 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_raw"
[0m09:42:28.525084 [debug] [ThreadPool]: On list_casestudy_raw: BEGIN
[0m09:42:28.525399 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:42:28.542275 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m09:42:28.542735 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_raw"
[0m09:42:28.543096 [debug] [ThreadPool]: On list_casestudy_raw: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_raw"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'raw'
    and table_catalog = 'casestudy'
  
[0m09:42:28.553154 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m09:42:28.554664 [debug] [ThreadPool]: On list_casestudy_raw: ROLLBACK
[0m09:42:28.555416 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_raw'
[0m09:42:28.555784 [debug] [ThreadPool]: On list_casestudy_raw: Close
[0m09:42:28.560898 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy_raw, now list_casestudy_intermediate)
[0m09:42:28.564688 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_intermediate"
[0m09:42:28.565052 [debug] [ThreadPool]: On list_casestudy_intermediate: BEGIN
[0m09:42:28.565329 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:42:28.577028 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m09:42:28.577515 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_intermediate"
[0m09:42:28.577858 [debug] [ThreadPool]: On list_casestudy_intermediate: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_intermediate"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'intermediate'
    and table_catalog = 'casestudy'
  
[0m09:42:28.586807 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m09:42:28.588464 [debug] [ThreadPool]: On list_casestudy_intermediate: ROLLBACK
[0m09:42:28.589021 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_intermediate'
[0m09:42:28.589358 [debug] [ThreadPool]: On list_casestudy_intermediate: Close
[0m09:42:28.594676 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy_intermediate, now list_casestudy_staging)
[0m09:42:28.598271 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_staging"
[0m09:42:28.598762 [debug] [ThreadPool]: On list_casestudy_staging: BEGIN
[0m09:42:28.599123 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:42:28.611645 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m09:42:28.612266 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_staging"
[0m09:42:28.612635 [debug] [ThreadPool]: On list_casestudy_staging: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_staging"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'staging'
    and table_catalog = 'casestudy'
  
[0m09:42:28.622536 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m09:42:28.624026 [debug] [ThreadPool]: On list_casestudy_staging: ROLLBACK
[0m09:42:28.624533 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_staging'
[0m09:42:28.624842 [debug] [ThreadPool]: On list_casestudy_staging: Close
[0m09:42:28.629782 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e5d4e6d1-981f-4395-b1a8-58352a7213c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f038abc3110>]}
[0m09:42:28.630336 [debug] [MainThread]: Using duckdb connection "master"
[0m09:42:28.630647 [debug] [MainThread]: On master: BEGIN
[0m09:42:28.630930 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:42:28.642847 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m09:42:28.643269 [debug] [MainThread]: On master: COMMIT
[0m09:42:28.643605 [debug] [MainThread]: Using duckdb connection "master"
[0m09:42:28.643862 [debug] [MainThread]: On master: COMMIT
[0m09:42:28.644311 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m09:42:28.644606 [debug] [MainThread]: On master: Close
[0m09:42:28.646849 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:42:28.647277 [info ] [MainThread]: 
[0m09:42:28.649989 [debug] [Thread-1 (]: Began running node test.vg_casestudy.not_null_fx_rates_full_history_currency_iso_code.e845428370
[0m09:42:28.650499 [info ] [Thread-1 (]: 1 of 3 START test not_null_fx_rates_full_history_currency_iso_code ............. [RUN]
[0m09:42:28.651307 [debug] [Thread-1 (]: Acquiring new duckdb connection 'test.vg_casestudy.not_null_fx_rates_full_history_currency_iso_code.e845428370'
[0m09:42:28.651660 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.not_null_fx_rates_full_history_currency_iso_code.e845428370
[0m09:42:28.671970 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.not_null_fx_rates_full_history_currency_iso_code.e845428370"
[0m09:42:28.676145 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_fx_rates_full_history_currency_iso_code.e845428370 (compile): 09:42:28.651890 => 09:42:28.675842
[0m09:42:28.676577 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.not_null_fx_rates_full_history_currency_iso_code.e845428370
[0m09:42:28.688953 [debug] [Thread-1 (]: Writing runtime sql for node "test.vg_casestudy.not_null_fx_rates_full_history_currency_iso_code.e845428370"
[0m09:42:28.690892 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.not_null_fx_rates_full_history_currency_iso_code.e845428370"
[0m09:42:28.691282 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_fx_rates_full_history_currency_iso_code.e845428370: BEGIN
[0m09:42:28.691590 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m09:42:28.706035 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:42:28.706510 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.not_null_fx_rates_full_history_currency_iso_code.e845428370"
[0m09:42:28.706877 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_fx_rates_full_history_currency_iso_code.e845428370: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "test.vg_casestudy.not_null_fx_rates_full_history_currency_iso_code.e845428370"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select currency_iso_code
from "casestudy"."raw"."fx_rates_full_history"
where currency_iso_code is null



      
    ) dbt_internal_test
[0m09:42:28.712785 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:42:28.716343 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_fx_rates_full_history_currency_iso_code.e845428370 (execute): 09:42:28.676818 => 09:42:28.716086
[0m09:42:28.716815 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_fx_rates_full_history_currency_iso_code.e845428370: ROLLBACK
[0m09:42:28.717335 [debug] [Thread-1 (]: Failed to rollback 'test.vg_casestudy.not_null_fx_rates_full_history_currency_iso_code.e845428370'
[0m09:42:28.717675 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_fx_rates_full_history_currency_iso_code.e845428370: Close
[0m09:42:28.720320 [info ] [Thread-1 (]: 1 of 3 PASS not_null_fx_rates_full_history_currency_iso_code ................... [[32mPASS[0m in 0.07s]
[0m09:42:28.720947 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.not_null_fx_rates_full_history_currency_iso_code.e845428370
[0m09:42:28.721371 [debug] [Thread-1 (]: Began running node test.vg_casestudy.not_null_fx_rates_full_history_fx_rate.cdb4ee04e4
[0m09:42:28.721892 [info ] [Thread-1 (]: 2 of 3 START test not_null_fx_rates_full_history_fx_rate ....................... [RUN]
[0m09:42:28.722640 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.not_null_fx_rates_full_history_currency_iso_code.e845428370, now test.vg_casestudy.not_null_fx_rates_full_history_fx_rate.cdb4ee04e4)
[0m09:42:28.722976 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.not_null_fx_rates_full_history_fx_rate.cdb4ee04e4
[0m09:42:28.727337 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.not_null_fx_rates_full_history_fx_rate.cdb4ee04e4"
[0m09:42:28.728374 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_fx_rates_full_history_fx_rate.cdb4ee04e4 (compile): 09:42:28.723201 => 09:42:28.728142
[0m09:42:28.728786 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.not_null_fx_rates_full_history_fx_rate.cdb4ee04e4
[0m09:42:28.731790 [debug] [Thread-1 (]: Writing runtime sql for node "test.vg_casestudy.not_null_fx_rates_full_history_fx_rate.cdb4ee04e4"
[0m09:42:28.732707 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.not_null_fx_rates_full_history_fx_rate.cdb4ee04e4"
[0m09:42:28.733161 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_fx_rates_full_history_fx_rate.cdb4ee04e4: BEGIN
[0m09:42:28.733551 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:42:28.748014 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:42:28.748523 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.not_null_fx_rates_full_history_fx_rate.cdb4ee04e4"
[0m09:42:28.748891 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_fx_rates_full_history_fx_rate.cdb4ee04e4: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "test.vg_casestudy.not_null_fx_rates_full_history_fx_rate.cdb4ee04e4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select fx_rate
from "casestudy"."raw"."fx_rates_full_history"
where fx_rate is null



      
    ) dbt_internal_test
[0m09:42:28.750346 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:42:28.752599 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_fx_rates_full_history_fx_rate.cdb4ee04e4 (execute): 09:42:28.729078 => 09:42:28.752326
[0m09:42:28.753021 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_fx_rates_full_history_fx_rate.cdb4ee04e4: ROLLBACK
[0m09:42:28.753544 [debug] [Thread-1 (]: Failed to rollback 'test.vg_casestudy.not_null_fx_rates_full_history_fx_rate.cdb4ee04e4'
[0m09:42:28.753869 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_fx_rates_full_history_fx_rate.cdb4ee04e4: Close
[0m09:42:28.756374 [info ] [Thread-1 (]: 2 of 3 PASS not_null_fx_rates_full_history_fx_rate ............................. [[32mPASS[0m in 0.03s]
[0m09:42:28.757070 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.not_null_fx_rates_full_history_fx_rate.cdb4ee04e4
[0m09:42:28.757477 [debug] [Thread-1 (]: Began running node test.vg_casestudy.not_null_fx_rates_full_history_fx_rate_date.2fa88715f4
[0m09:42:28.757967 [info ] [Thread-1 (]: 3 of 3 START test not_null_fx_rates_full_history_fx_rate_date .................. [RUN]
[0m09:42:28.758659 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.not_null_fx_rates_full_history_fx_rate.cdb4ee04e4, now test.vg_casestudy.not_null_fx_rates_full_history_fx_rate_date.2fa88715f4)
[0m09:42:28.758998 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.not_null_fx_rates_full_history_fx_rate_date.2fa88715f4
[0m09:42:28.763273 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.not_null_fx_rates_full_history_fx_rate_date.2fa88715f4"
[0m09:42:28.765178 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_fx_rates_full_history_fx_rate_date.2fa88715f4 (compile): 09:42:28.759223 => 09:42:28.764894
[0m09:42:28.765641 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.not_null_fx_rates_full_history_fx_rate_date.2fa88715f4
[0m09:42:28.770480 [debug] [Thread-1 (]: Writing runtime sql for node "test.vg_casestudy.not_null_fx_rates_full_history_fx_rate_date.2fa88715f4"
[0m09:42:28.771262 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.not_null_fx_rates_full_history_fx_rate_date.2fa88715f4"
[0m09:42:28.771676 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_fx_rates_full_history_fx_rate_date.2fa88715f4: BEGIN
[0m09:42:28.772190 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:42:28.786452 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:42:28.786934 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.not_null_fx_rates_full_history_fx_rate_date.2fa88715f4"
[0m09:42:28.787288 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_fx_rates_full_history_fx_rate_date.2fa88715f4: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "test.vg_casestudy.not_null_fx_rates_full_history_fx_rate_date.2fa88715f4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select fx_rate_date
from "casestudy"."raw"."fx_rates_full_history"
where fx_rate_date is null



      
    ) dbt_internal_test
[0m09:42:28.788616 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:42:28.790300 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_fx_rates_full_history_fx_rate_date.2fa88715f4 (execute): 09:42:28.765931 => 09:42:28.790039
[0m09:42:28.790722 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_fx_rates_full_history_fx_rate_date.2fa88715f4: ROLLBACK
[0m09:42:28.791212 [debug] [Thread-1 (]: Failed to rollback 'test.vg_casestudy.not_null_fx_rates_full_history_fx_rate_date.2fa88715f4'
[0m09:42:28.791547 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_fx_rates_full_history_fx_rate_date.2fa88715f4: Close
[0m09:42:28.794525 [info ] [Thread-1 (]: 3 of 3 PASS not_null_fx_rates_full_history_fx_rate_date ........................ [[32mPASS[0m in 0.04s]
[0m09:42:28.795171 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.not_null_fx_rates_full_history_fx_rate_date.2fa88715f4
[0m09:42:28.796864 [debug] [MainThread]: Using duckdb connection "master"
[0m09:42:28.797179 [debug] [MainThread]: On master: BEGIN
[0m09:42:28.797438 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:42:28.810746 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m09:42:28.811189 [debug] [MainThread]: On master: COMMIT
[0m09:42:28.811473 [debug] [MainThread]: Using duckdb connection "master"
[0m09:42:28.811741 [debug] [MainThread]: On master: COMMIT
[0m09:42:28.812351 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m09:42:28.812742 [debug] [MainThread]: On master: Close
[0m09:42:28.815631 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:42:28.816053 [debug] [MainThread]: Connection 'list_casestudy_staging' was properly closed.
[0m09:42:28.816394 [debug] [MainThread]: Connection 'test.vg_casestudy.not_null_fx_rates_full_history_fx_rate_date.2fa88715f4' was properly closed.
[0m09:42:28.816780 [info ] [MainThread]: 
[0m09:42:28.817185 [info ] [MainThread]: Finished running 3 tests in 0 hours 0 minutes and 0.35 seconds (0.35s).
[0m09:42:28.818083 [debug] [MainThread]: Command end result
[0m09:42:28.837497 [info ] [MainThread]: 
[0m09:42:28.838012 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:42:28.838351 [info ] [MainThread]: 
[0m09:42:28.838742 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m09:42:28.839365 [debug] [MainThread]: Command `dbt test` succeeded at 09:42:28.839188 after 0.61 seconds
[0m09:42:28.839964 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f038b2cc490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f038addd710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f038ad1b850>]}
[0m09:42:28.840565 [debug] [MainThread]: Flushing usage events
[0m10:25:41.038445 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffbe4aa5250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffbe4c32990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffbe4bf9e90>]}


============================== 10:25:41.044580 | 65e203fe-17cc-4604-87f7-c0a5db50b3fe ==============================
[0m10:25:41.044580 [info ] [MainThread]: Running with dbt=1.6.18
[0m10:25:41.045180 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/workspaces/vg_case_study_tim/transformation', 'version_check': 'True', 'debug': 'False', 'log_path': '/workspaces/vg_case_study_tim/transformation/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --select stg_staging_intermediate_fx_rates_filled', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:25:41.246412 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '65e203fe-17cc-4604-87f7-c0a5db50b3fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffbe4c23850>]}
[0m10:25:41.260968 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '65e203fe-17cc-4604-87f7-c0a5db50b3fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffbe4bf9950>]}
[0m10:25:41.262691 [info ] [MainThread]: Registered adapter: duckdb=1.6.2
[0m10:25:41.328949 [debug] [MainThread]: checksum: 7b9fab86a08e9e96a48a825af743c566d95b877e068b8c6d0dbafbf714447189, vars: {}, profile: , target: , version: 1.6.18
[0m10:25:41.436931 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m10:25:41.437673 [debug] [MainThread]: Partial parsing: added file: vg_casestudy://models/intermediate/stg_staging_intermediate_fx_rates_filled.sql
[0m10:25:41.509539 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.vg_casestudy.marts
- models.vg_casestudy.main
- models.vg_casestudy.reporting
[0m10:25:41.559581 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '65e203fe-17cc-4604-87f7-c0a5db50b3fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffbe4902290>]}
[0m10:25:41.588135 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '65e203fe-17cc-4604-87f7-c0a5db50b3fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffbe038d750>]}
[0m10:25:41.588685 [info ] [MainThread]: Found 12 models, 1 analysis, 3 seeds, 74 tests, 5 sources, 0 exposures, 0 metrics, 632 macros, 0 groups, 0 semantic models
[0m10:25:41.589079 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '65e203fe-17cc-4604-87f7-c0a5db50b3fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffbe0f17c50>]}
[0m10:25:41.591525 [info ] [MainThread]: 
[0m10:25:41.592728 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m10:25:41.595502 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_casestudy'
[0m10:25:41.605135 [debug] [ThreadPool]: Using duckdb connection "list_casestudy"
[0m10:25:41.605614 [debug] [ThreadPool]: On list_casestudy: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"casestudy"'
    
  
  
[0m10:25:41.605917 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:25:41.748433 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:25:41.750143 [debug] [ThreadPool]: On list_casestudy: Close
[0m10:25:41.757797 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy, now create_casestudy_intermediate)
[0m10:25:41.758668 [debug] [ThreadPool]: Creating schema "database: "casestudy"
schema: "intermediate"
"
[0m10:25:41.763306 [debug] [ThreadPool]: Using duckdb connection "create_casestudy_intermediate"
[0m10:25:41.763693 [debug] [ThreadPool]: On create_casestudy_intermediate: BEGIN
[0m10:25:41.764025 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:25:41.774807 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:25:41.775329 [debug] [ThreadPool]: Using duckdb connection "create_casestudy_intermediate"
[0m10:25:41.775647 [debug] [ThreadPool]: On create_casestudy_intermediate: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "create_casestudy_intermediate"} */
create schema if not exists "casestudy"."intermediate"
[0m10:25:41.776314 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:25:41.777317 [debug] [ThreadPool]: On create_casestudy_intermediate: COMMIT
[0m10:25:41.777609 [debug] [ThreadPool]: Using duckdb connection "create_casestudy_intermediate"
[0m10:25:41.777897 [debug] [ThreadPool]: On create_casestudy_intermediate: COMMIT
[0m10:25:41.778653 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:25:41.778979 [debug] [ThreadPool]: On create_casestudy_intermediate: Close
[0m10:25:41.783376 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_casestudy_raw'
[0m10:25:41.788771 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_raw"
[0m10:25:41.789392 [debug] [ThreadPool]: On list_casestudy_raw: BEGIN
[0m10:25:41.789691 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:25:41.803555 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:25:41.803963 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_raw"
[0m10:25:41.804255 [debug] [ThreadPool]: On list_casestudy_raw: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_raw"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'raw'
    and table_catalog = 'casestudy'
  
[0m10:25:41.818733 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:25:41.820166 [debug] [ThreadPool]: On list_casestudy_raw: ROLLBACK
[0m10:25:41.821708 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_raw'
[0m10:25:41.822023 [debug] [ThreadPool]: On list_casestudy_raw: Close
[0m10:25:41.825297 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy_raw, now list_casestudy_intermediate)
[0m10:25:41.827615 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_intermediate"
[0m10:25:41.828030 [debug] [ThreadPool]: On list_casestudy_intermediate: BEGIN
[0m10:25:41.828355 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:25:41.839647 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:25:41.840028 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_intermediate"
[0m10:25:41.840320 [debug] [ThreadPool]: On list_casestudy_intermediate: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_intermediate"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'intermediate'
    and table_catalog = 'casestudy'
  
[0m10:25:41.849108 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:25:41.850481 [debug] [ThreadPool]: On list_casestudy_intermediate: ROLLBACK
[0m10:25:41.850954 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_intermediate'
[0m10:25:41.851213 [debug] [ThreadPool]: On list_casestudy_intermediate: Close
[0m10:25:41.854005 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy_intermediate, now list_casestudy_staging)
[0m10:25:41.857037 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_staging"
[0m10:25:41.857394 [debug] [ThreadPool]: On list_casestudy_staging: BEGIN
[0m10:25:41.858687 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:25:41.870502 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:25:41.870906 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_staging"
[0m10:25:41.871201 [debug] [ThreadPool]: On list_casestudy_staging: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_staging"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'staging'
    and table_catalog = 'casestudy'
  
[0m10:25:41.879809 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:25:41.881245 [debug] [ThreadPool]: On list_casestudy_staging: ROLLBACK
[0m10:25:41.881852 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_staging'
[0m10:25:41.882157 [debug] [ThreadPool]: On list_casestudy_staging: Close
[0m10:25:41.886085 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '65e203fe-17cc-4604-87f7-c0a5db50b3fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffbe0f554d0>]}
[0m10:25:41.886568 [debug] [MainThread]: Using duckdb connection "master"
[0m10:25:41.886865 [debug] [MainThread]: On master: BEGIN
[0m10:25:41.887146 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:25:41.900835 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m10:25:41.901267 [debug] [MainThread]: On master: COMMIT
[0m10:25:41.901645 [debug] [MainThread]: Using duckdb connection "master"
[0m10:25:41.901931 [debug] [MainThread]: On master: COMMIT
[0m10:25:41.902447 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m10:25:41.902721 [debug] [MainThread]: On master: Close
[0m10:25:41.905070 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:25:41.905479 [info ] [MainThread]: 
[0m10:25:41.911618 [debug] [Thread-1 (]: Began running node model.vg_casestudy.stg_staging_intermediate_fx_rates_filled
[0m10:25:41.912218 [info ] [Thread-1 (]: 1 of 1 START sql table model intermediate.stg_staging_intermediate_fx_rates_filled  [RUN]
[0m10:25:41.913123 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.vg_casestudy.stg_staging_intermediate_fx_rates_filled'
[0m10:25:41.913560 [debug] [Thread-1 (]: Began compiling node model.vg_casestudy.stg_staging_intermediate_fx_rates_filled
[0m10:25:41.938238 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate_fx_rates_filled"
[0m10:25:41.938731 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate_fx_rates_filled: BEGIN
[0m10:25:41.939068 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:25:41.954108 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m10:25:41.954542 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate_fx_rates_filled"
[0m10:25:41.954877 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate_fx_rates_filled: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_staging_intermediate_fx_rates_filled"} */


        select 
        (((select max(transaction_date) from {{ ref('stg_staging_intermediate__transactions') }}))::date - ((select min(transaction_date) from {{ ref('stg_staging_intermediate__transactions') }}))::date)
    
[0m10:25:41.969295 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.stg_staging_intermediate_fx_rates_filled (compile): 10:25:41.913915 => 10:25:41.969020
[0m10:25:41.969748 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate_fx_rates_filled: ROLLBACK
[0m10:25:41.979438 [debug] [Thread-1 (]: Failed to rollback 'model.vg_casestudy.stg_staging_intermediate_fx_rates_filled'
[0m10:25:41.979928 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate_fx_rates_filled: Close
[0m10:25:41.983948 [debug] [Thread-1 (]: Runtime Error in model stg_staging_intermediate_fx_rates_filled (models/intermediate/stg_staging_intermediate_fx_rates_filled.sql)
  Parser Error: syntax error at or near "{"
[0m10:25:41.984450 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '65e203fe-17cc-4604-87f7-c0a5db50b3fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffbe059e010>]}
[0m10:25:41.985022 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model intermediate.stg_staging_intermediate_fx_rates_filled  [[31mERROR[0m in 0.07s]
[0m10:25:41.985547 [debug] [Thread-1 (]: Finished running node model.vg_casestudy.stg_staging_intermediate_fx_rates_filled
[0m10:25:41.987788 [debug] [MainThread]: Using duckdb connection "master"
[0m10:25:41.988159 [debug] [MainThread]: On master: BEGIN
[0m10:25:41.988435 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:25:42.005409 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m10:25:42.005857 [debug] [MainThread]: On master: COMMIT
[0m10:25:42.006168 [debug] [MainThread]: Using duckdb connection "master"
[0m10:25:42.006435 [debug] [MainThread]: On master: COMMIT
[0m10:25:42.007049 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m10:25:42.007438 [debug] [MainThread]: On master: Close
[0m10:25:42.010610 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:25:42.011326 [debug] [MainThread]: Connection 'create_casestudy_intermediate' was properly closed.
[0m10:25:42.011682 [debug] [MainThread]: Connection 'list_casestudy_staging' was properly closed.
[0m10:25:42.011932 [debug] [MainThread]: Connection 'model.vg_casestudy.stg_staging_intermediate_fx_rates_filled' was properly closed.
[0m10:25:42.012280 [info ] [MainThread]: 
[0m10:25:42.012625 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.42 seconds (0.42s).
[0m10:25:42.013155 [debug] [MainThread]: Command end result
[0m10:25:42.032765 [info ] [MainThread]: 
[0m10:25:42.033291 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m10:25:42.033684 [info ] [MainThread]: 
[0m10:25:42.034094 [error] [MainThread]:   Runtime Error in model stg_staging_intermediate_fx_rates_filled (models/intermediate/stg_staging_intermediate_fx_rates_filled.sql)
  Parser Error: syntax error at or near "{"
[0m10:25:42.034435 [info ] [MainThread]: 
[0m10:25:42.034805 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m10:25:42.035322 [debug] [MainThread]: Command `dbt run` failed at 10:25:42.035226 after 1.01 seconds
[0m10:25:42.035672 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffbe47c82d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffbe47c8550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffbe4603b10>]}
[0m10:25:42.036028 [debug] [MainThread]: Flushing usage events
[0m10:28:02.821722 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe819411050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe819251510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe81923b590>]}


============================== 10:28:02.826923 | 7d14a674-7821-4c6f-bfeb-7323d5e90c20 ==============================
[0m10:28:02.826923 [info ] [MainThread]: Running with dbt=1.6.18
[0m10:28:02.827512 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/workspaces/vg_case_study_tim/transformation/logs', 'profiles_dir': '/workspaces/vg_case_study_tim/transformation', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --select stg_staging_intermediate_fx_rates_filled', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m10:28:03.023836 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7d14a674-7821-4c6f-bfeb-7323d5e90c20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8158be910>]}
[0m10:28:03.038930 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7d14a674-7821-4c6f-bfeb-7323d5e90c20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe81956fad0>]}
[0m10:28:03.040376 [info ] [MainThread]: Registered adapter: duckdb=1.6.2
[0m10:28:03.068885 [debug] [MainThread]: checksum: 7b9fab86a08e9e96a48a825af743c566d95b877e068b8c6d0dbafbf714447189, vars: {}, profile: , target: , version: 1.6.18
[0m10:28:03.171075 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:28:03.171880 [debug] [MainThread]: Partial parsing: updated file: vg_casestudy://models/intermediate/stg_staging_intermediate_fx_rates_filled.sql
[0m10:28:03.246474 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.vg_casestudy.reporting
- models.vg_casestudy.main
- models.vg_casestudy.marts
[0m10:28:03.297241 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7d14a674-7821-4c6f-bfeb-7323d5e90c20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8195a0c50>]}
[0m10:28:03.325881 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7d14a674-7821-4c6f-bfeb-7323d5e90c20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe814f211d0>]}
[0m10:28:03.326436 [info ] [MainThread]: Found 12 models, 1 analysis, 3 seeds, 74 tests, 5 sources, 0 exposures, 0 metrics, 632 macros, 0 groups, 0 semantic models
[0m10:28:03.326827 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7d14a674-7821-4c6f-bfeb-7323d5e90c20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe819113fd0>]}
[0m10:28:03.329063 [info ] [MainThread]: 
[0m10:28:03.329861 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m10:28:03.331016 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_casestudy'
[0m10:28:03.338968 [debug] [ThreadPool]: Using duckdb connection "list_casestudy"
[0m10:28:03.339462 [debug] [ThreadPool]: On list_casestudy: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"casestudy"'
    
  
  
[0m10:28:03.339819 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:28:03.486209 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:28:03.487979 [debug] [ThreadPool]: On list_casestudy: Close
[0m10:28:03.491565 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy, now create_casestudy_intermediate)
[0m10:28:03.492362 [debug] [ThreadPool]: Creating schema "database: "casestudy"
schema: "intermediate"
"
[0m10:28:03.496683 [debug] [ThreadPool]: Using duckdb connection "create_casestudy_intermediate"
[0m10:28:03.497080 [debug] [ThreadPool]: On create_casestudy_intermediate: BEGIN
[0m10:28:03.497355 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:28:03.509352 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:28:03.509811 [debug] [ThreadPool]: Using duckdb connection "create_casestudy_intermediate"
[0m10:28:03.510121 [debug] [ThreadPool]: On create_casestudy_intermediate: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "create_casestudy_intermediate"} */
create schema if not exists "casestudy"."intermediate"
[0m10:28:03.510839 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:28:03.511777 [debug] [ThreadPool]: On create_casestudy_intermediate: COMMIT
[0m10:28:03.512094 [debug] [ThreadPool]: Using duckdb connection "create_casestudy_intermediate"
[0m10:28:03.512377 [debug] [ThreadPool]: On create_casestudy_intermediate: COMMIT
[0m10:28:03.513013 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:28:03.513369 [debug] [ThreadPool]: On create_casestudy_intermediate: Close
[0m10:28:03.519714 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_casestudy_intermediate, now list_casestudy_intermediate)
[0m10:28:03.525546 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_intermediate"
[0m10:28:03.525967 [debug] [ThreadPool]: On list_casestudy_intermediate: BEGIN
[0m10:28:03.526288 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:28:03.539682 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:28:03.540211 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_intermediate"
[0m10:28:03.540528 [debug] [ThreadPool]: On list_casestudy_intermediate: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_intermediate"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'intermediate'
    and table_catalog = 'casestudy'
  
[0m10:28:03.560058 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:28:03.561587 [debug] [ThreadPool]: On list_casestudy_intermediate: ROLLBACK
[0m10:28:03.562995 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_intermediate'
[0m10:28:03.563389 [debug] [ThreadPool]: On list_casestudy_intermediate: Close
[0m10:28:03.566644 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy_intermediate, now list_casestudy_staging)
[0m10:28:03.569918 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_staging"
[0m10:28:03.570278 [debug] [ThreadPool]: On list_casestudy_staging: BEGIN
[0m10:28:03.570541 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:28:03.582029 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:28:03.582454 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_staging"
[0m10:28:03.582751 [debug] [ThreadPool]: On list_casestudy_staging: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_staging"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'staging'
    and table_catalog = 'casestudy'
  
[0m10:28:03.591553 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:28:03.592995 [debug] [ThreadPool]: On list_casestudy_staging: ROLLBACK
[0m10:28:03.593576 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_staging'
[0m10:28:03.593861 [debug] [ThreadPool]: On list_casestudy_staging: Close
[0m10:28:03.597371 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy_staging, now list_casestudy_raw)
[0m10:28:03.602365 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_raw"
[0m10:28:03.602766 [debug] [ThreadPool]: On list_casestudy_raw: BEGIN
[0m10:28:03.603078 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:28:03.614164 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:28:03.614571 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_raw"
[0m10:28:03.614901 [debug] [ThreadPool]: On list_casestudy_raw: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_raw"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'raw'
    and table_catalog = 'casestudy'
  
[0m10:28:03.622765 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:28:03.624286 [debug] [ThreadPool]: On list_casestudy_raw: ROLLBACK
[0m10:28:03.624903 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_raw'
[0m10:28:03.625199 [debug] [ThreadPool]: On list_casestudy_raw: Close
[0m10:28:03.629391 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7d14a674-7821-4c6f-bfeb-7323d5e90c20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8158c9f90>]}
[0m10:28:03.629948 [debug] [MainThread]: Using duckdb connection "master"
[0m10:28:03.630220 [debug] [MainThread]: On master: BEGIN
[0m10:28:03.630495 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:28:03.644227 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m10:28:03.644647 [debug] [MainThread]: On master: COMMIT
[0m10:28:03.644950 [debug] [MainThread]: Using duckdb connection "master"
[0m10:28:03.645208 [debug] [MainThread]: On master: COMMIT
[0m10:28:03.645690 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m10:28:03.645976 [debug] [MainThread]: On master: Close
[0m10:28:03.648627 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:28:03.649105 [info ] [MainThread]: 
[0m10:28:03.655185 [debug] [Thread-1 (]: Began running node model.vg_casestudy.stg_staging_intermediate_fx_rates_filled
[0m10:28:03.655716 [info ] [Thread-1 (]: 1 of 1 START sql table model intermediate.stg_staging_intermediate_fx_rates_filled  [RUN]
[0m10:28:03.656815 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.vg_casestudy.stg_staging_intermediate_fx_rates_filled'
[0m10:28:03.657573 [debug] [Thread-1 (]: Began compiling node model.vg_casestudy.stg_staging_intermediate_fx_rates_filled
[0m10:28:03.683530 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate_fx_rates_filled"
[0m10:28:03.684022 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate_fx_rates_filled: BEGIN
[0m10:28:03.684378 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:28:03.699516 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m10:28:03.699981 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate_fx_rates_filled"
[0m10:28:03.700334 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate_fx_rates_filled: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_staging_intermediate_fx_rates_filled"} */


        select 
        (('2025-03-10')::date - ('2025-01-01')::date)
    
[0m10:28:03.702836 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m10:28:03.706621 [debug] [Thread-1 (]: Writing injected SQL for node "model.vg_casestudy.stg_staging_intermediate_fx_rates_filled"
[0m10:28:03.707470 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.stg_staging_intermediate_fx_rates_filled (compile): 10:28:03.657951 => 10:28:03.707233
[0m10:28:03.707884 [debug] [Thread-1 (]: Began executing node model.vg_casestudy.stg_staging_intermediate_fx_rates_filled
[0m10:28:03.739976 [debug] [Thread-1 (]: Writing runtime sql for node "model.vg_casestudy.stg_staging_intermediate_fx_rates_filled"
[0m10:28:03.740658 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate_fx_rates_filled"
[0m10:28:03.741110 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate_fx_rates_filled: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_staging_intermediate_fx_rates_filled"} */

  
    
    

    create  table
      "casestudy"."intermediate"."stg_staging_intermediate_fx_rates_filled__dbt_tmp"
  
    as (
      with calendar as (

    





with rawdata as (

    

    

    with p as (
        select 0 as generated_number union all select 1
    ), unioned as (

    select

    
    p0.generated_number * power(2, 0)
     + 
    
    p1.generated_number * power(2, 1)
     + 
    
    p2.generated_number * power(2, 2)
     + 
    
    p3.generated_number * power(2, 3)
     + 
    
    p4.generated_number * power(2, 4)
     + 
    
    p5.generated_number * power(2, 5)
     + 
    
    p6.generated_number * power(2, 6)
    
    
    + 1
    as generated_number

    from

    
    p as p0
     cross join 
    
    p as p1
     cross join 
    
    p as p2
     cross join 
    
    p as p3
     cross join 
    
    p as p4
     cross join 
    
    p as p5
     cross join 
    
    p as p6
    
    

    )

    select *
    from unioned
    where generated_number <= 68
    order by generated_number



),

all_periods as (

    select (
        

    '2025-01-01' + ((interval '1 day') * (row_number() over (order by 1) - 1))


    ) as date_day
    from rawdata

),

filtered as (

    select *
    from all_periods
    where date_day <= '2025-03-10'

)

select * from filtered



),

currencies as (
    select distinct trim(currency_iso_code) as currency_iso_code
    from "casestudy"."raw"."fx_rates_full_history"
),

date_matrix as (
    select 
        currencies.currency_iso_code,
        calendar.date_day as fx_rate_date
    from currencies
    cross join calendar 

),

joined as (
    select 
        date_matrix.currency_iso_code,
        date_matrix.fx_rate_date,
        fx_rates_full_history.fx_rate
    from date_matrix
    left join "casestudy"."raw"."fx_rates_full_history" as fx_rates_full_history
    on date_matrix.currency_iso_code = fx_rates_full_history.currency_iso_code
    and date_matrix.fx_rate_date = fx_rates_full_history.fx_rate_date
),

forward_fill_dates as (
    select 
        currency_iso_code,
        fx_rate_date,

        last_value(fx_rate ignore nulls) over(
            partition by currency_iso_code
            order by fx_rate_date asc
            rows between unbounded preceding and current row
        ) as fx_rate
    from joined
)

select *
from forward_fill_dates
    );
  
  
[0m10:28:03.764289 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.stg_staging_intermediate_fx_rates_filled (execute): 10:28:03.708128 => 10:28:03.764002
[0m10:28:03.764732 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate_fx_rates_filled: ROLLBACK
[0m10:28:03.774089 [debug] [Thread-1 (]: Failed to rollback 'model.vg_casestudy.stg_staging_intermediate_fx_rates_filled'
[0m10:28:03.774613 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate_fx_rates_filled: Close
[0m10:28:03.778894 [debug] [Thread-1 (]: Runtime Error in model stg_staging_intermediate_fx_rates_filled (models/intermediate/stg_staging_intermediate_fx_rates_filled.sql)
  Binder Error: Could not choose a best candidate function for the function call "+(STRING_LITERAL, INTERVAL)". In order to select one, please add explicit type casts.
  	Candidate functions:
  	+(DATE, INTERVAL) -> TIMESTAMP
  	+(TIME, INTERVAL) -> TIME
  	+(TIMESTAMP, INTERVAL) -> TIMESTAMP
  	+(TIME WITH TIME ZONE, INTERVAL) -> TIME WITH TIME ZONE
  	+(TIMESTAMP WITH TIME ZONE, INTERVAL) -> TIMESTAMP WITH TIME ZONE
  	+(INTERVAL, INTERVAL) -> INTERVAL
  
  
  LINE 97:     '2025-01-01' + ((interval '1 day') * (row_number() over (order by 1)...
                            ^
[0m10:28:03.779464 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7d14a674-7821-4c6f-bfeb-7323d5e90c20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8158f1790>]}
[0m10:28:03.780069 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model intermediate.stg_staging_intermediate_fx_rates_filled  [[31mERROR[0m in 0.12s]
[0m10:28:03.780682 [debug] [Thread-1 (]: Finished running node model.vg_casestudy.stg_staging_intermediate_fx_rates_filled
[0m10:28:03.783403 [debug] [MainThread]: Using duckdb connection "master"
[0m10:28:03.783771 [debug] [MainThread]: On master: BEGIN
[0m10:28:03.784039 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:28:03.798561 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m10:28:03.799095 [debug] [MainThread]: On master: COMMIT
[0m10:28:03.799508 [debug] [MainThread]: Using duckdb connection "master"
[0m10:28:03.799853 [debug] [MainThread]: On master: COMMIT
[0m10:28:03.800793 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m10:28:03.801213 [debug] [MainThread]: On master: Close
[0m10:28:03.803793 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:28:03.804140 [debug] [MainThread]: Connection 'list_casestudy_raw' was properly closed.
[0m10:28:03.804415 [debug] [MainThread]: Connection 'model.vg_casestudy.stg_staging_intermediate_fx_rates_filled' was properly closed.
[0m10:28:03.804740 [info ] [MainThread]: 
[0m10:28:03.805135 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.48 seconds (0.48s).
[0m10:28:03.805739 [debug] [MainThread]: Command end result
[0m10:28:03.824584 [info ] [MainThread]: 
[0m10:28:03.825365 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m10:28:03.825771 [info ] [MainThread]: 
[0m10:28:03.826197 [error] [MainThread]:   Runtime Error in model stg_staging_intermediate_fx_rates_filled (models/intermediate/stg_staging_intermediate_fx_rates_filled.sql)
  Binder Error: Could not choose a best candidate function for the function call "+(STRING_LITERAL, INTERVAL)". In order to select one, please add explicit type casts.
  	Candidate functions:
  	+(DATE, INTERVAL) -> TIMESTAMP
  	+(TIME, INTERVAL) -> TIME
  	+(TIMESTAMP, INTERVAL) -> TIMESTAMP
  	+(TIME WITH TIME ZONE, INTERVAL) -> TIME WITH TIME ZONE
  	+(TIMESTAMP WITH TIME ZONE, INTERVAL) -> TIMESTAMP WITH TIME ZONE
  	+(INTERVAL, INTERVAL) -> INTERVAL
  
  
  LINE 97:     '2025-01-01' + ((interval '1 day') * (row_number() over (order by 1)...
                            ^
[0m10:28:03.826622 [info ] [MainThread]: 
[0m10:28:03.826999 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m10:28:03.827529 [debug] [MainThread]: Command `dbt run` failed at 10:28:03.827428 after 1.02 seconds
[0m10:28:03.827918 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe819411990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8192d6a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8192d7850>]}
[0m10:28:03.828286 [debug] [MainThread]: Flushing usage events
[0m10:29:02.896140 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f6f404c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f6efa0e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f70842f90>]}


============================== 10:29:02.901723 | 41bb05b7-3b41-4460-9f2f-2e700836dda2 ==============================
[0m10:29:02.901723 [info ] [MainThread]: Running with dbt=1.6.18
[0m10:29:02.902372 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/workspaces/vg_case_study_tim/transformation', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/workspaces/vg_case_study_tim/transformation/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select stg_staging_intermediate_fx_rates_filled', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:29:03.105107 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '41bb05b7-3b41-4460-9f2f-2e700836dda2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f6f0aba90>]}
[0m10:29:03.120383 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '41bb05b7-3b41-4460-9f2f-2e700836dda2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f6ec26310>]}
[0m10:29:03.122075 [info ] [MainThread]: Registered adapter: duckdb=1.6.2
[0m10:29:03.149792 [debug] [MainThread]: checksum: 7b9fab86a08e9e96a48a825af743c566d95b877e068b8c6d0dbafbf714447189, vars: {}, profile: , target: , version: 1.6.18
[0m10:29:03.250426 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:29:03.251257 [debug] [MainThread]: Partial parsing: updated file: vg_casestudy://models/intermediate/stg_staging_intermediate_fx_rates_filled.sql
[0m10:29:03.326237 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.vg_casestudy.marts
- models.vg_casestudy.reporting
- models.vg_casestudy.main
[0m10:29:03.376750 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '41bb05b7-3b41-4460-9f2f-2e700836dda2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f6ac993d0>]}
[0m10:29:03.405681 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '41bb05b7-3b41-4460-9f2f-2e700836dda2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f6aca40d0>]}
[0m10:29:03.406306 [info ] [MainThread]: Found 12 models, 1 analysis, 3 seeds, 74 tests, 5 sources, 0 exposures, 0 metrics, 632 macros, 0 groups, 0 semantic models
[0m10:29:03.406727 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '41bb05b7-3b41-4460-9f2f-2e700836dda2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f6f3f7610>]}
[0m10:29:03.409024 [info ] [MainThread]: 
[0m10:29:03.409839 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m10:29:03.411912 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_casestudy'
[0m10:29:03.420061 [debug] [ThreadPool]: Using duckdb connection "list_casestudy"
[0m10:29:03.420775 [debug] [ThreadPool]: On list_casestudy: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"casestudy"'
    
  
  
[0m10:29:03.421462 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:29:03.545048 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:29:03.546834 [debug] [ThreadPool]: On list_casestudy: Close
[0m10:29:03.552692 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy, now create_casestudy_intermediate)
[0m10:29:03.553607 [debug] [ThreadPool]: Creating schema "database: "casestudy"
schema: "intermediate"
"
[0m10:29:03.558380 [debug] [ThreadPool]: Using duckdb connection "create_casestudy_intermediate"
[0m10:29:03.558790 [debug] [ThreadPool]: On create_casestudy_intermediate: BEGIN
[0m10:29:03.559119 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:29:03.571796 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:29:03.572249 [debug] [ThreadPool]: Using duckdb connection "create_casestudy_intermediate"
[0m10:29:03.572570 [debug] [ThreadPool]: On create_casestudy_intermediate: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "create_casestudy_intermediate"} */
create schema if not exists "casestudy"."intermediate"
[0m10:29:03.573280 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:29:03.574296 [debug] [ThreadPool]: On create_casestudy_intermediate: COMMIT
[0m10:29:03.574620 [debug] [ThreadPool]: Using duckdb connection "create_casestudy_intermediate"
[0m10:29:03.574902 [debug] [ThreadPool]: On create_casestudy_intermediate: COMMIT
[0m10:29:03.575547 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:29:03.575920 [debug] [ThreadPool]: On create_casestudy_intermediate: Close
[0m10:29:03.580234 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_casestudy_intermediate, now list_casestudy_staging)
[0m10:29:03.586392 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_staging"
[0m10:29:03.586860 [debug] [ThreadPool]: On list_casestudy_staging: BEGIN
[0m10:29:03.587150 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:29:03.602038 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:29:03.602764 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_staging"
[0m10:29:03.603157 [debug] [ThreadPool]: On list_casestudy_staging: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_staging"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'staging'
    and table_catalog = 'casestudy'
  
[0m10:29:03.618134 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:29:03.619741 [debug] [ThreadPool]: On list_casestudy_staging: ROLLBACK
[0m10:29:03.620923 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_staging'
[0m10:29:03.621309 [debug] [ThreadPool]: On list_casestudy_staging: Close
[0m10:29:03.624785 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy_staging, now list_casestudy_raw)
[0m10:29:03.628199 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_raw"
[0m10:29:03.628603 [debug] [ThreadPool]: On list_casestudy_raw: BEGIN
[0m10:29:03.628883 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:29:03.641566 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:29:03.641997 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_raw"
[0m10:29:03.642293 [debug] [ThreadPool]: On list_casestudy_raw: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_raw"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'raw'
    and table_catalog = 'casestudy'
  
[0m10:29:03.653433 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:29:03.654924 [debug] [ThreadPool]: On list_casestudy_raw: ROLLBACK
[0m10:29:03.655447 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_raw'
[0m10:29:03.655763 [debug] [ThreadPool]: On list_casestudy_raw: Close
[0m10:29:03.658961 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy_raw, now list_casestudy_intermediate)
[0m10:29:03.663612 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_intermediate"
[0m10:29:03.664216 [debug] [ThreadPool]: On list_casestudy_intermediate: BEGIN
[0m10:29:03.664559 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:29:03.676548 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:29:03.676987 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_intermediate"
[0m10:29:03.677476 [debug] [ThreadPool]: On list_casestudy_intermediate: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_intermediate"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'intermediate'
    and table_catalog = 'casestudy'
  
[0m10:29:03.688980 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:29:03.690520 [debug] [ThreadPool]: On list_casestudy_intermediate: ROLLBACK
[0m10:29:03.691060 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_intermediate'
[0m10:29:03.691353 [debug] [ThreadPool]: On list_casestudy_intermediate: Close
[0m10:29:03.695251 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '41bb05b7-3b41-4460-9f2f-2e700836dda2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f6f32cfd0>]}
[0m10:29:03.695812 [debug] [MainThread]: Using duckdb connection "master"
[0m10:29:03.696166 [debug] [MainThread]: On master: BEGIN
[0m10:29:03.696443 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:29:03.711617 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m10:29:03.712083 [debug] [MainThread]: On master: COMMIT
[0m10:29:03.712394 [debug] [MainThread]: Using duckdb connection "master"
[0m10:29:03.712662 [debug] [MainThread]: On master: COMMIT
[0m10:29:03.713256 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m10:29:03.713688 [debug] [MainThread]: On master: Close
[0m10:29:03.717224 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:29:03.717912 [info ] [MainThread]: 
[0m10:29:03.722975 [debug] [Thread-1 (]: Began running node model.vg_casestudy.stg_staging_intermediate_fx_rates_filled
[0m10:29:03.723577 [info ] [Thread-1 (]: 1 of 1 START sql table model intermediate.stg_staging_intermediate_fx_rates_filled  [RUN]
[0m10:29:03.724473 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.vg_casestudy.stg_staging_intermediate_fx_rates_filled'
[0m10:29:03.724865 [debug] [Thread-1 (]: Began compiling node model.vg_casestudy.stg_staging_intermediate_fx_rates_filled
[0m10:29:03.753308 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate_fx_rates_filled"
[0m10:29:03.753969 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate_fx_rates_filled: BEGIN
[0m10:29:03.754370 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:29:03.771862 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m10:29:03.772385 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate_fx_rates_filled"
[0m10:29:03.772801 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate_fx_rates_filled: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_staging_intermediate_fx_rates_filled"} */


        select 
        ((date('2025-03-10'))::date - (date('2025-01-01'))::date)
    
[0m10:29:03.774860 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m10:29:03.778194 [debug] [Thread-1 (]: Writing injected SQL for node "model.vg_casestudy.stg_staging_intermediate_fx_rates_filled"
[0m10:29:03.779059 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.stg_staging_intermediate_fx_rates_filled (compile): 10:29:03.725134 => 10:29:03.778803
[0m10:29:03.779551 [debug] [Thread-1 (]: Began executing node model.vg_casestudy.stg_staging_intermediate_fx_rates_filled
[0m10:29:03.821581 [debug] [Thread-1 (]: Writing runtime sql for node "model.vg_casestudy.stg_staging_intermediate_fx_rates_filled"
[0m10:29:03.822385 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate_fx_rates_filled"
[0m10:29:03.822835 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate_fx_rates_filled: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_staging_intermediate_fx_rates_filled"} */

  
    
    

    create  table
      "casestudy"."intermediate"."stg_staging_intermediate_fx_rates_filled__dbt_tmp"
  
    as (
      with calendar as (

    





with rawdata as (

    

    

    with p as (
        select 0 as generated_number union all select 1
    ), unioned as (

    select

    
    p0.generated_number * power(2, 0)
     + 
    
    p1.generated_number * power(2, 1)
     + 
    
    p2.generated_number * power(2, 2)
     + 
    
    p3.generated_number * power(2, 3)
     + 
    
    p4.generated_number * power(2, 4)
     + 
    
    p5.generated_number * power(2, 5)
     + 
    
    p6.generated_number * power(2, 6)
    
    
    + 1
    as generated_number

    from

    
    p as p0
     cross join 
    
    p as p1
     cross join 
    
    p as p2
     cross join 
    
    p as p3
     cross join 
    
    p as p4
     cross join 
    
    p as p5
     cross join 
    
    p as p6
    
    

    )

    select *
    from unioned
    where generated_number <= 68
    order by generated_number



),

all_periods as (

    select (
        

    date('2025-01-01') + ((interval '1 day') * (row_number() over (order by 1) - 1))


    ) as date_day
    from rawdata

),

filtered as (

    select *
    from all_periods
    where date_day <= date('2025-03-10')

)

select * from filtered



),

currencies as (
    select distinct trim(currency_iso_code) as currency_iso_code
    from "casestudy"."raw"."fx_rates_full_history"
),

date_matrix as (
    select 
        currencies.currency_iso_code,
        calendar.date_day as fx_rate_date
    from currencies
    cross join calendar 

),

joined as (
    select 
        date_matrix.currency_iso_code,
        date_matrix.fx_rate_date,
        fx_rates_full_history.fx_rate
    from date_matrix
    left join "casestudy"."raw"."fx_rates_full_history" as fx_rates_full_history
    on date_matrix.currency_iso_code = fx_rates_full_history.currency_iso_code
    and date_matrix.fx_rate_date = fx_rates_full_history.fx_rate_date
),

forward_fill_dates as (
    select 
        currency_iso_code,
        fx_rate_date,

        last_value(fx_rate ignore nulls) over(
            partition by currency_iso_code
            order by fx_rate_date asc
            rows between unbounded preceding and current row
        ) as fx_rate
    from joined
)

select *
from forward_fill_dates
    );
  
  
[0m10:29:03.845047 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m10:29:03.852544 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate_fx_rates_filled"
[0m10:29:03.853108 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate_fx_rates_filled: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_staging_intermediate_fx_rates_filled"} */
alter table "casestudy"."intermediate"."stg_staging_intermediate_fx_rates_filled__dbt_tmp" rename to "stg_staging_intermediate_fx_rates_filled"
[0m10:29:03.854057 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m10:29:03.871045 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate_fx_rates_filled: COMMIT
[0m10:29:03.871484 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate_fx_rates_filled"
[0m10:29:03.871861 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate_fx_rates_filled: COMMIT
[0m10:29:03.878874 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m10:29:03.885094 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate_fx_rates_filled"
[0m10:29:03.885550 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate_fx_rates_filled: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_staging_intermediate_fx_rates_filled"} */
drop table if exists "casestudy"."intermediate"."stg_staging_intermediate_fx_rates_filled__dbt_backup" cascade
[0m10:29:03.886478 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m10:29:03.887900 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.stg_staging_intermediate_fx_rates_filled (execute): 10:29:03.779823 => 10:29:03.887754
[0m10:29:03.888280 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate_fx_rates_filled: Close
[0m10:29:03.919286 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '41bb05b7-3b41-4460-9f2f-2e700836dda2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f6ad02450>]}
[0m10:29:03.920008 [info ] [Thread-1 (]: 1 of 1 OK created sql table model intermediate.stg_staging_intermediate_fx_rates_filled  [[32mOK[0m in 0.20s]
[0m10:29:03.920665 [debug] [Thread-1 (]: Finished running node model.vg_casestudy.stg_staging_intermediate_fx_rates_filled
[0m10:29:03.922450 [debug] [MainThread]: Using duckdb connection "master"
[0m10:29:03.922781 [debug] [MainThread]: On master: BEGIN
[0m10:29:03.923052 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:29:03.936556 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m10:29:03.937078 [debug] [MainThread]: On master: COMMIT
[0m10:29:03.937521 [debug] [MainThread]: Using duckdb connection "master"
[0m10:29:03.937950 [debug] [MainThread]: On master: COMMIT
[0m10:29:03.938835 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m10:29:03.939442 [debug] [MainThread]: On master: Close
[0m10:29:03.942350 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:29:03.942783 [debug] [MainThread]: Connection 'list_casestudy_intermediate' was properly closed.
[0m10:29:03.943067 [debug] [MainThread]: Connection 'model.vg_casestudy.stg_staging_intermediate_fx_rates_filled' was properly closed.
[0m10:29:03.943412 [info ] [MainThread]: 
[0m10:29:03.943773 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.53 seconds (0.53s).
[0m10:29:03.944350 [debug] [MainThread]: Command end result
[0m10:29:03.962312 [info ] [MainThread]: 
[0m10:29:03.962845 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:29:03.963176 [info ] [MainThread]: 
[0m10:29:03.963506 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m10:29:03.964074 [debug] [MainThread]: Command `dbt run` succeeded at 10:29:03.963939 after 1.08 seconds
[0m10:29:03.964588 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f738deb50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f73a66290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f73a674d0>]}
[0m10:29:03.964980 [debug] [MainThread]: Flushing usage events
[0m10:43:22.697841 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f372297d550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3722f65550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3722c34390>]}


============================== 10:43:22.703673 | 18e45fe8-e3f6-462a-b501-4dea0126bdf2 ==============================
[0m10:43:22.703673 [info ] [MainThread]: Running with dbt=1.6.18
[0m10:43:22.704265 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/workspaces/vg_case_study_tim/transformation', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/workspaces/vg_case_study_tim/transformation/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select stg_staging_intermediate_fx_rates_filled', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:43:22.898702 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '18e45fe8-e3f6-462a-b501-4dea0126bdf2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3722c438d0>]}
[0m10:43:22.913806 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '18e45fe8-e3f6-462a-b501-4dea0126bdf2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3722b2ed90>]}
[0m10:43:22.915430 [info ] [MainThread]: Registered adapter: duckdb=1.6.2
[0m10:43:22.945354 [debug] [MainThread]: checksum: 7b9fab86a08e9e96a48a825af743c566d95b877e068b8c6d0dbafbf714447189, vars: {}, profile: , target: , version: 1.6.18
[0m10:43:23.039189 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:43:23.040003 [debug] [MainThread]: Partial parsing: updated file: vg_casestudy://models/intermediate/stg_staging_intermediate_fx_rates_filled.sql
[0m10:43:23.116427 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.vg_casestudy.marts
- models.vg_casestudy.main
- models.vg_casestudy.reporting
[0m10:43:23.167513 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '18e45fe8-e3f6-462a-b501-4dea0126bdf2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f371e873d90>]}
[0m10:43:23.195684 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '18e45fe8-e3f6-462a-b501-4dea0126bdf2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f371e9f2190>]}
[0m10:43:23.196241 [info ] [MainThread]: Found 12 models, 1 analysis, 3 seeds, 74 tests, 5 sources, 0 exposures, 0 metrics, 632 macros, 0 groups, 0 semantic models
[0m10:43:23.196650 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '18e45fe8-e3f6-462a-b501-4dea0126bdf2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3722cd1f90>]}
[0m10:43:23.198929 [info ] [MainThread]: 
[0m10:43:23.199720 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m10:43:23.200850 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_casestudy'
[0m10:43:23.208680 [debug] [ThreadPool]: Using duckdb connection "list_casestudy"
[0m10:43:23.209168 [debug] [ThreadPool]: On list_casestudy: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"casestudy"'
    
  
  
[0m10:43:23.209466 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:43:23.346261 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:43:23.348168 [debug] [ThreadPool]: On list_casestudy: Close
[0m10:43:23.353062 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy, now create_casestudy_intermediate)
[0m10:43:23.353925 [debug] [ThreadPool]: Creating schema "database: "casestudy"
schema: "intermediate"
"
[0m10:43:23.359258 [debug] [ThreadPool]: Using duckdb connection "create_casestudy_intermediate"
[0m10:43:23.359690 [debug] [ThreadPool]: On create_casestudy_intermediate: BEGIN
[0m10:43:23.360021 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:43:23.374766 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:43:23.375247 [debug] [ThreadPool]: Using duckdb connection "create_casestudy_intermediate"
[0m10:43:23.375567 [debug] [ThreadPool]: On create_casestudy_intermediate: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "create_casestudy_intermediate"} */
create schema if not exists "casestudy"."intermediate"
[0m10:43:23.376375 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:43:23.377382 [debug] [ThreadPool]: On create_casestudy_intermediate: COMMIT
[0m10:43:23.377741 [debug] [ThreadPool]: Using duckdb connection "create_casestudy_intermediate"
[0m10:43:23.378066 [debug] [ThreadPool]: On create_casestudy_intermediate: COMMIT
[0m10:43:23.378926 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:43:23.379310 [debug] [ThreadPool]: On create_casestudy_intermediate: Close
[0m10:43:23.383792 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_casestudy_intermediate, now list_casestudy_staging)
[0m10:43:23.389840 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_staging"
[0m10:43:23.390323 [debug] [ThreadPool]: On list_casestudy_staging: BEGIN
[0m10:43:23.390697 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:43:23.404571 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:43:23.405169 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_staging"
[0m10:43:23.405624 [debug] [ThreadPool]: On list_casestudy_staging: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_staging"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'staging'
    and table_catalog = 'casestudy'
  
[0m10:43:23.420900 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:43:23.423029 [debug] [ThreadPool]: On list_casestudy_staging: ROLLBACK
[0m10:43:23.424395 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_staging'
[0m10:43:23.424770 [debug] [ThreadPool]: On list_casestudy_staging: Close
[0m10:43:23.428152 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy_staging, now list_casestudy_intermediate)
[0m10:43:23.431504 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_intermediate"
[0m10:43:23.431918 [debug] [ThreadPool]: On list_casestudy_intermediate: BEGIN
[0m10:43:23.432187 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:43:23.443505 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:43:23.443910 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_intermediate"
[0m10:43:23.444212 [debug] [ThreadPool]: On list_casestudy_intermediate: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_intermediate"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'intermediate'
    and table_catalog = 'casestudy'
  
[0m10:43:23.452499 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:43:23.453867 [debug] [ThreadPool]: On list_casestudy_intermediate: ROLLBACK
[0m10:43:23.454345 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_intermediate'
[0m10:43:23.454608 [debug] [ThreadPool]: On list_casestudy_intermediate: Close
[0m10:43:23.457544 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy_intermediate, now list_casestudy_raw)
[0m10:43:23.460633 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_raw"
[0m10:43:23.461020 [debug] [ThreadPool]: On list_casestudy_raw: BEGIN
[0m10:43:23.462350 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:43:23.473807 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:43:23.474253 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_raw"
[0m10:43:23.474572 [debug] [ThreadPool]: On list_casestudy_raw: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_raw"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'raw'
    and table_catalog = 'casestudy'
  
[0m10:43:23.483404 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:43:23.484982 [debug] [ThreadPool]: On list_casestudy_raw: ROLLBACK
[0m10:43:23.485507 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_raw'
[0m10:43:23.485833 [debug] [ThreadPool]: On list_casestudy_raw: Close
[0m10:43:23.490209 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '18e45fe8-e3f6-462a-b501-4dea0126bdf2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f371e809850>]}
[0m10:43:23.490817 [debug] [MainThread]: Using duckdb connection "master"
[0m10:43:23.491115 [debug] [MainThread]: On master: BEGIN
[0m10:43:23.491368 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:43:23.503197 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m10:43:23.503643 [debug] [MainThread]: On master: COMMIT
[0m10:43:23.503957 [debug] [MainThread]: Using duckdb connection "master"
[0m10:43:23.504229 [debug] [MainThread]: On master: COMMIT
[0m10:43:23.505072 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m10:43:23.505798 [debug] [MainThread]: On master: Close
[0m10:43:23.508444 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:43:23.508907 [info ] [MainThread]: 
[0m10:43:23.514820 [debug] [Thread-1 (]: Began running node model.vg_casestudy.stg_staging_intermediate_fx_rates_filled
[0m10:43:23.515379 [info ] [Thread-1 (]: 1 of 1 START sql table model intermediate.stg_staging_intermediate_fx_rates_filled  [RUN]
[0m10:43:23.516227 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.vg_casestudy.stg_staging_intermediate_fx_rates_filled'
[0m10:43:23.516674 [debug] [Thread-1 (]: Began compiling node model.vg_casestudy.stg_staging_intermediate_fx_rates_filled
[0m10:43:23.540655 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate_fx_rates_filled"
[0m10:43:23.541193 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate_fx_rates_filled: BEGIN
[0m10:43:23.541725 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:43:23.558958 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m10:43:23.559437 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate_fx_rates_filled"
[0m10:43:23.559781 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate_fx_rates_filled: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_staging_intermediate_fx_rates_filled"} */


        select 
        ((date('2025-03-10'))::date - (date('2024-12-31'))::date)
    
[0m10:43:23.561715 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m10:43:23.564787 [debug] [Thread-1 (]: Writing injected SQL for node "model.vg_casestudy.stg_staging_intermediate_fx_rates_filled"
[0m10:43:23.565474 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.stg_staging_intermediate_fx_rates_filled (compile): 10:43:23.516945 => 10:43:23.565267
[0m10:43:23.565861 [debug] [Thread-1 (]: Began executing node model.vg_casestudy.stg_staging_intermediate_fx_rates_filled
[0m10:43:23.598446 [debug] [Thread-1 (]: Writing runtime sql for node "model.vg_casestudy.stg_staging_intermediate_fx_rates_filled"
[0m10:43:23.599277 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate_fx_rates_filled"
[0m10:43:23.599750 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate_fx_rates_filled: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_staging_intermediate_fx_rates_filled"} */

  
    
    

    create  table
      "casestudy"."intermediate"."stg_staging_intermediate_fx_rates_filled__dbt_tmp"
  
    as (
      with calendar as (

    





with rawdata as (

    

    

    with p as (
        select 0 as generated_number union all select 1
    ), unioned as (

    select

    
    p0.generated_number * power(2, 0)
     + 
    
    p1.generated_number * power(2, 1)
     + 
    
    p2.generated_number * power(2, 2)
     + 
    
    p3.generated_number * power(2, 3)
     + 
    
    p4.generated_number * power(2, 4)
     + 
    
    p5.generated_number * power(2, 5)
     + 
    
    p6.generated_number * power(2, 6)
    
    
    + 1
    as generated_number

    from

    
    p as p0
     cross join 
    
    p as p1
     cross join 
    
    p as p2
     cross join 
    
    p as p3
     cross join 
    
    p as p4
     cross join 
    
    p as p5
     cross join 
    
    p as p6
    
    

    )

    select *
    from unioned
    where generated_number <= 69
    order by generated_number



),

all_periods as (

    select (
        

    date('2024-12-31') + ((interval '1 day') * (row_number() over (order by 1) - 1))


    ) as date_day
    from rawdata

),

filtered as (

    select *
    from all_periods
    where date_day <= date('2025-03-10')

)

select * from filtered



),

currencies as (
    select distinct trim(currency_iso_code) as currency_iso_code
    from "casestudy"."raw"."fx_rates_full_history"
),

date_matrix as (
    select 
        currencies.currency_iso_code,
        calendar.date_day as fx_rate_date
    from currencies
    cross join calendar 

),

joined as (
    select 
        date_matrix.currency_iso_code,
        date_matrix.fx_rate_date,
        fx_rates_full_history.fx_rate
    from date_matrix
    left join "casestudy"."raw"."fx_rates_full_history" as fx_rates_full_history
    on date_matrix.currency_iso_code = fx_rates_full_history.currency_iso_code
    and date_matrix.fx_rate_date = fx_rates_full_history.fx_rate_date
),

forward_fill_dates as (
    select 
        currency_iso_code,
        fx_rate_date,

        last_value(fx_rate ignore nulls) over(
            partition by currency_iso_code
            order by fx_rate_date asc
            rows between unbounded preceding and current row
        ) as fx_rate
    from joined
)

select *
from forward_fill_dates
    );
  
  
[0m10:43:23.621693 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m10:43:23.628180 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate_fx_rates_filled"
[0m10:43:23.628725 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate_fx_rates_filled: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_staging_intermediate_fx_rates_filled"} */
alter table "casestudy"."intermediate"."stg_staging_intermediate_fx_rates_filled" rename to "stg_staging_intermediate_fx_rates_filled__dbt_backup"
[0m10:43:23.629697 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m10:43:23.632579 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate_fx_rates_filled"
[0m10:43:23.632905 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate_fx_rates_filled: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_staging_intermediate_fx_rates_filled"} */
alter table "casestudy"."intermediate"."stg_staging_intermediate_fx_rates_filled__dbt_tmp" rename to "stg_staging_intermediate_fx_rates_filled"
[0m10:43:23.633763 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m10:43:23.652581 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate_fx_rates_filled: COMMIT
[0m10:43:23.653030 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate_fx_rates_filled"
[0m10:43:23.653352 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate_fx_rates_filled: COMMIT
[0m10:43:23.660867 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m10:43:23.666580 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate_fx_rates_filled"
[0m10:43:23.666995 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate_fx_rates_filled: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_staging_intermediate_fx_rates_filled"} */
drop table if exists "casestudy"."intermediate"."stg_staging_intermediate_fx_rates_filled__dbt_backup" cascade
[0m10:43:23.671116 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m10:43:23.672689 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.stg_staging_intermediate_fx_rates_filled (execute): 10:43:23.566084 => 10:43:23.672489
[0m10:43:23.673109 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate_fx_rates_filled: Close
[0m10:43:23.705055 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '18e45fe8-e3f6-462a-b501-4dea0126bdf2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f371e896690>]}
[0m10:43:23.705838 [info ] [Thread-1 (]: 1 of 1 OK created sql table model intermediate.stg_staging_intermediate_fx_rates_filled  [[32mOK[0m in 0.19s]
[0m10:43:23.706506 [debug] [Thread-1 (]: Finished running node model.vg_casestudy.stg_staging_intermediate_fx_rates_filled
[0m10:43:23.708462 [debug] [MainThread]: Using duckdb connection "master"
[0m10:43:23.708821 [debug] [MainThread]: On master: BEGIN
[0m10:43:23.709114 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:43:23.723662 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m10:43:23.724355 [debug] [MainThread]: On master: COMMIT
[0m10:43:23.724711 [debug] [MainThread]: Using duckdb connection "master"
[0m10:43:23.725008 [debug] [MainThread]: On master: COMMIT
[0m10:43:23.725942 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m10:43:23.726413 [debug] [MainThread]: On master: Close
[0m10:43:23.729084 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:43:23.729450 [debug] [MainThread]: Connection 'list_casestudy_raw' was properly closed.
[0m10:43:23.729719 [debug] [MainThread]: Connection 'model.vg_casestudy.stg_staging_intermediate_fx_rates_filled' was properly closed.
[0m10:43:23.730029 [info ] [MainThread]: 
[0m10:43:23.730361 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.53 seconds (0.53s).
[0m10:43:23.730945 [debug] [MainThread]: Command end result
[0m10:43:23.779382 [info ] [MainThread]: 
[0m10:43:23.779952 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:43:23.780407 [info ] [MainThread]: 
[0m10:43:23.780828 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m10:43:23.781372 [debug] [MainThread]: Command `dbt run` succeeded at 10:43:23.781241 after 1.09 seconds
[0m10:43:23.781753 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f372448ae10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37274c0e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3723dc4710>]}
[0m10:43:23.782103 [debug] [MainThread]: Flushing usage events
[0m10:48:47.406731 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa383932350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa383afa510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa383806650>]}


============================== 10:48:47.412716 | d4bae58c-975d-4165-a742-6e33ea7d4c9a ==============================
[0m10:48:47.412716 [info ] [MainThread]: Running with dbt=1.6.18
[0m10:48:47.413293 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/workspaces/vg_case_study_tim/transformation/logs', 'profiles_dir': '/workspaces/vg_case_study_tim/transformation', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --select stg_staging_intermediate_fx_rates_filled', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:48:47.619577 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd4bae58c-975d-4165-a742-6e33ea7d4c9a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3837ee950>]}
[0m10:48:47.634154 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd4bae58c-975d-4165-a742-6e33ea7d4c9a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3838f8a50>]}
[0m10:48:47.635783 [info ] [MainThread]: Registered adapter: duckdb=1.6.2
[0m10:48:47.666900 [debug] [MainThread]: checksum: 7b9fab86a08e9e96a48a825af743c566d95b877e068b8c6d0dbafbf714447189, vars: {}, profile: , target: , version: 1.6.18
[0m10:48:47.763937 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:48:47.764779 [debug] [MainThread]: Partial parsing: updated file: vg_casestudy://models/intermediate/stg_staging_intermediate_fx_rates_filled.sql
[0m10:48:47.883319 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.vg_casestudy.marts
- models.vg_casestudy.main
- models.vg_casestudy.reporting
[0m10:48:47.890042 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd4bae58c-975d-4165-a742-6e33ea7d4c9a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3834af410>]}
[0m10:48:47.923818 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd4bae58c-975d-4165-a742-6e33ea7d4c9a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa37f4ed3d0>]}
[0m10:48:47.924430 [info ] [MainThread]: Found 12 models, 1 analysis, 3 seeds, 74 tests, 5 sources, 0 exposures, 0 metrics, 632 macros, 0 groups, 0 semantic models
[0m10:48:47.924837 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd4bae58c-975d-4165-a742-6e33ea7d4c9a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3854186d0>]}
[0m10:48:47.927075 [info ] [MainThread]: 
[0m10:48:47.927842 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m10:48:47.929995 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_casestudy'
[0m10:48:47.938225 [debug] [ThreadPool]: Using duckdb connection "list_casestudy"
[0m10:48:47.939041 [debug] [ThreadPool]: On list_casestudy: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"casestudy"'
    
  
  
[0m10:48:47.939408 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:48:48.070827 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:48:48.072489 [debug] [ThreadPool]: On list_casestudy: Close
[0m10:48:48.075896 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy, now create_casestudy_intermediate)
[0m10:48:48.076689 [debug] [ThreadPool]: Creating schema "database: "casestudy"
schema: "intermediate"
"
[0m10:48:48.081402 [debug] [ThreadPool]: Using duckdb connection "create_casestudy_intermediate"
[0m10:48:48.081829 [debug] [ThreadPool]: On create_casestudy_intermediate: BEGIN
[0m10:48:48.082148 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:48:48.095392 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:48:48.095890 [debug] [ThreadPool]: Using duckdb connection "create_casestudy_intermediate"
[0m10:48:48.096247 [debug] [ThreadPool]: On create_casestudy_intermediate: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "create_casestudy_intermediate"} */
create schema if not exists "casestudy"."intermediate"
[0m10:48:48.096978 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:48:48.098002 [debug] [ThreadPool]: On create_casestudy_intermediate: COMMIT
[0m10:48:48.098347 [debug] [ThreadPool]: Using duckdb connection "create_casestudy_intermediate"
[0m10:48:48.098632 [debug] [ThreadPool]: On create_casestudy_intermediate: COMMIT
[0m10:48:48.099391 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:48:48.099848 [debug] [ThreadPool]: On create_casestudy_intermediate: Close
[0m10:48:48.105360 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_casestudy_intermediate, now list_casestudy_raw)
[0m10:48:48.111184 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_raw"
[0m10:48:48.111577 [debug] [ThreadPool]: On list_casestudy_raw: BEGIN
[0m10:48:48.111865 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:48:48.123615 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:48:48.124029 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_raw"
[0m10:48:48.124351 [debug] [ThreadPool]: On list_casestudy_raw: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_raw"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'raw'
    and table_catalog = 'casestudy'
  
[0m10:48:48.139539 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:48:48.140992 [debug] [ThreadPool]: On list_casestudy_raw: ROLLBACK
[0m10:48:48.142535 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_raw'
[0m10:48:48.142847 [debug] [ThreadPool]: On list_casestudy_raw: Close
[0m10:48:48.145908 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy_raw, now list_casestudy_staging)
[0m10:48:48.148808 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_staging"
[0m10:48:48.149234 [debug] [ThreadPool]: On list_casestudy_staging: BEGIN
[0m10:48:48.150977 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:48:48.161762 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:48:48.162157 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_staging"
[0m10:48:48.162475 [debug] [ThreadPool]: On list_casestudy_staging: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_staging"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'staging'
    and table_catalog = 'casestudy'
  
[0m10:48:48.171018 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:48:48.172426 [debug] [ThreadPool]: On list_casestudy_staging: ROLLBACK
[0m10:48:48.172901 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_staging'
[0m10:48:48.173213 [debug] [ThreadPool]: On list_casestudy_staging: Close
[0m10:48:48.176192 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy_staging, now list_casestudy_intermediate)
[0m10:48:48.178379 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_intermediate"
[0m10:48:48.178724 [debug] [ThreadPool]: On list_casestudy_intermediate: BEGIN
[0m10:48:48.179058 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:48:48.190093 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:48:48.190493 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_intermediate"
[0m10:48:48.190803 [debug] [ThreadPool]: On list_casestudy_intermediate: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_intermediate"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'intermediate'
    and table_catalog = 'casestudy'
  
[0m10:48:48.199156 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:48:48.200665 [debug] [ThreadPool]: On list_casestudy_intermediate: ROLLBACK
[0m10:48:48.201146 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_intermediate'
[0m10:48:48.201437 [debug] [ThreadPool]: On list_casestudy_intermediate: Close
[0m10:48:48.205281 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd4bae58c-975d-4165-a742-6e33ea7d4c9a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3834f49d0>]}
[0m10:48:48.205768 [debug] [MainThread]: Using duckdb connection "master"
[0m10:48:48.206043 [debug] [MainThread]: On master: BEGIN
[0m10:48:48.206292 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:48:48.219026 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m10:48:48.219497 [debug] [MainThread]: On master: COMMIT
[0m10:48:48.219771 [debug] [MainThread]: Using duckdb connection "master"
[0m10:48:48.220033 [debug] [MainThread]: On master: COMMIT
[0m10:48:48.220673 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m10:48:48.220990 [debug] [MainThread]: On master: Close
[0m10:48:48.223747 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:48:48.224206 [info ] [MainThread]: 
[0m10:48:48.229911 [debug] [Thread-1 (]: Began running node model.vg_casestudy.stg_staging_intermediate_fx_rates_filled
[0m10:48:48.230476 [info ] [Thread-1 (]: 1 of 1 START sql table model intermediate.stg_staging_intermediate_fx_rates_filled  [RUN]
[0m10:48:48.231936 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.vg_casestudy.stg_staging_intermediate_fx_rates_filled'
[0m10:48:48.232530 [debug] [Thread-1 (]: Began compiling node model.vg_casestudy.stg_staging_intermediate_fx_rates_filled
[0m10:48:48.256987 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate_fx_rates_filled"
[0m10:48:48.257463 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate_fx_rates_filled: BEGIN
[0m10:48:48.257810 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:48:48.273242 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m10:48:48.273716 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate_fx_rates_filled"
[0m10:48:48.274057 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate_fx_rates_filled: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_staging_intermediate_fx_rates_filled"} */


        select 
        ((date('2025-03-10'))::date - (date('2024-12-31'))::date)
    
[0m10:48:48.276130 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m10:48:48.279927 [debug] [Thread-1 (]: Writing injected SQL for node "model.vg_casestudy.stg_staging_intermediate_fx_rates_filled"
[0m10:48:48.280629 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.stg_staging_intermediate_fx_rates_filled (compile): 10:48:48.232908 => 10:48:48.280389
[0m10:48:48.280997 [debug] [Thread-1 (]: Began executing node model.vg_casestudy.stg_staging_intermediate_fx_rates_filled
[0m10:48:48.314879 [debug] [Thread-1 (]: Writing runtime sql for node "model.vg_casestudy.stg_staging_intermediate_fx_rates_filled"
[0m10:48:48.315712 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate_fx_rates_filled"
[0m10:48:48.316235 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate_fx_rates_filled: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_staging_intermediate_fx_rates_filled"} */

  
    
    

    create  table
      "casestudy"."intermediate"."stg_staging_intermediate_fx_rates_filled__dbt_tmp"
  
    as (
      with calendar as (

    





with rawdata as (

    

    

    with p as (
        select 0 as generated_number union all select 1
    ), unioned as (

    select

    
    p0.generated_number * power(2, 0)
     + 
    
    p1.generated_number * power(2, 1)
     + 
    
    p2.generated_number * power(2, 2)
     + 
    
    p3.generated_number * power(2, 3)
     + 
    
    p4.generated_number * power(2, 4)
     + 
    
    p5.generated_number * power(2, 5)
     + 
    
    p6.generated_number * power(2, 6)
    
    
    + 1
    as generated_number

    from

    
    p as p0
     cross join 
    
    p as p1
     cross join 
    
    p as p2
     cross join 
    
    p as p3
     cross join 
    
    p as p4
     cross join 
    
    p as p5
     cross join 
    
    p as p6
    
    

    )

    select *
    from unioned
    where generated_number <= 69
    order by generated_number



),

all_periods as (

    select (
        

    date('2024-12-31') + ((interval '1 day') * (row_number() over (order by 1) - 1))


    ) as date_day
    from rawdata

),

filtered as (

    select *
    from all_periods
    where date_day <= date('2025-03-10')

)

select * from filtered



),

currencies as (
    select distinct trim(currency_iso_code) as currency_iso_code
    from "casestudy"."raw"."fx_rates_full_history"
),

date_matrix as (
    select 
        currencies.currency_iso_code,
        calendar.date_day as fx_rate_date
    from currencies
    cross join calendar 

),

joined as (
    select 
        date_matrix.currency_iso_code,
        date_matrix.fx_rate_date,
        fx_rates_full_history.fx_rate
    from date_matrix
    left join "casestudy"."raw"."fx_rates_full_history" as fx_rates_full_history
    on date_matrix.currency_iso_code = fx_rates_full_history.currency_iso_code
    and date_matrix.fx_rate_date = fx_rates_full_history.fx_rate_date
),

forward_fill_dates as (
    select 
        currency_iso_code,
        fx_rate_date::date as fx_rate_date,

        last_value(fx_rate ignore nulls) over(
            partition by currency_iso_code
            order by fx_rate_date asc
            rows between unbounded preceding and current row
        ) as fx_rate
    from joined
)

select *
from forward_fill_dates
    );
  
  
[0m10:48:48.342682 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m10:48:48.348853 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate_fx_rates_filled"
[0m10:48:48.349311 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate_fx_rates_filled: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_staging_intermediate_fx_rates_filled"} */
alter table "casestudy"."intermediate"."stg_staging_intermediate_fx_rates_filled" rename to "stg_staging_intermediate_fx_rates_filled__dbt_backup"
[0m10:48:48.350299 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m10:48:48.353411 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate_fx_rates_filled"
[0m10:48:48.353849 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate_fx_rates_filled: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_staging_intermediate_fx_rates_filled"} */
alter table "casestudy"."intermediate"."stg_staging_intermediate_fx_rates_filled__dbt_tmp" rename to "stg_staging_intermediate_fx_rates_filled"
[0m10:48:48.355028 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m10:48:48.374799 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate_fx_rates_filled: COMMIT
[0m10:48:48.375298 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate_fx_rates_filled"
[0m10:48:48.375630 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate_fx_rates_filled: COMMIT
[0m10:48:48.381943 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m10:48:48.387346 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate_fx_rates_filled"
[0m10:48:48.387755 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate_fx_rates_filled: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_staging_intermediate_fx_rates_filled"} */
drop table if exists "casestudy"."intermediate"."stg_staging_intermediate_fx_rates_filled__dbt_backup" cascade
[0m10:48:48.393112 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m10:48:48.394649 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.stg_staging_intermediate_fx_rates_filled (execute): 10:48:48.281267 => 10:48:48.394485
[0m10:48:48.395011 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate_fx_rates_filled: Close
[0m10:48:48.424502 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd4bae58c-975d-4165-a742-6e33ea7d4c9a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa37f5ff050>]}
[0m10:48:48.425262 [info ] [Thread-1 (]: 1 of 1 OK created sql table model intermediate.stg_staging_intermediate_fx_rates_filled  [[32mOK[0m in 0.19s]
[0m10:48:48.425888 [debug] [Thread-1 (]: Finished running node model.vg_casestudy.stg_staging_intermediate_fx_rates_filled
[0m10:48:48.427693 [debug] [MainThread]: Using duckdb connection "master"
[0m10:48:48.428012 [debug] [MainThread]: On master: BEGIN
[0m10:48:48.428341 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:48:48.443161 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m10:48:48.443585 [debug] [MainThread]: On master: COMMIT
[0m10:48:48.443912 [debug] [MainThread]: Using duckdb connection "master"
[0m10:48:48.444191 [debug] [MainThread]: On master: COMMIT
[0m10:48:48.444694 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m10:48:48.445062 [debug] [MainThread]: On master: Close
[0m10:48:48.447818 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:48:48.448228 [debug] [MainThread]: Connection 'list_casestudy_intermediate' was properly closed.
[0m10:48:48.448506 [debug] [MainThread]: Connection 'model.vg_casestudy.stg_staging_intermediate_fx_rates_filled' was properly closed.
[0m10:48:48.448881 [info ] [MainThread]: 
[0m10:48:48.449277 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.52 seconds (0.52s).
[0m10:48:48.450042 [debug] [MainThread]: Command end result
[0m10:48:48.468309 [info ] [MainThread]: 
[0m10:48:48.468885 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:48:48.469253 [info ] [MainThread]: 
[0m10:48:48.469578 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m10:48:48.470167 [debug] [MainThread]: Command `dbt run` succeeded at 10:48:48.470012 after 1.07 seconds
[0m10:48:48.470665 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3836530d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa38364f3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3838fbe50>]}
[0m10:48:48.471335 [debug] [MainThread]: Flushing usage events
[0m10:56:25.368342 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4a02237d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4a03a9510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4a2dad610>]}


============================== 10:56:25.373943 | 8a38e847-6d8c-4952-9146-1b3c31bd8f1b ==============================
[0m10:56:25.373943 [info ] [MainThread]: Running with dbt=1.6.18
[0m10:56:25.374508 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/workspaces/vg_case_study_tim/transformation/logs', 'profiles_dir': '/workspaces/vg_case_study_tim/transformation', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --select stg_staging_intermediate_fx_rates_filled', 'send_anonymous_usage_stats': 'True'}
[0m10:56:25.577762 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8a38e847-6d8c-4952-9146-1b3c31bd8f1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4a04f38d0>]}
[0m10:56:25.592739 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8a38e847-6d8c-4952-9146-1b3c31bd8f1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4a07fe590>]}
[0m10:56:25.594142 [info ] [MainThread]: Registered adapter: duckdb=1.6.2
[0m10:56:25.622086 [debug] [MainThread]: checksum: 7b9fab86a08e9e96a48a825af743c566d95b877e068b8c6d0dbafbf714447189, vars: {}, profile: , target: , version: 1.6.18
[0m10:56:25.718292 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:56:25.719105 [debug] [MainThread]: Partial parsing: updated file: vg_casestudy://models/intermediate/stg_staging_intermediate_fx_rates_filled.sql
[0m10:56:25.833612 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.vg_casestudy.main
- models.vg_casestudy.marts
- models.vg_casestudy.reporting
[0m10:56:25.840445 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8a38e847-6d8c-4952-9146-1b3c31bd8f1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa49c13d850>]}
[0m10:56:25.872241 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8a38e847-6d8c-4952-9146-1b3c31bd8f1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa49cb4ea10>]}
[0m10:56:25.872886 [info ] [MainThread]: Found 12 models, 1 analysis, 3 seeds, 74 tests, 5 sources, 0 exposures, 0 metrics, 632 macros, 0 groups, 0 semantic models
[0m10:56:25.873296 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8a38e847-6d8c-4952-9146-1b3c31bd8f1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4a021fb90>]}
[0m10:56:25.875389 [info ] [MainThread]: 
[0m10:56:25.876136 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m10:56:25.878239 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_casestudy'
[0m10:56:25.886083 [debug] [ThreadPool]: Using duckdb connection "list_casestudy"
[0m10:56:25.886550 [debug] [ThreadPool]: On list_casestudy: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"casestudy"'
    
  
  
[0m10:56:25.886902 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:56:26.017244 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:56:26.019256 [debug] [ThreadPool]: On list_casestudy: Close
[0m10:56:26.024160 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy, now create_casestudy_intermediate)
[0m10:56:26.024956 [debug] [ThreadPool]: Creating schema "database: "casestudy"
schema: "intermediate"
"
[0m10:56:26.029545 [debug] [ThreadPool]: Using duckdb connection "create_casestudy_intermediate"
[0m10:56:26.029948 [debug] [ThreadPool]: On create_casestudy_intermediate: BEGIN
[0m10:56:26.030224 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:56:26.042787 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:56:26.043240 [debug] [ThreadPool]: Using duckdb connection "create_casestudy_intermediate"
[0m10:56:26.043553 [debug] [ThreadPool]: On create_casestudy_intermediate: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "create_casestudy_intermediate"} */
create schema if not exists "casestudy"."intermediate"
[0m10:56:26.044143 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:56:26.045076 [debug] [ThreadPool]: On create_casestudy_intermediate: COMMIT
[0m10:56:26.045387 [debug] [ThreadPool]: Using duckdb connection "create_casestudy_intermediate"
[0m10:56:26.045649 [debug] [ThreadPool]: On create_casestudy_intermediate: COMMIT
[0m10:56:26.046173 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:56:26.046491 [debug] [ThreadPool]: On create_casestudy_intermediate: Close
[0m10:56:26.052105 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_casestudy_intermediate, now list_casestudy_raw)
[0m10:56:26.057922 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_raw"
[0m10:56:26.058287 [debug] [ThreadPool]: On list_casestudy_raw: BEGIN
[0m10:56:26.058586 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:56:26.069649 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:56:26.070043 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_raw"
[0m10:56:26.070330 [debug] [ThreadPool]: On list_casestudy_raw: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_raw"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'raw'
    and table_catalog = 'casestudy'
  
[0m10:56:26.085818 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:56:26.087260 [debug] [ThreadPool]: On list_casestudy_raw: ROLLBACK
[0m10:56:26.088857 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_raw'
[0m10:56:26.089256 [debug] [ThreadPool]: On list_casestudy_raw: Close
[0m10:56:26.092321 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy_raw, now list_casestudy_intermediate)
[0m10:56:26.095125 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_intermediate"
[0m10:56:26.095470 [debug] [ThreadPool]: On list_casestudy_intermediate: BEGIN
[0m10:56:26.095800 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:56:26.106492 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:56:26.106887 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_intermediate"
[0m10:56:26.107244 [debug] [ThreadPool]: On list_casestudy_intermediate: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_intermediate"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'intermediate'
    and table_catalog = 'casestudy'
  
[0m10:56:26.115144 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:56:26.116652 [debug] [ThreadPool]: On list_casestudy_intermediate: ROLLBACK
[0m10:56:26.117173 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_intermediate'
[0m10:56:26.117444 [debug] [ThreadPool]: On list_casestudy_intermediate: Close
[0m10:56:26.120511 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy_intermediate, now list_casestudy_staging)
[0m10:56:26.122708 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_staging"
[0m10:56:26.123064 [debug] [ThreadPool]: On list_casestudy_staging: BEGIN
[0m10:56:26.123389 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:56:26.136034 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:56:26.136525 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_staging"
[0m10:56:26.136818 [debug] [ThreadPool]: On list_casestudy_staging: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_staging"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'staging'
    and table_catalog = 'casestudy'
  
[0m10:56:26.145317 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:56:26.146708 [debug] [ThreadPool]: On list_casestudy_staging: ROLLBACK
[0m10:56:26.147182 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_staging'
[0m10:56:26.147454 [debug] [ThreadPool]: On list_casestudy_staging: Close
[0m10:56:26.151648 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8a38e847-6d8c-4952-9146-1b3c31bd8f1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4a12445d0>]}
[0m10:56:26.152164 [debug] [MainThread]: Using duckdb connection "master"
[0m10:56:26.152443 [debug] [MainThread]: On master: BEGIN
[0m10:56:26.152730 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:56:26.166165 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m10:56:26.166689 [debug] [MainThread]: On master: COMMIT
[0m10:56:26.167169 [debug] [MainThread]: Using duckdb connection "master"
[0m10:56:26.167439 [debug] [MainThread]: On master: COMMIT
[0m10:56:26.168010 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m10:56:26.168344 [debug] [MainThread]: On master: Close
[0m10:56:26.171062 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:56:26.171486 [info ] [MainThread]: 
[0m10:56:26.176723 [debug] [Thread-1 (]: Began running node model.vg_casestudy.stg_staging_intermediate_fx_rates_filled
[0m10:56:26.177240 [info ] [Thread-1 (]: 1 of 1 START sql table model intermediate.stg_staging_intermediate_fx_rates_filled  [RUN]
[0m10:56:26.178304 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.vg_casestudy.stg_staging_intermediate_fx_rates_filled'
[0m10:56:26.178654 [debug] [Thread-1 (]: Began compiling node model.vg_casestudy.stg_staging_intermediate_fx_rates_filled
[0m10:56:26.202739 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate_fx_rates_filled"
[0m10:56:26.203280 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate_fx_rates_filled: BEGIN
[0m10:56:26.203830 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:56:26.219392 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m10:56:26.220053 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate_fx_rates_filled"
[0m10:56:26.220415 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate_fx_rates_filled: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_staging_intermediate_fx_rates_filled"} */


        select 
        ((date('2025-03-11'))::date - (date('2024-12-31'))::date)
    
[0m10:56:26.222929 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m10:56:26.226472 [debug] [Thread-1 (]: Writing injected SQL for node "model.vg_casestudy.stg_staging_intermediate_fx_rates_filled"
[0m10:56:26.227335 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.stg_staging_intermediate_fx_rates_filled (compile): 10:56:26.178927 => 10:56:26.227085
[0m10:56:26.227716 [debug] [Thread-1 (]: Began executing node model.vg_casestudy.stg_staging_intermediate_fx_rates_filled
[0m10:56:26.259914 [debug] [Thread-1 (]: Writing runtime sql for node "model.vg_casestudy.stg_staging_intermediate_fx_rates_filled"
[0m10:56:26.260672 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate_fx_rates_filled"
[0m10:56:26.261162 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate_fx_rates_filled: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_staging_intermediate_fx_rates_filled"} */

  
    
    

    create  table
      "casestudy"."intermediate"."stg_staging_intermediate_fx_rates_filled__dbt_tmp"
  
    as (
      with calendar as (

    





with rawdata as (

    

    

    with p as (
        select 0 as generated_number union all select 1
    ), unioned as (

    select

    
    p0.generated_number * power(2, 0)
     + 
    
    p1.generated_number * power(2, 1)
     + 
    
    p2.generated_number * power(2, 2)
     + 
    
    p3.generated_number * power(2, 3)
     + 
    
    p4.generated_number * power(2, 4)
     + 
    
    p5.generated_number * power(2, 5)
     + 
    
    p6.generated_number * power(2, 6)
    
    
    + 1
    as generated_number

    from

    
    p as p0
     cross join 
    
    p as p1
     cross join 
    
    p as p2
     cross join 
    
    p as p3
     cross join 
    
    p as p4
     cross join 
    
    p as p5
     cross join 
    
    p as p6
    
    

    )

    select *
    from unioned
    where generated_number <= 70
    order by generated_number



),

all_periods as (

    select (
        

    date('2024-12-31') + ((interval '1 day') * (row_number() over (order by 1) - 1))


    ) as date_day
    from rawdata

),

filtered as (

    select *
    from all_periods
    where date_day <= date('2025-03-11')

)

select * from filtered



),

currencies as (
    select distinct trim(currency_iso_code) as currency_iso_code
    from "casestudy"."raw"."fx_rates_full_history"
),

date_matrix as (
    select 
        currencies.currency_iso_code,
        calendar.date_day as fx_rate_date
    from currencies
    cross join calendar 

),

joined as (
    select 
        date_matrix.currency_iso_code,
        date_matrix.fx_rate_date,
        fx_rates_full_history.fx_rate
    from date_matrix
    left join "casestudy"."raw"."fx_rates_full_history" as fx_rates_full_history
    on date_matrix.currency_iso_code = fx_rates_full_history.currency_iso_code
    and date_matrix.fx_rate_date = fx_rates_full_history.fx_rate_date
),

forward_fill_dates as (
    select 
        currency_iso_code,
        fx_rate_date::date as fx_rate_date,

        last_value(fx_rate ignore nulls) over(
            partition by currency_iso_code
            order by fx_rate_date asc
            rows between unbounded preceding and current row
        ) as fx_rate
    from joined
)

select *
from forward_fill_dates
    );
  
  
[0m10:56:26.288225 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m10:56:26.296027 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate_fx_rates_filled"
[0m10:56:26.296465 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate_fx_rates_filled: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_staging_intermediate_fx_rates_filled"} */
alter table "casestudy"."intermediate"."stg_staging_intermediate_fx_rates_filled" rename to "stg_staging_intermediate_fx_rates_filled__dbt_backup"
[0m10:56:26.297369 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m10:56:26.300472 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate_fx_rates_filled"
[0m10:56:26.300860 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate_fx_rates_filled: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_staging_intermediate_fx_rates_filled"} */
alter table "casestudy"."intermediate"."stg_staging_intermediate_fx_rates_filled__dbt_tmp" rename to "stg_staging_intermediate_fx_rates_filled"
[0m10:56:26.301661 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m10:56:26.319076 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate_fx_rates_filled: COMMIT
[0m10:56:26.319520 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate_fx_rates_filled"
[0m10:56:26.319849 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate_fx_rates_filled: COMMIT
[0m10:56:26.325618 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m10:56:26.330783 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate_fx_rates_filled"
[0m10:56:26.331233 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate_fx_rates_filled: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_staging_intermediate_fx_rates_filled"} */
drop table if exists "casestudy"."intermediate"."stg_staging_intermediate_fx_rates_filled__dbt_backup" cascade
[0m10:56:26.335733 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m10:56:26.337178 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.stg_staging_intermediate_fx_rates_filled (execute): 10:56:26.227969 => 10:56:26.337011
[0m10:56:26.337590 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate_fx_rates_filled: Close
[0m10:56:26.365543 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8a38e847-6d8c-4952-9146-1b3c31bd8f1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa49c06b390>]}
[0m10:56:26.366261 [info ] [Thread-1 (]: 1 of 1 OK created sql table model intermediate.stg_staging_intermediate_fx_rates_filled  [[32mOK[0m in 0.19s]
[0m10:56:26.366861 [debug] [Thread-1 (]: Finished running node model.vg_casestudy.stg_staging_intermediate_fx_rates_filled
[0m10:56:26.368556 [debug] [MainThread]: Using duckdb connection "master"
[0m10:56:26.368925 [debug] [MainThread]: On master: BEGIN
[0m10:56:26.369233 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:56:26.385102 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m10:56:26.385813 [debug] [MainThread]: On master: COMMIT
[0m10:56:26.386192 [debug] [MainThread]: Using duckdb connection "master"
[0m10:56:26.386556 [debug] [MainThread]: On master: COMMIT
[0m10:56:26.387288 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m10:56:26.387640 [debug] [MainThread]: On master: Close
[0m10:56:26.390132 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:56:26.390488 [debug] [MainThread]: Connection 'list_casestudy_staging' was properly closed.
[0m10:56:26.390759 [debug] [MainThread]: Connection 'model.vg_casestudy.stg_staging_intermediate_fx_rates_filled' was properly closed.
[0m10:56:26.391087 [info ] [MainThread]: 
[0m10:56:26.391437 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.52 seconds (0.52s).
[0m10:56:26.392159 [debug] [MainThread]: Command end result
[0m10:56:26.412332 [info ] [MainThread]: 
[0m10:56:26.412816 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:56:26.413139 [info ] [MainThread]: 
[0m10:56:26.413478 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m10:56:26.413977 [debug] [MainThread]: Command `dbt run` succeeded at 10:56:26.413876 after 1.06 seconds
[0m10:56:26.414334 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4a020e710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4a020aa90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4a03a9510>]}
[0m10:56:26.414696 [debug] [MainThread]: Flushing usage events
[0m11:08:14.610982 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbe540c110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbe57332d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbe540ddd0>]}


============================== 11:08:14.616812 | 2ef9f8fa-b2e8-4387-9ee3-98ce1163a3da ==============================
[0m11:08:14.616812 [info ] [MainThread]: Running with dbt=1.6.18
[0m11:08:14.617390 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/workspaces/vg_case_study_tim/transformation', 'log_path': '/workspaces/vg_case_study_tim/transformation/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt test --select stg_staging_intermediate_fx_rates_filled', 'send_anonymous_usage_stats': 'True'}
[0m11:08:14.819902 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2ef9f8fa-b2e8-4387-9ee3-98ce1163a3da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbe57336d0>]}
[0m11:08:14.834166 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2ef9f8fa-b2e8-4387-9ee3-98ce1163a3da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbe540f9d0>]}
[0m11:08:14.836045 [info ] [MainThread]: Registered adapter: duckdb=1.6.2
[0m11:08:14.864835 [debug] [MainThread]: checksum: 7b9fab86a08e9e96a48a825af743c566d95b877e068b8c6d0dbafbf714447189, vars: {}, profile: , target: , version: 1.6.18
[0m11:08:14.958316 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:08:14.959351 [debug] [MainThread]: Partial parsing: updated file: vg_casestudy://models/intermediate/schema.yml
[0m11:08:15.083875 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.vg_casestudy.main
- models.vg_casestudy.reporting
- models.vg_casestudy.marts
[0m11:08:15.091703 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2ef9f8fa-b2e8-4387-9ee3-98ce1163a3da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbe5179f10>]}
[0m11:08:15.123729 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2ef9f8fa-b2e8-4387-9ee3-98ce1163a3da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbe1160810>]}
[0m11:08:15.124269 [info ] [MainThread]: Found 12 models, 1 analysis, 3 seeds, 80 tests, 5 sources, 0 exposures, 0 metrics, 632 macros, 0 groups, 0 semantic models
[0m11:08:15.124762 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2ef9f8fa-b2e8-4387-9ee3-98ce1163a3da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbe6f442d0>]}
[0m11:08:15.127341 [info ] [MainThread]: 
[0m11:08:15.128106 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m11:08:15.129965 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_casestudy_intermediate'
[0m11:08:15.143709 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_intermediate"
[0m11:08:15.144226 [debug] [ThreadPool]: On list_casestudy_intermediate: BEGIN
[0m11:08:15.144543 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:08:15.268005 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:08:15.268450 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_intermediate"
[0m11:08:15.268756 [debug] [ThreadPool]: On list_casestudy_intermediate: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_intermediate"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'intermediate'
    and table_catalog = 'casestudy'
  
[0m11:08:15.291858 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:08:15.293751 [debug] [ThreadPool]: On list_casestudy_intermediate: ROLLBACK
[0m11:08:15.295187 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_intermediate'
[0m11:08:15.295604 [debug] [ThreadPool]: On list_casestudy_intermediate: Close
[0m11:08:15.298756 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy_intermediate, now list_casestudy_raw)
[0m11:08:15.302193 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_raw"
[0m11:08:15.302543 [debug] [ThreadPool]: On list_casestudy_raw: BEGIN
[0m11:08:15.302817 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:08:15.314404 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:08:15.314803 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_raw"
[0m11:08:15.315099 [debug] [ThreadPool]: On list_casestudy_raw: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_raw"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'raw'
    and table_catalog = 'casestudy'
  
[0m11:08:15.324178 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:08:15.325565 [debug] [ThreadPool]: On list_casestudy_raw: ROLLBACK
[0m11:08:15.326030 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_raw'
[0m11:08:15.326290 [debug] [ThreadPool]: On list_casestudy_raw: Close
[0m11:08:15.329133 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy_raw, now list_casestudy_staging)
[0m11:08:15.331362 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_staging"
[0m11:08:15.331712 [debug] [ThreadPool]: On list_casestudy_staging: BEGIN
[0m11:08:15.332031 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:08:15.342753 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:08:15.343150 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_staging"
[0m11:08:15.343464 [debug] [ThreadPool]: On list_casestudy_staging: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_staging"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'staging'
    and table_catalog = 'casestudy'
  
[0m11:08:15.351415 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:08:15.352857 [debug] [ThreadPool]: On list_casestudy_staging: ROLLBACK
[0m11:08:15.353299 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_staging'
[0m11:08:15.353562 [debug] [ThreadPool]: On list_casestudy_staging: Close
[0m11:08:15.357305 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2ef9f8fa-b2e8-4387-9ee3-98ce1163a3da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbe11bec90>]}
[0m11:08:15.357769 [debug] [MainThread]: Using duckdb connection "master"
[0m11:08:15.358051 [debug] [MainThread]: On master: BEGIN
[0m11:08:15.358306 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:08:15.371129 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m11:08:15.371579 [debug] [MainThread]: On master: COMMIT
[0m11:08:15.371872 [debug] [MainThread]: Using duckdb connection "master"
[0m11:08:15.372128 [debug] [MainThread]: On master: COMMIT
[0m11:08:15.372624 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m11:08:15.372905 [debug] [MainThread]: On master: Close
[0m11:08:15.375331 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:08:15.375752 [info ] [MainThread]: 
[0m11:08:15.381383 [debug] [Thread-1 (]: Began running node test.vg_casestudy.not_null_stg_staging_intermediate_fx_rates_filled_currency_iso_code.9c900535e4
[0m11:08:15.381829 [info ] [Thread-1 (]: 1 of 6 START test not_null_stg_staging_intermediate_fx_rates_filled_currency_iso_code  [RUN]
[0m11:08:15.382677 [debug] [Thread-1 (]: Acquiring new duckdb connection 'test.vg_casestudy.not_null_stg_staging_intermediate_fx_rates_filled_currency_iso_code.9c900535e4'
[0m11:08:15.383030 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.not_null_stg_staging_intermediate_fx_rates_filled_currency_iso_code.9c900535e4
[0m11:08:15.401037 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.not_null_stg_staging_intermediate_fx_rates_filled_currency_iso_code.9c900535e4"
[0m11:08:15.402277 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_stg_staging_intermediate_fx_rates_filled_currency_iso_code.9c900535e4 (compile): 11:08:15.383273 => 11:08:15.402040
[0m11:08:15.402739 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.not_null_stg_staging_intermediate_fx_rates_filled_currency_iso_code.9c900535e4
[0m11:08:15.416369 [debug] [Thread-1 (]: Writing runtime sql for node "test.vg_casestudy.not_null_stg_staging_intermediate_fx_rates_filled_currency_iso_code.9c900535e4"
[0m11:08:15.418137 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.not_null_stg_staging_intermediate_fx_rates_filled_currency_iso_code.9c900535e4"
[0m11:08:15.418560 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_stg_staging_intermediate_fx_rates_filled_currency_iso_code.9c900535e4: BEGIN
[0m11:08:15.418880 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:08:15.432307 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:08:15.432786 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.not_null_stg_staging_intermediate_fx_rates_filled_currency_iso_code.9c900535e4"
[0m11:08:15.433152 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_stg_staging_intermediate_fx_rates_filled_currency_iso_code.9c900535e4: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "test.vg_casestudy.not_null_stg_staging_intermediate_fx_rates_filled_currency_iso_code.9c900535e4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select currency_iso_code
from "casestudy"."intermediate"."stg_staging_intermediate_fx_rates_filled"
where currency_iso_code is null



      
    ) dbt_internal_test
[0m11:08:15.438002 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:08:15.441374 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_stg_staging_intermediate_fx_rates_filled_currency_iso_code.9c900535e4 (execute): 11:08:15.402989 => 11:08:15.441062
[0m11:08:15.441779 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_stg_staging_intermediate_fx_rates_filled_currency_iso_code.9c900535e4: ROLLBACK
[0m11:08:15.442322 [debug] [Thread-1 (]: Failed to rollback 'test.vg_casestudy.not_null_stg_staging_intermediate_fx_rates_filled_currency_iso_code.9c900535e4'
[0m11:08:15.442673 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_stg_staging_intermediate_fx_rates_filled_currency_iso_code.9c900535e4: Close
[0m11:08:15.446158 [info ] [Thread-1 (]: 1 of 6 PASS not_null_stg_staging_intermediate_fx_rates_filled_currency_iso_code  [[32mPASS[0m in 0.06s]
[0m11:08:15.447200 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.not_null_stg_staging_intermediate_fx_rates_filled_currency_iso_code.9c900535e4
[0m11:08:15.447805 [debug] [Thread-1 (]: Began running node test.vg_casestudy.not_null_stg_staging_intermediate_fx_rates_filled_fx_rate.91750a92be
[0m11:08:15.448483 [info ] [Thread-1 (]: 2 of 6 START test not_null_stg_staging_intermediate_fx_rates_filled_fx_rate .... [RUN]
[0m11:08:15.449302 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.not_null_stg_staging_intermediate_fx_rates_filled_currency_iso_code.9c900535e4, now test.vg_casestudy.not_null_stg_staging_intermediate_fx_rates_filled_fx_rate.91750a92be)
[0m11:08:15.449658 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.not_null_stg_staging_intermediate_fx_rates_filled_fx_rate.91750a92be
[0m11:08:15.454153 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.not_null_stg_staging_intermediate_fx_rates_filled_fx_rate.91750a92be"
[0m11:08:15.454920 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_stg_staging_intermediate_fx_rates_filled_fx_rate.91750a92be (compile): 11:08:15.449892 => 11:08:15.454693
[0m11:08:15.455338 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.not_null_stg_staging_intermediate_fx_rates_filled_fx_rate.91750a92be
[0m11:08:15.458158 [debug] [Thread-1 (]: Writing runtime sql for node "test.vg_casestudy.not_null_stg_staging_intermediate_fx_rates_filled_fx_rate.91750a92be"
[0m11:08:15.458889 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.not_null_stg_staging_intermediate_fx_rates_filled_fx_rate.91750a92be"
[0m11:08:15.459265 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_stg_staging_intermediate_fx_rates_filled_fx_rate.91750a92be: BEGIN
[0m11:08:15.459653 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:08:15.473058 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:08:15.473582 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.not_null_stg_staging_intermediate_fx_rates_filled_fx_rate.91750a92be"
[0m11:08:15.473966 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_stg_staging_intermediate_fx_rates_filled_fx_rate.91750a92be: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "test.vg_casestudy.not_null_stg_staging_intermediate_fx_rates_filled_fx_rate.91750a92be"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select fx_rate
from "casestudy"."intermediate"."stg_staging_intermediate_fx_rates_filled"
where fx_rate is null



      
    ) dbt_internal_test
[0m11:08:15.475063 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:08:15.476718 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_stg_staging_intermediate_fx_rates_filled_fx_rate.91750a92be (execute): 11:08:15.455637 => 11:08:15.476437
[0m11:08:15.477295 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_stg_staging_intermediate_fx_rates_filled_fx_rate.91750a92be: ROLLBACK
[0m11:08:15.477834 [debug] [Thread-1 (]: Failed to rollback 'test.vg_casestudy.not_null_stg_staging_intermediate_fx_rates_filled_fx_rate.91750a92be'
[0m11:08:15.478199 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_stg_staging_intermediate_fx_rates_filled_fx_rate.91750a92be: Close
[0m11:08:15.480574 [info ] [Thread-1 (]: 2 of 6 PASS not_null_stg_staging_intermediate_fx_rates_filled_fx_rate .......... [[32mPASS[0m in 0.03s]
[0m11:08:15.481234 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.not_null_stg_staging_intermediate_fx_rates_filled_fx_rate.91750a92be
[0m11:08:15.481659 [debug] [Thread-1 (]: Began running node test.vg_casestudy.not_null_stg_staging_intermediate_fx_rates_filled_fx_rate_date.9ee70a0615
[0m11:08:15.482171 [info ] [Thread-1 (]: 3 of 6 START test not_null_stg_staging_intermediate_fx_rates_filled_fx_rate_date  [RUN]
[0m11:08:15.482906 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.not_null_stg_staging_intermediate_fx_rates_filled_fx_rate.91750a92be, now test.vg_casestudy.not_null_stg_staging_intermediate_fx_rates_filled_fx_rate_date.9ee70a0615)
[0m11:08:15.483265 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.not_null_stg_staging_intermediate_fx_rates_filled_fx_rate_date.9ee70a0615
[0m11:08:15.487686 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.not_null_stg_staging_intermediate_fx_rates_filled_fx_rate_date.9ee70a0615"
[0m11:08:15.488555 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_stg_staging_intermediate_fx_rates_filled_fx_rate_date.9ee70a0615 (compile): 11:08:15.483496 => 11:08:15.488289
[0m11:08:15.488986 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.not_null_stg_staging_intermediate_fx_rates_filled_fx_rate_date.9ee70a0615
[0m11:08:15.493575 [debug] [Thread-1 (]: Writing runtime sql for node "test.vg_casestudy.not_null_stg_staging_intermediate_fx_rates_filled_fx_rate_date.9ee70a0615"
[0m11:08:15.494443 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.not_null_stg_staging_intermediate_fx_rates_filled_fx_rate_date.9ee70a0615"
[0m11:08:15.494825 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_stg_staging_intermediate_fx_rates_filled_fx_rate_date.9ee70a0615: BEGIN
[0m11:08:15.495139 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:08:15.507927 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:08:15.508402 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.not_null_stg_staging_intermediate_fx_rates_filled_fx_rate_date.9ee70a0615"
[0m11:08:15.508842 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_stg_staging_intermediate_fx_rates_filled_fx_rate_date.9ee70a0615: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "test.vg_casestudy.not_null_stg_staging_intermediate_fx_rates_filled_fx_rate_date.9ee70a0615"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select fx_rate_date
from "casestudy"."intermediate"."stg_staging_intermediate_fx_rates_filled"
where fx_rate_date is null



      
    ) dbt_internal_test
[0m11:08:15.510391 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:08:15.512268 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_stg_staging_intermediate_fx_rates_filled_fx_rate_date.9ee70a0615 (execute): 11:08:15.489341 => 11:08:15.512038
[0m11:08:15.512679 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_stg_staging_intermediate_fx_rates_filled_fx_rate_date.9ee70a0615: ROLLBACK
[0m11:08:15.513159 [debug] [Thread-1 (]: Failed to rollback 'test.vg_casestudy.not_null_stg_staging_intermediate_fx_rates_filled_fx_rate_date.9ee70a0615'
[0m11:08:15.513496 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_stg_staging_intermediate_fx_rates_filled_fx_rate_date.9ee70a0615: Close
[0m11:08:15.516029 [info ] [Thread-1 (]: 3 of 6 PASS not_null_stg_staging_intermediate_fx_rates_filled_fx_rate_date ..... [[32mPASS[0m in 0.03s]
[0m11:08:15.516692 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.not_null_stg_staging_intermediate_fx_rates_filled_fx_rate_date.9ee70a0615
[0m11:08:15.517123 [debug] [Thread-1 (]: Began running node test.vg_casestudy.numeric_range_stg_staging_intermediate_fx_rates_filled_fx_rate__0.c2731cf81b
[0m11:08:15.517712 [info ] [Thread-1 (]: 4 of 6 START test numeric_range_stg_staging_intermediate_fx_rates_filled_fx_rate__0  [RUN]
[0m11:08:15.518444 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.not_null_stg_staging_intermediate_fx_rates_filled_fx_rate_date.9ee70a0615, now test.vg_casestudy.numeric_range_stg_staging_intermediate_fx_rates_filled_fx_rate__0.c2731cf81b)
[0m11:08:15.518786 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.numeric_range_stg_staging_intermediate_fx_rates_filled_fx_rate__0.c2731cf81b
[0m11:08:15.522940 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.numeric_range_stg_staging_intermediate_fx_rates_filled_fx_rate__0.c2731cf81b"
[0m11:08:15.523654 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.numeric_range_stg_staging_intermediate_fx_rates_filled_fx_rate__0.c2731cf81b (compile): 11:08:15.519009 => 11:08:15.523420
[0m11:08:15.524026 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.numeric_range_stg_staging_intermediate_fx_rates_filled_fx_rate__0.c2731cf81b
[0m11:08:15.527360 [debug] [Thread-1 (]: Writing runtime sql for node "test.vg_casestudy.numeric_range_stg_staging_intermediate_fx_rates_filled_fx_rate__0.c2731cf81b"
[0m11:08:15.528140 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.numeric_range_stg_staging_intermediate_fx_rates_filled_fx_rate__0.c2731cf81b"
[0m11:08:15.528553 [debug] [Thread-1 (]: On test.vg_casestudy.numeric_range_stg_staging_intermediate_fx_rates_filled_fx_rate__0.c2731cf81b: BEGIN
[0m11:08:15.528919 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:08:15.542148 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:08:15.542724 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.numeric_range_stg_staging_intermediate_fx_rates_filled_fx_rate__0.c2731cf81b"
[0m11:08:15.543156 [debug] [Thread-1 (]: On test.vg_casestudy.numeric_range_stg_staging_intermediate_fx_rates_filled_fx_rate__0.c2731cf81b: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "test.vg_casestudy.numeric_range_stg_staging_intermediate_fx_rates_filled_fx_rate__0.c2731cf81b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

    
        select *
        from "casestudy"."intermediate"."stg_staging_intermediate_fx_rates_filled"
        where fx_rate < 0
    
    


      
    ) dbt_internal_test
[0m11:08:15.544623 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:08:15.546365 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.numeric_range_stg_staging_intermediate_fx_rates_filled_fx_rate__0.c2731cf81b (execute): 11:08:15.524276 => 11:08:15.546089
[0m11:08:15.546824 [debug] [Thread-1 (]: On test.vg_casestudy.numeric_range_stg_staging_intermediate_fx_rates_filled_fx_rate__0.c2731cf81b: ROLLBACK
[0m11:08:15.547402 [debug] [Thread-1 (]: Failed to rollback 'test.vg_casestudy.numeric_range_stg_staging_intermediate_fx_rates_filled_fx_rate__0.c2731cf81b'
[0m11:08:15.547807 [debug] [Thread-1 (]: On test.vg_casestudy.numeric_range_stg_staging_intermediate_fx_rates_filled_fx_rate__0.c2731cf81b: Close
[0m11:08:15.550410 [info ] [Thread-1 (]: 4 of 6 PASS numeric_range_stg_staging_intermediate_fx_rates_filled_fx_rate__0 .. [[32mPASS[0m in 0.03s]
[0m11:08:15.551066 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.numeric_range_stg_staging_intermediate_fx_rates_filled_fx_rate__0.c2731cf81b
[0m11:08:15.551588 [debug] [Thread-1 (]: Began running node test.vg_casestudy.unique_stg_staging_intermediate_fx_rates_filled_currency_iso_code.1135e2ffae
[0m11:08:15.552146 [info ] [Thread-1 (]: 5 of 6 START test unique_stg_staging_intermediate_fx_rates_filled_currency_iso_code  [RUN]
[0m11:08:15.552887 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.numeric_range_stg_staging_intermediate_fx_rates_filled_fx_rate__0.c2731cf81b, now test.vg_casestudy.unique_stg_staging_intermediate_fx_rates_filled_currency_iso_code.1135e2ffae)
[0m11:08:15.553235 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.unique_stg_staging_intermediate_fx_rates_filled_currency_iso_code.1135e2ffae
[0m11:08:15.562250 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.unique_stg_staging_intermediate_fx_rates_filled_currency_iso_code.1135e2ffae"
[0m11:08:15.563082 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.unique_stg_staging_intermediate_fx_rates_filled_currency_iso_code.1135e2ffae (compile): 11:08:15.553458 => 11:08:15.562826
[0m11:08:15.563525 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.unique_stg_staging_intermediate_fx_rates_filled_currency_iso_code.1135e2ffae
[0m11:08:15.566812 [debug] [Thread-1 (]: Writing runtime sql for node "test.vg_casestudy.unique_stg_staging_intermediate_fx_rates_filled_currency_iso_code.1135e2ffae"
[0m11:08:15.567819 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.unique_stg_staging_intermediate_fx_rates_filled_currency_iso_code.1135e2ffae"
[0m11:08:15.568255 [debug] [Thread-1 (]: On test.vg_casestudy.unique_stg_staging_intermediate_fx_rates_filled_currency_iso_code.1135e2ffae: BEGIN
[0m11:08:15.568589 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:08:15.583208 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:08:15.583741 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.unique_stg_staging_intermediate_fx_rates_filled_currency_iso_code.1135e2ffae"
[0m11:08:15.584148 [debug] [Thread-1 (]: On test.vg_casestudy.unique_stg_staging_intermediate_fx_rates_filled_currency_iso_code.1135e2ffae: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "test.vg_casestudy.unique_stg_staging_intermediate_fx_rates_filled_currency_iso_code.1135e2ffae"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    currency_iso_code as unique_field,
    count(*) as n_records

from "casestudy"."intermediate"."stg_staging_intermediate_fx_rates_filled"
where currency_iso_code is not null
group by currency_iso_code
having count(*) > 1



      
    ) dbt_internal_test
[0m11:08:15.593289 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:08:15.595451 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.unique_stg_staging_intermediate_fx_rates_filled_currency_iso_code.1135e2ffae (execute): 11:08:15.563862 => 11:08:15.595074
[0m11:08:15.595910 [debug] [Thread-1 (]: On test.vg_casestudy.unique_stg_staging_intermediate_fx_rates_filled_currency_iso_code.1135e2ffae: ROLLBACK
[0m11:08:15.596432 [debug] [Thread-1 (]: Failed to rollback 'test.vg_casestudy.unique_stg_staging_intermediate_fx_rates_filled_currency_iso_code.1135e2ffae'
[0m11:08:15.596768 [debug] [Thread-1 (]: On test.vg_casestudy.unique_stg_staging_intermediate_fx_rates_filled_currency_iso_code.1135e2ffae: Close
[0m11:08:15.600106 [error] [Thread-1 (]: 5 of 6 FAIL 15 unique_stg_staging_intermediate_fx_rates_filled_currency_iso_code  [[31mFAIL 15[0m in 0.05s]
[0m11:08:15.600854 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.unique_stg_staging_intermediate_fx_rates_filled_currency_iso_code.1135e2ffae
[0m11:08:15.601361 [debug] [Thread-1 (]: Began running node test.vg_casestudy.unique_stg_staging_intermediate_fx_rates_filled_fx_rate_date.8c859e2761
[0m11:08:15.601738 [info ] [Thread-1 (]: 6 of 6 START test unique_stg_staging_intermediate_fx_rates_filled_fx_rate_date . [RUN]
[0m11:08:15.602547 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.unique_stg_staging_intermediate_fx_rates_filled_currency_iso_code.1135e2ffae, now test.vg_casestudy.unique_stg_staging_intermediate_fx_rates_filled_fx_rate_date.8c859e2761)
[0m11:08:15.603158 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.unique_stg_staging_intermediate_fx_rates_filled_fx_rate_date.8c859e2761
[0m11:08:15.607755 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.unique_stg_staging_intermediate_fx_rates_filled_fx_rate_date.8c859e2761"
[0m11:08:15.608933 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.unique_stg_staging_intermediate_fx_rates_filled_fx_rate_date.8c859e2761 (compile): 11:08:15.603441 => 11:08:15.608552
[0m11:08:15.609503 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.unique_stg_staging_intermediate_fx_rates_filled_fx_rate_date.8c859e2761
[0m11:08:15.612912 [debug] [Thread-1 (]: Writing runtime sql for node "test.vg_casestudy.unique_stg_staging_intermediate_fx_rates_filled_fx_rate_date.8c859e2761"
[0m11:08:15.613620 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.unique_stg_staging_intermediate_fx_rates_filled_fx_rate_date.8c859e2761"
[0m11:08:15.613998 [debug] [Thread-1 (]: On test.vg_casestudy.unique_stg_staging_intermediate_fx_rates_filled_fx_rate_date.8c859e2761: BEGIN
[0m11:08:15.614316 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:08:15.627683 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:08:15.628279 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.unique_stg_staging_intermediate_fx_rates_filled_fx_rate_date.8c859e2761"
[0m11:08:15.629068 [debug] [Thread-1 (]: On test.vg_casestudy.unique_stg_staging_intermediate_fx_rates_filled_fx_rate_date.8c859e2761: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "test.vg_casestudy.unique_stg_staging_intermediate_fx_rates_filled_fx_rate_date.8c859e2761"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    fx_rate_date as unique_field,
    count(*) as n_records

from "casestudy"."intermediate"."stg_staging_intermediate_fx_rates_filled"
where fx_rate_date is not null
group by fx_rate_date
having count(*) > 1



      
    ) dbt_internal_test
[0m11:08:15.633530 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:08:15.636832 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.unique_stg_staging_intermediate_fx_rates_filled_fx_rate_date.8c859e2761 (execute): 11:08:15.609881 => 11:08:15.636420
[0m11:08:15.637336 [debug] [Thread-1 (]: On test.vg_casestudy.unique_stg_staging_intermediate_fx_rates_filled_fx_rate_date.8c859e2761: ROLLBACK
[0m11:08:15.637874 [debug] [Thread-1 (]: Failed to rollback 'test.vg_casestudy.unique_stg_staging_intermediate_fx_rates_filled_fx_rate_date.8c859e2761'
[0m11:08:15.638250 [debug] [Thread-1 (]: On test.vg_casestudy.unique_stg_staging_intermediate_fx_rates_filled_fx_rate_date.8c859e2761: Close
[0m11:08:15.640953 [error] [Thread-1 (]: 6 of 6 FAIL 70 unique_stg_staging_intermediate_fx_rates_filled_fx_rate_date .... [[31mFAIL 70[0m in 0.04s]
[0m11:08:15.642064 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.unique_stg_staging_intermediate_fx_rates_filled_fx_rate_date.8c859e2761
[0m11:08:15.644310 [debug] [MainThread]: Using duckdb connection "master"
[0m11:08:15.644733 [debug] [MainThread]: On master: BEGIN
[0m11:08:15.645077 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:08:15.662358 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m11:08:15.662835 [debug] [MainThread]: On master: COMMIT
[0m11:08:15.663217 [debug] [MainThread]: Using duckdb connection "master"
[0m11:08:15.663529 [debug] [MainThread]: On master: COMMIT
[0m11:08:15.664127 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m11:08:15.664446 [debug] [MainThread]: On master: Close
[0m11:08:15.667969 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:08:15.668403 [debug] [MainThread]: Connection 'list_casestudy_staging' was properly closed.
[0m11:08:15.668701 [debug] [MainThread]: Connection 'test.vg_casestudy.unique_stg_staging_intermediate_fx_rates_filled_fx_rate_date.8c859e2761' was properly closed.
[0m11:08:15.669046 [info ] [MainThread]: 
[0m11:08:15.669388 [info ] [MainThread]: Finished running 6 tests in 0 hours 0 minutes and 0.54 seconds (0.54s).
[0m11:08:15.670479 [debug] [MainThread]: Command end result
[0m11:08:15.690150 [info ] [MainThread]: 
[0m11:08:15.690626 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m11:08:15.690948 [info ] [MainThread]: 
[0m11:08:15.691294 [error] [MainThread]: [31mFailure in test unique_stg_staging_intermediate_fx_rates_filled_currency_iso_code (models/intermediate/schema.yml)[0m
[0m11:08:15.691609 [error] [MainThread]:   Got 15 results, configured to fail if != 0
[0m11:08:15.691917 [info ] [MainThread]: 
[0m11:08:15.692199 [info ] [MainThread]:   compiled Code at target/compiled/vg_casestudy/models/intermediate/schema.yml/unique_stg_staging_intermediat_6dcfe84f78b298d5dcee3c19baa974dc.sql
[0m11:08:15.692522 [info ] [MainThread]: 
[0m11:08:15.692829 [error] [MainThread]: [31mFailure in test unique_stg_staging_intermediate_fx_rates_filled_fx_rate_date (models/intermediate/schema.yml)[0m
[0m11:08:15.693117 [error] [MainThread]:   Got 70 results, configured to fail if != 0
[0m11:08:15.693410 [info ] [MainThread]: 
[0m11:08:15.693772 [info ] [MainThread]:   compiled Code at target/compiled/vg_casestudy/models/intermediate/schema.yml/unique_stg_staging_intermediate_fx_rates_filled_fx_rate_date.sql
[0m11:08:15.694087 [info ] [MainThread]: 
[0m11:08:15.694416 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=2 SKIP=0 TOTAL=6
[0m11:08:15.694912 [debug] [MainThread]: Command `dbt test` failed at 11:08:15.694814 after 1.09 seconds
[0m11:08:15.695282 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbe548d9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbe5745b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbe9dd6250>]}
[0m11:08:15.695638 [debug] [MainThread]: Flushing usage events
[0m11:08:52.501119 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb069d025d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb068d331d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb068e9aed0>]}


============================== 11:08:52.503977 | b811fa92-3e83-4e3e-827d-8107fc267b65 ==============================
[0m11:08:52.503977 [info ] [MainThread]: Running with dbt=1.6.18
[0m11:08:52.504541 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/workspaces/vg_case_study_tim/transformation', 'debug': 'False', 'warn_error': 'None', 'log_path': '/workspaces/vg_case_study_tim/transformation/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt test --select stg_staging_intermediate_fx_rates_filled', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:08:52.616144 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b811fa92-3e83-4e3e-827d-8107fc267b65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb06890cf90>]}
[0m11:08:52.630290 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b811fa92-3e83-4e3e-827d-8107fc267b65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0688aa0d0>]}
[0m11:08:52.631241 [info ] [MainThread]: Registered adapter: duckdb=1.6.2
[0m11:08:52.656231 [debug] [MainThread]: checksum: 7b9fab86a08e9e96a48a825af743c566d95b877e068b8c6d0dbafbf714447189, vars: {}, profile: , target: , version: 1.6.18
[0m11:08:52.698258 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:08:52.699516 [debug] [MainThread]: Partial parsing: updated file: vg_casestudy://models/intermediate/schema.yml
[0m11:08:52.862906 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.vg_casestudy.main
- models.vg_casestudy.reporting
- models.vg_casestudy.marts
[0m11:08:52.869820 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b811fa92-3e83-4e3e-827d-8107fc267b65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb06a76de10>]}
[0m11:08:52.898718 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b811fa92-3e83-4e3e-827d-8107fc267b65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0649b2350>]}
[0m11:08:52.899287 [info ] [MainThread]: Found 12 models, 1 analysis, 3 seeds, 78 tests, 5 sources, 0 exposures, 0 metrics, 632 macros, 0 groups, 0 semantic models
[0m11:08:52.899694 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b811fa92-3e83-4e3e-827d-8107fc267b65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb068ecda50>]}
[0m11:08:52.902134 [info ] [MainThread]: 
[0m11:08:52.902922 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m11:08:52.904931 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_casestudy_staging'
[0m11:08:52.911015 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_staging"
[0m11:08:52.911498 [debug] [ThreadPool]: On list_casestudy_staging: BEGIN
[0m11:08:52.911839 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:08:52.930527 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:08:52.931010 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_staging"
[0m11:08:52.931325 [debug] [ThreadPool]: On list_casestudy_staging: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_staging"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'staging'
    and table_catalog = 'casestudy'
  
[0m11:08:52.941747 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:08:52.943352 [debug] [ThreadPool]: On list_casestudy_staging: ROLLBACK
[0m11:08:52.944025 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_staging'
[0m11:08:52.944324 [debug] [ThreadPool]: On list_casestudy_staging: Close
[0m11:08:52.949949 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy_staging, now list_casestudy_raw)
[0m11:08:52.952218 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_raw"
[0m11:08:52.952580 [debug] [ThreadPool]: On list_casestudy_raw: BEGIN
[0m11:08:52.952875 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:08:52.964744 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:08:52.965176 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_raw"
[0m11:08:52.965482 [debug] [ThreadPool]: On list_casestudy_raw: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_raw"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'raw'
    and table_catalog = 'casestudy'
  
[0m11:08:52.975307 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:08:52.976736 [debug] [ThreadPool]: On list_casestudy_raw: ROLLBACK
[0m11:08:52.977241 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_raw'
[0m11:08:52.977508 [debug] [ThreadPool]: On list_casestudy_raw: Close
[0m11:08:52.980522 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy_raw, now list_casestudy_intermediate)
[0m11:08:52.982953 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_intermediate"
[0m11:08:52.983312 [debug] [ThreadPool]: On list_casestudy_intermediate: BEGIN
[0m11:08:52.983605 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:08:52.994009 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:08:52.994408 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_intermediate"
[0m11:08:52.994700 [debug] [ThreadPool]: On list_casestudy_intermediate: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_intermediate"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'intermediate'
    and table_catalog = 'casestudy'
  
[0m11:08:53.003118 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:08:53.004438 [debug] [ThreadPool]: On list_casestudy_intermediate: ROLLBACK
[0m11:08:53.004903 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_intermediate'
[0m11:08:53.005159 [debug] [ThreadPool]: On list_casestudy_intermediate: Close
[0m11:08:53.008737 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b811fa92-3e83-4e3e-827d-8107fc267b65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb068ed9dd0>]}
[0m11:08:53.009267 [debug] [MainThread]: Using duckdb connection "master"
[0m11:08:53.009546 [debug] [MainThread]: On master: BEGIN
[0m11:08:53.009807 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:08:53.021583 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m11:08:53.021995 [debug] [MainThread]: On master: COMMIT
[0m11:08:53.022303 [debug] [MainThread]: Using duckdb connection "master"
[0m11:08:53.022618 [debug] [MainThread]: On master: COMMIT
[0m11:08:53.023127 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m11:08:53.023467 [debug] [MainThread]: On master: Close
[0m11:08:53.026444 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:08:53.026880 [info ] [MainThread]: 
[0m11:08:53.029800 [debug] [Thread-1 (]: Began running node test.vg_casestudy.not_null_stg_staging_intermediate_fx_rates_filled_currency_iso_code.9c900535e4
[0m11:08:53.030213 [info ] [Thread-1 (]: 1 of 4 START test not_null_stg_staging_intermediate_fx_rates_filled_currency_iso_code  [RUN]
[0m11:08:53.031010 [debug] [Thread-1 (]: Acquiring new duckdb connection 'test.vg_casestudy.not_null_stg_staging_intermediate_fx_rates_filled_currency_iso_code.9c900535e4'
[0m11:08:53.031319 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.not_null_stg_staging_intermediate_fx_rates_filled_currency_iso_code.9c900535e4
[0m11:08:53.047614 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.not_null_stg_staging_intermediate_fx_rates_filled_currency_iso_code.9c900535e4"
[0m11:08:53.048605 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_stg_staging_intermediate_fx_rates_filled_currency_iso_code.9c900535e4 (compile): 11:08:53.031545 => 11:08:53.048364
[0m11:08:53.049040 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.not_null_stg_staging_intermediate_fx_rates_filled_currency_iso_code.9c900535e4
[0m11:08:53.061267 [debug] [Thread-1 (]: Writing runtime sql for node "test.vg_casestudy.not_null_stg_staging_intermediate_fx_rates_filled_currency_iso_code.9c900535e4"
[0m11:08:53.062056 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.not_null_stg_staging_intermediate_fx_rates_filled_currency_iso_code.9c900535e4"
[0m11:08:53.062548 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_stg_staging_intermediate_fx_rates_filled_currency_iso_code.9c900535e4: BEGIN
[0m11:08:53.063047 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:08:53.075767 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:08:53.076253 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.not_null_stg_staging_intermediate_fx_rates_filled_currency_iso_code.9c900535e4"
[0m11:08:53.076600 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_stg_staging_intermediate_fx_rates_filled_currency_iso_code.9c900535e4: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "test.vg_casestudy.not_null_stg_staging_intermediate_fx_rates_filled_currency_iso_code.9c900535e4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select currency_iso_code
from "casestudy"."intermediate"."stg_staging_intermediate_fx_rates_filled"
where currency_iso_code is null



      
    ) dbt_internal_test
[0m11:08:53.078625 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:08:53.080981 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_stg_staging_intermediate_fx_rates_filled_currency_iso_code.9c900535e4 (execute): 11:08:53.049276 => 11:08:53.080759
[0m11:08:53.081343 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_stg_staging_intermediate_fx_rates_filled_currency_iso_code.9c900535e4: ROLLBACK
[0m11:08:53.081830 [debug] [Thread-1 (]: Failed to rollback 'test.vg_casestudy.not_null_stg_staging_intermediate_fx_rates_filled_currency_iso_code.9c900535e4'
[0m11:08:53.082139 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_stg_staging_intermediate_fx_rates_filled_currency_iso_code.9c900535e4: Close
[0m11:08:53.084657 [info ] [Thread-1 (]: 1 of 4 PASS not_null_stg_staging_intermediate_fx_rates_filled_currency_iso_code  [[32mPASS[0m in 0.05s]
[0m11:08:53.085306 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.not_null_stg_staging_intermediate_fx_rates_filled_currency_iso_code.9c900535e4
[0m11:08:53.085723 [debug] [Thread-1 (]: Began running node test.vg_casestudy.not_null_stg_staging_intermediate_fx_rates_filled_fx_rate.91750a92be
[0m11:08:53.086107 [info ] [Thread-1 (]: 2 of 4 START test not_null_stg_staging_intermediate_fx_rates_filled_fx_rate .... [RUN]
[0m11:08:53.086852 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.not_null_stg_staging_intermediate_fx_rates_filled_currency_iso_code.9c900535e4, now test.vg_casestudy.not_null_stg_staging_intermediate_fx_rates_filled_fx_rate.91750a92be)
[0m11:08:53.087210 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.not_null_stg_staging_intermediate_fx_rates_filled_fx_rate.91750a92be
[0m11:08:53.093450 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.not_null_stg_staging_intermediate_fx_rates_filled_fx_rate.91750a92be"
[0m11:08:53.094561 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_stg_staging_intermediate_fx_rates_filled_fx_rate.91750a92be (compile): 11:08:53.087441 => 11:08:53.094164
[0m11:08:53.095048 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.not_null_stg_staging_intermediate_fx_rates_filled_fx_rate.91750a92be
[0m11:08:53.098298 [debug] [Thread-1 (]: Writing runtime sql for node "test.vg_casestudy.not_null_stg_staging_intermediate_fx_rates_filled_fx_rate.91750a92be"
[0m11:08:53.099068 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.not_null_stg_staging_intermediate_fx_rates_filled_fx_rate.91750a92be"
[0m11:08:53.099470 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_stg_staging_intermediate_fx_rates_filled_fx_rate.91750a92be: BEGIN
[0m11:08:53.099784 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:08:53.113200 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:08:53.113772 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.not_null_stg_staging_intermediate_fx_rates_filled_fx_rate.91750a92be"
[0m11:08:53.114210 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_stg_staging_intermediate_fx_rates_filled_fx_rate.91750a92be: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "test.vg_casestudy.not_null_stg_staging_intermediate_fx_rates_filled_fx_rate.91750a92be"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select fx_rate
from "casestudy"."intermediate"."stg_staging_intermediate_fx_rates_filled"
where fx_rate is null



      
    ) dbt_internal_test
[0m11:08:53.115641 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:08:53.117331 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_stg_staging_intermediate_fx_rates_filled_fx_rate.91750a92be (execute): 11:08:53.095447 => 11:08:53.117129
[0m11:08:53.117733 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_stg_staging_intermediate_fx_rates_filled_fx_rate.91750a92be: ROLLBACK
[0m11:08:53.118269 [debug] [Thread-1 (]: Failed to rollback 'test.vg_casestudy.not_null_stg_staging_intermediate_fx_rates_filled_fx_rate.91750a92be'
[0m11:08:53.118622 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_stg_staging_intermediate_fx_rates_filled_fx_rate.91750a92be: Close
[0m11:08:53.121142 [info ] [Thread-1 (]: 2 of 4 PASS not_null_stg_staging_intermediate_fx_rates_filled_fx_rate .......... [[32mPASS[0m in 0.03s]
[0m11:08:53.121810 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.not_null_stg_staging_intermediate_fx_rates_filled_fx_rate.91750a92be
[0m11:08:53.122220 [debug] [Thread-1 (]: Began running node test.vg_casestudy.not_null_stg_staging_intermediate_fx_rates_filled_fx_rate_date.9ee70a0615
[0m11:08:53.122608 [info ] [Thread-1 (]: 3 of 4 START test not_null_stg_staging_intermediate_fx_rates_filled_fx_rate_date  [RUN]
[0m11:08:53.123473 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.not_null_stg_staging_intermediate_fx_rates_filled_fx_rate.91750a92be, now test.vg_casestudy.not_null_stg_staging_intermediate_fx_rates_filled_fx_rate_date.9ee70a0615)
[0m11:08:53.123820 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.not_null_stg_staging_intermediate_fx_rates_filled_fx_rate_date.9ee70a0615
[0m11:08:53.127839 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.not_null_stg_staging_intermediate_fx_rates_filled_fx_rate_date.9ee70a0615"
[0m11:08:53.128705 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_stg_staging_intermediate_fx_rates_filled_fx_rate_date.9ee70a0615 (compile): 11:08:53.124052 => 11:08:53.128391
[0m11:08:53.129201 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.not_null_stg_staging_intermediate_fx_rates_filled_fx_rate_date.9ee70a0615
[0m11:08:53.132331 [debug] [Thread-1 (]: Writing runtime sql for node "test.vg_casestudy.not_null_stg_staging_intermediate_fx_rates_filled_fx_rate_date.9ee70a0615"
[0m11:08:53.133116 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.not_null_stg_staging_intermediate_fx_rates_filled_fx_rate_date.9ee70a0615"
[0m11:08:53.133517 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_stg_staging_intermediate_fx_rates_filled_fx_rate_date.9ee70a0615: BEGIN
[0m11:08:53.133844 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:08:53.150857 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:08:53.151345 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.not_null_stg_staging_intermediate_fx_rates_filled_fx_rate_date.9ee70a0615"
[0m11:08:53.151687 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_stg_staging_intermediate_fx_rates_filled_fx_rate_date.9ee70a0615: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "test.vg_casestudy.not_null_stg_staging_intermediate_fx_rates_filled_fx_rate_date.9ee70a0615"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select fx_rate_date
from "casestudy"."intermediate"."stg_staging_intermediate_fx_rates_filled"
where fx_rate_date is null



      
    ) dbt_internal_test
[0m11:08:53.152874 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:08:53.154399 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_stg_staging_intermediate_fx_rates_filled_fx_rate_date.9ee70a0615 (execute): 11:08:53.129516 => 11:08:53.154212
[0m11:08:53.154791 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_stg_staging_intermediate_fx_rates_filled_fx_rate_date.9ee70a0615: ROLLBACK
[0m11:08:53.155289 [debug] [Thread-1 (]: Failed to rollback 'test.vg_casestudy.not_null_stg_staging_intermediate_fx_rates_filled_fx_rate_date.9ee70a0615'
[0m11:08:53.155605 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_stg_staging_intermediate_fx_rates_filled_fx_rate_date.9ee70a0615: Close
[0m11:08:53.158056 [info ] [Thread-1 (]: 3 of 4 PASS not_null_stg_staging_intermediate_fx_rates_filled_fx_rate_date ..... [[32mPASS[0m in 0.03s]
[0m11:08:53.158750 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.not_null_stg_staging_intermediate_fx_rates_filled_fx_rate_date.9ee70a0615
[0m11:08:53.159152 [debug] [Thread-1 (]: Began running node test.vg_casestudy.numeric_range_stg_staging_intermediate_fx_rates_filled_fx_rate__0.c2731cf81b
[0m11:08:53.159508 [info ] [Thread-1 (]: 4 of 4 START test numeric_range_stg_staging_intermediate_fx_rates_filled_fx_rate__0  [RUN]
[0m11:08:53.160381 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.not_null_stg_staging_intermediate_fx_rates_filled_fx_rate_date.9ee70a0615, now test.vg_casestudy.numeric_range_stg_staging_intermediate_fx_rates_filled_fx_rate__0.c2731cf81b)
[0m11:08:53.160708 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.numeric_range_stg_staging_intermediate_fx_rates_filled_fx_rate__0.c2731cf81b
[0m11:08:53.165082 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.numeric_range_stg_staging_intermediate_fx_rates_filled_fx_rate__0.c2731cf81b"
[0m11:08:53.165821 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.numeric_range_stg_staging_intermediate_fx_rates_filled_fx_rate__0.c2731cf81b (compile): 11:08:53.160951 => 11:08:53.165598
[0m11:08:53.166241 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.numeric_range_stg_staging_intermediate_fx_rates_filled_fx_rate__0.c2731cf81b
[0m11:08:53.169779 [debug] [Thread-1 (]: Writing runtime sql for node "test.vg_casestudy.numeric_range_stg_staging_intermediate_fx_rates_filled_fx_rate__0.c2731cf81b"
[0m11:08:53.170560 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.numeric_range_stg_staging_intermediate_fx_rates_filled_fx_rate__0.c2731cf81b"
[0m11:08:53.171026 [debug] [Thread-1 (]: On test.vg_casestudy.numeric_range_stg_staging_intermediate_fx_rates_filled_fx_rate__0.c2731cf81b: BEGIN
[0m11:08:53.171401 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:08:53.185067 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:08:53.185551 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.numeric_range_stg_staging_intermediate_fx_rates_filled_fx_rate__0.c2731cf81b"
[0m11:08:53.185910 [debug] [Thread-1 (]: On test.vg_casestudy.numeric_range_stg_staging_intermediate_fx_rates_filled_fx_rate__0.c2731cf81b: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "test.vg_casestudy.numeric_range_stg_staging_intermediate_fx_rates_filled_fx_rate__0.c2731cf81b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

    
        select *
        from "casestudy"."intermediate"."stg_staging_intermediate_fx_rates_filled"
        where fx_rate < 0
    
    


      
    ) dbt_internal_test
[0m11:08:53.187148 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:08:53.188705 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.numeric_range_stg_staging_intermediate_fx_rates_filled_fx_rate__0.c2731cf81b (execute): 11:08:53.166628 => 11:08:53.188495
[0m11:08:53.189078 [debug] [Thread-1 (]: On test.vg_casestudy.numeric_range_stg_staging_intermediate_fx_rates_filled_fx_rate__0.c2731cf81b: ROLLBACK
[0m11:08:53.189547 [debug] [Thread-1 (]: Failed to rollback 'test.vg_casestudy.numeric_range_stg_staging_intermediate_fx_rates_filled_fx_rate__0.c2731cf81b'
[0m11:08:53.189870 [debug] [Thread-1 (]: On test.vg_casestudy.numeric_range_stg_staging_intermediate_fx_rates_filled_fx_rate__0.c2731cf81b: Close
[0m11:08:53.192185 [info ] [Thread-1 (]: 4 of 4 PASS numeric_range_stg_staging_intermediate_fx_rates_filled_fx_rate__0 .. [[32mPASS[0m in 0.03s]
[0m11:08:53.192799 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.numeric_range_stg_staging_intermediate_fx_rates_filled_fx_rate__0.c2731cf81b
[0m11:08:53.194641 [debug] [MainThread]: Using duckdb connection "master"
[0m11:08:53.195027 [debug] [MainThread]: On master: BEGIN
[0m11:08:53.195298 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:08:53.209764 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m11:08:53.210205 [debug] [MainThread]: On master: COMMIT
[0m11:08:53.210536 [debug] [MainThread]: Using duckdb connection "master"
[0m11:08:53.210829 [debug] [MainThread]: On master: COMMIT
[0m11:08:53.211532 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m11:08:53.211939 [debug] [MainThread]: On master: Close
[0m11:08:53.215505 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:08:53.215945 [debug] [MainThread]: Connection 'list_casestudy_intermediate' was properly closed.
[0m11:08:53.216223 [debug] [MainThread]: Connection 'test.vg_casestudy.numeric_range_stg_staging_intermediate_fx_rates_filled_fx_rate__0.c2731cf81b' was properly closed.
[0m11:08:53.216570 [info ] [MainThread]: 
[0m11:08:53.216924 [info ] [MainThread]: Finished running 4 tests in 0 hours 0 minutes and 0.31 seconds (0.31s).
[0m11:08:53.217816 [debug] [MainThread]: Command end result
[0m11:08:53.237505 [info ] [MainThread]: 
[0m11:08:53.238099 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:08:53.238501 [info ] [MainThread]: 
[0m11:08:53.238826 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m11:08:53.239297 [debug] [MainThread]: Command `dbt test` succeeded at 11:08:53.239203 after 0.75 seconds
[0m11:08:53.239632 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb068e94a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb068e97a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb06b0cdbd0>]}
[0m11:08:53.239984 [debug] [MainThread]: Flushing usage events
[0m13:13:33.112152 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0927cb890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa09260ccd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa092467590>]}


============================== 13:13:33.119102 | b91ee66a-1cd7-4894-a44a-5203ed0560d3 ==============================
[0m13:13:33.119102 [info ] [MainThread]: Running with dbt=1.6.18
[0m13:13:33.120260 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/workspaces/vg_case_study_tim/transformation', 'log_path': '/workspaces/vg_case_study_tim/transformation/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt debug', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:13:33.120726 [info ] [MainThread]: dbt version: 1.6.18
[0m13:13:33.121080 [info ] [MainThread]: python version: 3.11.6
[0m13:13:33.121403 [info ] [MainThread]: python path: /usr/local/bin/python
[0m13:13:33.121693 [info ] [MainThread]: os info: Linux-5.15.153.1-microsoft-standard-WSL2-x86_64-with-glibc2.31
[0m13:13:33.258490 [info ] [MainThread]: Using profiles dir at /workspaces/vg_case_study_tim/transformation
[0m13:13:33.259013 [info ] [MainThread]: Using profiles.yml file at /workspaces/vg_case_study_tim/transformation/profiles.yml
[0m13:13:33.259344 [info ] [MainThread]: Using dbt_project.yml file at /workspaces/vg_case_study_tim/transformation/dbt_project.yml
[0m13:13:33.260740 [info ] [MainThread]: adapter type: duckdb
[0m13:13:33.261143 [info ] [MainThread]: adapter version: 1.6.2
[0m13:13:33.293124 [info ] [MainThread]: Configuration:
[0m13:13:33.293647 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m13:13:33.294016 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m13:13:33.294341 [info ] [MainThread]: Required dependencies:
[0m13:13:33.294725 [debug] [MainThread]: Executing "git --help"
[0m13:13:33.296426 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m13:13:33.296877 [debug] [MainThread]: STDERR: "b''"
[0m13:13:33.297145 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m13:13:33.297485 [info ] [MainThread]: Connection:
[0m13:13:33.297809 [info ] [MainThread]:   database: casestudy
[0m13:13:33.298112 [info ] [MainThread]:   schema: main
[0m13:13:33.298402 [info ] [MainThread]:   path: casestudy.duckdb
[0m13:13:33.298673 [info ] [MainThread]:   config_options: None
[0m13:13:33.298939 [info ] [MainThread]:   extensions: ['icu']
[0m13:13:33.299203 [info ] [MainThread]:   settings: None
[0m13:13:33.299467 [info ] [MainThread]:   external_root: .
[0m13:13:33.299733 [info ] [MainThread]:   use_credential_provider: None
[0m13:13:33.300017 [info ] [MainThread]:   attach: None
[0m13:13:33.300285 [info ] [MainThread]:   filesystems: None
[0m13:13:33.300576 [info ] [MainThread]:   remote: None
[0m13:13:33.300860 [info ] [MainThread]:   plugins: None
[0m13:13:33.301187 [info ] [MainThread]:   disable_transactions: False
[0m13:13:33.301632 [info ] [MainThread]: Registered adapter: duckdb=1.6.2
[0m13:13:33.302354 [debug] [MainThread]: Acquiring new duckdb connection 'debug'
[0m13:13:33.302670 [debug] [MainThread]: Using duckdb connection "debug"
[0m13:13:33.302930 [debug] [MainThread]: On debug: select 1 as id
[0m13:13:33.303177 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:13:33.435253 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m13:13:33.436336 [debug] [MainThread]: On debug: Close
[0m13:13:33.439049 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m13:13:33.439565 [info ] [MainThread]: [32mAll checks passed![0m
[0m13:13:33.440051 [debug] [MainThread]: Command `dbt debug` succeeded at 13:13:33.439952 after 0.34 seconds
[0m13:13:33.440357 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m13:13:33.440686 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa092671910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0927b4f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0927b4ed0>]}
[0m13:13:33.441068 [debug] [MainThread]: Flushing usage events
[0m14:40:07.140922 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08de90d450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08debdbf50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08dec11850>]}


============================== 14:40:07.147166 | e8a6f5cc-bada-4119-b01c-1f252e4bfc06 ==============================
[0m14:40:07.147166 [info ] [MainThread]: Running with dbt=1.6.18
[0m14:40:07.147761 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/workspaces/vg_case_study_tim/transformation', 'version_check': 'True', 'debug': 'False', 'log_path': '/workspaces/vg_case_study_tim/transformation/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run --select stg_staging_intermediate__transactions', 'send_anonymous_usage_stats': 'True'}
[0m14:40:07.327874 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e8a6f5cc-bada-4119-b01c-1f252e4bfc06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08debdbf90>]}
[0m14:40:07.341868 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e8a6f5cc-bada-4119-b01c-1f252e4bfc06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08de8f98d0>]}
[0m14:40:07.343384 [info ] [MainThread]: Registered adapter: duckdb=1.6.2
[0m14:40:07.371769 [debug] [MainThread]: checksum: 7b9fab86a08e9e96a48a825af743c566d95b877e068b8c6d0dbafbf714447189, vars: {}, profile: , target: , version: 1.6.18
[0m14:40:07.468570 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 2 files changed.
[0m14:40:07.469299 [debug] [MainThread]: Partial parsing: added file: vg_casestudy://models/core/core__transactions_with_eur.sql
[0m14:40:07.470054 [debug] [MainThread]: Partial parsing: updated file: vg_casestudy://models/intermediate/schema.yml
[0m14:40:07.470423 [debug] [MainThread]: Partial parsing: updated file: vg_casestudy://models/intermediate/stg_staging_intermediate__transactions.sql
[0m14:40:07.637372 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.vg_casestudy.marts
- models.vg_casestudy.main
- models.vg_casestudy.reporting
[0m14:40:07.644160 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e8a6f5cc-bada-4119-b01c-1f252e4bfc06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08de91c450>]}
[0m14:40:07.675658 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e8a6f5cc-bada-4119-b01c-1f252e4bfc06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08e02fb4d0>]}
[0m14:40:07.676240 [info ] [MainThread]: Found 13 models, 1 analysis, 3 seeds, 80 tests, 5 sources, 0 exposures, 0 metrics, 632 macros, 0 groups, 0 semantic models
[0m14:40:07.676745 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e8a6f5cc-bada-4119-b01c-1f252e4bfc06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08da536410>]}
[0m14:40:07.679212 [info ] [MainThread]: 
[0m14:40:07.679997 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:40:07.681355 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_casestudy'
[0m14:40:07.695419 [debug] [ThreadPool]: Using duckdb connection "list_casestudy"
[0m14:40:07.695857 [debug] [ThreadPool]: On list_casestudy: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"casestudy"'
    
  
  
[0m14:40:07.696160 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:40:07.829897 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:40:07.831500 [debug] [ThreadPool]: On list_casestudy: Close
[0m14:40:07.835487 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy, now create_casestudy_intermediate)
[0m14:40:07.836342 [debug] [ThreadPool]: Creating schema "database: "casestudy"
schema: "intermediate"
"
[0m14:40:07.841029 [debug] [ThreadPool]: Using duckdb connection "create_casestudy_intermediate"
[0m14:40:07.841399 [debug] [ThreadPool]: On create_casestudy_intermediate: BEGIN
[0m14:40:07.841674 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:40:07.853430 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:40:07.854033 [debug] [ThreadPool]: Using duckdb connection "create_casestudy_intermediate"
[0m14:40:07.854483 [debug] [ThreadPool]: On create_casestudy_intermediate: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "create_casestudy_intermediate"} */
create schema if not exists "casestudy"."intermediate"
[0m14:40:07.855109 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:40:07.856007 [debug] [ThreadPool]: On create_casestudy_intermediate: COMMIT
[0m14:40:07.856339 [debug] [ThreadPool]: Using duckdb connection "create_casestudy_intermediate"
[0m14:40:07.856628 [debug] [ThreadPool]: On create_casestudy_intermediate: COMMIT
[0m14:40:07.857280 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:40:07.857641 [debug] [ThreadPool]: On create_casestudy_intermediate: Close
[0m14:40:07.861948 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_casestudy_intermediate, now list_casestudy_main)
[0m14:40:07.867484 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_main"
[0m14:40:07.867935 [debug] [ThreadPool]: On list_casestudy_main: BEGIN
[0m14:40:07.868213 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:40:07.880851 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:40:07.881296 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_main"
[0m14:40:07.881596 [debug] [ThreadPool]: On list_casestudy_main: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_main"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'casestudy'
  
[0m14:40:07.896488 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:40:07.898132 [debug] [ThreadPool]: On list_casestudy_main: ROLLBACK
[0m14:40:07.899705 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_main'
[0m14:40:07.900035 [debug] [ThreadPool]: On list_casestudy_main: Close
[0m14:40:07.903158 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy_main, now list_casestudy_raw)
[0m14:40:07.906239 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_raw"
[0m14:40:07.906622 [debug] [ThreadPool]: On list_casestudy_raw: BEGIN
[0m14:40:07.906994 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:40:07.917660 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:40:07.918095 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_raw"
[0m14:40:07.918374 [debug] [ThreadPool]: On list_casestudy_raw: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_raw"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'raw'
    and table_catalog = 'casestudy'
  
[0m14:40:07.927511 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:40:07.928854 [debug] [ThreadPool]: On list_casestudy_raw: ROLLBACK
[0m14:40:07.929352 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_raw'
[0m14:40:07.929615 [debug] [ThreadPool]: On list_casestudy_raw: Close
[0m14:40:07.932257 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy_raw, now list_casestudy_intermediate)
[0m14:40:07.934487 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_intermediate"
[0m14:40:07.934841 [debug] [ThreadPool]: On list_casestudy_intermediate: BEGIN
[0m14:40:07.935182 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:40:07.945680 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:40:07.946087 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_intermediate"
[0m14:40:07.946374 [debug] [ThreadPool]: On list_casestudy_intermediate: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_intermediate"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'intermediate'
    and table_catalog = 'casestudy'
  
[0m14:40:07.954532 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:40:07.955828 [debug] [ThreadPool]: On list_casestudy_intermediate: ROLLBACK
[0m14:40:07.956279 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_intermediate'
[0m14:40:07.956544 [debug] [ThreadPool]: On list_casestudy_intermediate: Close
[0m14:40:07.959298 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy_intermediate, now list_casestudy_staging)
[0m14:40:07.962417 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_staging"
[0m14:40:07.962708 [debug] [ThreadPool]: On list_casestudy_staging: BEGIN
[0m14:40:07.963056 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:40:07.973819 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:40:07.974250 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_staging"
[0m14:40:07.974550 [debug] [ThreadPool]: On list_casestudy_staging: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_staging"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'staging'
    and table_catalog = 'casestudy'
  
[0m14:40:07.982541 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:40:07.984252 [debug] [ThreadPool]: On list_casestudy_staging: ROLLBACK
[0m14:40:07.984786 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_staging'
[0m14:40:07.985093 [debug] [ThreadPool]: On list_casestudy_staging: Close
[0m14:40:07.989318 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e8a6f5cc-bada-4119-b01c-1f252e4bfc06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08df6169d0>]}
[0m14:40:07.989824 [debug] [MainThread]: Using duckdb connection "master"
[0m14:40:07.990132 [debug] [MainThread]: On master: BEGIN
[0m14:40:07.990421 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:40:08.003211 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:40:08.003854 [debug] [MainThread]: On master: COMMIT
[0m14:40:08.004133 [debug] [MainThread]: Using duckdb connection "master"
[0m14:40:08.004405 [debug] [MainThread]: On master: COMMIT
[0m14:40:08.005058 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:40:08.005384 [debug] [MainThread]: On master: Close
[0m14:40:08.008083 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:40:08.008534 [info ] [MainThread]: 
[0m14:40:08.014258 [debug] [Thread-1 (]: Began running node model.vg_casestudy.stg_staging_intermediate__transactions
[0m14:40:08.014876 [info ] [Thread-1 (]: 1 of 1 START sql table model intermediate.stg_staging_intermediate__transactions  [RUN]
[0m14:40:08.015850 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.vg_casestudy.stg_staging_intermediate__transactions'
[0m14:40:08.016373 [debug] [Thread-1 (]: Began compiling node model.vg_casestudy.stg_staging_intermediate__transactions
[0m14:40:08.026726 [debug] [Thread-1 (]: Writing injected SQL for node "model.vg_casestudy.stg_staging_intermediate__transactions"
[0m14:40:08.028040 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.stg_staging_intermediate__transactions (compile): 14:40:08.016708 => 14:40:08.027553
[0m14:40:08.028646 [debug] [Thread-1 (]: Began executing node model.vg_casestudy.stg_staging_intermediate__transactions
[0m14:40:08.062888 [debug] [Thread-1 (]: Writing runtime sql for node "model.vg_casestudy.stg_staging_intermediate__transactions"
[0m14:40:08.063846 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__transactions"
[0m14:40:08.064597 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__transactions: BEGIN
[0m14:40:08.065153 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:40:08.081467 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:40:08.082196 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__transactions"
[0m14:40:08.082761 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__transactions: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_staging_intermediate__transactions"} */

  
    
    

    create  table
      "casestudy"."intermediate"."stg_staging_intermediate__transactions__dbt_tmp"
  
    as (
      with staging as (
    select * from "casestudy"."staging"."stg_raw_staging__transactions"
),

filtered as (
    select
        transaction_id,
        transaction_date,
        account_id,
        transaction_type,
        transaction_amount,
        case 
            when transaction_currency = 'RON1' then 'RON'
            else transaction_currency
        end as transaction_currency
    from staging
    where not has_date_parsing_error
)

select * from filtered
    );
  
  
[0m14:40:08.163286 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:40:08.170112 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__transactions"
[0m14:40:08.170559 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__transactions: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_staging_intermediate__transactions"} */
alter table "casestudy"."intermediate"."stg_staging_intermediate__transactions" rename to "stg_staging_intermediate__transactions__dbt_backup"
[0m14:40:08.171545 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:40:08.174736 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__transactions"
[0m14:40:08.175116 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__transactions: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_staging_intermediate__transactions"} */
alter table "casestudy"."intermediate"."stg_staging_intermediate__transactions__dbt_tmp" rename to "stg_staging_intermediate__transactions"
[0m14:40:08.175926 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:40:08.194054 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__transactions: COMMIT
[0m14:40:08.194476 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__transactions"
[0m14:40:08.194809 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__transactions: COMMIT
[0m14:40:08.210851 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:40:08.220453 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__transactions"
[0m14:40:08.221000 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__transactions: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_staging_intermediate__transactions"} */
drop table if exists "casestudy"."intermediate"."stg_staging_intermediate__transactions__dbt_backup" cascade
[0m14:40:08.225728 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:40:08.227478 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.stg_staging_intermediate__transactions (execute): 14:40:08.029066 => 14:40:08.227289
[0m14:40:08.227911 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__transactions: Close
[0m14:40:08.283394 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e8a6f5cc-bada-4119-b01c-1f252e4bfc06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08e0430210>]}
[0m14:40:08.284499 [info ] [Thread-1 (]: 1 of 1 OK created sql table model intermediate.stg_staging_intermediate__transactions  [[32mOK[0m in 0.27s]
[0m14:40:08.285422 [debug] [Thread-1 (]: Finished running node model.vg_casestudy.stg_staging_intermediate__transactions
[0m14:40:08.287773 [debug] [MainThread]: Using duckdb connection "master"
[0m14:40:08.288284 [debug] [MainThread]: On master: BEGIN
[0m14:40:08.288646 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:40:08.306603 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:40:08.307068 [debug] [MainThread]: On master: COMMIT
[0m14:40:08.307407 [debug] [MainThread]: Using duckdb connection "master"
[0m14:40:08.307720 [debug] [MainThread]: On master: COMMIT
[0m14:40:08.308478 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:40:08.308908 [debug] [MainThread]: On master: Close
[0m14:40:08.312506 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:40:08.313137 [debug] [MainThread]: Connection 'list_casestudy_staging' was properly closed.
[0m14:40:08.313499 [debug] [MainThread]: Connection 'model.vg_casestudy.stg_staging_intermediate__transactions' was properly closed.
[0m14:40:08.313925 [info ] [MainThread]: 
[0m14:40:08.314429 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.63 seconds (0.63s).
[0m14:40:08.315206 [debug] [MainThread]: Command end result
[0m14:40:08.338282 [info ] [MainThread]: 
[0m14:40:08.338779 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:40:08.339112 [info ] [MainThread]: 
[0m14:40:08.339458 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m14:40:08.339945 [debug] [MainThread]: Command `dbt run` succeeded at 14:40:08.339845 after 1.21 seconds
[0m14:40:08.340298 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08de7fb890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08de644ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08de6487d0>]}
[0m14:40:08.340663 [debug] [MainThread]: Flushing usage events
[0m14:40:26.975868 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c69c288d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c69b3da90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c69ad2390>]}


============================== 14:40:26.978328 | 0910081f-7cc6-48d0-9a5f-384ad5000ffc ==============================
[0m14:40:26.978328 [info ] [MainThread]: Running with dbt=1.6.18
[0m14:40:26.978896 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/workspaces/vg_case_study_tim/transformation', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/workspaces/vg_case_study_tim/transformation/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt test --select stg_staging_intermediate__transactions', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:40:27.074598 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0910081f-7cc6-48d0-9a5f-384ad5000ffc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c69f87850>]}
[0m14:40:27.089965 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0910081f-7cc6-48d0-9a5f-384ad5000ffc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c697f1f90>]}
[0m14:40:27.090854 [info ] [MainThread]: Registered adapter: duckdb=1.6.2
[0m14:40:27.115865 [debug] [MainThread]: checksum: 7b9fab86a08e9e96a48a825af743c566d95b877e068b8c6d0dbafbf714447189, vars: {}, profile: , target: , version: 1.6.18
[0m14:40:27.157863 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:40:27.158298 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:40:27.159656 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.vg_casestudy.marts
- models.vg_casestudy.reporting
- models.vg_casestudy.main
[0m14:40:27.167625 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0910081f-7cc6-48d0-9a5f-384ad5000ffc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c69e0f950>]}
[0m14:40:27.238755 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0910081f-7cc6-48d0-9a5f-384ad5000ffc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c6582dc50>]}
[0m14:40:27.239306 [info ] [MainThread]: Found 13 models, 1 analysis, 3 seeds, 80 tests, 5 sources, 0 exposures, 0 metrics, 632 macros, 0 groups, 0 semantic models
[0m14:40:27.239711 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0910081f-7cc6-48d0-9a5f-384ad5000ffc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c657bfe90>]}
[0m14:40:27.242312 [info ] [MainThread]: 
[0m14:40:27.243100 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:40:27.246564 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_casestudy_raw'
[0m14:40:27.258324 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_raw"
[0m14:40:27.258901 [debug] [ThreadPool]: On list_casestudy_raw: BEGIN
[0m14:40:27.259236 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:40:27.276280 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:40:27.276735 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_raw"
[0m14:40:27.277079 [debug] [ThreadPool]: On list_casestudy_raw: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_raw"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'raw'
    and table_catalog = 'casestudy'
  
[0m14:40:27.289973 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:40:27.291592 [debug] [ThreadPool]: On list_casestudy_raw: ROLLBACK
[0m14:40:27.292282 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_raw'
[0m14:40:27.292611 [debug] [ThreadPool]: On list_casestudy_raw: Close
[0m14:40:27.295682 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy_raw, now list_casestudy_staging)
[0m14:40:27.298984 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_staging"
[0m14:40:27.299311 [debug] [ThreadPool]: On list_casestudy_staging: BEGIN
[0m14:40:27.299605 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:40:27.312840 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:40:27.313322 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_staging"
[0m14:40:27.313622 [debug] [ThreadPool]: On list_casestudy_staging: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_staging"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'staging'
    and table_catalog = 'casestudy'
  
[0m14:40:27.323857 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:40:27.325405 [debug] [ThreadPool]: On list_casestudy_staging: ROLLBACK
[0m14:40:27.325896 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_staging'
[0m14:40:27.326189 [debug] [ThreadPool]: On list_casestudy_staging: Close
[0m14:40:27.329361 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy_staging, now list_casestudy_main)
[0m14:40:27.331781 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_main"
[0m14:40:27.332139 [debug] [ThreadPool]: On list_casestudy_main: BEGIN
[0m14:40:27.332465 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:40:27.343257 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:40:27.343669 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_main"
[0m14:40:27.343986 [debug] [ThreadPool]: On list_casestudy_main: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_main"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'casestudy'
  
[0m14:40:27.352304 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:40:27.353583 [debug] [ThreadPool]: On list_casestudy_main: ROLLBACK
[0m14:40:27.354047 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_main'
[0m14:40:27.354307 [debug] [ThreadPool]: On list_casestudy_main: Close
[0m14:40:27.357273 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy_main, now list_casestudy_intermediate)
[0m14:40:27.359503 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_intermediate"
[0m14:40:27.359888 [debug] [ThreadPool]: On list_casestudy_intermediate: BEGIN
[0m14:40:27.360191 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:40:27.372936 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:40:27.373384 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_intermediate"
[0m14:40:27.373695 [debug] [ThreadPool]: On list_casestudy_intermediate: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_intermediate"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'intermediate'
    and table_catalog = 'casestudy'
  
[0m14:40:27.382989 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:40:27.384459 [debug] [ThreadPool]: On list_casestudy_intermediate: ROLLBACK
[0m14:40:27.384949 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_intermediate'
[0m14:40:27.385254 [debug] [ThreadPool]: On list_casestudy_intermediate: Close
[0m14:40:27.388943 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0910081f-7cc6-48d0-9a5f-384ad5000ffc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c65732ed0>]}
[0m14:40:27.389462 [debug] [MainThread]: Using duckdb connection "master"
[0m14:40:27.389777 [debug] [MainThread]: On master: BEGIN
[0m14:40:27.390047 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:40:27.401835 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:40:27.402245 [debug] [MainThread]: On master: COMMIT
[0m14:40:27.402523 [debug] [MainThread]: Using duckdb connection "master"
[0m14:40:27.402784 [debug] [MainThread]: On master: COMMIT
[0m14:40:27.403395 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:40:27.403719 [debug] [MainThread]: On master: Close
[0m14:40:27.406014 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:40:27.406444 [info ] [MainThread]: 
[0m14:40:27.409192 [debug] [Thread-1 (]: Began running node test.vg_casestudy.accepted_values_stg_staging_intermediate__transactions_transaction_currency__AUD__BGN__CHF__CZK__DKK__GBP__HUF__ISK__JPY__NOK__PLN__RON__SEK__TRY.93638c3051
[0m14:40:27.409593 [info ] [Thread-1 (]: 1 of 6 START test accepted_values_stg_staging_intermediate__transactions_transaction_currency__AUD__BGN__CHF__CZK__DKK__GBP__HUF__ISK__JPY__NOK__PLN__RON__SEK__TRY  [RUN]
[0m14:40:27.410463 [debug] [Thread-1 (]: Acquiring new duckdb connection 'test.vg_casestudy.accepted_values_stg_staging_intermediate__transactions_transaction_currency__AUD__BGN__CHF__CZK__DKK__GBP__HUF__ISK__JPY__NOK__PLN__RON__SEK__TRY.93638c3051'
[0m14:40:27.411079 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.accepted_values_stg_staging_intermediate__transactions_transaction_currency__AUD__BGN__CHF__CZK__DKK__GBP__HUF__ISK__JPY__NOK__PLN__RON__SEK__TRY.93638c3051
[0m14:40:27.435726 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.accepted_values_stg_staging_intermediate__transactions_transaction_currency__AUD__BGN__CHF__CZK__DKK__GBP__HUF__ISK__JPY__NOK__PLN__RON__SEK__TRY.93638c3051"
[0m14:40:27.436762 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.accepted_values_stg_staging_intermediate__transactions_transaction_currency__AUD__BGN__CHF__CZK__DKK__GBP__HUF__ISK__JPY__NOK__PLN__RON__SEK__TRY.93638c3051 (compile): 14:40:27.411305 => 14:40:27.436451
[0m14:40:27.437241 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.accepted_values_stg_staging_intermediate__transactions_transaction_currency__AUD__BGN__CHF__CZK__DKK__GBP__HUF__ISK__JPY__NOK__PLN__RON__SEK__TRY.93638c3051
[0m14:40:27.451942 [debug] [Thread-1 (]: Writing runtime sql for node "test.vg_casestudy.accepted_values_stg_staging_intermediate__transactions_transaction_currency__AUD__BGN__CHF__CZK__DKK__GBP__HUF__ISK__JPY__NOK__PLN__RON__SEK__TRY.93638c3051"
[0m14:40:27.452687 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.accepted_values_stg_staging_intermediate__transactions_transaction_currency__AUD__BGN__CHF__CZK__DKK__GBP__HUF__ISK__JPY__NOK__PLN__RON__SEK__TRY.93638c3051"
[0m14:40:27.453123 [debug] [Thread-1 (]: On test.vg_casestudy.accepted_values_stg_staging_intermediate__transactions_transaction_currency__AUD__BGN__CHF__CZK__DKK__GBP__HUF__ISK__JPY__NOK__PLN__RON__SEK__TRY.93638c3051: BEGIN
[0m14:40:27.453427 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:40:27.465087 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:40:27.465567 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.accepted_values_stg_staging_intermediate__transactions_transaction_currency__AUD__BGN__CHF__CZK__DKK__GBP__HUF__ISK__JPY__NOK__PLN__RON__SEK__TRY.93638c3051"
[0m14:40:27.465949 [debug] [Thread-1 (]: On test.vg_casestudy.accepted_values_stg_staging_intermediate__transactions_transaction_currency__AUD__BGN__CHF__CZK__DKK__GBP__HUF__ISK__JPY__NOK__PLN__RON__SEK__TRY.93638c3051: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "test.vg_casestudy.accepted_values_stg_staging_intermediate__transactions_transaction_currency__AUD__BGN__CHF__CZK__DKK__GBP__HUF__ISK__JPY__NOK__PLN__RON__SEK__TRY.93638c3051"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        transaction_currency as value_field,
        count(*) as n_records

    from "casestudy"."intermediate"."stg_staging_intermediate__transactions"
    group by transaction_currency

)

select *
from all_values
where value_field not in (
    'AUD','BGN','CHF','CZK','DKK','GBP','HUF','ISK','JPY','NOK','PLN','RON','SEK','TRY'
)



      
    ) dbt_internal_test
[0m14:40:27.480484 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:40:27.483696 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.accepted_values_stg_staging_intermediate__transactions_transaction_currency__AUD__BGN__CHF__CZK__DKK__GBP__HUF__ISK__JPY__NOK__PLN__RON__SEK__TRY.93638c3051 (execute): 14:40:27.437491 => 14:40:27.483472
[0m14:40:27.484135 [debug] [Thread-1 (]: On test.vg_casestudy.accepted_values_stg_staging_intermediate__transactions_transaction_currency__AUD__BGN__CHF__CZK__DKK__GBP__HUF__ISK__JPY__NOK__PLN__RON__SEK__TRY.93638c3051: ROLLBACK
[0m14:40:27.484654 [debug] [Thread-1 (]: Failed to rollback 'test.vg_casestudy.accepted_values_stg_staging_intermediate__transactions_transaction_currency__AUD__BGN__CHF__CZK__DKK__GBP__HUF__ISK__JPY__NOK__PLN__RON__SEK__TRY.93638c3051'
[0m14:40:27.484997 [debug] [Thread-1 (]: On test.vg_casestudy.accepted_values_stg_staging_intermediate__transactions_transaction_currency__AUD__BGN__CHF__CZK__DKK__GBP__HUF__ISK__JPY__NOK__PLN__RON__SEK__TRY.93638c3051: Close
[0m14:40:27.488162 [info ] [Thread-1 (]: 1 of 6 PASS accepted_values_stg_staging_intermediate__transactions_transaction_currency__AUD__BGN__CHF__CZK__DKK__GBP__HUF__ISK__JPY__NOK__PLN__RON__SEK__TRY  [[32mPASS[0m in 0.08s]
[0m14:40:27.488819 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.accepted_values_stg_staging_intermediate__transactions_transaction_currency__AUD__BGN__CHF__CZK__DKK__GBP__HUF__ISK__JPY__NOK__PLN__RON__SEK__TRY.93638c3051
[0m14:40:27.489254 [debug] [Thread-1 (]: Began running node test.vg_casestudy.not_null_stg_staging_intermediate__transactions_transaction_amount.8dc65a17fe
[0m14:40:27.489641 [info ] [Thread-1 (]: 2 of 6 START test not_null_stg_staging_intermediate__transactions_transaction_amount  [RUN]
[0m14:40:27.490549 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.accepted_values_stg_staging_intermediate__transactions_transaction_currency__AUD__BGN__CHF__CZK__DKK__GBP__HUF__ISK__JPY__NOK__PLN__RON__SEK__TRY.93638c3051, now test.vg_casestudy.not_null_stg_staging_intermediate__transactions_transaction_amount.8dc65a17fe)
[0m14:40:27.490915 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.not_null_stg_staging_intermediate__transactions_transaction_amount.8dc65a17fe
[0m14:40:27.498352 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.not_null_stg_staging_intermediate__transactions_transaction_amount.8dc65a17fe"
[0m14:40:27.499572 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_stg_staging_intermediate__transactions_transaction_amount.8dc65a17fe (compile): 14:40:27.491151 => 14:40:27.499197
[0m14:40:27.500174 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.not_null_stg_staging_intermediate__transactions_transaction_amount.8dc65a17fe
[0m14:40:27.504333 [debug] [Thread-1 (]: Writing runtime sql for node "test.vg_casestudy.not_null_stg_staging_intermediate__transactions_transaction_amount.8dc65a17fe"
[0m14:40:27.505283 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.not_null_stg_staging_intermediate__transactions_transaction_amount.8dc65a17fe"
[0m14:40:27.505804 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_stg_staging_intermediate__transactions_transaction_amount.8dc65a17fe: BEGIN
[0m14:40:27.506288 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:40:27.519364 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:40:27.519989 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.not_null_stg_staging_intermediate__transactions_transaction_amount.8dc65a17fe"
[0m14:40:27.520586 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_stg_staging_intermediate__transactions_transaction_amount.8dc65a17fe: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "test.vg_casestudy.not_null_stg_staging_intermediate__transactions_transaction_amount.8dc65a17fe"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select transaction_amount
from "casestudy"."intermediate"."stg_staging_intermediate__transactions"
where transaction_amount is null



      
    ) dbt_internal_test
[0m14:40:27.522055 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:40:27.523749 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_stg_staging_intermediate__transactions_transaction_amount.8dc65a17fe (execute): 14:40:27.500540 => 14:40:27.523513
[0m14:40:27.524167 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_stg_staging_intermediate__transactions_transaction_amount.8dc65a17fe: ROLLBACK
[0m14:40:27.524666 [debug] [Thread-1 (]: Failed to rollback 'test.vg_casestudy.not_null_stg_staging_intermediate__transactions_transaction_amount.8dc65a17fe'
[0m14:40:27.525076 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_stg_staging_intermediate__transactions_transaction_amount.8dc65a17fe: Close
[0m14:40:27.527895 [info ] [Thread-1 (]: 2 of 6 PASS not_null_stg_staging_intermediate__transactions_transaction_amount . [[32mPASS[0m in 0.04s]
[0m14:40:27.528601 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.not_null_stg_staging_intermediate__transactions_transaction_amount.8dc65a17fe
[0m14:40:27.529070 [debug] [Thread-1 (]: Began running node test.vg_casestudy.not_null_stg_staging_intermediate__transactions_transaction_currency.fd19959743
[0m14:40:27.529706 [info ] [Thread-1 (]: 3 of 6 START test not_null_stg_staging_intermediate__transactions_transaction_currency  [RUN]
[0m14:40:27.530527 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.not_null_stg_staging_intermediate__transactions_transaction_amount.8dc65a17fe, now test.vg_casestudy.not_null_stg_staging_intermediate__transactions_transaction_currency.fd19959743)
[0m14:40:27.530903 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.not_null_stg_staging_intermediate__transactions_transaction_currency.fd19959743
[0m14:40:27.536022 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.not_null_stg_staging_intermediate__transactions_transaction_currency.fd19959743"
[0m14:40:27.537391 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_stg_staging_intermediate__transactions_transaction_currency.fd19959743 (compile): 14:40:27.531136 => 14:40:27.536695
[0m14:40:27.538044 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.not_null_stg_staging_intermediate__transactions_transaction_currency.fd19959743
[0m14:40:27.541725 [debug] [Thread-1 (]: Writing runtime sql for node "test.vg_casestudy.not_null_stg_staging_intermediate__transactions_transaction_currency.fd19959743"
[0m14:40:27.542589 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.not_null_stg_staging_intermediate__transactions_transaction_currency.fd19959743"
[0m14:40:27.543161 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_stg_staging_intermediate__transactions_transaction_currency.fd19959743: BEGIN
[0m14:40:27.543602 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:40:27.559584 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:40:27.560119 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.not_null_stg_staging_intermediate__transactions_transaction_currency.fd19959743"
[0m14:40:27.560551 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_stg_staging_intermediate__transactions_transaction_currency.fd19959743: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "test.vg_casestudy.not_null_stg_staging_intermediate__transactions_transaction_currency.fd19959743"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select transaction_currency
from "casestudy"."intermediate"."stg_staging_intermediate__transactions"
where transaction_currency is null



      
    ) dbt_internal_test
[0m14:40:27.561981 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:40:27.563684 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_stg_staging_intermediate__transactions_transaction_currency.fd19959743 (execute): 14:40:27.538346 => 14:40:27.563448
[0m14:40:27.564096 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_stg_staging_intermediate__transactions_transaction_currency.fd19959743: ROLLBACK
[0m14:40:27.564586 [debug] [Thread-1 (]: Failed to rollback 'test.vg_casestudy.not_null_stg_staging_intermediate__transactions_transaction_currency.fd19959743'
[0m14:40:27.564948 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_stg_staging_intermediate__transactions_transaction_currency.fd19959743: Close
[0m14:40:27.567688 [info ] [Thread-1 (]: 3 of 6 PASS not_null_stg_staging_intermediate__transactions_transaction_currency  [[32mPASS[0m in 0.04s]
[0m14:40:27.568555 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.not_null_stg_staging_intermediate__transactions_transaction_currency.fd19959743
[0m14:40:27.569187 [debug] [Thread-1 (]: Began running node test.vg_casestudy.not_null_stg_staging_intermediate__transactions_transaction_id.cb7402fe02
[0m14:40:27.569904 [info ] [Thread-1 (]: 4 of 6 START test not_null_stg_staging_intermediate__transactions_transaction_id  [RUN]
[0m14:40:27.570742 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.not_null_stg_staging_intermediate__transactions_transaction_currency.fd19959743, now test.vg_casestudy.not_null_stg_staging_intermediate__transactions_transaction_id.cb7402fe02)
[0m14:40:27.571175 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.not_null_stg_staging_intermediate__transactions_transaction_id.cb7402fe02
[0m14:40:27.576414 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.not_null_stg_staging_intermediate__transactions_transaction_id.cb7402fe02"
[0m14:40:27.577465 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_stg_staging_intermediate__transactions_transaction_id.cb7402fe02 (compile): 14:40:27.571452 => 14:40:27.577179
[0m14:40:27.577900 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.not_null_stg_staging_intermediate__transactions_transaction_id.cb7402fe02
[0m14:40:27.580823 [debug] [Thread-1 (]: Writing runtime sql for node "test.vg_casestudy.not_null_stg_staging_intermediate__transactions_transaction_id.cb7402fe02"
[0m14:40:27.581573 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.not_null_stg_staging_intermediate__transactions_transaction_id.cb7402fe02"
[0m14:40:27.582006 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_stg_staging_intermediate__transactions_transaction_id.cb7402fe02: BEGIN
[0m14:40:27.582361 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:40:27.598074 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:40:27.598582 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.not_null_stg_staging_intermediate__transactions_transaction_id.cb7402fe02"
[0m14:40:27.598958 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_stg_staging_intermediate__transactions_transaction_id.cb7402fe02: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "test.vg_casestudy.not_null_stg_staging_intermediate__transactions_transaction_id.cb7402fe02"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select transaction_id
from "casestudy"."intermediate"."stg_staging_intermediate__transactions"
where transaction_id is null



      
    ) dbt_internal_test
[0m14:40:27.600270 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:40:27.601998 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_stg_staging_intermediate__transactions_transaction_id.cb7402fe02 (execute): 14:40:27.578142 => 14:40:27.601771
[0m14:40:27.602655 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_stg_staging_intermediate__transactions_transaction_id.cb7402fe02: ROLLBACK
[0m14:40:27.603245 [debug] [Thread-1 (]: Failed to rollback 'test.vg_casestudy.not_null_stg_staging_intermediate__transactions_transaction_id.cb7402fe02'
[0m14:40:27.603591 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_stg_staging_intermediate__transactions_transaction_id.cb7402fe02: Close
[0m14:40:27.606732 [info ] [Thread-1 (]: 4 of 6 PASS not_null_stg_staging_intermediate__transactions_transaction_id ..... [[32mPASS[0m in 0.04s]
[0m14:40:27.607689 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.not_null_stg_staging_intermediate__transactions_transaction_id.cb7402fe02
[0m14:40:27.608354 [debug] [Thread-1 (]: Began running node test.vg_casestudy.numeric_range_stg_staging_intermediate__transactions_transaction_amount__0.789e7a4361
[0m14:40:27.609066 [info ] [Thread-1 (]: 5 of 6 START test numeric_range_stg_staging_intermediate__transactions_transaction_amount__0  [RUN]
[0m14:40:27.610070 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.not_null_stg_staging_intermediate__transactions_transaction_id.cb7402fe02, now test.vg_casestudy.numeric_range_stg_staging_intermediate__transactions_transaction_amount__0.789e7a4361)
[0m14:40:27.611034 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.numeric_range_stg_staging_intermediate__transactions_transaction_amount__0.789e7a4361
[0m14:40:27.621368 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.numeric_range_stg_staging_intermediate__transactions_transaction_amount__0.789e7a4361"
[0m14:40:27.622473 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.numeric_range_stg_staging_intermediate__transactions_transaction_amount__0.789e7a4361 (compile): 14:40:27.611505 => 14:40:27.622092
[0m14:40:27.623162 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.numeric_range_stg_staging_intermediate__transactions_transaction_amount__0.789e7a4361
[0m14:40:27.626868 [debug] [Thread-1 (]: Writing runtime sql for node "test.vg_casestudy.numeric_range_stg_staging_intermediate__transactions_transaction_amount__0.789e7a4361"
[0m14:40:27.627575 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.numeric_range_stg_staging_intermediate__transactions_transaction_amount__0.789e7a4361"
[0m14:40:27.628024 [debug] [Thread-1 (]: On test.vg_casestudy.numeric_range_stg_staging_intermediate__transactions_transaction_amount__0.789e7a4361: BEGIN
[0m14:40:27.628431 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:40:27.643664 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:40:27.644149 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.numeric_range_stg_staging_intermediate__transactions_transaction_amount__0.789e7a4361"
[0m14:40:27.644538 [debug] [Thread-1 (]: On test.vg_casestudy.numeric_range_stg_staging_intermediate__transactions_transaction_amount__0.789e7a4361: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "test.vg_casestudy.numeric_range_stg_staging_intermediate__transactions_transaction_amount__0.789e7a4361"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

    
        select *
        from "casestudy"."intermediate"."stg_staging_intermediate__transactions"
        where transaction_amount < 0
    
    


      
    ) dbt_internal_test
[0m14:40:27.645917 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:40:27.649694 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.numeric_range_stg_staging_intermediate__transactions_transaction_amount__0.789e7a4361 (execute): 14:40:27.623580 => 14:40:27.649444
[0m14:40:27.650129 [debug] [Thread-1 (]: On test.vg_casestudy.numeric_range_stg_staging_intermediate__transactions_transaction_amount__0.789e7a4361: ROLLBACK
[0m14:40:27.650688 [debug] [Thread-1 (]: Failed to rollback 'test.vg_casestudy.numeric_range_stg_staging_intermediate__transactions_transaction_amount__0.789e7a4361'
[0m14:40:27.651024 [debug] [Thread-1 (]: On test.vg_casestudy.numeric_range_stg_staging_intermediate__transactions_transaction_amount__0.789e7a4361: Close
[0m14:40:27.653574 [info ] [Thread-1 (]: 5 of 6 PASS numeric_range_stg_staging_intermediate__transactions_transaction_amount__0  [[32mPASS[0m in 0.04s]
[0m14:40:27.654258 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.numeric_range_stg_staging_intermediate__transactions_transaction_amount__0.789e7a4361
[0m14:40:27.654715 [debug] [Thread-1 (]: Began running node test.vg_casestudy.unique_stg_staging_intermediate__transactions_transaction_id.dbfd7b9b66
[0m14:40:27.655279 [info ] [Thread-1 (]: 6 of 6 START test unique_stg_staging_intermediate__transactions_transaction_id . [RUN]
[0m14:40:27.656032 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.numeric_range_stg_staging_intermediate__transactions_transaction_amount__0.789e7a4361, now test.vg_casestudy.unique_stg_staging_intermediate__transactions_transaction_id.dbfd7b9b66)
[0m14:40:27.656387 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.unique_stg_staging_intermediate__transactions_transaction_id.dbfd7b9b66
[0m14:40:27.663035 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.unique_stg_staging_intermediate__transactions_transaction_id.dbfd7b9b66"
[0m14:40:27.663898 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.unique_stg_staging_intermediate__transactions_transaction_id.dbfd7b9b66 (compile): 14:40:27.656612 => 14:40:27.663599
[0m14:40:27.664465 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.unique_stg_staging_intermediate__transactions_transaction_id.dbfd7b9b66
[0m14:40:27.667364 [debug] [Thread-1 (]: Writing runtime sql for node "test.vg_casestudy.unique_stg_staging_intermediate__transactions_transaction_id.dbfd7b9b66"
[0m14:40:27.668135 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.unique_stg_staging_intermediate__transactions_transaction_id.dbfd7b9b66"
[0m14:40:27.668875 [debug] [Thread-1 (]: On test.vg_casestudy.unique_stg_staging_intermediate__transactions_transaction_id.dbfd7b9b66: BEGIN
[0m14:40:27.669673 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:40:27.683099 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:40:27.683587 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.unique_stg_staging_intermediate__transactions_transaction_id.dbfd7b9b66"
[0m14:40:27.683986 [debug] [Thread-1 (]: On test.vg_casestudy.unique_stg_staging_intermediate__transactions_transaction_id.dbfd7b9b66: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "test.vg_casestudy.unique_stg_staging_intermediate__transactions_transaction_id.dbfd7b9b66"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    transaction_id as unique_field,
    count(*) as n_records

from "casestudy"."intermediate"."stg_staging_intermediate__transactions"
where transaction_id is not null
group by transaction_id
having count(*) > 1



      
    ) dbt_internal_test
[0m14:40:27.694928 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:40:27.696791 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.unique_stg_staging_intermediate__transactions_transaction_id.dbfd7b9b66 (execute): 14:40:27.664824 => 14:40:27.696541
[0m14:40:27.697254 [debug] [Thread-1 (]: On test.vg_casestudy.unique_stg_staging_intermediate__transactions_transaction_id.dbfd7b9b66: ROLLBACK
[0m14:40:27.697728 [debug] [Thread-1 (]: Failed to rollback 'test.vg_casestudy.unique_stg_staging_intermediate__transactions_transaction_id.dbfd7b9b66'
[0m14:40:27.698120 [debug] [Thread-1 (]: On test.vg_casestudy.unique_stg_staging_intermediate__transactions_transaction_id.dbfd7b9b66: Close
[0m14:40:27.702017 [info ] [Thread-1 (]: 6 of 6 PASS unique_stg_staging_intermediate__transactions_transaction_id ....... [[32mPASS[0m in 0.05s]
[0m14:40:27.702728 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.unique_stg_staging_intermediate__transactions_transaction_id.dbfd7b9b66
[0m14:40:27.704702 [debug] [MainThread]: Using duckdb connection "master"
[0m14:40:27.705048 [debug] [MainThread]: On master: BEGIN
[0m14:40:27.705324 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:40:27.718449 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:40:27.718949 [debug] [MainThread]: On master: COMMIT
[0m14:40:27.719369 [debug] [MainThread]: Using duckdb connection "master"
[0m14:40:27.719684 [debug] [MainThread]: On master: COMMIT
[0m14:40:27.720494 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:40:27.720955 [debug] [MainThread]: On master: Close
[0m14:40:27.723739 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:40:27.724333 [debug] [MainThread]: Connection 'list_casestudy_intermediate' was properly closed.
[0m14:40:27.724662 [debug] [MainThread]: Connection 'test.vg_casestudy.unique_stg_staging_intermediate__transactions_transaction_id.dbfd7b9b66' was properly closed.
[0m14:40:27.725041 [info ] [MainThread]: 
[0m14:40:27.725507 [info ] [MainThread]: Finished running 6 tests in 0 hours 0 minutes and 0.48 seconds (0.48s).
[0m14:40:27.726707 [debug] [MainThread]: Command end result
[0m14:40:27.747699 [info ] [MainThread]: 
[0m14:40:27.748194 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:40:27.748550 [info ] [MainThread]: 
[0m14:40:27.748892 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m14:40:27.749373 [debug] [MainThread]: Command `dbt test` succeeded at 14:40:27.749276 after 0.78 seconds
[0m14:40:27.749728 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c6e5818d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c6997e350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c6b3e2f50>]}
[0m14:40:27.750098 [debug] [MainThread]: Flushing usage events
[0m14:45:31.923801 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9c1002c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9c0e7e950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9c12eba90>]}


============================== 14:45:31.929724 | 41f7ef0f-e0b0-4dce-886d-e17fa66f0951 ==============================
[0m14:45:31.929724 [info ] [MainThread]: Running with dbt=1.6.18
[0m14:45:31.930344 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/workspaces/vg_case_study_tim/transformation', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/workspaces/vg_case_study_tim/transformation/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select core__transactions_with_euro', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:45:32.129320 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '41f7ef0f-e0b0-4dce-886d-e17fa66f0951', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9c0b8f590>]}
[0m14:45:32.144291 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '41f7ef0f-e0b0-4dce-886d-e17fa66f0951', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9c1281150>]}
[0m14:45:32.145825 [info ] [MainThread]: Registered adapter: duckdb=1.6.2
[0m14:45:32.176911 [debug] [MainThread]: checksum: 7b9fab86a08e9e96a48a825af743c566d95b877e068b8c6d0dbafbf714447189, vars: {}, profile: , target: , version: 1.6.18
[0m14:45:32.271619 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 0 files changed.
[0m14:45:32.272378 [debug] [MainThread]: Partial parsing: added file: vg_casestudy://models/core/core__transactions_with_euro.sql
[0m14:45:32.272716 [debug] [MainThread]: Partial parsing: deleted file: vg_casestudy://models/core/core__transactions_with_eur.sql
[0m14:45:32.323631 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.vg_casestudy.main
- models.vg_casestudy.marts
- models.vg_casestudy.reporting
[0m14:45:32.373067 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '41f7ef0f-e0b0-4dce-886d-e17fa66f0951', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9c0b824d0>]}
[0m14:45:32.398942 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '41f7ef0f-e0b0-4dce-886d-e17fa66f0951', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9bd574290>]}
[0m14:45:32.399556 [info ] [MainThread]: Found 13 models, 1 analysis, 3 seeds, 80 tests, 5 sources, 0 exposures, 0 metrics, 632 macros, 0 groups, 0 semantic models
[0m14:45:32.399997 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '41f7ef0f-e0b0-4dce-886d-e17fa66f0951', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9c134a550>]}
[0m14:45:32.402315 [info ] [MainThread]: 
[0m14:45:32.403108 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:45:32.404249 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_casestudy'
[0m14:45:32.417401 [debug] [ThreadPool]: Using duckdb connection "list_casestudy"
[0m14:45:32.417869 [debug] [ThreadPool]: On list_casestudy: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"casestudy"'
    
  
  
[0m14:45:32.418183 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:45:32.544477 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:45:32.545912 [debug] [ThreadPool]: On list_casestudy: Close
[0m14:45:32.550119 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy, now create_casestudy_main)
[0m14:45:32.551002 [debug] [ThreadPool]: Creating schema "database: "casestudy"
schema: "main"
"
[0m14:45:32.555657 [debug] [ThreadPool]: Using duckdb connection "create_casestudy_main"
[0m14:45:32.556053 [debug] [ThreadPool]: On create_casestudy_main: BEGIN
[0m14:45:32.556344 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:45:32.569176 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:45:32.569609 [debug] [ThreadPool]: Using duckdb connection "create_casestudy_main"
[0m14:45:32.569907 [debug] [ThreadPool]: On create_casestudy_main: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "create_casestudy_main"} */
create schema if not exists "casestudy"."main"
[0m14:45:32.570724 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:45:32.571835 [debug] [ThreadPool]: On create_casestudy_main: COMMIT
[0m14:45:32.572273 [debug] [ThreadPool]: Using duckdb connection "create_casestudy_main"
[0m14:45:32.572630 [debug] [ThreadPool]: On create_casestudy_main: COMMIT
[0m14:45:32.573317 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:45:32.573646 [debug] [ThreadPool]: On create_casestudy_main: Close
[0m14:45:32.578102 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_casestudy_main, now list_casestudy_raw)
[0m14:45:32.583766 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_raw"
[0m14:45:32.584163 [debug] [ThreadPool]: On list_casestudy_raw: BEGIN
[0m14:45:32.584468 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:45:32.595886 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:45:32.596289 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_raw"
[0m14:45:32.596611 [debug] [ThreadPool]: On list_casestudy_raw: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_raw"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'raw'
    and table_catalog = 'casestudy'
  
[0m14:45:32.611779 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:45:32.613644 [debug] [ThreadPool]: On list_casestudy_raw: ROLLBACK
[0m14:45:32.615158 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_raw'
[0m14:45:32.615475 [debug] [ThreadPool]: On list_casestudy_raw: Close
[0m14:45:32.619494 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy_raw, now list_casestudy_main)
[0m14:45:32.621709 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_main"
[0m14:45:32.622065 [debug] [ThreadPool]: On list_casestudy_main: BEGIN
[0m14:45:32.622376 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:45:32.632972 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:45:32.633453 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_main"
[0m14:45:32.633749 [debug] [ThreadPool]: On list_casestudy_main: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_main"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'casestudy'
  
[0m14:45:32.641738 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:45:32.643365 [debug] [ThreadPool]: On list_casestudy_main: ROLLBACK
[0m14:45:32.643991 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_main'
[0m14:45:32.644444 [debug] [ThreadPool]: On list_casestudy_main: Close
[0m14:45:32.647556 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy_main, now list_casestudy_staging)
[0m14:45:32.650135 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_staging"
[0m14:45:32.650471 [debug] [ThreadPool]: On list_casestudy_staging: BEGIN
[0m14:45:32.650740 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:45:32.661058 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:45:32.661452 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_staging"
[0m14:45:32.661759 [debug] [ThreadPool]: On list_casestudy_staging: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_staging"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'staging'
    and table_catalog = 'casestudy'
  
[0m14:45:32.669928 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:45:32.671249 [debug] [ThreadPool]: On list_casestudy_staging: ROLLBACK
[0m14:45:32.671709 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_staging'
[0m14:45:32.671972 [debug] [ThreadPool]: On list_casestudy_staging: Close
[0m14:45:32.674905 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy_staging, now list_casestudy_intermediate)
[0m14:45:32.678706 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_intermediate"
[0m14:45:32.679173 [debug] [ThreadPool]: On list_casestudy_intermediate: BEGIN
[0m14:45:32.679503 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:45:32.690416 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:45:32.690843 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_intermediate"
[0m14:45:32.691182 [debug] [ThreadPool]: On list_casestudy_intermediate: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_intermediate"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'intermediate'
    and table_catalog = 'casestudy'
  
[0m14:45:32.699233 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:45:32.700820 [debug] [ThreadPool]: On list_casestudy_intermediate: ROLLBACK
[0m14:45:32.701284 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_intermediate'
[0m14:45:32.701551 [debug] [ThreadPool]: On list_casestudy_intermediate: Close
[0m14:45:32.705335 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '41f7ef0f-e0b0-4dce-886d-e17fa66f0951', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9c1003a90>]}
[0m14:45:32.705811 [debug] [MainThread]: Using duckdb connection "master"
[0m14:45:32.706119 [debug] [MainThread]: On master: BEGIN
[0m14:45:32.706412 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:45:32.719505 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:45:32.719926 [debug] [MainThread]: On master: COMMIT
[0m14:45:32.720232 [debug] [MainThread]: Using duckdb connection "master"
[0m14:45:32.720499 [debug] [MainThread]: On master: COMMIT
[0m14:45:32.720979 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:45:32.721295 [debug] [MainThread]: On master: Close
[0m14:45:32.724311 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:45:32.724781 [info ] [MainThread]: 
[0m14:45:32.731033 [debug] [Thread-1 (]: Began running node model.vg_casestudy.core__transactions_with_euro
[0m14:45:32.731642 [info ] [Thread-1 (]: 1 of 1 START sql view model main.core__transactions_with_euro .................. [RUN]
[0m14:45:32.732631 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.vg_casestudy.core__transactions_with_euro'
[0m14:45:32.733123 [debug] [Thread-1 (]: Began compiling node model.vg_casestudy.core__transactions_with_euro
[0m14:45:32.742734 [debug] [Thread-1 (]: Writing injected SQL for node "model.vg_casestudy.core__transactions_with_euro"
[0m14:45:32.744279 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.core__transactions_with_euro (compile): 14:45:32.733433 => 14:45:32.744027
[0m14:45:32.744710 [debug] [Thread-1 (]: Began executing node model.vg_casestudy.core__transactions_with_euro
[0m14:45:32.776777 [debug] [Thread-1 (]: Writing runtime sql for node "model.vg_casestudy.core__transactions_with_euro"
[0m14:45:32.778426 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.core__transactions_with_euro"
[0m14:45:32.778794 [debug] [Thread-1 (]: On model.vg_casestudy.core__transactions_with_euro: BEGIN
[0m14:45:32.779095 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:45:32.795386 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:45:32.796017 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.core__transactions_with_euro"
[0m14:45:32.796508 [debug] [Thread-1 (]: On model.vg_casestudy.core__transactions_with_euro: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.core__transactions_with_euro"} */

  
  create view "casestudy"."main"."core__transactions_with_euro__dbt_tmp" as (
    with transactions as (
    select *
    from "casestudy"."intermediate"."stg_staging_intermediate__transactions"
),

fx_rates_filled as (
    select *
    from "casestudy"."intermediate"."stg_staging_intermediate_fx_rates_filled"
),

joined as (
    select 
        transactions.transaction_id,
        transactions.transaction_date,
        transactions.account_id,
        transactions.transaction_type,
        transactions.transaction_amount,
        transactions.transaction_currency,
        fx_rates_filled.fx_rate,
        transactions.transaction_amount / nullif(coalesce(fx_rates_filled.fx_rate, 1.0),0) as transaction_amount_euro
    from transactions
    left join fx_rates_filled
    on transactions.transaction_currency = fx_rates_filled.currency_iso_code
    and transactions.transaction_date = fx_rates_filled.fx_rate_date
)

select *
from joined
  );

[0m14:45:32.801607 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:45:32.810686 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.core__transactions_with_euro"
[0m14:45:32.811236 [debug] [Thread-1 (]: On model.vg_casestudy.core__transactions_with_euro: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.core__transactions_with_euro"} */
alter view "casestudy"."main"."core__transactions_with_euro__dbt_tmp" rename to "core__transactions_with_euro"
[0m14:45:32.812667 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:45:32.828830 [debug] [Thread-1 (]: On model.vg_casestudy.core__transactions_with_euro: COMMIT
[0m14:45:32.829407 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.core__transactions_with_euro"
[0m14:45:32.829851 [debug] [Thread-1 (]: On model.vg_casestudy.core__transactions_with_euro: COMMIT
[0m14:45:32.837738 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:45:32.843722 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.core__transactions_with_euro"
[0m14:45:32.844290 [debug] [Thread-1 (]: On model.vg_casestudy.core__transactions_with_euro: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.core__transactions_with_euro"} */
drop view if exists "casestudy"."main"."core__transactions_with_euro__dbt_backup" cascade
[0m14:45:32.845345 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:45:32.847366 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.core__transactions_with_euro (execute): 14:45:32.744953 => 14:45:32.847178
[0m14:45:32.847830 [debug] [Thread-1 (]: On model.vg_casestudy.core__transactions_with_euro: Close
[0m14:45:32.882906 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '41f7ef0f-e0b0-4dce-886d-e17fa66f0951', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9bcb9efd0>]}
[0m14:45:32.884208 [info ] [Thread-1 (]: 1 of 1 OK created sql view model main.core__transactions_with_euro ............. [[32mOK[0m in 0.15s]
[0m14:45:32.884923 [debug] [Thread-1 (]: Finished running node model.vg_casestudy.core__transactions_with_euro
[0m14:45:32.887556 [debug] [MainThread]: Using duckdb connection "master"
[0m14:45:32.887942 [debug] [MainThread]: On master: BEGIN
[0m14:45:32.888288 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:45:32.912054 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:45:32.912683 [debug] [MainThread]: On master: COMMIT
[0m14:45:32.913091 [debug] [MainThread]: Using duckdb connection "master"
[0m14:45:32.913438 [debug] [MainThread]: On master: COMMIT
[0m14:45:32.914235 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:45:32.914673 [debug] [MainThread]: On master: Close
[0m14:45:32.918286 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:45:32.918859 [debug] [MainThread]: Connection 'list_casestudy_intermediate' was properly closed.
[0m14:45:32.919243 [debug] [MainThread]: Connection 'model.vg_casestudy.core__transactions_with_euro' was properly closed.
[0m14:45:32.919789 [info ] [MainThread]: 
[0m14:45:32.920329 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.52 seconds (0.52s).
[0m14:45:32.921139 [debug] [MainThread]: Command end result
[0m14:45:32.946137 [info ] [MainThread]: 
[0m14:45:32.946891 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:45:32.947397 [info ] [MainThread]: 
[0m14:45:32.947801 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m14:45:32.948562 [debug] [MainThread]: Command `dbt run` succeeded at 14:45:32.948406 after 1.04 seconds
[0m14:45:32.949134 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9c59bb410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9c59ba1d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9c0d43b90>]}
[0m14:45:32.949629 [debug] [MainThread]: Flushing usage events
[0m14:48:18.624014 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f766ec5b710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f766eaad510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f766edc5110>]}


============================== 14:48:18.629464 | dcfce918-0401-4fb5-b1d7-8e9a5a339175 ==============================
[0m14:48:18.629464 [info ] [MainThread]: Running with dbt=1.6.18
[0m14:48:18.630064 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/workspaces/vg_case_study_tim/transformation/logs', 'fail_fast': 'False', 'profiles_dir': '/workspaces/vg_case_study_tim/transformation', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test --select core__transactions_with_euro', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:48:18.853614 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dcfce918-0401-4fb5-b1d7-8e9a5a339175', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f766ed83a10>]}
[0m14:48:18.869244 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'dcfce918-0401-4fb5-b1d7-8e9a5a339175', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f766ed18dd0>]}
[0m14:48:18.870947 [info ] [MainThread]: Registered adapter: duckdb=1.6.2
[0m14:48:18.899099 [debug] [MainThread]: checksum: 7b9fab86a08e9e96a48a825af743c566d95b877e068b8c6d0dbafbf714447189, vars: {}, profile: , target: , version: 1.6.18
[0m14:48:18.993531 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m14:48:18.994343 [debug] [MainThread]: Partial parsing: added file: vg_casestudy://models/core/core__transactions_with_euro.yml
[0m14:48:19.130117 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.vg_casestudy.main
- models.vg_casestudy.reporting
- models.vg_casestudy.marts
[0m14:48:19.137237 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dcfce918-0401-4fb5-b1d7-8e9a5a339175', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f766e6ba510>]}
[0m14:48:19.167221 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dcfce918-0401-4fb5-b1d7-8e9a5a339175', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f766e6a1150>]}
[0m14:48:19.167772 [info ] [MainThread]: Found 13 models, 1 analysis, 3 seeds, 88 tests, 5 sources, 0 exposures, 0 metrics, 632 macros, 0 groups, 0 semantic models
[0m14:48:19.168152 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dcfce918-0401-4fb5-b1d7-8e9a5a339175', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f766a420090>]}
[0m14:48:19.170880 [info ] [MainThread]: 
[0m14:48:19.171657 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:48:19.174386 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_casestudy_raw'
[0m14:48:19.186131 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_raw"
[0m14:48:19.186776 [debug] [ThreadPool]: On list_casestudy_raw: BEGIN
[0m14:48:19.187132 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:48:19.318016 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:48:19.318562 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_raw"
[0m14:48:19.318956 [debug] [ThreadPool]: On list_casestudy_raw: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_raw"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'raw'
    and table_catalog = 'casestudy'
  
[0m14:48:19.339804 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:48:19.341474 [debug] [ThreadPool]: On list_casestudy_raw: ROLLBACK
[0m14:48:19.342812 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_raw'
[0m14:48:19.343153 [debug] [ThreadPool]: On list_casestudy_raw: Close
[0m14:48:19.347705 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy_raw, now list_casestudy_staging)
[0m14:48:19.351333 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_staging"
[0m14:48:19.351722 [debug] [ThreadPool]: On list_casestudy_staging: BEGIN
[0m14:48:19.351998 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:48:19.363372 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:48:19.363925 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_staging"
[0m14:48:19.364268 [debug] [ThreadPool]: On list_casestudy_staging: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_staging"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'staging'
    and table_catalog = 'casestudy'
  
[0m14:48:19.372942 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:48:19.374498 [debug] [ThreadPool]: On list_casestudy_staging: ROLLBACK
[0m14:48:19.375000 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_staging'
[0m14:48:19.375315 [debug] [ThreadPool]: On list_casestudy_staging: Close
[0m14:48:19.379855 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy_staging, now list_casestudy_intermediate)
[0m14:48:19.382158 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_intermediate"
[0m14:48:19.383567 [debug] [ThreadPool]: On list_casestudy_intermediate: BEGIN
[0m14:48:19.383874 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:48:19.394883 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:48:19.395306 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_intermediate"
[0m14:48:19.395634 [debug] [ThreadPool]: On list_casestudy_intermediate: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_intermediate"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'intermediate'
    and table_catalog = 'casestudy'
  
[0m14:48:19.404166 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:48:19.405725 [debug] [ThreadPool]: On list_casestudy_intermediate: ROLLBACK
[0m14:48:19.406239 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_intermediate'
[0m14:48:19.406554 [debug] [ThreadPool]: On list_casestudy_intermediate: Close
[0m14:48:19.409746 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy_intermediate, now list_casestudy_main)
[0m14:48:19.411955 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_main"
[0m14:48:19.412349 [debug] [ThreadPool]: On list_casestudy_main: BEGIN
[0m14:48:19.412650 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:48:19.423620 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:48:19.424051 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_main"
[0m14:48:19.424375 [debug] [ThreadPool]: On list_casestudy_main: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_main"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'casestudy'
  
[0m14:48:19.432790 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:48:19.434169 [debug] [ThreadPool]: On list_casestudy_main: ROLLBACK
[0m14:48:19.434670 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_main'
[0m14:48:19.434981 [debug] [ThreadPool]: On list_casestudy_main: Close
[0m14:48:19.438698 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dcfce918-0401-4fb5-b1d7-8e9a5a339175', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f766ec8b1d0>]}
[0m14:48:19.439233 [debug] [MainThread]: Using duckdb connection "master"
[0m14:48:19.439540 [debug] [MainThread]: On master: BEGIN
[0m14:48:19.439821 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:48:19.454359 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:48:19.454804 [debug] [MainThread]: On master: COMMIT
[0m14:48:19.455098 [debug] [MainThread]: Using duckdb connection "master"
[0m14:48:19.455367 [debug] [MainThread]: On master: COMMIT
[0m14:48:19.456005 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:48:19.456355 [debug] [MainThread]: On master: Close
[0m14:48:19.458981 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:48:19.459458 [info ] [MainThread]: 
[0m14:48:19.464703 [debug] [Thread-1 (]: Began running node test.vg_casestudy.not_null_core__transactions_with_euro_account_id.2c4215ab21
[0m14:48:19.465162 [info ] [Thread-1 (]: 1 of 8 START test not_null_core__transactions_with_euro_account_id ............. [RUN]
[0m14:48:19.465967 [debug] [Thread-1 (]: Acquiring new duckdb connection 'test.vg_casestudy.not_null_core__transactions_with_euro_account_id.2c4215ab21'
[0m14:48:19.466320 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.not_null_core__transactions_with_euro_account_id.2c4215ab21
[0m14:48:19.482618 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.not_null_core__transactions_with_euro_account_id.2c4215ab21"
[0m14:48:19.484246 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_core__transactions_with_euro_account_id.2c4215ab21 (compile): 14:48:19.466546 => 14:48:19.483957
[0m14:48:19.484732 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.not_null_core__transactions_with_euro_account_id.2c4215ab21
[0m14:48:19.499428 [debug] [Thread-1 (]: Writing runtime sql for node "test.vg_casestudy.not_null_core__transactions_with_euro_account_id.2c4215ab21"
[0m14:48:19.500959 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.not_null_core__transactions_with_euro_account_id.2c4215ab21"
[0m14:48:19.501379 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_core__transactions_with_euro_account_id.2c4215ab21: BEGIN
[0m14:48:19.501702 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:48:19.518513 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:48:19.518989 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.not_null_core__transactions_with_euro_account_id.2c4215ab21"
[0m14:48:19.519348 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_core__transactions_with_euro_account_id.2c4215ab21: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "test.vg_casestudy.not_null_core__transactions_with_euro_account_id.2c4215ab21"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select account_id
from "casestudy"."main"."core__transactions_with_euro"
where account_id is null



      
    ) dbt_internal_test
[0m14:48:19.534507 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:48:19.537977 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_core__transactions_with_euro_account_id.2c4215ab21 (execute): 14:48:19.485046 => 14:48:19.537739
[0m14:48:19.538488 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_core__transactions_with_euro_account_id.2c4215ab21: ROLLBACK
[0m14:48:19.539072 [debug] [Thread-1 (]: Failed to rollback 'test.vg_casestudy.not_null_core__transactions_with_euro_account_id.2c4215ab21'
[0m14:48:19.539465 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_core__transactions_with_euro_account_id.2c4215ab21: Close
[0m14:48:19.542335 [info ] [Thread-1 (]: 1 of 8 PASS not_null_core__transactions_with_euro_account_id ................... [[32mPASS[0m in 0.08s]
[0m14:48:19.543039 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.not_null_core__transactions_with_euro_account_id.2c4215ab21
[0m14:48:19.543583 [debug] [Thread-1 (]: Began running node test.vg_casestudy.not_null_core__transactions_with_euro_transaction_amount.7130175b19
[0m14:48:19.544208 [info ] [Thread-1 (]: 2 of 8 START test not_null_core__transactions_with_euro_transaction_amount ..... [RUN]
[0m14:48:19.544945 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.not_null_core__transactions_with_euro_account_id.2c4215ab21, now test.vg_casestudy.not_null_core__transactions_with_euro_transaction_amount.7130175b19)
[0m14:48:19.545291 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.not_null_core__transactions_with_euro_transaction_amount.7130175b19
[0m14:48:19.549531 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.not_null_core__transactions_with_euro_transaction_amount.7130175b19"
[0m14:48:19.550294 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_core__transactions_with_euro_transaction_amount.7130175b19 (compile): 14:48:19.545522 => 14:48:19.550048
[0m14:48:19.550682 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.not_null_core__transactions_with_euro_transaction_amount.7130175b19
[0m14:48:19.555237 [debug] [Thread-1 (]: Writing runtime sql for node "test.vg_casestudy.not_null_core__transactions_with_euro_transaction_amount.7130175b19"
[0m14:48:19.555988 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.not_null_core__transactions_with_euro_transaction_amount.7130175b19"
[0m14:48:19.556379 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_core__transactions_with_euro_transaction_amount.7130175b19: BEGIN
[0m14:48:19.556727 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:48:19.570219 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:48:19.570711 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.not_null_core__transactions_with_euro_transaction_amount.7130175b19"
[0m14:48:19.571086 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_core__transactions_with_euro_transaction_amount.7130175b19: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "test.vg_casestudy.not_null_core__transactions_with_euro_transaction_amount.7130175b19"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select transaction_amount
from "casestudy"."main"."core__transactions_with_euro"
where transaction_amount is null



      
    ) dbt_internal_test
[0m14:48:19.575564 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:48:19.577436 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_core__transactions_with_euro_transaction_amount.7130175b19 (execute): 14:48:19.550967 => 14:48:19.577204
[0m14:48:19.577887 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_core__transactions_with_euro_transaction_amount.7130175b19: ROLLBACK
[0m14:48:19.578378 [debug] [Thread-1 (]: Failed to rollback 'test.vg_casestudy.not_null_core__transactions_with_euro_transaction_amount.7130175b19'
[0m14:48:19.578722 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_core__transactions_with_euro_transaction_amount.7130175b19: Close
[0m14:48:19.581383 [info ] [Thread-1 (]: 2 of 8 PASS not_null_core__transactions_with_euro_transaction_amount ........... [[32mPASS[0m in 0.04s]
[0m14:48:19.582116 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.not_null_core__transactions_with_euro_transaction_amount.7130175b19
[0m14:48:19.582751 [debug] [Thread-1 (]: Began running node test.vg_casestudy.not_null_core__transactions_with_euro_transaction_amount_euro.d6c3b5cd24
[0m14:48:19.583302 [info ] [Thread-1 (]: 3 of 8 START test not_null_core__transactions_with_euro_transaction_amount_euro  [RUN]
[0m14:48:19.584441 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.not_null_core__transactions_with_euro_transaction_amount.7130175b19, now test.vg_casestudy.not_null_core__transactions_with_euro_transaction_amount_euro.d6c3b5cd24)
[0m14:48:19.584829 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.not_null_core__transactions_with_euro_transaction_amount_euro.d6c3b5cd24
[0m14:48:19.589192 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.not_null_core__transactions_with_euro_transaction_amount_euro.d6c3b5cd24"
[0m14:48:19.590562 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_core__transactions_with_euro_transaction_amount_euro.d6c3b5cd24 (compile): 14:48:19.585061 => 14:48:19.589739
[0m14:48:19.591395 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.not_null_core__transactions_with_euro_transaction_amount_euro.d6c3b5cd24
[0m14:48:19.594888 [debug] [Thread-1 (]: Writing runtime sql for node "test.vg_casestudy.not_null_core__transactions_with_euro_transaction_amount_euro.d6c3b5cd24"
[0m14:48:19.595595 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.not_null_core__transactions_with_euro_transaction_amount_euro.d6c3b5cd24"
[0m14:48:19.595971 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_core__transactions_with_euro_transaction_amount_euro.d6c3b5cd24: BEGIN
[0m14:48:19.596292 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:48:19.610094 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:48:19.610572 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.not_null_core__transactions_with_euro_transaction_amount_euro.d6c3b5cd24"
[0m14:48:19.610918 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_core__transactions_with_euro_transaction_amount_euro.d6c3b5cd24: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "test.vg_casestudy.not_null_core__transactions_with_euro_transaction_amount_euro.d6c3b5cd24"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select transaction_amount_euro
from "casestudy"."main"."core__transactions_with_euro"
where transaction_amount_euro is null



      
    ) dbt_internal_test
[0m14:48:19.624114 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:48:19.625831 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_core__transactions_with_euro_transaction_amount_euro.d6c3b5cd24 (execute): 14:48:19.591862 => 14:48:19.625620
[0m14:48:19.626216 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_core__transactions_with_euro_transaction_amount_euro.d6c3b5cd24: ROLLBACK
[0m14:48:19.626700 [debug] [Thread-1 (]: Failed to rollback 'test.vg_casestudy.not_null_core__transactions_with_euro_transaction_amount_euro.d6c3b5cd24'
[0m14:48:19.627012 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_core__transactions_with_euro_transaction_amount_euro.d6c3b5cd24: Close
[0m14:48:19.630269 [info ] [Thread-1 (]: 3 of 8 PASS not_null_core__transactions_with_euro_transaction_amount_euro ...... [[32mPASS[0m in 0.05s]
[0m14:48:19.630969 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.not_null_core__transactions_with_euro_transaction_amount_euro.d6c3b5cd24
[0m14:48:19.631427 [debug] [Thread-1 (]: Began running node test.vg_casestudy.not_null_core__transactions_with_euro_transaction_date.b09759e145
[0m14:48:19.631813 [info ] [Thread-1 (]: 4 of 8 START test not_null_core__transactions_with_euro_transaction_date ....... [RUN]
[0m14:48:19.632703 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.not_null_core__transactions_with_euro_transaction_amount_euro.d6c3b5cd24, now test.vg_casestudy.not_null_core__transactions_with_euro_transaction_date.b09759e145)
[0m14:48:19.633084 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.not_null_core__transactions_with_euro_transaction_date.b09759e145
[0m14:48:19.637346 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.not_null_core__transactions_with_euro_transaction_date.b09759e145"
[0m14:48:19.638077 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_core__transactions_with_euro_transaction_date.b09759e145 (compile): 14:48:19.633315 => 14:48:19.637848
[0m14:48:19.638571 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.not_null_core__transactions_with_euro_transaction_date.b09759e145
[0m14:48:19.641697 [debug] [Thread-1 (]: Writing runtime sql for node "test.vg_casestudy.not_null_core__transactions_with_euro_transaction_date.b09759e145"
[0m14:48:19.642343 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.not_null_core__transactions_with_euro_transaction_date.b09759e145"
[0m14:48:19.642707 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_core__transactions_with_euro_transaction_date.b09759e145: BEGIN
[0m14:48:19.643009 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:48:19.656513 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:48:19.657031 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.not_null_core__transactions_with_euro_transaction_date.b09759e145"
[0m14:48:19.657463 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_core__transactions_with_euro_transaction_date.b09759e145: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "test.vg_casestudy.not_null_core__transactions_with_euro_transaction_date.b09759e145"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select transaction_date
from "casestudy"."main"."core__transactions_with_euro"
where transaction_date is null



      
    ) dbt_internal_test
[0m14:48:19.660610 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:48:19.662355 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_core__transactions_with_euro_transaction_date.b09759e145 (execute): 14:48:19.638836 => 14:48:19.662106
[0m14:48:19.662852 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_core__transactions_with_euro_transaction_date.b09759e145: ROLLBACK
[0m14:48:19.663601 [debug] [Thread-1 (]: Failed to rollback 'test.vg_casestudy.not_null_core__transactions_with_euro_transaction_date.b09759e145'
[0m14:48:19.664306 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_core__transactions_with_euro_transaction_date.b09759e145: Close
[0m14:48:19.671386 [info ] [Thread-1 (]: 4 of 8 PASS not_null_core__transactions_with_euro_transaction_date ............. [[32mPASS[0m in 0.04s]
[0m14:48:19.674825 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.not_null_core__transactions_with_euro_transaction_date.b09759e145
[0m14:48:19.676088 [debug] [Thread-1 (]: Began running node test.vg_casestudy.not_null_core__transactions_with_euro_transaction_id.f75c556915
[0m14:48:19.677057 [info ] [Thread-1 (]: 5 of 8 START test not_null_core__transactions_with_euro_transaction_id ......... [RUN]
[0m14:48:19.678030 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.not_null_core__transactions_with_euro_transaction_date.b09759e145, now test.vg_casestudy.not_null_core__transactions_with_euro_transaction_id.f75c556915)
[0m14:48:19.678398 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.not_null_core__transactions_with_euro_transaction_id.f75c556915
[0m14:48:19.683501 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.not_null_core__transactions_with_euro_transaction_id.f75c556915"
[0m14:48:19.684421 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_core__transactions_with_euro_transaction_id.f75c556915 (compile): 14:48:19.678662 => 14:48:19.684122
[0m14:48:19.684912 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.not_null_core__transactions_with_euro_transaction_id.f75c556915
[0m14:48:19.687584 [debug] [Thread-1 (]: Writing runtime sql for node "test.vg_casestudy.not_null_core__transactions_with_euro_transaction_id.f75c556915"
[0m14:48:19.688299 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.not_null_core__transactions_with_euro_transaction_id.f75c556915"
[0m14:48:19.688666 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_core__transactions_with_euro_transaction_id.f75c556915: BEGIN
[0m14:48:19.688972 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:48:19.701974 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:48:19.702442 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.not_null_core__transactions_with_euro_transaction_id.f75c556915"
[0m14:48:19.702797 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_core__transactions_with_euro_transaction_id.f75c556915: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "test.vg_casestudy.not_null_core__transactions_with_euro_transaction_id.f75c556915"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select transaction_id
from "casestudy"."main"."core__transactions_with_euro"
where transaction_id is null



      
    ) dbt_internal_test
[0m14:48:19.705495 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:48:19.707087 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_core__transactions_with_euro_transaction_id.f75c556915 (execute): 14:48:19.685194 => 14:48:19.706844
[0m14:48:19.707512 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_core__transactions_with_euro_transaction_id.f75c556915: ROLLBACK
[0m14:48:19.708201 [debug] [Thread-1 (]: Failed to rollback 'test.vg_casestudy.not_null_core__transactions_with_euro_transaction_id.f75c556915'
[0m14:48:19.708639 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_core__transactions_with_euro_transaction_id.f75c556915: Close
[0m14:48:19.711620 [info ] [Thread-1 (]: 5 of 8 PASS not_null_core__transactions_with_euro_transaction_id ............... [[32mPASS[0m in 0.03s]
[0m14:48:19.712299 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.not_null_core__transactions_with_euro_transaction_id.f75c556915
[0m14:48:19.712708 [debug] [Thread-1 (]: Began running node test.vg_casestudy.numeric_range_core__transactions_with_euro_transaction_amount__0.b4dc525fde
[0m14:48:19.713076 [info ] [Thread-1 (]: 6 of 8 START test numeric_range_core__transactions_with_euro_transaction_amount__0  [RUN]
[0m14:48:19.714002 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.not_null_core__transactions_with_euro_transaction_id.f75c556915, now test.vg_casestudy.numeric_range_core__transactions_with_euro_transaction_amount__0.b4dc525fde)
[0m14:48:19.714374 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.numeric_range_core__transactions_with_euro_transaction_amount__0.b4dc525fde
[0m14:48:19.718432 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.numeric_range_core__transactions_with_euro_transaction_amount__0.b4dc525fde"
[0m14:48:19.719052 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.numeric_range_core__transactions_with_euro_transaction_amount__0.b4dc525fde (compile): 14:48:19.714599 => 14:48:19.718858
[0m14:48:19.719466 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.numeric_range_core__transactions_with_euro_transaction_amount__0.b4dc525fde
[0m14:48:19.722540 [debug] [Thread-1 (]: Writing runtime sql for node "test.vg_casestudy.numeric_range_core__transactions_with_euro_transaction_amount__0.b4dc525fde"
[0m14:48:19.723167 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.numeric_range_core__transactions_with_euro_transaction_amount__0.b4dc525fde"
[0m14:48:19.723607 [debug] [Thread-1 (]: On test.vg_casestudy.numeric_range_core__transactions_with_euro_transaction_amount__0.b4dc525fde: BEGIN
[0m14:48:19.723969 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:48:19.738056 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:48:19.738530 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.numeric_range_core__transactions_with_euro_transaction_amount__0.b4dc525fde"
[0m14:48:19.738877 [debug] [Thread-1 (]: On test.vg_casestudy.numeric_range_core__transactions_with_euro_transaction_amount__0.b4dc525fde: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "test.vg_casestudy.numeric_range_core__transactions_with_euro_transaction_amount__0.b4dc525fde"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

    
        select *
        from "casestudy"."main"."core__transactions_with_euro"
        where transaction_amount < 0
    
    


      
    ) dbt_internal_test
[0m14:48:19.742050 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:48:19.744053 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.numeric_range_core__transactions_with_euro_transaction_amount__0.b4dc525fde (execute): 14:48:19.719760 => 14:48:19.743747
[0m14:48:19.744476 [debug] [Thread-1 (]: On test.vg_casestudy.numeric_range_core__transactions_with_euro_transaction_amount__0.b4dc525fde: ROLLBACK
[0m14:48:19.744967 [debug] [Thread-1 (]: Failed to rollback 'test.vg_casestudy.numeric_range_core__transactions_with_euro_transaction_amount__0.b4dc525fde'
[0m14:48:19.745289 [debug] [Thread-1 (]: On test.vg_casestudy.numeric_range_core__transactions_with_euro_transaction_amount__0.b4dc525fde: Close
[0m14:48:19.747854 [info ] [Thread-1 (]: 6 of 8 PASS numeric_range_core__transactions_with_euro_transaction_amount__0 ... [[32mPASS[0m in 0.03s]
[0m14:48:19.748479 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.numeric_range_core__transactions_with_euro_transaction_amount__0.b4dc525fde
[0m14:48:19.748934 [debug] [Thread-1 (]: Began running node test.vg_casestudy.numeric_range_core__transactions_with_euro_transaction_amount_euro__0.751c1dfde7
[0m14:48:19.749400 [info ] [Thread-1 (]: 7 of 8 START test numeric_range_core__transactions_with_euro_transaction_amount_euro__0  [RUN]
[0m14:48:19.750079 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.numeric_range_core__transactions_with_euro_transaction_amount__0.b4dc525fde, now test.vg_casestudy.numeric_range_core__transactions_with_euro_transaction_amount_euro__0.751c1dfde7)
[0m14:48:19.750427 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.numeric_range_core__transactions_with_euro_transaction_amount_euro__0.751c1dfde7
[0m14:48:19.756317 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.numeric_range_core__transactions_with_euro_transaction_amount_euro__0.751c1dfde7"
[0m14:48:19.757295 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.numeric_range_core__transactions_with_euro_transaction_amount_euro__0.751c1dfde7 (compile): 14:48:19.750648 => 14:48:19.756905
[0m14:48:19.757877 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.numeric_range_core__transactions_with_euro_transaction_amount_euro__0.751c1dfde7
[0m14:48:19.761670 [debug] [Thread-1 (]: Writing runtime sql for node "test.vg_casestudy.numeric_range_core__transactions_with_euro_transaction_amount_euro__0.751c1dfde7"
[0m14:48:19.762507 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.numeric_range_core__transactions_with_euro_transaction_amount_euro__0.751c1dfde7"
[0m14:48:19.762999 [debug] [Thread-1 (]: On test.vg_casestudy.numeric_range_core__transactions_with_euro_transaction_amount_euro__0.751c1dfde7: BEGIN
[0m14:48:19.763507 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:48:19.777015 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:48:19.777516 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.numeric_range_core__transactions_with_euro_transaction_amount_euro__0.751c1dfde7"
[0m14:48:19.777890 [debug] [Thread-1 (]: On test.vg_casestudy.numeric_range_core__transactions_with_euro_transaction_amount_euro__0.751c1dfde7: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "test.vg_casestudy.numeric_range_core__transactions_with_euro_transaction_amount_euro__0.751c1dfde7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

    
        select *
        from "casestudy"."main"."core__transactions_with_euro"
        where transaction_amount_euro < 0
    
    


      
    ) dbt_internal_test
[0m14:48:19.786736 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:48:19.788357 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.numeric_range_core__transactions_with_euro_transaction_amount_euro__0.751c1dfde7 (execute): 14:48:19.758246 => 14:48:19.788121
[0m14:48:19.788740 [debug] [Thread-1 (]: On test.vg_casestudy.numeric_range_core__transactions_with_euro_transaction_amount_euro__0.751c1dfde7: ROLLBACK
[0m14:48:19.789200 [debug] [Thread-1 (]: Failed to rollback 'test.vg_casestudy.numeric_range_core__transactions_with_euro_transaction_amount_euro__0.751c1dfde7'
[0m14:48:19.789492 [debug] [Thread-1 (]: On test.vg_casestudy.numeric_range_core__transactions_with_euro_transaction_amount_euro__0.751c1dfde7: Close
[0m14:48:19.793342 [info ] [Thread-1 (]: 7 of 8 PASS numeric_range_core__transactions_with_euro_transaction_amount_euro__0  [[32mPASS[0m in 0.04s]
[0m14:48:19.794211 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.numeric_range_core__transactions_with_euro_transaction_amount_euro__0.751c1dfde7
[0m14:48:19.794632 [debug] [Thread-1 (]: Began running node test.vg_casestudy.unique_core__transactions_with_euro_transaction_id.524c820bba
[0m14:48:19.794997 [info ] [Thread-1 (]: 8 of 8 START test unique_core__transactions_with_euro_transaction_id ........... [RUN]
[0m14:48:19.795780 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.numeric_range_core__transactions_with_euro_transaction_amount_euro__0.751c1dfde7, now test.vg_casestudy.unique_core__transactions_with_euro_transaction_id.524c820bba)
[0m14:48:19.796118 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.unique_core__transactions_with_euro_transaction_id.524c820bba
[0m14:48:19.802626 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.unique_core__transactions_with_euro_transaction_id.524c820bba"
[0m14:48:19.803559 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.unique_core__transactions_with_euro_transaction_id.524c820bba (compile): 14:48:19.796341 => 14:48:19.803175
[0m14:48:19.804080 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.unique_core__transactions_with_euro_transaction_id.524c820bba
[0m14:48:19.807017 [debug] [Thread-1 (]: Writing runtime sql for node "test.vg_casestudy.unique_core__transactions_with_euro_transaction_id.524c820bba"
[0m14:48:19.808057 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.unique_core__transactions_with_euro_transaction_id.524c820bba"
[0m14:48:19.808640 [debug] [Thread-1 (]: On test.vg_casestudy.unique_core__transactions_with_euro_transaction_id.524c820bba: BEGIN
[0m14:48:19.809163 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:48:19.822561 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:48:19.823018 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.unique_core__transactions_with_euro_transaction_id.524c820bba"
[0m14:48:19.823398 [debug] [Thread-1 (]: On test.vg_casestudy.unique_core__transactions_with_euro_transaction_id.524c820bba: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "test.vg_casestudy.unique_core__transactions_with_euro_transaction_id.524c820bba"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    transaction_id as unique_field,
    count(*) as n_records

from "casestudy"."main"."core__transactions_with_euro"
where transaction_id is not null
group by transaction_id
having count(*) > 1



      
    ) dbt_internal_test
[0m14:48:19.840480 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:48:19.842150 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.unique_core__transactions_with_euro_transaction_id.524c820bba (execute): 14:48:19.804345 => 14:48:19.841933
[0m14:48:19.842536 [debug] [Thread-1 (]: On test.vg_casestudy.unique_core__transactions_with_euro_transaction_id.524c820bba: ROLLBACK
[0m14:48:19.843037 [debug] [Thread-1 (]: Failed to rollback 'test.vg_casestudy.unique_core__transactions_with_euro_transaction_id.524c820bba'
[0m14:48:19.843355 [debug] [Thread-1 (]: On test.vg_casestudy.unique_core__transactions_with_euro_transaction_id.524c820bba: Close
[0m14:48:19.846556 [info ] [Thread-1 (]: 8 of 8 PASS unique_core__transactions_with_euro_transaction_id ................. [[32mPASS[0m in 0.05s]
[0m14:48:19.847220 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.unique_core__transactions_with_euro_transaction_id.524c820bba
[0m14:48:19.849285 [debug] [MainThread]: Using duckdb connection "master"
[0m14:48:19.849607 [debug] [MainThread]: On master: BEGIN
[0m14:48:19.849878 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:48:19.864078 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:48:19.864517 [debug] [MainThread]: On master: COMMIT
[0m14:48:19.864804 [debug] [MainThread]: Using duckdb connection "master"
[0m14:48:19.865070 [debug] [MainThread]: On master: COMMIT
[0m14:48:19.865627 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:48:19.865980 [debug] [MainThread]: On master: Close
[0m14:48:19.868571 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:48:19.869024 [debug] [MainThread]: Connection 'list_casestudy_main' was properly closed.
[0m14:48:19.869309 [debug] [MainThread]: Connection 'test.vg_casestudy.unique_core__transactions_with_euro_transaction_id.524c820bba' was properly closed.
[0m14:48:19.869663 [info ] [MainThread]: 
[0m14:48:19.870067 [info ] [MainThread]: Finished running 8 tests in 0 hours 0 minutes and 0.70 seconds (0.70s).
[0m14:48:19.871453 [debug] [MainThread]: Command end result
[0m14:48:19.891564 [info ] [MainThread]: 
[0m14:48:19.892072 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:48:19.892417 [info ] [MainThread]: 
[0m14:48:19.892813 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=0 SKIP=0 TOTAL=8
[0m14:48:19.893363 [debug] [MainThread]: Command `dbt test` succeeded at 14:48:19.893245 after 1.28 seconds
[0m14:48:19.893747 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7671345bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76705bd1d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7670fbd8d0>]}
[0m14:48:19.894111 [debug] [MainThread]: Flushing usage events
