[0m18:52:06.352389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72ccb9af0050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72ccbbe9b950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72ccb98385d0>]}


============================== 18:52:06.356077 | f5354b01-b7b3-4bc5-8cd9-fdf31314330e ==============================
[0m18:52:06.356077 [info ] [MainThread]: Running with dbt=1.6.18
[0m18:52:06.356369 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/workspaces/varengold_data_analyst_case/transformation', 'debug': 'False', 'warn_error': 'None', 'log_path': '/workspaces/varengold_data_analyst_case/transformation/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run-operation explore_schemas', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:52:06.420506 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f5354b01-b7b3-4bc5-8cd9-fdf31314330e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72ccb97a8610>]}
[0m18:52:06.428092 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f5354b01-b7b3-4bc5-8cd9-fdf31314330e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72ccb97c4890>]}
[0m18:52:06.428627 [info ] [MainThread]: Registered adapter: duckdb=1.6.2
[0m18:52:06.429087 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found 3 package(s) specified in packages.yml, but only 0 package(s) installed in dbt_packages. Run "dbt deps" to install package dependencies.
[0m18:52:06.429409 [debug] [MainThread]: Command `dbt run-operation` failed at 18:52:06.429327 after 0.08 seconds
[0m18:52:06.429618 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72ccb996f090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72ccb97d8c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72ccbdf4f490>]}
[0m18:52:06.429807 [debug] [MainThread]: Flushing usage events
[0m18:52:15.617398 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a6bc72b6ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a6bc7492d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a6bc8002510>]}


============================== 18:52:15.621063 | c663f173-4a3e-4d5f-89f6-cab108857431 ==============================
[0m18:52:15.621063 [info ] [MainThread]: Running with dbt=1.6.18
[0m18:52:15.621500 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/workspaces/varengold_data_analyst_case/transformation', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/workspaces/varengold_data_analyst_case/transformation/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt deps', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m18:52:15.642314 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c663f173-4a3e-4d5f-89f6-cab108857431', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a6bc75e7990>]}
[0m18:52:15.649640 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-71nztet0'
[0m18:52:15.650055 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m18:52:15.823766 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m18:52:15.824773 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/codegen.json
[0m18:52:15.959547 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/codegen.json 200
[0m18:52:15.962783 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m18:52:16.137204 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m18:52:16.143710 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/godatadriven/dbt_date.json
[0m18:52:16.295233 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/godatadriven/dbt_date.json 200
[0m18:52:16.303416 [info ] [MainThread]: Installing dbt-labs/codegen
[0m18:52:16.601431 [info ] [MainThread]: Installed from version 0.13.1
[0m18:52:16.601691 [info ] [MainThread]: Up to date!
[0m18:52:16.601888 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'c663f173-4a3e-4d5f-89f6-cab108857431', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a6bc75e4650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a6bc7608dd0>]}
[0m18:52:16.602090 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m18:52:16.983586 [info ] [MainThread]: Installed from version 1.3.0
[0m18:52:16.983891 [info ] [MainThread]: Up to date!
[0m18:52:16.984122 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'c663f173-4a3e-4d5f-89f6-cab108857431', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a6bc75e4650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a6bc7001ed0>]}
[0m18:52:16.984365 [info ] [MainThread]: Installing godatadriven/dbt_date
[0m18:52:17.709923 [info ] [MainThread]: Installed from version 0.11.0
[0m18:52:17.710384 [info ] [MainThread]: Updated version available: 0.14.1
[0m18:52:17.710679 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'c663f173-4a3e-4d5f-89f6-cab108857431', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a6bc72b4b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a6bc7677e10>]}
[0m18:52:17.710984 [info ] [MainThread]: 
[0m18:52:17.711217 [info ] [MainThread]: Updates available for packages: ['godatadriven/dbt_date']                 
Update your versions in packages.yml, then run dbt deps
[0m18:52:17.711844 [debug] [MainThread]: Command `dbt deps` succeeded at 18:52:17.711730 after 2.10 seconds
[0m18:52:17.712077 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a6bc72d4090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a6bc7675510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a6bc770bb10>]}
[0m18:52:17.712270 [debug] [MainThread]: Flushing usage events
[0m18:52:23.851101 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x765de2d0fc10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x765de2cb8ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x765de2d16650>]}


============================== 18:52:23.854154 | 2d606c17-1fe9-458d-9d84-4ef8f8b9e6ac ==============================
[0m18:52:23.854154 [info ] [MainThread]: Running with dbt=1.6.18
[0m18:52:23.854742 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/workspaces/varengold_data_analyst_case/transformation', 'log_path': '/workspaces/varengold_data_analyst_case/transformation/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run-operation explore_schemas', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:52:23.914068 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2d606c17-1fe9-458d-9d84-4ef8f8b9e6ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x765ddf30d190>]}
[0m18:52:23.922027 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2d606c17-1fe9-458d-9d84-4ef8f8b9e6ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x765de2e6eed0>]}
[0m18:52:23.922486 [info ] [MainThread]: Registered adapter: duckdb=1.6.2
[0m18:52:23.942658 [debug] [MainThread]: checksum: 7b9fab86a08e9e96a48a825af743c566d95b877e068b8c6d0dbafbf714447189, vars: {}, profile: , target: , version: 1.6.18
[0m18:52:23.943127 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m18:52:23.943349 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '2d606c17-1fe9-458d-9d84-4ef8f8b9e6ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x765de2fc7f10>]}
[0m18:52:24.850098 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.vg_casestudy.main
- models.vg_casestudy.reporting
- models.vg_casestudy.marts
[0m18:52:24.855354 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2d606c17-1fe9-458d-9d84-4ef8f8b9e6ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x765de2a32ed0>]}
[0m18:52:24.875330 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2d606c17-1fe9-458d-9d84-4ef8f8b9e6ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x765dd7a1fe50>]}
[0m18:52:24.875700 [info ] [MainThread]: Found 11 models, 1 analysis, 2 seeds, 71 tests, 5 sources, 0 exposures, 0 metrics, 632 macros, 0 groups, 0 semantic models
[0m18:52:24.875918 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2d606c17-1fe9-458d-9d84-4ef8f8b9e6ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x765de2cb8810>]}
[0m18:52:24.876386 [debug] [MainThread]: Acquiring new duckdb connection 'macro_explore_schemas'
[0m18:52:24.876573 [debug] [MainThread]: Using duckdb connection "macro_explore_schemas"
[0m18:52:24.876730 [debug] [MainThread]: On macro_explore_schemas: BEGIN
[0m18:52:24.876886 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:52:27.905884 [debug] [MainThread]: SQL status: OK in 3.0 seconds
[0m18:52:27.906214 [debug] [MainThread]: On macro_explore_schemas: COMMIT
[0m18:52:27.906396 [debug] [MainThread]: Using duckdb connection "macro_explore_schemas"
[0m18:52:27.906555 [debug] [MainThread]: On macro_explore_schemas: COMMIT
[0m18:52:27.906943 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m18:52:27.913046 [debug] [MainThread]: Using duckdb connection "macro_explore_schemas"
[0m18:52:27.913278 [debug] [MainThread]: On macro_explore_schemas: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "macro_explore_schemas"} */

    
        SELECT schema_name FROM information_schema.schemata
    
  
[0m18:52:27.914572 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m18:52:27.915410 [debug] [MainThread]: On macro_explore_schemas: Close
[0m18:52:27.917609 [debug] [MainThread]: Command `dbt run-operation` succeeded at 18:52:27.917532 after 4.07 seconds
[0m18:52:27.917792 [debug] [MainThread]: Connection 'macro_explore_schemas' was properly closed.
[0m18:52:27.917970 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x765de2e6cf50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x765de2c69ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x765ddf327250>]}
[0m18:52:27.918188 [debug] [MainThread]: Flushing usage events
[0m18:53:26.187163 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b1d5bb88650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b1d5b8b72d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b1d5bb989d0>]}


============================== 18:53:26.190083 | 26ed4d6c-702e-48e7-83cc-bce0d51bf469 ==============================
[0m18:53:26.190083 [info ] [MainThread]: Running with dbt=1.6.18
[0m18:53:26.190682 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/workspaces/varengold_data_analyst_case/transformation', 'debug': 'False', 'version_check': 'True', 'log_path': '/workspaces/varengold_data_analyst_case/transformation/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': "dbt run-operation explore_tables --args {'schema_name' : 'raw'}", 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:53:26.251440 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '26ed4d6c-702e-48e7-83cc-bce0d51bf469', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b1d5b5c5650>]}
[0m18:53:26.259247 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '26ed4d6c-702e-48e7-83cc-bce0d51bf469', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b1d5b59a010>]}
[0m18:53:26.259702 [info ] [MainThread]: Registered adapter: duckdb=1.6.2
[0m18:53:26.272305 [debug] [MainThread]: checksum: 7b9fab86a08e9e96a48a825af743c566d95b877e068b8c6d0dbafbf714447189, vars: {}, profile: , target: , version: 1.6.18
[0m18:53:26.294126 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:53:26.294421 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:53:26.295207 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.vg_casestudy.main
- models.vg_casestudy.reporting
- models.vg_casestudy.marts
[0m18:53:26.299437 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '26ed4d6c-702e-48e7-83cc-bce0d51bf469', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b1d5b8b4b90>]}
[0m18:53:26.314631 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '26ed4d6c-702e-48e7-83cc-bce0d51bf469', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b1d57ec7010>]}
[0m18:53:26.314988 [info ] [MainThread]: Found 11 models, 1 analysis, 2 seeds, 71 tests, 5 sources, 0 exposures, 0 metrics, 632 macros, 0 groups, 0 semantic models
[0m18:53:26.315185 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '26ed4d6c-702e-48e7-83cc-bce0d51bf469', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b1d5b5e5790>]}
[0m18:53:26.315632 [debug] [MainThread]: Acquiring new duckdb connection 'macro_explore_tables'
[0m18:53:26.315817 [debug] [MainThread]: Using duckdb connection "macro_explore_tables"
[0m18:53:26.315981 [debug] [MainThread]: On macro_explore_tables: BEGIN
[0m18:53:26.316119 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:53:26.325444 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m18:53:26.325742 [debug] [MainThread]: On macro_explore_tables: COMMIT
[0m18:53:26.325913 [debug] [MainThread]: Using duckdb connection "macro_explore_tables"
[0m18:53:26.326072 [debug] [MainThread]: On macro_explore_tables: COMMIT
[0m18:53:26.326410 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m18:53:26.332538 [debug] [MainThread]: Using duckdb connection "macro_explore_tables"
[0m18:53:26.332776 [debug] [MainThread]: On macro_explore_tables: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "macro_explore_tables"} */

    
        SELECT table_name 
        FROM information_schema.tables 
        WHERE table_schema = 'raw'
    
  
[0m18:53:26.339938 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m18:53:26.340801 [debug] [MainThread]: On macro_explore_tables: Close
[0m18:53:26.343896 [debug] [MainThread]: Command `dbt run-operation` succeeded at 18:53:26.343802 after 0.16 seconds
[0m18:53:26.344141 [debug] [MainThread]: Connection 'macro_explore_tables' was properly closed.
[0m18:53:26.344364 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b1d57ecd5d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b1d5bb67d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b1d5b8b6f90>]}
[0m18:53:26.344599 [debug] [MainThread]: Flushing usage events
[0m02:27:08.041012 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x717358bc7610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x717358bb6d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x717358d18210>]}


============================== 02:27:08.045130 | d4135266-a19c-465d-ae63-59b65a852018 ==============================
[0m02:27:08.045130 [info ] [MainThread]: Running with dbt=1.6.18
[0m02:27:08.045442 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/workspaces/varengold_data_analyst_case/transformation/logs', 'version_check': 'True', 'profiles_dir': '/workspaces/varengold_data_analyst_case/transformation', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt deps', 'send_anonymous_usage_stats': 'True'}
[0m02:27:08.067870 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd4135266-a19c-465d-ae63-59b65a852018', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71735875d890>]}
[0m02:27:08.068495 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-91g19c8v'
[0m02:27:08.068837 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m02:27:08.253751 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m02:27:08.254993 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/codegen.json
[0m02:27:08.406604 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/codegen.json 200
[0m02:27:08.409110 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m02:27:08.574758 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m02:27:08.578811 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/godatadriven/dbt_date.json
[0m02:27:08.739389 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/godatadriven/dbt_date.json 200
[0m02:27:08.749471 [info ] [MainThread]: Installing dbt-labs/codegen
[0m02:27:09.073166 [info ] [MainThread]: Installed from version 0.13.1
[0m02:27:09.073426 [info ] [MainThread]: Up to date!
[0m02:27:09.073617 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'd4135266-a19c-465d-ae63-59b65a852018', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x717358d09fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7173589ec950>]}
[0m02:27:09.073811 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m02:27:09.422227 [info ] [MainThread]: Installed from version 1.3.0
[0m02:27:09.422499 [info ] [MainThread]: Up to date!
[0m02:27:09.422702 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'd4135266-a19c-465d-ae63-59b65a852018', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7173589d8550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x717358d09fd0>]}
[0m02:27:09.422915 [info ] [MainThread]: Installing godatadriven/dbt_date
[0m02:27:09.805247 [info ] [MainThread]: Installed from version 0.11.0
[0m02:27:09.805530 [info ] [MainThread]: Updated version available: 0.14.1
[0m02:27:09.805745 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'd4135266-a19c-465d-ae63-59b65a852018', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71735873b190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x717358722c10>]}
[0m02:27:09.805963 [info ] [MainThread]: 
[0m02:27:09.806147 [info ] [MainThread]: Updates available for packages: ['godatadriven/dbt_date']                 
Update your versions in packages.yml, then run dbt deps
[0m02:27:09.806596 [debug] [MainThread]: Command `dbt deps` succeeded at 02:27:09.806503 after 1.77 seconds
[0m02:27:09.806815 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71735d278e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71735d304bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71735d305d90>]}
[0m02:27:09.807002 [debug] [MainThread]: Flushing usage events
[0m02:27:14.933237 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7185c65e2890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7185c65cc550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7185c6463310>]}


============================== 02:27:14.936286 | 0b0329fb-cf28-4293-b1b2-c45dbb3ba5b0 ==============================
[0m02:27:14.936286 [info ] [MainThread]: Running with dbt=1.6.18
[0m02:27:14.936685 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/workspaces/varengold_data_analyst_case/transformation', 'debug': 'False', 'version_check': 'True', 'log_path': '/workspaces/varengold_data_analyst_case/transformation/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m02:27:14.992584 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0b0329fb-cf28-4293-b1b2-c45dbb3ba5b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7185c62b24d0>]}
[0m02:27:15.000546 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0b0329fb-cf28-4293-b1b2-c45dbb3ba5b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7185c65dbd90>]}
[0m02:27:15.001089 [info ] [MainThread]: Registered adapter: duckdb=1.6.2
[0m02:27:15.014964 [debug] [MainThread]: checksum: 7b9fab86a08e9e96a48a825af743c566d95b877e068b8c6d0dbafbf714447189, vars: {}, profile: , target: , version: 1.6.18
[0m02:27:15.027368 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m02:27:15.027712 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '0b0329fb-cf28-4293-b1b2-c45dbb3ba5b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7185c2908310>]}
[0m02:27:15.936691 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.vg_casestudy.main
- models.vg_casestudy.reporting
- models.vg_casestudy.marts
[0m02:27:15.940370 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0b0329fb-cf28-4293-b1b2-c45dbb3ba5b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7185c1e31c50>]}
[0m02:27:15.953459 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0b0329fb-cf28-4293-b1b2-c45dbb3ba5b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7185bb1e7e90>]}
[0m02:27:15.953808 [info ] [MainThread]: Found 11 models, 1 analysis, 2 seeds, 71 tests, 5 sources, 0 exposures, 0 metrics, 632 macros, 0 groups, 0 semantic models
[0m02:27:15.954012 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0b0329fb-cf28-4293-b1b2-c45dbb3ba5b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7185bb1a8d90>]}
[0m02:27:15.955909 [info ] [MainThread]: 
[0m02:27:15.956381 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m02:27:15.958002 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_casestudy'
[0m02:27:15.968384 [debug] [ThreadPool]: Using duckdb connection "list_casestudy"
[0m02:27:15.968611 [debug] [ThreadPool]: On list_casestudy: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"casestudy"'
    
  
  
[0m02:27:15.968782 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:27:20.478374 [debug] [ThreadPool]: SQL status: OK in 5.0 seconds
[0m02:27:20.479364 [debug] [ThreadPool]: On list_casestudy: Close
[0m02:27:20.484855 [debug] [ThreadPool]: Using duckdb connection "list_casestudy"
[0m02:27:20.485150 [debug] [ThreadPool]: On list_casestudy: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"casestudy"'
    
  
  
[0m02:27:20.485322 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:27:20.492625 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m02:27:20.493344 [debug] [ThreadPool]: On list_casestudy: Close
[0m02:27:20.494779 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy, now create_casestudy_staging)
[0m02:27:20.495189 [debug] [ThreadPool]: Creating schema "database: "casestudy"
schema: "staging"
"
[0m02:27:20.497714 [debug] [ThreadPool]: Using duckdb connection "create_casestudy_staging"
[0m02:27:20.497908 [debug] [ThreadPool]: On create_casestudy_staging: BEGIN
[0m02:27:20.498062 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:27:20.504335 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m02:27:20.504527 [debug] [ThreadPool]: Using duckdb connection "create_casestudy_staging"
[0m02:27:20.504694 [debug] [ThreadPool]: On create_casestudy_staging: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "create_casestudy_staging"} */
create schema if not exists "casestudy"."staging"
[0m02:27:20.504959 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m02:27:20.505452 [debug] [ThreadPool]: On create_casestudy_staging: COMMIT
[0m02:27:20.505623 [debug] [ThreadPool]: Using duckdb connection "create_casestudy_staging"
[0m02:27:20.505780 [debug] [ThreadPool]: On create_casestudy_staging: COMMIT
[0m02:27:20.506017 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m02:27:20.506196 [debug] [ThreadPool]: On create_casestudy_staging: Close
[0m02:27:20.507663 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_casestudy_staging, now create_casestudy_intermediate)
[0m02:27:20.508040 [debug] [ThreadPool]: Creating schema "database: "casestudy"
schema: "intermediate"
"
[0m02:27:20.509184 [debug] [ThreadPool]: Using duckdb connection "create_casestudy_intermediate"
[0m02:27:20.509418 [debug] [ThreadPool]: On create_casestudy_intermediate: BEGIN
[0m02:27:20.509571 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:27:20.515771 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m02:27:20.515962 [debug] [ThreadPool]: Using duckdb connection "create_casestudy_intermediate"
[0m02:27:20.516133 [debug] [ThreadPool]: On create_casestudy_intermediate: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "create_casestudy_intermediate"} */
create schema if not exists "casestudy"."intermediate"
[0m02:27:20.516412 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m02:27:20.516859 [debug] [ThreadPool]: On create_casestudy_intermediate: COMMIT
[0m02:27:20.517032 [debug] [ThreadPool]: Using duckdb connection "create_casestudy_intermediate"
[0m02:27:20.517195 [debug] [ThreadPool]: On create_casestudy_intermediate: COMMIT
[0m02:27:20.517438 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m02:27:20.517607 [debug] [ThreadPool]: On create_casestudy_intermediate: Close
[0m02:27:20.519969 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_casestudy_intermediate, now list_casestudy_staging)
[0m02:27:20.525942 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_staging"
[0m02:27:20.526303 [debug] [ThreadPool]: On list_casestudy_staging: BEGIN
[0m02:27:20.526583 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:27:20.536110 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m02:27:20.536311 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_staging"
[0m02:27:20.536484 [debug] [ThreadPool]: On list_casestudy_staging: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_staging"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'staging'
    and table_catalog = 'casestudy'
  
[0m02:27:20.543182 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m02:27:20.543980 [debug] [ThreadPool]: On list_casestudy_staging: ROLLBACK
[0m02:27:20.544472 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_staging'
[0m02:27:20.544646 [debug] [ThreadPool]: On list_casestudy_staging: Close
[0m02:27:20.546059 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy_staging, now list_casestudy_intermediate)
[0m02:27:20.547712 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_intermediate"
[0m02:27:20.547893 [debug] [ThreadPool]: On list_casestudy_intermediate: BEGIN
[0m02:27:20.548046 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:27:20.554311 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m02:27:20.554503 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_intermediate"
[0m02:27:20.554678 [debug] [ThreadPool]: On list_casestudy_intermediate: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_intermediate"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'intermediate'
    and table_catalog = 'casestudy'
  
[0m02:27:20.561570 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m02:27:20.562480 [debug] [ThreadPool]: On list_casestudy_intermediate: ROLLBACK
[0m02:27:20.562776 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_intermediate'
[0m02:27:20.562941 [debug] [ThreadPool]: On list_casestudy_intermediate: Close
[0m02:27:20.564562 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy_intermediate, now list_casestudy_raw)
[0m02:27:20.566812 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_raw"
[0m02:27:20.566987 [debug] [ThreadPool]: On list_casestudy_raw: BEGIN
[0m02:27:20.567132 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:27:20.573717 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m02:27:20.573900 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_raw"
[0m02:27:20.574054 [debug] [ThreadPool]: On list_casestudy_raw: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_raw"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'raw'
    and table_catalog = 'casestudy'
  
[0m02:27:20.580469 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m02:27:20.581176 [debug] [ThreadPool]: On list_casestudy_raw: ROLLBACK
[0m02:27:20.581442 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_raw'
[0m02:27:20.581595 [debug] [ThreadPool]: On list_casestudy_raw: Close
[0m02:27:20.583969 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0b0329fb-cf28-4293-b1b2-c45dbb3ba5b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7185c1dab0d0>]}
[0m02:27:20.584531 [debug] [MainThread]: Using duckdb connection "master"
[0m02:27:20.584884 [debug] [MainThread]: On master: BEGIN
[0m02:27:20.585221 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:27:20.592872 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m02:27:20.593063 [debug] [MainThread]: On master: COMMIT
[0m02:27:20.593233 [debug] [MainThread]: Using duckdb connection "master"
[0m02:27:20.593380 [debug] [MainThread]: On master: COMMIT
[0m02:27:20.593621 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m02:27:20.593787 [debug] [MainThread]: On master: Close
[0m02:27:20.595034 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:27:20.595253 [info ] [MainThread]: 
[0m02:27:20.606495 [debug] [Thread-1 (]: Began running node model.vg_casestudy.stg_raw_staging__accounts
[0m02:27:20.607257 [info ] [Thread-1 (]: 1 of 11 START sql view model staging.stg_raw_staging__accounts ................. [RUN]
[0m02:27:20.608139 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.vg_casestudy.stg_raw_staging__accounts'
[0m02:27:20.608437 [debug] [Thread-1 (]: Began compiling node model.vg_casestudy.stg_raw_staging__accounts
[0m02:27:20.613678 [debug] [Thread-1 (]: Writing injected SQL for node "model.vg_casestudy.stg_raw_staging__accounts"
[0m02:27:20.614257 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.stg_raw_staging__accounts (compile): 02:27:20.608578 => 02:27:20.614090
[0m02:27:20.614487 [debug] [Thread-1 (]: Began executing node model.vg_casestudy.stg_raw_staging__accounts
[0m02:27:20.633739 [debug] [Thread-1 (]: Writing runtime sql for node "model.vg_casestudy.stg_raw_staging__accounts"
[0m02:27:20.634264 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_raw_staging__accounts"
[0m02:27:20.634463 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__accounts: BEGIN
[0m02:27:20.634638 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m02:27:20.644326 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:27:20.644577 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_raw_staging__accounts"
[0m02:27:20.644813 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__accounts: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_raw_staging__accounts"} */

  
  create view "casestudy"."staging"."stg_raw_staging__accounts__dbt_tmp" as (
    with source as (
    select * from "casestudy"."raw"."accounts"
),

renamed as (
    select
        account_id,
        customer_id,
        account_type,
        
CASE
    -- First try DD.MM.YYYY format (German format with dots)
    WHEN REGEXP_MATCHES(account_opening_date, '^\d{1,2}\.\d{1,2}\.\d{4}$') 
        THEN TRY_CAST(STRPTIME(account_opening_date, '%d.%m.%Y') AS DATE)
        
    -- Then try DD/MM/YYYY format (with slashes)
    WHEN REGEXP_MATCHES(account_opening_date, '^\d{1,2}/\d{1,2}/\d{4}$')
        AND CAST(SPLIT_PART(account_opening_date, '/', 1) AS INTEGER) <= 31 
        AND CAST(SPLIT_PART(account_opening_date, '/', 2) AS INTEGER) <= 12 
        THEN TRY_CAST(STRPTIME(account_opening_date, '%d/%m/%Y') AS DATE)
        
    -- Try MM/DD/YYYY format (US format with slashes)
    WHEN REGEXP_MATCHES(account_opening_date, '^\d{1,2}/\d{1,2}/\d{4}$')
        AND CAST(SPLIT_PART(account_opening_date, '/', 1) AS INTEGER) <= 12 
        THEN TRY_CAST(STRPTIME(account_opening_date, '%m/%d/%Y') AS DATE)
        
    -- Try YYYY-MM-DD format (ISO format)
    WHEN REGEXP_MATCHES(account_opening_date, '^\d{4}-\d{1,2}-\d{1,2}$')
        THEN TRY_CAST(STRPTIME(account_opening_date, '%Y-%m-%d') AS DATE)
        
    -- Try generic date parsing as last resort
    ELSE TRY_CAST(account_opening_date AS DATE)
END
 as account_opening_date,
        account_opening_date as account_opening_date_raw
    from source
    where account_type is not null and account_type != '' and account_type != '-'
),

final as (
    select
        account_id,
        customer_id,
        account_type,
        account_opening_date,
        -- Flag records with date parsing issues
        CASE WHEN account_opening_date IS NULL AND account_opening_date_raw IS NOT NULL
             THEN TRUE ELSE FALSE 
        END as has_date_parsing_error
    from renamed
)

select * from final
  );

[0m02:27:20.645843 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:27:20.649463 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_raw_staging__accounts"
[0m02:27:20.649687 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__accounts: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_raw_staging__accounts"} */
alter view "casestudy"."staging"."stg_raw_staging__accounts" rename to "stg_raw_staging__accounts__dbt_backup"
[0m02:27:20.650052 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:27:20.651552 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_raw_staging__accounts"
[0m02:27:20.651767 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__accounts: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_raw_staging__accounts"} */
alter view "casestudy"."staging"."stg_raw_staging__accounts__dbt_tmp" rename to "stg_raw_staging__accounts"
[0m02:27:20.652102 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:27:20.661033 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__accounts: COMMIT
[0m02:27:20.661248 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_raw_staging__accounts"
[0m02:27:20.661425 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__accounts: COMMIT
[0m02:27:20.662742 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:27:20.665360 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_raw_staging__accounts"
[0m02:27:20.665560 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__accounts: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_raw_staging__accounts"} */
drop view if exists "casestudy"."staging"."stg_raw_staging__accounts__dbt_backup" cascade
[0m02:27:20.666418 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:27:20.667190 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.stg_raw_staging__accounts (execute): 02:27:20.614622 => 02:27:20.667053
[0m02:27:20.667415 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__accounts: Close
[0m02:27:20.678400 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b0329fb-cf28-4293-b1b2-c45dbb3ba5b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7185c1d85dd0>]}
[0m02:27:20.679048 [info ] [Thread-1 (]: 1 of 11 OK created sql view model staging.stg_raw_staging__accounts ............ [[32mOK[0m in 0.07s]
[0m02:27:20.679494 [debug] [Thread-1 (]: Finished running node model.vg_casestudy.stg_raw_staging__accounts
[0m02:27:20.679798 [debug] [Thread-1 (]: Began running node model.vg_casestudy.stg_raw_staging__customers
[0m02:27:20.680340 [info ] [Thread-1 (]: 2 of 11 START sql view model staging.stg_raw_staging__customers ................ [RUN]
[0m02:27:20.680793 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.vg_casestudy.stg_raw_staging__accounts, now model.vg_casestudy.stg_raw_staging__customers)
[0m02:27:20.680989 [debug] [Thread-1 (]: Began compiling node model.vg_casestudy.stg_raw_staging__customers
[0m02:27:20.682745 [debug] [Thread-1 (]: Writing injected SQL for node "model.vg_casestudy.stg_raw_staging__customers"
[0m02:27:20.683088 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.stg_raw_staging__customers (compile): 02:27:20.681111 => 02:27:20.682978
[0m02:27:20.683285 [debug] [Thread-1 (]: Began executing node model.vg_casestudy.stg_raw_staging__customers
[0m02:27:20.685541 [debug] [Thread-1 (]: Writing runtime sql for node "model.vg_casestudy.stg_raw_staging__customers"
[0m02:27:20.685877 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_raw_staging__customers"
[0m02:27:20.686066 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__customers: BEGIN
[0m02:27:20.686241 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:27:20.695978 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:27:20.696258 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_raw_staging__customers"
[0m02:27:20.696459 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__customers: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_raw_staging__customers"} */

  
  create view "casestudy"."staging"."stg_raw_staging__customers__dbt_tmp" as (
    with source as (
    select * from "casestudy"."raw"."customers"
),

renamed as (
    select distinct
        customer_id,
        trim(firstname) as firstname,
        trim(lastname) as lastname,
        Age as age,
        branch_id
    from source
)

select * from renamed
  );

[0m02:27:20.697030 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:27:20.699086 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_raw_staging__customers"
[0m02:27:20.699333 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__customers: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_raw_staging__customers"} */
alter view "casestudy"."staging"."stg_raw_staging__customers" rename to "stg_raw_staging__customers__dbt_backup"
[0m02:27:20.699727 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:27:20.701548 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_raw_staging__customers"
[0m02:27:20.701767 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__customers: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_raw_staging__customers"} */
alter view "casestudy"."staging"."stg_raw_staging__customers__dbt_tmp" rename to "stg_raw_staging__customers"
[0m02:27:20.702128 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:27:20.703101 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__customers: COMMIT
[0m02:27:20.703321 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_raw_staging__customers"
[0m02:27:20.703499 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__customers: COMMIT
[0m02:27:20.705706 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:27:20.708295 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_raw_staging__customers"
[0m02:27:20.708525 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__customers: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_raw_staging__customers"} */
drop view if exists "casestudy"."staging"."stg_raw_staging__customers__dbt_backup" cascade
[0m02:27:20.709537 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:27:20.710464 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.stg_raw_staging__customers (execute): 02:27:20.683411 => 02:27:20.710360
[0m02:27:20.710675 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__customers: Close
[0m02:27:20.723084 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b0329fb-cf28-4293-b1b2-c45dbb3ba5b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7185baf2b8d0>]}
[0m02:27:20.723841 [info ] [Thread-1 (]: 2 of 11 OK created sql view model staging.stg_raw_staging__customers ........... [[32mOK[0m in 0.04s]
[0m02:27:20.724541 [debug] [Thread-1 (]: Finished running node model.vg_casestudy.stg_raw_staging__customers
[0m02:27:20.725031 [debug] [Thread-1 (]: Began running node model.vg_casestudy.stg_raw_staging__fx_rates
[0m02:27:20.725777 [info ] [Thread-1 (]: 3 of 11 START sql view model staging.stg_raw_staging__fx_rates ................. [RUN]
[0m02:27:20.726634 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.vg_casestudy.stg_raw_staging__customers, now model.vg_casestudy.stg_raw_staging__fx_rates)
[0m02:27:20.726833 [debug] [Thread-1 (]: Began compiling node model.vg_casestudy.stg_raw_staging__fx_rates
[0m02:27:20.728962 [debug] [Thread-1 (]: Writing injected SQL for node "model.vg_casestudy.stg_raw_staging__fx_rates"
[0m02:27:20.729325 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.stg_raw_staging__fx_rates (compile): 02:27:20.726953 => 02:27:20.729210
[0m02:27:20.729512 [debug] [Thread-1 (]: Began executing node model.vg_casestudy.stg_raw_staging__fx_rates
[0m02:27:20.731701 [debug] [Thread-1 (]: Writing runtime sql for node "model.vg_casestudy.stg_raw_staging__fx_rates"
[0m02:27:20.732009 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_raw_staging__fx_rates"
[0m02:27:20.732212 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__fx_rates: BEGIN
[0m02:27:20.732384 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:27:20.739788 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:27:20.740079 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_raw_staging__fx_rates"
[0m02:27:20.740348 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__fx_rates: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_raw_staging__fx_rates"} */

  
  create view "casestudy"."staging"."stg_raw_staging__fx_rates__dbt_tmp" as (
    with source as (
    select * from "casestudy"."raw"."fx_rates"
),

renamed as (
    select
        trim(currency_iso_code) as currency_iso_code,
        
CASE
    WHEN fx_rate IS NULL THEN NULL
    -- If the value is already a valid number
    WHEN TRY_CAST(fx_rate AS DOUBLE) IS NOT NULL 
        THEN TRY_CAST(fx_rate AS DOUBLE)
    -- If contains both dot and comma (German notation)
    WHEN POSITION('.' IN fx_rate) > 0 AND POSITION(',' IN fx_rate) > 0 
        THEN TRY_CAST(REPLACE(REPLACE(TRIM(fx_rate), '.', ''), ',', '.') AS DOUBLE)
    -- If only contains comma, treat as decimal point
    WHEN POSITION(',' IN fx_rate) > 0 
        THEN TRY_CAST(REPLACE(TRIM(fx_rate), ',', '.') AS DOUBLE)
    -- If only contains dots, likely thousands separator
    WHEN POSITION('.' IN fx_rate) > 0 
        THEN TRY_CAST(REPLACE(TRIM(fx_rate), '.', '') AS DOUBLE)
    ELSE NULL
END
 as fx_rate,
        
CASE
    -- First try DD.MM.YYYY format (German format with dots)
    WHEN REGEXP_MATCHES(date, '^\d{1,2}\.\d{1,2}\.\d{4}$') 
        THEN TRY_CAST(STRPTIME(date, '%d.%m.%Y') AS DATE)
        
    -- Then try DD/MM/YYYY format (with slashes)
    WHEN REGEXP_MATCHES(date, '^\d{1,2}/\d{1,2}/\d{4}$')
        AND CAST(SPLIT_PART(date, '/', 1) AS INTEGER) <= 31 
        AND CAST(SPLIT_PART(date, '/', 2) AS INTEGER) <= 12 
        THEN TRY_CAST(STRPTIME(date, '%d/%m/%Y') AS DATE)
        
    -- Try MM/DD/YYYY format (US format with slashes)
    WHEN REGEXP_MATCHES(date, '^\d{1,2}/\d{1,2}/\d{4}$')
        AND CAST(SPLIT_PART(date, '/', 1) AS INTEGER) <= 12 
        THEN TRY_CAST(STRPTIME(date, '%m/%d/%Y') AS DATE)
        
    -- Try YYYY-MM-DD format (ISO format)
    WHEN REGEXP_MATCHES(date, '^\d{4}-\d{1,2}-\d{1,2}$')
        THEN TRY_CAST(STRPTIME(date, '%Y-%m-%d') AS DATE)
        
    -- Try generic date parsing as last resort
    ELSE TRY_CAST(date AS DATE)
END
 as fx_rate_date,
        date as fx_rate_date_raw
    from source
    where currency_iso_code is not null and trim(currency_iso_code) not in  ('(none)', '')
),

final as (
    select
        currency_iso_code,
        fx_rate,
        fx_rate_date,
        -- Flag records with date parsing issues
        CASE WHEN fx_rate_date IS NULL AND fx_rate_date_raw IS NOT NULL
             THEN TRUE ELSE FALSE 
        END as has_date_parsing_error
    from renamed
)

select * from final
  );

[0m02:27:20.741543 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:27:20.744164 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_raw_staging__fx_rates"
[0m02:27:20.744382 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__fx_rates: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_raw_staging__fx_rates"} */
alter view "casestudy"."staging"."stg_raw_staging__fx_rates" rename to "stg_raw_staging__fx_rates__dbt_backup"
[0m02:27:20.744768 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:27:20.746405 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_raw_staging__fx_rates"
[0m02:27:20.746615 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__fx_rates: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_raw_staging__fx_rates"} */
alter view "casestudy"."staging"."stg_raw_staging__fx_rates__dbt_tmp" rename to "stg_raw_staging__fx_rates"
[0m02:27:20.746968 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:27:20.747882 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__fx_rates: COMMIT
[0m02:27:20.748086 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_raw_staging__fx_rates"
[0m02:27:20.748270 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__fx_rates: COMMIT
[0m02:27:20.749617 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:27:20.751021 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_raw_staging__fx_rates"
[0m02:27:20.751234 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__fx_rates: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_raw_staging__fx_rates"} */
drop view if exists "casestudy"."staging"."stg_raw_staging__fx_rates__dbt_backup" cascade
[0m02:27:20.752255 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:27:20.753026 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.stg_raw_staging__fx_rates (execute): 02:27:20.729638 => 02:27:20.752919
[0m02:27:20.753239 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__fx_rates: Close
[0m02:27:20.764105 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b0329fb-cf28-4293-b1b2-c45dbb3ba5b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7185bb192150>]}
[0m02:27:20.764472 [info ] [Thread-1 (]: 3 of 11 OK created sql view model staging.stg_raw_staging__fx_rates ............ [[32mOK[0m in 0.04s]
[0m02:27:20.764765 [debug] [Thread-1 (]: Finished running node model.vg_casestudy.stg_raw_staging__fx_rates
[0m02:27:20.764985 [debug] [Thread-1 (]: Began running node model.vg_casestudy.stg_raw_staging__loans
[0m02:27:20.765209 [info ] [Thread-1 (]: 4 of 11 START sql view model staging.stg_raw_staging__loans .................... [RUN]
[0m02:27:20.765723 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.vg_casestudy.stg_raw_staging__fx_rates, now model.vg_casestudy.stg_raw_staging__loans)
[0m02:27:20.765917 [debug] [Thread-1 (]: Began compiling node model.vg_casestudy.stg_raw_staging__loans
[0m02:27:20.767956 [debug] [Thread-1 (]: Writing injected SQL for node "model.vg_casestudy.stg_raw_staging__loans"
[0m02:27:20.768304 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.stg_raw_staging__loans (compile): 02:27:20.766028 => 02:27:20.768191
[0m02:27:20.768518 [debug] [Thread-1 (]: Began executing node model.vg_casestudy.stg_raw_staging__loans
[0m02:27:20.770721 [debug] [Thread-1 (]: Writing runtime sql for node "model.vg_casestudy.stg_raw_staging__loans"
[0m02:27:20.771009 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_raw_staging__loans"
[0m02:27:20.771196 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__loans: BEGIN
[0m02:27:20.771360 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:27:20.780935 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:27:20.781251 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_raw_staging__loans"
[0m02:27:20.781545 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__loans: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_raw_staging__loans"} */

  
  create view "casestudy"."staging"."stg_raw_staging__loans__dbt_tmp" as (
    with source as (
    select * from "casestudy"."raw"."loans"
),

renamed as (
    select
        customer_id,
        loan_id,
        
CASE
    WHEN loan_amount IS NULL THEN NULL
    -- If the value is already a valid number
    WHEN TRY_CAST(loan_amount AS DOUBLE) IS NOT NULL 
        THEN TRY_CAST(loan_amount AS DOUBLE)
    -- If contains both dot and comma (German notation)
    WHEN POSITION('.' IN loan_amount) > 0 AND POSITION(',' IN loan_amount) > 0 
        THEN TRY_CAST(REPLACE(REPLACE(TRIM(loan_amount), '.', ''), ',', '.') AS DOUBLE)
    -- If only contains comma, treat as decimal point
    WHEN POSITION(',' IN loan_amount) > 0 
        THEN TRY_CAST(REPLACE(TRIM(loan_amount), ',', '.') AS DOUBLE)
    -- If only contains dots, likely thousands separator
    WHEN POSITION('.' IN loan_amount) > 0 
        THEN TRY_CAST(REPLACE(TRIM(loan_amount), '.', '') AS DOUBLE)
    ELSE NULL
END
 as loan_amount,
        loant_type,
        
CASE
    WHEN interest_rate IS NULL THEN NULL
    -- If the value is already a valid number
    WHEN TRY_CAST(interest_rate AS DOUBLE) IS NOT NULL 
        THEN TRY_CAST(interest_rate AS DOUBLE)
    -- If contains both dot and comma (German notation)
    WHEN POSITION('.' IN interest_rate) > 0 AND POSITION(',' IN interest_rate) > 0 
        THEN TRY_CAST(REPLACE(REPLACE(TRIM(interest_rate), '.', ''), ',', '.') AS DOUBLE)
    -- If only contains comma, treat as decimal point
    WHEN POSITION(',' IN interest_rate) > 0 
        THEN TRY_CAST(REPLACE(TRIM(interest_rate), ',', '.') AS DOUBLE)
    -- If only contains dots, likely thousands separator
    WHEN POSITION('.' IN interest_rate) > 0 
        THEN TRY_CAST(REPLACE(TRIM(interest_rate), '.', '') AS DOUBLE)
    ELSE NULL
END
 as interest_rate,
        loan_term,
        
CASE
    -- First try DD.MM.YYYY format (German format with dots)
    WHEN REGEXP_MATCHES(approval_rejection_date, '^\d{1,2}\.\d{1,2}\.\d{4}$') 
        THEN TRY_CAST(STRPTIME(approval_rejection_date, '%d.%m.%Y') AS DATE)
        
    -- Then try DD/MM/YYYY format (with slashes)
    WHEN REGEXP_MATCHES(approval_rejection_date, '^\d{1,2}/\d{1,2}/\d{4}$')
        AND CAST(SPLIT_PART(approval_rejection_date, '/', 1) AS INTEGER) <= 31 
        AND CAST(SPLIT_PART(approval_rejection_date, '/', 2) AS INTEGER) <= 12 
        THEN TRY_CAST(STRPTIME(approval_rejection_date, '%d/%m/%Y') AS DATE)
        
    -- Try MM/DD/YYYY format (US format with slashes)
    WHEN REGEXP_MATCHES(approval_rejection_date, '^\d{1,2}/\d{1,2}/\d{4}$')
        AND CAST(SPLIT_PART(approval_rejection_date, '/', 1) AS INTEGER) <= 12 
        THEN TRY_CAST(STRPTIME(approval_rejection_date, '%m/%d/%Y') AS DATE)
        
    -- Try YYYY-MM-DD format (ISO format)
    WHEN REGEXP_MATCHES(approval_rejection_date, '^\d{4}-\d{1,2}-\d{1,2}$')
        THEN TRY_CAST(STRPTIME(approval_rejection_date, '%Y-%m-%d') AS DATE)
        
    -- Try generic date parsing as last resort
    ELSE TRY_CAST(approval_rejection_date AS DATE)
END
 as approval_rejection_date,
        approval_rejection_date as approval_rejection_date_raw,
        loan_status
    from source
),

final as (
    select
        customer_id,
        loan_id,
        loan_amount,
        loant_type as loan_type,
        interest_rate,
        loan_term,
        approval_rejection_date,
        loan_status,
        -- Flag records with date parsing issues
        CASE WHEN approval_rejection_date IS NULL AND approval_rejection_date_raw IS NOT NULL
             THEN TRUE ELSE FALSE 
        END as has_date_parsing_error
    from renamed
)

select * from final
  );

[0m02:27:20.783080 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:27:20.786451 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_raw_staging__loans"
[0m02:27:20.786709 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__loans: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_raw_staging__loans"} */
alter view "casestudy"."staging"."stg_raw_staging__loans" rename to "stg_raw_staging__loans__dbt_backup"
[0m02:27:20.787195 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:27:20.789993 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_raw_staging__loans"
[0m02:27:20.790226 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__loans: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_raw_staging__loans"} */
alter view "casestudy"."staging"."stg_raw_staging__loans__dbt_tmp" rename to "stg_raw_staging__loans"
[0m02:27:20.790603 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:27:20.791525 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__loans: COMMIT
[0m02:27:20.791730 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_raw_staging__loans"
[0m02:27:20.791910 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__loans: COMMIT
[0m02:27:20.793313 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:27:20.794571 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_raw_staging__loans"
[0m02:27:20.794780 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__loans: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_raw_staging__loans"} */
drop view if exists "casestudy"."staging"."stg_raw_staging__loans__dbt_backup" cascade
[0m02:27:20.795656 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:27:20.796382 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.stg_raw_staging__loans (execute): 02:27:20.768682 => 02:27:20.796284
[0m02:27:20.796575 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__loans: Close
[0m02:27:20.807139 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b0329fb-cf28-4293-b1b2-c45dbb3ba5b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7185baf51b10>]}
[0m02:27:20.807486 [info ] [Thread-1 (]: 4 of 11 OK created sql view model staging.stg_raw_staging__loans ............... [[32mOK[0m in 0.04s]
[0m02:27:20.807777 [debug] [Thread-1 (]: Finished running node model.vg_casestudy.stg_raw_staging__loans
[0m02:27:20.807985 [debug] [Thread-1 (]: Began running node model.vg_casestudy.stg_raw_staging__transactions
[0m02:27:20.808206 [info ] [Thread-1 (]: 5 of 11 START sql view model staging.stg_raw_staging__transactions ............. [RUN]
[0m02:27:20.808632 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.vg_casestudy.stg_raw_staging__loans, now model.vg_casestudy.stg_raw_staging__transactions)
[0m02:27:20.808899 [debug] [Thread-1 (]: Began compiling node model.vg_casestudy.stg_raw_staging__transactions
[0m02:27:20.810856 [debug] [Thread-1 (]: Writing injected SQL for node "model.vg_casestudy.stg_raw_staging__transactions"
[0m02:27:20.811180 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.stg_raw_staging__transactions (compile): 02:27:20.809020 => 02:27:20.811070
[0m02:27:20.811360 [debug] [Thread-1 (]: Began executing node model.vg_casestudy.stg_raw_staging__transactions
[0m02:27:20.813395 [debug] [Thread-1 (]: Writing runtime sql for node "model.vg_casestudy.stg_raw_staging__transactions"
[0m02:27:20.813669 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_raw_staging__transactions"
[0m02:27:20.813851 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__transactions: BEGIN
[0m02:27:20.814015 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:27:20.825772 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:27:20.826070 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_raw_staging__transactions"
[0m02:27:20.826318 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__transactions: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_raw_staging__transactions"} */

  
  create view "casestudy"."staging"."stg_raw_staging__transactions__dbt_tmp" as (
    with source as (
    select * from "casestudy"."raw"."transactions"
),

renamed as (
    select
        transaction_id,
        
CASE
    -- First try DD.MM.YYYY format (German format with dots)
    WHEN REGEXP_MATCHES(transaction_date, '^\d{1,2}\.\d{1,2}\.\d{4}$') 
        THEN TRY_CAST(STRPTIME(transaction_date, '%d.%m.%Y') AS DATE)
        
    -- Then try DD/MM/YYYY format (with slashes)
    WHEN REGEXP_MATCHES(transaction_date, '^\d{1,2}/\d{1,2}/\d{4}$')
        AND CAST(SPLIT_PART(transaction_date, '/', 1) AS INTEGER) <= 31 
        AND CAST(SPLIT_PART(transaction_date, '/', 2) AS INTEGER) <= 12 
        THEN TRY_CAST(STRPTIME(transaction_date, '%d/%m/%Y') AS DATE)
        
    -- Try MM/DD/YYYY format (US format with slashes)
    WHEN REGEXP_MATCHES(transaction_date, '^\d{1,2}/\d{1,2}/\d{4}$')
        AND CAST(SPLIT_PART(transaction_date, '/', 1) AS INTEGER) <= 12 
        THEN TRY_CAST(STRPTIME(transaction_date, '%m/%d/%Y') AS DATE)
        
    -- Try YYYY-MM-DD format (ISO format)
    WHEN REGEXP_MATCHES(transaction_date, '^\d{4}-\d{1,2}-\d{1,2}$')
        THEN TRY_CAST(STRPTIME(transaction_date, '%Y-%m-%d') AS DATE)
        
    -- Try generic date parsing as last resort
    ELSE TRY_CAST(transaction_date AS DATE)
END
 as transaction_date,
        transaction_date as transaction_date_raw,
        account_id,
        trim(transaction_type) as transaction_type,
        
CASE
    WHEN transaction_amount IS NULL THEN NULL
    -- If the value is already a valid number
    WHEN TRY_CAST(transaction_amount AS DOUBLE) IS NOT NULL 
        THEN TRY_CAST(transaction_amount AS DOUBLE)
    -- If contains both dot and comma (German notation)
    WHEN POSITION('.' IN transaction_amount) > 0 AND POSITION(',' IN transaction_amount) > 0 
        THEN TRY_CAST(REPLACE(REPLACE(TRIM(transaction_amount), '.', ''), ',', '.') AS DOUBLE)
    -- If only contains comma, treat as decimal point
    WHEN POSITION(',' IN transaction_amount) > 0 
        THEN TRY_CAST(REPLACE(TRIM(transaction_amount), ',', '.') AS DOUBLE)
    -- If only contains dots, likely thousands separator
    WHEN POSITION('.' IN transaction_amount) > 0 
        THEN TRY_CAST(REPLACE(TRIM(transaction_amount), '.', '') AS DOUBLE)
    ELSE NULL
END
 as transaction_amount,
        trim(transaction_currency) as transaction_currency
    from source
),

final as (
    select
        transaction_id,
        transaction_date,
        account_id,
        transaction_type,
        transaction_amount,
        transaction_currency,
        -- Flag records with date parsing issues
        CASE WHEN transaction_date IS NULL AND transaction_date_raw IS NOT NULL
             THEN TRUE ELSE FALSE 
        END as has_date_parsing_error
    from renamed
)

select * from final
  );

[0m02:27:20.827503 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:27:20.829382 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_raw_staging__transactions"
[0m02:27:20.829581 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__transactions: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_raw_staging__transactions"} */
alter view "casestudy"."staging"."stg_raw_staging__transactions" rename to "stg_raw_staging__transactions__dbt_backup"
[0m02:27:20.829936 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:27:20.831415 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_raw_staging__transactions"
[0m02:27:20.831612 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__transactions: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_raw_staging__transactions"} */
alter view "casestudy"."staging"."stg_raw_staging__transactions__dbt_tmp" rename to "stg_raw_staging__transactions"
[0m02:27:20.831936 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:27:20.832784 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__transactions: COMMIT
[0m02:27:20.832976 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_raw_staging__transactions"
[0m02:27:20.833146 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__transactions: COMMIT
[0m02:27:20.834775 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:27:20.836044 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_raw_staging__transactions"
[0m02:27:20.836246 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__transactions: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_raw_staging__transactions"} */
drop view if exists "casestudy"."staging"."stg_raw_staging__transactions__dbt_backup" cascade
[0m02:27:20.837315 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:27:20.838015 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.stg_raw_staging__transactions (execute): 02:27:20.811476 => 02:27:20.837918
[0m02:27:20.838211 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__transactions: Close
[0m02:27:20.848695 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b0329fb-cf28-4293-b1b2-c45dbb3ba5b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7185baf53ad0>]}
[0m02:27:20.849036 [info ] [Thread-1 (]: 5 of 11 OK created sql view model staging.stg_raw_staging__transactions ........ [[32mOK[0m in 0.04s]
[0m02:27:20.849342 [debug] [Thread-1 (]: Finished running node model.vg_casestudy.stg_raw_staging__transactions
[0m02:27:20.849558 [debug] [Thread-1 (]: Began running node model.vg_casestudy.stg_staging_intermediate__currencies
[0m02:27:20.849772 [info ] [Thread-1 (]: 6 of 11 START sql table model intermediate.stg_staging_intermediate__currencies  [RUN]
[0m02:27:20.850296 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.vg_casestudy.stg_raw_staging__transactions, now model.vg_casestudy.stg_staging_intermediate__currencies)
[0m02:27:20.850482 [debug] [Thread-1 (]: Began compiling node model.vg_casestudy.stg_staging_intermediate__currencies
[0m02:27:20.852098 [debug] [Thread-1 (]: Writing injected SQL for node "model.vg_casestudy.stg_staging_intermediate__currencies"
[0m02:27:20.852459 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.stg_staging_intermediate__currencies (compile): 02:27:20.850597 => 02:27:20.852351
[0m02:27:20.852637 [debug] [Thread-1 (]: Began executing node model.vg_casestudy.stg_staging_intermediate__currencies
[0m02:27:20.863987 [debug] [Thread-1 (]: Writing runtime sql for node "model.vg_casestudy.stg_staging_intermediate__currencies"
[0m02:27:20.864480 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__currencies"
[0m02:27:20.864673 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__currencies: BEGIN
[0m02:27:20.864849 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:27:20.872376 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:27:20.872701 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__currencies"
[0m02:27:20.872896 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__currencies: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_staging_intermediate__currencies"} */

  
    
    

    create  table
      "casestudy"."intermediate"."stg_staging_intermediate__currencies__dbt_tmp"
  
    as (
      with staging as (
    select * from "casestudy"."raw"."currencies"
),
cleaned as (
    select distinct
        trim(currency) as currency,
        trim(currency_iso_code) as currency_iso_code,
    from staging
    where currency_iso_code is not null and trim(currency_iso_code) != '(none)'
)

select * from cleaned
    );
  
  
[0m02:27:20.877516 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.stg_staging_intermediate__currencies (execute): 02:27:20.852754 => 02:27:20.877384
[0m02:27:20.877721 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__currencies: ROLLBACK
[0m02:27:20.879593 [debug] [Thread-1 (]: Failed to rollback 'model.vg_casestudy.stg_staging_intermediate__currencies'
[0m02:27:20.879802 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__currencies: Close
[0m02:27:20.882191 [debug] [Thread-1 (]: Runtime Error in model stg_staging_intermediate__currencies (models/intermediate/stg_staging_intermediate__currencies.sql)
  Catalog Error: Table with name currencies does not exist!
  Did you mean "staging.currencies"?
  
  LINE 12:     select * from "casestudy"."raw"."currencies"
                             ^
[0m02:27:20.882474 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b0329fb-cf28-4293-b1b2-c45dbb3ba5b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7185bafabb10>]}
[0m02:27:20.882802 [error] [Thread-1 (]: 6 of 11 ERROR creating sql table model intermediate.stg_staging_intermediate__currencies  [[31mERROR[0m in 0.03s]
[0m02:27:20.883113 [debug] [Thread-1 (]: Finished running node model.vg_casestudy.stg_staging_intermediate__currencies
[0m02:27:20.883342 [debug] [Thread-1 (]: Began running node model.vg_casestudy.stg_staging_intermediate__accounts
[0m02:27:20.884453 [info ] [Thread-1 (]: 7 of 11 START sql table model intermediate.stg_staging_intermediate__accounts .. [RUN]
[0m02:27:20.884782 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.vg_casestudy.stg_staging_intermediate__currencies, now model.vg_casestudy.stg_staging_intermediate__accounts)
[0m02:27:20.884962 [debug] [Thread-1 (]: Began compiling node model.vg_casestudy.stg_staging_intermediate__accounts
[0m02:27:20.886719 [debug] [Thread-1 (]: Writing injected SQL for node "model.vg_casestudy.stg_staging_intermediate__accounts"
[0m02:27:20.887054 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.stg_staging_intermediate__accounts (compile): 02:27:20.885073 => 02:27:20.886946
[0m02:27:20.887255 [debug] [Thread-1 (]: Began executing node model.vg_casestudy.stg_staging_intermediate__accounts
[0m02:27:20.889240 [debug] [Thread-1 (]: Writing runtime sql for node "model.vg_casestudy.stg_staging_intermediate__accounts"
[0m02:27:20.889526 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__accounts"
[0m02:27:20.889715 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__accounts: BEGIN
[0m02:27:20.889882 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:27:20.897399 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:27:20.897926 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__accounts"
[0m02:27:20.898139 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__accounts: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_staging_intermediate__accounts"} */

  
    
    

    create  table
      "casestudy"."intermediate"."stg_staging_intermediate__accounts__dbt_tmp"
  
    as (
      with staging as (
    select * from "casestudy"."staging"."stg_raw_staging__accounts"
), 
filtered as (
    select 
        account_id,
        customer_id,
        account_type,
        account_opening_date,
     from staging
    where not has_date_parsing_error
)

select * from filtered
    );
  
  
[0m02:27:20.904099 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:27:20.906335 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__accounts"
[0m02:27:20.906575 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__accounts: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_staging_intermediate__accounts"} */
alter table "casestudy"."intermediate"."stg_staging_intermediate__accounts" rename to "stg_staging_intermediate__accounts__dbt_backup"
[0m02:27:20.906993 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:27:20.908593 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__accounts"
[0m02:27:20.908797 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__accounts: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_staging_intermediate__accounts"} */
alter table "casestudy"."intermediate"."stg_staging_intermediate__accounts__dbt_tmp" rename to "stg_staging_intermediate__accounts"
[0m02:27:20.909131 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:27:20.912009 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__accounts: COMMIT
[0m02:27:20.912228 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__accounts"
[0m02:27:20.912404 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__accounts: COMMIT
[0m02:27:20.914005 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:27:20.915368 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__accounts"
[0m02:27:20.915577 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__accounts: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_staging_intermediate__accounts"} */
drop table if exists "casestudy"."intermediate"."stg_staging_intermediate__accounts__dbt_backup" cascade
[0m02:27:20.916477 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:27:20.917211 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.stg_staging_intermediate__accounts (execute): 02:27:20.887376 => 02:27:20.917101
[0m02:27:20.917443 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__accounts: Close
[0m02:27:20.931394 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b0329fb-cf28-4293-b1b2-c45dbb3ba5b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7185bb18ead0>]}
[0m02:27:20.932024 [info ] [Thread-1 (]: 7 of 11 OK created sql table model intermediate.stg_staging_intermediate__accounts  [[32mOK[0m in 0.05s]
[0m02:27:20.932554 [debug] [Thread-1 (]: Finished running node model.vg_casestudy.stg_staging_intermediate__accounts
[0m02:27:20.932834 [debug] [Thread-1 (]: Began running node model.vg_casestudy.stg_staging_intermediate__customers
[0m02:27:20.933209 [info ] [Thread-1 (]: 8 of 11 START sql table model intermediate.stg_staging_intermediate__customers . [RUN]
[0m02:27:20.933633 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.vg_casestudy.stg_staging_intermediate__accounts, now model.vg_casestudy.stg_staging_intermediate__customers)
[0m02:27:20.933865 [debug] [Thread-1 (]: Began compiling node model.vg_casestudy.stg_staging_intermediate__customers
[0m02:27:20.935587 [debug] [Thread-1 (]: Writing injected SQL for node "model.vg_casestudy.stg_staging_intermediate__customers"
[0m02:27:20.935930 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.stg_staging_intermediate__customers (compile): 02:27:20.933995 => 02:27:20.935819
[0m02:27:20.936114 [debug] [Thread-1 (]: Began executing node model.vg_casestudy.stg_staging_intermediate__customers
[0m02:27:20.938259 [debug] [Thread-1 (]: Writing runtime sql for node "model.vg_casestudy.stg_staging_intermediate__customers"
[0m02:27:20.938557 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__customers"
[0m02:27:20.938745 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__customers: BEGIN
[0m02:27:20.938917 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:27:20.947048 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:27:20.947293 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__customers"
[0m02:27:20.947490 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__customers: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_staging_intermediate__customers"} */

  
    
    

    create  table
      "casestudy"."intermediate"."stg_staging_intermediate__customers__dbt_tmp"
  
    as (
      with staging as (
    select * from "casestudy"."staging"."stg_raw_staging__customers"
)

select * from staging
    );
  
  
[0m02:27:20.952704 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:27:20.954639 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__customers"
[0m02:27:20.954876 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__customers: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_staging_intermediate__customers"} */
alter table "casestudy"."intermediate"."stg_staging_intermediate__customers" rename to "stg_staging_intermediate__customers__dbt_backup"
[0m02:27:20.955284 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:27:20.957227 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__customers"
[0m02:27:20.957460 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__customers: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_staging_intermediate__customers"} */
alter table "casestudy"."intermediate"."stg_staging_intermediate__customers__dbt_tmp" rename to "stg_staging_intermediate__customers"
[0m02:27:20.957877 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:27:20.960817 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__customers: COMMIT
[0m02:27:20.961036 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__customers"
[0m02:27:20.961231 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__customers: COMMIT
[0m02:27:20.963294 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:27:20.964647 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__customers"
[0m02:27:20.964861 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__customers: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_staging_intermediate__customers"} */
drop table if exists "casestudy"."intermediate"."stg_staging_intermediate__customers__dbt_backup" cascade
[0m02:27:20.965782 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:27:20.966535 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.stg_staging_intermediate__customers (execute): 02:27:20.936258 => 02:27:20.966435
[0m02:27:20.966736 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__customers: Close
[0m02:27:20.982153 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b0329fb-cf28-4293-b1b2-c45dbb3ba5b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7185bb02d5d0>]}
[0m02:27:20.982605 [info ] [Thread-1 (]: 8 of 11 OK created sql table model intermediate.stg_staging_intermediate__customers  [[32mOK[0m in 0.05s]
[0m02:27:20.982940 [debug] [Thread-1 (]: Finished running node model.vg_casestudy.stg_staging_intermediate__customers
[0m02:27:20.983175 [debug] [Thread-1 (]: Began running node model.vg_casestudy.stg_staging_intermediate__fx_rates
[0m02:27:20.983521 [info ] [Thread-1 (]: 9 of 11 START sql table model intermediate.stg_staging_intermediate__fx_rates .. [RUN]
[0m02:27:20.983874 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.vg_casestudy.stg_staging_intermediate__customers, now model.vg_casestudy.stg_staging_intermediate__fx_rates)
[0m02:27:20.984067 [debug] [Thread-1 (]: Began compiling node model.vg_casestudy.stg_staging_intermediate__fx_rates
[0m02:27:20.985844 [debug] [Thread-1 (]: Writing injected SQL for node "model.vg_casestudy.stg_staging_intermediate__fx_rates"
[0m02:27:20.986189 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.stg_staging_intermediate__fx_rates (compile): 02:27:20.984201 => 02:27:20.986073
[0m02:27:20.986401 [debug] [Thread-1 (]: Began executing node model.vg_casestudy.stg_staging_intermediate__fx_rates
[0m02:27:20.988557 [debug] [Thread-1 (]: Writing runtime sql for node "model.vg_casestudy.stg_staging_intermediate__fx_rates"
[0m02:27:20.988842 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__fx_rates"
[0m02:27:20.989023 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__fx_rates: BEGIN
[0m02:27:20.989206 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:27:20.996631 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:27:20.997065 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__fx_rates"
[0m02:27:20.997288 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__fx_rates: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_staging_intermediate__fx_rates"} */

  
    
    

    create  table
      "casestudy"."intermediate"."stg_staging_intermediate__fx_rates__dbt_tmp"
  
    as (
      with staging as (
    select * from "casestudy"."staging"."stg_raw_staging__fx_rates"
),

filtered as (
    select
        currency_iso_code,
        fx_rate,
        fx_rate_date
    from staging
    where not has_date_parsing_error
)

select * from filtered
    );
  
  
[0m02:27:20.999717 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:27:21.001525 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__fx_rates"
[0m02:27:21.001750 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__fx_rates: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_staging_intermediate__fx_rates"} */
alter table "casestudy"."intermediate"."stg_staging_intermediate__fx_rates" rename to "stg_staging_intermediate__fx_rates__dbt_backup"
[0m02:27:21.002110 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:27:21.003785 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__fx_rates"
[0m02:27:21.004034 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__fx_rates: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_staging_intermediate__fx_rates"} */
alter table "casestudy"."intermediate"."stg_staging_intermediate__fx_rates__dbt_tmp" rename to "stg_staging_intermediate__fx_rates"
[0m02:27:21.004395 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:27:21.005426 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__fx_rates: COMMIT
[0m02:27:21.005646 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__fx_rates"
[0m02:27:21.005834 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__fx_rates: COMMIT
[0m02:27:21.007308 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:27:21.008698 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__fx_rates"
[0m02:27:21.008917 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__fx_rates: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_staging_intermediate__fx_rates"} */
drop table if exists "casestudy"."intermediate"."stg_staging_intermediate__fx_rates__dbt_backup" cascade
[0m02:27:21.009857 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:27:21.010606 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.stg_staging_intermediate__fx_rates (execute): 02:27:20.986526 => 02:27:21.010506
[0m02:27:21.010809 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__fx_rates: Close
[0m02:27:21.022003 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b0329fb-cf28-4293-b1b2-c45dbb3ba5b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7185bb02cf90>]}
[0m02:27:21.022387 [info ] [Thread-1 (]: 9 of 11 OK created sql table model intermediate.stg_staging_intermediate__fx_rates  [[32mOK[0m in 0.04s]
[0m02:27:21.022702 [debug] [Thread-1 (]: Finished running node model.vg_casestudy.stg_staging_intermediate__fx_rates
[0m02:27:21.022924 [debug] [Thread-1 (]: Began running node model.vg_casestudy.stg_staging_intermediate__loans
[0m02:27:21.023440 [info ] [Thread-1 (]: 10 of 11 START sql table model intermediate.stg_staging_intermediate__loans .... [RUN]
[0m02:27:21.024340 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.vg_casestudy.stg_staging_intermediate__fx_rates, now model.vg_casestudy.stg_staging_intermediate__loans)
[0m02:27:21.024810 [debug] [Thread-1 (]: Began compiling node model.vg_casestudy.stg_staging_intermediate__loans
[0m02:27:21.027337 [debug] [Thread-1 (]: Writing injected SQL for node "model.vg_casestudy.stg_staging_intermediate__loans"
[0m02:27:21.027645 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.stg_staging_intermediate__loans (compile): 02:27:21.025103 => 02:27:21.027544
[0m02:27:21.027823 [debug] [Thread-1 (]: Began executing node model.vg_casestudy.stg_staging_intermediate__loans
[0m02:27:21.029816 [debug] [Thread-1 (]: Writing runtime sql for node "model.vg_casestudy.stg_staging_intermediate__loans"
[0m02:27:21.030109 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__loans"
[0m02:27:21.030313 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__loans: BEGIN
[0m02:27:21.030490 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:27:21.037801 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:27:21.038256 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__loans"
[0m02:27:21.038524 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__loans: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_staging_intermediate__loans"} */

  
    
    

    create  table
      "casestudy"."intermediate"."stg_staging_intermediate__loans__dbt_tmp"
  
    as (
      with staging as (
    select * from "casestudy"."staging"."stg_raw_staging__loans"
),

filtered as (
    select
        customer_id,
        loan_id,
        loan_amount,
        loan_type,
        interest_rate,
        loan_term,
        approval_rejection_date,
        loan_status
    from staging
    where not has_date_parsing_error
)

select * from filtered
    );
  
  
[0m02:27:21.047716 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:27:21.049690 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__loans"
[0m02:27:21.049918 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__loans: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_staging_intermediate__loans"} */
alter table "casestudy"."intermediate"."stg_staging_intermediate__loans" rename to "stg_staging_intermediate__loans__dbt_backup"
[0m02:27:21.050300 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:27:21.053199 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__loans"
[0m02:27:21.053422 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__loans: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_staging_intermediate__loans"} */
alter table "casestudy"."intermediate"."stg_staging_intermediate__loans__dbt_tmp" rename to "stg_staging_intermediate__loans"
[0m02:27:21.053784 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:27:21.054848 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__loans: COMMIT
[0m02:27:21.055058 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__loans"
[0m02:27:21.055245 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__loans: COMMIT
[0m02:27:21.057298 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:27:21.058743 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__loans"
[0m02:27:21.058960 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__loans: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_staging_intermediate__loans"} */
drop table if exists "casestudy"."intermediate"."stg_staging_intermediate__loans__dbt_backup" cascade
[0m02:27:21.060983 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:27:21.061846 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.stg_staging_intermediate__loans (execute): 02:27:21.027939 => 02:27:21.061739
[0m02:27:21.062048 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__loans: Close
[0m02:27:21.079968 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b0329fb-cf28-4293-b1b2-c45dbb3ba5b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7185bb0358d0>]}
[0m02:27:21.080476 [info ] [Thread-1 (]: 10 of 11 OK created sql table model intermediate.stg_staging_intermediate__loans  [[32mOK[0m in 0.06s]
[0m02:27:21.080873 [debug] [Thread-1 (]: Finished running node model.vg_casestudy.stg_staging_intermediate__loans
[0m02:27:21.081149 [debug] [Thread-1 (]: Began running node model.vg_casestudy.stg_staging_intermediate__transactions
[0m02:27:21.081473 [info ] [Thread-1 (]: 11 of 11 START sql table model intermediate.stg_staging_intermediate__transactions  [RUN]
[0m02:27:21.081869 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.vg_casestudy.stg_staging_intermediate__loans, now model.vg_casestudy.stg_staging_intermediate__transactions)
[0m02:27:21.082076 [debug] [Thread-1 (]: Began compiling node model.vg_casestudy.stg_staging_intermediate__transactions
[0m02:27:21.084085 [debug] [Thread-1 (]: Writing injected SQL for node "model.vg_casestudy.stg_staging_intermediate__transactions"
[0m02:27:21.084555 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.stg_staging_intermediate__transactions (compile): 02:27:21.082210 => 02:27:21.084403
[0m02:27:21.084754 [debug] [Thread-1 (]: Began executing node model.vg_casestudy.stg_staging_intermediate__transactions
[0m02:27:21.088067 [debug] [Thread-1 (]: Writing runtime sql for node "model.vg_casestudy.stg_staging_intermediate__transactions"
[0m02:27:21.088855 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__transactions"
[0m02:27:21.089298 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__transactions: BEGIN
[0m02:27:21.089669 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:27:21.106581 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:27:21.107484 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__transactions"
[0m02:27:21.107791 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__transactions: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_staging_intermediate__transactions"} */

  
    
    

    create  table
      "casestudy"."intermediate"."stg_staging_intermediate__transactions__dbt_tmp"
  
    as (
      with staging as (
    select * from "casestudy"."staging"."stg_raw_staging__transactions"
),

filtered as (
    select
        transaction_id,
        transaction_date,
        account_id,
        transaction_type,
        transaction_amount,
        transaction_currency
    from staging
    where not has_date_parsing_error
)

select * from filtered
    );
  
  
[0m02:27:21.147469 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:27:21.149798 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__transactions"
[0m02:27:21.150036 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__transactions: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_staging_intermediate__transactions"} */
alter table "casestudy"."intermediate"."stg_staging_intermediate__transactions" rename to "stg_staging_intermediate__transactions__dbt_backup"
[0m02:27:21.150537 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:27:21.152231 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__transactions"
[0m02:27:21.152438 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__transactions: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_staging_intermediate__transactions"} */
alter table "casestudy"."intermediate"."stg_staging_intermediate__transactions__dbt_tmp" rename to "stg_staging_intermediate__transactions"
[0m02:27:21.152818 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:27:21.153780 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__transactions: COMMIT
[0m02:27:21.153980 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__transactions"
[0m02:27:21.154158 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__transactions: COMMIT
[0m02:27:21.159053 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:27:21.160450 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__transactions"
[0m02:27:21.160650 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__transactions: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_staging_intermediate__transactions"} */
drop table if exists "casestudy"."intermediate"."stg_staging_intermediate__transactions__dbt_backup" cascade
[0m02:27:21.161544 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:27:21.162335 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.stg_staging_intermediate__transactions (execute): 02:27:21.084905 => 02:27:21.162239
[0m02:27:21.162526 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__transactions: Close
[0m02:27:21.185757 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b0329fb-cf28-4293-b1b2-c45dbb3ba5b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7185c1d2c210>]}
[0m02:27:21.186190 [info ] [Thread-1 (]: 11 of 11 OK created sql table model intermediate.stg_staging_intermediate__transactions  [[32mOK[0m in 0.10s]
[0m02:27:21.186509 [debug] [Thread-1 (]: Finished running node model.vg_casestudy.stg_staging_intermediate__transactions
[0m02:27:21.188739 [debug] [MainThread]: Using duckdb connection "master"
[0m02:27:21.189277 [debug] [MainThread]: On master: BEGIN
[0m02:27:21.189456 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:27:21.197283 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m02:27:21.197498 [debug] [MainThread]: On master: COMMIT
[0m02:27:21.197651 [debug] [MainThread]: Using duckdb connection "master"
[0m02:27:21.197793 [debug] [MainThread]: On master: COMMIT
[0m02:27:21.198024 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m02:27:21.198199 [debug] [MainThread]: On master: Close
[0m02:27:21.199530 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:27:21.199736 [debug] [MainThread]: Connection 'list_casestudy_raw' was properly closed.
[0m02:27:21.199883 [debug] [MainThread]: Connection 'model.vg_casestudy.stg_staging_intermediate__transactions' was properly closed.
[0m02:27:21.200094 [info ] [MainThread]: 
[0m02:27:21.200286 [info ] [MainThread]: Finished running 5 view models, 6 table models in 0 hours 0 minutes and 5.24 seconds (5.24s).
[0m02:27:21.201154 [debug] [MainThread]: Command end result
[0m02:27:21.261516 [info ] [MainThread]: 
[0m02:27:21.261839 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m02:27:21.262014 [info ] [MainThread]: 
[0m02:27:21.262185 [error] [MainThread]:   Runtime Error in model stg_staging_intermediate__currencies (models/intermediate/stg_staging_intermediate__currencies.sql)
  Catalog Error: Table with name currencies does not exist!
  Did you mean "staging.currencies"?
  
  LINE 12:     select * from "casestudy"."raw"."currencies"
                             ^
[0m02:27:21.262355 [info ] [MainThread]: 
[0m02:27:21.262518 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=1 SKIP=0 TOTAL=11
[0m02:27:21.262790 [debug] [MainThread]: Command `dbt run` failed at 02:27:21.262728 after 6.33 seconds
[0m02:27:21.263007 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7185cabe1910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7185c1eb2510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7185c1eb2150>]}
[0m02:27:21.263207 [debug] [MainThread]: Flushing usage events
[0m02:28:22.088727 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x790a58ecab50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x790a58be0110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x790a590b46d0>]}


============================== 02:28:22.091872 | 8b2ca433-5e5e-4da7-936b-b82859d29cb1 ==============================
[0m02:28:22.091872 [info ] [MainThread]: Running with dbt=1.6.18
[0m02:28:22.092507 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/workspaces/varengold_data_analyst_case/transformation', 'log_path': '/workspaces/varengold_data_analyst_case/transformation/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt seed', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m02:28:22.148637 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8b2ca433-5e5e-4da7-936b-b82859d29cb1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x790a58f046d0>]}
[0m02:28:22.156521 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8b2ca433-5e5e-4da7-936b-b82859d29cb1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x790a58a50f10>]}
[0m02:28:22.156957 [info ] [MainThread]: Registered adapter: duckdb=1.6.2
[0m02:28:22.170046 [debug] [MainThread]: checksum: 7b9fab86a08e9e96a48a825af743c566d95b877e068b8c6d0dbafbf714447189, vars: {}, profile: , target: , version: 1.6.18
[0m02:28:22.192751 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m02:28:22.193031 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m02:28:22.193760 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.vg_casestudy.marts
- models.vg_casestudy.main
- models.vg_casestudy.reporting
[0m02:28:22.197780 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8b2ca433-5e5e-4da7-936b-b82859d29cb1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x790a548f6a90>]}
[0m02:28:22.213582 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8b2ca433-5e5e-4da7-936b-b82859d29cb1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x790a589167d0>]}
[0m02:28:22.213924 [info ] [MainThread]: Found 11 models, 1 analysis, 2 seeds, 71 tests, 5 sources, 0 exposures, 0 metrics, 632 macros, 0 groups, 0 semantic models
[0m02:28:22.214118 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8b2ca433-5e5e-4da7-936b-b82859d29cb1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x790a5465bed0>]}
[0m02:28:22.215703 [info ] [MainThread]: 
[0m02:28:22.216147 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m02:28:22.217351 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_casestudy'
[0m02:28:22.227749 [debug] [ThreadPool]: Using duckdb connection "list_casestudy"
[0m02:28:22.227984 [debug] [ThreadPool]: On list_casestudy: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"casestudy"'
    
  
  
[0m02:28:22.228153 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:28:22.237530 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m02:28:22.238372 [debug] [ThreadPool]: On list_casestudy: Close
[0m02:28:22.241285 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy, now create_casestudy_raw)
[0m02:28:22.241710 [debug] [ThreadPool]: Creating schema "database: "casestudy"
schema: "raw"
"
[0m02:28:22.245030 [debug] [ThreadPool]: Using duckdb connection "create_casestudy_raw"
[0m02:28:22.245235 [debug] [ThreadPool]: On create_casestudy_raw: BEGIN
[0m02:28:22.245385 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:28:22.252178 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m02:28:22.252373 [debug] [ThreadPool]: Using duckdb connection "create_casestudy_raw"
[0m02:28:22.252523 [debug] [ThreadPool]: On create_casestudy_raw: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "create_casestudy_raw"} */
create schema if not exists "casestudy"."raw"
[0m02:28:22.252877 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m02:28:22.253395 [debug] [ThreadPool]: On create_casestudy_raw: COMMIT
[0m02:28:22.253557 [debug] [ThreadPool]: Using duckdb connection "create_casestudy_raw"
[0m02:28:22.253693 [debug] [ThreadPool]: On create_casestudy_raw: COMMIT
[0m02:28:22.253931 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m02:28:22.254091 [debug] [ThreadPool]: On create_casestudy_raw: Close
[0m02:28:22.257471 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_casestudy_raw, now list_casestudy_raw)
[0m02:28:22.262069 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_raw"
[0m02:28:22.262285 [debug] [ThreadPool]: On list_casestudy_raw: BEGIN
[0m02:28:22.262442 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:28:22.269344 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m02:28:22.269546 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_raw"
[0m02:28:22.269714 [debug] [ThreadPool]: On list_casestudy_raw: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_raw"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'raw'
    and table_catalog = 'casestudy'
  
[0m02:28:22.277022 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m02:28:22.277854 [debug] [ThreadPool]: On list_casestudy_raw: ROLLBACK
[0m02:28:22.278298 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_raw'
[0m02:28:22.278472 [debug] [ThreadPool]: On list_casestudy_raw: Close
[0m02:28:22.280249 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy_raw, now list_casestudy_staging)
[0m02:28:22.282031 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_staging"
[0m02:28:22.282230 [debug] [ThreadPool]: On list_casestudy_staging: BEGIN
[0m02:28:22.282381 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:28:22.289237 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m02:28:22.289436 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_staging"
[0m02:28:22.289603 [debug] [ThreadPool]: On list_casestudy_staging: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_staging"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'staging'
    and table_catalog = 'casestudy'
  
[0m02:28:22.296489 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m02:28:22.297279 [debug] [ThreadPool]: On list_casestudy_staging: ROLLBACK
[0m02:28:22.297566 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_staging'
[0m02:28:22.297729 [debug] [ThreadPool]: On list_casestudy_staging: Close
[0m02:28:22.299282 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy_staging, now list_casestudy_intermediate)
[0m02:28:22.301649 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_intermediate"
[0m02:28:22.301836 [debug] [ThreadPool]: On list_casestudy_intermediate: BEGIN
[0m02:28:22.301984 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:28:22.308739 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m02:28:22.308931 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_intermediate"
[0m02:28:22.309097 [debug] [ThreadPool]: On list_casestudy_intermediate: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_intermediate"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'intermediate'
    and table_catalog = 'casestudy'
  
[0m02:28:22.316749 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m02:28:22.317474 [debug] [ThreadPool]: On list_casestudy_intermediate: ROLLBACK
[0m02:28:22.317745 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_intermediate'
[0m02:28:22.317896 [debug] [ThreadPool]: On list_casestudy_intermediate: Close
[0m02:28:22.320393 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8b2ca433-5e5e-4da7-936b-b82859d29cb1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x790a588f9e10>]}
[0m02:28:22.320917 [debug] [MainThread]: Using duckdb connection "master"
[0m02:28:22.321274 [debug] [MainThread]: On master: BEGIN
[0m02:28:22.321589 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:28:22.329476 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m02:28:22.329672 [debug] [MainThread]: On master: COMMIT
[0m02:28:22.329820 [debug] [MainThread]: Using duckdb connection "master"
[0m02:28:22.329957 [debug] [MainThread]: On master: COMMIT
[0m02:28:22.330184 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m02:28:22.330343 [debug] [MainThread]: On master: Close
[0m02:28:22.331487 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:28:22.331684 [info ] [MainThread]: 
[0m02:28:22.333023 [debug] [Thread-1 (]: Began running node seed.vg_casestudy.currencies
[0m02:28:22.333550 [info ] [Thread-1 (]: 1 of 2 START seed file raw.currencies .......................................... [RUN]
[0m02:28:22.334597 [debug] [Thread-1 (]: Acquiring new duckdb connection 'seed.vg_casestudy.currencies'
[0m02:28:22.334995 [debug] [Thread-1 (]: Began compiling node seed.vg_casestudy.currencies
[0m02:28:22.335454 [debug] [Thread-1 (]: Timing info for seed.vg_casestudy.currencies (compile): 02:28:22.335253 => 02:28:22.335256
[0m02:28:22.335790 [debug] [Thread-1 (]: Began executing node seed.vg_casestudy.currencies
[0m02:28:22.350794 [debug] [Thread-1 (]: Using duckdb connection "seed.vg_casestudy.currencies"
[0m02:28:22.351094 [debug] [Thread-1 (]: On seed.vg_casestudy.currencies: BEGIN
[0m02:28:22.351285 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m02:28:22.360011 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:28:22.360259 [debug] [Thread-1 (]: Using duckdb connection "seed.vg_casestudy.currencies"
[0m02:28:22.360433 [debug] [Thread-1 (]: On seed.vg_casestudy.currencies: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "seed.vg_casestudy.currencies"} */

    create table "casestudy"."raw"."currencies" ("currency" text,"currency_iso_code" text)
  
[0m02:28:22.360848 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:28:22.366843 [debug] [Thread-1 (]: Using duckdb connection "seed.vg_casestudy.currencies"
[0m02:28:22.367069 [debug] [Thread-1 (]: On seed.vg_casestudy.currencies: 
          COPY "casestudy"."raw"."currencies" FROM '/workspaces/varengold_data_analyst_case/transformation/seeds/currencies.csv' (FORMAT CSV, HEADER TRUE)
        ...
[0m02:28:22.370793 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:28:22.373888 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.vg_casestudy.currencies"
[0m02:28:22.383348 [debug] [Thread-1 (]: On seed.vg_casestudy.currencies: COMMIT
[0m02:28:22.383565 [debug] [Thread-1 (]: Using duckdb connection "seed.vg_casestudy.currencies"
[0m02:28:22.383740 [debug] [Thread-1 (]: On seed.vg_casestudy.currencies: COMMIT
[0m02:28:22.391441 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:28:22.392024 [debug] [Thread-1 (]: Timing info for seed.vg_casestudy.currencies (execute): 02:28:22.336015 => 02:28:22.391925
[0m02:28:22.392226 [debug] [Thread-1 (]: On seed.vg_casestudy.currencies: Close
[0m02:28:22.406329 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8b2ca433-5e5e-4da7-936b-b82859d29cb1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x790a5894d510>]}
[0m02:28:22.407047 [info ] [Thread-1 (]: 1 of 2 OK loaded seed file raw.currencies ...................................... [[32mINSERT 158[0m in 0.07s]
[0m02:28:22.407582 [debug] [Thread-1 (]: Finished running node seed.vg_casestudy.currencies
[0m02:28:22.407953 [debug] [Thread-1 (]: Began running node seed.vg_casestudy.dbt_project_evaluator_exceptions
[0m02:28:22.408521 [info ] [Thread-1 (]: 2 of 2 START seed file raw.dbt_project_evaluator_exceptions .................... [RUN]
[0m02:28:22.409250 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.vg_casestudy.currencies, now seed.vg_casestudy.dbt_project_evaluator_exceptions)
[0m02:28:22.409504 [debug] [Thread-1 (]: Began compiling node seed.vg_casestudy.dbt_project_evaluator_exceptions
[0m02:28:22.409748 [debug] [Thread-1 (]: Timing info for seed.vg_casestudy.dbt_project_evaluator_exceptions (compile): 02:28:22.409640 => 02:28:22.409642
[0m02:28:22.409929 [debug] [Thread-1 (]: Began executing node seed.vg_casestudy.dbt_project_evaluator_exceptions
[0m02:28:22.412379 [debug] [Thread-1 (]: Using duckdb connection "seed.vg_casestudy.dbt_project_evaluator_exceptions"
[0m02:28:22.412597 [debug] [Thread-1 (]: On seed.vg_casestudy.dbt_project_evaluator_exceptions: BEGIN
[0m02:28:22.412765 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:28:22.419685 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:28:22.420023 [debug] [Thread-1 (]: Using duckdb connection "seed.vg_casestudy.dbt_project_evaluator_exceptions"
[0m02:28:22.420250 [debug] [Thread-1 (]: On seed.vg_casestudy.dbt_project_evaluator_exceptions: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "seed.vg_casestudy.dbt_project_evaluator_exceptions"} */

    create table "casestudy"."raw"."dbt_project_evaluator_exceptions" ("fct_name" text,"column_name" text,"id_to_exclude" text,"comment" text)
  
[0m02:28:22.420797 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:28:22.421631 [debug] [Thread-1 (]: Using duckdb connection "seed.vg_casestudy.dbt_project_evaluator_exceptions"
[0m02:28:22.421850 [debug] [Thread-1 (]: On seed.vg_casestudy.dbt_project_evaluator_exceptions: 
          COPY "casestudy"."raw"."dbt_project_evaluator_exceptions" FROM '/workspaces/varengold_data_analyst_case/transformation/seeds/dbt_project_evaluator_exceptions.csv' (FORMAT CSV, HEADER TRUE)
        ...
[0m02:28:22.424687 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:28:22.425224 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.vg_casestudy.dbt_project_evaluator_exceptions"
[0m02:28:22.426401 [debug] [Thread-1 (]: On seed.vg_casestudy.dbt_project_evaluator_exceptions: COMMIT
[0m02:28:22.426631 [debug] [Thread-1 (]: Using duckdb connection "seed.vg_casestudy.dbt_project_evaluator_exceptions"
[0m02:28:22.426801 [debug] [Thread-1 (]: On seed.vg_casestudy.dbt_project_evaluator_exceptions: COMMIT
[0m02:28:22.428146 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:28:22.428695 [debug] [Thread-1 (]: Timing info for seed.vg_casestudy.dbt_project_evaluator_exceptions (execute): 02:28:22.410049 => 02:28:22.428597
[0m02:28:22.428882 [debug] [Thread-1 (]: On seed.vg_casestudy.dbt_project_evaluator_exceptions: Close
[0m02:28:22.440840 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8b2ca433-5e5e-4da7-936b-b82859d29cb1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x790a5893b810>]}
[0m02:28:22.441203 [info ] [Thread-1 (]: 2 of 2 OK loaded seed file raw.dbt_project_evaluator_exceptions ................ [[32mINSERT 2[0m in 0.03s]
[0m02:28:22.441519 [debug] [Thread-1 (]: Finished running node seed.vg_casestudy.dbt_project_evaluator_exceptions
[0m02:28:22.442743 [debug] [MainThread]: Using duckdb connection "master"
[0m02:28:22.442943 [debug] [MainThread]: On master: BEGIN
[0m02:28:22.443090 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:28:22.450807 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m02:28:22.451048 [debug] [MainThread]: On master: COMMIT
[0m02:28:22.451216 [debug] [MainThread]: Using duckdb connection "master"
[0m02:28:22.451365 [debug] [MainThread]: On master: COMMIT
[0m02:28:22.451607 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m02:28:22.451784 [debug] [MainThread]: On master: Close
[0m02:28:22.453454 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:28:22.453654 [debug] [MainThread]: Connection 'list_casestudy_intermediate' was properly closed.
[0m02:28:22.453789 [debug] [MainThread]: Connection 'seed.vg_casestudy.dbt_project_evaluator_exceptions' was properly closed.
[0m02:28:22.454010 [info ] [MainThread]: 
[0m02:28:22.454196 [info ] [MainThread]: Finished running 2 seeds in 0 hours 0 minutes and 0.24 seconds (0.24s).
[0m02:28:22.454624 [debug] [MainThread]: Command end result
[0m02:28:22.503959 [info ] [MainThread]: 
[0m02:28:22.504264 [info ] [MainThread]: [32mCompleted successfully[0m
[0m02:28:22.504436 [info ] [MainThread]: 
[0m02:28:22.504603 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m02:28:22.504864 [debug] [MainThread]: Command `dbt seed` succeeded at 02:28:22.504802 after 0.42 seconds
[0m02:28:22.505059 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x790a59d33dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x790a58c40cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x790a58c40710>]}
[0m02:28:22.505271 [debug] [MainThread]: Flushing usage events
[0m02:28:26.616898 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x740a744f23d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x740a74afacd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x740a7475fb10>]}


============================== 02:28:26.619875 | 3aeec56f-ff13-44f7-96b5-c78c6b5fd01e ==============================
[0m02:28:26.619875 [info ] [MainThread]: Running with dbt=1.6.18
[0m02:28:26.620419 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/workspaces/varengold_data_analyst_case/transformation', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/workspaces/varengold_data_analyst_case/transformation/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m02:28:26.676907 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3aeec56f-ff13-44f7-96b5-c78c6b5fd01e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x740a74517e90>]}
[0m02:28:26.684641 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3aeec56f-ff13-44f7-96b5-c78c6b5fd01e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x740a74823050>]}
[0m02:28:26.685068 [info ] [MainThread]: Registered adapter: duckdb=1.6.2
[0m02:28:26.697698 [debug] [MainThread]: checksum: 7b9fab86a08e9e96a48a825af743c566d95b877e068b8c6d0dbafbf714447189, vars: {}, profile: , target: , version: 1.6.18
[0m02:28:26.720445 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m02:28:26.720757 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m02:28:26.721462 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.vg_casestudy.marts
- models.vg_casestudy.reporting
- models.vg_casestudy.main
[0m02:28:26.725422 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3aeec56f-ff13-44f7-96b5-c78c6b5fd01e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x740a70386a90>]}
[0m02:28:26.738906 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3aeec56f-ff13-44f7-96b5-c78c6b5fd01e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x740a703702d0>]}
[0m02:28:26.739264 [info ] [MainThread]: Found 11 models, 1 analysis, 2 seeds, 71 tests, 5 sources, 0 exposures, 0 metrics, 632 macros, 0 groups, 0 semantic models
[0m02:28:26.739465 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3aeec56f-ff13-44f7-96b5-c78c6b5fd01e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x740a7027ff10>]}
[0m02:28:26.741270 [info ] [MainThread]: 
[0m02:28:26.741723 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m02:28:26.742837 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_casestudy'
[0m02:28:26.752811 [debug] [ThreadPool]: Using duckdb connection "list_casestudy"
[0m02:28:26.753024 [debug] [ThreadPool]: On list_casestudy: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"casestudy"'
    
  
  
[0m02:28:26.753214 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:28:26.764312 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m02:28:26.765291 [debug] [ThreadPool]: On list_casestudy: Close
[0m02:28:26.770491 [debug] [ThreadPool]: Using duckdb connection "list_casestudy"
[0m02:28:26.770772 [debug] [ThreadPool]: On list_casestudy: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"casestudy"'
    
  
  
[0m02:28:26.770937 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:28:26.778369 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m02:28:26.779260 [debug] [ThreadPool]: On list_casestudy: Close
[0m02:28:26.781198 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy, now create_casestudy_staging)
[0m02:28:26.781598 [debug] [ThreadPool]: Creating schema "database: "casestudy"
schema: "staging"
"
[0m02:28:26.784303 [debug] [ThreadPool]: Using duckdb connection "create_casestudy_staging"
[0m02:28:26.784488 [debug] [ThreadPool]: On create_casestudy_staging: BEGIN
[0m02:28:26.784639 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:28:26.791334 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m02:28:26.791553 [debug] [ThreadPool]: Using duckdb connection "create_casestudy_staging"
[0m02:28:26.791707 [debug] [ThreadPool]: On create_casestudy_staging: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "create_casestudy_staging"} */
create schema if not exists "casestudy"."staging"
[0m02:28:26.791981 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m02:28:26.792909 [debug] [ThreadPool]: On create_casestudy_staging: COMMIT
[0m02:28:26.793352 [debug] [ThreadPool]: Using duckdb connection "create_casestudy_staging"
[0m02:28:26.793642 [debug] [ThreadPool]: On create_casestudy_staging: COMMIT
[0m02:28:26.794209 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m02:28:26.794527 [debug] [ThreadPool]: On create_casestudy_staging: Close
[0m02:28:26.796871 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_casestudy_staging, now create_casestudy_intermediate)
[0m02:28:26.797264 [debug] [ThreadPool]: Creating schema "database: "casestudy"
schema: "intermediate"
"
[0m02:28:26.798558 [debug] [ThreadPool]: Using duckdb connection "create_casestudy_intermediate"
[0m02:28:26.798741 [debug] [ThreadPool]: On create_casestudy_intermediate: BEGIN
[0m02:28:26.798884 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:28:26.805490 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m02:28:26.805689 [debug] [ThreadPool]: Using duckdb connection "create_casestudy_intermediate"
[0m02:28:26.805841 [debug] [ThreadPool]: On create_casestudy_intermediate: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "create_casestudy_intermediate"} */
create schema if not exists "casestudy"."intermediate"
[0m02:28:26.806111 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m02:28:26.806624 [debug] [ThreadPool]: On create_casestudy_intermediate: COMMIT
[0m02:28:26.806791 [debug] [ThreadPool]: Using duckdb connection "create_casestudy_intermediate"
[0m02:28:26.806934 [debug] [ThreadPool]: On create_casestudy_intermediate: COMMIT
[0m02:28:26.807191 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m02:28:26.807356 [debug] [ThreadPool]: On create_casestudy_intermediate: Close
[0m02:28:26.809850 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_casestudy_intermediate, now list_casestudy_raw)
[0m02:28:26.815730 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_raw"
[0m02:28:26.815913 [debug] [ThreadPool]: On list_casestudy_raw: BEGIN
[0m02:28:26.816059 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:28:26.822608 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m02:28:26.822791 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_raw"
[0m02:28:26.822944 [debug] [ThreadPool]: On list_casestudy_raw: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_raw"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'raw'
    and table_catalog = 'casestudy'
  
[0m02:28:26.831442 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m02:28:26.832250 [debug] [ThreadPool]: On list_casestudy_raw: ROLLBACK
[0m02:28:26.832699 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_raw'
[0m02:28:26.832884 [debug] [ThreadPool]: On list_casestudy_raw: Close
[0m02:28:26.834423 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy_raw, now list_casestudy_staging)
[0m02:28:26.836965 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_staging"
[0m02:28:26.837149 [debug] [ThreadPool]: On list_casestudy_staging: BEGIN
[0m02:28:26.837291 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:28:26.843712 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m02:28:26.843893 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_staging"
[0m02:28:26.844050 [debug] [ThreadPool]: On list_casestudy_staging: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_staging"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'staging'
    and table_catalog = 'casestudy'
  
[0m02:28:26.850822 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m02:28:26.851545 [debug] [ThreadPool]: On list_casestudy_staging: ROLLBACK
[0m02:28:26.851808 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_staging'
[0m02:28:26.851953 [debug] [ThreadPool]: On list_casestudy_staging: Close
[0m02:28:26.854204 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy_staging, now list_casestudy_intermediate)
[0m02:28:26.857128 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_intermediate"
[0m02:28:26.857359 [debug] [ThreadPool]: On list_casestudy_intermediate: BEGIN
[0m02:28:26.857490 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:28:26.867876 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m02:28:26.868061 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_intermediate"
[0m02:28:26.868617 [debug] [ThreadPool]: On list_casestudy_intermediate: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_intermediate"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'intermediate'
    and table_catalog = 'casestudy'
  
[0m02:28:26.880010 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m02:28:26.880747 [debug] [ThreadPool]: On list_casestudy_intermediate: ROLLBACK
[0m02:28:26.881028 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_intermediate'
[0m02:28:26.881186 [debug] [ThreadPool]: On list_casestudy_intermediate: Close
[0m02:28:26.883399 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3aeec56f-ff13-44f7-96b5-c78c6b5fd01e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x740a7497acd0>]}
[0m02:28:26.883679 [debug] [MainThread]: Using duckdb connection "master"
[0m02:28:26.883832 [debug] [MainThread]: On master: BEGIN
[0m02:28:26.883969 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:28:26.891171 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m02:28:26.891361 [debug] [MainThread]: On master: COMMIT
[0m02:28:26.891510 [debug] [MainThread]: Using duckdb connection "master"
[0m02:28:26.891650 [debug] [MainThread]: On master: COMMIT
[0m02:28:26.891880 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m02:28:26.892046 [debug] [MainThread]: On master: Close
[0m02:28:26.893745 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:28:26.893993 [info ] [MainThread]: 
[0m02:28:26.895583 [debug] [Thread-1 (]: Began running node model.vg_casestudy.stg_raw_staging__accounts
[0m02:28:26.895854 [info ] [Thread-1 (]: 1 of 11 START sql view model staging.stg_raw_staging__accounts ................. [RUN]
[0m02:28:26.896262 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.vg_casestudy.stg_raw_staging__accounts'
[0m02:28:26.896459 [debug] [Thread-1 (]: Began compiling node model.vg_casestudy.stg_raw_staging__accounts
[0m02:28:26.901643 [debug] [Thread-1 (]: Writing injected SQL for node "model.vg_casestudy.stg_raw_staging__accounts"
[0m02:28:26.902021 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.stg_raw_staging__accounts (compile): 02:28:26.896579 => 02:28:26.901905
[0m02:28:26.902232 [debug] [Thread-1 (]: Began executing node model.vg_casestudy.stg_raw_staging__accounts
[0m02:28:26.920650 [debug] [Thread-1 (]: Writing runtime sql for node "model.vg_casestudy.stg_raw_staging__accounts"
[0m02:28:26.921071 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_raw_staging__accounts"
[0m02:28:26.921275 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__accounts: BEGIN
[0m02:28:26.921442 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m02:28:26.930008 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:28:26.930258 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_raw_staging__accounts"
[0m02:28:26.930476 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__accounts: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_raw_staging__accounts"} */

  
  create view "casestudy"."staging"."stg_raw_staging__accounts__dbt_tmp" as (
    with source as (
    select * from "casestudy"."raw"."accounts"
),

renamed as (
    select
        account_id,
        customer_id,
        account_type,
        
CASE
    -- First try DD.MM.YYYY format (German format with dots)
    WHEN REGEXP_MATCHES(account_opening_date, '^\d{1,2}\.\d{1,2}\.\d{4}$') 
        THEN TRY_CAST(STRPTIME(account_opening_date, '%d.%m.%Y') AS DATE)
        
    -- Then try DD/MM/YYYY format (with slashes)
    WHEN REGEXP_MATCHES(account_opening_date, '^\d{1,2}/\d{1,2}/\d{4}$')
        AND CAST(SPLIT_PART(account_opening_date, '/', 1) AS INTEGER) <= 31 
        AND CAST(SPLIT_PART(account_opening_date, '/', 2) AS INTEGER) <= 12 
        THEN TRY_CAST(STRPTIME(account_opening_date, '%d/%m/%Y') AS DATE)
        
    -- Try MM/DD/YYYY format (US format with slashes)
    WHEN REGEXP_MATCHES(account_opening_date, '^\d{1,2}/\d{1,2}/\d{4}$')
        AND CAST(SPLIT_PART(account_opening_date, '/', 1) AS INTEGER) <= 12 
        THEN TRY_CAST(STRPTIME(account_opening_date, '%m/%d/%Y') AS DATE)
        
    -- Try YYYY-MM-DD format (ISO format)
    WHEN REGEXP_MATCHES(account_opening_date, '^\d{4}-\d{1,2}-\d{1,2}$')
        THEN TRY_CAST(STRPTIME(account_opening_date, '%Y-%m-%d') AS DATE)
        
    -- Try generic date parsing as last resort
    ELSE TRY_CAST(account_opening_date AS DATE)
END
 as account_opening_date,
        account_opening_date as account_opening_date_raw
    from source
    where account_type is not null and account_type != '' and account_type != '-'
),

final as (
    select
        account_id,
        customer_id,
        account_type,
        account_opening_date,
        -- Flag records with date parsing issues
        CASE WHEN account_opening_date IS NULL AND account_opening_date_raw IS NOT NULL
             THEN TRUE ELSE FALSE 
        END as has_date_parsing_error
    from renamed
)

select * from final
  );

[0m02:28:26.931481 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:28:26.971385 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_raw_staging__accounts"
[0m02:28:26.971666 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__accounts: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_raw_staging__accounts"} */
alter view "casestudy"."staging"."stg_raw_staging__accounts" rename to "stg_raw_staging__accounts__dbt_backup"
[0m02:28:26.972330 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:28:26.974061 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_raw_staging__accounts"
[0m02:28:26.974305 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__accounts: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_raw_staging__accounts"} */
alter view "casestudy"."staging"."stg_raw_staging__accounts__dbt_tmp" rename to "stg_raw_staging__accounts"
[0m02:28:26.974737 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:28:26.983867 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__accounts: COMMIT
[0m02:28:26.984097 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_raw_staging__accounts"
[0m02:28:26.984281 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__accounts: COMMIT
[0m02:28:26.986331 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:28:26.989025 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_raw_staging__accounts"
[0m02:28:26.989236 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__accounts: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_raw_staging__accounts"} */
drop view if exists "casestudy"."staging"."stg_raw_staging__accounts__dbt_backup" cascade
[0m02:28:26.990714 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:28:26.991528 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.stg_raw_staging__accounts (execute): 02:28:26.902355 => 02:28:26.991432
[0m02:28:26.991725 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__accounts: Close
[0m02:28:27.003690 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3aeec56f-ff13-44f7-96b5-c78c6b5fd01e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x740a702baf90>]}
[0m02:28:27.004042 [info ] [Thread-1 (]: 1 of 11 OK created sql view model staging.stg_raw_staging__accounts ............ [[32mOK[0m in 0.11s]
[0m02:28:27.004358 [debug] [Thread-1 (]: Finished running node model.vg_casestudy.stg_raw_staging__accounts
[0m02:28:27.004567 [debug] [Thread-1 (]: Began running node model.vg_casestudy.stg_raw_staging__customers
[0m02:28:27.004944 [info ] [Thread-1 (]: 2 of 11 START sql view model staging.stg_raw_staging__customers ................ [RUN]
[0m02:28:27.005305 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.vg_casestudy.stg_raw_staging__accounts, now model.vg_casestudy.stg_raw_staging__customers)
[0m02:28:27.005500 [debug] [Thread-1 (]: Began compiling node model.vg_casestudy.stg_raw_staging__customers
[0m02:28:27.007059 [debug] [Thread-1 (]: Writing injected SQL for node "model.vg_casestudy.stg_raw_staging__customers"
[0m02:28:27.007400 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.stg_raw_staging__customers (compile): 02:28:27.005618 => 02:28:27.007288
[0m02:28:27.007584 [debug] [Thread-1 (]: Began executing node model.vg_casestudy.stg_raw_staging__customers
[0m02:28:27.009570 [debug] [Thread-1 (]: Writing runtime sql for node "model.vg_casestudy.stg_raw_staging__customers"
[0m02:28:27.009872 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_raw_staging__customers"
[0m02:28:27.010056 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__customers: BEGIN
[0m02:28:27.010243 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:28:27.021644 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:28:27.022033 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_raw_staging__customers"
[0m02:28:27.022253 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__customers: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_raw_staging__customers"} */

  
  create view "casestudy"."staging"."stg_raw_staging__customers__dbt_tmp" as (
    with source as (
    select * from "casestudy"."raw"."customers"
),

renamed as (
    select distinct
        customer_id,
        trim(firstname) as firstname,
        trim(lastname) as lastname,
        Age as age,
        branch_id
    from source
)

select * from renamed
  );

[0m02:28:27.022925 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:28:27.025137 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_raw_staging__customers"
[0m02:28:27.025377 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__customers: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_raw_staging__customers"} */
alter view "casestudy"."staging"."stg_raw_staging__customers" rename to "stg_raw_staging__customers__dbt_backup"
[0m02:28:27.025732 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:28:27.027375 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_raw_staging__customers"
[0m02:28:27.027580 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__customers: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_raw_staging__customers"} */
alter view "casestudy"."staging"."stg_raw_staging__customers__dbt_tmp" rename to "stg_raw_staging__customers"
[0m02:28:27.028040 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:28:27.028909 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__customers: COMMIT
[0m02:28:27.029105 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_raw_staging__customers"
[0m02:28:27.029275 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__customers: COMMIT
[0m02:28:27.030657 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:28:27.032077 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_raw_staging__customers"
[0m02:28:27.032279 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__customers: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_raw_staging__customers"} */
drop view if exists "casestudy"."staging"."stg_raw_staging__customers__dbt_backup" cascade
[0m02:28:27.033161 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:28:27.033882 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.stg_raw_staging__customers (execute): 02:28:27.007703 => 02:28:27.033781
[0m02:28:27.034065 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__customers: Close
[0m02:28:27.044583 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3aeec56f-ff13-44f7-96b5-c78c6b5fd01e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x740a702c4c50>]}
[0m02:28:27.044938 [info ] [Thread-1 (]: 2 of 11 OK created sql view model staging.stg_raw_staging__customers ........... [[32mOK[0m in 0.04s]
[0m02:28:27.045251 [debug] [Thread-1 (]: Finished running node model.vg_casestudy.stg_raw_staging__customers
[0m02:28:27.045477 [debug] [Thread-1 (]: Began running node model.vg_casestudy.stg_raw_staging__fx_rates
[0m02:28:27.045765 [info ] [Thread-1 (]: 3 of 11 START sql view model staging.stg_raw_staging__fx_rates ................. [RUN]
[0m02:28:27.046169 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.vg_casestudy.stg_raw_staging__customers, now model.vg_casestudy.stg_raw_staging__fx_rates)
[0m02:28:27.046371 [debug] [Thread-1 (]: Began compiling node model.vg_casestudy.stg_raw_staging__fx_rates
[0m02:28:27.050106 [debug] [Thread-1 (]: Writing injected SQL for node "model.vg_casestudy.stg_raw_staging__fx_rates"
[0m02:28:27.050465 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.stg_raw_staging__fx_rates (compile): 02:28:27.046491 => 02:28:27.050351
[0m02:28:27.050649 [debug] [Thread-1 (]: Began executing node model.vg_casestudy.stg_raw_staging__fx_rates
[0m02:28:27.052603 [debug] [Thread-1 (]: Writing runtime sql for node "model.vg_casestudy.stg_raw_staging__fx_rates"
[0m02:28:27.052894 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_raw_staging__fx_rates"
[0m02:28:27.053071 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__fx_rates: BEGIN
[0m02:28:27.053249 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:28:27.060171 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:28:27.060492 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_raw_staging__fx_rates"
[0m02:28:27.060735 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__fx_rates: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_raw_staging__fx_rates"} */

  
  create view "casestudy"."staging"."stg_raw_staging__fx_rates__dbt_tmp" as (
    with source as (
    select * from "casestudy"."raw"."fx_rates"
),

renamed as (
    select
        trim(currency_iso_code) as currency_iso_code,
        
CASE
    WHEN fx_rate IS NULL THEN NULL
    -- If the value is already a valid number
    WHEN TRY_CAST(fx_rate AS DOUBLE) IS NOT NULL 
        THEN TRY_CAST(fx_rate AS DOUBLE)
    -- If contains both dot and comma (German notation)
    WHEN POSITION('.' IN fx_rate) > 0 AND POSITION(',' IN fx_rate) > 0 
        THEN TRY_CAST(REPLACE(REPLACE(TRIM(fx_rate), '.', ''), ',', '.') AS DOUBLE)
    -- If only contains comma, treat as decimal point
    WHEN POSITION(',' IN fx_rate) > 0 
        THEN TRY_CAST(REPLACE(TRIM(fx_rate), ',', '.') AS DOUBLE)
    -- If only contains dots, likely thousands separator
    WHEN POSITION('.' IN fx_rate) > 0 
        THEN TRY_CAST(REPLACE(TRIM(fx_rate), '.', '') AS DOUBLE)
    ELSE NULL
END
 as fx_rate,
        
CASE
    -- First try DD.MM.YYYY format (German format with dots)
    WHEN REGEXP_MATCHES(date, '^\d{1,2}\.\d{1,2}\.\d{4}$') 
        THEN TRY_CAST(STRPTIME(date, '%d.%m.%Y') AS DATE)
        
    -- Then try DD/MM/YYYY format (with slashes)
    WHEN REGEXP_MATCHES(date, '^\d{1,2}/\d{1,2}/\d{4}$')
        AND CAST(SPLIT_PART(date, '/', 1) AS INTEGER) <= 31 
        AND CAST(SPLIT_PART(date, '/', 2) AS INTEGER) <= 12 
        THEN TRY_CAST(STRPTIME(date, '%d/%m/%Y') AS DATE)
        
    -- Try MM/DD/YYYY format (US format with slashes)
    WHEN REGEXP_MATCHES(date, '^\d{1,2}/\d{1,2}/\d{4}$')
        AND CAST(SPLIT_PART(date, '/', 1) AS INTEGER) <= 12 
        THEN TRY_CAST(STRPTIME(date, '%m/%d/%Y') AS DATE)
        
    -- Try YYYY-MM-DD format (ISO format)
    WHEN REGEXP_MATCHES(date, '^\d{4}-\d{1,2}-\d{1,2}$')
        THEN TRY_CAST(STRPTIME(date, '%Y-%m-%d') AS DATE)
        
    -- Try generic date parsing as last resort
    ELSE TRY_CAST(date AS DATE)
END
 as fx_rate_date,
        date as fx_rate_date_raw
    from source
    where currency_iso_code is not null and trim(currency_iso_code) not in  ('(none)', '')
),

final as (
    select
        currency_iso_code,
        fx_rate,
        fx_rate_date,
        -- Flag records with date parsing issues
        CASE WHEN fx_rate_date IS NULL AND fx_rate_date_raw IS NOT NULL
             THEN TRUE ELSE FALSE 
        END as has_date_parsing_error
    from renamed
)

select * from final
  );

[0m02:28:27.062157 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:28:27.064223 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_raw_staging__fx_rates"
[0m02:28:27.064429 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__fx_rates: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_raw_staging__fx_rates"} */
alter view "casestudy"."staging"."stg_raw_staging__fx_rates" rename to "stg_raw_staging__fx_rates__dbt_backup"
[0m02:28:27.064794 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:28:27.066413 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_raw_staging__fx_rates"
[0m02:28:27.066613 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__fx_rates: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_raw_staging__fx_rates"} */
alter view "casestudy"."staging"."stg_raw_staging__fx_rates__dbt_tmp" rename to "stg_raw_staging__fx_rates"
[0m02:28:27.067137 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:28:27.067984 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__fx_rates: COMMIT
[0m02:28:27.068178 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_raw_staging__fx_rates"
[0m02:28:27.068344 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__fx_rates: COMMIT
[0m02:28:27.069752 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:28:27.071020 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_raw_staging__fx_rates"
[0m02:28:27.071224 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__fx_rates: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_raw_staging__fx_rates"} */
drop view if exists "casestudy"."staging"."stg_raw_staging__fx_rates__dbt_backup" cascade
[0m02:28:27.072101 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:28:27.072811 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.stg_raw_staging__fx_rates (execute): 02:28:27.050768 => 02:28:27.072714
[0m02:28:27.072995 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__fx_rates: Close
[0m02:28:27.084480 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3aeec56f-ff13-44f7-96b5-c78c6b5fd01e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x740a74536b10>]}
[0m02:28:27.085194 [info ] [Thread-1 (]: 3 of 11 OK created sql view model staging.stg_raw_staging__fx_rates ............ [[32mOK[0m in 0.04s]
[0m02:28:27.085686 [debug] [Thread-1 (]: Finished running node model.vg_casestudy.stg_raw_staging__fx_rates
[0m02:28:27.085973 [debug] [Thread-1 (]: Began running node model.vg_casestudy.stg_raw_staging__loans
[0m02:28:27.086379 [info ] [Thread-1 (]: 4 of 11 START sql view model staging.stg_raw_staging__loans .................... [RUN]
[0m02:28:27.086847 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.vg_casestudy.stg_raw_staging__fx_rates, now model.vg_casestudy.stg_raw_staging__loans)
[0m02:28:27.087092 [debug] [Thread-1 (]: Began compiling node model.vg_casestudy.stg_raw_staging__loans
[0m02:28:27.089224 [debug] [Thread-1 (]: Writing injected SQL for node "model.vg_casestudy.stg_raw_staging__loans"
[0m02:28:27.089577 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.stg_raw_staging__loans (compile): 02:28:27.087224 => 02:28:27.089460
[0m02:28:27.089756 [debug] [Thread-1 (]: Began executing node model.vg_casestudy.stg_raw_staging__loans
[0m02:28:27.091861 [debug] [Thread-1 (]: Writing runtime sql for node "model.vg_casestudy.stg_raw_staging__loans"
[0m02:28:27.092172 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_raw_staging__loans"
[0m02:28:27.092359 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__loans: BEGIN
[0m02:28:27.092519 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:28:27.100097 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:28:27.100397 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_raw_staging__loans"
[0m02:28:27.100665 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__loans: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_raw_staging__loans"} */

  
  create view "casestudy"."staging"."stg_raw_staging__loans__dbt_tmp" as (
    with source as (
    select * from "casestudy"."raw"."loans"
),

renamed as (
    select
        customer_id,
        loan_id,
        
CASE
    WHEN loan_amount IS NULL THEN NULL
    -- If the value is already a valid number
    WHEN TRY_CAST(loan_amount AS DOUBLE) IS NOT NULL 
        THEN TRY_CAST(loan_amount AS DOUBLE)
    -- If contains both dot and comma (German notation)
    WHEN POSITION('.' IN loan_amount) > 0 AND POSITION(',' IN loan_amount) > 0 
        THEN TRY_CAST(REPLACE(REPLACE(TRIM(loan_amount), '.', ''), ',', '.') AS DOUBLE)
    -- If only contains comma, treat as decimal point
    WHEN POSITION(',' IN loan_amount) > 0 
        THEN TRY_CAST(REPLACE(TRIM(loan_amount), ',', '.') AS DOUBLE)
    -- If only contains dots, likely thousands separator
    WHEN POSITION('.' IN loan_amount) > 0 
        THEN TRY_CAST(REPLACE(TRIM(loan_amount), '.', '') AS DOUBLE)
    ELSE NULL
END
 as loan_amount,
        loant_type,
        
CASE
    WHEN interest_rate IS NULL THEN NULL
    -- If the value is already a valid number
    WHEN TRY_CAST(interest_rate AS DOUBLE) IS NOT NULL 
        THEN TRY_CAST(interest_rate AS DOUBLE)
    -- If contains both dot and comma (German notation)
    WHEN POSITION('.' IN interest_rate) > 0 AND POSITION(',' IN interest_rate) > 0 
        THEN TRY_CAST(REPLACE(REPLACE(TRIM(interest_rate), '.', ''), ',', '.') AS DOUBLE)
    -- If only contains comma, treat as decimal point
    WHEN POSITION(',' IN interest_rate) > 0 
        THEN TRY_CAST(REPLACE(TRIM(interest_rate), ',', '.') AS DOUBLE)
    -- If only contains dots, likely thousands separator
    WHEN POSITION('.' IN interest_rate) > 0 
        THEN TRY_CAST(REPLACE(TRIM(interest_rate), '.', '') AS DOUBLE)
    ELSE NULL
END
 as interest_rate,
        loan_term,
        
CASE
    -- First try DD.MM.YYYY format (German format with dots)
    WHEN REGEXP_MATCHES(approval_rejection_date, '^\d{1,2}\.\d{1,2}\.\d{4}$') 
        THEN TRY_CAST(STRPTIME(approval_rejection_date, '%d.%m.%Y') AS DATE)
        
    -- Then try DD/MM/YYYY format (with slashes)
    WHEN REGEXP_MATCHES(approval_rejection_date, '^\d{1,2}/\d{1,2}/\d{4}$')
        AND CAST(SPLIT_PART(approval_rejection_date, '/', 1) AS INTEGER) <= 31 
        AND CAST(SPLIT_PART(approval_rejection_date, '/', 2) AS INTEGER) <= 12 
        THEN TRY_CAST(STRPTIME(approval_rejection_date, '%d/%m/%Y') AS DATE)
        
    -- Try MM/DD/YYYY format (US format with slashes)
    WHEN REGEXP_MATCHES(approval_rejection_date, '^\d{1,2}/\d{1,2}/\d{4}$')
        AND CAST(SPLIT_PART(approval_rejection_date, '/', 1) AS INTEGER) <= 12 
        THEN TRY_CAST(STRPTIME(approval_rejection_date, '%m/%d/%Y') AS DATE)
        
    -- Try YYYY-MM-DD format (ISO format)
    WHEN REGEXP_MATCHES(approval_rejection_date, '^\d{4}-\d{1,2}-\d{1,2}$')
        THEN TRY_CAST(STRPTIME(approval_rejection_date, '%Y-%m-%d') AS DATE)
        
    -- Try generic date parsing as last resort
    ELSE TRY_CAST(approval_rejection_date AS DATE)
END
 as approval_rejection_date,
        approval_rejection_date as approval_rejection_date_raw,
        loan_status
    from source
),

final as (
    select
        customer_id,
        loan_id,
        loan_amount,
        loant_type as loan_type,
        interest_rate,
        loan_term,
        approval_rejection_date,
        loan_status,
        -- Flag records with date parsing issues
        CASE WHEN approval_rejection_date IS NULL AND approval_rejection_date_raw IS NOT NULL
             THEN TRUE ELSE FALSE 
        END as has_date_parsing_error
    from renamed
)

select * from final
  );

[0m02:28:27.102116 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:28:27.104114 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_raw_staging__loans"
[0m02:28:27.104335 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__loans: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_raw_staging__loans"} */
alter view "casestudy"."staging"."stg_raw_staging__loans" rename to "stg_raw_staging__loans__dbt_backup"
[0m02:28:27.104708 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:28:27.106250 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_raw_staging__loans"
[0m02:28:27.106449 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__loans: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_raw_staging__loans"} */
alter view "casestudy"."staging"."stg_raw_staging__loans__dbt_tmp" rename to "stg_raw_staging__loans"
[0m02:28:27.106788 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:28:27.107682 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__loans: COMMIT
[0m02:28:27.107875 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_raw_staging__loans"
[0m02:28:27.108036 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__loans: COMMIT
[0m02:28:27.109810 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:28:27.112117 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_raw_staging__loans"
[0m02:28:27.112326 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__loans: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_raw_staging__loans"} */
drop view if exists "casestudy"."staging"."stg_raw_staging__loans__dbt_backup" cascade
[0m02:28:27.113266 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:28:27.113984 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.stg_raw_staging__loans (execute): 02:28:27.089873 => 02:28:27.113886
[0m02:28:27.114171 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__loans: Close
[0m02:28:27.125408 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3aeec56f-ff13-44f7-96b5-c78c6b5fd01e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x740a703b7ed0>]}
[0m02:28:27.125935 [info ] [Thread-1 (]: 4 of 11 OK created sql view model staging.stg_raw_staging__loans ............... [[32mOK[0m in 0.04s]
[0m02:28:27.126411 [debug] [Thread-1 (]: Finished running node model.vg_casestudy.stg_raw_staging__loans
[0m02:28:27.126661 [debug] [Thread-1 (]: Began running node model.vg_casestudy.stg_raw_staging__transactions
[0m02:28:27.126942 [info ] [Thread-1 (]: 5 of 11 START sql view model staging.stg_raw_staging__transactions ............. [RUN]
[0m02:28:27.127348 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.vg_casestudy.stg_raw_staging__loans, now model.vg_casestudy.stg_raw_staging__transactions)
[0m02:28:27.127528 [debug] [Thread-1 (]: Began compiling node model.vg_casestudy.stg_raw_staging__transactions
[0m02:28:27.129509 [debug] [Thread-1 (]: Writing injected SQL for node "model.vg_casestudy.stg_raw_staging__transactions"
[0m02:28:27.129851 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.stg_raw_staging__transactions (compile): 02:28:27.127640 => 02:28:27.129737
[0m02:28:27.130030 [debug] [Thread-1 (]: Began executing node model.vg_casestudy.stg_raw_staging__transactions
[0m02:28:27.132007 [debug] [Thread-1 (]: Writing runtime sql for node "model.vg_casestudy.stg_raw_staging__transactions"
[0m02:28:27.132306 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_raw_staging__transactions"
[0m02:28:27.132484 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__transactions: BEGIN
[0m02:28:27.132642 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:28:27.139475 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:28:27.139715 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_raw_staging__transactions"
[0m02:28:27.139953 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__transactions: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_raw_staging__transactions"} */

  
  create view "casestudy"."staging"."stg_raw_staging__transactions__dbt_tmp" as (
    with source as (
    select * from "casestudy"."raw"."transactions"
),

renamed as (
    select
        transaction_id,
        
CASE
    -- First try DD.MM.YYYY format (German format with dots)
    WHEN REGEXP_MATCHES(transaction_date, '^\d{1,2}\.\d{1,2}\.\d{4}$') 
        THEN TRY_CAST(STRPTIME(transaction_date, '%d.%m.%Y') AS DATE)
        
    -- Then try DD/MM/YYYY format (with slashes)
    WHEN REGEXP_MATCHES(transaction_date, '^\d{1,2}/\d{1,2}/\d{4}$')
        AND CAST(SPLIT_PART(transaction_date, '/', 1) AS INTEGER) <= 31 
        AND CAST(SPLIT_PART(transaction_date, '/', 2) AS INTEGER) <= 12 
        THEN TRY_CAST(STRPTIME(transaction_date, '%d/%m/%Y') AS DATE)
        
    -- Try MM/DD/YYYY format (US format with slashes)
    WHEN REGEXP_MATCHES(transaction_date, '^\d{1,2}/\d{1,2}/\d{4}$')
        AND CAST(SPLIT_PART(transaction_date, '/', 1) AS INTEGER) <= 12 
        THEN TRY_CAST(STRPTIME(transaction_date, '%m/%d/%Y') AS DATE)
        
    -- Try YYYY-MM-DD format (ISO format)
    WHEN REGEXP_MATCHES(transaction_date, '^\d{4}-\d{1,2}-\d{1,2}$')
        THEN TRY_CAST(STRPTIME(transaction_date, '%Y-%m-%d') AS DATE)
        
    -- Try generic date parsing as last resort
    ELSE TRY_CAST(transaction_date AS DATE)
END
 as transaction_date,
        transaction_date as transaction_date_raw,
        account_id,
        trim(transaction_type) as transaction_type,
        
CASE
    WHEN transaction_amount IS NULL THEN NULL
    -- If the value is already a valid number
    WHEN TRY_CAST(transaction_amount AS DOUBLE) IS NOT NULL 
        THEN TRY_CAST(transaction_amount AS DOUBLE)
    -- If contains both dot and comma (German notation)
    WHEN POSITION('.' IN transaction_amount) > 0 AND POSITION(',' IN transaction_amount) > 0 
        THEN TRY_CAST(REPLACE(REPLACE(TRIM(transaction_amount), '.', ''), ',', '.') AS DOUBLE)
    -- If only contains comma, treat as decimal point
    WHEN POSITION(',' IN transaction_amount) > 0 
        THEN TRY_CAST(REPLACE(TRIM(transaction_amount), ',', '.') AS DOUBLE)
    -- If only contains dots, likely thousands separator
    WHEN POSITION('.' IN transaction_amount) > 0 
        THEN TRY_CAST(REPLACE(TRIM(transaction_amount), '.', '') AS DOUBLE)
    ELSE NULL
END
 as transaction_amount,
        trim(transaction_currency) as transaction_currency
    from source
),

final as (
    select
        transaction_id,
        transaction_date,
        account_id,
        transaction_type,
        transaction_amount,
        transaction_currency,
        -- Flag records with date parsing issues
        CASE WHEN transaction_date IS NULL AND transaction_date_raw IS NOT NULL
             THEN TRUE ELSE FALSE 
        END as has_date_parsing_error
    from renamed
)

select * from final
  );

[0m02:28:27.141007 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:28:27.143016 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_raw_staging__transactions"
[0m02:28:27.143253 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__transactions: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_raw_staging__transactions"} */
alter view "casestudy"."staging"."stg_raw_staging__transactions" rename to "stg_raw_staging__transactions__dbt_backup"
[0m02:28:27.143696 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:28:27.145425 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_raw_staging__transactions"
[0m02:28:27.145630 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__transactions: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_raw_staging__transactions"} */
alter view "casestudy"."staging"."stg_raw_staging__transactions__dbt_tmp" rename to "stg_raw_staging__transactions"
[0m02:28:27.145970 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:28:27.146831 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__transactions: COMMIT
[0m02:28:27.147022 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_raw_staging__transactions"
[0m02:28:27.147193 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__transactions: COMMIT
[0m02:28:27.149225 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:28:27.150558 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_raw_staging__transactions"
[0m02:28:27.150754 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__transactions: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_raw_staging__transactions"} */
drop view if exists "casestudy"."staging"."stg_raw_staging__transactions__dbt_backup" cascade
[0m02:28:27.151631 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:28:27.152353 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.stg_raw_staging__transactions (execute): 02:28:27.130158 => 02:28:27.152257
[0m02:28:27.152540 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__transactions: Close
[0m02:28:27.164850 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3aeec56f-ff13-44f7-96b5-c78c6b5fd01e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x740a703bef90>]}
[0m02:28:27.165377 [info ] [Thread-1 (]: 5 of 11 OK created sql view model staging.stg_raw_staging__transactions ........ [[32mOK[0m in 0.04s]
[0m02:28:27.165809 [debug] [Thread-1 (]: Finished running node model.vg_casestudy.stg_raw_staging__transactions
[0m02:28:27.166118 [debug] [Thread-1 (]: Began running node model.vg_casestudy.stg_staging_intermediate__currencies
[0m02:28:27.166541 [info ] [Thread-1 (]: 6 of 11 START sql table model intermediate.stg_staging_intermediate__currencies  [RUN]
[0m02:28:27.166907 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.vg_casestudy.stg_raw_staging__transactions, now model.vg_casestudy.stg_staging_intermediate__currencies)
[0m02:28:27.167102 [debug] [Thread-1 (]: Began compiling node model.vg_casestudy.stg_staging_intermediate__currencies
[0m02:28:27.168795 [debug] [Thread-1 (]: Writing injected SQL for node "model.vg_casestudy.stg_staging_intermediate__currencies"
[0m02:28:27.169144 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.stg_staging_intermediate__currencies (compile): 02:28:27.167238 => 02:28:27.169022
[0m02:28:27.169330 [debug] [Thread-1 (]: Began executing node model.vg_casestudy.stg_staging_intermediate__currencies
[0m02:28:27.179730 [debug] [Thread-1 (]: Writing runtime sql for node "model.vg_casestudy.stg_staging_intermediate__currencies"
[0m02:28:27.180105 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__currencies"
[0m02:28:27.180316 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__currencies: BEGIN
[0m02:28:27.180489 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:28:27.187886 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:28:27.188153 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__currencies"
[0m02:28:27.188344 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__currencies: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_staging_intermediate__currencies"} */

  
    
    

    create  table
      "casestudy"."intermediate"."stg_staging_intermediate__currencies__dbt_tmp"
  
    as (
      with staging as (
    select * from "casestudy"."raw"."currencies"
),
cleaned as (
    select distinct
        trim(currency) as currency,
        trim(currency_iso_code) as currency_iso_code,
    from staging
    where currency_iso_code is not null and trim(currency_iso_code) != '(none)'
)

select * from cleaned
    );
  
  
[0m02:28:27.190506 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:28:27.192295 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__currencies"
[0m02:28:27.192501 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__currencies: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_staging_intermediate__currencies"} */
alter table "casestudy"."intermediate"."stg_staging_intermediate__currencies" rename to "stg_staging_intermediate__currencies__dbt_backup"
[0m02:28:27.192836 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:28:27.195272 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__currencies"
[0m02:28:27.195478 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__currencies: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_staging_intermediate__currencies"} */
alter table "casestudy"."intermediate"."stg_staging_intermediate__currencies__dbt_tmp" rename to "stg_staging_intermediate__currencies"
[0m02:28:27.195889 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:28:27.198766 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__currencies: COMMIT
[0m02:28:27.198973 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__currencies"
[0m02:28:27.199159 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__currencies: COMMIT
[0m02:28:27.200552 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:28:27.201857 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__currencies"
[0m02:28:27.202055 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__currencies: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_staging_intermediate__currencies"} */
drop table if exists "casestudy"."intermediate"."stg_staging_intermediate__currencies__dbt_backup" cascade
[0m02:28:27.203010 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:28:27.203717 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.stg_staging_intermediate__currencies (execute): 02:28:27.169448 => 02:28:27.203621
[0m02:28:27.203903 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__currencies: Close
[0m02:28:27.217949 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3aeec56f-ff13-44f7-96b5-c78c6b5fd01e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x740a70074390>]}
[0m02:28:27.218318 [info ] [Thread-1 (]: 6 of 11 OK created sql table model intermediate.stg_staging_intermediate__currencies  [[32mOK[0m in 0.05s]
[0m02:28:27.218619 [debug] [Thread-1 (]: Finished running node model.vg_casestudy.stg_staging_intermediate__currencies
[0m02:28:27.218828 [debug] [Thread-1 (]: Began running node model.vg_casestudy.stg_staging_intermediate__accounts
[0m02:28:27.219130 [info ] [Thread-1 (]: 7 of 11 START sql table model intermediate.stg_staging_intermediate__accounts .. [RUN]
[0m02:28:27.219459 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.vg_casestudy.stg_staging_intermediate__currencies, now model.vg_casestudy.stg_staging_intermediate__accounts)
[0m02:28:27.219646 [debug] [Thread-1 (]: Began compiling node model.vg_casestudy.stg_staging_intermediate__accounts
[0m02:28:27.221303 [debug] [Thread-1 (]: Writing injected SQL for node "model.vg_casestudy.stg_staging_intermediate__accounts"
[0m02:28:27.221641 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.stg_staging_intermediate__accounts (compile): 02:28:27.219763 => 02:28:27.221529
[0m02:28:27.221821 [debug] [Thread-1 (]: Began executing node model.vg_casestudy.stg_staging_intermediate__accounts
[0m02:28:27.223796 [debug] [Thread-1 (]: Writing runtime sql for node "model.vg_casestudy.stg_staging_intermediate__accounts"
[0m02:28:27.224088 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__accounts"
[0m02:28:27.224287 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__accounts: BEGIN
[0m02:28:27.224450 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:28:27.231737 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:28:27.232110 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__accounts"
[0m02:28:27.232365 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__accounts: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_staging_intermediate__accounts"} */

  
    
    

    create  table
      "casestudy"."intermediate"."stg_staging_intermediate__accounts__dbt_tmp"
  
    as (
      with staging as (
    select * from "casestudy"."staging"."stg_raw_staging__accounts"
), 
filtered as (
    select 
        account_id,
        customer_id,
        account_type,
        account_opening_date,
     from staging
    where not has_date_parsing_error
)

select * from filtered
    );
  
  
[0m02:28:27.236328 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:28:27.238421 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__accounts"
[0m02:28:27.238636 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__accounts: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_staging_intermediate__accounts"} */
alter table "casestudy"."intermediate"."stg_staging_intermediate__accounts" rename to "stg_staging_intermediate__accounts__dbt_backup"
[0m02:28:27.238992 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:28:27.240584 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__accounts"
[0m02:28:27.240797 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__accounts: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_staging_intermediate__accounts"} */
alter table "casestudy"."intermediate"."stg_staging_intermediate__accounts__dbt_tmp" rename to "stg_staging_intermediate__accounts"
[0m02:28:27.241191 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:28:27.242155 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__accounts: COMMIT
[0m02:28:27.242357 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__accounts"
[0m02:28:27.242536 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__accounts: COMMIT
[0m02:28:27.244038 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:28:27.245385 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__accounts"
[0m02:28:27.245587 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__accounts: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_staging_intermediate__accounts"} */
drop table if exists "casestudy"."intermediate"."stg_staging_intermediate__accounts__dbt_backup" cascade
[0m02:28:27.246521 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:28:27.247292 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.stg_staging_intermediate__accounts (execute): 02:28:27.221935 => 02:28:27.247188
[0m02:28:27.247489 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__accounts: Close
[0m02:28:27.259816 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3aeec56f-ff13-44f7-96b5-c78c6b5fd01e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x740a70427710>]}
[0m02:28:27.260238 [info ] [Thread-1 (]: 7 of 11 OK created sql table model intermediate.stg_staging_intermediate__accounts  [[32mOK[0m in 0.04s]
[0m02:28:27.260558 [debug] [Thread-1 (]: Finished running node model.vg_casestudy.stg_staging_intermediate__accounts
[0m02:28:27.260790 [debug] [Thread-1 (]: Began running node model.vg_casestudy.stg_staging_intermediate__customers
[0m02:28:27.261101 [info ] [Thread-1 (]: 8 of 11 START sql table model intermediate.stg_staging_intermediate__customers . [RUN]
[0m02:28:27.261467 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.vg_casestudy.stg_staging_intermediate__accounts, now model.vg_casestudy.stg_staging_intermediate__customers)
[0m02:28:27.261672 [debug] [Thread-1 (]: Began compiling node model.vg_casestudy.stg_staging_intermediate__customers
[0m02:28:27.263528 [debug] [Thread-1 (]: Writing injected SQL for node "model.vg_casestudy.stg_staging_intermediate__customers"
[0m02:28:27.263908 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.stg_staging_intermediate__customers (compile): 02:28:27.261796 => 02:28:27.263785
[0m02:28:27.264089 [debug] [Thread-1 (]: Began executing node model.vg_casestudy.stg_staging_intermediate__customers
[0m02:28:27.266187 [debug] [Thread-1 (]: Writing runtime sql for node "model.vg_casestudy.stg_staging_intermediate__customers"
[0m02:28:27.266495 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__customers"
[0m02:28:27.266689 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__customers: BEGIN
[0m02:28:27.266877 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:28:27.274276 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:28:27.274519 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__customers"
[0m02:28:27.274708 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__customers: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_staging_intermediate__customers"} */

  
    
    

    create  table
      "casestudy"."intermediate"."stg_staging_intermediate__customers__dbt_tmp"
  
    as (
      with staging as (
    select * from "casestudy"."staging"."stg_raw_staging__customers"
)

select * from staging
    );
  
  
[0m02:28:27.279828 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:28:27.282751 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__customers"
[0m02:28:27.282966 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__customers: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_staging_intermediate__customers"} */
alter table "casestudy"."intermediate"."stg_staging_intermediate__customers" rename to "stg_staging_intermediate__customers__dbt_backup"
[0m02:28:27.283332 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:28:27.284903 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__customers"
[0m02:28:27.285114 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__customers: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_staging_intermediate__customers"} */
alter table "casestudy"."intermediate"."stg_staging_intermediate__customers__dbt_tmp" rename to "stg_staging_intermediate__customers"
[0m02:28:27.285501 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:28:27.286458 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__customers: COMMIT
[0m02:28:27.286657 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__customers"
[0m02:28:27.286829 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__customers: COMMIT
[0m02:28:27.288684 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:28:27.290111 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__customers"
[0m02:28:27.290377 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__customers: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_staging_intermediate__customers"} */
drop table if exists "casestudy"."intermediate"."stg_staging_intermediate__customers__dbt_backup" cascade
[0m02:28:27.291695 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:28:27.292474 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.stg_staging_intermediate__customers (execute): 02:28:27.264217 => 02:28:27.292375
[0m02:28:27.292671 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__customers: Close
[0m02:28:27.311926 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3aeec56f-ff13-44f7-96b5-c78c6b5fd01e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x740a70095ed0>]}
[0m02:28:27.312353 [info ] [Thread-1 (]: 8 of 11 OK created sql table model intermediate.stg_staging_intermediate__customers  [[32mOK[0m in 0.05s]
[0m02:28:27.312669 [debug] [Thread-1 (]: Finished running node model.vg_casestudy.stg_staging_intermediate__customers
[0m02:28:27.312889 [debug] [Thread-1 (]: Began running node model.vg_casestudy.stg_staging_intermediate__fx_rates
[0m02:28:27.313188 [info ] [Thread-1 (]: 9 of 11 START sql table model intermediate.stg_staging_intermediate__fx_rates .. [RUN]
[0m02:28:27.313541 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.vg_casestudy.stg_staging_intermediate__customers, now model.vg_casestudy.stg_staging_intermediate__fx_rates)
[0m02:28:27.313733 [debug] [Thread-1 (]: Began compiling node model.vg_casestudy.stg_staging_intermediate__fx_rates
[0m02:28:27.315456 [debug] [Thread-1 (]: Writing injected SQL for node "model.vg_casestudy.stg_staging_intermediate__fx_rates"
[0m02:28:27.315800 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.stg_staging_intermediate__fx_rates (compile): 02:28:27.313851 => 02:28:27.315686
[0m02:28:27.315983 [debug] [Thread-1 (]: Began executing node model.vg_casestudy.stg_staging_intermediate__fx_rates
[0m02:28:27.317996 [debug] [Thread-1 (]: Writing runtime sql for node "model.vg_casestudy.stg_staging_intermediate__fx_rates"
[0m02:28:27.318298 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__fx_rates"
[0m02:28:27.318478 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__fx_rates: BEGIN
[0m02:28:27.318640 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:28:27.326050 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:28:27.326380 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__fx_rates"
[0m02:28:27.326598 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__fx_rates: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_staging_intermediate__fx_rates"} */

  
    
    

    create  table
      "casestudy"."intermediate"."stg_staging_intermediate__fx_rates__dbt_tmp"
  
    as (
      with staging as (
    select * from "casestudy"."staging"."stg_raw_staging__fx_rates"
),

filtered as (
    select
        currency_iso_code,
        fx_rate,
        fx_rate_date
    from staging
    where not has_date_parsing_error
)

select * from filtered
    );
  
  
[0m02:28:27.328999 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:28:27.330871 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__fx_rates"
[0m02:28:27.331080 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__fx_rates: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_staging_intermediate__fx_rates"} */
alter table "casestudy"."intermediate"."stg_staging_intermediate__fx_rates" rename to "stg_staging_intermediate__fx_rates__dbt_backup"
[0m02:28:27.331498 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:28:27.333080 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__fx_rates"
[0m02:28:27.333295 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__fx_rates: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_staging_intermediate__fx_rates"} */
alter table "casestudy"."intermediate"."stg_staging_intermediate__fx_rates__dbt_tmp" rename to "stg_staging_intermediate__fx_rates"
[0m02:28:27.333628 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:28:27.334583 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__fx_rates: COMMIT
[0m02:28:27.334782 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__fx_rates"
[0m02:28:27.334954 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__fx_rates: COMMIT
[0m02:28:27.336413 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:28:27.337792 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__fx_rates"
[0m02:28:27.337994 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__fx_rates: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_staging_intermediate__fx_rates"} */
drop table if exists "casestudy"."intermediate"."stg_staging_intermediate__fx_rates__dbt_backup" cascade
[0m02:28:27.339192 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:28:27.339927 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.stg_staging_intermediate__fx_rates (execute): 02:28:27.316100 => 02:28:27.339828
[0m02:28:27.340119 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__fx_rates: Close
[0m02:28:27.352291 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3aeec56f-ff13-44f7-96b5-c78c6b5fd01e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x740a70559110>]}
[0m02:28:27.352684 [info ] [Thread-1 (]: 9 of 11 OK created sql table model intermediate.stg_staging_intermediate__fx_rates  [[32mOK[0m in 0.04s]
[0m02:28:27.352987 [debug] [Thread-1 (]: Finished running node model.vg_casestudy.stg_staging_intermediate__fx_rates
[0m02:28:27.353207 [debug] [Thread-1 (]: Began running node model.vg_casestudy.stg_staging_intermediate__loans
[0m02:28:27.353498 [info ] [Thread-1 (]: 10 of 11 START sql table model intermediate.stg_staging_intermediate__loans .... [RUN]
[0m02:28:27.353840 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.vg_casestudy.stg_staging_intermediate__fx_rates, now model.vg_casestudy.stg_staging_intermediate__loans)
[0m02:28:27.354029 [debug] [Thread-1 (]: Began compiling node model.vg_casestudy.stg_staging_intermediate__loans
[0m02:28:27.355741 [debug] [Thread-1 (]: Writing injected SQL for node "model.vg_casestudy.stg_staging_intermediate__loans"
[0m02:28:27.356079 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.stg_staging_intermediate__loans (compile): 02:28:27.354158 => 02:28:27.355965
[0m02:28:27.356268 [debug] [Thread-1 (]: Began executing node model.vg_casestudy.stg_staging_intermediate__loans
[0m02:28:27.359332 [debug] [Thread-1 (]: Writing runtime sql for node "model.vg_casestudy.stg_staging_intermediate__loans"
[0m02:28:27.359629 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__loans"
[0m02:28:27.359808 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__loans: BEGIN
[0m02:28:27.359968 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:28:27.366972 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:28:27.367216 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__loans"
[0m02:28:27.367409 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__loans: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_staging_intermediate__loans"} */

  
    
    

    create  table
      "casestudy"."intermediate"."stg_staging_intermediate__loans__dbt_tmp"
  
    as (
      with staging as (
    select * from "casestudy"."staging"."stg_raw_staging__loans"
),

filtered as (
    select
        customer_id,
        loan_id,
        loan_amount,
        loan_type,
        interest_rate,
        loan_term,
        approval_rejection_date,
        loan_status
    from staging
    where not has_date_parsing_error
)

select * from filtered
    );
  
  
[0m02:28:27.376255 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:28:27.378504 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__loans"
[0m02:28:27.378753 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__loans: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_staging_intermediate__loans"} */
alter table "casestudy"."intermediate"."stg_staging_intermediate__loans" rename to "stg_staging_intermediate__loans__dbt_backup"
[0m02:28:27.379158 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:28:27.380754 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__loans"
[0m02:28:27.380959 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__loans: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_staging_intermediate__loans"} */
alter table "casestudy"."intermediate"."stg_staging_intermediate__loans__dbt_tmp" rename to "stg_staging_intermediate__loans"
[0m02:28:27.381301 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:28:27.382252 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__loans: COMMIT
[0m02:28:27.382462 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__loans"
[0m02:28:27.382637 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__loans: COMMIT
[0m02:28:27.384456 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:28:27.385853 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__loans"
[0m02:28:27.386058 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__loans: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_staging_intermediate__loans"} */
drop table if exists "casestudy"."intermediate"."stg_staging_intermediate__loans__dbt_backup" cascade
[0m02:28:27.386972 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:28:27.387697 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.stg_staging_intermediate__loans (execute): 02:28:27.356385 => 02:28:27.387600
[0m02:28:27.387889 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__loans: Close
[0m02:28:27.401998 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3aeec56f-ff13-44f7-96b5-c78c6b5fd01e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x740a70076c50>]}
[0m02:28:27.402403 [info ] [Thread-1 (]: 10 of 11 OK created sql table model intermediate.stg_staging_intermediate__loans  [[32mOK[0m in 0.05s]
[0m02:28:27.402709 [debug] [Thread-1 (]: Finished running node model.vg_casestudy.stg_staging_intermediate__loans
[0m02:28:27.402924 [debug] [Thread-1 (]: Began running node model.vg_casestudy.stg_staging_intermediate__transactions
[0m02:28:27.403217 [info ] [Thread-1 (]: 11 of 11 START sql table model intermediate.stg_staging_intermediate__transactions  [RUN]
[0m02:28:27.403551 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.vg_casestudy.stg_staging_intermediate__loans, now model.vg_casestudy.stg_staging_intermediate__transactions)
[0m02:28:27.403741 [debug] [Thread-1 (]: Began compiling node model.vg_casestudy.stg_staging_intermediate__transactions
[0m02:28:27.405445 [debug] [Thread-1 (]: Writing injected SQL for node "model.vg_casestudy.stg_staging_intermediate__transactions"
[0m02:28:27.405793 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.stg_staging_intermediate__transactions (compile): 02:28:27.403858 => 02:28:27.405679
[0m02:28:27.405971 [debug] [Thread-1 (]: Began executing node model.vg_casestudy.stg_staging_intermediate__transactions
[0m02:28:27.407899 [debug] [Thread-1 (]: Writing runtime sql for node "model.vg_casestudy.stg_staging_intermediate__transactions"
[0m02:28:27.408209 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__transactions"
[0m02:28:27.408395 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__transactions: BEGIN
[0m02:28:27.408554 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:28:27.416330 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:28:27.416658 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__transactions"
[0m02:28:27.416861 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__transactions: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_staging_intermediate__transactions"} */

  
    
    

    create  table
      "casestudy"."intermediate"."stg_staging_intermediate__transactions__dbt_tmp"
  
    as (
      with staging as (
    select * from "casestudy"."staging"."stg_raw_staging__transactions"
),

filtered as (
    select
        transaction_id,
        transaction_date,
        account_id,
        transaction_type,
        transaction_amount,
        transaction_currency
    from staging
    where not has_date_parsing_error
)

select * from filtered
    );
  
  
[0m02:28:27.455847 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:28:27.458099 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__transactions"
[0m02:28:27.458324 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__transactions: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_staging_intermediate__transactions"} */
alter table "casestudy"."intermediate"."stg_staging_intermediate__transactions" rename to "stg_staging_intermediate__transactions__dbt_backup"
[0m02:28:27.458760 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:28:27.460480 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__transactions"
[0m02:28:27.460775 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__transactions: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_staging_intermediate__transactions"} */
alter table "casestudy"."intermediate"."stg_staging_intermediate__transactions__dbt_tmp" rename to "stg_staging_intermediate__transactions"
[0m02:28:27.461232 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:28:27.462253 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__transactions: COMMIT
[0m02:28:27.462449 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__transactions"
[0m02:28:27.462617 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__transactions: COMMIT
[0m02:28:27.467662 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:28:27.469100 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__transactions"
[0m02:28:27.469309 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__transactions: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_staging_intermediate__transactions"} */
drop table if exists "casestudy"."intermediate"."stg_staging_intermediate__transactions__dbt_backup" cascade
[0m02:28:27.470257 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:28:27.471001 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.stg_staging_intermediate__transactions (execute): 02:28:27.406085 => 02:28:27.470903
[0m02:28:27.471194 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__transactions: Close
[0m02:28:27.494900 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3aeec56f-ff13-44f7-96b5-c78c6b5fd01e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x740a70077850>]}
[0m02:28:27.495278 [info ] [Thread-1 (]: 11 of 11 OK created sql table model intermediate.stg_staging_intermediate__transactions  [[32mOK[0m in 0.09s]
[0m02:28:27.495577 [debug] [Thread-1 (]: Finished running node model.vg_casestudy.stg_staging_intermediate__transactions
[0m02:28:27.496658 [debug] [MainThread]: Using duckdb connection "master"
[0m02:28:27.496834 [debug] [MainThread]: On master: BEGIN
[0m02:28:27.496974 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:28:27.504383 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m02:28:27.504584 [debug] [MainThread]: On master: COMMIT
[0m02:28:27.504731 [debug] [MainThread]: Using duckdb connection "master"
[0m02:28:27.504867 [debug] [MainThread]: On master: COMMIT
[0m02:28:27.505183 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m02:28:27.505350 [debug] [MainThread]: On master: Close
[0m02:28:27.506805 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:28:27.506983 [debug] [MainThread]: Connection 'list_casestudy_intermediate' was properly closed.
[0m02:28:27.507121 [debug] [MainThread]: Connection 'model.vg_casestudy.stg_staging_intermediate__transactions' was properly closed.
[0m02:28:27.507346 [info ] [MainThread]: 
[0m02:28:27.507523 [info ] [MainThread]: Finished running 5 view models, 6 table models in 0 hours 0 minutes and 0.77 seconds (0.77s).
[0m02:28:27.508433 [debug] [MainThread]: Command end result
[0m02:28:27.519635 [info ] [MainThread]: 
[0m02:28:27.519924 [info ] [MainThread]: [32mCompleted successfully[0m
[0m02:28:27.520090 [info ] [MainThread]: 
[0m02:28:27.520262 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=0 SKIP=0 TOTAL=11
[0m02:28:27.520519 [debug] [MainThread]: Command `dbt run` succeeded at 02:28:27.520460 after 0.91 seconds
[0m02:28:27.520712 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x740a7909da50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x740a7909c990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x740a7909dbd0>]}
[0m02:28:27.520899 [debug] [MainThread]: Flushing usage events
[0m02:30:08.370277 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c7a2fe22050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c7a3015bb10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c7a301921d0>]}


============================== 02:30:08.373198 | f9c6553f-5fe9-4ba1-91f8-90d6cbeef8c8 ==============================
[0m02:30:08.373198 [info ] [MainThread]: Running with dbt=1.6.18
[0m02:30:08.373791 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/workspaces/varengold_data_analyst_case/transformation/logs', 'profiles_dir': '/workspaces/varengold_data_analyst_case/transformation', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --full-refresh', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m02:30:08.431087 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f9c6553f-5fe9-4ba1-91f8-90d6cbeef8c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c7a3017d9d0>]}
[0m02:30:08.439068 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f9c6553f-5fe9-4ba1-91f8-90d6cbeef8c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c7a2fe38910>]}
[0m02:30:08.439522 [info ] [MainThread]: Registered adapter: duckdb=1.6.2
[0m02:30:08.452314 [debug] [MainThread]: checksum: 7b9fab86a08e9e96a48a825af743c566d95b877e068b8c6d0dbafbf714447189, vars: {}, profile: , target: , version: 1.6.18
[0m02:30:08.474361 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m02:30:08.474642 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m02:30:08.475348 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.vg_casestudy.reporting
- models.vg_casestudy.marts
- models.vg_casestudy.main
[0m02:30:08.479227 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f9c6553f-5fe9-4ba1-91f8-90d6cbeef8c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c7a2fbc8350>]}
[0m02:30:08.494021 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f9c6553f-5fe9-4ba1-91f8-90d6cbeef8c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c7a2c4d2850>]}
[0m02:30:08.494400 [info ] [MainThread]: Found 11 models, 1 analysis, 2 seeds, 71 tests, 5 sources, 0 exposures, 0 metrics, 632 macros, 0 groups, 0 semantic models
[0m02:30:08.494601 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f9c6553f-5fe9-4ba1-91f8-90d6cbeef8c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c7a2b97bd50>]}
[0m02:30:08.496366 [info ] [MainThread]: 
[0m02:30:08.496819 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m02:30:08.498164 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_casestudy'
[0m02:30:08.511218 [debug] [ThreadPool]: Using duckdb connection "list_casestudy"
[0m02:30:08.511459 [debug] [ThreadPool]: On list_casestudy: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"casestudy"'
    
  
  
[0m02:30:08.511628 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:30:08.521724 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m02:30:08.522630 [debug] [ThreadPool]: On list_casestudy: Close
[0m02:30:08.526828 [debug] [ThreadPool]: Using duckdb connection "list_casestudy"
[0m02:30:08.527145 [debug] [ThreadPool]: On list_casestudy: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"casestudy"'
    
  
  
[0m02:30:08.527345 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:30:08.534731 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m02:30:08.535548 [debug] [ThreadPool]: On list_casestudy: Close
[0m02:30:08.538415 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy, now create_casestudy_intermediate)
[0m02:30:08.538937 [debug] [ThreadPool]: Creating schema "database: "casestudy"
schema: "intermediate"
"
[0m02:30:08.541668 [debug] [ThreadPool]: Using duckdb connection "create_casestudy_intermediate"
[0m02:30:08.541854 [debug] [ThreadPool]: On create_casestudy_intermediate: BEGIN
[0m02:30:08.541995 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:30:08.548718 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m02:30:08.548913 [debug] [ThreadPool]: Using duckdb connection "create_casestudy_intermediate"
[0m02:30:08.549067 [debug] [ThreadPool]: On create_casestudy_intermediate: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "create_casestudy_intermediate"} */
create schema if not exists "casestudy"."intermediate"
[0m02:30:08.549412 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m02:30:08.549905 [debug] [ThreadPool]: On create_casestudy_intermediate: COMMIT
[0m02:30:08.550069 [debug] [ThreadPool]: Using duckdb connection "create_casestudy_intermediate"
[0m02:30:08.550218 [debug] [ThreadPool]: On create_casestudy_intermediate: COMMIT
[0m02:30:08.550460 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m02:30:08.550621 [debug] [ThreadPool]: On create_casestudy_intermediate: Close
[0m02:30:08.552510 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_casestudy_intermediate, now create_casestudy_staging)
[0m02:30:08.552898 [debug] [ThreadPool]: Creating schema "database: "casestudy"
schema: "staging"
"
[0m02:30:08.554388 [debug] [ThreadPool]: Using duckdb connection "create_casestudy_staging"
[0m02:30:08.554906 [debug] [ThreadPool]: On create_casestudy_staging: BEGIN
[0m02:30:08.555174 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:30:08.561856 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m02:30:08.562048 [debug] [ThreadPool]: Using duckdb connection "create_casestudy_staging"
[0m02:30:08.562210 [debug] [ThreadPool]: On create_casestudy_staging: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "create_casestudy_staging"} */
create schema if not exists "casestudy"."staging"
[0m02:30:08.562491 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m02:30:08.562983 [debug] [ThreadPool]: On create_casestudy_staging: COMMIT
[0m02:30:08.563152 [debug] [ThreadPool]: Using duckdb connection "create_casestudy_staging"
[0m02:30:08.563295 [debug] [ThreadPool]: On create_casestudy_staging: COMMIT
[0m02:30:08.563537 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m02:30:08.563705 [debug] [ThreadPool]: On create_casestudy_staging: Close
[0m02:30:08.566593 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_casestudy_staging, now list_casestudy_intermediate)
[0m02:30:08.572175 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_intermediate"
[0m02:30:08.572357 [debug] [ThreadPool]: On list_casestudy_intermediate: BEGIN
[0m02:30:08.572500 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:30:08.578954 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m02:30:08.579147 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_intermediate"
[0m02:30:08.579306 [debug] [ThreadPool]: On list_casestudy_intermediate: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_intermediate"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'intermediate'
    and table_catalog = 'casestudy'
  
[0m02:30:08.586172 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m02:30:08.586950 [debug] [ThreadPool]: On list_casestudy_intermediate: ROLLBACK
[0m02:30:08.587388 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_intermediate'
[0m02:30:08.587555 [debug] [ThreadPool]: On list_casestudy_intermediate: Close
[0m02:30:08.590271 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy_intermediate, now list_casestudy_raw)
[0m02:30:08.593699 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_raw"
[0m02:30:08.594041 [debug] [ThreadPool]: On list_casestudy_raw: BEGIN
[0m02:30:08.594326 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:30:08.603506 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m02:30:08.603748 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_raw"
[0m02:30:08.603917 [debug] [ThreadPool]: On list_casestudy_raw: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_raw"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'raw'
    and table_catalog = 'casestudy'
  
[0m02:30:08.609661 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m02:30:08.610445 [debug] [ThreadPool]: On list_casestudy_raw: ROLLBACK
[0m02:30:08.610733 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_raw'
[0m02:30:08.610894 [debug] [ThreadPool]: On list_casestudy_raw: Close
[0m02:30:08.612942 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy_raw, now list_casestudy_staging)
[0m02:30:08.615566 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_staging"
[0m02:30:08.615737 [debug] [ThreadPool]: On list_casestudy_staging: BEGIN
[0m02:30:08.615875 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:30:08.622815 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m02:30:08.623004 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_staging"
[0m02:30:08.623169 [debug] [ThreadPool]: On list_casestudy_staging: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_staging"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'staging'
    and table_catalog = 'casestudy'
  
[0m02:30:08.629909 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m02:30:08.630612 [debug] [ThreadPool]: On list_casestudy_staging: ROLLBACK
[0m02:30:08.630864 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_staging'
[0m02:30:08.631011 [debug] [ThreadPool]: On list_casestudy_staging: Close
[0m02:30:08.633982 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f9c6553f-5fe9-4ba1-91f8-90d6cbeef8c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c7a3016d590>]}
[0m02:30:08.634541 [debug] [MainThread]: Using duckdb connection "master"
[0m02:30:08.634889 [debug] [MainThread]: On master: BEGIN
[0m02:30:08.635220 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:30:08.643064 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m02:30:08.643268 [debug] [MainThread]: On master: COMMIT
[0m02:30:08.643421 [debug] [MainThread]: Using duckdb connection "master"
[0m02:30:08.643564 [debug] [MainThread]: On master: COMMIT
[0m02:30:08.643789 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m02:30:08.643951 [debug] [MainThread]: On master: Close
[0m02:30:08.645310 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:30:08.645514 [info ] [MainThread]: 
[0m02:30:08.646997 [debug] [Thread-1 (]: Began running node model.vg_casestudy.stg_raw_staging__accounts
[0m02:30:08.647545 [info ] [Thread-1 (]: 1 of 11 START sql view model staging.stg_raw_staging__accounts ................. [RUN]
[0m02:30:08.648402 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.vg_casestudy.stg_raw_staging__accounts'
[0m02:30:08.648892 [debug] [Thread-1 (]: Began compiling node model.vg_casestudy.stg_raw_staging__accounts
[0m02:30:08.655436 [debug] [Thread-1 (]: Writing injected SQL for node "model.vg_casestudy.stg_raw_staging__accounts"
[0m02:30:08.655820 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.stg_raw_staging__accounts (compile): 02:30:08.649196 => 02:30:08.655706
[0m02:30:08.656015 [debug] [Thread-1 (]: Began executing node model.vg_casestudy.stg_raw_staging__accounts
[0m02:30:08.676423 [debug] [Thread-1 (]: Writing runtime sql for node "model.vg_casestudy.stg_raw_staging__accounts"
[0m02:30:08.676871 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_raw_staging__accounts"
[0m02:30:08.677094 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__accounts: BEGIN
[0m02:30:08.677286 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m02:30:08.685327 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:30:08.685568 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_raw_staging__accounts"
[0m02:30:08.685809 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__accounts: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_raw_staging__accounts"} */

  
  create view "casestudy"."staging"."stg_raw_staging__accounts__dbt_tmp" as (
    with source as (
    select * from "casestudy"."raw"."accounts"
),

renamed as (
    select
        account_id,
        customer_id,
        account_type,
        
CASE
    -- First try DD.MM.YYYY format (German format with dots)
    WHEN REGEXP_MATCHES(account_opening_date, '^\d{1,2}\.\d{1,2}\.\d{4}$') 
        THEN TRY_CAST(STRPTIME(account_opening_date, '%d.%m.%Y') AS DATE)
        
    -- Then try DD/MM/YYYY format (with slashes)
    WHEN REGEXP_MATCHES(account_opening_date, '^\d{1,2}/\d{1,2}/\d{4}$')
        AND CAST(SPLIT_PART(account_opening_date, '/', 1) AS INTEGER) <= 31 
        AND CAST(SPLIT_PART(account_opening_date, '/', 2) AS INTEGER) <= 12 
        THEN TRY_CAST(STRPTIME(account_opening_date, '%d/%m/%Y') AS DATE)
        
    -- Try MM/DD/YYYY format (US format with slashes)
    WHEN REGEXP_MATCHES(account_opening_date, '^\d{1,2}/\d{1,2}/\d{4}$')
        AND CAST(SPLIT_PART(account_opening_date, '/', 1) AS INTEGER) <= 12 
        THEN TRY_CAST(STRPTIME(account_opening_date, '%m/%d/%Y') AS DATE)
        
    -- Try YYYY-MM-DD format (ISO format)
    WHEN REGEXP_MATCHES(account_opening_date, '^\d{4}-\d{1,2}-\d{1,2}$')
        THEN TRY_CAST(STRPTIME(account_opening_date, '%Y-%m-%d') AS DATE)
        
    -- Try generic date parsing as last resort
    ELSE TRY_CAST(account_opening_date AS DATE)
END
 as account_opening_date,
        account_opening_date as account_opening_date_raw
    from source
    where account_type is not null and account_type != '' and account_type != '-'
),

final as (
    select
        account_id,
        customer_id,
        account_type,
        account_opening_date,
        -- Flag records with date parsing issues
        CASE WHEN account_opening_date IS NULL AND account_opening_date_raw IS NOT NULL
             THEN TRUE ELSE FALSE 
        END as has_date_parsing_error
    from renamed
)

select * from final
  );

[0m02:30:08.686816 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:30:08.728316 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_raw_staging__accounts"
[0m02:30:08.728654 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__accounts: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_raw_staging__accounts"} */
alter view "casestudy"."staging"."stg_raw_staging__accounts" rename to "stg_raw_staging__accounts__dbt_backup"
[0m02:30:08.729368 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:30:08.731361 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_raw_staging__accounts"
[0m02:30:08.731626 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__accounts: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_raw_staging__accounts"} */
alter view "casestudy"."staging"."stg_raw_staging__accounts__dbt_tmp" rename to "stg_raw_staging__accounts"
[0m02:30:08.732214 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:30:08.741888 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__accounts: COMMIT
[0m02:30:08.742182 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_raw_staging__accounts"
[0m02:30:08.742395 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__accounts: COMMIT
[0m02:30:08.744383 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:30:08.747319 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_raw_staging__accounts"
[0m02:30:08.747549 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__accounts: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_raw_staging__accounts"} */
drop view if exists "casestudy"."staging"."stg_raw_staging__accounts__dbt_backup" cascade
[0m02:30:08.748588 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:30:08.749486 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.stg_raw_staging__accounts (execute): 02:30:08.656145 => 02:30:08.749386
[0m02:30:08.749707 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__accounts: Close
[0m02:30:08.761876 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f9c6553f-5fe9-4ba1-91f8-90d6cbeef8c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c7a2b9bd190>]}
[0m02:30:08.762275 [info ] [Thread-1 (]: 1 of 11 OK created sql view model staging.stg_raw_staging__accounts ............ [[32mOK[0m in 0.11s]
[0m02:30:08.762605 [debug] [Thread-1 (]: Finished running node model.vg_casestudy.stg_raw_staging__accounts
[0m02:30:08.762839 [debug] [Thread-1 (]: Began running node model.vg_casestudy.stg_raw_staging__customers
[0m02:30:08.763073 [info ] [Thread-1 (]: 2 of 11 START sql view model staging.stg_raw_staging__customers ................ [RUN]
[0m02:30:08.763437 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.vg_casestudy.stg_raw_staging__accounts, now model.vg_casestudy.stg_raw_staging__customers)
[0m02:30:08.763757 [debug] [Thread-1 (]: Began compiling node model.vg_casestudy.stg_raw_staging__customers
[0m02:30:08.765482 [debug] [Thread-1 (]: Writing injected SQL for node "model.vg_casestudy.stg_raw_staging__customers"
[0m02:30:08.765866 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.stg_raw_staging__customers (compile): 02:30:08.763962 => 02:30:08.765744
[0m02:30:08.766065 [debug] [Thread-1 (]: Began executing node model.vg_casestudy.stg_raw_staging__customers
[0m02:30:08.768180 [debug] [Thread-1 (]: Writing runtime sql for node "model.vg_casestudy.stg_raw_staging__customers"
[0m02:30:08.768498 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_raw_staging__customers"
[0m02:30:08.768693 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__customers: BEGIN
[0m02:30:08.768875 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:30:08.776187 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:30:08.776591 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_raw_staging__customers"
[0m02:30:08.776897 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__customers: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_raw_staging__customers"} */

  
  create view "casestudy"."staging"."stg_raw_staging__customers__dbt_tmp" as (
    with source as (
    select * from "casestudy"."raw"."customers"
),

renamed as (
    select distinct
        customer_id,
        trim(firstname) as firstname,
        trim(lastname) as lastname,
        Age as age,
        branch_id
    from source
)

select * from renamed
  );

[0m02:30:08.777727 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:30:08.782710 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_raw_staging__customers"
[0m02:30:08.783305 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__customers: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_raw_staging__customers"} */
alter view "casestudy"."staging"."stg_raw_staging__customers" rename to "stg_raw_staging__customers__dbt_backup"
[0m02:30:08.784597 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:30:08.789133 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_raw_staging__customers"
[0m02:30:08.789688 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__customers: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_raw_staging__customers"} */
alter view "casestudy"."staging"."stg_raw_staging__customers__dbt_tmp" rename to "stg_raw_staging__customers"
[0m02:30:08.790974 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:30:08.793021 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__customers: COMMIT
[0m02:30:08.793478 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_raw_staging__customers"
[0m02:30:08.793844 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__customers: COMMIT
[0m02:30:08.796089 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:30:08.799014 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_raw_staging__customers"
[0m02:30:08.799449 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__customers: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_raw_staging__customers"} */
drop view if exists "casestudy"."staging"."stg_raw_staging__customers__dbt_backup" cascade
[0m02:30:08.801330 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:30:08.803242 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.stg_raw_staging__customers (execute): 02:30:08.766202 => 02:30:08.803016
[0m02:30:08.803663 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__customers: Close
[0m02:30:08.818072 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f9c6553f-5fe9-4ba1-91f8-90d6cbeef8c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c7a2fddf150>]}
[0m02:30:08.818470 [info ] [Thread-1 (]: 2 of 11 OK created sql view model staging.stg_raw_staging__customers ........... [[32mOK[0m in 0.05s]
[0m02:30:08.818781 [debug] [Thread-1 (]: Finished running node model.vg_casestudy.stg_raw_staging__customers
[0m02:30:08.819001 [debug] [Thread-1 (]: Began running node model.vg_casestudy.stg_raw_staging__fx_rates
[0m02:30:08.819424 [info ] [Thread-1 (]: 3 of 11 START sql view model staging.stg_raw_staging__fx_rates ................. [RUN]
[0m02:30:08.819786 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.vg_casestudy.stg_raw_staging__customers, now model.vg_casestudy.stg_raw_staging__fx_rates)
[0m02:30:08.819975 [debug] [Thread-1 (]: Began compiling node model.vg_casestudy.stg_raw_staging__fx_rates
[0m02:30:08.824030 [debug] [Thread-1 (]: Writing injected SQL for node "model.vg_casestudy.stg_raw_staging__fx_rates"
[0m02:30:08.824400 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.stg_raw_staging__fx_rates (compile): 02:30:08.820095 => 02:30:08.824284
[0m02:30:08.824582 [debug] [Thread-1 (]: Began executing node model.vg_casestudy.stg_raw_staging__fx_rates
[0m02:30:08.826696 [debug] [Thread-1 (]: Writing runtime sql for node "model.vg_casestudy.stg_raw_staging__fx_rates"
[0m02:30:08.827014 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_raw_staging__fx_rates"
[0m02:30:08.827211 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__fx_rates: BEGIN
[0m02:30:08.827383 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:30:08.834757 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:30:08.834990 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_raw_staging__fx_rates"
[0m02:30:08.835243 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__fx_rates: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_raw_staging__fx_rates"} */

  
  create view "casestudy"."staging"."stg_raw_staging__fx_rates__dbt_tmp" as (
    with source as (
    select * from "casestudy"."raw"."fx_rates"
),

renamed as (
    select
        trim(currency_iso_code) as currency_iso_code,
        
CASE
    WHEN fx_rate IS NULL THEN NULL
    -- If the value is already a valid number
    WHEN TRY_CAST(fx_rate AS DOUBLE) IS NOT NULL 
        THEN TRY_CAST(fx_rate AS DOUBLE)
    -- If contains both dot and comma (German notation)
    WHEN POSITION('.' IN fx_rate) > 0 AND POSITION(',' IN fx_rate) > 0 
        THEN TRY_CAST(REPLACE(REPLACE(TRIM(fx_rate), '.', ''), ',', '.') AS DOUBLE)
    -- If only contains comma, treat as decimal point
    WHEN POSITION(',' IN fx_rate) > 0 
        THEN TRY_CAST(REPLACE(TRIM(fx_rate), ',', '.') AS DOUBLE)
    -- If only contains dots, likely thousands separator
    WHEN POSITION('.' IN fx_rate) > 0 
        THEN TRY_CAST(REPLACE(TRIM(fx_rate), '.', '') AS DOUBLE)
    ELSE NULL
END
 as fx_rate,
        
CASE
    -- First try DD.MM.YYYY format (German format with dots)
    WHEN REGEXP_MATCHES(date, '^\d{1,2}\.\d{1,2}\.\d{4}$') 
        THEN TRY_CAST(STRPTIME(date, '%d.%m.%Y') AS DATE)
        
    -- Then try DD/MM/YYYY format (with slashes)
    WHEN REGEXP_MATCHES(date, '^\d{1,2}/\d{1,2}/\d{4}$')
        AND CAST(SPLIT_PART(date, '/', 1) AS INTEGER) <= 31 
        AND CAST(SPLIT_PART(date, '/', 2) AS INTEGER) <= 12 
        THEN TRY_CAST(STRPTIME(date, '%d/%m/%Y') AS DATE)
        
    -- Try MM/DD/YYYY format (US format with slashes)
    WHEN REGEXP_MATCHES(date, '^\d{1,2}/\d{1,2}/\d{4}$')
        AND CAST(SPLIT_PART(date, '/', 1) AS INTEGER) <= 12 
        THEN TRY_CAST(STRPTIME(date, '%m/%d/%Y') AS DATE)
        
    -- Try YYYY-MM-DD format (ISO format)
    WHEN REGEXP_MATCHES(date, '^\d{4}-\d{1,2}-\d{1,2}$')
        THEN TRY_CAST(STRPTIME(date, '%Y-%m-%d') AS DATE)
        
    -- Try generic date parsing as last resort
    ELSE TRY_CAST(date AS DATE)
END
 as fx_rate_date,
        date as fx_rate_date_raw
    from source
    where currency_iso_code is not null and trim(currency_iso_code) not in  ('(none)', '')
),

final as (
    select
        currency_iso_code,
        fx_rate,
        fx_rate_date,
        -- Flag records with date parsing issues
        CASE WHEN fx_rate_date IS NULL AND fx_rate_date_raw IS NOT NULL
             THEN TRUE ELSE FALSE 
        END as has_date_parsing_error
    from renamed
)

select * from final
  );

[0m02:30:08.836315 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:30:08.838250 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_raw_staging__fx_rates"
[0m02:30:08.838466 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__fx_rates: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_raw_staging__fx_rates"} */
alter view "casestudy"."staging"."stg_raw_staging__fx_rates" rename to "stg_raw_staging__fx_rates__dbt_backup"
[0m02:30:08.838862 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:30:08.840578 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_raw_staging__fx_rates"
[0m02:30:08.840795 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__fx_rates: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_raw_staging__fx_rates"} */
alter view "casestudy"."staging"."stg_raw_staging__fx_rates__dbt_tmp" rename to "stg_raw_staging__fx_rates"
[0m02:30:08.841165 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:30:08.842129 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__fx_rates: COMMIT
[0m02:30:08.842331 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_raw_staging__fx_rates"
[0m02:30:08.842506 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__fx_rates: COMMIT
[0m02:30:08.843979 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:30:08.845307 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_raw_staging__fx_rates"
[0m02:30:08.845506 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__fx_rates: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_raw_staging__fx_rates"} */
drop view if exists "casestudy"."staging"."stg_raw_staging__fx_rates__dbt_backup" cascade
[0m02:30:08.846538 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:30:08.847298 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.stg_raw_staging__fx_rates (execute): 02:30:08.824697 => 02:30:08.847201
[0m02:30:08.847489 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__fx_rates: Close
[0m02:30:08.859000 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f9c6553f-5fe9-4ba1-91f8-90d6cbeef8c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c7a2ba2cc50>]}
[0m02:30:08.859385 [info ] [Thread-1 (]: 3 of 11 OK created sql view model staging.stg_raw_staging__fx_rates ............ [[32mOK[0m in 0.04s]
[0m02:30:08.859687 [debug] [Thread-1 (]: Finished running node model.vg_casestudy.stg_raw_staging__fx_rates
[0m02:30:08.859905 [debug] [Thread-1 (]: Began running node model.vg_casestudy.stg_raw_staging__loans
[0m02:30:08.860334 [info ] [Thread-1 (]: 4 of 11 START sql view model staging.stg_raw_staging__loans .................... [RUN]
[0m02:30:08.860704 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.vg_casestudy.stg_raw_staging__fx_rates, now model.vg_casestudy.stg_raw_staging__loans)
[0m02:30:08.860901 [debug] [Thread-1 (]: Began compiling node model.vg_casestudy.stg_raw_staging__loans
[0m02:30:08.863066 [debug] [Thread-1 (]: Writing injected SQL for node "model.vg_casestudy.stg_raw_staging__loans"
[0m02:30:08.863434 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.stg_raw_staging__loans (compile): 02:30:08.861021 => 02:30:08.863315
[0m02:30:08.863621 [debug] [Thread-1 (]: Began executing node model.vg_casestudy.stg_raw_staging__loans
[0m02:30:08.865780 [debug] [Thread-1 (]: Writing runtime sql for node "model.vg_casestudy.stg_raw_staging__loans"
[0m02:30:08.866085 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_raw_staging__loans"
[0m02:30:08.866286 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__loans: BEGIN
[0m02:30:08.866457 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:30:08.874135 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:30:08.874488 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_raw_staging__loans"
[0m02:30:08.874763 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__loans: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_raw_staging__loans"} */

  
  create view "casestudy"."staging"."stg_raw_staging__loans__dbt_tmp" as (
    with source as (
    select * from "casestudy"."raw"."loans"
),

renamed as (
    select
        customer_id,
        loan_id,
        
CASE
    WHEN loan_amount IS NULL THEN NULL
    -- If the value is already a valid number
    WHEN TRY_CAST(loan_amount AS DOUBLE) IS NOT NULL 
        THEN TRY_CAST(loan_amount AS DOUBLE)
    -- If contains both dot and comma (German notation)
    WHEN POSITION('.' IN loan_amount) > 0 AND POSITION(',' IN loan_amount) > 0 
        THEN TRY_CAST(REPLACE(REPLACE(TRIM(loan_amount), '.', ''), ',', '.') AS DOUBLE)
    -- If only contains comma, treat as decimal point
    WHEN POSITION(',' IN loan_amount) > 0 
        THEN TRY_CAST(REPLACE(TRIM(loan_amount), ',', '.') AS DOUBLE)
    -- If only contains dots, likely thousands separator
    WHEN POSITION('.' IN loan_amount) > 0 
        THEN TRY_CAST(REPLACE(TRIM(loan_amount), '.', '') AS DOUBLE)
    ELSE NULL
END
 as loan_amount,
        loant_type,
        
CASE
    WHEN interest_rate IS NULL THEN NULL
    -- If the value is already a valid number
    WHEN TRY_CAST(interest_rate AS DOUBLE) IS NOT NULL 
        THEN TRY_CAST(interest_rate AS DOUBLE)
    -- If contains both dot and comma (German notation)
    WHEN POSITION('.' IN interest_rate) > 0 AND POSITION(',' IN interest_rate) > 0 
        THEN TRY_CAST(REPLACE(REPLACE(TRIM(interest_rate), '.', ''), ',', '.') AS DOUBLE)
    -- If only contains comma, treat as decimal point
    WHEN POSITION(',' IN interest_rate) > 0 
        THEN TRY_CAST(REPLACE(TRIM(interest_rate), ',', '.') AS DOUBLE)
    -- If only contains dots, likely thousands separator
    WHEN POSITION('.' IN interest_rate) > 0 
        THEN TRY_CAST(REPLACE(TRIM(interest_rate), '.', '') AS DOUBLE)
    ELSE NULL
END
 as interest_rate,
        loan_term,
        
CASE
    -- First try DD.MM.YYYY format (German format with dots)
    WHEN REGEXP_MATCHES(approval_rejection_date, '^\d{1,2}\.\d{1,2}\.\d{4}$') 
        THEN TRY_CAST(STRPTIME(approval_rejection_date, '%d.%m.%Y') AS DATE)
        
    -- Then try DD/MM/YYYY format (with slashes)
    WHEN REGEXP_MATCHES(approval_rejection_date, '^\d{1,2}/\d{1,2}/\d{4}$')
        AND CAST(SPLIT_PART(approval_rejection_date, '/', 1) AS INTEGER) <= 31 
        AND CAST(SPLIT_PART(approval_rejection_date, '/', 2) AS INTEGER) <= 12 
        THEN TRY_CAST(STRPTIME(approval_rejection_date, '%d/%m/%Y') AS DATE)
        
    -- Try MM/DD/YYYY format (US format with slashes)
    WHEN REGEXP_MATCHES(approval_rejection_date, '^\d{1,2}/\d{1,2}/\d{4}$')
        AND CAST(SPLIT_PART(approval_rejection_date, '/', 1) AS INTEGER) <= 12 
        THEN TRY_CAST(STRPTIME(approval_rejection_date, '%m/%d/%Y') AS DATE)
        
    -- Try YYYY-MM-DD format (ISO format)
    WHEN REGEXP_MATCHES(approval_rejection_date, '^\d{4}-\d{1,2}-\d{1,2}$')
        THEN TRY_CAST(STRPTIME(approval_rejection_date, '%Y-%m-%d') AS DATE)
        
    -- Try generic date parsing as last resort
    ELSE TRY_CAST(approval_rejection_date AS DATE)
END
 as approval_rejection_date,
        approval_rejection_date as approval_rejection_date_raw,
        loan_status
    from source
),

final as (
    select
        customer_id,
        loan_id,
        loan_amount,
        loant_type as loan_type,
        interest_rate,
        loan_term,
        approval_rejection_date,
        loan_status,
        -- Flag records with date parsing issues
        CASE WHEN approval_rejection_date IS NULL AND approval_rejection_date_raw IS NOT NULL
             THEN TRUE ELSE FALSE 
        END as has_date_parsing_error
    from renamed
)

select * from final
  );

[0m02:30:08.876293 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:30:08.878280 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_raw_staging__loans"
[0m02:30:08.878492 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__loans: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_raw_staging__loans"} */
alter view "casestudy"."staging"."stg_raw_staging__loans" rename to "stg_raw_staging__loans__dbt_backup"
[0m02:30:08.878871 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:30:08.880462 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_raw_staging__loans"
[0m02:30:08.880671 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__loans: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_raw_staging__loans"} */
alter view "casestudy"."staging"."stg_raw_staging__loans__dbt_tmp" rename to "stg_raw_staging__loans"
[0m02:30:08.881018 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:30:08.881941 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__loans: COMMIT
[0m02:30:08.882148 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_raw_staging__loans"
[0m02:30:08.882327 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__loans: COMMIT
[0m02:30:08.883673 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:30:08.885966 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_raw_staging__loans"
[0m02:30:08.886179 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__loans: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_raw_staging__loans"} */
drop view if exists "casestudy"."staging"."stg_raw_staging__loans__dbt_backup" cascade
[0m02:30:08.887057 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:30:08.887804 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.stg_raw_staging__loans (execute): 02:30:08.863742 => 02:30:08.887697
[0m02:30:08.887994 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__loans: Close
[0m02:30:08.898687 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f9c6553f-5fe9-4ba1-91f8-90d6cbeef8c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c7a2bab8090>]}
[0m02:30:08.899059 [info ] [Thread-1 (]: 4 of 11 OK created sql view model staging.stg_raw_staging__loans ............... [[32mOK[0m in 0.04s]
[0m02:30:08.899370 [debug] [Thread-1 (]: Finished running node model.vg_casestudy.stg_raw_staging__loans
[0m02:30:08.899581 [debug] [Thread-1 (]: Began running node model.vg_casestudy.stg_raw_staging__transactions
[0m02:30:08.899992 [info ] [Thread-1 (]: 5 of 11 START sql view model staging.stg_raw_staging__transactions ............. [RUN]
[0m02:30:08.900359 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.vg_casestudy.stg_raw_staging__loans, now model.vg_casestudy.stg_raw_staging__transactions)
[0m02:30:08.900544 [debug] [Thread-1 (]: Began compiling node model.vg_casestudy.stg_raw_staging__transactions
[0m02:30:08.902589 [debug] [Thread-1 (]: Writing injected SQL for node "model.vg_casestudy.stg_raw_staging__transactions"
[0m02:30:08.902942 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.stg_raw_staging__transactions (compile): 02:30:08.900655 => 02:30:08.902827
[0m02:30:08.903131 [debug] [Thread-1 (]: Began executing node model.vg_casestudy.stg_raw_staging__transactions
[0m02:30:08.905220 [debug] [Thread-1 (]: Writing runtime sql for node "model.vg_casestudy.stg_raw_staging__transactions"
[0m02:30:08.905525 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_raw_staging__transactions"
[0m02:30:08.905711 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__transactions: BEGIN
[0m02:30:08.905876 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:30:08.913138 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:30:08.913429 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_raw_staging__transactions"
[0m02:30:08.913684 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__transactions: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_raw_staging__transactions"} */

  
  create view "casestudy"."staging"."stg_raw_staging__transactions__dbt_tmp" as (
    with source as (
    select * from "casestudy"."raw"."transactions"
),

renamed as (
    select
        transaction_id,
        
CASE
    -- First try DD.MM.YYYY format (German format with dots)
    WHEN REGEXP_MATCHES(transaction_date, '^\d{1,2}\.\d{1,2}\.\d{4}$') 
        THEN TRY_CAST(STRPTIME(transaction_date, '%d.%m.%Y') AS DATE)
        
    -- Then try DD/MM/YYYY format (with slashes)
    WHEN REGEXP_MATCHES(transaction_date, '^\d{1,2}/\d{1,2}/\d{4}$')
        AND CAST(SPLIT_PART(transaction_date, '/', 1) AS INTEGER) <= 31 
        AND CAST(SPLIT_PART(transaction_date, '/', 2) AS INTEGER) <= 12 
        THEN TRY_CAST(STRPTIME(transaction_date, '%d/%m/%Y') AS DATE)
        
    -- Try MM/DD/YYYY format (US format with slashes)
    WHEN REGEXP_MATCHES(transaction_date, '^\d{1,2}/\d{1,2}/\d{4}$')
        AND CAST(SPLIT_PART(transaction_date, '/', 1) AS INTEGER) <= 12 
        THEN TRY_CAST(STRPTIME(transaction_date, '%m/%d/%Y') AS DATE)
        
    -- Try YYYY-MM-DD format (ISO format)
    WHEN REGEXP_MATCHES(transaction_date, '^\d{4}-\d{1,2}-\d{1,2}$')
        THEN TRY_CAST(STRPTIME(transaction_date, '%Y-%m-%d') AS DATE)
        
    -- Try generic date parsing as last resort
    ELSE TRY_CAST(transaction_date AS DATE)
END
 as transaction_date,
        transaction_date as transaction_date_raw,
        account_id,
        trim(transaction_type) as transaction_type,
        
CASE
    WHEN transaction_amount IS NULL THEN NULL
    -- If the value is already a valid number
    WHEN TRY_CAST(transaction_amount AS DOUBLE) IS NOT NULL 
        THEN TRY_CAST(transaction_amount AS DOUBLE)
    -- If contains both dot and comma (German notation)
    WHEN POSITION('.' IN transaction_amount) > 0 AND POSITION(',' IN transaction_amount) > 0 
        THEN TRY_CAST(REPLACE(REPLACE(TRIM(transaction_amount), '.', ''), ',', '.') AS DOUBLE)
    -- If only contains comma, treat as decimal point
    WHEN POSITION(',' IN transaction_amount) > 0 
        THEN TRY_CAST(REPLACE(TRIM(transaction_amount), ',', '.') AS DOUBLE)
    -- If only contains dots, likely thousands separator
    WHEN POSITION('.' IN transaction_amount) > 0 
        THEN TRY_CAST(REPLACE(TRIM(transaction_amount), '.', '') AS DOUBLE)
    ELSE NULL
END
 as transaction_amount,
        trim(transaction_currency) as transaction_currency
    from source
),

final as (
    select
        transaction_id,
        transaction_date,
        account_id,
        transaction_type,
        transaction_amount,
        transaction_currency,
        -- Flag records with date parsing issues
        CASE WHEN transaction_date IS NULL AND transaction_date_raw IS NOT NULL
             THEN TRUE ELSE FALSE 
        END as has_date_parsing_error
    from renamed
)

select * from final
  );

[0m02:30:08.914904 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:30:08.917276 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_raw_staging__transactions"
[0m02:30:08.917484 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__transactions: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_raw_staging__transactions"} */
alter view "casestudy"."staging"."stg_raw_staging__transactions" rename to "stg_raw_staging__transactions__dbt_backup"
[0m02:30:08.917861 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:30:08.919449 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_raw_staging__transactions"
[0m02:30:08.919656 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__transactions: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_raw_staging__transactions"} */
alter view "casestudy"."staging"."stg_raw_staging__transactions__dbt_tmp" rename to "stg_raw_staging__transactions"
[0m02:30:08.920013 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:30:08.920964 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__transactions: COMMIT
[0m02:30:08.921171 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_raw_staging__transactions"
[0m02:30:08.921358 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__transactions: COMMIT
[0m02:30:08.922776 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:30:08.924118 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_raw_staging__transactions"
[0m02:30:08.924323 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__transactions: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_raw_staging__transactions"} */
drop view if exists "casestudy"."staging"."stg_raw_staging__transactions__dbt_backup" cascade
[0m02:30:08.925214 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:30:08.925945 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.stg_raw_staging__transactions (execute): 02:30:08.903260 => 02:30:08.925843
[0m02:30:08.926144 [debug] [Thread-1 (]: On model.vg_casestudy.stg_raw_staging__transactions: Close
[0m02:30:08.938227 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f9c6553f-5fe9-4ba1-91f8-90d6cbeef8c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c7a2b9dd290>]}
[0m02:30:08.938591 [info ] [Thread-1 (]: 5 of 11 OK created sql view model staging.stg_raw_staging__transactions ........ [[32mOK[0m in 0.04s]
[0m02:30:08.938886 [debug] [Thread-1 (]: Finished running node model.vg_casestudy.stg_raw_staging__transactions
[0m02:30:08.939103 [debug] [Thread-1 (]: Began running node model.vg_casestudy.stg_staging_intermediate__currencies
[0m02:30:08.939513 [info ] [Thread-1 (]: 6 of 11 START sql table model intermediate.stg_staging_intermediate__currencies  [RUN]
[0m02:30:08.939873 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.vg_casestudy.stg_raw_staging__transactions, now model.vg_casestudy.stg_staging_intermediate__currencies)
[0m02:30:08.940065 [debug] [Thread-1 (]: Began compiling node model.vg_casestudy.stg_staging_intermediate__currencies
[0m02:30:08.941733 [debug] [Thread-1 (]: Writing injected SQL for node "model.vg_casestudy.stg_staging_intermediate__currencies"
[0m02:30:08.942076 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.stg_staging_intermediate__currencies (compile): 02:30:08.940193 => 02:30:08.941963
[0m02:30:08.942272 [debug] [Thread-1 (]: Began executing node model.vg_casestudy.stg_staging_intermediate__currencies
[0m02:30:08.953154 [debug] [Thread-1 (]: Writing runtime sql for node "model.vg_casestudy.stg_staging_intermediate__currencies"
[0m02:30:08.953633 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__currencies"
[0m02:30:08.953848 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__currencies: BEGIN
[0m02:30:08.954043 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:30:08.962090 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:30:08.962332 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__currencies"
[0m02:30:08.962534 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__currencies: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_staging_intermediate__currencies"} */

  
    
    

    create  table
      "casestudy"."intermediate"."stg_staging_intermediate__currencies__dbt_tmp"
  
    as (
      with staging as (
    select * from "casestudy"."raw"."currencies"
),
cleaned as (
    select distinct
        trim(currency) as currency,
        trim(currency_iso_code) as currency_iso_code,
    from staging
    where currency_iso_code is not null and trim(currency_iso_code) != '(none)'
)

select * from cleaned
    );
  
  
[0m02:30:08.965311 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:30:08.967198 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__currencies"
[0m02:30:08.967411 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__currencies: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_staging_intermediate__currencies"} */
alter table "casestudy"."intermediate"."stg_staging_intermediate__currencies" rename to "stg_staging_intermediate__currencies__dbt_backup"
[0m02:30:08.967766 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:30:08.970613 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__currencies"
[0m02:30:08.970833 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__currencies: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_staging_intermediate__currencies"} */
alter table "casestudy"."intermediate"."stg_staging_intermediate__currencies__dbt_tmp" rename to "stg_staging_intermediate__currencies"
[0m02:30:08.971170 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:30:08.973977 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__currencies: COMMIT
[0m02:30:08.974202 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__currencies"
[0m02:30:08.974384 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__currencies: COMMIT
[0m02:30:08.975857 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:30:08.977173 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__currencies"
[0m02:30:08.977379 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__currencies: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_staging_intermediate__currencies"} */
drop table if exists "casestudy"."intermediate"."stg_staging_intermediate__currencies__dbt_backup" cascade
[0m02:30:08.978218 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:30:08.978933 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.stg_staging_intermediate__currencies (execute): 02:30:08.942390 => 02:30:08.978829
[0m02:30:08.979121 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__currencies: Close
[0m02:30:08.993108 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f9c6553f-5fe9-4ba1-91f8-90d6cbeef8c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c7a2b771390>]}
[0m02:30:08.993497 [info ] [Thread-1 (]: 6 of 11 OK created sql table model intermediate.stg_staging_intermediate__currencies  [[32mOK[0m in 0.05s]
[0m02:30:08.993799 [debug] [Thread-1 (]: Finished running node model.vg_casestudy.stg_staging_intermediate__currencies
[0m02:30:08.994011 [debug] [Thread-1 (]: Began running node model.vg_casestudy.stg_staging_intermediate__accounts
[0m02:30:08.994329 [info ] [Thread-1 (]: 7 of 11 START sql table model intermediate.stg_staging_intermediate__accounts .. [RUN]
[0m02:30:08.994662 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.vg_casestudy.stg_staging_intermediate__currencies, now model.vg_casestudy.stg_staging_intermediate__accounts)
[0m02:30:08.994846 [debug] [Thread-1 (]: Began compiling node model.vg_casestudy.stg_staging_intermediate__accounts
[0m02:30:08.996492 [debug] [Thread-1 (]: Writing injected SQL for node "model.vg_casestudy.stg_staging_intermediate__accounts"
[0m02:30:08.996830 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.stg_staging_intermediate__accounts (compile): 02:30:08.994962 => 02:30:08.996719
[0m02:30:08.997007 [debug] [Thread-1 (]: Began executing node model.vg_casestudy.stg_staging_intermediate__accounts
[0m02:30:08.999012 [debug] [Thread-1 (]: Writing runtime sql for node "model.vg_casestudy.stg_staging_intermediate__accounts"
[0m02:30:08.999349 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__accounts"
[0m02:30:08.999532 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__accounts: BEGIN
[0m02:30:08.999694 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:30:09.007051 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:30:09.007379 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__accounts"
[0m02:30:09.007593 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__accounts: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_staging_intermediate__accounts"} */

  
    
    

    create  table
      "casestudy"."intermediate"."stg_staging_intermediate__accounts__dbt_tmp"
  
    as (
      with staging as (
    select * from "casestudy"."staging"."stg_raw_staging__accounts"
), 
filtered as (
    select 
        account_id,
        customer_id,
        account_type,
        account_opening_date,
     from staging
    where not has_date_parsing_error
)

select * from filtered
    );
  
  
[0m02:30:09.011880 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:30:09.013896 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__accounts"
[0m02:30:09.014136 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__accounts: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_staging_intermediate__accounts"} */
alter table "casestudy"."intermediate"."stg_staging_intermediate__accounts" rename to "stg_staging_intermediate__accounts__dbt_backup"
[0m02:30:09.014561 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:30:09.016365 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__accounts"
[0m02:30:09.016591 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__accounts: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_staging_intermediate__accounts"} */
alter table "casestudy"."intermediate"."stg_staging_intermediate__accounts__dbt_tmp" rename to "stg_staging_intermediate__accounts"
[0m02:30:09.017065 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:30:09.018113 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__accounts: COMMIT
[0m02:30:09.018344 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__accounts"
[0m02:30:09.018536 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__accounts: COMMIT
[0m02:30:09.020268 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:30:09.021854 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__accounts"
[0m02:30:09.022075 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__accounts: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_staging_intermediate__accounts"} */
drop table if exists "casestudy"."intermediate"."stg_staging_intermediate__accounts__dbt_backup" cascade
[0m02:30:09.023815 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:30:09.024664 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.stg_staging_intermediate__accounts (execute): 02:30:08.997120 => 02:30:09.024559
[0m02:30:09.024875 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__accounts: Close
[0m02:30:09.042577 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f9c6553f-5fe9-4ba1-91f8-90d6cbeef8c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c7a2c488990>]}
[0m02:30:09.043005 [info ] [Thread-1 (]: 7 of 11 OK created sql table model intermediate.stg_staging_intermediate__accounts  [[32mOK[0m in 0.05s]
[0m02:30:09.043353 [debug] [Thread-1 (]: Finished running node model.vg_casestudy.stg_staging_intermediate__accounts
[0m02:30:09.043599 [debug] [Thread-1 (]: Began running node model.vg_casestudy.stg_staging_intermediate__customers
[0m02:30:09.043970 [info ] [Thread-1 (]: 8 of 11 START sql table model intermediate.stg_staging_intermediate__customers . [RUN]
[0m02:30:09.044407 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.vg_casestudy.stg_staging_intermediate__accounts, now model.vg_casestudy.stg_staging_intermediate__customers)
[0m02:30:09.044653 [debug] [Thread-1 (]: Began compiling node model.vg_casestudy.stg_staging_intermediate__customers
[0m02:30:09.046401 [debug] [Thread-1 (]: Writing injected SQL for node "model.vg_casestudy.stg_staging_intermediate__customers"
[0m02:30:09.046750 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.stg_staging_intermediate__customers (compile): 02:30:09.044782 => 02:30:09.046634
[0m02:30:09.046930 [debug] [Thread-1 (]: Began executing node model.vg_casestudy.stg_staging_intermediate__customers
[0m02:30:09.049052 [debug] [Thread-1 (]: Writing runtime sql for node "model.vg_casestudy.stg_staging_intermediate__customers"
[0m02:30:09.049364 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__customers"
[0m02:30:09.049551 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__customers: BEGIN
[0m02:30:09.049713 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:30:09.056627 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:30:09.056853 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__customers"
[0m02:30:09.057031 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__customers: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_staging_intermediate__customers"} */

  
    
    

    create  table
      "casestudy"."intermediate"."stg_staging_intermediate__customers__dbt_tmp"
  
    as (
      with staging as (
    select * from "casestudy"."staging"."stg_raw_staging__customers"
)

select * from staging
    );
  
  
[0m02:30:09.062968 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:30:09.065941 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__customers"
[0m02:30:09.066178 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__customers: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_staging_intermediate__customers"} */
alter table "casestudy"."intermediate"."stg_staging_intermediate__customers" rename to "stg_staging_intermediate__customers__dbt_backup"
[0m02:30:09.066553 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:30:09.068116 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__customers"
[0m02:30:09.068342 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__customers: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_staging_intermediate__customers"} */
alter table "casestudy"."intermediate"."stg_staging_intermediate__customers__dbt_tmp" rename to "stg_staging_intermediate__customers"
[0m02:30:09.068669 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:30:09.069627 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__customers: COMMIT
[0m02:30:09.069829 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__customers"
[0m02:30:09.070002 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__customers: COMMIT
[0m02:30:09.072052 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:30:09.073397 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__customers"
[0m02:30:09.073649 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__customers: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_staging_intermediate__customers"} */
drop table if exists "casestudy"."intermediate"."stg_staging_intermediate__customers__dbt_backup" cascade
[0m02:30:09.074810 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:30:09.075579 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.stg_staging_intermediate__customers (execute): 02:30:09.047046 => 02:30:09.075475
[0m02:30:09.075779 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__customers: Close
[0m02:30:09.094529 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f9c6553f-5fe9-4ba1-91f8-90d6cbeef8c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c7a2b792f10>]}
[0m02:30:09.094950 [info ] [Thread-1 (]: 8 of 11 OK created sql table model intermediate.stg_staging_intermediate__customers  [[32mOK[0m in 0.05s]
[0m02:30:09.095274 [debug] [Thread-1 (]: Finished running node model.vg_casestudy.stg_staging_intermediate__customers
[0m02:30:09.095501 [debug] [Thread-1 (]: Began running node model.vg_casestudy.stg_staging_intermediate__fx_rates
[0m02:30:09.095845 [info ] [Thread-1 (]: 9 of 11 START sql table model intermediate.stg_staging_intermediate__fx_rates .. [RUN]
[0m02:30:09.096195 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.vg_casestudy.stg_staging_intermediate__customers, now model.vg_casestudy.stg_staging_intermediate__fx_rates)
[0m02:30:09.096383 [debug] [Thread-1 (]: Began compiling node model.vg_casestudy.stg_staging_intermediate__fx_rates
[0m02:30:09.098046 [debug] [Thread-1 (]: Writing injected SQL for node "model.vg_casestudy.stg_staging_intermediate__fx_rates"
[0m02:30:09.098400 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.stg_staging_intermediate__fx_rates (compile): 02:30:09.096497 => 02:30:09.098283
[0m02:30:09.098579 [debug] [Thread-1 (]: Began executing node model.vg_casestudy.stg_staging_intermediate__fx_rates
[0m02:30:09.100533 [debug] [Thread-1 (]: Writing runtime sql for node "model.vg_casestudy.stg_staging_intermediate__fx_rates"
[0m02:30:09.100826 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__fx_rates"
[0m02:30:09.101013 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__fx_rates: BEGIN
[0m02:30:09.101187 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:30:09.108494 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:30:09.108881 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__fx_rates"
[0m02:30:09.109079 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__fx_rates: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_staging_intermediate__fx_rates"} */

  
    
    

    create  table
      "casestudy"."intermediate"."stg_staging_intermediate__fx_rates__dbt_tmp"
  
    as (
      with staging as (
    select * from "casestudy"."staging"."stg_raw_staging__fx_rates"
),

filtered as (
    select
        currency_iso_code,
        fx_rate,
        fx_rate_date
    from staging
    where not has_date_parsing_error
)

select * from filtered
    );
  
  
[0m02:30:09.111575 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:30:09.113473 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__fx_rates"
[0m02:30:09.113679 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__fx_rates: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_staging_intermediate__fx_rates"} */
alter table "casestudy"."intermediate"."stg_staging_intermediate__fx_rates" rename to "stg_staging_intermediate__fx_rates__dbt_backup"
[0m02:30:09.114084 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:30:09.115657 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__fx_rates"
[0m02:30:09.115862 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__fx_rates: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_staging_intermediate__fx_rates"} */
alter table "casestudy"."intermediate"."stg_staging_intermediate__fx_rates__dbt_tmp" rename to "stg_staging_intermediate__fx_rates"
[0m02:30:09.116197 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:30:09.117159 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__fx_rates: COMMIT
[0m02:30:09.117355 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__fx_rates"
[0m02:30:09.117521 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__fx_rates: COMMIT
[0m02:30:09.118828 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:30:09.120152 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__fx_rates"
[0m02:30:09.120342 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__fx_rates: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_staging_intermediate__fx_rates"} */
drop table if exists "casestudy"."intermediate"."stg_staging_intermediate__fx_rates__dbt_backup" cascade
[0m02:30:09.121770 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:30:09.122571 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.stg_staging_intermediate__fx_rates (execute): 02:30:09.098692 => 02:30:09.122459
[0m02:30:09.122773 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__fx_rates: Close
[0m02:30:09.135950 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f9c6553f-5fe9-4ba1-91f8-90d6cbeef8c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c7a2b7b44d0>]}
[0m02:30:09.136737 [info ] [Thread-1 (]: 9 of 11 OK created sql table model intermediate.stg_staging_intermediate__fx_rates  [[32mOK[0m in 0.04s]
[0m02:30:09.137371 [debug] [Thread-1 (]: Finished running node model.vg_casestudy.stg_staging_intermediate__fx_rates
[0m02:30:09.137758 [debug] [Thread-1 (]: Began running node model.vg_casestudy.stg_staging_intermediate__loans
[0m02:30:09.138298 [info ] [Thread-1 (]: 10 of 11 START sql table model intermediate.stg_staging_intermediate__loans .... [RUN]
[0m02:30:09.138904 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.vg_casestudy.stg_staging_intermediate__fx_rates, now model.vg_casestudy.stg_staging_intermediate__loans)
[0m02:30:09.139096 [debug] [Thread-1 (]: Began compiling node model.vg_casestudy.stg_staging_intermediate__loans
[0m02:30:09.140849 [debug] [Thread-1 (]: Writing injected SQL for node "model.vg_casestudy.stg_staging_intermediate__loans"
[0m02:30:09.141199 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.stg_staging_intermediate__loans (compile): 02:30:09.139224 => 02:30:09.141079
[0m02:30:09.141380 [debug] [Thread-1 (]: Began executing node model.vg_casestudy.stg_staging_intermediate__loans
[0m02:30:09.144490 [debug] [Thread-1 (]: Writing runtime sql for node "model.vg_casestudy.stg_staging_intermediate__loans"
[0m02:30:09.144790 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__loans"
[0m02:30:09.144972 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__loans: BEGIN
[0m02:30:09.145148 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:30:09.152491 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:30:09.152811 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__loans"
[0m02:30:09.153006 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__loans: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_staging_intermediate__loans"} */

  
    
    

    create  table
      "casestudy"."intermediate"."stg_staging_intermediate__loans__dbt_tmp"
  
    as (
      with staging as (
    select * from "casestudy"."staging"."stg_raw_staging__loans"
),

filtered as (
    select
        customer_id,
        loan_id,
        loan_amount,
        loan_type,
        interest_rate,
        loan_term,
        approval_rejection_date,
        loan_status
    from staging
    where not has_date_parsing_error
)

select * from filtered
    );
  
  
[0m02:30:09.162375 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:30:09.164274 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__loans"
[0m02:30:09.164494 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__loans: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_staging_intermediate__loans"} */
alter table "casestudy"."intermediate"."stg_staging_intermediate__loans" rename to "stg_staging_intermediate__loans__dbt_backup"
[0m02:30:09.164851 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:30:09.166449 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__loans"
[0m02:30:09.166653 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__loans: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_staging_intermediate__loans"} */
alter table "casestudy"."intermediate"."stg_staging_intermediate__loans__dbt_tmp" rename to "stg_staging_intermediate__loans"
[0m02:30:09.166981 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:30:09.167918 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__loans: COMMIT
[0m02:30:09.168115 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__loans"
[0m02:30:09.168291 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__loans: COMMIT
[0m02:30:09.170180 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:30:09.171556 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__loans"
[0m02:30:09.171759 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__loans: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_staging_intermediate__loans"} */
drop table if exists "casestudy"."intermediate"."stg_staging_intermediate__loans__dbt_backup" cascade
[0m02:30:09.172736 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:30:09.173455 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.stg_staging_intermediate__loans (execute): 02:30:09.141495 => 02:30:09.173357
[0m02:30:09.173646 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__loans: Close
[0m02:30:09.187746 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f9c6553f-5fe9-4ba1-91f8-90d6cbeef8c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c7a2baab5d0>]}
[0m02:30:09.188138 [info ] [Thread-1 (]: 10 of 11 OK created sql table model intermediate.stg_staging_intermediate__loans  [[32mOK[0m in 0.05s]
[0m02:30:09.188455 [debug] [Thread-1 (]: Finished running node model.vg_casestudy.stg_staging_intermediate__loans
[0m02:30:09.188682 [debug] [Thread-1 (]: Began running node model.vg_casestudy.stg_staging_intermediate__transactions
[0m02:30:09.189003 [info ] [Thread-1 (]: 11 of 11 START sql table model intermediate.stg_staging_intermediate__transactions  [RUN]
[0m02:30:09.189371 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.vg_casestudy.stg_staging_intermediate__loans, now model.vg_casestudy.stg_staging_intermediate__transactions)
[0m02:30:09.189586 [debug] [Thread-1 (]: Began compiling node model.vg_casestudy.stg_staging_intermediate__transactions
[0m02:30:09.191298 [debug] [Thread-1 (]: Writing injected SQL for node "model.vg_casestudy.stg_staging_intermediate__transactions"
[0m02:30:09.191657 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.stg_staging_intermediate__transactions (compile): 02:30:09.189709 => 02:30:09.191535
[0m02:30:09.191850 [debug] [Thread-1 (]: Began executing node model.vg_casestudy.stg_staging_intermediate__transactions
[0m02:30:09.193835 [debug] [Thread-1 (]: Writing runtime sql for node "model.vg_casestudy.stg_staging_intermediate__transactions"
[0m02:30:09.194149 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__transactions"
[0m02:30:09.194348 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__transactions: BEGIN
[0m02:30:09.194519 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:30:09.203816 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:30:09.204288 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__transactions"
[0m02:30:09.204635 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__transactions: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_staging_intermediate__transactions"} */

  
    
    

    create  table
      "casestudy"."intermediate"."stg_staging_intermediate__transactions__dbt_tmp"
  
    as (
      with staging as (
    select * from "casestudy"."staging"."stg_raw_staging__transactions"
),

filtered as (
    select
        transaction_id,
        transaction_date,
        account_id,
        transaction_type,
        transaction_amount,
        transaction_currency
    from staging
    where not has_date_parsing_error
)

select * from filtered
    );
  
  
[0m02:30:09.242877 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:30:09.244876 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__transactions"
[0m02:30:09.245095 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__transactions: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_staging_intermediate__transactions"} */
alter table "casestudy"."intermediate"."stg_staging_intermediate__transactions" rename to "stg_staging_intermediate__transactions__dbt_backup"
[0m02:30:09.245513 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:30:09.247404 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__transactions"
[0m02:30:09.247630 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__transactions: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_staging_intermediate__transactions"} */
alter table "casestudy"."intermediate"."stg_staging_intermediate__transactions__dbt_tmp" rename to "stg_staging_intermediate__transactions"
[0m02:30:09.247996 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:30:09.248983 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__transactions: COMMIT
[0m02:30:09.249184 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__transactions"
[0m02:30:09.249359 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__transactions: COMMIT
[0m02:30:09.254721 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:30:09.256140 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__transactions"
[0m02:30:09.256341 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__transactions: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_staging_intermediate__transactions"} */
drop table if exists "casestudy"."intermediate"."stg_staging_intermediate__transactions__dbt_backup" cascade
[0m02:30:09.257285 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:30:09.258017 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.stg_staging_intermediate__transactions (execute): 02:30:09.191970 => 02:30:09.257918
[0m02:30:09.258220 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__transactions: Close
[0m02:30:09.281836 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f9c6553f-5fe9-4ba1-91f8-90d6cbeef8c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c7a2b74ab90>]}
[0m02:30:09.282586 [info ] [Thread-1 (]: 11 of 11 OK created sql table model intermediate.stg_staging_intermediate__transactions  [[32mOK[0m in 0.09s]
[0m02:30:09.283239 [debug] [Thread-1 (]: Finished running node model.vg_casestudy.stg_staging_intermediate__transactions
[0m02:30:09.284567 [debug] [MainThread]: Using duckdb connection "master"
[0m02:30:09.284758 [debug] [MainThread]: On master: BEGIN
[0m02:30:09.284908 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:30:09.292955 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m02:30:09.293191 [debug] [MainThread]: On master: COMMIT
[0m02:30:09.293345 [debug] [MainThread]: Using duckdb connection "master"
[0m02:30:09.293490 [debug] [MainThread]: On master: COMMIT
[0m02:30:09.293745 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m02:30:09.293909 [debug] [MainThread]: On master: Close
[0m02:30:09.297083 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:30:09.297526 [debug] [MainThread]: Connection 'list_casestudy_staging' was properly closed.
[0m02:30:09.297865 [debug] [MainThread]: Connection 'model.vg_casestudy.stg_staging_intermediate__transactions' was properly closed.
[0m02:30:09.298338 [info ] [MainThread]: 
[0m02:30:09.298726 [info ] [MainThread]: Finished running 5 view models, 6 table models in 0 hours 0 minutes and 0.80 seconds (0.80s).
[0m02:30:09.300402 [debug] [MainThread]: Command end result
[0m02:30:09.311205 [info ] [MainThread]: 
[0m02:30:09.311491 [info ] [MainThread]: [32mCompleted successfully[0m
[0m02:30:09.311656 [info ] [MainThread]: 
[0m02:30:09.311816 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=0 SKIP=0 TOTAL=11
[0m02:30:09.312064 [debug] [MainThread]: Command `dbt run` succeeded at 02:30:09.312006 after 0.95 seconds
[0m02:30:09.312269 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c7a30198d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c7a30303790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c7a3471da50>]}
[0m02:30:09.312457 [debug] [MainThread]: Flushing usage events
[0m02:30:23.684205 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x759a30087590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x759a2fceebd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x759a3256bfd0>]}


============================== 02:30:23.685778 | 679749e6-b802-4fdc-a30c-c04bccfe50f3 ==============================
[0m02:30:23.685778 [info ] [MainThread]: Running with dbt=1.6.18
[0m02:30:23.686062 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/workspaces/varengold_data_analyst_case/transformation', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/workspaces/varengold_data_analyst_case/transformation/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run-operation explore_schemas', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m02:30:23.740984 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '679749e6-b802-4fdc-a30c-c04bccfe50f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x759a2bb76910>]}
[0m02:30:23.748938 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '679749e6-b802-4fdc-a30c-c04bccfe50f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x759a30070f50>]}
[0m02:30:23.749391 [info ] [MainThread]: Registered adapter: duckdb=1.6.2
[0m02:30:23.762428 [debug] [MainThread]: checksum: 7b9fab86a08e9e96a48a825af743c566d95b877e068b8c6d0dbafbf714447189, vars: {}, profile: , target: , version: 1.6.18
[0m02:30:23.786227 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m02:30:23.786514 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m02:30:23.787255 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.vg_casestudy.reporting
- models.vg_casestudy.main
- models.vg_casestudy.marts
[0m02:30:23.792640 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '679749e6-b802-4fdc-a30c-c04bccfe50f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x759a2b95b610>]}
[0m02:30:23.808060 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '679749e6-b802-4fdc-a30c-c04bccfe50f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x759a2b9ab410>]}
[0m02:30:23.808409 [info ] [MainThread]: Found 11 models, 1 analysis, 2 seeds, 71 tests, 5 sources, 0 exposures, 0 metrics, 632 macros, 0 groups, 0 semantic models
[0m02:30:23.808606 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '679749e6-b802-4fdc-a30c-c04bccfe50f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x759a2fab9e50>]}
[0m02:30:23.809024 [debug] [MainThread]: Acquiring new duckdb connection 'macro_explore_schemas'
[0m02:30:23.809209 [debug] [MainThread]: Using duckdb connection "macro_explore_schemas"
[0m02:30:23.809352 [debug] [MainThread]: On macro_explore_schemas: BEGIN
[0m02:30:23.809486 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:30:23.818462 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m02:30:23.818757 [debug] [MainThread]: On macro_explore_schemas: COMMIT
[0m02:30:23.818921 [debug] [MainThread]: Using duckdb connection "macro_explore_schemas"
[0m02:30:23.819069 [debug] [MainThread]: On macro_explore_schemas: COMMIT
[0m02:30:23.819322 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m02:30:23.825150 [debug] [MainThread]: Using duckdb connection "macro_explore_schemas"
[0m02:30:23.825357 [debug] [MainThread]: On macro_explore_schemas: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "macro_explore_schemas"} */

    
        SELECT schema_name FROM information_schema.schemata
    
  
[0m02:30:23.826010 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m02:30:23.826822 [debug] [MainThread]: On macro_explore_schemas: Close
[0m02:30:23.829431 [debug] [MainThread]: Command `dbt run-operation` succeeded at 02:30:23.829352 after 0.15 seconds
[0m02:30:23.829620 [debug] [MainThread]: Connection 'macro_explore_schemas' was properly closed.
[0m02:30:23.829802 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x759a2b9aa410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x759a2b9a8e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x759a2b9a8550>]}
[0m02:30:23.830016 [debug] [MainThread]: Flushing usage events
[0m02:32:03.645803 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e9cad73d610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e9cad8f8850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e9cadd27f50>]}


============================== 02:32:03.649166 | 5f0c7093-2535-4b97-bc14-eac63ff1fdfe ==============================
[0m02:32:03.649166 [info ] [MainThread]: Running with dbt=1.6.18
[0m02:32:03.649531 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/workspaces/varengold_data_analyst_case/transformation', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/workspaces/varengold_data_analyst_case/transformation/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run-operation explore_schemas', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m02:32:03.701725 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5f0c7093-2535-4b97-bc14-eac63ff1fdfe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e9cad750d10>]}
[0m02:32:03.709527 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5f0c7093-2535-4b97-bc14-eac63ff1fdfe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e9cadd56850>]}
[0m02:32:03.709906 [info ] [MainThread]: Registered adapter: duckdb=1.6.2
[0m02:32:03.722599 [debug] [MainThread]: checksum: 7b9fab86a08e9e96a48a825af743c566d95b877e068b8c6d0dbafbf714447189, vars: {}, profile: , target: , version: 1.6.18
[0m02:32:03.744484 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m02:32:03.744787 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m02:32:03.745694 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.vg_casestudy.main
- models.vg_casestudy.reporting
- models.vg_casestudy.marts
[0m02:32:03.749680 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5f0c7093-2535-4b97-bc14-eac63ff1fdfe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e9ca96ac390>]}
[0m02:32:03.762663 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5f0c7093-2535-4b97-bc14-eac63ff1fdfe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e9cad78fa10>]}
[0m02:32:03.763018 [info ] [MainThread]: Found 11 models, 1 analysis, 2 seeds, 71 tests, 5 sources, 0 exposures, 0 metrics, 632 macros, 0 groups, 0 semantic models
[0m02:32:03.763229 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5f0c7093-2535-4b97-bc14-eac63ff1fdfe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e9cadd24490>]}
[0m02:32:03.763658 [debug] [MainThread]: Acquiring new duckdb connection 'macro_explore_schemas'
[0m02:32:03.763837 [debug] [MainThread]: Using duckdb connection "macro_explore_schemas"
[0m02:32:03.763986 [debug] [MainThread]: On macro_explore_schemas: BEGIN
[0m02:32:03.764129 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:32:03.773162 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m02:32:03.773429 [debug] [MainThread]: On macro_explore_schemas: COMMIT
[0m02:32:03.773594 [debug] [MainThread]: Using duckdb connection "macro_explore_schemas"
[0m02:32:03.773742 [debug] [MainThread]: On macro_explore_schemas: COMMIT
[0m02:32:03.773985 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m02:32:03.779948 [debug] [MainThread]: Using duckdb connection "macro_explore_schemas"
[0m02:32:03.780202 [debug] [MainThread]: On macro_explore_schemas: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "macro_explore_schemas"} */

    
        SELECT schema_name FROM information_schema.schemata
    
  
[0m02:32:03.781210 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m02:32:03.782183 [debug] [MainThread]: On macro_explore_schemas: Close
[0m02:32:03.785296 [debug] [MainThread]: Command `dbt run-operation` succeeded at 02:32:03.785217 after 0.14 seconds
[0m02:32:03.785497 [debug] [MainThread]: Connection 'macro_explore_schemas' was properly closed.
[0m02:32:03.785678 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e9cae31db50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e9cad75fdd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e9caa09fbd0>]}
[0m02:32:03.785883 [debug] [MainThread]: Flushing usage events
[0m14:30:25.349156 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6eb1262850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6eb16cbf50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6eb1268410>]}


============================== 14:30:25.389227 | 10c491be-18e4-4a12-8795-1b3096a1cf7b ==============================
[0m14:30:25.389227 [info ] [MainThread]: Running with dbt=1.6.18
[0m14:30:25.399448 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/workspaces/vg_case_study_tim/transformation', 'log_path': '/workspaces/vg_case_study_tim/transformation/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt deps', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:30:25.706483 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '10c491be-18e4-4a12-8795-1b3096a1cf7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6eb1457510>]}
[0m14:30:25.710772 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-kslpa1n4'
[0m14:30:25.712165 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:30:25.890014 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:30:25.893902 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/codegen.json
[0m14:30:25.960719 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/codegen.json 200
[0m14:30:25.972383 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:30:26.077431 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:30:26.097437 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/godatadriven/dbt_date.json
[0m14:30:26.174948 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/godatadriven/dbt_date.json 200
[0m14:30:26.235557 [info ] [MainThread]: Installing dbt-labs/codegen
[0m14:30:26.517623 [info ] [MainThread]: Installed from version 0.13.1
[0m14:30:26.519153 [info ] [MainThread]: Up to date!
[0m14:30:26.520481 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '10c491be-18e4-4a12-8795-1b3096a1cf7b', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6eb15c7c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6eb1245d50>]}
[0m14:30:26.521702 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:30:26.955998 [info ] [MainThread]: Installed from version 1.3.0
[0m14:30:26.957086 [info ] [MainThread]: Up to date!
[0m14:30:26.958355 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '10c491be-18e4-4a12-8795-1b3096a1cf7b', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6eb33b6390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6eb15c7810>]}
[0m14:30:26.960848 [info ] [MainThread]: Installing godatadriven/dbt_date
[0m14:30:27.234634 [info ] [MainThread]: Installed from version 0.11.0
[0m14:30:27.235785 [info ] [MainThread]: Updated version available: 0.14.2
[0m14:30:27.236833 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '10c491be-18e4-4a12-8795-1b3096a1cf7b', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6eb1b17010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6eb0e28490>]}
[0m14:30:27.238098 [info ] [MainThread]: 
[0m14:30:27.239165 [info ] [MainThread]: Updates available for packages: ['godatadriven/dbt_date']                 
Update your versions in packages.yml, then run dbt deps
[0m14:30:27.241311 [debug] [MainThread]: Command `dbt deps` succeeded at 14:30:27.241037 after 1.96 seconds
[0m14:30:27.243549 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6eb5ad8e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6eb1b17310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6eb15b0410>]}
[0m14:30:27.246455 [debug] [MainThread]: Flushing usage events
[0m14:30:40.159773 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5723feafd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5723ffc410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f572404fbd0>]}


============================== 14:30:40.167020 | c40f80b7-3706-4ae1-bc2c-bbc76e981492 ==============================
[0m14:30:40.167020 [info ] [MainThread]: Running with dbt=1.6.18
[0m14:30:40.169108 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/workspaces/vg_case_study_tim/transformation/logs', 'version_check': 'True', 'profiles_dir': '/workspaces/vg_case_study_tim/transformation', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt debug', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:30:40.170674 [info ] [MainThread]: dbt version: 1.6.18
[0m14:30:40.172282 [info ] [MainThread]: python version: 3.11.6
[0m14:30:40.173814 [info ] [MainThread]: python path: /usr/local/bin/python
[0m14:30:40.175052 [info ] [MainThread]: os info: Linux-5.15.153.1-microsoft-standard-WSL2-x86_64-with-glibc2.31
[0m14:30:40.416650 [info ] [MainThread]: Using profiles dir at /workspaces/vg_case_study_tim/transformation
[0m14:30:40.418280 [info ] [MainThread]: Using profiles.yml file at /workspaces/vg_case_study_tim/transformation/profiles.yml
[0m14:30:40.419488 [info ] [MainThread]: Using dbt_project.yml file at /workspaces/vg_case_study_tim/transformation/dbt_project.yml
[0m14:30:40.421121 [info ] [MainThread]: adapter type: duckdb
[0m14:30:40.422123 [info ] [MainThread]: adapter version: 1.6.2
[0m14:30:40.545626 [info ] [MainThread]: Configuration:
[0m14:30:40.547961 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m14:30:40.549916 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m14:30:40.551939 [info ] [MainThread]: Required dependencies:
[0m14:30:40.558441 [debug] [MainThread]: Executing "git --help"
[0m14:30:40.566177 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m14:30:40.571903 [debug] [MainThread]: STDERR: "b''"
[0m14:30:40.573844 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m14:30:40.575284 [info ] [MainThread]: Connection:
[0m14:30:40.577207 [info ] [MainThread]:   database: casestudy
[0m14:30:40.578643 [info ] [MainThread]:   schema: main
[0m14:30:40.580031 [info ] [MainThread]:   path: casestudy.duckdb
[0m14:30:40.581359 [info ] [MainThread]:   config_options: None
[0m14:30:40.582685 [info ] [MainThread]:   extensions: ['icu']
[0m14:30:40.584389 [info ] [MainThread]:   settings: None
[0m14:30:40.594500 [info ] [MainThread]:   external_root: .
[0m14:30:40.596138 [info ] [MainThread]:   use_credential_provider: None
[0m14:30:40.597786 [info ] [MainThread]:   attach: None
[0m14:30:40.599171 [info ] [MainThread]:   filesystems: None
[0m14:30:40.600378 [info ] [MainThread]:   remote: None
[0m14:30:40.601695 [info ] [MainThread]:   plugins: None
[0m14:30:40.603234 [info ] [MainThread]:   disable_transactions: False
[0m14:30:40.616081 [info ] [MainThread]: Registered adapter: duckdb=1.6.2
[0m14:30:40.618707 [debug] [MainThread]: Acquiring new duckdb connection 'debug'
[0m14:30:40.620347 [debug] [MainThread]: Using duckdb connection "debug"
[0m14:30:40.621896 [debug] [MainThread]: On debug: select 1 as id
[0m14:30:40.623322 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:30:44.898579 [debug] [MainThread]: SQL status: OK in 4.0 seconds
[0m14:30:44.902311 [debug] [MainThread]: On debug: Close
[0m14:30:44.909643 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m14:30:44.911959 [info ] [MainThread]: [32mAll checks passed![0m
[0m14:30:44.914279 [debug] [MainThread]: Command `dbt debug` succeeded at 14:30:44.913715 after 4.78 seconds
[0m14:30:44.915616 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m14:30:44.917062 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5724533590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5723da78d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f57245ba2d0>]}
[0m14:30:44.918525 [debug] [MainThread]: Flushing usage events
[0m14:49:18.981596 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe4e1167d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe4e130c6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe4e0df6050>]}


============================== 14:49:18.987981 | 93be8bfe-df18-4822-892d-5fa1eef69cac ==============================
[0m14:49:18.987981 [info ] [MainThread]: Running with dbt=1.6.18
[0m14:49:18.988624 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/workspaces/vg_case_study_tim/transformation/logs', 'debug': 'False', 'profiles_dir': '/workspaces/vg_case_study_tim/transformation', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt docs generate', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:49:19.151766 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '93be8bfe-df18-4822-892d-5fa1eef69cac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe4dd48e550>]}
[0m14:49:19.166716 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '93be8bfe-df18-4822-892d-5fa1eef69cac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe4e0e171d0>]}
[0m14:49:19.167919 [info ] [MainThread]: Registered adapter: duckdb=1.6.2
[0m14:49:19.194569 [debug] [MainThread]: checksum: 7b9fab86a08e9e96a48a825af743c566d95b877e068b8c6d0dbafbf714447189, vars: {}, profile: , target: , version: 1.6.18
[0m14:49:19.258703 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:49:19.259150 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:49:19.260346 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.vg_casestudy.reporting
- models.vg_casestudy.marts
- models.vg_casestudy.main
[0m14:49:19.267822 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '93be8bfe-df18-4822-892d-5fa1eef69cac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe4e0e46b10>]}
[0m14:49:19.278567 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '93be8bfe-df18-4822-892d-5fa1eef69cac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe4dca569d0>]}
[0m14:49:19.279114 [info ] [MainThread]: Found 11 models, 1 analysis, 2 seeds, 71 tests, 5 sources, 0 exposures, 0 metrics, 632 macros, 0 groups, 0 semantic models
[0m14:49:19.279523 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '93be8bfe-df18-4822-892d-5fa1eef69cac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe4e0ea2d50>]}
[0m14:49:19.284499 [info ] [MainThread]: 
[0m14:49:19.285426 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:49:19.287035 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_casestudy_intermediate'
[0m14:49:19.297966 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_intermediate"
[0m14:49:19.298446 [debug] [ThreadPool]: On list_casestudy_intermediate: BEGIN
[0m14:49:19.298741 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:49:19.388166 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:49:19.388593 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_intermediate"
[0m14:49:19.388894 [debug] [ThreadPool]: On list_casestudy_intermediate: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_intermediate"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'intermediate'
    and table_catalog = 'casestudy'
  
[0m14:49:19.406079 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:49:19.407533 [debug] [ThreadPool]: On list_casestudy_intermediate: ROLLBACK
[0m14:49:19.409034 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_intermediate'
[0m14:49:19.409348 [debug] [ThreadPool]: On list_casestudy_intermediate: Close
[0m14:49:19.413645 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy_intermediate, now list_casestudy_raw)
[0m14:49:19.416006 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_raw"
[0m14:49:19.416353 [debug] [ThreadPool]: On list_casestudy_raw: BEGIN
[0m14:49:19.416683 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:49:19.428110 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:49:19.428676 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_raw"
[0m14:49:19.429026 [debug] [ThreadPool]: On list_casestudy_raw: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_raw"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'raw'
    and table_catalog = 'casestudy'
  
[0m14:49:19.439607 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:49:19.441047 [debug] [ThreadPool]: On list_casestudy_raw: ROLLBACK
[0m14:49:19.441535 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_raw'
[0m14:49:19.441814 [debug] [ThreadPool]: On list_casestudy_raw: Close
[0m14:49:19.444899 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy_raw, now list_casestudy_staging)
[0m14:49:19.447156 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_staging"
[0m14:49:19.447506 [debug] [ThreadPool]: On list_casestudy_staging: BEGIN
[0m14:49:19.447803 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:49:19.458114 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:49:19.458590 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_staging"
[0m14:49:19.458890 [debug] [ThreadPool]: On list_casestudy_staging: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_staging"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'staging'
    and table_catalog = 'casestudy'
  
[0m14:49:19.467676 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:49:19.468952 [debug] [ThreadPool]: On list_casestudy_staging: ROLLBACK
[0m14:49:19.469388 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_staging'
[0m14:49:19.469668 [debug] [ThreadPool]: On list_casestudy_staging: Close
[0m14:49:19.473397 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '93be8bfe-df18-4822-892d-5fa1eef69cac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe4e0ea2d50>]}
[0m14:49:19.474291 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:49:19.474744 [info ] [MainThread]: 
[0m14:49:19.485781 [debug] [Thread-1 (]: Began running node model.vg_casestudy.stg_raw_staging__accounts
[0m14:49:19.487020 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_casestudy_staging, now model.vg_casestudy.stg_raw_staging__accounts)
[0m14:49:19.487451 [debug] [Thread-1 (]: Began compiling node model.vg_casestudy.stg_raw_staging__accounts
[0m14:49:19.497819 [debug] [Thread-1 (]: Writing injected SQL for node "model.vg_casestudy.stg_raw_staging__accounts"
[0m14:49:19.498786 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.stg_raw_staging__accounts (compile): 14:49:19.487685 => 14:49:19.498560
[0m14:49:19.499159 [debug] [Thread-1 (]: Began executing node model.vg_casestudy.stg_raw_staging__accounts
[0m14:49:19.499575 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.stg_raw_staging__accounts (execute): 14:49:19.499410 => 14:49:19.499425
[0m14:49:19.500397 [debug] [Thread-1 (]: Finished running node model.vg_casestudy.stg_raw_staging__accounts
[0m14:49:19.500828 [debug] [Thread-1 (]: Began running node model.vg_casestudy.stg_raw_staging__customers
[0m14:49:19.501796 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.vg_casestudy.stg_raw_staging__accounts, now model.vg_casestudy.stg_raw_staging__customers)
[0m14:49:19.502175 [debug] [Thread-1 (]: Began compiling node model.vg_casestudy.stg_raw_staging__customers
[0m14:49:19.505278 [debug] [Thread-1 (]: Writing injected SQL for node "model.vg_casestudy.stg_raw_staging__customers"
[0m14:49:19.505891 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.stg_raw_staging__customers (compile): 14:49:19.502424 => 14:49:19.505704
[0m14:49:19.506218 [debug] [Thread-1 (]: Began executing node model.vg_casestudy.stg_raw_staging__customers
[0m14:49:19.506590 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.stg_raw_staging__customers (execute): 14:49:19.506435 => 14:49:19.506446
[0m14:49:19.507387 [debug] [Thread-1 (]: Finished running node model.vg_casestudy.stg_raw_staging__customers
[0m14:49:19.507759 [debug] [Thread-1 (]: Began running node model.vg_casestudy.stg_raw_staging__fx_rates
[0m14:49:19.508360 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.vg_casestudy.stg_raw_staging__customers, now model.vg_casestudy.stg_raw_staging__fx_rates)
[0m14:49:19.508691 [debug] [Thread-1 (]: Began compiling node model.vg_casestudy.stg_raw_staging__fx_rates
[0m14:49:19.515449 [debug] [Thread-1 (]: Writing injected SQL for node "model.vg_casestudy.stg_raw_staging__fx_rates"
[0m14:49:19.516195 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.stg_raw_staging__fx_rates (compile): 14:49:19.508910 => 14:49:19.515965
[0m14:49:19.516563 [debug] [Thread-1 (]: Began executing node model.vg_casestudy.stg_raw_staging__fx_rates
[0m14:49:19.516956 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.stg_raw_staging__fx_rates (execute): 14:49:19.516789 => 14:49:19.516799
[0m14:49:19.517715 [debug] [Thread-1 (]: Finished running node model.vg_casestudy.stg_raw_staging__fx_rates
[0m14:49:19.518077 [debug] [Thread-1 (]: Began running node model.vg_casestudy.stg_raw_staging__loans
[0m14:49:19.518679 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.vg_casestudy.stg_raw_staging__fx_rates, now model.vg_casestudy.stg_raw_staging__loans)
[0m14:49:19.518993 [debug] [Thread-1 (]: Began compiling node model.vg_casestudy.stg_raw_staging__loans
[0m14:49:19.522589 [debug] [Thread-1 (]: Writing injected SQL for node "model.vg_casestudy.stg_raw_staging__loans"
[0m14:49:19.523861 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.stg_raw_staging__loans (compile): 14:49:19.519213 => 14:49:19.523637
[0m14:49:19.524181 [debug] [Thread-1 (]: Began executing node model.vg_casestudy.stg_raw_staging__loans
[0m14:49:19.524568 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.stg_raw_staging__loans (execute): 14:49:19.524404 => 14:49:19.524414
[0m14:49:19.525283 [debug] [Thread-1 (]: Finished running node model.vg_casestudy.stg_raw_staging__loans
[0m14:49:19.525661 [debug] [Thread-1 (]: Began running node model.vg_casestudy.stg_raw_staging__transactions
[0m14:49:19.526229 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.vg_casestudy.stg_raw_staging__loans, now model.vg_casestudy.stg_raw_staging__transactions)
[0m14:49:19.526537 [debug] [Thread-1 (]: Began compiling node model.vg_casestudy.stg_raw_staging__transactions
[0m14:49:19.530015 [debug] [Thread-1 (]: Writing injected SQL for node "model.vg_casestudy.stg_raw_staging__transactions"
[0m14:49:19.531657 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.stg_raw_staging__transactions (compile): 14:49:19.526761 => 14:49:19.531393
[0m14:49:19.532001 [debug] [Thread-1 (]: Began executing node model.vg_casestudy.stg_raw_staging__transactions
[0m14:49:19.532386 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.stg_raw_staging__transactions (execute): 14:49:19.532226 => 14:49:19.532234
[0m14:49:19.533144 [debug] [Thread-1 (]: Finished running node model.vg_casestudy.stg_raw_staging__transactions
[0m14:49:19.533637 [debug] [Thread-1 (]: Began running node seed.vg_casestudy.currencies
[0m14:49:19.534203 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.vg_casestudy.stg_raw_staging__transactions, now seed.vg_casestudy.currencies)
[0m14:49:19.534525 [debug] [Thread-1 (]: Began compiling node seed.vg_casestudy.currencies
[0m14:49:19.536510 [debug] [Thread-1 (]: Timing info for seed.vg_casestudy.currencies (compile): 14:49:19.534748 => 14:49:19.536362
[0m14:49:19.536832 [debug] [Thread-1 (]: Began executing node seed.vg_casestudy.currencies
[0m14:49:19.537343 [debug] [Thread-1 (]: Timing info for seed.vg_casestudy.currencies (execute): 14:49:19.537177 => 14:49:19.537200
[0m14:49:19.538095 [debug] [Thread-1 (]: Finished running node seed.vg_casestudy.currencies
[0m14:49:19.538439 [debug] [Thread-1 (]: Began running node seed.vg_casestudy.dbt_project_evaluator_exceptions
[0m14:49:19.539012 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.vg_casestudy.currencies, now seed.vg_casestudy.dbt_project_evaluator_exceptions)
[0m14:49:19.539335 [debug] [Thread-1 (]: Began compiling node seed.vg_casestudy.dbt_project_evaluator_exceptions
[0m14:49:19.541111 [debug] [Thread-1 (]: Timing info for seed.vg_casestudy.dbt_project_evaluator_exceptions (compile): 14:49:19.539550 => 14:49:19.540938
[0m14:49:19.541441 [debug] [Thread-1 (]: Began executing node seed.vg_casestudy.dbt_project_evaluator_exceptions
[0m14:49:19.541850 [debug] [Thread-1 (]: Timing info for seed.vg_casestudy.dbt_project_evaluator_exceptions (execute): 14:49:19.541677 => 14:49:19.541684
[0m14:49:19.542584 [debug] [Thread-1 (]: Finished running node seed.vg_casestudy.dbt_project_evaluator_exceptions
[0m14:49:19.542943 [debug] [Thread-1 (]: Began running node model.vg_casestudy.stg_staging_intermediate__accounts
[0m14:49:19.543541 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.vg_casestudy.dbt_project_evaluator_exceptions, now model.vg_casestudy.stg_staging_intermediate__accounts)
[0m14:49:19.543856 [debug] [Thread-1 (]: Began compiling node model.vg_casestudy.stg_staging_intermediate__accounts
[0m14:49:19.546920 [debug] [Thread-1 (]: Writing injected SQL for node "model.vg_casestudy.stg_staging_intermediate__accounts"
[0m14:49:19.548476 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.stg_staging_intermediate__accounts (compile): 14:49:19.544063 => 14:49:19.548236
[0m14:49:19.548917 [debug] [Thread-1 (]: Began executing node model.vg_casestudy.stg_staging_intermediate__accounts
[0m14:49:19.549399 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.stg_staging_intermediate__accounts (execute): 14:49:19.549194 => 14:49:19.549204
[0m14:49:19.550408 [debug] [Thread-1 (]: Finished running node model.vg_casestudy.stg_staging_intermediate__accounts
[0m14:49:19.550917 [debug] [Thread-1 (]: Began running node test.vg_casestudy.accepted_values_stg_raw_staging__accounts_account_type__savings__current.8db4e271bb
[0m14:49:19.551720 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.vg_casestudy.stg_staging_intermediate__accounts, now test.vg_casestudy.accepted_values_stg_raw_staging__accounts_account_type__savings__current.8db4e271bb)
[0m14:49:19.552255 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.accepted_values_stg_raw_staging__accounts_account_type__savings__current.8db4e271bb
[0m14:49:19.564032 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.accepted_values_stg_raw_staging__accounts_account_type__savings__current.8db4e271bb"
[0m14:49:19.565763 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.accepted_values_stg_raw_staging__accounts_account_type__savings__current.8db4e271bb (compile): 14:49:19.552486 => 14:49:19.565526
[0m14:49:19.566130 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.accepted_values_stg_raw_staging__accounts_account_type__savings__current.8db4e271bb
[0m14:49:19.566548 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.accepted_values_stg_raw_staging__accounts_account_type__savings__current.8db4e271bb (execute): 14:49:19.566353 => 14:49:19.566363
[0m14:49:19.567381 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.accepted_values_stg_raw_staging__accounts_account_type__savings__current.8db4e271bb
[0m14:49:19.567795 [debug] [Thread-1 (]: Began running node test.vg_casestudy.date_is_past_stg_raw_staging__accounts_account_opening_date.b05801e56a
[0m14:49:19.568617 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.accepted_values_stg_raw_staging__accounts_account_type__savings__current.8db4e271bb, now test.vg_casestudy.date_is_past_stg_raw_staging__accounts_account_opening_date.b05801e56a)
[0m14:49:19.569134 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.date_is_past_stg_raw_staging__accounts_account_opening_date.b05801e56a
[0m14:49:19.574329 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.date_is_past_stg_raw_staging__accounts_account_opening_date.b05801e56a"
[0m14:49:19.574957 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.date_is_past_stg_raw_staging__accounts_account_opening_date.b05801e56a (compile): 14:49:19.569402 => 14:49:19.574758
[0m14:49:19.575285 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.date_is_past_stg_raw_staging__accounts_account_opening_date.b05801e56a
[0m14:49:19.575711 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.date_is_past_stg_raw_staging__accounts_account_opening_date.b05801e56a (execute): 14:49:19.575541 => 14:49:19.575548
[0m14:49:19.576474 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.date_is_past_stg_raw_staging__accounts_account_opening_date.b05801e56a
[0m14:49:19.576874 [debug] [Thread-1 (]: Began running node test.vg_casestudy.not_null_stg_raw_staging__accounts_account_id.c6fceee87c
[0m14:49:19.577635 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.date_is_past_stg_raw_staging__accounts_account_opening_date.b05801e56a, now test.vg_casestudy.not_null_stg_raw_staging__accounts_account_id.c6fceee87c)
[0m14:49:19.578040 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.not_null_stg_raw_staging__accounts_account_id.c6fceee87c
[0m14:49:19.587530 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.not_null_stg_raw_staging__accounts_account_id.c6fceee87c"
[0m14:49:19.588142 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_stg_raw_staging__accounts_account_id.c6fceee87c (compile): 14:49:19.578250 => 14:49:19.587935
[0m14:49:19.588480 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.not_null_stg_raw_staging__accounts_account_id.c6fceee87c
[0m14:49:19.588886 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_stg_raw_staging__accounts_account_id.c6fceee87c (execute): 14:49:19.588703 => 14:49:19.588710
[0m14:49:19.589601 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.not_null_stg_raw_staging__accounts_account_id.c6fceee87c
[0m14:49:19.589958 [debug] [Thread-1 (]: Began running node test.vg_casestudy.not_null_stg_raw_staging__accounts_account_type.298c80ded4
[0m14:49:19.590541 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.not_null_stg_raw_staging__accounts_account_id.c6fceee87c, now test.vg_casestudy.not_null_stg_raw_staging__accounts_account_type.298c80ded4)
[0m14:49:19.590885 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.not_null_stg_raw_staging__accounts_account_type.298c80ded4
[0m14:49:19.632263 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.not_null_stg_raw_staging__accounts_account_type.298c80ded4"
[0m14:49:19.632871 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_stg_raw_staging__accounts_account_type.298c80ded4 (compile): 14:49:19.591324 => 14:49:19.632692
[0m14:49:19.633262 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.not_null_stg_raw_staging__accounts_account_type.298c80ded4
[0m14:49:19.633676 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_stg_raw_staging__accounts_account_type.298c80ded4 (execute): 14:49:19.633513 => 14:49:19.633520
[0m14:49:19.634373 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.not_null_stg_raw_staging__accounts_account_type.298c80ded4
[0m14:49:19.634725 [debug] [Thread-1 (]: Began running node test.vg_casestudy.not_null_stg_raw_staging__accounts_customer_id.99ecced993
[0m14:49:19.635313 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.not_null_stg_raw_staging__accounts_account_type.298c80ded4, now test.vg_casestudy.not_null_stg_raw_staging__accounts_customer_id.99ecced993)
[0m14:49:19.635626 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.not_null_stg_raw_staging__accounts_customer_id.99ecced993
[0m14:49:19.639426 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.not_null_stg_raw_staging__accounts_customer_id.99ecced993"
[0m14:49:19.640172 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_stg_raw_staging__accounts_customer_id.99ecced993 (compile): 14:49:19.635848 => 14:49:19.639970
[0m14:49:19.640471 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.not_null_stg_raw_staging__accounts_customer_id.99ecced993
[0m14:49:19.640834 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_stg_raw_staging__accounts_customer_id.99ecced993 (execute): 14:49:19.640677 => 14:49:19.640683
[0m14:49:19.641515 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.not_null_stg_raw_staging__accounts_customer_id.99ecced993
[0m14:49:19.641869 [debug] [Thread-1 (]: Began running node test.vg_casestudy.unique_stg_raw_staging__accounts_account_id.cfe13a9c67
[0m14:49:19.642422 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.not_null_stg_raw_staging__accounts_customer_id.99ecced993, now test.vg_casestudy.unique_stg_raw_staging__accounts_account_id.cfe13a9c67)
[0m14:49:19.642821 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.unique_stg_raw_staging__accounts_account_id.cfe13a9c67
[0m14:49:19.649386 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.unique_stg_raw_staging__accounts_account_id.cfe13a9c67"
[0m14:49:19.649966 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.unique_stg_raw_staging__accounts_account_id.cfe13a9c67 (compile): 14:49:19.643224 => 14:49:19.649793
[0m14:49:19.650289 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.unique_stg_raw_staging__accounts_account_id.cfe13a9c67
[0m14:49:19.650700 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.unique_stg_raw_staging__accounts_account_id.cfe13a9c67 (execute): 14:49:19.650533 => 14:49:19.650540
[0m14:49:19.651410 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.unique_stg_raw_staging__accounts_account_id.cfe13a9c67
[0m14:49:19.651783 [debug] [Thread-1 (]: Began running node model.vg_casestudy.stg_staging_intermediate__customers
[0m14:49:19.652353 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.unique_stg_raw_staging__accounts_account_id.cfe13a9c67, now model.vg_casestudy.stg_staging_intermediate__customers)
[0m14:49:19.652688 [debug] [Thread-1 (]: Began compiling node model.vg_casestudy.stg_staging_intermediate__customers
[0m14:49:19.655370 [debug] [Thread-1 (]: Writing injected SQL for node "model.vg_casestudy.stg_staging_intermediate__customers"
[0m14:49:19.656141 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.stg_staging_intermediate__customers (compile): 14:49:19.652932 => 14:49:19.655904
[0m14:49:19.656440 [debug] [Thread-1 (]: Began executing node model.vg_casestudy.stg_staging_intermediate__customers
[0m14:49:19.656818 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.stg_staging_intermediate__customers (execute): 14:49:19.656660 => 14:49:19.656667
[0m14:49:19.657509 [debug] [Thread-1 (]: Finished running node model.vg_casestudy.stg_staging_intermediate__customers
[0m14:49:19.657877 [debug] [Thread-1 (]: Began running node test.vg_casestudy.not_null_stg_raw_staging__customers_age.402d2aacc9
[0m14:49:19.658434 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.vg_casestudy.stg_staging_intermediate__customers, now test.vg_casestudy.not_null_stg_raw_staging__customers_age.402d2aacc9)
[0m14:49:19.659236 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.not_null_stg_raw_staging__customers_age.402d2aacc9
[0m14:49:19.663091 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.not_null_stg_raw_staging__customers_age.402d2aacc9"
[0m14:49:19.664778 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_stg_raw_staging__customers_age.402d2aacc9 (compile): 14:49:19.659469 => 14:49:19.664558
[0m14:49:19.665090 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.not_null_stg_raw_staging__customers_age.402d2aacc9
[0m14:49:19.665464 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_stg_raw_staging__customers_age.402d2aacc9 (execute): 14:49:19.665307 => 14:49:19.665315
[0m14:49:19.666176 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.not_null_stg_raw_staging__customers_age.402d2aacc9
[0m14:49:19.666537 [debug] [Thread-1 (]: Began running node test.vg_casestudy.not_null_stg_raw_staging__customers_branch_id.96cc924db7
[0m14:49:19.667099 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.not_null_stg_raw_staging__customers_age.402d2aacc9, now test.vg_casestudy.not_null_stg_raw_staging__customers_branch_id.96cc924db7)
[0m14:49:19.667413 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.not_null_stg_raw_staging__customers_branch_id.96cc924db7
[0m14:49:19.671186 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.not_null_stg_raw_staging__customers_branch_id.96cc924db7"
[0m14:49:19.671896 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_stg_raw_staging__customers_branch_id.96cc924db7 (compile): 14:49:19.667642 => 14:49:19.671696
[0m14:49:19.672193 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.not_null_stg_raw_staging__customers_branch_id.96cc924db7
[0m14:49:19.672552 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_stg_raw_staging__customers_branch_id.96cc924db7 (execute): 14:49:19.672401 => 14:49:19.672408
[0m14:49:19.673260 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.not_null_stg_raw_staging__customers_branch_id.96cc924db7
[0m14:49:19.673674 [debug] [Thread-1 (]: Began running node test.vg_casestudy.not_null_stg_raw_staging__customers_customer_id.d27d30a04a
[0m14:49:19.674224 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.not_null_stg_raw_staging__customers_branch_id.96cc924db7, now test.vg_casestudy.not_null_stg_raw_staging__customers_customer_id.d27d30a04a)
[0m14:49:19.674883 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.not_null_stg_raw_staging__customers_customer_id.d27d30a04a
[0m14:49:19.678828 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.not_null_stg_raw_staging__customers_customer_id.d27d30a04a"
[0m14:49:19.679413 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_stg_raw_staging__customers_customer_id.d27d30a04a (compile): 14:49:19.675131 => 14:49:19.679230
[0m14:49:19.679715 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.not_null_stg_raw_staging__customers_customer_id.d27d30a04a
[0m14:49:19.680127 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_stg_raw_staging__customers_customer_id.d27d30a04a (execute): 14:49:19.679957 => 14:49:19.679980
[0m14:49:19.680880 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.not_null_stg_raw_staging__customers_customer_id.d27d30a04a
[0m14:49:19.681275 [debug] [Thread-1 (]: Began running node test.vg_casestudy.numeric_range_stg_raw_staging__customers_age__200__18.2b9231d3a8
[0m14:49:19.681896 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.not_null_stg_raw_staging__customers_customer_id.d27d30a04a, now test.vg_casestudy.numeric_range_stg_raw_staging__customers_age__200__18.2b9231d3a8)
[0m14:49:19.682230 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.numeric_range_stg_raw_staging__customers_age__200__18.2b9231d3a8
[0m14:49:19.688528 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.numeric_range_stg_raw_staging__customers_age__200__18.2b9231d3a8"
[0m14:49:19.689048 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.numeric_range_stg_raw_staging__customers_age__200__18.2b9231d3a8 (compile): 14:49:19.682463 => 14:49:19.688883
[0m14:49:19.689360 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.numeric_range_stg_raw_staging__customers_age__200__18.2b9231d3a8
[0m14:49:19.689748 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.numeric_range_stg_raw_staging__customers_age__200__18.2b9231d3a8 (execute): 14:49:19.689584 => 14:49:19.689592
[0m14:49:19.690530 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.numeric_range_stg_raw_staging__customers_age__200__18.2b9231d3a8
[0m14:49:19.690929 [debug] [Thread-1 (]: Began running node test.vg_casestudy.relationships_stg_raw_staging__accounts_customer_id__customer_id__ref_stg_raw_staging__customers_.87454c2c4c
[0m14:49:19.691497 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.numeric_range_stg_raw_staging__customers_age__200__18.2b9231d3a8, now test.vg_casestudy.relationships_stg_raw_staging__accounts_customer_id__customer_id__ref_stg_raw_staging__customers_.87454c2c4c)
[0m14:49:19.691830 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.relationships_stg_raw_staging__accounts_customer_id__customer_id__ref_stg_raw_staging__customers_.87454c2c4c
[0m14:49:19.700575 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.relationships_stg_raw_staging__accounts_customer_id__customer_id__ref_stg_raw_staging__customers_.87454c2c4c"
[0m14:49:19.701228 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.relationships_stg_raw_staging__accounts_customer_id__customer_id__ref_stg_raw_staging__customers_.87454c2c4c (compile): 14:49:19.692076 => 14:49:19.701005
[0m14:49:19.701550 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.relationships_stg_raw_staging__accounts_customer_id__customer_id__ref_stg_raw_staging__customers_.87454c2c4c
[0m14:49:19.701936 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.relationships_stg_raw_staging__accounts_customer_id__customer_id__ref_stg_raw_staging__customers_.87454c2c4c (execute): 14:49:19.701778 => 14:49:19.701785
[0m14:49:19.702636 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.relationships_stg_raw_staging__accounts_customer_id__customer_id__ref_stg_raw_staging__customers_.87454c2c4c
[0m14:49:19.702992 [debug] [Thread-1 (]: Began running node test.vg_casestudy.unique_stg_raw_staging__customers_customer_id.8cd8e9afb0
[0m14:49:19.703607 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.relationships_stg_raw_staging__accounts_customer_id__customer_id__ref_stg_raw_staging__customers_.87454c2c4c, now test.vg_casestudy.unique_stg_raw_staging__customers_customer_id.8cd8e9afb0)
[0m14:49:19.703952 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.unique_stg_raw_staging__customers_customer_id.8cd8e9afb0
[0m14:49:19.707704 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.unique_stg_raw_staging__customers_customer_id.8cd8e9afb0"
[0m14:49:19.708560 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.unique_stg_raw_staging__customers_customer_id.8cd8e9afb0 (compile): 14:49:19.704175 => 14:49:19.708321
[0m14:49:19.708869 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.unique_stg_raw_staging__customers_customer_id.8cd8e9afb0
[0m14:49:19.709247 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.unique_stg_raw_staging__customers_customer_id.8cd8e9afb0 (execute): 14:49:19.709089 => 14:49:19.709096
[0m14:49:19.709989 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.unique_stg_raw_staging__customers_customer_id.8cd8e9afb0
[0m14:49:19.710343 [debug] [Thread-1 (]: Began running node model.vg_casestudy.stg_staging_intermediate__fx_rates
[0m14:49:19.711162 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.unique_stg_raw_staging__customers_customer_id.8cd8e9afb0, now model.vg_casestudy.stg_staging_intermediate__fx_rates)
[0m14:49:19.711475 [debug] [Thread-1 (]: Began compiling node model.vg_casestudy.stg_staging_intermediate__fx_rates
[0m14:49:19.714139 [debug] [Thread-1 (]: Writing injected SQL for node "model.vg_casestudy.stg_staging_intermediate__fx_rates"
[0m14:49:19.714744 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.stg_staging_intermediate__fx_rates (compile): 14:49:19.711691 => 14:49:19.714527
[0m14:49:19.715110 [debug] [Thread-1 (]: Began executing node model.vg_casestudy.stg_staging_intermediate__fx_rates
[0m14:49:19.715489 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.stg_staging_intermediate__fx_rates (execute): 14:49:19.715337 => 14:49:19.715344
[0m14:49:19.716204 [debug] [Thread-1 (]: Finished running node model.vg_casestudy.stg_staging_intermediate__fx_rates
[0m14:49:19.716615 [debug] [Thread-1 (]: Began running node test.vg_casestudy.date_is_past_stg_raw_staging__fx_rates_fx_rate_date.7b2c6986f5
[0m14:49:19.717181 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.vg_casestudy.stg_staging_intermediate__fx_rates, now test.vg_casestudy.date_is_past_stg_raw_staging__fx_rates_fx_rate_date.7b2c6986f5)
[0m14:49:19.717489 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.date_is_past_stg_raw_staging__fx_rates_fx_rate_date.7b2c6986f5
[0m14:49:19.721062 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.date_is_past_stg_raw_staging__fx_rates_fx_rate_date.7b2c6986f5"
[0m14:49:19.722749 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.date_is_past_stg_raw_staging__fx_rates_fx_rate_date.7b2c6986f5 (compile): 14:49:19.717709 => 14:49:19.722495
[0m14:49:19.723120 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.date_is_past_stg_raw_staging__fx_rates_fx_rate_date.7b2c6986f5
[0m14:49:19.723560 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.date_is_past_stg_raw_staging__fx_rates_fx_rate_date.7b2c6986f5 (execute): 14:49:19.723382 => 14:49:19.723405
[0m14:49:19.724382 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.date_is_past_stg_raw_staging__fx_rates_fx_rate_date.7b2c6986f5
[0m14:49:19.724757 [debug] [Thread-1 (]: Began running node test.vg_casestudy.not_null_stg_raw_staging__fx_rates_currency_iso_code.6d09bdebaf
[0m14:49:19.725357 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.date_is_past_stg_raw_staging__fx_rates_fx_rate_date.7b2c6986f5, now test.vg_casestudy.not_null_stg_raw_staging__fx_rates_currency_iso_code.6d09bdebaf)
[0m14:49:19.725677 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.not_null_stg_raw_staging__fx_rates_currency_iso_code.6d09bdebaf
[0m14:49:19.729666 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.not_null_stg_raw_staging__fx_rates_currency_iso_code.6d09bdebaf"
[0m14:49:19.730379 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_stg_raw_staging__fx_rates_currency_iso_code.6d09bdebaf (compile): 14:49:19.725901 => 14:49:19.730160
[0m14:49:19.730687 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.not_null_stg_raw_staging__fx_rates_currency_iso_code.6d09bdebaf
[0m14:49:19.731056 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_stg_raw_staging__fx_rates_currency_iso_code.6d09bdebaf (execute): 14:49:19.730909 => 14:49:19.730916
[0m14:49:19.731761 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.not_null_stg_raw_staging__fx_rates_currency_iso_code.6d09bdebaf
[0m14:49:19.732139 [debug] [Thread-1 (]: Began running node test.vg_casestudy.not_null_stg_raw_staging__fx_rates_fx_rate.1c32f22fac
[0m14:49:19.732703 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.not_null_stg_raw_staging__fx_rates_currency_iso_code.6d09bdebaf, now test.vg_casestudy.not_null_stg_raw_staging__fx_rates_fx_rate.1c32f22fac)
[0m14:49:19.733031 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.not_null_stg_raw_staging__fx_rates_fx_rate.1c32f22fac
[0m14:49:19.736905 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.not_null_stg_raw_staging__fx_rates_fx_rate.1c32f22fac"
[0m14:49:19.737403 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_stg_raw_staging__fx_rates_fx_rate.1c32f22fac (compile): 14:49:19.733437 => 14:49:19.737250
[0m14:49:19.737713 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.not_null_stg_raw_staging__fx_rates_fx_rate.1c32f22fac
[0m14:49:19.738082 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_stg_raw_staging__fx_rates_fx_rate.1c32f22fac (execute): 14:49:19.737931 => 14:49:19.737937
[0m14:49:19.738931 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.not_null_stg_raw_staging__fx_rates_fx_rate.1c32f22fac
[0m14:49:19.739311 [debug] [Thread-1 (]: Began running node test.vg_casestudy.not_null_stg_raw_staging__fx_rates_has_date_parsing_error.2f51154c3b
[0m14:49:19.739904 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.not_null_stg_raw_staging__fx_rates_fx_rate.1c32f22fac, now test.vg_casestudy.not_null_stg_raw_staging__fx_rates_has_date_parsing_error.2f51154c3b)
[0m14:49:19.740230 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.not_null_stg_raw_staging__fx_rates_has_date_parsing_error.2f51154c3b
[0m14:49:19.744070 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.not_null_stg_raw_staging__fx_rates_has_date_parsing_error.2f51154c3b"
[0m14:49:19.744796 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_stg_raw_staging__fx_rates_has_date_parsing_error.2f51154c3b (compile): 14:49:19.740456 => 14:49:19.744594
[0m14:49:19.745098 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.not_null_stg_raw_staging__fx_rates_has_date_parsing_error.2f51154c3b
[0m14:49:19.745469 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_stg_raw_staging__fx_rates_has_date_parsing_error.2f51154c3b (execute): 14:49:19.745313 => 14:49:19.745319
[0m14:49:19.746146 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.not_null_stg_raw_staging__fx_rates_has_date_parsing_error.2f51154c3b
[0m14:49:19.746514 [debug] [Thread-1 (]: Began running node test.vg_casestudy.numeric_range_stg_raw_staging__fx_rates_fx_rate__0.ccd53e1d91
[0m14:49:19.747161 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.not_null_stg_raw_staging__fx_rates_has_date_parsing_error.2f51154c3b, now test.vg_casestudy.numeric_range_stg_raw_staging__fx_rates_fx_rate__0.ccd53e1d91)
[0m14:49:19.747481 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.numeric_range_stg_raw_staging__fx_rates_fx_rate__0.ccd53e1d91
[0m14:49:19.751143 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.numeric_range_stg_raw_staging__fx_rates_fx_rate__0.ccd53e1d91"
[0m14:49:19.751850 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.numeric_range_stg_raw_staging__fx_rates_fx_rate__0.ccd53e1d91 (compile): 14:49:19.747710 => 14:49:19.751652
[0m14:49:19.752148 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.numeric_range_stg_raw_staging__fx_rates_fx_rate__0.ccd53e1d91
[0m14:49:19.752524 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.numeric_range_stg_raw_staging__fx_rates_fx_rate__0.ccd53e1d91 (execute): 14:49:19.752368 => 14:49:19.752374
[0m14:49:19.753214 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.numeric_range_stg_raw_staging__fx_rates_fx_rate__0.ccd53e1d91
[0m14:49:19.753583 [debug] [Thread-1 (]: Began running node test.vg_casestudy.unique_stg_raw_staging__fx_rates_currency_iso_code.b1e6b26758
[0m14:49:19.754134 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.numeric_range_stg_raw_staging__fx_rates_fx_rate__0.ccd53e1d91, now test.vg_casestudy.unique_stg_raw_staging__fx_rates_currency_iso_code.b1e6b26758)
[0m14:49:19.754475 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.unique_stg_raw_staging__fx_rates_currency_iso_code.b1e6b26758
[0m14:49:19.758283 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.unique_stg_raw_staging__fx_rates_currency_iso_code.b1e6b26758"
[0m14:49:19.758906 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.unique_stg_raw_staging__fx_rates_currency_iso_code.b1e6b26758 (compile): 14:49:19.754764 => 14:49:19.758730
[0m14:49:19.759196 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.unique_stg_raw_staging__fx_rates_currency_iso_code.b1e6b26758
[0m14:49:19.759558 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.unique_stg_raw_staging__fx_rates_currency_iso_code.b1e6b26758 (execute): 14:49:19.759401 => 14:49:19.759407
[0m14:49:19.760261 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.unique_stg_raw_staging__fx_rates_currency_iso_code.b1e6b26758
[0m14:49:19.760636 [debug] [Thread-1 (]: Began running node model.vg_casestudy.stg_staging_intermediate__loans
[0m14:49:19.761220 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.unique_stg_raw_staging__fx_rates_currency_iso_code.b1e6b26758, now model.vg_casestudy.stg_staging_intermediate__loans)
[0m14:49:19.761534 [debug] [Thread-1 (]: Began compiling node model.vg_casestudy.stg_staging_intermediate__loans
[0m14:49:19.764291 [debug] [Thread-1 (]: Writing injected SQL for node "model.vg_casestudy.stg_staging_intermediate__loans"
[0m14:49:19.764975 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.stg_staging_intermediate__loans (compile): 14:49:19.761759 => 14:49:19.764776
[0m14:49:19.765287 [debug] [Thread-1 (]: Began executing node model.vg_casestudy.stg_staging_intermediate__loans
[0m14:49:19.765664 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.stg_staging_intermediate__loans (execute): 14:49:19.765503 => 14:49:19.765509
[0m14:49:19.766378 [debug] [Thread-1 (]: Finished running node model.vg_casestudy.stg_staging_intermediate__loans
[0m14:49:19.766743 [debug] [Thread-1 (]: Began running node test.vg_casestudy.accepted_values_stg_raw_staging__loans_loan_status__approved__rejected__closed.667473d6c1
[0m14:49:19.767304 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.vg_casestudy.stg_staging_intermediate__loans, now test.vg_casestudy.accepted_values_stg_raw_staging__loans_loan_status__approved__rejected__closed.667473d6c1)
[0m14:49:19.767631 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.accepted_values_stg_raw_staging__loans_loan_status__approved__rejected__closed.667473d6c1
[0m14:49:19.774833 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.accepted_values_stg_raw_staging__loans_loan_status__approved__rejected__closed.667473d6c1"
[0m14:49:19.776427 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.accepted_values_stg_raw_staging__loans_loan_status__approved__rejected__closed.667473d6c1 (compile): 14:49:19.767845 => 14:49:19.776207
[0m14:49:19.776752 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.accepted_values_stg_raw_staging__loans_loan_status__approved__rejected__closed.667473d6c1
[0m14:49:19.777136 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.accepted_values_stg_raw_staging__loans_loan_status__approved__rejected__closed.667473d6c1 (execute): 14:49:19.776976 => 14:49:19.776983
[0m14:49:19.777871 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.accepted_values_stg_raw_staging__loans_loan_status__approved__rejected__closed.667473d6c1
[0m14:49:19.778239 [debug] [Thread-1 (]: Began running node test.vg_casestudy.accepted_values_stg_raw_staging__loans_loan_term__12__24__36__48__60.88d346fe3c
[0m14:49:19.778811 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.accepted_values_stg_raw_staging__loans_loan_status__approved__rejected__closed.667473d6c1, now test.vg_casestudy.accepted_values_stg_raw_staging__loans_loan_term__12__24__36__48__60.88d346fe3c)
[0m14:49:19.779125 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.accepted_values_stg_raw_staging__loans_loan_term__12__24__36__48__60.88d346fe3c
[0m14:49:19.783169 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.accepted_values_stg_raw_staging__loans_loan_term__12__24__36__48__60.88d346fe3c"
[0m14:49:19.783942 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.accepted_values_stg_raw_staging__loans_loan_term__12__24__36__48__60.88d346fe3c (compile): 14:49:19.779349 => 14:49:19.783746
[0m14:49:19.784247 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.accepted_values_stg_raw_staging__loans_loan_term__12__24__36__48__60.88d346fe3c
[0m14:49:19.784618 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.accepted_values_stg_raw_staging__loans_loan_term__12__24__36__48__60.88d346fe3c (execute): 14:49:19.784464 => 14:49:19.784470
[0m14:49:19.785314 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.accepted_values_stg_raw_staging__loans_loan_term__12__24__36__48__60.88d346fe3c
[0m14:49:19.785698 [debug] [Thread-1 (]: Began running node test.vg_casestudy.accepted_values_stg_raw_staging__loans_loan_type__personal__mortgage__auto.f98f448e68
[0m14:49:19.786272 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.accepted_values_stg_raw_staging__loans_loan_term__12__24__36__48__60.88d346fe3c, now test.vg_casestudy.accepted_values_stg_raw_staging__loans_loan_type__personal__mortgage__auto.f98f448e68)
[0m14:49:19.786806 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.accepted_values_stg_raw_staging__loans_loan_type__personal__mortgage__auto.f98f448e68
[0m14:49:19.793413 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.accepted_values_stg_raw_staging__loans_loan_type__personal__mortgage__auto.f98f448e68"
[0m14:49:19.794042 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.accepted_values_stg_raw_staging__loans_loan_type__personal__mortgage__auto.f98f448e68 (compile): 14:49:19.787271 => 14:49:19.793848
[0m14:49:19.794389 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.accepted_values_stg_raw_staging__loans_loan_type__personal__mortgage__auto.f98f448e68
[0m14:49:19.794791 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.accepted_values_stg_raw_staging__loans_loan_type__personal__mortgage__auto.f98f448e68 (execute): 14:49:19.794621 => 14:49:19.794645
[0m14:49:19.795534 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.accepted_values_stg_raw_staging__loans_loan_type__personal__mortgage__auto.f98f448e68
[0m14:49:19.795907 [debug] [Thread-1 (]: Began running node test.vg_casestudy.date_is_past_stg_raw_staging__loans_approval_rejection_date.92db02c0aa
[0m14:49:19.796488 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.accepted_values_stg_raw_staging__loans_loan_type__personal__mortgage__auto.f98f448e68, now test.vg_casestudy.date_is_past_stg_raw_staging__loans_approval_rejection_date.92db02c0aa)
[0m14:49:19.796851 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.date_is_past_stg_raw_staging__loans_approval_rejection_date.92db02c0aa
[0m14:49:19.800551 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.date_is_past_stg_raw_staging__loans_approval_rejection_date.92db02c0aa"
[0m14:49:19.801068 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.date_is_past_stg_raw_staging__loans_approval_rejection_date.92db02c0aa (compile): 14:49:19.797176 => 14:49:19.800896
[0m14:49:19.801400 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.date_is_past_stg_raw_staging__loans_approval_rejection_date.92db02c0aa
[0m14:49:19.801777 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.date_is_past_stg_raw_staging__loans_approval_rejection_date.92db02c0aa (execute): 14:49:19.801606 => 14:49:19.801630
[0m14:49:19.802796 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.date_is_past_stg_raw_staging__loans_approval_rejection_date.92db02c0aa
[0m14:49:19.803211 [debug] [Thread-1 (]: Began running node test.vg_casestudy.not_null_stg_raw_staging__loans_approval_rejection_date.6c82d62e88
[0m14:49:19.803815 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.date_is_past_stg_raw_staging__loans_approval_rejection_date.92db02c0aa, now test.vg_casestudy.not_null_stg_raw_staging__loans_approval_rejection_date.6c82d62e88)
[0m14:49:19.804165 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.not_null_stg_raw_staging__loans_approval_rejection_date.6c82d62e88
[0m14:49:19.807913 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.not_null_stg_raw_staging__loans_approval_rejection_date.6c82d62e88"
[0m14:49:19.808560 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_stg_raw_staging__loans_approval_rejection_date.6c82d62e88 (compile): 14:49:19.804399 => 14:49:19.808380
[0m14:49:19.808844 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.not_null_stg_raw_staging__loans_approval_rejection_date.6c82d62e88
[0m14:49:19.809203 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_stg_raw_staging__loans_approval_rejection_date.6c82d62e88 (execute): 14:49:19.809049 => 14:49:19.809055
[0m14:49:19.809900 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.not_null_stg_raw_staging__loans_approval_rejection_date.6c82d62e88
[0m14:49:19.810266 [debug] [Thread-1 (]: Began running node test.vg_casestudy.not_null_stg_raw_staging__loans_interest_rate.af6bbce27a
[0m14:49:19.810832 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.not_null_stg_raw_staging__loans_approval_rejection_date.6c82d62e88, now test.vg_casestudy.not_null_stg_raw_staging__loans_interest_rate.af6bbce27a)
[0m14:49:19.811145 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.not_null_stg_raw_staging__loans_interest_rate.af6bbce27a
[0m14:49:19.815093 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.not_null_stg_raw_staging__loans_interest_rate.af6bbce27a"
[0m14:49:19.815733 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_stg_raw_staging__loans_interest_rate.af6bbce27a (compile): 14:49:19.811364 => 14:49:19.815555
[0m14:49:19.816036 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.not_null_stg_raw_staging__loans_interest_rate.af6bbce27a
[0m14:49:19.816419 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_stg_raw_staging__loans_interest_rate.af6bbce27a (execute): 14:49:19.816266 => 14:49:19.816272
[0m14:49:19.817098 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.not_null_stg_raw_staging__loans_interest_rate.af6bbce27a
[0m14:49:19.817461 [debug] [Thread-1 (]: Began running node test.vg_casestudy.not_null_stg_raw_staging__loans_loan_amount.9143c49752
[0m14:49:19.818041 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.not_null_stg_raw_staging__loans_interest_rate.af6bbce27a, now test.vg_casestudy.not_null_stg_raw_staging__loans_loan_amount.9143c49752)
[0m14:49:19.818509 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.not_null_stg_raw_staging__loans_loan_amount.9143c49752
[0m14:49:19.822362 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.not_null_stg_raw_staging__loans_loan_amount.9143c49752"
[0m14:49:19.822897 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_stg_raw_staging__loans_loan_amount.9143c49752 (compile): 14:49:19.818961 => 14:49:19.822723
[0m14:49:19.823253 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.not_null_stg_raw_staging__loans_loan_amount.9143c49752
[0m14:49:19.823645 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_stg_raw_staging__loans_loan_amount.9143c49752 (execute): 14:49:19.823472 => 14:49:19.823480
[0m14:49:19.824344 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.not_null_stg_raw_staging__loans_loan_amount.9143c49752
[0m14:49:19.824718 [debug] [Thread-1 (]: Began running node test.vg_casestudy.not_null_stg_raw_staging__loans_loan_id.2434a0af3b
[0m14:49:19.825333 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.not_null_stg_raw_staging__loans_loan_amount.9143c49752, now test.vg_casestudy.not_null_stg_raw_staging__loans_loan_id.2434a0af3b)
[0m14:49:19.825637 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.not_null_stg_raw_staging__loans_loan_id.2434a0af3b
[0m14:49:19.829217 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.not_null_stg_raw_staging__loans_loan_id.2434a0af3b"
[0m14:49:19.829714 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_stg_raw_staging__loans_loan_id.2434a0af3b (compile): 14:49:19.825838 => 14:49:19.829553
[0m14:49:19.830038 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.not_null_stg_raw_staging__loans_loan_id.2434a0af3b
[0m14:49:19.830402 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_stg_raw_staging__loans_loan_id.2434a0af3b (execute): 14:49:19.830253 => 14:49:19.830260
[0m14:49:19.831172 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.not_null_stg_raw_staging__loans_loan_id.2434a0af3b
[0m14:49:19.831538 [debug] [Thread-1 (]: Began running node test.vg_casestudy.not_null_stg_raw_staging__loans_loan_status.f4d3276dbd
[0m14:49:19.832103 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.not_null_stg_raw_staging__loans_loan_id.2434a0af3b, now test.vg_casestudy.not_null_stg_raw_staging__loans_loan_status.f4d3276dbd)
[0m14:49:19.832415 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.not_null_stg_raw_staging__loans_loan_status.f4d3276dbd
[0m14:49:19.838803 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.not_null_stg_raw_staging__loans_loan_status.f4d3276dbd"
[0m14:49:19.839370 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_stg_raw_staging__loans_loan_status.f4d3276dbd (compile): 14:49:19.832646 => 14:49:19.839192
[0m14:49:19.839696 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.not_null_stg_raw_staging__loans_loan_status.f4d3276dbd
[0m14:49:19.840064 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_stg_raw_staging__loans_loan_status.f4d3276dbd (execute): 14:49:19.839915 => 14:49:19.839922
[0m14:49:19.840786 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.not_null_stg_raw_staging__loans_loan_status.f4d3276dbd
[0m14:49:19.841136 [debug] [Thread-1 (]: Began running node test.vg_casestudy.not_null_stg_raw_staging__loans_loan_term.53fc5904d6
[0m14:49:19.841715 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.not_null_stg_raw_staging__loans_loan_status.f4d3276dbd, now test.vg_casestudy.not_null_stg_raw_staging__loans_loan_term.53fc5904d6)
[0m14:49:19.842030 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.not_null_stg_raw_staging__loans_loan_term.53fc5904d6
[0m14:49:19.845751 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.not_null_stg_raw_staging__loans_loan_term.53fc5904d6"
[0m14:49:19.846383 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_stg_raw_staging__loans_loan_term.53fc5904d6 (compile): 14:49:19.842268 => 14:49:19.846193
[0m14:49:19.846781 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.not_null_stg_raw_staging__loans_loan_term.53fc5904d6
[0m14:49:19.847159 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_stg_raw_staging__loans_loan_term.53fc5904d6 (execute): 14:49:19.847012 => 14:49:19.847018
[0m14:49:19.847870 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.not_null_stg_raw_staging__loans_loan_term.53fc5904d6
[0m14:49:19.848244 [debug] [Thread-1 (]: Began running node test.vg_casestudy.not_null_stg_raw_staging__loans_loan_type.a3d87b38a0
[0m14:49:19.848825 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.not_null_stg_raw_staging__loans_loan_term.53fc5904d6, now test.vg_casestudy.not_null_stg_raw_staging__loans_loan_type.a3d87b38a0)
[0m14:49:19.849149 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.not_null_stg_raw_staging__loans_loan_type.a3d87b38a0
[0m14:49:19.853324 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.not_null_stg_raw_staging__loans_loan_type.a3d87b38a0"
[0m14:49:19.853988 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_stg_raw_staging__loans_loan_type.a3d87b38a0 (compile): 14:49:19.849394 => 14:49:19.853781
[0m14:49:19.854332 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.not_null_stg_raw_staging__loans_loan_type.a3d87b38a0
[0m14:49:19.854785 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_stg_raw_staging__loans_loan_type.a3d87b38a0 (execute): 14:49:19.854553 => 14:49:19.854561
[0m14:49:19.855523 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.not_null_stg_raw_staging__loans_loan_type.a3d87b38a0
[0m14:49:19.855877 [debug] [Thread-1 (]: Began running node test.vg_casestudy.numeric_range_stg_raw_staging__loans_interest_rate__0.c62529af67
[0m14:49:19.856478 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.not_null_stg_raw_staging__loans_loan_type.a3d87b38a0, now test.vg_casestudy.numeric_range_stg_raw_staging__loans_interest_rate__0.c62529af67)
[0m14:49:19.856798 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.numeric_range_stg_raw_staging__loans_interest_rate__0.c62529af67
[0m14:49:19.860338 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.numeric_range_stg_raw_staging__loans_interest_rate__0.c62529af67"
[0m14:49:19.860997 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.numeric_range_stg_raw_staging__loans_interest_rate__0.c62529af67 (compile): 14:49:19.857021 => 14:49:19.860799
[0m14:49:19.861288 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.numeric_range_stg_raw_staging__loans_interest_rate__0.c62529af67
[0m14:49:19.861637 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.numeric_range_stg_raw_staging__loans_interest_rate__0.c62529af67 (execute): 14:49:19.861492 => 14:49:19.861498
[0m14:49:19.862484 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.numeric_range_stg_raw_staging__loans_interest_rate__0.c62529af67
[0m14:49:19.862871 [debug] [Thread-1 (]: Began running node test.vg_casestudy.numeric_range_stg_raw_staging__loans_loan_amount__0.d8b44433a4
[0m14:49:19.863500 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.numeric_range_stg_raw_staging__loans_interest_rate__0.c62529af67, now test.vg_casestudy.numeric_range_stg_raw_staging__loans_loan_amount__0.d8b44433a4)
[0m14:49:19.863830 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.numeric_range_stg_raw_staging__loans_loan_amount__0.d8b44433a4
[0m14:49:19.867525 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.numeric_range_stg_raw_staging__loans_loan_amount__0.d8b44433a4"
[0m14:49:19.868368 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.numeric_range_stg_raw_staging__loans_loan_amount__0.d8b44433a4 (compile): 14:49:19.864050 => 14:49:19.868132
[0m14:49:19.868670 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.numeric_range_stg_raw_staging__loans_loan_amount__0.d8b44433a4
[0m14:49:19.869050 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.numeric_range_stg_raw_staging__loans_loan_amount__0.d8b44433a4 (execute): 14:49:19.868890 => 14:49:19.868896
[0m14:49:19.869734 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.numeric_range_stg_raw_staging__loans_loan_amount__0.d8b44433a4
[0m14:49:19.870106 [debug] [Thread-1 (]: Began running node test.vg_casestudy.unique_stg_raw_staging__loans_loan_id.fdf57e988a
[0m14:49:19.870668 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.numeric_range_stg_raw_staging__loans_loan_amount__0.d8b44433a4, now test.vg_casestudy.unique_stg_raw_staging__loans_loan_id.fdf57e988a)
[0m14:49:19.870974 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.unique_stg_raw_staging__loans_loan_id.fdf57e988a
[0m14:49:19.874640 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.unique_stg_raw_staging__loans_loan_id.fdf57e988a"
[0m14:49:19.875459 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.unique_stg_raw_staging__loans_loan_id.fdf57e988a (compile): 14:49:19.871192 => 14:49:19.875225
[0m14:49:19.875750 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.unique_stg_raw_staging__loans_loan_id.fdf57e988a
[0m14:49:19.876118 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.unique_stg_raw_staging__loans_loan_id.fdf57e988a (execute): 14:49:19.875961 => 14:49:19.875967
[0m14:49:19.876811 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.unique_stg_raw_staging__loans_loan_id.fdf57e988a
[0m14:49:19.877173 [debug] [Thread-1 (]: Began running node model.vg_casestudy.stg_staging_intermediate__currencies
[0m14:49:19.877731 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.unique_stg_raw_staging__loans_loan_id.fdf57e988a, now model.vg_casestudy.stg_staging_intermediate__currencies)
[0m14:49:19.878042 [debug] [Thread-1 (]: Began compiling node model.vg_casestudy.stg_staging_intermediate__currencies
[0m14:49:19.880757 [debug] [Thread-1 (]: Writing injected SQL for node "model.vg_casestudy.stg_staging_intermediate__currencies"
[0m14:49:19.881554 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.stg_staging_intermediate__currencies (compile): 14:49:19.878283 => 14:49:19.881333
[0m14:49:19.881858 [debug] [Thread-1 (]: Began executing node model.vg_casestudy.stg_staging_intermediate__currencies
[0m14:49:19.882398 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.stg_staging_intermediate__currencies (execute): 14:49:19.882220 => 14:49:19.882228
[0m14:49:19.883143 [debug] [Thread-1 (]: Finished running node model.vg_casestudy.stg_staging_intermediate__currencies
[0m14:49:19.883543 [debug] [Thread-1 (]: Began running node model.vg_casestudy.stg_staging_intermediate__transactions
[0m14:49:19.884139 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.vg_casestudy.stg_staging_intermediate__currencies, now model.vg_casestudy.stg_staging_intermediate__transactions)
[0m14:49:19.884457 [debug] [Thread-1 (]: Began compiling node model.vg_casestudy.stg_staging_intermediate__transactions
[0m14:49:19.887161 [debug] [Thread-1 (]: Writing injected SQL for node "model.vg_casestudy.stg_staging_intermediate__transactions"
[0m14:49:19.888149 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.stg_staging_intermediate__transactions (compile): 14:49:19.884680 => 14:49:19.887898
[0m14:49:19.888501 [debug] [Thread-1 (]: Began executing node model.vg_casestudy.stg_staging_intermediate__transactions
[0m14:49:19.889014 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.stg_staging_intermediate__transactions (execute): 14:49:19.888724 => 14:49:19.888731
[0m14:49:19.889742 [debug] [Thread-1 (]: Finished running node model.vg_casestudy.stg_staging_intermediate__transactions
[0m14:49:19.890109 [debug] [Thread-1 (]: Began running node test.vg_casestudy.accepted_values_stg_raw_staging__transactions_transaction_type__transfer__deposit__withdrawal.9d791cc0ee
[0m14:49:19.890675 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.vg_casestudy.stg_staging_intermediate__transactions, now test.vg_casestudy.accepted_values_stg_raw_staging__transactions_transaction_type__transfer__deposit__withdrawal.9d791cc0ee)
[0m14:49:19.890986 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.accepted_values_stg_raw_staging__transactions_transaction_type__transfer__deposit__withdrawal.9d791cc0ee
[0m14:49:19.896210 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.accepted_values_stg_raw_staging__transactions_transaction_type__transfer__deposit__withdrawal.9d791cc0ee"
[0m14:49:19.898327 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.accepted_values_stg_raw_staging__transactions_transaction_type__transfer__deposit__withdrawal.9d791cc0ee (compile): 14:49:19.891214 => 14:49:19.897933
[0m14:49:19.898698 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.accepted_values_stg_raw_staging__transactions_transaction_type__transfer__deposit__withdrawal.9d791cc0ee
[0m14:49:19.899134 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.accepted_values_stg_raw_staging__transactions_transaction_type__transfer__deposit__withdrawal.9d791cc0ee (execute): 14:49:19.898946 => 14:49:19.898963
[0m14:49:19.900047 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.accepted_values_stg_raw_staging__transactions_transaction_type__transfer__deposit__withdrawal.9d791cc0ee
[0m14:49:19.900422 [debug] [Thread-1 (]: Began running node test.vg_casestudy.not_null_stg_raw_staging__transactions_account_id.52f5c093d5
[0m14:49:19.901013 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.accepted_values_stg_raw_staging__transactions_transaction_type__transfer__deposit__withdrawal.9d791cc0ee, now test.vg_casestudy.not_null_stg_raw_staging__transactions_account_id.52f5c093d5)
[0m14:49:19.901343 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.not_null_stg_raw_staging__transactions_account_id.52f5c093d5
[0m14:49:19.905358 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.not_null_stg_raw_staging__transactions_account_id.52f5c093d5"
[0m14:49:19.906139 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_stg_raw_staging__transactions_account_id.52f5c093d5 (compile): 14:49:19.901568 => 14:49:19.905906
[0m14:49:19.906441 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.not_null_stg_raw_staging__transactions_account_id.52f5c093d5
[0m14:49:19.906820 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_stg_raw_staging__transactions_account_id.52f5c093d5 (execute): 14:49:19.906659 => 14:49:19.906665
[0m14:49:19.907512 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.not_null_stg_raw_staging__transactions_account_id.52f5c093d5
[0m14:49:19.907880 [debug] [Thread-1 (]: Began running node test.vg_casestudy.not_null_stg_raw_staging__transactions_transaction_id.ebc02c3793
[0m14:49:19.910169 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.not_null_stg_raw_staging__transactions_account_id.52f5c093d5, now test.vg_casestudy.not_null_stg_raw_staging__transactions_transaction_id.ebc02c3793)
[0m14:49:19.910565 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.not_null_stg_raw_staging__transactions_transaction_id.ebc02c3793
[0m14:49:19.914536 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.not_null_stg_raw_staging__transactions_transaction_id.ebc02c3793"
[0m14:49:19.915420 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_stg_raw_staging__transactions_transaction_id.ebc02c3793 (compile): 14:49:19.910814 => 14:49:19.915209
[0m14:49:19.915729 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.not_null_stg_raw_staging__transactions_transaction_id.ebc02c3793
[0m14:49:19.916136 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_stg_raw_staging__transactions_transaction_id.ebc02c3793 (execute): 14:49:19.915945 => 14:49:19.915969
[0m14:49:19.916866 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.not_null_stg_raw_staging__transactions_transaction_id.ebc02c3793
[0m14:49:19.917218 [debug] [Thread-1 (]: Began running node test.vg_casestudy.not_null_stg_raw_staging__transactions_transaction_type.29e6a629e0
[0m14:49:19.917785 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.not_null_stg_raw_staging__transactions_transaction_id.ebc02c3793, now test.vg_casestudy.not_null_stg_raw_staging__transactions_transaction_type.29e6a629e0)
[0m14:49:19.918105 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.not_null_stg_raw_staging__transactions_transaction_type.29e6a629e0
[0m14:49:19.921857 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.not_null_stg_raw_staging__transactions_transaction_type.29e6a629e0"
[0m14:49:19.922544 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_stg_raw_staging__transactions_transaction_type.29e6a629e0 (compile): 14:49:19.918370 => 14:49:19.922349
[0m14:49:19.922840 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.not_null_stg_raw_staging__transactions_transaction_type.29e6a629e0
[0m14:49:19.923218 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_stg_raw_staging__transactions_transaction_type.29e6a629e0 (execute): 14:49:19.923052 => 14:49:19.923058
[0m14:49:19.923979 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.not_null_stg_raw_staging__transactions_transaction_type.29e6a629e0
[0m14:49:19.924346 [debug] [Thread-1 (]: Began running node test.vg_casestudy.relationships_stg_raw_staging__transactions_account_id__account_id__ref_stg_raw_staging__accounts_.e5e3cbe1a6
[0m14:49:19.925104 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.not_null_stg_raw_staging__transactions_transaction_type.29e6a629e0, now test.vg_casestudy.relationships_stg_raw_staging__transactions_account_id__account_id__ref_stg_raw_staging__accounts_.e5e3cbe1a6)
[0m14:49:19.925438 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.relationships_stg_raw_staging__transactions_account_id__account_id__ref_stg_raw_staging__accounts_.e5e3cbe1a6
[0m14:49:19.931832 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.relationships_stg_raw_staging__transactions_account_id__account_id__ref_stg_raw_staging__accounts_.e5e3cbe1a6"
[0m14:49:19.932653 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.relationships_stg_raw_staging__transactions_account_id__account_id__ref_stg_raw_staging__accounts_.e5e3cbe1a6 (compile): 14:49:19.925654 => 14:49:19.932328
[0m14:49:19.933376 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.relationships_stg_raw_staging__transactions_account_id__account_id__ref_stg_raw_staging__accounts_.e5e3cbe1a6
[0m14:49:19.934565 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.relationships_stg_raw_staging__transactions_account_id__account_id__ref_stg_raw_staging__accounts_.e5e3cbe1a6 (execute): 14:49:19.934081 => 14:49:19.934095
[0m14:49:19.936012 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.relationships_stg_raw_staging__transactions_account_id__account_id__ref_stg_raw_staging__accounts_.e5e3cbe1a6
[0m14:49:19.936453 [debug] [Thread-1 (]: Began running node test.vg_casestudy.unique_stg_raw_staging__transactions_transaction_id.e0f95cb9bb
[0m14:49:19.937219 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.relationships_stg_raw_staging__transactions_account_id__account_id__ref_stg_raw_staging__accounts_.e5e3cbe1a6, now test.vg_casestudy.unique_stg_raw_staging__transactions_transaction_id.e0f95cb9bb)
[0m14:49:19.937586 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.unique_stg_raw_staging__transactions_transaction_id.e0f95cb9bb
[0m14:49:19.941616 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.unique_stg_raw_staging__transactions_transaction_id.e0f95cb9bb"
[0m14:49:19.942266 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.unique_stg_raw_staging__transactions_transaction_id.e0f95cb9bb (compile): 14:49:19.937809 => 14:49:19.942078
[0m14:49:19.942608 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.unique_stg_raw_staging__transactions_transaction_id.e0f95cb9bb
[0m14:49:19.943001 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.unique_stg_raw_staging__transactions_transaction_id.e0f95cb9bb (execute): 14:49:19.942821 => 14:49:19.942830
[0m14:49:19.943827 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.unique_stg_raw_staging__transactions_transaction_id.e0f95cb9bb
[0m14:49:19.944198 [debug] [Thread-1 (]: Began running node test.vg_casestudy.date_is_past_stg_staging_intermediate__accounts_account_opening_date.f0a9449f31
[0m14:49:19.944811 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.unique_stg_raw_staging__transactions_transaction_id.e0f95cb9bb, now test.vg_casestudy.date_is_past_stg_staging_intermediate__accounts_account_opening_date.f0a9449f31)
[0m14:49:19.945224 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.date_is_past_stg_staging_intermediate__accounts_account_opening_date.f0a9449f31
[0m14:49:19.949226 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.date_is_past_stg_staging_intermediate__accounts_account_opening_date.f0a9449f31"
[0m14:49:19.951066 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.date_is_past_stg_staging_intermediate__accounts_account_opening_date.f0a9449f31 (compile): 14:49:19.945460 => 14:49:19.950774
[0m14:49:19.951414 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.date_is_past_stg_staging_intermediate__accounts_account_opening_date.f0a9449f31
[0m14:49:19.951786 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.date_is_past_stg_staging_intermediate__accounts_account_opening_date.f0a9449f31 (execute): 14:49:19.951627 => 14:49:19.951634
[0m14:49:19.952584 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.date_is_past_stg_staging_intermediate__accounts_account_opening_date.f0a9449f31
[0m14:49:19.952952 [debug] [Thread-1 (]: Began running node test.vg_casestudy.not_null_stg_staging_intermediate__accounts_account_id.ce9f8bf6f5
[0m14:49:19.953534 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.date_is_past_stg_staging_intermediate__accounts_account_opening_date.f0a9449f31, now test.vg_casestudy.not_null_stg_staging_intermediate__accounts_account_id.ce9f8bf6f5)
[0m14:49:19.953856 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.not_null_stg_staging_intermediate__accounts_account_id.ce9f8bf6f5
[0m14:49:19.957831 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.not_null_stg_staging_intermediate__accounts_account_id.ce9f8bf6f5"
[0m14:49:19.958546 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_stg_staging_intermediate__accounts_account_id.ce9f8bf6f5 (compile): 14:49:19.954093 => 14:49:19.958345
[0m14:49:19.958867 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.not_null_stg_staging_intermediate__accounts_account_id.ce9f8bf6f5
[0m14:49:19.959247 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_stg_staging_intermediate__accounts_account_id.ce9f8bf6f5 (execute): 14:49:19.959092 => 14:49:19.959098
[0m14:49:19.959954 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.not_null_stg_staging_intermediate__accounts_account_id.ce9f8bf6f5
[0m14:49:19.960302 [debug] [Thread-1 (]: Began running node test.vg_casestudy.not_null_stg_staging_intermediate__accounts_account_opening_date.14abf76bb5
[0m14:49:19.960999 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.not_null_stg_staging_intermediate__accounts_account_id.ce9f8bf6f5, now test.vg_casestudy.not_null_stg_staging_intermediate__accounts_account_opening_date.14abf76bb5)
[0m14:49:19.961352 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.not_null_stg_staging_intermediate__accounts_account_opening_date.14abf76bb5
[0m14:49:19.965325 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.not_null_stg_staging_intermediate__accounts_account_opening_date.14abf76bb5"
[0m14:49:19.966043 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_stg_staging_intermediate__accounts_account_opening_date.14abf76bb5 (compile): 14:49:19.961585 => 14:49:19.965837
[0m14:49:19.966346 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.not_null_stg_staging_intermediate__accounts_account_opening_date.14abf76bb5
[0m14:49:19.966726 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_stg_staging_intermediate__accounts_account_opening_date.14abf76bb5 (execute): 14:49:19.966570 => 14:49:19.966577
[0m14:49:19.967405 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.not_null_stg_staging_intermediate__accounts_account_opening_date.14abf76bb5
[0m14:49:19.967776 [debug] [Thread-1 (]: Began running node test.vg_casestudy.not_null_stg_staging_intermediate__accounts_customer_id.2a8ddb333d
[0m14:49:19.968330 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.not_null_stg_staging_intermediate__accounts_account_opening_date.14abf76bb5, now test.vg_casestudy.not_null_stg_staging_intermediate__accounts_customer_id.2a8ddb333d)
[0m14:49:19.968637 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.not_null_stg_staging_intermediate__accounts_customer_id.2a8ddb333d
[0m14:49:19.972407 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.not_null_stg_staging_intermediate__accounts_customer_id.2a8ddb333d"
[0m14:49:19.973107 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_stg_staging_intermediate__accounts_customer_id.2a8ddb333d (compile): 14:49:19.968895 => 14:49:19.972904
[0m14:49:19.973426 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.not_null_stg_staging_intermediate__accounts_customer_id.2a8ddb333d
[0m14:49:19.973808 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_stg_staging_intermediate__accounts_customer_id.2a8ddb333d (execute): 14:49:19.973650 => 14:49:19.973657
[0m14:49:19.974486 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.not_null_stg_staging_intermediate__accounts_customer_id.2a8ddb333d
[0m14:49:19.974841 [debug] [Thread-1 (]: Began running node test.vg_casestudy.unique_stg_staging_intermediate__accounts_account_id.b2f9fdea72
[0m14:49:19.975407 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.not_null_stg_staging_intermediate__accounts_customer_id.2a8ddb333d, now test.vg_casestudy.unique_stg_staging_intermediate__accounts_account_id.b2f9fdea72)
[0m14:49:19.975727 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.unique_stg_staging_intermediate__accounts_account_id.b2f9fdea72
[0m14:49:19.981524 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.unique_stg_staging_intermediate__accounts_account_id.b2f9fdea72"
[0m14:49:19.982145 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.unique_stg_staging_intermediate__accounts_account_id.b2f9fdea72 (compile): 14:49:19.975948 => 14:49:19.981941
[0m14:49:19.982457 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.unique_stg_staging_intermediate__accounts_account_id.b2f9fdea72
[0m14:49:19.982851 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.unique_stg_staging_intermediate__accounts_account_id.b2f9fdea72 (execute): 14:49:19.982689 => 14:49:19.982695
[0m14:49:19.983647 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.unique_stg_staging_intermediate__accounts_account_id.b2f9fdea72
[0m14:49:19.984025 [debug] [Thread-1 (]: Began running node test.vg_casestudy.not_null_stg_staging_intermediate__customers_branch_id.de895a293b
[0m14:49:19.984632 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.unique_stg_staging_intermediate__accounts_account_id.b2f9fdea72, now test.vg_casestudy.not_null_stg_staging_intermediate__customers_branch_id.de895a293b)
[0m14:49:19.984974 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.not_null_stg_staging_intermediate__customers_branch_id.de895a293b
[0m14:49:19.989055 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.not_null_stg_staging_intermediate__customers_branch_id.de895a293b"
[0m14:49:19.989891 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_stg_staging_intermediate__customers_branch_id.de895a293b (compile): 14:49:19.985244 => 14:49:19.989675
[0m14:49:19.990228 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.not_null_stg_staging_intermediate__customers_branch_id.de895a293b
[0m14:49:19.990637 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_stg_staging_intermediate__customers_branch_id.de895a293b (execute): 14:49:19.990465 => 14:49:19.990489
[0m14:49:19.991446 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.not_null_stg_staging_intermediate__customers_branch_id.de895a293b
[0m14:49:19.991838 [debug] [Thread-1 (]: Began running node test.vg_casestudy.not_null_stg_staging_intermediate__customers_customer_id.10f4ae76d7
[0m14:49:19.993084 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.not_null_stg_staging_intermediate__customers_branch_id.de895a293b, now test.vg_casestudy.not_null_stg_staging_intermediate__customers_customer_id.10f4ae76d7)
[0m14:49:19.993997 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.not_null_stg_staging_intermediate__customers_customer_id.10f4ae76d7
[0m14:49:19.998642 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.not_null_stg_staging_intermediate__customers_customer_id.10f4ae76d7"
[0m14:49:19.999312 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_stg_staging_intermediate__customers_customer_id.10f4ae76d7 (compile): 14:49:19.994310 => 14:49:19.999115
[0m14:49:19.999675 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.not_null_stg_staging_intermediate__customers_customer_id.10f4ae76d7
[0m14:49:20.000067 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_stg_staging_intermediate__customers_customer_id.10f4ae76d7 (execute): 14:49:19.999899 => 14:49:19.999923
[0m14:49:20.000846 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.not_null_stg_staging_intermediate__customers_customer_id.10f4ae76d7
[0m14:49:20.001246 [debug] [Thread-1 (]: Began running node test.vg_casestudy.relationships_stg_staging_intermediate__accounts_customer_id__customer_id__ref_stg_staging_intermediate__customers_.d3a09ede96
[0m14:49:20.001844 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.not_null_stg_staging_intermediate__customers_customer_id.10f4ae76d7, now test.vg_casestudy.relationships_stg_staging_intermediate__accounts_customer_id__customer_id__ref_stg_staging_intermediate__customers_.d3a09ede96)
[0m14:49:20.002203 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.relationships_stg_staging_intermediate__accounts_customer_id__customer_id__ref_stg_staging_intermediate__customers_.d3a09ede96
[0m14:49:20.008108 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.relationships_stg_staging_intermediate__accounts_customer_id__customer_id__ref_stg_staging_intermediate__customers_.d3a09ede96"
[0m14:49:20.008771 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.relationships_stg_staging_intermediate__accounts_customer_id__customer_id__ref_stg_staging_intermediate__customers_.d3a09ede96 (compile): 14:49:20.002501 => 14:49:20.008570
[0m14:49:20.009425 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.relationships_stg_staging_intermediate__accounts_customer_id__customer_id__ref_stg_staging_intermediate__customers_.d3a09ede96
[0m14:49:20.009914 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.relationships_stg_staging_intermediate__accounts_customer_id__customer_id__ref_stg_staging_intermediate__customers_.d3a09ede96 (execute): 14:49:20.009720 => 14:49:20.009729
[0m14:49:20.010754 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.relationships_stg_staging_intermediate__accounts_customer_id__customer_id__ref_stg_staging_intermediate__customers_.d3a09ede96
[0m14:49:20.011146 [debug] [Thread-1 (]: Began running node test.vg_casestudy.unique_stg_staging_intermediate__customers_customer_id.5bded562dd
[0m14:49:20.011915 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.relationships_stg_staging_intermediate__accounts_customer_id__customer_id__ref_stg_staging_intermediate__customers_.d3a09ede96, now test.vg_casestudy.unique_stg_staging_intermediate__customers_customer_id.5bded562dd)
[0m14:49:20.012271 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.unique_stg_staging_intermediate__customers_customer_id.5bded562dd
[0m14:49:20.016241 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.unique_stg_staging_intermediate__customers_customer_id.5bded562dd"
[0m14:49:20.016819 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.unique_stg_staging_intermediate__customers_customer_id.5bded562dd (compile): 14:49:20.012489 => 14:49:20.016634
[0m14:49:20.017152 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.unique_stg_staging_intermediate__customers_customer_id.5bded562dd
[0m14:49:20.017557 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.unique_stg_staging_intermediate__customers_customer_id.5bded562dd (execute): 14:49:20.017402 => 14:49:20.017409
[0m14:49:20.018299 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.unique_stg_staging_intermediate__customers_customer_id.5bded562dd
[0m14:49:20.018662 [debug] [Thread-1 (]: Began running node test.vg_casestudy.date_is_past_stg_staging_intermediate__fx_rates_fx_rate_date.6dd6ccf2e2
[0m14:49:20.019258 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.unique_stg_staging_intermediate__customers_customer_id.5bded562dd, now test.vg_casestudy.date_is_past_stg_staging_intermediate__fx_rates_fx_rate_date.6dd6ccf2e2)
[0m14:49:20.019605 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.date_is_past_stg_staging_intermediate__fx_rates_fx_rate_date.6dd6ccf2e2
[0m14:49:20.023108 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.date_is_past_stg_staging_intermediate__fx_rates_fx_rate_date.6dd6ccf2e2"
[0m14:49:20.023873 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.date_is_past_stg_staging_intermediate__fx_rates_fx_rate_date.6dd6ccf2e2 (compile): 14:49:20.019826 => 14:49:20.023670
[0m14:49:20.024174 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.date_is_past_stg_staging_intermediate__fx_rates_fx_rate_date.6dd6ccf2e2
[0m14:49:20.024561 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.date_is_past_stg_staging_intermediate__fx_rates_fx_rate_date.6dd6ccf2e2 (execute): 14:49:20.024391 => 14:49:20.024397
[0m14:49:20.025246 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.date_is_past_stg_staging_intermediate__fx_rates_fx_rate_date.6dd6ccf2e2
[0m14:49:20.025611 [debug] [Thread-1 (]: Began running node test.vg_casestudy.not_null_stg_staging_intermediate__fx_rates_currency_iso_code.95d2907ece
[0m14:49:20.026172 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.date_is_past_stg_staging_intermediate__fx_rates_fx_rate_date.6dd6ccf2e2, now test.vg_casestudy.not_null_stg_staging_intermediate__fx_rates_currency_iso_code.95d2907ece)
[0m14:49:20.026494 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.not_null_stg_staging_intermediate__fx_rates_currency_iso_code.95d2907ece
[0m14:49:20.030916 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.not_null_stg_staging_intermediate__fx_rates_currency_iso_code.95d2907ece"
[0m14:49:20.031890 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_stg_staging_intermediate__fx_rates_currency_iso_code.95d2907ece (compile): 14:49:20.026722 => 14:49:20.031671
[0m14:49:20.032281 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.not_null_stg_staging_intermediate__fx_rates_currency_iso_code.95d2907ece
[0m14:49:20.032685 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_stg_staging_intermediate__fx_rates_currency_iso_code.95d2907ece (execute): 14:49:20.032518 => 14:49:20.032525
[0m14:49:20.033427 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.not_null_stg_staging_intermediate__fx_rates_currency_iso_code.95d2907ece
[0m14:49:20.033788 [debug] [Thread-1 (]: Began running node test.vg_casestudy.not_null_stg_staging_intermediate__fx_rates_fx_rate.bec8509027
[0m14:49:20.034361 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.not_null_stg_staging_intermediate__fx_rates_currency_iso_code.95d2907ece, now test.vg_casestudy.not_null_stg_staging_intermediate__fx_rates_fx_rate.bec8509027)
[0m14:49:20.034675 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.not_null_stg_staging_intermediate__fx_rates_fx_rate.bec8509027
[0m14:49:20.038436 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.not_null_stg_staging_intermediate__fx_rates_fx_rate.bec8509027"
[0m14:49:20.039112 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_stg_staging_intermediate__fx_rates_fx_rate.bec8509027 (compile): 14:49:20.034900 => 14:49:20.038913
[0m14:49:20.039410 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.not_null_stg_staging_intermediate__fx_rates_fx_rate.bec8509027
[0m14:49:20.039769 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_stg_staging_intermediate__fx_rates_fx_rate.bec8509027 (execute): 14:49:20.039619 => 14:49:20.039625
[0m14:49:20.040444 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.not_null_stg_staging_intermediate__fx_rates_fx_rate.bec8509027
[0m14:49:20.040833 [debug] [Thread-1 (]: Began running node test.vg_casestudy.not_null_stg_staging_intermediate__fx_rates_fx_rate_date.0f5280bc57
[0m14:49:20.041391 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.not_null_stg_staging_intermediate__fx_rates_fx_rate.bec8509027, now test.vg_casestudy.not_null_stg_staging_intermediate__fx_rates_fx_rate_date.0f5280bc57)
[0m14:49:20.041701 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.not_null_stg_staging_intermediate__fx_rates_fx_rate_date.0f5280bc57
[0m14:49:20.045585 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.not_null_stg_staging_intermediate__fx_rates_fx_rate_date.0f5280bc57"
[0m14:49:20.046373 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_stg_staging_intermediate__fx_rates_fx_rate_date.0f5280bc57 (compile): 14:49:20.041921 => 14:49:20.046197
[0m14:49:20.046716 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.not_null_stg_staging_intermediate__fx_rates_fx_rate_date.0f5280bc57
[0m14:49:20.047107 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_stg_staging_intermediate__fx_rates_fx_rate_date.0f5280bc57 (execute): 14:49:20.046927 => 14:49:20.046934
[0m14:49:20.047836 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.not_null_stg_staging_intermediate__fx_rates_fx_rate_date.0f5280bc57
[0m14:49:20.048191 [debug] [Thread-1 (]: Began running node test.vg_casestudy.numeric_range_stg_staging_intermediate__fx_rates_fx_rate__0.2d4a929b3f
[0m14:49:20.048775 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.not_null_stg_staging_intermediate__fx_rates_fx_rate_date.0f5280bc57, now test.vg_casestudy.numeric_range_stg_staging_intermediate__fx_rates_fx_rate__0.2d4a929b3f)
[0m14:49:20.049096 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.numeric_range_stg_staging_intermediate__fx_rates_fx_rate__0.2d4a929b3f
[0m14:49:20.054408 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.numeric_range_stg_staging_intermediate__fx_rates_fx_rate__0.2d4a929b3f"
[0m14:49:20.055101 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.numeric_range_stg_staging_intermediate__fx_rates_fx_rate__0.2d4a929b3f (compile): 14:49:20.049318 => 14:49:20.054932
[0m14:49:20.055402 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.numeric_range_stg_staging_intermediate__fx_rates_fx_rate__0.2d4a929b3f
[0m14:49:20.055763 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.numeric_range_stg_staging_intermediate__fx_rates_fx_rate__0.2d4a929b3f (execute): 14:49:20.055608 => 14:49:20.055614
[0m14:49:20.056500 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.numeric_range_stg_staging_intermediate__fx_rates_fx_rate__0.2d4a929b3f
[0m14:49:20.056846 [debug] [Thread-1 (]: Began running node test.vg_casestudy.unique_stg_staging_intermediate__fx_rates_currency_iso_code.a28e4eee53
[0m14:49:20.057406 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.numeric_range_stg_staging_intermediate__fx_rates_fx_rate__0.2d4a929b3f, now test.vg_casestudy.unique_stg_staging_intermediate__fx_rates_currency_iso_code.a28e4eee53)
[0m14:49:20.057732 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.unique_stg_staging_intermediate__fx_rates_currency_iso_code.a28e4eee53
[0m14:49:20.061557 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.unique_stg_staging_intermediate__fx_rates_currency_iso_code.a28e4eee53"
[0m14:49:20.062351 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.unique_stg_staging_intermediate__fx_rates_currency_iso_code.a28e4eee53 (compile): 14:49:20.057950 => 14:49:20.062137
[0m14:49:20.062651 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.unique_stg_staging_intermediate__fx_rates_currency_iso_code.a28e4eee53
[0m14:49:20.063033 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.unique_stg_staging_intermediate__fx_rates_currency_iso_code.a28e4eee53 (execute): 14:49:20.062869 => 14:49:20.062875
[0m14:49:20.063861 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.unique_stg_staging_intermediate__fx_rates_currency_iso_code.a28e4eee53
[0m14:49:20.064222 [debug] [Thread-1 (]: Began running node analysis.vg_casestudy.sample_loan_data
[0m14:49:20.064807 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.unique_stg_staging_intermediate__fx_rates_currency_iso_code.a28e4eee53, now analysis.vg_casestudy.sample_loan_data)
[0m14:49:20.065117 [debug] [Thread-1 (]: Began compiling node analysis.vg_casestudy.sample_loan_data
[0m14:49:20.067812 [debug] [Thread-1 (]: Writing injected SQL for node "analysis.vg_casestudy.sample_loan_data"
[0m14:49:20.071720 [debug] [Thread-1 (]: Timing info for analysis.vg_casestudy.sample_loan_data (compile): 14:49:20.065338 => 14:49:20.071378
[0m14:49:20.072088 [debug] [Thread-1 (]: Began executing node analysis.vg_casestudy.sample_loan_data
[0m14:49:20.072455 [debug] [Thread-1 (]: Timing info for analysis.vg_casestudy.sample_loan_data (execute): 14:49:20.072300 => 14:49:20.072308
[0m14:49:20.073231 [debug] [Thread-1 (]: Finished running node analysis.vg_casestudy.sample_loan_data
[0m14:49:20.073588 [debug] [Thread-1 (]: Began running node test.vg_casestudy.accepted_values_stg_staging_intermediate__loans_loan_status__approved__rejected__closed.3143a4d227
[0m14:49:20.074150 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly analysis.vg_casestudy.sample_loan_data, now test.vg_casestudy.accepted_values_stg_staging_intermediate__loans_loan_status__approved__rejected__closed.3143a4d227)
[0m14:49:20.074466 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.accepted_values_stg_staging_intermediate__loans_loan_status__approved__rejected__closed.3143a4d227
[0m14:49:20.078584 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.accepted_values_stg_staging_intermediate__loans_loan_status__approved__rejected__closed.3143a4d227"
[0m14:49:20.079475 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.accepted_values_stg_staging_intermediate__loans_loan_status__approved__rejected__closed.3143a4d227 (compile): 14:49:20.074686 => 14:49:20.079257
[0m14:49:20.079928 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.accepted_values_stg_staging_intermediate__loans_loan_status__approved__rejected__closed.3143a4d227
[0m14:49:20.080328 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.accepted_values_stg_staging_intermediate__loans_loan_status__approved__rejected__closed.3143a4d227 (execute): 14:49:20.080163 => 14:49:20.080171
[0m14:49:20.081072 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.accepted_values_stg_staging_intermediate__loans_loan_status__approved__rejected__closed.3143a4d227
[0m14:49:20.081433 [debug] [Thread-1 (]: Began running node test.vg_casestudy.accepted_values_stg_staging_intermediate__loans_loan_term__12__24__36__48__60.5ea4cabc39
[0m14:49:20.082016 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.accepted_values_stg_staging_intermediate__loans_loan_status__approved__rejected__closed.3143a4d227, now test.vg_casestudy.accepted_values_stg_staging_intermediate__loans_loan_term__12__24__36__48__60.5ea4cabc39)
[0m14:49:20.082340 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.accepted_values_stg_staging_intermediate__loans_loan_term__12__24__36__48__60.5ea4cabc39
[0m14:49:20.086450 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.accepted_values_stg_staging_intermediate__loans_loan_term__12__24__36__48__60.5ea4cabc39"
[0m14:49:20.087179 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.accepted_values_stg_staging_intermediate__loans_loan_term__12__24__36__48__60.5ea4cabc39 (compile): 14:49:20.082568 => 14:49:20.086968
[0m14:49:20.087478 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.accepted_values_stg_staging_intermediate__loans_loan_term__12__24__36__48__60.5ea4cabc39
[0m14:49:20.087855 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.accepted_values_stg_staging_intermediate__loans_loan_term__12__24__36__48__60.5ea4cabc39 (execute): 14:49:20.087699 => 14:49:20.087706
[0m14:49:20.088582 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.accepted_values_stg_staging_intermediate__loans_loan_term__12__24__36__48__60.5ea4cabc39
[0m14:49:20.088949 [debug] [Thread-1 (]: Began running node test.vg_casestudy.date_is_past_stg_staging_intermediate__loans_approval_rejection_date.61c247afe7
[0m14:49:20.089503 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.accepted_values_stg_staging_intermediate__loans_loan_term__12__24__36__48__60.5ea4cabc39, now test.vg_casestudy.date_is_past_stg_staging_intermediate__loans_approval_rejection_date.61c247afe7)
[0m14:49:20.089830 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.date_is_past_stg_staging_intermediate__loans_approval_rejection_date.61c247afe7
[0m14:49:20.093642 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.date_is_past_stg_staging_intermediate__loans_approval_rejection_date.61c247afe7"
[0m14:49:20.094355 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.date_is_past_stg_staging_intermediate__loans_approval_rejection_date.61c247afe7 (compile): 14:49:20.090055 => 14:49:20.094171
[0m14:49:20.094698 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.date_is_past_stg_staging_intermediate__loans_approval_rejection_date.61c247afe7
[0m14:49:20.095062 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.date_is_past_stg_staging_intermediate__loans_approval_rejection_date.61c247afe7 (execute): 14:49:20.094902 => 14:49:20.094908
[0m14:49:20.095775 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.date_is_past_stg_staging_intermediate__loans_approval_rejection_date.61c247afe7
[0m14:49:20.096128 [debug] [Thread-1 (]: Began running node test.vg_casestudy.not_null_stg_staging_intermediate__loans_approval_rejection_date.28f5951b2f
[0m14:49:20.096775 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.date_is_past_stg_staging_intermediate__loans_approval_rejection_date.61c247afe7, now test.vg_casestudy.not_null_stg_staging_intermediate__loans_approval_rejection_date.28f5951b2f)
[0m14:49:20.097118 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.not_null_stg_staging_intermediate__loans_approval_rejection_date.28f5951b2f
[0m14:49:20.101072 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.not_null_stg_staging_intermediate__loans_approval_rejection_date.28f5951b2f"
[0m14:49:20.101778 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_stg_staging_intermediate__loans_approval_rejection_date.28f5951b2f (compile): 14:49:20.097347 => 14:49:20.101580
[0m14:49:20.102107 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.not_null_stg_staging_intermediate__loans_approval_rejection_date.28f5951b2f
[0m14:49:20.102483 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_stg_staging_intermediate__loans_approval_rejection_date.28f5951b2f (execute): 14:49:20.102325 => 14:49:20.102330
[0m14:49:20.103167 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.not_null_stg_staging_intermediate__loans_approval_rejection_date.28f5951b2f
[0m14:49:20.103557 [debug] [Thread-1 (]: Began running node test.vg_casestudy.not_null_stg_staging_intermediate__loans_interest_rate.290100bb78
[0m14:49:20.104121 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.not_null_stg_staging_intermediate__loans_approval_rejection_date.28f5951b2f, now test.vg_casestudy.not_null_stg_staging_intermediate__loans_interest_rate.290100bb78)
[0m14:49:20.104426 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.not_null_stg_staging_intermediate__loans_interest_rate.290100bb78
[0m14:49:20.108355 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.not_null_stg_staging_intermediate__loans_interest_rate.290100bb78"
[0m14:49:20.109274 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_stg_staging_intermediate__loans_interest_rate.290100bb78 (compile): 14:49:20.104697 => 14:49:20.109073
[0m14:49:20.109615 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.not_null_stg_staging_intermediate__loans_interest_rate.290100bb78
[0m14:49:20.110007 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_stg_staging_intermediate__loans_interest_rate.290100bb78 (execute): 14:49:20.109840 => 14:49:20.109847
[0m14:49:20.110711 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.not_null_stg_staging_intermediate__loans_interest_rate.290100bb78
[0m14:49:20.111063 [debug] [Thread-1 (]: Began running node test.vg_casestudy.not_null_stg_staging_intermediate__loans_loan_amount.3aa0f79ca3
[0m14:49:20.111683 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.not_null_stg_staging_intermediate__loans_interest_rate.290100bb78, now test.vg_casestudy.not_null_stg_staging_intermediate__loans_loan_amount.3aa0f79ca3)
[0m14:49:20.112006 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.not_null_stg_staging_intermediate__loans_loan_amount.3aa0f79ca3
[0m14:49:20.115837 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.not_null_stg_staging_intermediate__loans_loan_amount.3aa0f79ca3"
[0m14:49:20.116576 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_stg_staging_intermediate__loans_loan_amount.3aa0f79ca3 (compile): 14:49:20.112245 => 14:49:20.116371
[0m14:49:20.116884 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.not_null_stg_staging_intermediate__loans_loan_amount.3aa0f79ca3
[0m14:49:20.117250 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_stg_staging_intermediate__loans_loan_amount.3aa0f79ca3 (execute): 14:49:20.117094 => 14:49:20.117100
[0m14:49:20.117941 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.not_null_stg_staging_intermediate__loans_loan_amount.3aa0f79ca3
[0m14:49:20.118303 [debug] [Thread-1 (]: Began running node test.vg_casestudy.not_null_stg_staging_intermediate__loans_loan_id.bbf464e57e
[0m14:49:20.118872 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.not_null_stg_staging_intermediate__loans_loan_amount.3aa0f79ca3, now test.vg_casestudy.not_null_stg_staging_intermediate__loans_loan_id.bbf464e57e)
[0m14:49:20.119188 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.not_null_stg_staging_intermediate__loans_loan_id.bbf464e57e
[0m14:49:20.122978 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.not_null_stg_staging_intermediate__loans_loan_id.bbf464e57e"
[0m14:49:20.123693 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_stg_staging_intermediate__loans_loan_id.bbf464e57e (compile): 14:49:20.119412 => 14:49:20.123492
[0m14:49:20.123987 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.not_null_stg_staging_intermediate__loans_loan_id.bbf464e57e
[0m14:49:20.124449 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_stg_staging_intermediate__loans_loan_id.bbf464e57e (execute): 14:49:20.124238 => 14:49:20.124245
[0m14:49:20.125348 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.not_null_stg_staging_intermediate__loans_loan_id.bbf464e57e
[0m14:49:20.125715 [debug] [Thread-1 (]: Began running node test.vg_casestudy.not_null_stg_staging_intermediate__loans_loan_status.6519e56cae
[0m14:49:20.126320 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.not_null_stg_staging_intermediate__loans_loan_id.bbf464e57e, now test.vg_casestudy.not_null_stg_staging_intermediate__loans_loan_status.6519e56cae)
[0m14:49:20.126646 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.not_null_stg_staging_intermediate__loans_loan_status.6519e56cae
[0m14:49:20.132354 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.not_null_stg_staging_intermediate__loans_loan_status.6519e56cae"
[0m14:49:20.132903 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_stg_staging_intermediate__loans_loan_status.6519e56cae (compile): 14:49:20.126872 => 14:49:20.132738
[0m14:49:20.133208 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.not_null_stg_staging_intermediate__loans_loan_status.6519e56cae
[0m14:49:20.133638 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_stg_staging_intermediate__loans_loan_status.6519e56cae (execute): 14:49:20.133479 => 14:49:20.133486
[0m14:49:20.134365 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.not_null_stg_staging_intermediate__loans_loan_status.6519e56cae
[0m14:49:20.134738 [debug] [Thread-1 (]: Began running node test.vg_casestudy.not_null_stg_staging_intermediate__loans_loan_term.c98571f396
[0m14:49:20.135297 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.not_null_stg_staging_intermediate__loans_loan_status.6519e56cae, now test.vg_casestudy.not_null_stg_staging_intermediate__loans_loan_term.c98571f396)
[0m14:49:20.135622 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.not_null_stg_staging_intermediate__loans_loan_term.c98571f396
[0m14:49:20.139297 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.not_null_stg_staging_intermediate__loans_loan_term.c98571f396"
[0m14:49:20.139991 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_stg_staging_intermediate__loans_loan_term.c98571f396 (compile): 14:49:20.135847 => 14:49:20.139799
[0m14:49:20.140357 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.not_null_stg_staging_intermediate__loans_loan_term.c98571f396
[0m14:49:20.140859 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_stg_staging_intermediate__loans_loan_term.c98571f396 (execute): 14:49:20.140684 => 14:49:20.140691
[0m14:49:20.141625 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.not_null_stg_staging_intermediate__loans_loan_term.c98571f396
[0m14:49:20.141989 [debug] [Thread-1 (]: Began running node test.vg_casestudy.numeric_range_stg_staging_intermediate__loans_interest_rate__0.049a21d6b9
[0m14:49:20.142591 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.not_null_stg_staging_intermediate__loans_loan_term.c98571f396, now test.vg_casestudy.numeric_range_stg_staging_intermediate__loans_interest_rate__0.049a21d6b9)
[0m14:49:20.142919 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.numeric_range_stg_staging_intermediate__loans_interest_rate__0.049a21d6b9
[0m14:49:20.146658 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.numeric_range_stg_staging_intermediate__loans_interest_rate__0.049a21d6b9"
[0m14:49:20.147404 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.numeric_range_stg_staging_intermediate__loans_interest_rate__0.049a21d6b9 (compile): 14:49:20.143151 => 14:49:20.147203
[0m14:49:20.147710 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.numeric_range_stg_staging_intermediate__loans_interest_rate__0.049a21d6b9
[0m14:49:20.148091 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.numeric_range_stg_staging_intermediate__loans_interest_rate__0.049a21d6b9 (execute): 14:49:20.147930 => 14:49:20.147937
[0m14:49:20.148791 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.numeric_range_stg_staging_intermediate__loans_interest_rate__0.049a21d6b9
[0m14:49:20.149160 [debug] [Thread-1 (]: Began running node test.vg_casestudy.numeric_range_stg_staging_intermediate__loans_loan_amount__0.68f9ee0c26
[0m14:49:20.149729 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.numeric_range_stg_staging_intermediate__loans_interest_rate__0.049a21d6b9, now test.vg_casestudy.numeric_range_stg_staging_intermediate__loans_loan_amount__0.68f9ee0c26)
[0m14:49:20.150042 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.numeric_range_stg_staging_intermediate__loans_loan_amount__0.68f9ee0c26
[0m14:49:20.153795 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.numeric_range_stg_staging_intermediate__loans_loan_amount__0.68f9ee0c26"
[0m14:49:20.154500 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.numeric_range_stg_staging_intermediate__loans_loan_amount__0.68f9ee0c26 (compile): 14:49:20.150276 => 14:49:20.154296
[0m14:49:20.154808 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.numeric_range_stg_staging_intermediate__loans_loan_amount__0.68f9ee0c26
[0m14:49:20.155185 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.numeric_range_stg_staging_intermediate__loans_loan_amount__0.68f9ee0c26 (execute): 14:49:20.155026 => 14:49:20.155032
[0m14:49:20.156096 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.numeric_range_stg_staging_intermediate__loans_loan_amount__0.68f9ee0c26
[0m14:49:20.156481 [debug] [Thread-1 (]: Began running node test.vg_casestudy.unique_stg_staging_intermediate__loans_loan_id.7800e8cbcc
[0m14:49:20.157080 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.numeric_range_stg_staging_intermediate__loans_loan_amount__0.68f9ee0c26, now test.vg_casestudy.unique_stg_staging_intermediate__loans_loan_id.7800e8cbcc)
[0m14:49:20.157402 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.unique_stg_staging_intermediate__loans_loan_id.7800e8cbcc
[0m14:49:20.161067 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.unique_stg_staging_intermediate__loans_loan_id.7800e8cbcc"
[0m14:49:20.161885 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.unique_stg_staging_intermediate__loans_loan_id.7800e8cbcc (compile): 14:49:20.157635 => 14:49:20.161665
[0m14:49:20.162191 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.unique_stg_staging_intermediate__loans_loan_id.7800e8cbcc
[0m14:49:20.162554 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.unique_stg_staging_intermediate__loans_loan_id.7800e8cbcc (execute): 14:49:20.162397 => 14:49:20.162403
[0m14:49:20.163337 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.unique_stg_staging_intermediate__loans_loan_id.7800e8cbcc
[0m14:49:20.163760 [debug] [Thread-1 (]: Began running node test.vg_casestudy.not_null_stg_staging_intermediate__currencies_currency_iso_code.f7ebb4618b
[0m14:49:20.164333 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.unique_stg_staging_intermediate__loans_loan_id.7800e8cbcc, now test.vg_casestudy.not_null_stg_staging_intermediate__currencies_currency_iso_code.f7ebb4618b)
[0m14:49:20.164638 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.not_null_stg_staging_intermediate__currencies_currency_iso_code.f7ebb4618b
[0m14:49:20.168439 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.not_null_stg_staging_intermediate__currencies_currency_iso_code.f7ebb4618b"
[0m14:49:20.169161 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_stg_staging_intermediate__currencies_currency_iso_code.f7ebb4618b (compile): 14:49:20.164879 => 14:49:20.168953
[0m14:49:20.169460 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.not_null_stg_staging_intermediate__currencies_currency_iso_code.f7ebb4618b
[0m14:49:20.169831 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_stg_staging_intermediate__currencies_currency_iso_code.f7ebb4618b (execute): 14:49:20.169670 => 14:49:20.169676
[0m14:49:20.170524 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.not_null_stg_staging_intermediate__currencies_currency_iso_code.f7ebb4618b
[0m14:49:20.170889 [debug] [Thread-1 (]: Began running node test.vg_casestudy.unique_stg_staging_intermediate__currencies_currency_iso_code.4396247af3
[0m14:49:20.171623 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.not_null_stg_staging_intermediate__currencies_currency_iso_code.f7ebb4618b, now test.vg_casestudy.unique_stg_staging_intermediate__currencies_currency_iso_code.4396247af3)
[0m14:49:20.171991 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.unique_stg_staging_intermediate__currencies_currency_iso_code.4396247af3
[0m14:49:20.176509 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.unique_stg_staging_intermediate__currencies_currency_iso_code.4396247af3"
[0m14:49:20.177463 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.unique_stg_staging_intermediate__currencies_currency_iso_code.4396247af3 (compile): 14:49:20.172220 => 14:49:20.177231
[0m14:49:20.177778 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.unique_stg_staging_intermediate__currencies_currency_iso_code.4396247af3
[0m14:49:20.178159 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.unique_stg_staging_intermediate__currencies_currency_iso_code.4396247af3 (execute): 14:49:20.177996 => 14:49:20.178003
[0m14:49:20.178895 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.unique_stg_staging_intermediate__currencies_currency_iso_code.4396247af3
[0m14:49:20.179283 [debug] [Thread-1 (]: Began running node test.vg_casestudy.not_null_stg_staging_intermediate__transactions_transaction_amount.8dc65a17fe
[0m14:49:20.179854 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.unique_stg_staging_intermediate__currencies_currency_iso_code.4396247af3, now test.vg_casestudy.not_null_stg_staging_intermediate__transactions_transaction_amount.8dc65a17fe)
[0m14:49:20.180342 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.not_null_stg_staging_intermediate__transactions_transaction_amount.8dc65a17fe
[0m14:49:20.184603 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.not_null_stg_staging_intermediate__transactions_transaction_amount.8dc65a17fe"
[0m14:49:20.185168 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_stg_staging_intermediate__transactions_transaction_amount.8dc65a17fe (compile): 14:49:20.180578 => 14:49:20.184991
[0m14:49:20.185488 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.not_null_stg_staging_intermediate__transactions_transaction_amount.8dc65a17fe
[0m14:49:20.185858 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_stg_staging_intermediate__transactions_transaction_amount.8dc65a17fe (execute): 14:49:20.185701 => 14:49:20.185708
[0m14:49:20.186564 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.not_null_stg_staging_intermediate__transactions_transaction_amount.8dc65a17fe
[0m14:49:20.186938 [debug] [Thread-1 (]: Began running node test.vg_casestudy.not_null_stg_staging_intermediate__transactions_transaction_id.cb7402fe02
[0m14:49:20.187537 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.not_null_stg_staging_intermediate__transactions_transaction_amount.8dc65a17fe, now test.vg_casestudy.not_null_stg_staging_intermediate__transactions_transaction_id.cb7402fe02)
[0m14:49:20.187919 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.not_null_stg_staging_intermediate__transactions_transaction_id.cb7402fe02
[0m14:49:20.192367 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.not_null_stg_staging_intermediate__transactions_transaction_id.cb7402fe02"
[0m14:49:20.193286 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_stg_staging_intermediate__transactions_transaction_id.cb7402fe02 (compile): 14:49:20.188193 => 14:49:20.193008
[0m14:49:20.193610 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.not_null_stg_staging_intermediate__transactions_transaction_id.cb7402fe02
[0m14:49:20.194001 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_stg_staging_intermediate__transactions_transaction_id.cb7402fe02 (execute): 14:49:20.193834 => 14:49:20.193841
[0m14:49:20.194993 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.not_null_stg_staging_intermediate__transactions_transaction_id.cb7402fe02
[0m14:49:20.195366 [debug] [Thread-1 (]: Began running node test.vg_casestudy.numeric_range_stg_staging_intermediate__transactions_transaction_amount__0.789e7a4361
[0m14:49:20.195945 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.not_null_stg_staging_intermediate__transactions_transaction_id.cb7402fe02, now test.vg_casestudy.numeric_range_stg_staging_intermediate__transactions_transaction_amount__0.789e7a4361)
[0m14:49:20.196270 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.numeric_range_stg_staging_intermediate__transactions_transaction_amount__0.789e7a4361
[0m14:49:20.202339 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.numeric_range_stg_staging_intermediate__transactions_transaction_amount__0.789e7a4361"
[0m14:49:20.202953 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.numeric_range_stg_staging_intermediate__transactions_transaction_amount__0.789e7a4361 (compile): 14:49:20.196512 => 14:49:20.202772
[0m14:49:20.203325 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.numeric_range_stg_staging_intermediate__transactions_transaction_amount__0.789e7a4361
[0m14:49:20.203738 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.numeric_range_stg_staging_intermediate__transactions_transaction_amount__0.789e7a4361 (execute): 14:49:20.203570 => 14:49:20.203577
[0m14:49:20.204469 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.numeric_range_stg_staging_intermediate__transactions_transaction_amount__0.789e7a4361
[0m14:49:20.204866 [debug] [Thread-1 (]: Began running node test.vg_casestudy.unique_stg_staging_intermediate__transactions_transaction_id.dbfd7b9b66
[0m14:49:20.205437 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.numeric_range_stg_staging_intermediate__transactions_transaction_amount__0.789e7a4361, now test.vg_casestudy.unique_stg_staging_intermediate__transactions_transaction_id.dbfd7b9b66)
[0m14:49:20.205786 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.unique_stg_staging_intermediate__transactions_transaction_id.dbfd7b9b66
[0m14:49:20.209381 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.unique_stg_staging_intermediate__transactions_transaction_id.dbfd7b9b66"
[0m14:49:20.210090 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.unique_stg_staging_intermediate__transactions_transaction_id.dbfd7b9b66 (compile): 14:49:20.206012 => 14:49:20.209890
[0m14:49:20.210386 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.unique_stg_staging_intermediate__transactions_transaction_id.dbfd7b9b66
[0m14:49:20.210759 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.unique_stg_staging_intermediate__transactions_transaction_id.dbfd7b9b66 (execute): 14:49:20.210597 => 14:49:20.210603
[0m14:49:20.211450 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.unique_stg_staging_intermediate__transactions_transaction_id.dbfd7b9b66
[0m14:49:20.212985 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:49:20.213374 [debug] [MainThread]: Connection 'test.vg_casestudy.unique_stg_staging_intermediate__transactions_transaction_id.dbfd7b9b66' was properly closed.
[0m14:49:20.221244 [debug] [MainThread]: Command end result
[0m14:49:20.251939 [debug] [MainThread]: Acquiring new duckdb connection 'generate_catalog'
[0m14:49:20.252321 [info ] [MainThread]: Building catalog
[0m14:49:20.255124 [debug] [ThreadPool]: Acquiring new duckdb connection 'casestudy.information_schema'
[0m14:49:20.261222 [debug] [ThreadPool]: Using duckdb connection "casestudy.information_schema"
[0m14:49:20.261723 [debug] [ThreadPool]: On casestudy.information_schema: BEGIN
[0m14:49:20.262094 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:49:20.277125 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:49:20.277544 [debug] [ThreadPool]: Using duckdb connection "casestudy.information_schema"
[0m14:49:20.277840 [debug] [ThreadPool]: On casestudy.information_schema: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "casestudy.information_schema"} */
select
        'casestudy' as table_database,
        t.table_schema,
        t.table_name,
        t.table_type,
        '' as table_comment,
        c.column_name,
        c.ordinal_position as column_index,
        c.data_type column_type,
        '' as column_comment,
        '' as table_owner
    FROM information_schema.tables t JOIN information_schema.columns c ON t.table_schema = c.table_schema AND t.table_name = c.table_name
    WHERE (upper(t.table_schema) = upper('raw') or upper(t.table_schema) = upper('intermediate') or upper(t.table_schema) = upper('staging'))
    AND t.table_type IN ('BASE TABLE', 'VIEW')
    ORDER BY
        t.table_schema,
        t.table_name,
        c.ordinal_position
[0m14:49:20.295418 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:49:20.303601 [debug] [ThreadPool]: On casestudy.information_schema: ROLLBACK
[0m14:49:20.304147 [debug] [ThreadPool]: Failed to rollback 'casestudy.information_schema'
[0m14:49:20.304440 [debug] [ThreadPool]: On casestudy.information_schema: Close
[0m14:49:20.328673 [info ] [MainThread]: Catalog written to /workspaces/vg_case_study_tim/transformation/target/catalog.json
[0m14:49:20.329498 [debug] [MainThread]: Command `dbt docs generate` succeeded at 14:49:20.329380 after 1.36 seconds
[0m14:49:20.329816 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m14:49:20.330073 [debug] [MainThread]: Connection 'casestudy.information_schema' was properly closed.
[0m14:49:20.330374 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe4dcaf74d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe4e1b92650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe4dd4534d0>]}
[0m14:49:20.330758 [debug] [MainThread]: Flushing usage events
[0m14:49:31.275710 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f313e685710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f313e4cf690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f313e66e110>]}


============================== 14:49:31.278925 | 28a73fc8-4153-441a-9a86-d57f77d9be57 ==============================
[0m14:49:31.278925 [info ] [MainThread]: Running with dbt=1.6.18
[0m14:49:31.279586 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/workspaces/vg_case_study_tim/transformation/logs', 'debug': 'False', 'profiles_dir': '/workspaces/vg_case_study_tim/transformation', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt docs serve', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:49:31.396326 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '28a73fc8-4153-441a-9a86-d57f77d9be57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f313e4e7490>]}
[0m14:49:31.412376 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '28a73fc8-4153-441a-9a86-d57f77d9be57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3140147a90>]}
[0m03:35:53.257620 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7af32a9750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7af34102d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7af33d8150>]}


============================== 03:35:53.261900 | 89fa9f91-35ff-40cb-bc95-45ef446e59f7 ==============================
[0m03:35:53.261900 [info ] [MainThread]: Running with dbt=1.6.18
[0m03:35:53.262514 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/workspaces/vg_case_study_tim/transformation/logs', 'profiles_dir': '/workspaces/vg_case_study_tim/transformation', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt debug', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m03:35:53.262909 [info ] [MainThread]: dbt version: 1.6.18
[0m03:35:53.263272 [info ] [MainThread]: python version: 3.11.6
[0m03:35:53.263605 [info ] [MainThread]: python path: /usr/local/bin/python
[0m03:35:53.263913 [info ] [MainThread]: os info: Linux-5.15.153.1-microsoft-standard-WSL2-x86_64-with-glibc2.31
[0m03:35:53.382819 [info ] [MainThread]: Using profiles dir at /workspaces/vg_case_study_tim/transformation
[0m03:35:53.383317 [info ] [MainThread]: Using profiles.yml file at /workspaces/vg_case_study_tim/transformation/profiles.yml
[0m03:35:53.383671 [info ] [MainThread]: Using dbt_project.yml file at /workspaces/vg_case_study_tim/transformation/dbt_project.yml
[0m03:35:53.384625 [info ] [MainThread]: adapter type: duckdb
[0m03:35:53.384989 [info ] [MainThread]: adapter version: 1.6.2
[0m03:35:53.421016 [info ] [MainThread]: Configuration:
[0m03:35:53.421515 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m03:35:53.421870 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m03:35:53.422176 [info ] [MainThread]: Required dependencies:
[0m03:35:53.422560 [debug] [MainThread]: Executing "git --help"
[0m03:35:53.424463 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m03:35:53.424944 [debug] [MainThread]: STDERR: "b''"
[0m03:35:53.425262 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m03:35:53.425590 [info ] [MainThread]: Connection:
[0m03:35:53.425887 [info ] [MainThread]:   database: casestudy
[0m03:35:53.426197 [info ] [MainThread]:   schema: main
[0m03:35:53.426506 [info ] [MainThread]:   path: casestudy.duckdb
[0m03:35:53.426927 [info ] [MainThread]:   config_options: None
[0m03:35:53.427236 [info ] [MainThread]:   extensions: ['icu']
[0m03:35:53.427510 [info ] [MainThread]:   settings: None
[0m03:35:53.427802 [info ] [MainThread]:   external_root: .
[0m03:35:53.428121 [info ] [MainThread]:   use_credential_provider: None
[0m03:35:53.428511 [info ] [MainThread]:   attach: None
[0m03:35:53.428876 [info ] [MainThread]:   filesystems: None
[0m03:35:53.429300 [info ] [MainThread]:   remote: None
[0m03:35:53.429857 [info ] [MainThread]:   plugins: None
[0m03:35:53.430348 [info ] [MainThread]:   disable_transactions: False
[0m03:35:53.430846 [info ] [MainThread]: Registered adapter: duckdb=1.6.2
[0m03:35:53.431664 [debug] [MainThread]: Acquiring new duckdb connection 'debug'
[0m03:35:53.432031 [debug] [MainThread]: Using duckdb connection "debug"
[0m03:35:53.432418 [debug] [MainThread]: On debug: select 1 as id
[0m03:35:53.432824 [debug] [MainThread]: Opening a new connection, currently in state init
[0m03:35:53.561709 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m03:35:53.562996 [debug] [MainThread]: On debug: Close
[0m03:35:53.566971 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m03:35:53.567540 [info ] [MainThread]: [32mAll checks passed![0m
[0m03:35:53.568140 [debug] [MainThread]: Command `dbt debug` succeeded at 03:35:53.568004 after 0.32 seconds
[0m03:35:53.568567 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m03:35:53.568984 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7af3262bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7af79e5bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7af56253d0>]}
[0m03:35:53.569387 [debug] [MainThread]: Flushing usage events
[0m05:42:00.210869 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f24c2f815d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f24c2dd0890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f24c2afc150>]}


============================== 05:42:00.216117 | 5e6b65a8-9c36-4e9b-be9e-cc48704d7f3e ==============================
[0m05:42:00.216117 [info ] [MainThread]: Running with dbt=1.6.18
[0m05:42:00.216636 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/workspaces/vg_case_study_tim/transformation', 'log_path': '/workspaces/vg_case_study_tim/transformation/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt debug', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m05:42:00.217121 [info ] [MainThread]: dbt version: 1.6.18
[0m05:42:00.217485 [info ] [MainThread]: python version: 3.11.6
[0m05:42:00.217828 [info ] [MainThread]: python path: /usr/local/bin/python
[0m05:42:00.218240 [info ] [MainThread]: os info: Linux-5.15.153.1-microsoft-standard-WSL2-x86_64-with-glibc2.31
[0m05:42:00.339660 [info ] [MainThread]: Using profiles dir at /workspaces/vg_case_study_tim/transformation
[0m05:42:00.340179 [info ] [MainThread]: Using profiles.yml file at /workspaces/vg_case_study_tim/transformation/profiles.yml
[0m05:42:00.340577 [info ] [MainThread]: Using dbt_project.yml file at /workspaces/vg_case_study_tim/transformation/dbt_project.yml
[0m05:42:00.341637 [info ] [MainThread]: adapter type: duckdb
[0m05:42:00.342020 [info ] [MainThread]: adapter version: 1.6.2
[0m05:42:00.375136 [info ] [MainThread]: Configuration:
[0m05:42:00.375648 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m05:42:00.376089 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m05:42:00.376422 [info ] [MainThread]: Required dependencies:
[0m05:42:00.376734 [debug] [MainThread]: Executing "git --help"
[0m05:42:00.378442 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m05:42:00.378977 [debug] [MainThread]: STDERR: "b''"
[0m05:42:00.379301 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m05:42:00.379641 [info ] [MainThread]: Connection:
[0m05:42:00.379998 [info ] [MainThread]:   database: casestudy
[0m05:42:00.380384 [info ] [MainThread]:   schema: main
[0m05:42:00.380802 [info ] [MainThread]:   path: casestudy.duckdb
[0m05:42:00.381102 [info ] [MainThread]:   config_options: None
[0m05:42:00.381379 [info ] [MainThread]:   extensions: ['icu']
[0m05:42:00.381743 [info ] [MainThread]:   settings: None
[0m05:42:00.382174 [info ] [MainThread]:   external_root: .
[0m05:42:00.382582 [info ] [MainThread]:   use_credential_provider: None
[0m05:42:00.383016 [info ] [MainThread]:   attach: None
[0m05:42:00.383505 [info ] [MainThread]:   filesystems: None
[0m05:42:00.383993 [info ] [MainThread]:   remote: None
[0m05:42:00.384325 [info ] [MainThread]:   plugins: None
[0m05:42:00.384616 [info ] [MainThread]:   disable_transactions: False
[0m05:42:00.384996 [info ] [MainThread]: Registered adapter: duckdb=1.6.2
[0m05:42:00.385565 [debug] [MainThread]: Acquiring new duckdb connection 'debug'
[0m05:42:00.385877 [debug] [MainThread]: Using duckdb connection "debug"
[0m05:42:00.386185 [debug] [MainThread]: On debug: select 1 as id
[0m05:42:00.386464 [debug] [MainThread]: Opening a new connection, currently in state init
[0m05:42:00.512576 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m05:42:00.513666 [debug] [MainThread]: On debug: Close
[0m05:42:00.517118 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m05:42:00.517744 [info ] [MainThread]: [32mAll checks passed![0m
[0m05:42:00.518320 [debug] [MainThread]: Command `dbt debug` succeeded at 05:42:00.518210 after 0.32 seconds
[0m05:42:00.518680 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m05:42:00.519064 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f24c2cad490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f24c77b72d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f24c4915490>]}
[0m05:42:00.519469 [debug] [MainThread]: Flushing usage events
[0m09:30:40.601352 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee40feb810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee4108c910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee41319b10>]}


============================== 09:30:40.606898 | 88cf7907-557b-421f-b00a-ea7228b43b7e ==============================
[0m09:30:40.606898 [info ] [MainThread]: Running with dbt=1.6.18
[0m09:30:40.607475 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/workspaces/vg_case_study_tim/transformation/logs', 'profiles_dir': '/workspaces/vg_case_study_tim/transformation', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt seed --select fx_rates_full_history', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m09:30:40.811546 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '88cf7907-557b-421f-b00a-ea7228b43b7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee411d3010>]}
[0m09:30:40.826516 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '88cf7907-557b-421f-b00a-ea7228b43b7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee40d90b90>]}
[0m09:30:40.828085 [info ] [MainThread]: Registered adapter: duckdb=1.6.2
[0m09:30:40.857854 [debug] [MainThread]: checksum: 7b9fab86a08e9e96a48a825af743c566d95b877e068b8c6d0dbafbf714447189, vars: {}, profile: , target: , version: 1.6.18
[0m09:30:40.952478 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m09:30:40.953199 [debug] [MainThread]: Partial parsing: added file: vg_casestudy://seeds/fx_rates_full_history.csv
[0m09:30:40.998618 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.vg_casestudy.main
- models.vg_casestudy.marts
- models.vg_casestudy.reporting
[0m09:30:41.005350 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '88cf7907-557b-421f-b00a-ea7228b43b7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee40d8e050>]}
[0m09:30:41.073290 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '88cf7907-557b-421f-b00a-ea7228b43b7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee3d6ec4d0>]}
[0m09:30:41.073843 [info ] [MainThread]: Found 11 models, 1 analysis, 3 seeds, 71 tests, 5 sources, 0 exposures, 0 metrics, 632 macros, 0 groups, 0 semantic models
[0m09:30:41.074235 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '88cf7907-557b-421f-b00a-ea7228b43b7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee40d81310>]}
[0m09:30:41.076448 [info ] [MainThread]: 
[0m09:30:41.077233 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m09:30:41.078328 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_casestudy'
[0m09:30:41.091161 [debug] [ThreadPool]: Using duckdb connection "list_casestudy"
[0m09:30:41.091603 [debug] [ThreadPool]: On list_casestudy: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"casestudy"'
    
  
  
[0m09:30:41.091962 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:30:41.224718 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m09:30:41.226311 [debug] [ThreadPool]: On list_casestudy: Close
[0m09:30:41.230306 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy, now create_casestudy_raw)
[0m09:30:41.231072 [debug] [ThreadPool]: Creating schema "database: "casestudy"
schema: "raw"
"
[0m09:30:41.235565 [debug] [ThreadPool]: Using duckdb connection "create_casestudy_raw"
[0m09:30:41.235981 [debug] [ThreadPool]: On create_casestudy_raw: BEGIN
[0m09:30:41.236266 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:30:41.249391 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m09:30:41.249868 [debug] [ThreadPool]: Using duckdb connection "create_casestudy_raw"
[0m09:30:41.250163 [debug] [ThreadPool]: On create_casestudy_raw: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "create_casestudy_raw"} */
create schema if not exists "casestudy"."raw"
[0m09:30:41.250788 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m09:30:41.251708 [debug] [ThreadPool]: On create_casestudy_raw: COMMIT
[0m09:30:41.252026 [debug] [ThreadPool]: Using duckdb connection "create_casestudy_raw"
[0m09:30:41.252291 [debug] [ThreadPool]: On create_casestudy_raw: COMMIT
[0m09:30:41.252895 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m09:30:41.253232 [debug] [ThreadPool]: On create_casestudy_raw: Close
[0m09:30:41.258465 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_casestudy_raw, now list_casestudy_intermediate)
[0m09:30:41.264130 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_intermediate"
[0m09:30:41.264523 [debug] [ThreadPool]: On list_casestudy_intermediate: BEGIN
[0m09:30:41.264795 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:30:41.276180 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m09:30:41.276662 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_intermediate"
[0m09:30:41.276971 [debug] [ThreadPool]: On list_casestudy_intermediate: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_intermediate"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'intermediate'
    and table_catalog = 'casestudy'
  
[0m09:30:41.294107 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m09:30:41.295705 [debug] [ThreadPool]: On list_casestudy_intermediate: ROLLBACK
[0m09:30:41.297555 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_intermediate'
[0m09:30:41.297874 [debug] [ThreadPool]: On list_casestudy_intermediate: Close
[0m09:30:41.301023 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy_intermediate, now list_casestudy_staging)
[0m09:30:41.303186 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_staging"
[0m09:30:41.303524 [debug] [ThreadPool]: On list_casestudy_staging: BEGIN
[0m09:30:41.303837 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:30:41.314497 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m09:30:41.314927 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_staging"
[0m09:30:41.315213 [debug] [ThreadPool]: On list_casestudy_staging: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_staging"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'staging'
    and table_catalog = 'casestudy'
  
[0m09:30:41.323420 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m09:30:41.324836 [debug] [ThreadPool]: On list_casestudy_staging: ROLLBACK
[0m09:30:41.325334 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_staging'
[0m09:30:41.325604 [debug] [ThreadPool]: On list_casestudy_staging: Close
[0m09:30:41.328426 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy_staging, now list_casestudy_raw)
[0m09:30:41.330712 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_raw"
[0m09:30:41.331069 [debug] [ThreadPool]: On list_casestudy_raw: BEGIN
[0m09:30:41.331397 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:30:41.341962 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m09:30:41.342357 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_raw"
[0m09:30:41.342646 [debug] [ThreadPool]: On list_casestudy_raw: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_raw"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'raw'
    and table_catalog = 'casestudy'
  
[0m09:30:41.350743 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m09:30:41.352021 [debug] [ThreadPool]: On list_casestudy_raw: ROLLBACK
[0m09:30:41.352471 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_raw'
[0m09:30:41.352732 [debug] [ThreadPool]: On list_casestudy_raw: Close
[0m09:30:41.356783 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '88cf7907-557b-421f-b00a-ea7228b43b7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee41effa10>]}
[0m09:30:41.357330 [debug] [MainThread]: Using duckdb connection "master"
[0m09:30:41.357658 [debug] [MainThread]: On master: BEGIN
[0m09:30:41.357953 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:30:41.371181 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m09:30:41.371593 [debug] [MainThread]: On master: COMMIT
[0m09:30:41.371928 [debug] [MainThread]: Using duckdb connection "master"
[0m09:30:41.372192 [debug] [MainThread]: On master: COMMIT
[0m09:30:41.372755 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m09:30:41.373050 [debug] [MainThread]: On master: Close
[0m09:30:41.375536 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:30:41.375969 [info ] [MainThread]: 
[0m09:30:41.400237 [debug] [Thread-1 (]: Began running node seed.vg_casestudy.fx_rates_full_history
[0m09:30:41.400769 [info ] [Thread-1 (]: 1 of 1 START seed file raw.fx_rates_full_history ............................... [RUN]
[0m09:30:41.401557 [debug] [Thread-1 (]: Acquiring new duckdb connection 'seed.vg_casestudy.fx_rates_full_history'
[0m09:30:41.401978 [debug] [Thread-1 (]: Began compiling node seed.vg_casestudy.fx_rates_full_history
[0m09:30:41.402453 [debug] [Thread-1 (]: Timing info for seed.vg_casestudy.fx_rates_full_history (compile): 09:30:41.402260 => 09:30:41.402264
[0m09:30:41.402808 [debug] [Thread-1 (]: Began executing node seed.vg_casestudy.fx_rates_full_history
[0m09:30:41.445004 [debug] [Thread-1 (]: Using duckdb connection "seed.vg_casestudy.fx_rates_full_history"
[0m09:30:41.445432 [debug] [Thread-1 (]: On seed.vg_casestudy.fx_rates_full_history: BEGIN
[0m09:30:41.445757 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m09:30:41.458370 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:30:41.458798 [debug] [Thread-1 (]: Using duckdb connection "seed.vg_casestudy.fx_rates_full_history"
[0m09:30:41.459133 [debug] [Thread-1 (]: On seed.vg_casestudy.fx_rates_full_history: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "seed.vg_casestudy.fx_rates_full_history"} */

    create table "casestudy"."raw"."fx_rates_full_history" ("currency_iso_code" text,"fx_rate_date" date,"fx_rate" float8)
  
[0m09:30:41.459901 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:30:41.472758 [debug] [Thread-1 (]: Using duckdb connection "seed.vg_casestudy.fx_rates_full_history"
[0m09:30:41.473233 [debug] [Thread-1 (]: On seed.vg_casestudy.fx_rates_full_history: 
          COPY "casestudy"."raw"."fx_rates_full_history" FROM '/workspaces/vg_case_study_tim/transformation/seeds/fx_rates_full_history.csv' (FORMAT CSV, HEADER TRUE)
        ...
[0m09:30:41.534538 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:30:41.540037 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.vg_casestudy.fx_rates_full_history"
[0m09:30:41.555491 [debug] [Thread-1 (]: On seed.vg_casestudy.fx_rates_full_history: COMMIT
[0m09:30:41.555933 [debug] [Thread-1 (]: Using duckdb connection "seed.vg_casestudy.fx_rates_full_history"
[0m09:30:41.556244 [debug] [Thread-1 (]: On seed.vg_casestudy.fx_rates_full_history: COMMIT
[0m09:30:41.562599 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:30:41.563781 [debug] [Thread-1 (]: Timing info for seed.vg_casestudy.fx_rates_full_history (execute): 09:30:41.403049 => 09:30:41.563592
[0m09:30:41.564108 [debug] [Thread-1 (]: On seed.vg_casestudy.fx_rates_full_history: Close
[0m09:30:41.601896 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '88cf7907-557b-421f-b00a-ea7228b43b7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee4112ac90>]}
[0m09:30:41.602645 [info ] [Thread-1 (]: 1 of 1 OK loaded seed file raw.fx_rates_full_history ........................... [[32mINSERT 735[0m in 0.20s]
[0m09:30:41.603404 [debug] [Thread-1 (]: Finished running node seed.vg_casestudy.fx_rates_full_history
[0m09:30:41.605353 [debug] [MainThread]: Using duckdb connection "master"
[0m09:30:41.605793 [debug] [MainThread]: On master: BEGIN
[0m09:30:41.606114 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:30:41.620601 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m09:30:41.621269 [debug] [MainThread]: On master: COMMIT
[0m09:30:41.621734 [debug] [MainThread]: Using duckdb connection "master"
[0m09:30:41.622035 [debug] [MainThread]: On master: COMMIT
[0m09:30:41.622735 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m09:30:41.623093 [debug] [MainThread]: On master: Close
[0m09:30:41.625546 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:30:41.625900 [debug] [MainThread]: Connection 'list_casestudy_raw' was properly closed.
[0m09:30:41.626163 [debug] [MainThread]: Connection 'seed.vg_casestudy.fx_rates_full_history' was properly closed.
[0m09:30:41.626473 [info ] [MainThread]: 
[0m09:30:41.626808 [info ] [MainThread]: Finished running 1 seed in 0 hours 0 minutes and 0.55 seconds (0.55s).
[0m09:30:41.627402 [debug] [MainThread]: Command end result
[0m09:30:41.644342 [info ] [MainThread]: 
[0m09:30:41.644924 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:30:41.645333 [info ] [MainThread]: 
[0m09:30:41.645771 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m09:30:41.646373 [debug] [MainThread]: Command `dbt seed` succeeded at 09:30:41.646264 after 1.06 seconds
[0m09:30:41.646724 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee459eb210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee459ea250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee41318f90>]}
[0m09:30:41.647069 [debug] [MainThread]: Flushing usage events
[0m09:41:44.364147 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8be26f0050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8be26f3f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8be2727110>]}


============================== 09:41:44.370127 | 37d31229-dfa1-442b-9e0d-03a899165495 ==============================
[0m09:41:44.370127 [info ] [MainThread]: Running with dbt=1.6.18
[0m09:41:44.370713 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/workspaces/vg_case_study_tim/transformation', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/workspaces/vg_case_study_tim/transformation/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt seed --select fx_rates_full_history --full-refresh', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m09:41:44.585071 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '37d31229-dfa1-442b-9e0d-03a899165495', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8be28c6810>]}
[0m09:41:44.617478 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '37d31229-dfa1-442b-9e0d-03a899165495', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8be28bfb50>]}
[0m09:41:44.619243 [info ] [MainThread]: Registered adapter: duckdb=1.6.2
[0m09:41:44.675778 [debug] [MainThread]: checksum: 7b9fab86a08e9e96a48a825af743c566d95b877e068b8c6d0dbafbf714447189, vars: {}, profile: , target: , version: 1.6.18
[0m09:41:44.787554 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m09:41:44.788503 [debug] [MainThread]: Partial parsing: added file: vg_casestudy://seeds/fx_rates_full_history.yml
[0m09:41:44.900184 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.vg_casestudy.marts
- models.vg_casestudy.reporting
- models.vg_casestudy.main
[0m09:41:44.909175 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '37d31229-dfa1-442b-9e0d-03a899165495', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8be2a3bfd0>]}
[0m09:41:44.945389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '37d31229-dfa1-442b-9e0d-03a899165495', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8bde440090>]}
[0m09:41:44.946030 [info ] [MainThread]: Found 11 models, 1 analysis, 3 seeds, 74 tests, 5 sources, 0 exposures, 0 metrics, 632 macros, 0 groups, 0 semantic models
[0m09:41:44.946556 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '37d31229-dfa1-442b-9e0d-03a899165495', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8be2968d50>]}
[0m09:41:44.949461 [info ] [MainThread]: 
[0m09:41:44.950619 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m09:41:44.953755 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_casestudy'
[0m09:41:44.969226 [debug] [ThreadPool]: Using duckdb connection "list_casestudy"
[0m09:41:44.969697 [debug] [ThreadPool]: On list_casestudy: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"casestudy"'
    
  
  
[0m09:41:44.970012 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:41:45.102518 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m09:41:45.104200 [debug] [ThreadPool]: On list_casestudy: Close
[0m09:41:45.109892 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy, now create_casestudy_raw)
[0m09:41:45.110846 [debug] [ThreadPool]: Creating schema "database: "casestudy"
schema: "raw"
"
[0m09:41:45.116498 [debug] [ThreadPool]: Using duckdb connection "create_casestudy_raw"
[0m09:41:45.116968 [debug] [ThreadPool]: On create_casestudy_raw: BEGIN
[0m09:41:45.117320 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:41:45.129956 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m09:41:45.130420 [debug] [ThreadPool]: Using duckdb connection "create_casestudy_raw"
[0m09:41:45.130736 [debug] [ThreadPool]: On create_casestudy_raw: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "create_casestudy_raw"} */
create schema if not exists "casestudy"."raw"
[0m09:41:45.131415 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m09:41:45.132388 [debug] [ThreadPool]: On create_casestudy_raw: COMMIT
[0m09:41:45.132717 [debug] [ThreadPool]: Using duckdb connection "create_casestudy_raw"
[0m09:41:45.132987 [debug] [ThreadPool]: On create_casestudy_raw: COMMIT
[0m09:41:45.133724 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m09:41:45.134118 [debug] [ThreadPool]: On create_casestudy_raw: Close
[0m09:41:45.140013 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_casestudy_raw, now list_casestudy_raw)
[0m09:41:45.145899 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_raw"
[0m09:41:45.146395 [debug] [ThreadPool]: On list_casestudy_raw: BEGIN
[0m09:41:45.146730 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:41:45.159709 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m09:41:45.160162 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_raw"
[0m09:41:45.160491 [debug] [ThreadPool]: On list_casestudy_raw: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_raw"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'raw'
    and table_catalog = 'casestudy'
  
[0m09:41:45.175671 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m09:41:45.178102 [debug] [ThreadPool]: On list_casestudy_raw: ROLLBACK
[0m09:41:45.179860 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_raw'
[0m09:41:45.180646 [debug] [ThreadPool]: On list_casestudy_raw: Close
[0m09:41:45.184411 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy_raw, now list_casestudy_staging)
[0m09:41:45.189510 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_staging"
[0m09:41:45.189975 [debug] [ThreadPool]: On list_casestudy_staging: BEGIN
[0m09:41:45.190423 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:41:45.205210 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m09:41:45.205891 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_staging"
[0m09:41:45.206348 [debug] [ThreadPool]: On list_casestudy_staging: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_staging"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'staging'
    and table_catalog = 'casestudy'
  
[0m09:41:45.219660 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m09:41:45.221700 [debug] [ThreadPool]: On list_casestudy_staging: ROLLBACK
[0m09:41:45.222558 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_staging'
[0m09:41:45.223003 [debug] [ThreadPool]: On list_casestudy_staging: Close
[0m09:41:45.227029 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy_staging, now list_casestudy_intermediate)
[0m09:41:45.231370 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_intermediate"
[0m09:41:45.231877 [debug] [ThreadPool]: On list_casestudy_intermediate: BEGIN
[0m09:41:45.232381 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:41:45.248415 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m09:41:45.249072 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_intermediate"
[0m09:41:45.249601 [debug] [ThreadPool]: On list_casestudy_intermediate: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_intermediate"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'intermediate'
    and table_catalog = 'casestudy'
  
[0m09:41:45.260029 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m09:41:45.261792 [debug] [ThreadPool]: On list_casestudy_intermediate: ROLLBACK
[0m09:41:45.262686 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_intermediate'
[0m09:41:45.263043 [debug] [ThreadPool]: On list_casestudy_intermediate: Close
[0m09:41:45.267339 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '37d31229-dfa1-442b-9e0d-03a899165495', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8be2463f50>]}
[0m09:41:45.267975 [debug] [MainThread]: Using duckdb connection "master"
[0m09:41:45.268324 [debug] [MainThread]: On master: BEGIN
[0m09:41:45.268711 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:41:45.283808 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m09:41:45.284512 [debug] [MainThread]: On master: COMMIT
[0m09:41:45.285103 [debug] [MainThread]: Using duckdb connection "master"
[0m09:41:45.285567 [debug] [MainThread]: On master: COMMIT
[0m09:41:45.286324 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m09:41:45.286730 [debug] [MainThread]: On master: Close
[0m09:41:45.289632 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:41:45.290219 [info ] [MainThread]: 
[0m09:41:45.295766 [debug] [Thread-1 (]: Began running node seed.vg_casestudy.fx_rates_full_history
[0m09:41:45.296394 [info ] [Thread-1 (]: 1 of 1 START seed file raw.fx_rates_full_history ............................... [RUN]
[0m09:41:45.297633 [debug] [Thread-1 (]: Acquiring new duckdb connection 'seed.vg_casestudy.fx_rates_full_history'
[0m09:41:45.298326 [debug] [Thread-1 (]: Began compiling node seed.vg_casestudy.fx_rates_full_history
[0m09:41:45.299559 [debug] [Thread-1 (]: Timing info for seed.vg_casestudy.fx_rates_full_history (compile): 09:41:45.298870 => 09:41:45.298876
[0m09:41:45.300258 [debug] [Thread-1 (]: Began executing node seed.vg_casestudy.fx_rates_full_history
[0m09:41:45.347711 [debug] [Thread-1 (]: Using duckdb connection "seed.vg_casestudy.fx_rates_full_history"
[0m09:41:45.348191 [debug] [Thread-1 (]: On seed.vg_casestudy.fx_rates_full_history: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "seed.vg_casestudy.fx_rates_full_history"} */
drop table if exists "casestudy"."raw"."fx_rates_full_history" cascade
[0m09:41:45.348565 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m09:41:45.373944 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:41:45.386142 [debug] [Thread-1 (]: Using duckdb connection "seed.vg_casestudy.fx_rates_full_history"
[0m09:41:45.386647 [debug] [Thread-1 (]: On seed.vg_casestudy.fx_rates_full_history: BEGIN
[0m09:41:45.387475 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:41:45.387829 [debug] [Thread-1 (]: Using duckdb connection "seed.vg_casestudy.fx_rates_full_history"
[0m09:41:45.388133 [debug] [Thread-1 (]: On seed.vg_casestudy.fx_rates_full_history: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "seed.vg_casestudy.fx_rates_full_history"} */

    create table "casestudy"."raw"."fx_rates_full_history" ("currency_iso_code" text,"fx_rate_date" date,"fx_rate" float8)
  
[0m09:41:45.388802 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:41:45.400153 [debug] [Thread-1 (]: Using duckdb connection "seed.vg_casestudy.fx_rates_full_history"
[0m09:41:45.400720 [debug] [Thread-1 (]: On seed.vg_casestudy.fx_rates_full_history: 
          COPY "casestudy"."raw"."fx_rates_full_history" FROM '/workspaces/vg_case_study_tim/transformation/seeds/fx_rates_full_history.csv' (FORMAT CSV, HEADER TRUE)
        ...
[0m09:41:45.458121 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:41:45.463589 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.vg_casestudy.fx_rates_full_history"
[0m09:41:45.485914 [debug] [Thread-1 (]: On seed.vg_casestudy.fx_rates_full_history: COMMIT
[0m09:41:45.486380 [debug] [Thread-1 (]: Using duckdb connection "seed.vg_casestudy.fx_rates_full_history"
[0m09:41:45.486712 [debug] [Thread-1 (]: On seed.vg_casestudy.fx_rates_full_history: COMMIT
[0m09:41:45.492160 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:41:45.493259 [debug] [Thread-1 (]: Timing info for seed.vg_casestudy.fx_rates_full_history (execute): 09:41:45.300897 => 09:41:45.493049
[0m09:41:45.493664 [debug] [Thread-1 (]: On seed.vg_casestudy.fx_rates_full_history: Close
[0m09:41:45.522135 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '37d31229-dfa1-442b-9e0d-03a899165495', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8be2a45390>]}
[0m09:41:45.522806 [info ] [Thread-1 (]: 1 of 1 OK loaded seed file raw.fx_rates_full_history ........................... [[32mCREATE 735[0m in 0.23s]
[0m09:41:45.523409 [debug] [Thread-1 (]: Finished running node seed.vg_casestudy.fx_rates_full_history
[0m09:41:45.525404 [debug] [MainThread]: Using duckdb connection "master"
[0m09:41:45.525865 [debug] [MainThread]: On master: BEGIN
[0m09:41:45.526202 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:41:45.543539 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m09:41:45.544120 [debug] [MainThread]: On master: COMMIT
[0m09:41:45.544510 [debug] [MainThread]: Using duckdb connection "master"
[0m09:41:45.544860 [debug] [MainThread]: On master: COMMIT
[0m09:41:45.545595 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m09:41:45.545920 [debug] [MainThread]: On master: Close
[0m09:41:45.548614 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:41:45.549088 [debug] [MainThread]: Connection 'list_casestudy_intermediate' was properly closed.
[0m09:41:45.549382 [debug] [MainThread]: Connection 'seed.vg_casestudy.fx_rates_full_history' was properly closed.
[0m09:41:45.549768 [info ] [MainThread]: 
[0m09:41:45.550162 [info ] [MainThread]: Finished running 1 seed in 0 hours 0 minutes and 0.60 seconds (0.60s).
[0m09:41:45.550958 [debug] [MainThread]: Command end result
[0m09:41:45.571620 [info ] [MainThread]: 
[0m09:41:45.572311 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:41:45.572778 [info ] [MainThread]: 
[0m09:41:45.573239 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m09:41:45.573960 [debug] [MainThread]: Command `dbt seed` succeeded at 09:41:45.573802 after 1.22 seconds
[0m09:41:45.574478 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8be2b71190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8be244c550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8be4231350>]}
[0m09:41:45.574926 [debug] [MainThread]: Flushing usage events
[0m09:42:28.239016 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f038ac23350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f038ade6a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f038aaf0250>]}


============================== 09:42:28.241506 | e5d4e6d1-981f-4395-b1a8-58352a7213c6 ==============================
[0m09:42:28.241506 [info ] [MainThread]: Running with dbt=1.6.18
[0m09:42:28.242082 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/workspaces/vg_case_study_tim/transformation', 'log_path': '/workspaces/vg_case_study_tim/transformation/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test --select fx_rates_full_history', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m09:42:28.340384 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e5d4e6d1-981f-4395-b1a8-58352a7213c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f038adca550>]}
[0m09:42:28.354465 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e5d4e6d1-981f-4395-b1a8-58352a7213c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f038af15a50>]}
[0m09:42:28.355212 [info ] [MainThread]: Registered adapter: duckdb=1.6.2
[0m09:42:28.380013 [debug] [MainThread]: checksum: 7b9fab86a08e9e96a48a825af743c566d95b877e068b8c6d0dbafbf714447189, vars: {}, profile: , target: , version: 1.6.18
[0m09:42:28.425109 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:42:28.425549 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:42:28.426808 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.vg_casestudy.reporting
- models.vg_casestudy.main
- models.vg_casestudy.marts
[0m09:42:28.434281 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e5d4e6d1-981f-4395-b1a8-58352a7213c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f038adca150>]}
[0m09:42:28.463006 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e5d4e6d1-981f-4395-b1a8-58352a7213c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f03869e0c10>]}
[0m09:42:28.463560 [info ] [MainThread]: Found 11 models, 1 analysis, 3 seeds, 74 tests, 5 sources, 0 exposures, 0 metrics, 632 macros, 0 groups, 0 semantic models
[0m09:42:28.463968 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e5d4e6d1-981f-4395-b1a8-58352a7213c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f038abf39d0>]}
[0m09:42:28.466358 [info ] [MainThread]: 
[0m09:42:28.467300 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m09:42:28.469110 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_casestudy_raw'
[0m09:42:28.524544 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_raw"
[0m09:42:28.525084 [debug] [ThreadPool]: On list_casestudy_raw: BEGIN
[0m09:42:28.525399 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:42:28.542275 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m09:42:28.542735 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_raw"
[0m09:42:28.543096 [debug] [ThreadPool]: On list_casestudy_raw: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_raw"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'raw'
    and table_catalog = 'casestudy'
  
[0m09:42:28.553154 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m09:42:28.554664 [debug] [ThreadPool]: On list_casestudy_raw: ROLLBACK
[0m09:42:28.555416 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_raw'
[0m09:42:28.555784 [debug] [ThreadPool]: On list_casestudy_raw: Close
[0m09:42:28.560898 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy_raw, now list_casestudy_intermediate)
[0m09:42:28.564688 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_intermediate"
[0m09:42:28.565052 [debug] [ThreadPool]: On list_casestudy_intermediate: BEGIN
[0m09:42:28.565329 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:42:28.577028 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m09:42:28.577515 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_intermediate"
[0m09:42:28.577858 [debug] [ThreadPool]: On list_casestudy_intermediate: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_intermediate"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'intermediate'
    and table_catalog = 'casestudy'
  
[0m09:42:28.586807 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m09:42:28.588464 [debug] [ThreadPool]: On list_casestudy_intermediate: ROLLBACK
[0m09:42:28.589021 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_intermediate'
[0m09:42:28.589358 [debug] [ThreadPool]: On list_casestudy_intermediate: Close
[0m09:42:28.594676 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy_intermediate, now list_casestudy_staging)
[0m09:42:28.598271 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_staging"
[0m09:42:28.598762 [debug] [ThreadPool]: On list_casestudy_staging: BEGIN
[0m09:42:28.599123 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:42:28.611645 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m09:42:28.612266 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_staging"
[0m09:42:28.612635 [debug] [ThreadPool]: On list_casestudy_staging: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_staging"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'staging'
    and table_catalog = 'casestudy'
  
[0m09:42:28.622536 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m09:42:28.624026 [debug] [ThreadPool]: On list_casestudy_staging: ROLLBACK
[0m09:42:28.624533 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_staging'
[0m09:42:28.624842 [debug] [ThreadPool]: On list_casestudy_staging: Close
[0m09:42:28.629782 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e5d4e6d1-981f-4395-b1a8-58352a7213c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f038abc3110>]}
[0m09:42:28.630336 [debug] [MainThread]: Using duckdb connection "master"
[0m09:42:28.630647 [debug] [MainThread]: On master: BEGIN
[0m09:42:28.630930 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:42:28.642847 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m09:42:28.643269 [debug] [MainThread]: On master: COMMIT
[0m09:42:28.643605 [debug] [MainThread]: Using duckdb connection "master"
[0m09:42:28.643862 [debug] [MainThread]: On master: COMMIT
[0m09:42:28.644311 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m09:42:28.644606 [debug] [MainThread]: On master: Close
[0m09:42:28.646849 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:42:28.647277 [info ] [MainThread]: 
[0m09:42:28.649989 [debug] [Thread-1 (]: Began running node test.vg_casestudy.not_null_fx_rates_full_history_currency_iso_code.e845428370
[0m09:42:28.650499 [info ] [Thread-1 (]: 1 of 3 START test not_null_fx_rates_full_history_currency_iso_code ............. [RUN]
[0m09:42:28.651307 [debug] [Thread-1 (]: Acquiring new duckdb connection 'test.vg_casestudy.not_null_fx_rates_full_history_currency_iso_code.e845428370'
[0m09:42:28.651660 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.not_null_fx_rates_full_history_currency_iso_code.e845428370
[0m09:42:28.671970 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.not_null_fx_rates_full_history_currency_iso_code.e845428370"
[0m09:42:28.676145 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_fx_rates_full_history_currency_iso_code.e845428370 (compile): 09:42:28.651890 => 09:42:28.675842
[0m09:42:28.676577 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.not_null_fx_rates_full_history_currency_iso_code.e845428370
[0m09:42:28.688953 [debug] [Thread-1 (]: Writing runtime sql for node "test.vg_casestudy.not_null_fx_rates_full_history_currency_iso_code.e845428370"
[0m09:42:28.690892 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.not_null_fx_rates_full_history_currency_iso_code.e845428370"
[0m09:42:28.691282 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_fx_rates_full_history_currency_iso_code.e845428370: BEGIN
[0m09:42:28.691590 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m09:42:28.706035 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:42:28.706510 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.not_null_fx_rates_full_history_currency_iso_code.e845428370"
[0m09:42:28.706877 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_fx_rates_full_history_currency_iso_code.e845428370: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "test.vg_casestudy.not_null_fx_rates_full_history_currency_iso_code.e845428370"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select currency_iso_code
from "casestudy"."raw"."fx_rates_full_history"
where currency_iso_code is null



      
    ) dbt_internal_test
[0m09:42:28.712785 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:42:28.716343 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_fx_rates_full_history_currency_iso_code.e845428370 (execute): 09:42:28.676818 => 09:42:28.716086
[0m09:42:28.716815 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_fx_rates_full_history_currency_iso_code.e845428370: ROLLBACK
[0m09:42:28.717335 [debug] [Thread-1 (]: Failed to rollback 'test.vg_casestudy.not_null_fx_rates_full_history_currency_iso_code.e845428370'
[0m09:42:28.717675 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_fx_rates_full_history_currency_iso_code.e845428370: Close
[0m09:42:28.720320 [info ] [Thread-1 (]: 1 of 3 PASS not_null_fx_rates_full_history_currency_iso_code ................... [[32mPASS[0m in 0.07s]
[0m09:42:28.720947 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.not_null_fx_rates_full_history_currency_iso_code.e845428370
[0m09:42:28.721371 [debug] [Thread-1 (]: Began running node test.vg_casestudy.not_null_fx_rates_full_history_fx_rate.cdb4ee04e4
[0m09:42:28.721892 [info ] [Thread-1 (]: 2 of 3 START test not_null_fx_rates_full_history_fx_rate ....................... [RUN]
[0m09:42:28.722640 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.not_null_fx_rates_full_history_currency_iso_code.e845428370, now test.vg_casestudy.not_null_fx_rates_full_history_fx_rate.cdb4ee04e4)
[0m09:42:28.722976 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.not_null_fx_rates_full_history_fx_rate.cdb4ee04e4
[0m09:42:28.727337 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.not_null_fx_rates_full_history_fx_rate.cdb4ee04e4"
[0m09:42:28.728374 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_fx_rates_full_history_fx_rate.cdb4ee04e4 (compile): 09:42:28.723201 => 09:42:28.728142
[0m09:42:28.728786 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.not_null_fx_rates_full_history_fx_rate.cdb4ee04e4
[0m09:42:28.731790 [debug] [Thread-1 (]: Writing runtime sql for node "test.vg_casestudy.not_null_fx_rates_full_history_fx_rate.cdb4ee04e4"
[0m09:42:28.732707 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.not_null_fx_rates_full_history_fx_rate.cdb4ee04e4"
[0m09:42:28.733161 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_fx_rates_full_history_fx_rate.cdb4ee04e4: BEGIN
[0m09:42:28.733551 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:42:28.748014 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:42:28.748523 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.not_null_fx_rates_full_history_fx_rate.cdb4ee04e4"
[0m09:42:28.748891 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_fx_rates_full_history_fx_rate.cdb4ee04e4: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "test.vg_casestudy.not_null_fx_rates_full_history_fx_rate.cdb4ee04e4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select fx_rate
from "casestudy"."raw"."fx_rates_full_history"
where fx_rate is null



      
    ) dbt_internal_test
[0m09:42:28.750346 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:42:28.752599 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_fx_rates_full_history_fx_rate.cdb4ee04e4 (execute): 09:42:28.729078 => 09:42:28.752326
[0m09:42:28.753021 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_fx_rates_full_history_fx_rate.cdb4ee04e4: ROLLBACK
[0m09:42:28.753544 [debug] [Thread-1 (]: Failed to rollback 'test.vg_casestudy.not_null_fx_rates_full_history_fx_rate.cdb4ee04e4'
[0m09:42:28.753869 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_fx_rates_full_history_fx_rate.cdb4ee04e4: Close
[0m09:42:28.756374 [info ] [Thread-1 (]: 2 of 3 PASS not_null_fx_rates_full_history_fx_rate ............................. [[32mPASS[0m in 0.03s]
[0m09:42:28.757070 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.not_null_fx_rates_full_history_fx_rate.cdb4ee04e4
[0m09:42:28.757477 [debug] [Thread-1 (]: Began running node test.vg_casestudy.not_null_fx_rates_full_history_fx_rate_date.2fa88715f4
[0m09:42:28.757967 [info ] [Thread-1 (]: 3 of 3 START test not_null_fx_rates_full_history_fx_rate_date .................. [RUN]
[0m09:42:28.758659 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.not_null_fx_rates_full_history_fx_rate.cdb4ee04e4, now test.vg_casestudy.not_null_fx_rates_full_history_fx_rate_date.2fa88715f4)
[0m09:42:28.758998 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.not_null_fx_rates_full_history_fx_rate_date.2fa88715f4
[0m09:42:28.763273 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.not_null_fx_rates_full_history_fx_rate_date.2fa88715f4"
[0m09:42:28.765178 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_fx_rates_full_history_fx_rate_date.2fa88715f4 (compile): 09:42:28.759223 => 09:42:28.764894
[0m09:42:28.765641 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.not_null_fx_rates_full_history_fx_rate_date.2fa88715f4
[0m09:42:28.770480 [debug] [Thread-1 (]: Writing runtime sql for node "test.vg_casestudy.not_null_fx_rates_full_history_fx_rate_date.2fa88715f4"
[0m09:42:28.771262 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.not_null_fx_rates_full_history_fx_rate_date.2fa88715f4"
[0m09:42:28.771676 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_fx_rates_full_history_fx_rate_date.2fa88715f4: BEGIN
[0m09:42:28.772190 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:42:28.786452 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:42:28.786934 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.not_null_fx_rates_full_history_fx_rate_date.2fa88715f4"
[0m09:42:28.787288 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_fx_rates_full_history_fx_rate_date.2fa88715f4: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "test.vg_casestudy.not_null_fx_rates_full_history_fx_rate_date.2fa88715f4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select fx_rate_date
from "casestudy"."raw"."fx_rates_full_history"
where fx_rate_date is null



      
    ) dbt_internal_test
[0m09:42:28.788616 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:42:28.790300 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_fx_rates_full_history_fx_rate_date.2fa88715f4 (execute): 09:42:28.765931 => 09:42:28.790039
[0m09:42:28.790722 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_fx_rates_full_history_fx_rate_date.2fa88715f4: ROLLBACK
[0m09:42:28.791212 [debug] [Thread-1 (]: Failed to rollback 'test.vg_casestudy.not_null_fx_rates_full_history_fx_rate_date.2fa88715f4'
[0m09:42:28.791547 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_fx_rates_full_history_fx_rate_date.2fa88715f4: Close
[0m09:42:28.794525 [info ] [Thread-1 (]: 3 of 3 PASS not_null_fx_rates_full_history_fx_rate_date ........................ [[32mPASS[0m in 0.04s]
[0m09:42:28.795171 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.not_null_fx_rates_full_history_fx_rate_date.2fa88715f4
[0m09:42:28.796864 [debug] [MainThread]: Using duckdb connection "master"
[0m09:42:28.797179 [debug] [MainThread]: On master: BEGIN
[0m09:42:28.797438 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:42:28.810746 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m09:42:28.811189 [debug] [MainThread]: On master: COMMIT
[0m09:42:28.811473 [debug] [MainThread]: Using duckdb connection "master"
[0m09:42:28.811741 [debug] [MainThread]: On master: COMMIT
[0m09:42:28.812351 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m09:42:28.812742 [debug] [MainThread]: On master: Close
[0m09:42:28.815631 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:42:28.816053 [debug] [MainThread]: Connection 'list_casestudy_staging' was properly closed.
[0m09:42:28.816394 [debug] [MainThread]: Connection 'test.vg_casestudy.not_null_fx_rates_full_history_fx_rate_date.2fa88715f4' was properly closed.
[0m09:42:28.816780 [info ] [MainThread]: 
[0m09:42:28.817185 [info ] [MainThread]: Finished running 3 tests in 0 hours 0 minutes and 0.35 seconds (0.35s).
[0m09:42:28.818083 [debug] [MainThread]: Command end result
[0m09:42:28.837497 [info ] [MainThread]: 
[0m09:42:28.838012 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:42:28.838351 [info ] [MainThread]: 
[0m09:42:28.838742 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m09:42:28.839365 [debug] [MainThread]: Command `dbt test` succeeded at 09:42:28.839188 after 0.61 seconds
[0m09:42:28.839964 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f038b2cc490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f038addd710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f038ad1b850>]}
[0m09:42:28.840565 [debug] [MainThread]: Flushing usage events
[0m10:25:41.038445 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffbe4aa5250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffbe4c32990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffbe4bf9e90>]}


============================== 10:25:41.044580 | 65e203fe-17cc-4604-87f7-c0a5db50b3fe ==============================
[0m10:25:41.044580 [info ] [MainThread]: Running with dbt=1.6.18
[0m10:25:41.045180 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/workspaces/vg_case_study_tim/transformation', 'version_check': 'True', 'debug': 'False', 'log_path': '/workspaces/vg_case_study_tim/transformation/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --select stg_staging_intermediate_fx_rates_filled', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:25:41.246412 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '65e203fe-17cc-4604-87f7-c0a5db50b3fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffbe4c23850>]}
[0m10:25:41.260968 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '65e203fe-17cc-4604-87f7-c0a5db50b3fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffbe4bf9950>]}
[0m10:25:41.262691 [info ] [MainThread]: Registered adapter: duckdb=1.6.2
[0m10:25:41.328949 [debug] [MainThread]: checksum: 7b9fab86a08e9e96a48a825af743c566d95b877e068b8c6d0dbafbf714447189, vars: {}, profile: , target: , version: 1.6.18
[0m10:25:41.436931 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m10:25:41.437673 [debug] [MainThread]: Partial parsing: added file: vg_casestudy://models/intermediate/stg_staging_intermediate_fx_rates_filled.sql
[0m10:25:41.509539 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.vg_casestudy.marts
- models.vg_casestudy.main
- models.vg_casestudy.reporting
[0m10:25:41.559581 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '65e203fe-17cc-4604-87f7-c0a5db50b3fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffbe4902290>]}
[0m10:25:41.588135 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '65e203fe-17cc-4604-87f7-c0a5db50b3fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffbe038d750>]}
[0m10:25:41.588685 [info ] [MainThread]: Found 12 models, 1 analysis, 3 seeds, 74 tests, 5 sources, 0 exposures, 0 metrics, 632 macros, 0 groups, 0 semantic models
[0m10:25:41.589079 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '65e203fe-17cc-4604-87f7-c0a5db50b3fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffbe0f17c50>]}
[0m10:25:41.591525 [info ] [MainThread]: 
[0m10:25:41.592728 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m10:25:41.595502 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_casestudy'
[0m10:25:41.605135 [debug] [ThreadPool]: Using duckdb connection "list_casestudy"
[0m10:25:41.605614 [debug] [ThreadPool]: On list_casestudy: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"casestudy"'
    
  
  
[0m10:25:41.605917 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:25:41.748433 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:25:41.750143 [debug] [ThreadPool]: On list_casestudy: Close
[0m10:25:41.757797 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy, now create_casestudy_intermediate)
[0m10:25:41.758668 [debug] [ThreadPool]: Creating schema "database: "casestudy"
schema: "intermediate"
"
[0m10:25:41.763306 [debug] [ThreadPool]: Using duckdb connection "create_casestudy_intermediate"
[0m10:25:41.763693 [debug] [ThreadPool]: On create_casestudy_intermediate: BEGIN
[0m10:25:41.764025 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:25:41.774807 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:25:41.775329 [debug] [ThreadPool]: Using duckdb connection "create_casestudy_intermediate"
[0m10:25:41.775647 [debug] [ThreadPool]: On create_casestudy_intermediate: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "create_casestudy_intermediate"} */
create schema if not exists "casestudy"."intermediate"
[0m10:25:41.776314 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:25:41.777317 [debug] [ThreadPool]: On create_casestudy_intermediate: COMMIT
[0m10:25:41.777609 [debug] [ThreadPool]: Using duckdb connection "create_casestudy_intermediate"
[0m10:25:41.777897 [debug] [ThreadPool]: On create_casestudy_intermediate: COMMIT
[0m10:25:41.778653 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:25:41.778979 [debug] [ThreadPool]: On create_casestudy_intermediate: Close
[0m10:25:41.783376 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_casestudy_raw'
[0m10:25:41.788771 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_raw"
[0m10:25:41.789392 [debug] [ThreadPool]: On list_casestudy_raw: BEGIN
[0m10:25:41.789691 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:25:41.803555 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:25:41.803963 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_raw"
[0m10:25:41.804255 [debug] [ThreadPool]: On list_casestudy_raw: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_raw"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'raw'
    and table_catalog = 'casestudy'
  
[0m10:25:41.818733 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:25:41.820166 [debug] [ThreadPool]: On list_casestudy_raw: ROLLBACK
[0m10:25:41.821708 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_raw'
[0m10:25:41.822023 [debug] [ThreadPool]: On list_casestudy_raw: Close
[0m10:25:41.825297 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy_raw, now list_casestudy_intermediate)
[0m10:25:41.827615 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_intermediate"
[0m10:25:41.828030 [debug] [ThreadPool]: On list_casestudy_intermediate: BEGIN
[0m10:25:41.828355 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:25:41.839647 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:25:41.840028 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_intermediate"
[0m10:25:41.840320 [debug] [ThreadPool]: On list_casestudy_intermediate: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_intermediate"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'intermediate'
    and table_catalog = 'casestudy'
  
[0m10:25:41.849108 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:25:41.850481 [debug] [ThreadPool]: On list_casestudy_intermediate: ROLLBACK
[0m10:25:41.850954 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_intermediate'
[0m10:25:41.851213 [debug] [ThreadPool]: On list_casestudy_intermediate: Close
[0m10:25:41.854005 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy_intermediate, now list_casestudy_staging)
[0m10:25:41.857037 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_staging"
[0m10:25:41.857394 [debug] [ThreadPool]: On list_casestudy_staging: BEGIN
[0m10:25:41.858687 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:25:41.870502 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:25:41.870906 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_staging"
[0m10:25:41.871201 [debug] [ThreadPool]: On list_casestudy_staging: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_staging"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'staging'
    and table_catalog = 'casestudy'
  
[0m10:25:41.879809 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:25:41.881245 [debug] [ThreadPool]: On list_casestudy_staging: ROLLBACK
[0m10:25:41.881852 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_staging'
[0m10:25:41.882157 [debug] [ThreadPool]: On list_casestudy_staging: Close
[0m10:25:41.886085 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '65e203fe-17cc-4604-87f7-c0a5db50b3fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffbe0f554d0>]}
[0m10:25:41.886568 [debug] [MainThread]: Using duckdb connection "master"
[0m10:25:41.886865 [debug] [MainThread]: On master: BEGIN
[0m10:25:41.887146 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:25:41.900835 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m10:25:41.901267 [debug] [MainThread]: On master: COMMIT
[0m10:25:41.901645 [debug] [MainThread]: Using duckdb connection "master"
[0m10:25:41.901931 [debug] [MainThread]: On master: COMMIT
[0m10:25:41.902447 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m10:25:41.902721 [debug] [MainThread]: On master: Close
[0m10:25:41.905070 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:25:41.905479 [info ] [MainThread]: 
[0m10:25:41.911618 [debug] [Thread-1 (]: Began running node model.vg_casestudy.stg_staging_intermediate_fx_rates_filled
[0m10:25:41.912218 [info ] [Thread-1 (]: 1 of 1 START sql table model intermediate.stg_staging_intermediate_fx_rates_filled  [RUN]
[0m10:25:41.913123 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.vg_casestudy.stg_staging_intermediate_fx_rates_filled'
[0m10:25:41.913560 [debug] [Thread-1 (]: Began compiling node model.vg_casestudy.stg_staging_intermediate_fx_rates_filled
[0m10:25:41.938238 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate_fx_rates_filled"
[0m10:25:41.938731 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate_fx_rates_filled: BEGIN
[0m10:25:41.939068 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:25:41.954108 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m10:25:41.954542 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate_fx_rates_filled"
[0m10:25:41.954877 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate_fx_rates_filled: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_staging_intermediate_fx_rates_filled"} */


        select 
        (((select max(transaction_date) from {{ ref('stg_staging_intermediate__transactions') }}))::date - ((select min(transaction_date) from {{ ref('stg_staging_intermediate__transactions') }}))::date)
    
[0m10:25:41.969295 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.stg_staging_intermediate_fx_rates_filled (compile): 10:25:41.913915 => 10:25:41.969020
[0m10:25:41.969748 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate_fx_rates_filled: ROLLBACK
[0m10:25:41.979438 [debug] [Thread-1 (]: Failed to rollback 'model.vg_casestudy.stg_staging_intermediate_fx_rates_filled'
[0m10:25:41.979928 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate_fx_rates_filled: Close
[0m10:25:41.983948 [debug] [Thread-1 (]: Runtime Error in model stg_staging_intermediate_fx_rates_filled (models/intermediate/stg_staging_intermediate_fx_rates_filled.sql)
  Parser Error: syntax error at or near "{"
[0m10:25:41.984450 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '65e203fe-17cc-4604-87f7-c0a5db50b3fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffbe059e010>]}
[0m10:25:41.985022 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model intermediate.stg_staging_intermediate_fx_rates_filled  [[31mERROR[0m in 0.07s]
[0m10:25:41.985547 [debug] [Thread-1 (]: Finished running node model.vg_casestudy.stg_staging_intermediate_fx_rates_filled
[0m10:25:41.987788 [debug] [MainThread]: Using duckdb connection "master"
[0m10:25:41.988159 [debug] [MainThread]: On master: BEGIN
[0m10:25:41.988435 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:25:42.005409 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m10:25:42.005857 [debug] [MainThread]: On master: COMMIT
[0m10:25:42.006168 [debug] [MainThread]: Using duckdb connection "master"
[0m10:25:42.006435 [debug] [MainThread]: On master: COMMIT
[0m10:25:42.007049 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m10:25:42.007438 [debug] [MainThread]: On master: Close
[0m10:25:42.010610 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:25:42.011326 [debug] [MainThread]: Connection 'create_casestudy_intermediate' was properly closed.
[0m10:25:42.011682 [debug] [MainThread]: Connection 'list_casestudy_staging' was properly closed.
[0m10:25:42.011932 [debug] [MainThread]: Connection 'model.vg_casestudy.stg_staging_intermediate_fx_rates_filled' was properly closed.
[0m10:25:42.012280 [info ] [MainThread]: 
[0m10:25:42.012625 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.42 seconds (0.42s).
[0m10:25:42.013155 [debug] [MainThread]: Command end result
[0m10:25:42.032765 [info ] [MainThread]: 
[0m10:25:42.033291 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m10:25:42.033684 [info ] [MainThread]: 
[0m10:25:42.034094 [error] [MainThread]:   Runtime Error in model stg_staging_intermediate_fx_rates_filled (models/intermediate/stg_staging_intermediate_fx_rates_filled.sql)
  Parser Error: syntax error at or near "{"
[0m10:25:42.034435 [info ] [MainThread]: 
[0m10:25:42.034805 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m10:25:42.035322 [debug] [MainThread]: Command `dbt run` failed at 10:25:42.035226 after 1.01 seconds
[0m10:25:42.035672 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffbe47c82d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffbe47c8550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffbe4603b10>]}
[0m10:25:42.036028 [debug] [MainThread]: Flushing usage events
[0m10:28:02.821722 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe819411050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe819251510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe81923b590>]}


============================== 10:28:02.826923 | 7d14a674-7821-4c6f-bfeb-7323d5e90c20 ==============================
[0m10:28:02.826923 [info ] [MainThread]: Running with dbt=1.6.18
[0m10:28:02.827512 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/workspaces/vg_case_study_tim/transformation/logs', 'profiles_dir': '/workspaces/vg_case_study_tim/transformation', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --select stg_staging_intermediate_fx_rates_filled', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m10:28:03.023836 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7d14a674-7821-4c6f-bfeb-7323d5e90c20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8158be910>]}
[0m10:28:03.038930 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7d14a674-7821-4c6f-bfeb-7323d5e90c20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe81956fad0>]}
[0m10:28:03.040376 [info ] [MainThread]: Registered adapter: duckdb=1.6.2
[0m10:28:03.068885 [debug] [MainThread]: checksum: 7b9fab86a08e9e96a48a825af743c566d95b877e068b8c6d0dbafbf714447189, vars: {}, profile: , target: , version: 1.6.18
[0m10:28:03.171075 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:28:03.171880 [debug] [MainThread]: Partial parsing: updated file: vg_casestudy://models/intermediate/stg_staging_intermediate_fx_rates_filled.sql
[0m10:28:03.246474 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.vg_casestudy.reporting
- models.vg_casestudy.main
- models.vg_casestudy.marts
[0m10:28:03.297241 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7d14a674-7821-4c6f-bfeb-7323d5e90c20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8195a0c50>]}
[0m10:28:03.325881 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7d14a674-7821-4c6f-bfeb-7323d5e90c20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe814f211d0>]}
[0m10:28:03.326436 [info ] [MainThread]: Found 12 models, 1 analysis, 3 seeds, 74 tests, 5 sources, 0 exposures, 0 metrics, 632 macros, 0 groups, 0 semantic models
[0m10:28:03.326827 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7d14a674-7821-4c6f-bfeb-7323d5e90c20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe819113fd0>]}
[0m10:28:03.329063 [info ] [MainThread]: 
[0m10:28:03.329861 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m10:28:03.331016 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_casestudy'
[0m10:28:03.338968 [debug] [ThreadPool]: Using duckdb connection "list_casestudy"
[0m10:28:03.339462 [debug] [ThreadPool]: On list_casestudy: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"casestudy"'
    
  
  
[0m10:28:03.339819 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:28:03.486209 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:28:03.487979 [debug] [ThreadPool]: On list_casestudy: Close
[0m10:28:03.491565 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy, now create_casestudy_intermediate)
[0m10:28:03.492362 [debug] [ThreadPool]: Creating schema "database: "casestudy"
schema: "intermediate"
"
[0m10:28:03.496683 [debug] [ThreadPool]: Using duckdb connection "create_casestudy_intermediate"
[0m10:28:03.497080 [debug] [ThreadPool]: On create_casestudy_intermediate: BEGIN
[0m10:28:03.497355 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:28:03.509352 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:28:03.509811 [debug] [ThreadPool]: Using duckdb connection "create_casestudy_intermediate"
[0m10:28:03.510121 [debug] [ThreadPool]: On create_casestudy_intermediate: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "create_casestudy_intermediate"} */
create schema if not exists "casestudy"."intermediate"
[0m10:28:03.510839 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:28:03.511777 [debug] [ThreadPool]: On create_casestudy_intermediate: COMMIT
[0m10:28:03.512094 [debug] [ThreadPool]: Using duckdb connection "create_casestudy_intermediate"
[0m10:28:03.512377 [debug] [ThreadPool]: On create_casestudy_intermediate: COMMIT
[0m10:28:03.513013 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:28:03.513369 [debug] [ThreadPool]: On create_casestudy_intermediate: Close
[0m10:28:03.519714 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_casestudy_intermediate, now list_casestudy_intermediate)
[0m10:28:03.525546 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_intermediate"
[0m10:28:03.525967 [debug] [ThreadPool]: On list_casestudy_intermediate: BEGIN
[0m10:28:03.526288 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:28:03.539682 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:28:03.540211 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_intermediate"
[0m10:28:03.540528 [debug] [ThreadPool]: On list_casestudy_intermediate: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_intermediate"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'intermediate'
    and table_catalog = 'casestudy'
  
[0m10:28:03.560058 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:28:03.561587 [debug] [ThreadPool]: On list_casestudy_intermediate: ROLLBACK
[0m10:28:03.562995 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_intermediate'
[0m10:28:03.563389 [debug] [ThreadPool]: On list_casestudy_intermediate: Close
[0m10:28:03.566644 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy_intermediate, now list_casestudy_staging)
[0m10:28:03.569918 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_staging"
[0m10:28:03.570278 [debug] [ThreadPool]: On list_casestudy_staging: BEGIN
[0m10:28:03.570541 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:28:03.582029 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:28:03.582454 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_staging"
[0m10:28:03.582751 [debug] [ThreadPool]: On list_casestudy_staging: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_staging"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'staging'
    and table_catalog = 'casestudy'
  
[0m10:28:03.591553 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:28:03.592995 [debug] [ThreadPool]: On list_casestudy_staging: ROLLBACK
[0m10:28:03.593576 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_staging'
[0m10:28:03.593861 [debug] [ThreadPool]: On list_casestudy_staging: Close
[0m10:28:03.597371 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy_staging, now list_casestudy_raw)
[0m10:28:03.602365 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_raw"
[0m10:28:03.602766 [debug] [ThreadPool]: On list_casestudy_raw: BEGIN
[0m10:28:03.603078 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:28:03.614164 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:28:03.614571 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_raw"
[0m10:28:03.614901 [debug] [ThreadPool]: On list_casestudy_raw: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_raw"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'raw'
    and table_catalog = 'casestudy'
  
[0m10:28:03.622765 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:28:03.624286 [debug] [ThreadPool]: On list_casestudy_raw: ROLLBACK
[0m10:28:03.624903 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_raw'
[0m10:28:03.625199 [debug] [ThreadPool]: On list_casestudy_raw: Close
[0m10:28:03.629391 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7d14a674-7821-4c6f-bfeb-7323d5e90c20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8158c9f90>]}
[0m10:28:03.629948 [debug] [MainThread]: Using duckdb connection "master"
[0m10:28:03.630220 [debug] [MainThread]: On master: BEGIN
[0m10:28:03.630495 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:28:03.644227 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m10:28:03.644647 [debug] [MainThread]: On master: COMMIT
[0m10:28:03.644950 [debug] [MainThread]: Using duckdb connection "master"
[0m10:28:03.645208 [debug] [MainThread]: On master: COMMIT
[0m10:28:03.645690 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m10:28:03.645976 [debug] [MainThread]: On master: Close
[0m10:28:03.648627 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:28:03.649105 [info ] [MainThread]: 
[0m10:28:03.655185 [debug] [Thread-1 (]: Began running node model.vg_casestudy.stg_staging_intermediate_fx_rates_filled
[0m10:28:03.655716 [info ] [Thread-1 (]: 1 of 1 START sql table model intermediate.stg_staging_intermediate_fx_rates_filled  [RUN]
[0m10:28:03.656815 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.vg_casestudy.stg_staging_intermediate_fx_rates_filled'
[0m10:28:03.657573 [debug] [Thread-1 (]: Began compiling node model.vg_casestudy.stg_staging_intermediate_fx_rates_filled
[0m10:28:03.683530 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate_fx_rates_filled"
[0m10:28:03.684022 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate_fx_rates_filled: BEGIN
[0m10:28:03.684378 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:28:03.699516 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m10:28:03.699981 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate_fx_rates_filled"
[0m10:28:03.700334 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate_fx_rates_filled: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_staging_intermediate_fx_rates_filled"} */


        select 
        (('2025-03-10')::date - ('2025-01-01')::date)
    
[0m10:28:03.702836 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m10:28:03.706621 [debug] [Thread-1 (]: Writing injected SQL for node "model.vg_casestudy.stg_staging_intermediate_fx_rates_filled"
[0m10:28:03.707470 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.stg_staging_intermediate_fx_rates_filled (compile): 10:28:03.657951 => 10:28:03.707233
[0m10:28:03.707884 [debug] [Thread-1 (]: Began executing node model.vg_casestudy.stg_staging_intermediate_fx_rates_filled
[0m10:28:03.739976 [debug] [Thread-1 (]: Writing runtime sql for node "model.vg_casestudy.stg_staging_intermediate_fx_rates_filled"
[0m10:28:03.740658 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate_fx_rates_filled"
[0m10:28:03.741110 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate_fx_rates_filled: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_staging_intermediate_fx_rates_filled"} */

  
    
    

    create  table
      "casestudy"."intermediate"."stg_staging_intermediate_fx_rates_filled__dbt_tmp"
  
    as (
      with calendar as (

    





with rawdata as (

    

    

    with p as (
        select 0 as generated_number union all select 1
    ), unioned as (

    select

    
    p0.generated_number * power(2, 0)
     + 
    
    p1.generated_number * power(2, 1)
     + 
    
    p2.generated_number * power(2, 2)
     + 
    
    p3.generated_number * power(2, 3)
     + 
    
    p4.generated_number * power(2, 4)
     + 
    
    p5.generated_number * power(2, 5)
     + 
    
    p6.generated_number * power(2, 6)
    
    
    + 1
    as generated_number

    from

    
    p as p0
     cross join 
    
    p as p1
     cross join 
    
    p as p2
     cross join 
    
    p as p3
     cross join 
    
    p as p4
     cross join 
    
    p as p5
     cross join 
    
    p as p6
    
    

    )

    select *
    from unioned
    where generated_number <= 68
    order by generated_number



),

all_periods as (

    select (
        

    '2025-01-01' + ((interval '1 day') * (row_number() over (order by 1) - 1))


    ) as date_day
    from rawdata

),

filtered as (

    select *
    from all_periods
    where date_day <= '2025-03-10'

)

select * from filtered



),

currencies as (
    select distinct trim(currency_iso_code) as currency_iso_code
    from "casestudy"."raw"."fx_rates_full_history"
),

date_matrix as (
    select 
        currencies.currency_iso_code,
        calendar.date_day as fx_rate_date
    from currencies
    cross join calendar 

),

joined as (
    select 
        date_matrix.currency_iso_code,
        date_matrix.fx_rate_date,
        fx_rates_full_history.fx_rate
    from date_matrix
    left join "casestudy"."raw"."fx_rates_full_history" as fx_rates_full_history
    on date_matrix.currency_iso_code = fx_rates_full_history.currency_iso_code
    and date_matrix.fx_rate_date = fx_rates_full_history.fx_rate_date
),

forward_fill_dates as (
    select 
        currency_iso_code,
        fx_rate_date,

        last_value(fx_rate ignore nulls) over(
            partition by currency_iso_code
            order by fx_rate_date asc
            rows between unbounded preceding and current row
        ) as fx_rate
    from joined
)

select *
from forward_fill_dates
    );
  
  
[0m10:28:03.764289 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.stg_staging_intermediate_fx_rates_filled (execute): 10:28:03.708128 => 10:28:03.764002
[0m10:28:03.764732 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate_fx_rates_filled: ROLLBACK
[0m10:28:03.774089 [debug] [Thread-1 (]: Failed to rollback 'model.vg_casestudy.stg_staging_intermediate_fx_rates_filled'
[0m10:28:03.774613 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate_fx_rates_filled: Close
[0m10:28:03.778894 [debug] [Thread-1 (]: Runtime Error in model stg_staging_intermediate_fx_rates_filled (models/intermediate/stg_staging_intermediate_fx_rates_filled.sql)
  Binder Error: Could not choose a best candidate function for the function call "+(STRING_LITERAL, INTERVAL)". In order to select one, please add explicit type casts.
  	Candidate functions:
  	+(DATE, INTERVAL) -> TIMESTAMP
  	+(TIME, INTERVAL) -> TIME
  	+(TIMESTAMP, INTERVAL) -> TIMESTAMP
  	+(TIME WITH TIME ZONE, INTERVAL) -> TIME WITH TIME ZONE
  	+(TIMESTAMP WITH TIME ZONE, INTERVAL) -> TIMESTAMP WITH TIME ZONE
  	+(INTERVAL, INTERVAL) -> INTERVAL
  
  
  LINE 97:     '2025-01-01' + ((interval '1 day') * (row_number() over (order by 1)...
                            ^
[0m10:28:03.779464 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7d14a674-7821-4c6f-bfeb-7323d5e90c20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8158f1790>]}
[0m10:28:03.780069 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model intermediate.stg_staging_intermediate_fx_rates_filled  [[31mERROR[0m in 0.12s]
[0m10:28:03.780682 [debug] [Thread-1 (]: Finished running node model.vg_casestudy.stg_staging_intermediate_fx_rates_filled
[0m10:28:03.783403 [debug] [MainThread]: Using duckdb connection "master"
[0m10:28:03.783771 [debug] [MainThread]: On master: BEGIN
[0m10:28:03.784039 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:28:03.798561 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m10:28:03.799095 [debug] [MainThread]: On master: COMMIT
[0m10:28:03.799508 [debug] [MainThread]: Using duckdb connection "master"
[0m10:28:03.799853 [debug] [MainThread]: On master: COMMIT
[0m10:28:03.800793 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m10:28:03.801213 [debug] [MainThread]: On master: Close
[0m10:28:03.803793 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:28:03.804140 [debug] [MainThread]: Connection 'list_casestudy_raw' was properly closed.
[0m10:28:03.804415 [debug] [MainThread]: Connection 'model.vg_casestudy.stg_staging_intermediate_fx_rates_filled' was properly closed.
[0m10:28:03.804740 [info ] [MainThread]: 
[0m10:28:03.805135 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.48 seconds (0.48s).
[0m10:28:03.805739 [debug] [MainThread]: Command end result
[0m10:28:03.824584 [info ] [MainThread]: 
[0m10:28:03.825365 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m10:28:03.825771 [info ] [MainThread]: 
[0m10:28:03.826197 [error] [MainThread]:   Runtime Error in model stg_staging_intermediate_fx_rates_filled (models/intermediate/stg_staging_intermediate_fx_rates_filled.sql)
  Binder Error: Could not choose a best candidate function for the function call "+(STRING_LITERAL, INTERVAL)". In order to select one, please add explicit type casts.
  	Candidate functions:
  	+(DATE, INTERVAL) -> TIMESTAMP
  	+(TIME, INTERVAL) -> TIME
  	+(TIMESTAMP, INTERVAL) -> TIMESTAMP
  	+(TIME WITH TIME ZONE, INTERVAL) -> TIME WITH TIME ZONE
  	+(TIMESTAMP WITH TIME ZONE, INTERVAL) -> TIMESTAMP WITH TIME ZONE
  	+(INTERVAL, INTERVAL) -> INTERVAL
  
  
  LINE 97:     '2025-01-01' + ((interval '1 day') * (row_number() over (order by 1)...
                            ^
[0m10:28:03.826622 [info ] [MainThread]: 
[0m10:28:03.826999 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m10:28:03.827529 [debug] [MainThread]: Command `dbt run` failed at 10:28:03.827428 after 1.02 seconds
[0m10:28:03.827918 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe819411990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8192d6a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8192d7850>]}
[0m10:28:03.828286 [debug] [MainThread]: Flushing usage events
[0m10:29:02.896140 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f6f404c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f6efa0e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f70842f90>]}


============================== 10:29:02.901723 | 41bb05b7-3b41-4460-9f2f-2e700836dda2 ==============================
[0m10:29:02.901723 [info ] [MainThread]: Running with dbt=1.6.18
[0m10:29:02.902372 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/workspaces/vg_case_study_tim/transformation', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/workspaces/vg_case_study_tim/transformation/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select stg_staging_intermediate_fx_rates_filled', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:29:03.105107 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '41bb05b7-3b41-4460-9f2f-2e700836dda2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f6f0aba90>]}
[0m10:29:03.120383 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '41bb05b7-3b41-4460-9f2f-2e700836dda2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f6ec26310>]}
[0m10:29:03.122075 [info ] [MainThread]: Registered adapter: duckdb=1.6.2
[0m10:29:03.149792 [debug] [MainThread]: checksum: 7b9fab86a08e9e96a48a825af743c566d95b877e068b8c6d0dbafbf714447189, vars: {}, profile: , target: , version: 1.6.18
[0m10:29:03.250426 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:29:03.251257 [debug] [MainThread]: Partial parsing: updated file: vg_casestudy://models/intermediate/stg_staging_intermediate_fx_rates_filled.sql
[0m10:29:03.326237 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.vg_casestudy.marts
- models.vg_casestudy.reporting
- models.vg_casestudy.main
[0m10:29:03.376750 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '41bb05b7-3b41-4460-9f2f-2e700836dda2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f6ac993d0>]}
[0m10:29:03.405681 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '41bb05b7-3b41-4460-9f2f-2e700836dda2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f6aca40d0>]}
[0m10:29:03.406306 [info ] [MainThread]: Found 12 models, 1 analysis, 3 seeds, 74 tests, 5 sources, 0 exposures, 0 metrics, 632 macros, 0 groups, 0 semantic models
[0m10:29:03.406727 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '41bb05b7-3b41-4460-9f2f-2e700836dda2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f6f3f7610>]}
[0m10:29:03.409024 [info ] [MainThread]: 
[0m10:29:03.409839 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m10:29:03.411912 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_casestudy'
[0m10:29:03.420061 [debug] [ThreadPool]: Using duckdb connection "list_casestudy"
[0m10:29:03.420775 [debug] [ThreadPool]: On list_casestudy: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"casestudy"'
    
  
  
[0m10:29:03.421462 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:29:03.545048 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:29:03.546834 [debug] [ThreadPool]: On list_casestudy: Close
[0m10:29:03.552692 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy, now create_casestudy_intermediate)
[0m10:29:03.553607 [debug] [ThreadPool]: Creating schema "database: "casestudy"
schema: "intermediate"
"
[0m10:29:03.558380 [debug] [ThreadPool]: Using duckdb connection "create_casestudy_intermediate"
[0m10:29:03.558790 [debug] [ThreadPool]: On create_casestudy_intermediate: BEGIN
[0m10:29:03.559119 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:29:03.571796 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:29:03.572249 [debug] [ThreadPool]: Using duckdb connection "create_casestudy_intermediate"
[0m10:29:03.572570 [debug] [ThreadPool]: On create_casestudy_intermediate: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "create_casestudy_intermediate"} */
create schema if not exists "casestudy"."intermediate"
[0m10:29:03.573280 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:29:03.574296 [debug] [ThreadPool]: On create_casestudy_intermediate: COMMIT
[0m10:29:03.574620 [debug] [ThreadPool]: Using duckdb connection "create_casestudy_intermediate"
[0m10:29:03.574902 [debug] [ThreadPool]: On create_casestudy_intermediate: COMMIT
[0m10:29:03.575547 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:29:03.575920 [debug] [ThreadPool]: On create_casestudy_intermediate: Close
[0m10:29:03.580234 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_casestudy_intermediate, now list_casestudy_staging)
[0m10:29:03.586392 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_staging"
[0m10:29:03.586860 [debug] [ThreadPool]: On list_casestudy_staging: BEGIN
[0m10:29:03.587150 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:29:03.602038 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:29:03.602764 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_staging"
[0m10:29:03.603157 [debug] [ThreadPool]: On list_casestudy_staging: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_staging"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'staging'
    and table_catalog = 'casestudy'
  
[0m10:29:03.618134 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:29:03.619741 [debug] [ThreadPool]: On list_casestudy_staging: ROLLBACK
[0m10:29:03.620923 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_staging'
[0m10:29:03.621309 [debug] [ThreadPool]: On list_casestudy_staging: Close
[0m10:29:03.624785 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy_staging, now list_casestudy_raw)
[0m10:29:03.628199 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_raw"
[0m10:29:03.628603 [debug] [ThreadPool]: On list_casestudy_raw: BEGIN
[0m10:29:03.628883 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:29:03.641566 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:29:03.641997 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_raw"
[0m10:29:03.642293 [debug] [ThreadPool]: On list_casestudy_raw: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_raw"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'raw'
    and table_catalog = 'casestudy'
  
[0m10:29:03.653433 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:29:03.654924 [debug] [ThreadPool]: On list_casestudy_raw: ROLLBACK
[0m10:29:03.655447 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_raw'
[0m10:29:03.655763 [debug] [ThreadPool]: On list_casestudy_raw: Close
[0m10:29:03.658961 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy_raw, now list_casestudy_intermediate)
[0m10:29:03.663612 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_intermediate"
[0m10:29:03.664216 [debug] [ThreadPool]: On list_casestudy_intermediate: BEGIN
[0m10:29:03.664559 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:29:03.676548 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:29:03.676987 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_intermediate"
[0m10:29:03.677476 [debug] [ThreadPool]: On list_casestudy_intermediate: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_intermediate"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'intermediate'
    and table_catalog = 'casestudy'
  
[0m10:29:03.688980 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:29:03.690520 [debug] [ThreadPool]: On list_casestudy_intermediate: ROLLBACK
[0m10:29:03.691060 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_intermediate'
[0m10:29:03.691353 [debug] [ThreadPool]: On list_casestudy_intermediate: Close
[0m10:29:03.695251 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '41bb05b7-3b41-4460-9f2f-2e700836dda2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f6f32cfd0>]}
[0m10:29:03.695812 [debug] [MainThread]: Using duckdb connection "master"
[0m10:29:03.696166 [debug] [MainThread]: On master: BEGIN
[0m10:29:03.696443 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:29:03.711617 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m10:29:03.712083 [debug] [MainThread]: On master: COMMIT
[0m10:29:03.712394 [debug] [MainThread]: Using duckdb connection "master"
[0m10:29:03.712662 [debug] [MainThread]: On master: COMMIT
[0m10:29:03.713256 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m10:29:03.713688 [debug] [MainThread]: On master: Close
[0m10:29:03.717224 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:29:03.717912 [info ] [MainThread]: 
[0m10:29:03.722975 [debug] [Thread-1 (]: Began running node model.vg_casestudy.stg_staging_intermediate_fx_rates_filled
[0m10:29:03.723577 [info ] [Thread-1 (]: 1 of 1 START sql table model intermediate.stg_staging_intermediate_fx_rates_filled  [RUN]
[0m10:29:03.724473 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.vg_casestudy.stg_staging_intermediate_fx_rates_filled'
[0m10:29:03.724865 [debug] [Thread-1 (]: Began compiling node model.vg_casestudy.stg_staging_intermediate_fx_rates_filled
[0m10:29:03.753308 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate_fx_rates_filled"
[0m10:29:03.753969 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate_fx_rates_filled: BEGIN
[0m10:29:03.754370 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:29:03.771862 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m10:29:03.772385 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate_fx_rates_filled"
[0m10:29:03.772801 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate_fx_rates_filled: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_staging_intermediate_fx_rates_filled"} */


        select 
        ((date('2025-03-10'))::date - (date('2025-01-01'))::date)
    
[0m10:29:03.774860 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m10:29:03.778194 [debug] [Thread-1 (]: Writing injected SQL for node "model.vg_casestudy.stg_staging_intermediate_fx_rates_filled"
[0m10:29:03.779059 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.stg_staging_intermediate_fx_rates_filled (compile): 10:29:03.725134 => 10:29:03.778803
[0m10:29:03.779551 [debug] [Thread-1 (]: Began executing node model.vg_casestudy.stg_staging_intermediate_fx_rates_filled
[0m10:29:03.821581 [debug] [Thread-1 (]: Writing runtime sql for node "model.vg_casestudy.stg_staging_intermediate_fx_rates_filled"
[0m10:29:03.822385 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate_fx_rates_filled"
[0m10:29:03.822835 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate_fx_rates_filled: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_staging_intermediate_fx_rates_filled"} */

  
    
    

    create  table
      "casestudy"."intermediate"."stg_staging_intermediate_fx_rates_filled__dbt_tmp"
  
    as (
      with calendar as (

    





with rawdata as (

    

    

    with p as (
        select 0 as generated_number union all select 1
    ), unioned as (

    select

    
    p0.generated_number * power(2, 0)
     + 
    
    p1.generated_number * power(2, 1)
     + 
    
    p2.generated_number * power(2, 2)
     + 
    
    p3.generated_number * power(2, 3)
     + 
    
    p4.generated_number * power(2, 4)
     + 
    
    p5.generated_number * power(2, 5)
     + 
    
    p6.generated_number * power(2, 6)
    
    
    + 1
    as generated_number

    from

    
    p as p0
     cross join 
    
    p as p1
     cross join 
    
    p as p2
     cross join 
    
    p as p3
     cross join 
    
    p as p4
     cross join 
    
    p as p5
     cross join 
    
    p as p6
    
    

    )

    select *
    from unioned
    where generated_number <= 68
    order by generated_number



),

all_periods as (

    select (
        

    date('2025-01-01') + ((interval '1 day') * (row_number() over (order by 1) - 1))


    ) as date_day
    from rawdata

),

filtered as (

    select *
    from all_periods
    where date_day <= date('2025-03-10')

)

select * from filtered



),

currencies as (
    select distinct trim(currency_iso_code) as currency_iso_code
    from "casestudy"."raw"."fx_rates_full_history"
),

date_matrix as (
    select 
        currencies.currency_iso_code,
        calendar.date_day as fx_rate_date
    from currencies
    cross join calendar 

),

joined as (
    select 
        date_matrix.currency_iso_code,
        date_matrix.fx_rate_date,
        fx_rates_full_history.fx_rate
    from date_matrix
    left join "casestudy"."raw"."fx_rates_full_history" as fx_rates_full_history
    on date_matrix.currency_iso_code = fx_rates_full_history.currency_iso_code
    and date_matrix.fx_rate_date = fx_rates_full_history.fx_rate_date
),

forward_fill_dates as (
    select 
        currency_iso_code,
        fx_rate_date,

        last_value(fx_rate ignore nulls) over(
            partition by currency_iso_code
            order by fx_rate_date asc
            rows between unbounded preceding and current row
        ) as fx_rate
    from joined
)

select *
from forward_fill_dates
    );
  
  
[0m10:29:03.845047 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m10:29:03.852544 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate_fx_rates_filled"
[0m10:29:03.853108 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate_fx_rates_filled: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_staging_intermediate_fx_rates_filled"} */
alter table "casestudy"."intermediate"."stg_staging_intermediate_fx_rates_filled__dbt_tmp" rename to "stg_staging_intermediate_fx_rates_filled"
[0m10:29:03.854057 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m10:29:03.871045 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate_fx_rates_filled: COMMIT
[0m10:29:03.871484 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate_fx_rates_filled"
[0m10:29:03.871861 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate_fx_rates_filled: COMMIT
[0m10:29:03.878874 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m10:29:03.885094 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate_fx_rates_filled"
[0m10:29:03.885550 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate_fx_rates_filled: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_staging_intermediate_fx_rates_filled"} */
drop table if exists "casestudy"."intermediate"."stg_staging_intermediate_fx_rates_filled__dbt_backup" cascade
[0m10:29:03.886478 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m10:29:03.887900 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.stg_staging_intermediate_fx_rates_filled (execute): 10:29:03.779823 => 10:29:03.887754
[0m10:29:03.888280 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate_fx_rates_filled: Close
[0m10:29:03.919286 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '41bb05b7-3b41-4460-9f2f-2e700836dda2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f6ad02450>]}
[0m10:29:03.920008 [info ] [Thread-1 (]: 1 of 1 OK created sql table model intermediate.stg_staging_intermediate_fx_rates_filled  [[32mOK[0m in 0.20s]
[0m10:29:03.920665 [debug] [Thread-1 (]: Finished running node model.vg_casestudy.stg_staging_intermediate_fx_rates_filled
[0m10:29:03.922450 [debug] [MainThread]: Using duckdb connection "master"
[0m10:29:03.922781 [debug] [MainThread]: On master: BEGIN
[0m10:29:03.923052 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:29:03.936556 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m10:29:03.937078 [debug] [MainThread]: On master: COMMIT
[0m10:29:03.937521 [debug] [MainThread]: Using duckdb connection "master"
[0m10:29:03.937950 [debug] [MainThread]: On master: COMMIT
[0m10:29:03.938835 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m10:29:03.939442 [debug] [MainThread]: On master: Close
[0m10:29:03.942350 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:29:03.942783 [debug] [MainThread]: Connection 'list_casestudy_intermediate' was properly closed.
[0m10:29:03.943067 [debug] [MainThread]: Connection 'model.vg_casestudy.stg_staging_intermediate_fx_rates_filled' was properly closed.
[0m10:29:03.943412 [info ] [MainThread]: 
[0m10:29:03.943773 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.53 seconds (0.53s).
[0m10:29:03.944350 [debug] [MainThread]: Command end result
[0m10:29:03.962312 [info ] [MainThread]: 
[0m10:29:03.962845 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:29:03.963176 [info ] [MainThread]: 
[0m10:29:03.963506 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m10:29:03.964074 [debug] [MainThread]: Command `dbt run` succeeded at 10:29:03.963939 after 1.08 seconds
[0m10:29:03.964588 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f738deb50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f73a66290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f73a674d0>]}
[0m10:29:03.964980 [debug] [MainThread]: Flushing usage events
[0m10:43:22.697841 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f372297d550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3722f65550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3722c34390>]}


============================== 10:43:22.703673 | 18e45fe8-e3f6-462a-b501-4dea0126bdf2 ==============================
[0m10:43:22.703673 [info ] [MainThread]: Running with dbt=1.6.18
[0m10:43:22.704265 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/workspaces/vg_case_study_tim/transformation', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/workspaces/vg_case_study_tim/transformation/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select stg_staging_intermediate_fx_rates_filled', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:43:22.898702 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '18e45fe8-e3f6-462a-b501-4dea0126bdf2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3722c438d0>]}
[0m10:43:22.913806 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '18e45fe8-e3f6-462a-b501-4dea0126bdf2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3722b2ed90>]}
[0m10:43:22.915430 [info ] [MainThread]: Registered adapter: duckdb=1.6.2
[0m10:43:22.945354 [debug] [MainThread]: checksum: 7b9fab86a08e9e96a48a825af743c566d95b877e068b8c6d0dbafbf714447189, vars: {}, profile: , target: , version: 1.6.18
[0m10:43:23.039189 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:43:23.040003 [debug] [MainThread]: Partial parsing: updated file: vg_casestudy://models/intermediate/stg_staging_intermediate_fx_rates_filled.sql
[0m10:43:23.116427 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.vg_casestudy.marts
- models.vg_casestudy.main
- models.vg_casestudy.reporting
[0m10:43:23.167513 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '18e45fe8-e3f6-462a-b501-4dea0126bdf2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f371e873d90>]}
[0m10:43:23.195684 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '18e45fe8-e3f6-462a-b501-4dea0126bdf2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f371e9f2190>]}
[0m10:43:23.196241 [info ] [MainThread]: Found 12 models, 1 analysis, 3 seeds, 74 tests, 5 sources, 0 exposures, 0 metrics, 632 macros, 0 groups, 0 semantic models
[0m10:43:23.196650 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '18e45fe8-e3f6-462a-b501-4dea0126bdf2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3722cd1f90>]}
[0m10:43:23.198929 [info ] [MainThread]: 
[0m10:43:23.199720 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m10:43:23.200850 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_casestudy'
[0m10:43:23.208680 [debug] [ThreadPool]: Using duckdb connection "list_casestudy"
[0m10:43:23.209168 [debug] [ThreadPool]: On list_casestudy: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"casestudy"'
    
  
  
[0m10:43:23.209466 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:43:23.346261 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:43:23.348168 [debug] [ThreadPool]: On list_casestudy: Close
[0m10:43:23.353062 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy, now create_casestudy_intermediate)
[0m10:43:23.353925 [debug] [ThreadPool]: Creating schema "database: "casestudy"
schema: "intermediate"
"
[0m10:43:23.359258 [debug] [ThreadPool]: Using duckdb connection "create_casestudy_intermediate"
[0m10:43:23.359690 [debug] [ThreadPool]: On create_casestudy_intermediate: BEGIN
[0m10:43:23.360021 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:43:23.374766 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:43:23.375247 [debug] [ThreadPool]: Using duckdb connection "create_casestudy_intermediate"
[0m10:43:23.375567 [debug] [ThreadPool]: On create_casestudy_intermediate: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "create_casestudy_intermediate"} */
create schema if not exists "casestudy"."intermediate"
[0m10:43:23.376375 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:43:23.377382 [debug] [ThreadPool]: On create_casestudy_intermediate: COMMIT
[0m10:43:23.377741 [debug] [ThreadPool]: Using duckdb connection "create_casestudy_intermediate"
[0m10:43:23.378066 [debug] [ThreadPool]: On create_casestudy_intermediate: COMMIT
[0m10:43:23.378926 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:43:23.379310 [debug] [ThreadPool]: On create_casestudy_intermediate: Close
[0m10:43:23.383792 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_casestudy_intermediate, now list_casestudy_staging)
[0m10:43:23.389840 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_staging"
[0m10:43:23.390323 [debug] [ThreadPool]: On list_casestudy_staging: BEGIN
[0m10:43:23.390697 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:43:23.404571 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:43:23.405169 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_staging"
[0m10:43:23.405624 [debug] [ThreadPool]: On list_casestudy_staging: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_staging"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'staging'
    and table_catalog = 'casestudy'
  
[0m10:43:23.420900 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:43:23.423029 [debug] [ThreadPool]: On list_casestudy_staging: ROLLBACK
[0m10:43:23.424395 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_staging'
[0m10:43:23.424770 [debug] [ThreadPool]: On list_casestudy_staging: Close
[0m10:43:23.428152 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy_staging, now list_casestudy_intermediate)
[0m10:43:23.431504 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_intermediate"
[0m10:43:23.431918 [debug] [ThreadPool]: On list_casestudy_intermediate: BEGIN
[0m10:43:23.432187 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:43:23.443505 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:43:23.443910 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_intermediate"
[0m10:43:23.444212 [debug] [ThreadPool]: On list_casestudy_intermediate: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_intermediate"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'intermediate'
    and table_catalog = 'casestudy'
  
[0m10:43:23.452499 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:43:23.453867 [debug] [ThreadPool]: On list_casestudy_intermediate: ROLLBACK
[0m10:43:23.454345 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_intermediate'
[0m10:43:23.454608 [debug] [ThreadPool]: On list_casestudy_intermediate: Close
[0m10:43:23.457544 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy_intermediate, now list_casestudy_raw)
[0m10:43:23.460633 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_raw"
[0m10:43:23.461020 [debug] [ThreadPool]: On list_casestudy_raw: BEGIN
[0m10:43:23.462350 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:43:23.473807 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:43:23.474253 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_raw"
[0m10:43:23.474572 [debug] [ThreadPool]: On list_casestudy_raw: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_raw"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'raw'
    and table_catalog = 'casestudy'
  
[0m10:43:23.483404 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:43:23.484982 [debug] [ThreadPool]: On list_casestudy_raw: ROLLBACK
[0m10:43:23.485507 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_raw'
[0m10:43:23.485833 [debug] [ThreadPool]: On list_casestudy_raw: Close
[0m10:43:23.490209 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '18e45fe8-e3f6-462a-b501-4dea0126bdf2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f371e809850>]}
[0m10:43:23.490817 [debug] [MainThread]: Using duckdb connection "master"
[0m10:43:23.491115 [debug] [MainThread]: On master: BEGIN
[0m10:43:23.491368 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:43:23.503197 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m10:43:23.503643 [debug] [MainThread]: On master: COMMIT
[0m10:43:23.503957 [debug] [MainThread]: Using duckdb connection "master"
[0m10:43:23.504229 [debug] [MainThread]: On master: COMMIT
[0m10:43:23.505072 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m10:43:23.505798 [debug] [MainThread]: On master: Close
[0m10:43:23.508444 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:43:23.508907 [info ] [MainThread]: 
[0m10:43:23.514820 [debug] [Thread-1 (]: Began running node model.vg_casestudy.stg_staging_intermediate_fx_rates_filled
[0m10:43:23.515379 [info ] [Thread-1 (]: 1 of 1 START sql table model intermediate.stg_staging_intermediate_fx_rates_filled  [RUN]
[0m10:43:23.516227 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.vg_casestudy.stg_staging_intermediate_fx_rates_filled'
[0m10:43:23.516674 [debug] [Thread-1 (]: Began compiling node model.vg_casestudy.stg_staging_intermediate_fx_rates_filled
[0m10:43:23.540655 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate_fx_rates_filled"
[0m10:43:23.541193 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate_fx_rates_filled: BEGIN
[0m10:43:23.541725 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:43:23.558958 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m10:43:23.559437 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate_fx_rates_filled"
[0m10:43:23.559781 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate_fx_rates_filled: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_staging_intermediate_fx_rates_filled"} */


        select 
        ((date('2025-03-10'))::date - (date('2024-12-31'))::date)
    
[0m10:43:23.561715 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m10:43:23.564787 [debug] [Thread-1 (]: Writing injected SQL for node "model.vg_casestudy.stg_staging_intermediate_fx_rates_filled"
[0m10:43:23.565474 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.stg_staging_intermediate_fx_rates_filled (compile): 10:43:23.516945 => 10:43:23.565267
[0m10:43:23.565861 [debug] [Thread-1 (]: Began executing node model.vg_casestudy.stg_staging_intermediate_fx_rates_filled
[0m10:43:23.598446 [debug] [Thread-1 (]: Writing runtime sql for node "model.vg_casestudy.stg_staging_intermediate_fx_rates_filled"
[0m10:43:23.599277 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate_fx_rates_filled"
[0m10:43:23.599750 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate_fx_rates_filled: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_staging_intermediate_fx_rates_filled"} */

  
    
    

    create  table
      "casestudy"."intermediate"."stg_staging_intermediate_fx_rates_filled__dbt_tmp"
  
    as (
      with calendar as (

    





with rawdata as (

    

    

    with p as (
        select 0 as generated_number union all select 1
    ), unioned as (

    select

    
    p0.generated_number * power(2, 0)
     + 
    
    p1.generated_number * power(2, 1)
     + 
    
    p2.generated_number * power(2, 2)
     + 
    
    p3.generated_number * power(2, 3)
     + 
    
    p4.generated_number * power(2, 4)
     + 
    
    p5.generated_number * power(2, 5)
     + 
    
    p6.generated_number * power(2, 6)
    
    
    + 1
    as generated_number

    from

    
    p as p0
     cross join 
    
    p as p1
     cross join 
    
    p as p2
     cross join 
    
    p as p3
     cross join 
    
    p as p4
     cross join 
    
    p as p5
     cross join 
    
    p as p6
    
    

    )

    select *
    from unioned
    where generated_number <= 69
    order by generated_number



),

all_periods as (

    select (
        

    date('2024-12-31') + ((interval '1 day') * (row_number() over (order by 1) - 1))


    ) as date_day
    from rawdata

),

filtered as (

    select *
    from all_periods
    where date_day <= date('2025-03-10')

)

select * from filtered



),

currencies as (
    select distinct trim(currency_iso_code) as currency_iso_code
    from "casestudy"."raw"."fx_rates_full_history"
),

date_matrix as (
    select 
        currencies.currency_iso_code,
        calendar.date_day as fx_rate_date
    from currencies
    cross join calendar 

),

joined as (
    select 
        date_matrix.currency_iso_code,
        date_matrix.fx_rate_date,
        fx_rates_full_history.fx_rate
    from date_matrix
    left join "casestudy"."raw"."fx_rates_full_history" as fx_rates_full_history
    on date_matrix.currency_iso_code = fx_rates_full_history.currency_iso_code
    and date_matrix.fx_rate_date = fx_rates_full_history.fx_rate_date
),

forward_fill_dates as (
    select 
        currency_iso_code,
        fx_rate_date,

        last_value(fx_rate ignore nulls) over(
            partition by currency_iso_code
            order by fx_rate_date asc
            rows between unbounded preceding and current row
        ) as fx_rate
    from joined
)

select *
from forward_fill_dates
    );
  
  
[0m10:43:23.621693 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m10:43:23.628180 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate_fx_rates_filled"
[0m10:43:23.628725 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate_fx_rates_filled: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_staging_intermediate_fx_rates_filled"} */
alter table "casestudy"."intermediate"."stg_staging_intermediate_fx_rates_filled" rename to "stg_staging_intermediate_fx_rates_filled__dbt_backup"
[0m10:43:23.629697 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m10:43:23.632579 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate_fx_rates_filled"
[0m10:43:23.632905 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate_fx_rates_filled: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_staging_intermediate_fx_rates_filled"} */
alter table "casestudy"."intermediate"."stg_staging_intermediate_fx_rates_filled__dbt_tmp" rename to "stg_staging_intermediate_fx_rates_filled"
[0m10:43:23.633763 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m10:43:23.652581 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate_fx_rates_filled: COMMIT
[0m10:43:23.653030 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate_fx_rates_filled"
[0m10:43:23.653352 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate_fx_rates_filled: COMMIT
[0m10:43:23.660867 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m10:43:23.666580 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate_fx_rates_filled"
[0m10:43:23.666995 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate_fx_rates_filled: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_staging_intermediate_fx_rates_filled"} */
drop table if exists "casestudy"."intermediate"."stg_staging_intermediate_fx_rates_filled__dbt_backup" cascade
[0m10:43:23.671116 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m10:43:23.672689 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.stg_staging_intermediate_fx_rates_filled (execute): 10:43:23.566084 => 10:43:23.672489
[0m10:43:23.673109 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate_fx_rates_filled: Close
[0m10:43:23.705055 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '18e45fe8-e3f6-462a-b501-4dea0126bdf2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f371e896690>]}
[0m10:43:23.705838 [info ] [Thread-1 (]: 1 of 1 OK created sql table model intermediate.stg_staging_intermediate_fx_rates_filled  [[32mOK[0m in 0.19s]
[0m10:43:23.706506 [debug] [Thread-1 (]: Finished running node model.vg_casestudy.stg_staging_intermediate_fx_rates_filled
[0m10:43:23.708462 [debug] [MainThread]: Using duckdb connection "master"
[0m10:43:23.708821 [debug] [MainThread]: On master: BEGIN
[0m10:43:23.709114 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:43:23.723662 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m10:43:23.724355 [debug] [MainThread]: On master: COMMIT
[0m10:43:23.724711 [debug] [MainThread]: Using duckdb connection "master"
[0m10:43:23.725008 [debug] [MainThread]: On master: COMMIT
[0m10:43:23.725942 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m10:43:23.726413 [debug] [MainThread]: On master: Close
[0m10:43:23.729084 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:43:23.729450 [debug] [MainThread]: Connection 'list_casestudy_raw' was properly closed.
[0m10:43:23.729719 [debug] [MainThread]: Connection 'model.vg_casestudy.stg_staging_intermediate_fx_rates_filled' was properly closed.
[0m10:43:23.730029 [info ] [MainThread]: 
[0m10:43:23.730361 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.53 seconds (0.53s).
[0m10:43:23.730945 [debug] [MainThread]: Command end result
[0m10:43:23.779382 [info ] [MainThread]: 
[0m10:43:23.779952 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:43:23.780407 [info ] [MainThread]: 
[0m10:43:23.780828 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m10:43:23.781372 [debug] [MainThread]: Command `dbt run` succeeded at 10:43:23.781241 after 1.09 seconds
[0m10:43:23.781753 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f372448ae10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37274c0e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3723dc4710>]}
[0m10:43:23.782103 [debug] [MainThread]: Flushing usage events
[0m10:48:47.406731 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa383932350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa383afa510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa383806650>]}


============================== 10:48:47.412716 | d4bae58c-975d-4165-a742-6e33ea7d4c9a ==============================
[0m10:48:47.412716 [info ] [MainThread]: Running with dbt=1.6.18
[0m10:48:47.413293 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/workspaces/vg_case_study_tim/transformation/logs', 'profiles_dir': '/workspaces/vg_case_study_tim/transformation', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --select stg_staging_intermediate_fx_rates_filled', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:48:47.619577 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd4bae58c-975d-4165-a742-6e33ea7d4c9a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3837ee950>]}
[0m10:48:47.634154 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd4bae58c-975d-4165-a742-6e33ea7d4c9a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3838f8a50>]}
[0m10:48:47.635783 [info ] [MainThread]: Registered adapter: duckdb=1.6.2
[0m10:48:47.666900 [debug] [MainThread]: checksum: 7b9fab86a08e9e96a48a825af743c566d95b877e068b8c6d0dbafbf714447189, vars: {}, profile: , target: , version: 1.6.18
[0m10:48:47.763937 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:48:47.764779 [debug] [MainThread]: Partial parsing: updated file: vg_casestudy://models/intermediate/stg_staging_intermediate_fx_rates_filled.sql
[0m10:48:47.883319 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.vg_casestudy.marts
- models.vg_casestudy.main
- models.vg_casestudy.reporting
[0m10:48:47.890042 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd4bae58c-975d-4165-a742-6e33ea7d4c9a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3834af410>]}
[0m10:48:47.923818 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd4bae58c-975d-4165-a742-6e33ea7d4c9a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa37f4ed3d0>]}
[0m10:48:47.924430 [info ] [MainThread]: Found 12 models, 1 analysis, 3 seeds, 74 tests, 5 sources, 0 exposures, 0 metrics, 632 macros, 0 groups, 0 semantic models
[0m10:48:47.924837 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd4bae58c-975d-4165-a742-6e33ea7d4c9a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3854186d0>]}
[0m10:48:47.927075 [info ] [MainThread]: 
[0m10:48:47.927842 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m10:48:47.929995 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_casestudy'
[0m10:48:47.938225 [debug] [ThreadPool]: Using duckdb connection "list_casestudy"
[0m10:48:47.939041 [debug] [ThreadPool]: On list_casestudy: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"casestudy"'
    
  
  
[0m10:48:47.939408 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:48:48.070827 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:48:48.072489 [debug] [ThreadPool]: On list_casestudy: Close
[0m10:48:48.075896 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy, now create_casestudy_intermediate)
[0m10:48:48.076689 [debug] [ThreadPool]: Creating schema "database: "casestudy"
schema: "intermediate"
"
[0m10:48:48.081402 [debug] [ThreadPool]: Using duckdb connection "create_casestudy_intermediate"
[0m10:48:48.081829 [debug] [ThreadPool]: On create_casestudy_intermediate: BEGIN
[0m10:48:48.082148 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:48:48.095392 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:48:48.095890 [debug] [ThreadPool]: Using duckdb connection "create_casestudy_intermediate"
[0m10:48:48.096247 [debug] [ThreadPool]: On create_casestudy_intermediate: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "create_casestudy_intermediate"} */
create schema if not exists "casestudy"."intermediate"
[0m10:48:48.096978 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:48:48.098002 [debug] [ThreadPool]: On create_casestudy_intermediate: COMMIT
[0m10:48:48.098347 [debug] [ThreadPool]: Using duckdb connection "create_casestudy_intermediate"
[0m10:48:48.098632 [debug] [ThreadPool]: On create_casestudy_intermediate: COMMIT
[0m10:48:48.099391 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:48:48.099848 [debug] [ThreadPool]: On create_casestudy_intermediate: Close
[0m10:48:48.105360 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_casestudy_intermediate, now list_casestudy_raw)
[0m10:48:48.111184 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_raw"
[0m10:48:48.111577 [debug] [ThreadPool]: On list_casestudy_raw: BEGIN
[0m10:48:48.111865 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:48:48.123615 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:48:48.124029 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_raw"
[0m10:48:48.124351 [debug] [ThreadPool]: On list_casestudy_raw: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_raw"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'raw'
    and table_catalog = 'casestudy'
  
[0m10:48:48.139539 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:48:48.140992 [debug] [ThreadPool]: On list_casestudy_raw: ROLLBACK
[0m10:48:48.142535 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_raw'
[0m10:48:48.142847 [debug] [ThreadPool]: On list_casestudy_raw: Close
[0m10:48:48.145908 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy_raw, now list_casestudy_staging)
[0m10:48:48.148808 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_staging"
[0m10:48:48.149234 [debug] [ThreadPool]: On list_casestudy_staging: BEGIN
[0m10:48:48.150977 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:48:48.161762 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:48:48.162157 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_staging"
[0m10:48:48.162475 [debug] [ThreadPool]: On list_casestudy_staging: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_staging"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'staging'
    and table_catalog = 'casestudy'
  
[0m10:48:48.171018 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:48:48.172426 [debug] [ThreadPool]: On list_casestudy_staging: ROLLBACK
[0m10:48:48.172901 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_staging'
[0m10:48:48.173213 [debug] [ThreadPool]: On list_casestudy_staging: Close
[0m10:48:48.176192 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy_staging, now list_casestudy_intermediate)
[0m10:48:48.178379 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_intermediate"
[0m10:48:48.178724 [debug] [ThreadPool]: On list_casestudy_intermediate: BEGIN
[0m10:48:48.179058 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:48:48.190093 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:48:48.190493 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_intermediate"
[0m10:48:48.190803 [debug] [ThreadPool]: On list_casestudy_intermediate: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_intermediate"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'intermediate'
    and table_catalog = 'casestudy'
  
[0m10:48:48.199156 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:48:48.200665 [debug] [ThreadPool]: On list_casestudy_intermediate: ROLLBACK
[0m10:48:48.201146 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_intermediate'
[0m10:48:48.201437 [debug] [ThreadPool]: On list_casestudy_intermediate: Close
[0m10:48:48.205281 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd4bae58c-975d-4165-a742-6e33ea7d4c9a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3834f49d0>]}
[0m10:48:48.205768 [debug] [MainThread]: Using duckdb connection "master"
[0m10:48:48.206043 [debug] [MainThread]: On master: BEGIN
[0m10:48:48.206292 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:48:48.219026 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m10:48:48.219497 [debug] [MainThread]: On master: COMMIT
[0m10:48:48.219771 [debug] [MainThread]: Using duckdb connection "master"
[0m10:48:48.220033 [debug] [MainThread]: On master: COMMIT
[0m10:48:48.220673 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m10:48:48.220990 [debug] [MainThread]: On master: Close
[0m10:48:48.223747 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:48:48.224206 [info ] [MainThread]: 
[0m10:48:48.229911 [debug] [Thread-1 (]: Began running node model.vg_casestudy.stg_staging_intermediate_fx_rates_filled
[0m10:48:48.230476 [info ] [Thread-1 (]: 1 of 1 START sql table model intermediate.stg_staging_intermediate_fx_rates_filled  [RUN]
[0m10:48:48.231936 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.vg_casestudy.stg_staging_intermediate_fx_rates_filled'
[0m10:48:48.232530 [debug] [Thread-1 (]: Began compiling node model.vg_casestudy.stg_staging_intermediate_fx_rates_filled
[0m10:48:48.256987 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate_fx_rates_filled"
[0m10:48:48.257463 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate_fx_rates_filled: BEGIN
[0m10:48:48.257810 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:48:48.273242 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m10:48:48.273716 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate_fx_rates_filled"
[0m10:48:48.274057 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate_fx_rates_filled: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_staging_intermediate_fx_rates_filled"} */


        select 
        ((date('2025-03-10'))::date - (date('2024-12-31'))::date)
    
[0m10:48:48.276130 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m10:48:48.279927 [debug] [Thread-1 (]: Writing injected SQL for node "model.vg_casestudy.stg_staging_intermediate_fx_rates_filled"
[0m10:48:48.280629 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.stg_staging_intermediate_fx_rates_filled (compile): 10:48:48.232908 => 10:48:48.280389
[0m10:48:48.280997 [debug] [Thread-1 (]: Began executing node model.vg_casestudy.stg_staging_intermediate_fx_rates_filled
[0m10:48:48.314879 [debug] [Thread-1 (]: Writing runtime sql for node "model.vg_casestudy.stg_staging_intermediate_fx_rates_filled"
[0m10:48:48.315712 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate_fx_rates_filled"
[0m10:48:48.316235 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate_fx_rates_filled: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_staging_intermediate_fx_rates_filled"} */

  
    
    

    create  table
      "casestudy"."intermediate"."stg_staging_intermediate_fx_rates_filled__dbt_tmp"
  
    as (
      with calendar as (

    





with rawdata as (

    

    

    with p as (
        select 0 as generated_number union all select 1
    ), unioned as (

    select

    
    p0.generated_number * power(2, 0)
     + 
    
    p1.generated_number * power(2, 1)
     + 
    
    p2.generated_number * power(2, 2)
     + 
    
    p3.generated_number * power(2, 3)
     + 
    
    p4.generated_number * power(2, 4)
     + 
    
    p5.generated_number * power(2, 5)
     + 
    
    p6.generated_number * power(2, 6)
    
    
    + 1
    as generated_number

    from

    
    p as p0
     cross join 
    
    p as p1
     cross join 
    
    p as p2
     cross join 
    
    p as p3
     cross join 
    
    p as p4
     cross join 
    
    p as p5
     cross join 
    
    p as p6
    
    

    )

    select *
    from unioned
    where generated_number <= 69
    order by generated_number



),

all_periods as (

    select (
        

    date('2024-12-31') + ((interval '1 day') * (row_number() over (order by 1) - 1))


    ) as date_day
    from rawdata

),

filtered as (

    select *
    from all_periods
    where date_day <= date('2025-03-10')

)

select * from filtered



),

currencies as (
    select distinct trim(currency_iso_code) as currency_iso_code
    from "casestudy"."raw"."fx_rates_full_history"
),

date_matrix as (
    select 
        currencies.currency_iso_code,
        calendar.date_day as fx_rate_date
    from currencies
    cross join calendar 

),

joined as (
    select 
        date_matrix.currency_iso_code,
        date_matrix.fx_rate_date,
        fx_rates_full_history.fx_rate
    from date_matrix
    left join "casestudy"."raw"."fx_rates_full_history" as fx_rates_full_history
    on date_matrix.currency_iso_code = fx_rates_full_history.currency_iso_code
    and date_matrix.fx_rate_date = fx_rates_full_history.fx_rate_date
),

forward_fill_dates as (
    select 
        currency_iso_code,
        fx_rate_date::date as fx_rate_date,

        last_value(fx_rate ignore nulls) over(
            partition by currency_iso_code
            order by fx_rate_date asc
            rows between unbounded preceding and current row
        ) as fx_rate
    from joined
)

select *
from forward_fill_dates
    );
  
  
[0m10:48:48.342682 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m10:48:48.348853 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate_fx_rates_filled"
[0m10:48:48.349311 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate_fx_rates_filled: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_staging_intermediate_fx_rates_filled"} */
alter table "casestudy"."intermediate"."stg_staging_intermediate_fx_rates_filled" rename to "stg_staging_intermediate_fx_rates_filled__dbt_backup"
[0m10:48:48.350299 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m10:48:48.353411 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate_fx_rates_filled"
[0m10:48:48.353849 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate_fx_rates_filled: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_staging_intermediate_fx_rates_filled"} */
alter table "casestudy"."intermediate"."stg_staging_intermediate_fx_rates_filled__dbt_tmp" rename to "stg_staging_intermediate_fx_rates_filled"
[0m10:48:48.355028 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m10:48:48.374799 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate_fx_rates_filled: COMMIT
[0m10:48:48.375298 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate_fx_rates_filled"
[0m10:48:48.375630 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate_fx_rates_filled: COMMIT
[0m10:48:48.381943 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m10:48:48.387346 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate_fx_rates_filled"
[0m10:48:48.387755 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate_fx_rates_filled: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_staging_intermediate_fx_rates_filled"} */
drop table if exists "casestudy"."intermediate"."stg_staging_intermediate_fx_rates_filled__dbt_backup" cascade
[0m10:48:48.393112 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m10:48:48.394649 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.stg_staging_intermediate_fx_rates_filled (execute): 10:48:48.281267 => 10:48:48.394485
[0m10:48:48.395011 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate_fx_rates_filled: Close
[0m10:48:48.424502 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd4bae58c-975d-4165-a742-6e33ea7d4c9a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa37f5ff050>]}
[0m10:48:48.425262 [info ] [Thread-1 (]: 1 of 1 OK created sql table model intermediate.stg_staging_intermediate_fx_rates_filled  [[32mOK[0m in 0.19s]
[0m10:48:48.425888 [debug] [Thread-1 (]: Finished running node model.vg_casestudy.stg_staging_intermediate_fx_rates_filled
[0m10:48:48.427693 [debug] [MainThread]: Using duckdb connection "master"
[0m10:48:48.428012 [debug] [MainThread]: On master: BEGIN
[0m10:48:48.428341 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:48:48.443161 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m10:48:48.443585 [debug] [MainThread]: On master: COMMIT
[0m10:48:48.443912 [debug] [MainThread]: Using duckdb connection "master"
[0m10:48:48.444191 [debug] [MainThread]: On master: COMMIT
[0m10:48:48.444694 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m10:48:48.445062 [debug] [MainThread]: On master: Close
[0m10:48:48.447818 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:48:48.448228 [debug] [MainThread]: Connection 'list_casestudy_intermediate' was properly closed.
[0m10:48:48.448506 [debug] [MainThread]: Connection 'model.vg_casestudy.stg_staging_intermediate_fx_rates_filled' was properly closed.
[0m10:48:48.448881 [info ] [MainThread]: 
[0m10:48:48.449277 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.52 seconds (0.52s).
[0m10:48:48.450042 [debug] [MainThread]: Command end result
[0m10:48:48.468309 [info ] [MainThread]: 
[0m10:48:48.468885 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:48:48.469253 [info ] [MainThread]: 
[0m10:48:48.469578 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m10:48:48.470167 [debug] [MainThread]: Command `dbt run` succeeded at 10:48:48.470012 after 1.07 seconds
[0m10:48:48.470665 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3836530d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa38364f3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3838fbe50>]}
[0m10:48:48.471335 [debug] [MainThread]: Flushing usage events
[0m10:56:25.368342 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4a02237d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4a03a9510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4a2dad610>]}


============================== 10:56:25.373943 | 8a38e847-6d8c-4952-9146-1b3c31bd8f1b ==============================
[0m10:56:25.373943 [info ] [MainThread]: Running with dbt=1.6.18
[0m10:56:25.374508 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/workspaces/vg_case_study_tim/transformation/logs', 'profiles_dir': '/workspaces/vg_case_study_tim/transformation', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --select stg_staging_intermediate_fx_rates_filled', 'send_anonymous_usage_stats': 'True'}
[0m10:56:25.577762 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8a38e847-6d8c-4952-9146-1b3c31bd8f1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4a04f38d0>]}
[0m10:56:25.592739 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8a38e847-6d8c-4952-9146-1b3c31bd8f1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4a07fe590>]}
[0m10:56:25.594142 [info ] [MainThread]: Registered adapter: duckdb=1.6.2
[0m10:56:25.622086 [debug] [MainThread]: checksum: 7b9fab86a08e9e96a48a825af743c566d95b877e068b8c6d0dbafbf714447189, vars: {}, profile: , target: , version: 1.6.18
[0m10:56:25.718292 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:56:25.719105 [debug] [MainThread]: Partial parsing: updated file: vg_casestudy://models/intermediate/stg_staging_intermediate_fx_rates_filled.sql
[0m10:56:25.833612 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.vg_casestudy.main
- models.vg_casestudy.marts
- models.vg_casestudy.reporting
[0m10:56:25.840445 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8a38e847-6d8c-4952-9146-1b3c31bd8f1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa49c13d850>]}
[0m10:56:25.872241 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8a38e847-6d8c-4952-9146-1b3c31bd8f1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa49cb4ea10>]}
[0m10:56:25.872886 [info ] [MainThread]: Found 12 models, 1 analysis, 3 seeds, 74 tests, 5 sources, 0 exposures, 0 metrics, 632 macros, 0 groups, 0 semantic models
[0m10:56:25.873296 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8a38e847-6d8c-4952-9146-1b3c31bd8f1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4a021fb90>]}
[0m10:56:25.875389 [info ] [MainThread]: 
[0m10:56:25.876136 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m10:56:25.878239 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_casestudy'
[0m10:56:25.886083 [debug] [ThreadPool]: Using duckdb connection "list_casestudy"
[0m10:56:25.886550 [debug] [ThreadPool]: On list_casestudy: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"casestudy"'
    
  
  
[0m10:56:25.886902 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:56:26.017244 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:56:26.019256 [debug] [ThreadPool]: On list_casestudy: Close
[0m10:56:26.024160 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy, now create_casestudy_intermediate)
[0m10:56:26.024956 [debug] [ThreadPool]: Creating schema "database: "casestudy"
schema: "intermediate"
"
[0m10:56:26.029545 [debug] [ThreadPool]: Using duckdb connection "create_casestudy_intermediate"
[0m10:56:26.029948 [debug] [ThreadPool]: On create_casestudy_intermediate: BEGIN
[0m10:56:26.030224 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:56:26.042787 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:56:26.043240 [debug] [ThreadPool]: Using duckdb connection "create_casestudy_intermediate"
[0m10:56:26.043553 [debug] [ThreadPool]: On create_casestudy_intermediate: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "create_casestudy_intermediate"} */
create schema if not exists "casestudy"."intermediate"
[0m10:56:26.044143 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:56:26.045076 [debug] [ThreadPool]: On create_casestudy_intermediate: COMMIT
[0m10:56:26.045387 [debug] [ThreadPool]: Using duckdb connection "create_casestudy_intermediate"
[0m10:56:26.045649 [debug] [ThreadPool]: On create_casestudy_intermediate: COMMIT
[0m10:56:26.046173 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:56:26.046491 [debug] [ThreadPool]: On create_casestudy_intermediate: Close
[0m10:56:26.052105 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_casestudy_intermediate, now list_casestudy_raw)
[0m10:56:26.057922 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_raw"
[0m10:56:26.058287 [debug] [ThreadPool]: On list_casestudy_raw: BEGIN
[0m10:56:26.058586 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:56:26.069649 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:56:26.070043 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_raw"
[0m10:56:26.070330 [debug] [ThreadPool]: On list_casestudy_raw: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_raw"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'raw'
    and table_catalog = 'casestudy'
  
[0m10:56:26.085818 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:56:26.087260 [debug] [ThreadPool]: On list_casestudy_raw: ROLLBACK
[0m10:56:26.088857 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_raw'
[0m10:56:26.089256 [debug] [ThreadPool]: On list_casestudy_raw: Close
[0m10:56:26.092321 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy_raw, now list_casestudy_intermediate)
[0m10:56:26.095125 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_intermediate"
[0m10:56:26.095470 [debug] [ThreadPool]: On list_casestudy_intermediate: BEGIN
[0m10:56:26.095800 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:56:26.106492 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:56:26.106887 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_intermediate"
[0m10:56:26.107244 [debug] [ThreadPool]: On list_casestudy_intermediate: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_intermediate"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'intermediate'
    and table_catalog = 'casestudy'
  
[0m10:56:26.115144 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:56:26.116652 [debug] [ThreadPool]: On list_casestudy_intermediate: ROLLBACK
[0m10:56:26.117173 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_intermediate'
[0m10:56:26.117444 [debug] [ThreadPool]: On list_casestudy_intermediate: Close
[0m10:56:26.120511 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy_intermediate, now list_casestudy_staging)
[0m10:56:26.122708 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_staging"
[0m10:56:26.123064 [debug] [ThreadPool]: On list_casestudy_staging: BEGIN
[0m10:56:26.123389 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:56:26.136034 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:56:26.136525 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_staging"
[0m10:56:26.136818 [debug] [ThreadPool]: On list_casestudy_staging: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_staging"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'staging'
    and table_catalog = 'casestudy'
  
[0m10:56:26.145317 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:56:26.146708 [debug] [ThreadPool]: On list_casestudy_staging: ROLLBACK
[0m10:56:26.147182 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_staging'
[0m10:56:26.147454 [debug] [ThreadPool]: On list_casestudy_staging: Close
[0m10:56:26.151648 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8a38e847-6d8c-4952-9146-1b3c31bd8f1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4a12445d0>]}
[0m10:56:26.152164 [debug] [MainThread]: Using duckdb connection "master"
[0m10:56:26.152443 [debug] [MainThread]: On master: BEGIN
[0m10:56:26.152730 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:56:26.166165 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m10:56:26.166689 [debug] [MainThread]: On master: COMMIT
[0m10:56:26.167169 [debug] [MainThread]: Using duckdb connection "master"
[0m10:56:26.167439 [debug] [MainThread]: On master: COMMIT
[0m10:56:26.168010 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m10:56:26.168344 [debug] [MainThread]: On master: Close
[0m10:56:26.171062 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:56:26.171486 [info ] [MainThread]: 
[0m10:56:26.176723 [debug] [Thread-1 (]: Began running node model.vg_casestudy.stg_staging_intermediate_fx_rates_filled
[0m10:56:26.177240 [info ] [Thread-1 (]: 1 of 1 START sql table model intermediate.stg_staging_intermediate_fx_rates_filled  [RUN]
[0m10:56:26.178304 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.vg_casestudy.stg_staging_intermediate_fx_rates_filled'
[0m10:56:26.178654 [debug] [Thread-1 (]: Began compiling node model.vg_casestudy.stg_staging_intermediate_fx_rates_filled
[0m10:56:26.202739 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate_fx_rates_filled"
[0m10:56:26.203280 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate_fx_rates_filled: BEGIN
[0m10:56:26.203830 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:56:26.219392 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m10:56:26.220053 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate_fx_rates_filled"
[0m10:56:26.220415 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate_fx_rates_filled: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_staging_intermediate_fx_rates_filled"} */


        select 
        ((date('2025-03-11'))::date - (date('2024-12-31'))::date)
    
[0m10:56:26.222929 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m10:56:26.226472 [debug] [Thread-1 (]: Writing injected SQL for node "model.vg_casestudy.stg_staging_intermediate_fx_rates_filled"
[0m10:56:26.227335 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.stg_staging_intermediate_fx_rates_filled (compile): 10:56:26.178927 => 10:56:26.227085
[0m10:56:26.227716 [debug] [Thread-1 (]: Began executing node model.vg_casestudy.stg_staging_intermediate_fx_rates_filled
[0m10:56:26.259914 [debug] [Thread-1 (]: Writing runtime sql for node "model.vg_casestudy.stg_staging_intermediate_fx_rates_filled"
[0m10:56:26.260672 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate_fx_rates_filled"
[0m10:56:26.261162 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate_fx_rates_filled: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_staging_intermediate_fx_rates_filled"} */

  
    
    

    create  table
      "casestudy"."intermediate"."stg_staging_intermediate_fx_rates_filled__dbt_tmp"
  
    as (
      with calendar as (

    





with rawdata as (

    

    

    with p as (
        select 0 as generated_number union all select 1
    ), unioned as (

    select

    
    p0.generated_number * power(2, 0)
     + 
    
    p1.generated_number * power(2, 1)
     + 
    
    p2.generated_number * power(2, 2)
     + 
    
    p3.generated_number * power(2, 3)
     + 
    
    p4.generated_number * power(2, 4)
     + 
    
    p5.generated_number * power(2, 5)
     + 
    
    p6.generated_number * power(2, 6)
    
    
    + 1
    as generated_number

    from

    
    p as p0
     cross join 
    
    p as p1
     cross join 
    
    p as p2
     cross join 
    
    p as p3
     cross join 
    
    p as p4
     cross join 
    
    p as p5
     cross join 
    
    p as p6
    
    

    )

    select *
    from unioned
    where generated_number <= 70
    order by generated_number



),

all_periods as (

    select (
        

    date('2024-12-31') + ((interval '1 day') * (row_number() over (order by 1) - 1))


    ) as date_day
    from rawdata

),

filtered as (

    select *
    from all_periods
    where date_day <= date('2025-03-11')

)

select * from filtered



),

currencies as (
    select distinct trim(currency_iso_code) as currency_iso_code
    from "casestudy"."raw"."fx_rates_full_history"
),

date_matrix as (
    select 
        currencies.currency_iso_code,
        calendar.date_day as fx_rate_date
    from currencies
    cross join calendar 

),

joined as (
    select 
        date_matrix.currency_iso_code,
        date_matrix.fx_rate_date,
        fx_rates_full_history.fx_rate
    from date_matrix
    left join "casestudy"."raw"."fx_rates_full_history" as fx_rates_full_history
    on date_matrix.currency_iso_code = fx_rates_full_history.currency_iso_code
    and date_matrix.fx_rate_date = fx_rates_full_history.fx_rate_date
),

forward_fill_dates as (
    select 
        currency_iso_code,
        fx_rate_date::date as fx_rate_date,

        last_value(fx_rate ignore nulls) over(
            partition by currency_iso_code
            order by fx_rate_date asc
            rows between unbounded preceding and current row
        ) as fx_rate
    from joined
)

select *
from forward_fill_dates
    );
  
  
[0m10:56:26.288225 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m10:56:26.296027 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate_fx_rates_filled"
[0m10:56:26.296465 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate_fx_rates_filled: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_staging_intermediate_fx_rates_filled"} */
alter table "casestudy"."intermediate"."stg_staging_intermediate_fx_rates_filled" rename to "stg_staging_intermediate_fx_rates_filled__dbt_backup"
[0m10:56:26.297369 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m10:56:26.300472 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate_fx_rates_filled"
[0m10:56:26.300860 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate_fx_rates_filled: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_staging_intermediate_fx_rates_filled"} */
alter table "casestudy"."intermediate"."stg_staging_intermediate_fx_rates_filled__dbt_tmp" rename to "stg_staging_intermediate_fx_rates_filled"
[0m10:56:26.301661 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m10:56:26.319076 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate_fx_rates_filled: COMMIT
[0m10:56:26.319520 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate_fx_rates_filled"
[0m10:56:26.319849 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate_fx_rates_filled: COMMIT
[0m10:56:26.325618 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m10:56:26.330783 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate_fx_rates_filled"
[0m10:56:26.331233 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate_fx_rates_filled: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_staging_intermediate_fx_rates_filled"} */
drop table if exists "casestudy"."intermediate"."stg_staging_intermediate_fx_rates_filled__dbt_backup" cascade
[0m10:56:26.335733 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m10:56:26.337178 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.stg_staging_intermediate_fx_rates_filled (execute): 10:56:26.227969 => 10:56:26.337011
[0m10:56:26.337590 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate_fx_rates_filled: Close
[0m10:56:26.365543 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8a38e847-6d8c-4952-9146-1b3c31bd8f1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa49c06b390>]}
[0m10:56:26.366261 [info ] [Thread-1 (]: 1 of 1 OK created sql table model intermediate.stg_staging_intermediate_fx_rates_filled  [[32mOK[0m in 0.19s]
[0m10:56:26.366861 [debug] [Thread-1 (]: Finished running node model.vg_casestudy.stg_staging_intermediate_fx_rates_filled
[0m10:56:26.368556 [debug] [MainThread]: Using duckdb connection "master"
[0m10:56:26.368925 [debug] [MainThread]: On master: BEGIN
[0m10:56:26.369233 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:56:26.385102 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m10:56:26.385813 [debug] [MainThread]: On master: COMMIT
[0m10:56:26.386192 [debug] [MainThread]: Using duckdb connection "master"
[0m10:56:26.386556 [debug] [MainThread]: On master: COMMIT
[0m10:56:26.387288 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m10:56:26.387640 [debug] [MainThread]: On master: Close
[0m10:56:26.390132 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:56:26.390488 [debug] [MainThread]: Connection 'list_casestudy_staging' was properly closed.
[0m10:56:26.390759 [debug] [MainThread]: Connection 'model.vg_casestudy.stg_staging_intermediate_fx_rates_filled' was properly closed.
[0m10:56:26.391087 [info ] [MainThread]: 
[0m10:56:26.391437 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.52 seconds (0.52s).
[0m10:56:26.392159 [debug] [MainThread]: Command end result
[0m10:56:26.412332 [info ] [MainThread]: 
[0m10:56:26.412816 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:56:26.413139 [info ] [MainThread]: 
[0m10:56:26.413478 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m10:56:26.413977 [debug] [MainThread]: Command `dbt run` succeeded at 10:56:26.413876 after 1.06 seconds
[0m10:56:26.414334 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4a020e710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4a020aa90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4a03a9510>]}
[0m10:56:26.414696 [debug] [MainThread]: Flushing usage events
[0m11:08:14.610982 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbe540c110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbe57332d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbe540ddd0>]}


============================== 11:08:14.616812 | 2ef9f8fa-b2e8-4387-9ee3-98ce1163a3da ==============================
[0m11:08:14.616812 [info ] [MainThread]: Running with dbt=1.6.18
[0m11:08:14.617390 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/workspaces/vg_case_study_tim/transformation', 'log_path': '/workspaces/vg_case_study_tim/transformation/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt test --select stg_staging_intermediate_fx_rates_filled', 'send_anonymous_usage_stats': 'True'}
[0m11:08:14.819902 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2ef9f8fa-b2e8-4387-9ee3-98ce1163a3da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbe57336d0>]}
[0m11:08:14.834166 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2ef9f8fa-b2e8-4387-9ee3-98ce1163a3da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbe540f9d0>]}
[0m11:08:14.836045 [info ] [MainThread]: Registered adapter: duckdb=1.6.2
[0m11:08:14.864835 [debug] [MainThread]: checksum: 7b9fab86a08e9e96a48a825af743c566d95b877e068b8c6d0dbafbf714447189, vars: {}, profile: , target: , version: 1.6.18
[0m11:08:14.958316 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:08:14.959351 [debug] [MainThread]: Partial parsing: updated file: vg_casestudy://models/intermediate/schema.yml
[0m11:08:15.083875 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.vg_casestudy.main
- models.vg_casestudy.reporting
- models.vg_casestudy.marts
[0m11:08:15.091703 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2ef9f8fa-b2e8-4387-9ee3-98ce1163a3da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbe5179f10>]}
[0m11:08:15.123729 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2ef9f8fa-b2e8-4387-9ee3-98ce1163a3da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbe1160810>]}
[0m11:08:15.124269 [info ] [MainThread]: Found 12 models, 1 analysis, 3 seeds, 80 tests, 5 sources, 0 exposures, 0 metrics, 632 macros, 0 groups, 0 semantic models
[0m11:08:15.124762 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2ef9f8fa-b2e8-4387-9ee3-98ce1163a3da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbe6f442d0>]}
[0m11:08:15.127341 [info ] [MainThread]: 
[0m11:08:15.128106 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m11:08:15.129965 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_casestudy_intermediate'
[0m11:08:15.143709 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_intermediate"
[0m11:08:15.144226 [debug] [ThreadPool]: On list_casestudy_intermediate: BEGIN
[0m11:08:15.144543 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:08:15.268005 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:08:15.268450 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_intermediate"
[0m11:08:15.268756 [debug] [ThreadPool]: On list_casestudy_intermediate: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_intermediate"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'intermediate'
    and table_catalog = 'casestudy'
  
[0m11:08:15.291858 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:08:15.293751 [debug] [ThreadPool]: On list_casestudy_intermediate: ROLLBACK
[0m11:08:15.295187 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_intermediate'
[0m11:08:15.295604 [debug] [ThreadPool]: On list_casestudy_intermediate: Close
[0m11:08:15.298756 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy_intermediate, now list_casestudy_raw)
[0m11:08:15.302193 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_raw"
[0m11:08:15.302543 [debug] [ThreadPool]: On list_casestudy_raw: BEGIN
[0m11:08:15.302817 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:08:15.314404 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:08:15.314803 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_raw"
[0m11:08:15.315099 [debug] [ThreadPool]: On list_casestudy_raw: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_raw"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'raw'
    and table_catalog = 'casestudy'
  
[0m11:08:15.324178 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:08:15.325565 [debug] [ThreadPool]: On list_casestudy_raw: ROLLBACK
[0m11:08:15.326030 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_raw'
[0m11:08:15.326290 [debug] [ThreadPool]: On list_casestudy_raw: Close
[0m11:08:15.329133 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy_raw, now list_casestudy_staging)
[0m11:08:15.331362 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_staging"
[0m11:08:15.331712 [debug] [ThreadPool]: On list_casestudy_staging: BEGIN
[0m11:08:15.332031 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:08:15.342753 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:08:15.343150 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_staging"
[0m11:08:15.343464 [debug] [ThreadPool]: On list_casestudy_staging: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_staging"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'staging'
    and table_catalog = 'casestudy'
  
[0m11:08:15.351415 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:08:15.352857 [debug] [ThreadPool]: On list_casestudy_staging: ROLLBACK
[0m11:08:15.353299 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_staging'
[0m11:08:15.353562 [debug] [ThreadPool]: On list_casestudy_staging: Close
[0m11:08:15.357305 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2ef9f8fa-b2e8-4387-9ee3-98ce1163a3da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbe11bec90>]}
[0m11:08:15.357769 [debug] [MainThread]: Using duckdb connection "master"
[0m11:08:15.358051 [debug] [MainThread]: On master: BEGIN
[0m11:08:15.358306 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:08:15.371129 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m11:08:15.371579 [debug] [MainThread]: On master: COMMIT
[0m11:08:15.371872 [debug] [MainThread]: Using duckdb connection "master"
[0m11:08:15.372128 [debug] [MainThread]: On master: COMMIT
[0m11:08:15.372624 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m11:08:15.372905 [debug] [MainThread]: On master: Close
[0m11:08:15.375331 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:08:15.375752 [info ] [MainThread]: 
[0m11:08:15.381383 [debug] [Thread-1 (]: Began running node test.vg_casestudy.not_null_stg_staging_intermediate_fx_rates_filled_currency_iso_code.9c900535e4
[0m11:08:15.381829 [info ] [Thread-1 (]: 1 of 6 START test not_null_stg_staging_intermediate_fx_rates_filled_currency_iso_code  [RUN]
[0m11:08:15.382677 [debug] [Thread-1 (]: Acquiring new duckdb connection 'test.vg_casestudy.not_null_stg_staging_intermediate_fx_rates_filled_currency_iso_code.9c900535e4'
[0m11:08:15.383030 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.not_null_stg_staging_intermediate_fx_rates_filled_currency_iso_code.9c900535e4
[0m11:08:15.401037 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.not_null_stg_staging_intermediate_fx_rates_filled_currency_iso_code.9c900535e4"
[0m11:08:15.402277 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_stg_staging_intermediate_fx_rates_filled_currency_iso_code.9c900535e4 (compile): 11:08:15.383273 => 11:08:15.402040
[0m11:08:15.402739 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.not_null_stg_staging_intermediate_fx_rates_filled_currency_iso_code.9c900535e4
[0m11:08:15.416369 [debug] [Thread-1 (]: Writing runtime sql for node "test.vg_casestudy.not_null_stg_staging_intermediate_fx_rates_filled_currency_iso_code.9c900535e4"
[0m11:08:15.418137 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.not_null_stg_staging_intermediate_fx_rates_filled_currency_iso_code.9c900535e4"
[0m11:08:15.418560 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_stg_staging_intermediate_fx_rates_filled_currency_iso_code.9c900535e4: BEGIN
[0m11:08:15.418880 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:08:15.432307 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:08:15.432786 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.not_null_stg_staging_intermediate_fx_rates_filled_currency_iso_code.9c900535e4"
[0m11:08:15.433152 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_stg_staging_intermediate_fx_rates_filled_currency_iso_code.9c900535e4: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "test.vg_casestudy.not_null_stg_staging_intermediate_fx_rates_filled_currency_iso_code.9c900535e4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select currency_iso_code
from "casestudy"."intermediate"."stg_staging_intermediate_fx_rates_filled"
where currency_iso_code is null



      
    ) dbt_internal_test
[0m11:08:15.438002 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:08:15.441374 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_stg_staging_intermediate_fx_rates_filled_currency_iso_code.9c900535e4 (execute): 11:08:15.402989 => 11:08:15.441062
[0m11:08:15.441779 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_stg_staging_intermediate_fx_rates_filled_currency_iso_code.9c900535e4: ROLLBACK
[0m11:08:15.442322 [debug] [Thread-1 (]: Failed to rollback 'test.vg_casestudy.not_null_stg_staging_intermediate_fx_rates_filled_currency_iso_code.9c900535e4'
[0m11:08:15.442673 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_stg_staging_intermediate_fx_rates_filled_currency_iso_code.9c900535e4: Close
[0m11:08:15.446158 [info ] [Thread-1 (]: 1 of 6 PASS not_null_stg_staging_intermediate_fx_rates_filled_currency_iso_code  [[32mPASS[0m in 0.06s]
[0m11:08:15.447200 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.not_null_stg_staging_intermediate_fx_rates_filled_currency_iso_code.9c900535e4
[0m11:08:15.447805 [debug] [Thread-1 (]: Began running node test.vg_casestudy.not_null_stg_staging_intermediate_fx_rates_filled_fx_rate.91750a92be
[0m11:08:15.448483 [info ] [Thread-1 (]: 2 of 6 START test not_null_stg_staging_intermediate_fx_rates_filled_fx_rate .... [RUN]
[0m11:08:15.449302 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.not_null_stg_staging_intermediate_fx_rates_filled_currency_iso_code.9c900535e4, now test.vg_casestudy.not_null_stg_staging_intermediate_fx_rates_filled_fx_rate.91750a92be)
[0m11:08:15.449658 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.not_null_stg_staging_intermediate_fx_rates_filled_fx_rate.91750a92be
[0m11:08:15.454153 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.not_null_stg_staging_intermediate_fx_rates_filled_fx_rate.91750a92be"
[0m11:08:15.454920 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_stg_staging_intermediate_fx_rates_filled_fx_rate.91750a92be (compile): 11:08:15.449892 => 11:08:15.454693
[0m11:08:15.455338 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.not_null_stg_staging_intermediate_fx_rates_filled_fx_rate.91750a92be
[0m11:08:15.458158 [debug] [Thread-1 (]: Writing runtime sql for node "test.vg_casestudy.not_null_stg_staging_intermediate_fx_rates_filled_fx_rate.91750a92be"
[0m11:08:15.458889 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.not_null_stg_staging_intermediate_fx_rates_filled_fx_rate.91750a92be"
[0m11:08:15.459265 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_stg_staging_intermediate_fx_rates_filled_fx_rate.91750a92be: BEGIN
[0m11:08:15.459653 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:08:15.473058 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:08:15.473582 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.not_null_stg_staging_intermediate_fx_rates_filled_fx_rate.91750a92be"
[0m11:08:15.473966 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_stg_staging_intermediate_fx_rates_filled_fx_rate.91750a92be: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "test.vg_casestudy.not_null_stg_staging_intermediate_fx_rates_filled_fx_rate.91750a92be"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select fx_rate
from "casestudy"."intermediate"."stg_staging_intermediate_fx_rates_filled"
where fx_rate is null



      
    ) dbt_internal_test
[0m11:08:15.475063 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:08:15.476718 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_stg_staging_intermediate_fx_rates_filled_fx_rate.91750a92be (execute): 11:08:15.455637 => 11:08:15.476437
[0m11:08:15.477295 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_stg_staging_intermediate_fx_rates_filled_fx_rate.91750a92be: ROLLBACK
[0m11:08:15.477834 [debug] [Thread-1 (]: Failed to rollback 'test.vg_casestudy.not_null_stg_staging_intermediate_fx_rates_filled_fx_rate.91750a92be'
[0m11:08:15.478199 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_stg_staging_intermediate_fx_rates_filled_fx_rate.91750a92be: Close
[0m11:08:15.480574 [info ] [Thread-1 (]: 2 of 6 PASS not_null_stg_staging_intermediate_fx_rates_filled_fx_rate .......... [[32mPASS[0m in 0.03s]
[0m11:08:15.481234 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.not_null_stg_staging_intermediate_fx_rates_filled_fx_rate.91750a92be
[0m11:08:15.481659 [debug] [Thread-1 (]: Began running node test.vg_casestudy.not_null_stg_staging_intermediate_fx_rates_filled_fx_rate_date.9ee70a0615
[0m11:08:15.482171 [info ] [Thread-1 (]: 3 of 6 START test not_null_stg_staging_intermediate_fx_rates_filled_fx_rate_date  [RUN]
[0m11:08:15.482906 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.not_null_stg_staging_intermediate_fx_rates_filled_fx_rate.91750a92be, now test.vg_casestudy.not_null_stg_staging_intermediate_fx_rates_filled_fx_rate_date.9ee70a0615)
[0m11:08:15.483265 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.not_null_stg_staging_intermediate_fx_rates_filled_fx_rate_date.9ee70a0615
[0m11:08:15.487686 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.not_null_stg_staging_intermediate_fx_rates_filled_fx_rate_date.9ee70a0615"
[0m11:08:15.488555 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_stg_staging_intermediate_fx_rates_filled_fx_rate_date.9ee70a0615 (compile): 11:08:15.483496 => 11:08:15.488289
[0m11:08:15.488986 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.not_null_stg_staging_intermediate_fx_rates_filled_fx_rate_date.9ee70a0615
[0m11:08:15.493575 [debug] [Thread-1 (]: Writing runtime sql for node "test.vg_casestudy.not_null_stg_staging_intermediate_fx_rates_filled_fx_rate_date.9ee70a0615"
[0m11:08:15.494443 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.not_null_stg_staging_intermediate_fx_rates_filled_fx_rate_date.9ee70a0615"
[0m11:08:15.494825 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_stg_staging_intermediate_fx_rates_filled_fx_rate_date.9ee70a0615: BEGIN
[0m11:08:15.495139 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:08:15.507927 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:08:15.508402 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.not_null_stg_staging_intermediate_fx_rates_filled_fx_rate_date.9ee70a0615"
[0m11:08:15.508842 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_stg_staging_intermediate_fx_rates_filled_fx_rate_date.9ee70a0615: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "test.vg_casestudy.not_null_stg_staging_intermediate_fx_rates_filled_fx_rate_date.9ee70a0615"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select fx_rate_date
from "casestudy"."intermediate"."stg_staging_intermediate_fx_rates_filled"
where fx_rate_date is null



      
    ) dbt_internal_test
[0m11:08:15.510391 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:08:15.512268 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_stg_staging_intermediate_fx_rates_filled_fx_rate_date.9ee70a0615 (execute): 11:08:15.489341 => 11:08:15.512038
[0m11:08:15.512679 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_stg_staging_intermediate_fx_rates_filled_fx_rate_date.9ee70a0615: ROLLBACK
[0m11:08:15.513159 [debug] [Thread-1 (]: Failed to rollback 'test.vg_casestudy.not_null_stg_staging_intermediate_fx_rates_filled_fx_rate_date.9ee70a0615'
[0m11:08:15.513496 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_stg_staging_intermediate_fx_rates_filled_fx_rate_date.9ee70a0615: Close
[0m11:08:15.516029 [info ] [Thread-1 (]: 3 of 6 PASS not_null_stg_staging_intermediate_fx_rates_filled_fx_rate_date ..... [[32mPASS[0m in 0.03s]
[0m11:08:15.516692 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.not_null_stg_staging_intermediate_fx_rates_filled_fx_rate_date.9ee70a0615
[0m11:08:15.517123 [debug] [Thread-1 (]: Began running node test.vg_casestudy.numeric_range_stg_staging_intermediate_fx_rates_filled_fx_rate__0.c2731cf81b
[0m11:08:15.517712 [info ] [Thread-1 (]: 4 of 6 START test numeric_range_stg_staging_intermediate_fx_rates_filled_fx_rate__0  [RUN]
[0m11:08:15.518444 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.not_null_stg_staging_intermediate_fx_rates_filled_fx_rate_date.9ee70a0615, now test.vg_casestudy.numeric_range_stg_staging_intermediate_fx_rates_filled_fx_rate__0.c2731cf81b)
[0m11:08:15.518786 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.numeric_range_stg_staging_intermediate_fx_rates_filled_fx_rate__0.c2731cf81b
[0m11:08:15.522940 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.numeric_range_stg_staging_intermediate_fx_rates_filled_fx_rate__0.c2731cf81b"
[0m11:08:15.523654 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.numeric_range_stg_staging_intermediate_fx_rates_filled_fx_rate__0.c2731cf81b (compile): 11:08:15.519009 => 11:08:15.523420
[0m11:08:15.524026 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.numeric_range_stg_staging_intermediate_fx_rates_filled_fx_rate__0.c2731cf81b
[0m11:08:15.527360 [debug] [Thread-1 (]: Writing runtime sql for node "test.vg_casestudy.numeric_range_stg_staging_intermediate_fx_rates_filled_fx_rate__0.c2731cf81b"
[0m11:08:15.528140 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.numeric_range_stg_staging_intermediate_fx_rates_filled_fx_rate__0.c2731cf81b"
[0m11:08:15.528553 [debug] [Thread-1 (]: On test.vg_casestudy.numeric_range_stg_staging_intermediate_fx_rates_filled_fx_rate__0.c2731cf81b: BEGIN
[0m11:08:15.528919 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:08:15.542148 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:08:15.542724 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.numeric_range_stg_staging_intermediate_fx_rates_filled_fx_rate__0.c2731cf81b"
[0m11:08:15.543156 [debug] [Thread-1 (]: On test.vg_casestudy.numeric_range_stg_staging_intermediate_fx_rates_filled_fx_rate__0.c2731cf81b: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "test.vg_casestudy.numeric_range_stg_staging_intermediate_fx_rates_filled_fx_rate__0.c2731cf81b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

    
        select *
        from "casestudy"."intermediate"."stg_staging_intermediate_fx_rates_filled"
        where fx_rate < 0
    
    


      
    ) dbt_internal_test
[0m11:08:15.544623 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:08:15.546365 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.numeric_range_stg_staging_intermediate_fx_rates_filled_fx_rate__0.c2731cf81b (execute): 11:08:15.524276 => 11:08:15.546089
[0m11:08:15.546824 [debug] [Thread-1 (]: On test.vg_casestudy.numeric_range_stg_staging_intermediate_fx_rates_filled_fx_rate__0.c2731cf81b: ROLLBACK
[0m11:08:15.547402 [debug] [Thread-1 (]: Failed to rollback 'test.vg_casestudy.numeric_range_stg_staging_intermediate_fx_rates_filled_fx_rate__0.c2731cf81b'
[0m11:08:15.547807 [debug] [Thread-1 (]: On test.vg_casestudy.numeric_range_stg_staging_intermediate_fx_rates_filled_fx_rate__0.c2731cf81b: Close
[0m11:08:15.550410 [info ] [Thread-1 (]: 4 of 6 PASS numeric_range_stg_staging_intermediate_fx_rates_filled_fx_rate__0 .. [[32mPASS[0m in 0.03s]
[0m11:08:15.551066 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.numeric_range_stg_staging_intermediate_fx_rates_filled_fx_rate__0.c2731cf81b
[0m11:08:15.551588 [debug] [Thread-1 (]: Began running node test.vg_casestudy.unique_stg_staging_intermediate_fx_rates_filled_currency_iso_code.1135e2ffae
[0m11:08:15.552146 [info ] [Thread-1 (]: 5 of 6 START test unique_stg_staging_intermediate_fx_rates_filled_currency_iso_code  [RUN]
[0m11:08:15.552887 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.numeric_range_stg_staging_intermediate_fx_rates_filled_fx_rate__0.c2731cf81b, now test.vg_casestudy.unique_stg_staging_intermediate_fx_rates_filled_currency_iso_code.1135e2ffae)
[0m11:08:15.553235 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.unique_stg_staging_intermediate_fx_rates_filled_currency_iso_code.1135e2ffae
[0m11:08:15.562250 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.unique_stg_staging_intermediate_fx_rates_filled_currency_iso_code.1135e2ffae"
[0m11:08:15.563082 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.unique_stg_staging_intermediate_fx_rates_filled_currency_iso_code.1135e2ffae (compile): 11:08:15.553458 => 11:08:15.562826
[0m11:08:15.563525 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.unique_stg_staging_intermediate_fx_rates_filled_currency_iso_code.1135e2ffae
[0m11:08:15.566812 [debug] [Thread-1 (]: Writing runtime sql for node "test.vg_casestudy.unique_stg_staging_intermediate_fx_rates_filled_currency_iso_code.1135e2ffae"
[0m11:08:15.567819 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.unique_stg_staging_intermediate_fx_rates_filled_currency_iso_code.1135e2ffae"
[0m11:08:15.568255 [debug] [Thread-1 (]: On test.vg_casestudy.unique_stg_staging_intermediate_fx_rates_filled_currency_iso_code.1135e2ffae: BEGIN
[0m11:08:15.568589 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:08:15.583208 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:08:15.583741 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.unique_stg_staging_intermediate_fx_rates_filled_currency_iso_code.1135e2ffae"
[0m11:08:15.584148 [debug] [Thread-1 (]: On test.vg_casestudy.unique_stg_staging_intermediate_fx_rates_filled_currency_iso_code.1135e2ffae: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "test.vg_casestudy.unique_stg_staging_intermediate_fx_rates_filled_currency_iso_code.1135e2ffae"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    currency_iso_code as unique_field,
    count(*) as n_records

from "casestudy"."intermediate"."stg_staging_intermediate_fx_rates_filled"
where currency_iso_code is not null
group by currency_iso_code
having count(*) > 1



      
    ) dbt_internal_test
[0m11:08:15.593289 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:08:15.595451 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.unique_stg_staging_intermediate_fx_rates_filled_currency_iso_code.1135e2ffae (execute): 11:08:15.563862 => 11:08:15.595074
[0m11:08:15.595910 [debug] [Thread-1 (]: On test.vg_casestudy.unique_stg_staging_intermediate_fx_rates_filled_currency_iso_code.1135e2ffae: ROLLBACK
[0m11:08:15.596432 [debug] [Thread-1 (]: Failed to rollback 'test.vg_casestudy.unique_stg_staging_intermediate_fx_rates_filled_currency_iso_code.1135e2ffae'
[0m11:08:15.596768 [debug] [Thread-1 (]: On test.vg_casestudy.unique_stg_staging_intermediate_fx_rates_filled_currency_iso_code.1135e2ffae: Close
[0m11:08:15.600106 [error] [Thread-1 (]: 5 of 6 FAIL 15 unique_stg_staging_intermediate_fx_rates_filled_currency_iso_code  [[31mFAIL 15[0m in 0.05s]
[0m11:08:15.600854 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.unique_stg_staging_intermediate_fx_rates_filled_currency_iso_code.1135e2ffae
[0m11:08:15.601361 [debug] [Thread-1 (]: Began running node test.vg_casestudy.unique_stg_staging_intermediate_fx_rates_filled_fx_rate_date.8c859e2761
[0m11:08:15.601738 [info ] [Thread-1 (]: 6 of 6 START test unique_stg_staging_intermediate_fx_rates_filled_fx_rate_date . [RUN]
[0m11:08:15.602547 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.unique_stg_staging_intermediate_fx_rates_filled_currency_iso_code.1135e2ffae, now test.vg_casestudy.unique_stg_staging_intermediate_fx_rates_filled_fx_rate_date.8c859e2761)
[0m11:08:15.603158 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.unique_stg_staging_intermediate_fx_rates_filled_fx_rate_date.8c859e2761
[0m11:08:15.607755 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.unique_stg_staging_intermediate_fx_rates_filled_fx_rate_date.8c859e2761"
[0m11:08:15.608933 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.unique_stg_staging_intermediate_fx_rates_filled_fx_rate_date.8c859e2761 (compile): 11:08:15.603441 => 11:08:15.608552
[0m11:08:15.609503 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.unique_stg_staging_intermediate_fx_rates_filled_fx_rate_date.8c859e2761
[0m11:08:15.612912 [debug] [Thread-1 (]: Writing runtime sql for node "test.vg_casestudy.unique_stg_staging_intermediate_fx_rates_filled_fx_rate_date.8c859e2761"
[0m11:08:15.613620 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.unique_stg_staging_intermediate_fx_rates_filled_fx_rate_date.8c859e2761"
[0m11:08:15.613998 [debug] [Thread-1 (]: On test.vg_casestudy.unique_stg_staging_intermediate_fx_rates_filled_fx_rate_date.8c859e2761: BEGIN
[0m11:08:15.614316 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:08:15.627683 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:08:15.628279 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.unique_stg_staging_intermediate_fx_rates_filled_fx_rate_date.8c859e2761"
[0m11:08:15.629068 [debug] [Thread-1 (]: On test.vg_casestudy.unique_stg_staging_intermediate_fx_rates_filled_fx_rate_date.8c859e2761: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "test.vg_casestudy.unique_stg_staging_intermediate_fx_rates_filled_fx_rate_date.8c859e2761"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    fx_rate_date as unique_field,
    count(*) as n_records

from "casestudy"."intermediate"."stg_staging_intermediate_fx_rates_filled"
where fx_rate_date is not null
group by fx_rate_date
having count(*) > 1



      
    ) dbt_internal_test
[0m11:08:15.633530 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:08:15.636832 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.unique_stg_staging_intermediate_fx_rates_filled_fx_rate_date.8c859e2761 (execute): 11:08:15.609881 => 11:08:15.636420
[0m11:08:15.637336 [debug] [Thread-1 (]: On test.vg_casestudy.unique_stg_staging_intermediate_fx_rates_filled_fx_rate_date.8c859e2761: ROLLBACK
[0m11:08:15.637874 [debug] [Thread-1 (]: Failed to rollback 'test.vg_casestudy.unique_stg_staging_intermediate_fx_rates_filled_fx_rate_date.8c859e2761'
[0m11:08:15.638250 [debug] [Thread-1 (]: On test.vg_casestudy.unique_stg_staging_intermediate_fx_rates_filled_fx_rate_date.8c859e2761: Close
[0m11:08:15.640953 [error] [Thread-1 (]: 6 of 6 FAIL 70 unique_stg_staging_intermediate_fx_rates_filled_fx_rate_date .... [[31mFAIL 70[0m in 0.04s]
[0m11:08:15.642064 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.unique_stg_staging_intermediate_fx_rates_filled_fx_rate_date.8c859e2761
[0m11:08:15.644310 [debug] [MainThread]: Using duckdb connection "master"
[0m11:08:15.644733 [debug] [MainThread]: On master: BEGIN
[0m11:08:15.645077 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:08:15.662358 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m11:08:15.662835 [debug] [MainThread]: On master: COMMIT
[0m11:08:15.663217 [debug] [MainThread]: Using duckdb connection "master"
[0m11:08:15.663529 [debug] [MainThread]: On master: COMMIT
[0m11:08:15.664127 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m11:08:15.664446 [debug] [MainThread]: On master: Close
[0m11:08:15.667969 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:08:15.668403 [debug] [MainThread]: Connection 'list_casestudy_staging' was properly closed.
[0m11:08:15.668701 [debug] [MainThread]: Connection 'test.vg_casestudy.unique_stg_staging_intermediate_fx_rates_filled_fx_rate_date.8c859e2761' was properly closed.
[0m11:08:15.669046 [info ] [MainThread]: 
[0m11:08:15.669388 [info ] [MainThread]: Finished running 6 tests in 0 hours 0 minutes and 0.54 seconds (0.54s).
[0m11:08:15.670479 [debug] [MainThread]: Command end result
[0m11:08:15.690150 [info ] [MainThread]: 
[0m11:08:15.690626 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m11:08:15.690948 [info ] [MainThread]: 
[0m11:08:15.691294 [error] [MainThread]: [31mFailure in test unique_stg_staging_intermediate_fx_rates_filled_currency_iso_code (models/intermediate/schema.yml)[0m
[0m11:08:15.691609 [error] [MainThread]:   Got 15 results, configured to fail if != 0
[0m11:08:15.691917 [info ] [MainThread]: 
[0m11:08:15.692199 [info ] [MainThread]:   compiled Code at target/compiled/vg_casestudy/models/intermediate/schema.yml/unique_stg_staging_intermediat_6dcfe84f78b298d5dcee3c19baa974dc.sql
[0m11:08:15.692522 [info ] [MainThread]: 
[0m11:08:15.692829 [error] [MainThread]: [31mFailure in test unique_stg_staging_intermediate_fx_rates_filled_fx_rate_date (models/intermediate/schema.yml)[0m
[0m11:08:15.693117 [error] [MainThread]:   Got 70 results, configured to fail if != 0
[0m11:08:15.693410 [info ] [MainThread]: 
[0m11:08:15.693772 [info ] [MainThread]:   compiled Code at target/compiled/vg_casestudy/models/intermediate/schema.yml/unique_stg_staging_intermediate_fx_rates_filled_fx_rate_date.sql
[0m11:08:15.694087 [info ] [MainThread]: 
[0m11:08:15.694416 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=2 SKIP=0 TOTAL=6
[0m11:08:15.694912 [debug] [MainThread]: Command `dbt test` failed at 11:08:15.694814 after 1.09 seconds
[0m11:08:15.695282 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbe548d9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbe5745b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbe9dd6250>]}
[0m11:08:15.695638 [debug] [MainThread]: Flushing usage events
[0m11:08:52.501119 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb069d025d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb068d331d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb068e9aed0>]}


============================== 11:08:52.503977 | b811fa92-3e83-4e3e-827d-8107fc267b65 ==============================
[0m11:08:52.503977 [info ] [MainThread]: Running with dbt=1.6.18
[0m11:08:52.504541 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/workspaces/vg_case_study_tim/transformation', 'debug': 'False', 'warn_error': 'None', 'log_path': '/workspaces/vg_case_study_tim/transformation/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt test --select stg_staging_intermediate_fx_rates_filled', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:08:52.616144 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b811fa92-3e83-4e3e-827d-8107fc267b65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb06890cf90>]}
[0m11:08:52.630290 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b811fa92-3e83-4e3e-827d-8107fc267b65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0688aa0d0>]}
[0m11:08:52.631241 [info ] [MainThread]: Registered adapter: duckdb=1.6.2
[0m11:08:52.656231 [debug] [MainThread]: checksum: 7b9fab86a08e9e96a48a825af743c566d95b877e068b8c6d0dbafbf714447189, vars: {}, profile: , target: , version: 1.6.18
[0m11:08:52.698258 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:08:52.699516 [debug] [MainThread]: Partial parsing: updated file: vg_casestudy://models/intermediate/schema.yml
[0m11:08:52.862906 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.vg_casestudy.main
- models.vg_casestudy.reporting
- models.vg_casestudy.marts
[0m11:08:52.869820 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b811fa92-3e83-4e3e-827d-8107fc267b65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb06a76de10>]}
[0m11:08:52.898718 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b811fa92-3e83-4e3e-827d-8107fc267b65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0649b2350>]}
[0m11:08:52.899287 [info ] [MainThread]: Found 12 models, 1 analysis, 3 seeds, 78 tests, 5 sources, 0 exposures, 0 metrics, 632 macros, 0 groups, 0 semantic models
[0m11:08:52.899694 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b811fa92-3e83-4e3e-827d-8107fc267b65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb068ecda50>]}
[0m11:08:52.902134 [info ] [MainThread]: 
[0m11:08:52.902922 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m11:08:52.904931 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_casestudy_staging'
[0m11:08:52.911015 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_staging"
[0m11:08:52.911498 [debug] [ThreadPool]: On list_casestudy_staging: BEGIN
[0m11:08:52.911839 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:08:52.930527 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:08:52.931010 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_staging"
[0m11:08:52.931325 [debug] [ThreadPool]: On list_casestudy_staging: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_staging"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'staging'
    and table_catalog = 'casestudy'
  
[0m11:08:52.941747 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:08:52.943352 [debug] [ThreadPool]: On list_casestudy_staging: ROLLBACK
[0m11:08:52.944025 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_staging'
[0m11:08:52.944324 [debug] [ThreadPool]: On list_casestudy_staging: Close
[0m11:08:52.949949 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy_staging, now list_casestudy_raw)
[0m11:08:52.952218 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_raw"
[0m11:08:52.952580 [debug] [ThreadPool]: On list_casestudy_raw: BEGIN
[0m11:08:52.952875 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:08:52.964744 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:08:52.965176 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_raw"
[0m11:08:52.965482 [debug] [ThreadPool]: On list_casestudy_raw: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_raw"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'raw'
    and table_catalog = 'casestudy'
  
[0m11:08:52.975307 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:08:52.976736 [debug] [ThreadPool]: On list_casestudy_raw: ROLLBACK
[0m11:08:52.977241 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_raw'
[0m11:08:52.977508 [debug] [ThreadPool]: On list_casestudy_raw: Close
[0m11:08:52.980522 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy_raw, now list_casestudy_intermediate)
[0m11:08:52.982953 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_intermediate"
[0m11:08:52.983312 [debug] [ThreadPool]: On list_casestudy_intermediate: BEGIN
[0m11:08:52.983605 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:08:52.994009 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:08:52.994408 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_intermediate"
[0m11:08:52.994700 [debug] [ThreadPool]: On list_casestudy_intermediate: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_intermediate"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'intermediate'
    and table_catalog = 'casestudy'
  
[0m11:08:53.003118 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:08:53.004438 [debug] [ThreadPool]: On list_casestudy_intermediate: ROLLBACK
[0m11:08:53.004903 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_intermediate'
[0m11:08:53.005159 [debug] [ThreadPool]: On list_casestudy_intermediate: Close
[0m11:08:53.008737 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b811fa92-3e83-4e3e-827d-8107fc267b65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb068ed9dd0>]}
[0m11:08:53.009267 [debug] [MainThread]: Using duckdb connection "master"
[0m11:08:53.009546 [debug] [MainThread]: On master: BEGIN
[0m11:08:53.009807 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:08:53.021583 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m11:08:53.021995 [debug] [MainThread]: On master: COMMIT
[0m11:08:53.022303 [debug] [MainThread]: Using duckdb connection "master"
[0m11:08:53.022618 [debug] [MainThread]: On master: COMMIT
[0m11:08:53.023127 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m11:08:53.023467 [debug] [MainThread]: On master: Close
[0m11:08:53.026444 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:08:53.026880 [info ] [MainThread]: 
[0m11:08:53.029800 [debug] [Thread-1 (]: Began running node test.vg_casestudy.not_null_stg_staging_intermediate_fx_rates_filled_currency_iso_code.9c900535e4
[0m11:08:53.030213 [info ] [Thread-1 (]: 1 of 4 START test not_null_stg_staging_intermediate_fx_rates_filled_currency_iso_code  [RUN]
[0m11:08:53.031010 [debug] [Thread-1 (]: Acquiring new duckdb connection 'test.vg_casestudy.not_null_stg_staging_intermediate_fx_rates_filled_currency_iso_code.9c900535e4'
[0m11:08:53.031319 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.not_null_stg_staging_intermediate_fx_rates_filled_currency_iso_code.9c900535e4
[0m11:08:53.047614 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.not_null_stg_staging_intermediate_fx_rates_filled_currency_iso_code.9c900535e4"
[0m11:08:53.048605 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_stg_staging_intermediate_fx_rates_filled_currency_iso_code.9c900535e4 (compile): 11:08:53.031545 => 11:08:53.048364
[0m11:08:53.049040 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.not_null_stg_staging_intermediate_fx_rates_filled_currency_iso_code.9c900535e4
[0m11:08:53.061267 [debug] [Thread-1 (]: Writing runtime sql for node "test.vg_casestudy.not_null_stg_staging_intermediate_fx_rates_filled_currency_iso_code.9c900535e4"
[0m11:08:53.062056 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.not_null_stg_staging_intermediate_fx_rates_filled_currency_iso_code.9c900535e4"
[0m11:08:53.062548 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_stg_staging_intermediate_fx_rates_filled_currency_iso_code.9c900535e4: BEGIN
[0m11:08:53.063047 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:08:53.075767 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:08:53.076253 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.not_null_stg_staging_intermediate_fx_rates_filled_currency_iso_code.9c900535e4"
[0m11:08:53.076600 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_stg_staging_intermediate_fx_rates_filled_currency_iso_code.9c900535e4: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "test.vg_casestudy.not_null_stg_staging_intermediate_fx_rates_filled_currency_iso_code.9c900535e4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select currency_iso_code
from "casestudy"."intermediate"."stg_staging_intermediate_fx_rates_filled"
where currency_iso_code is null



      
    ) dbt_internal_test
[0m11:08:53.078625 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:08:53.080981 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_stg_staging_intermediate_fx_rates_filled_currency_iso_code.9c900535e4 (execute): 11:08:53.049276 => 11:08:53.080759
[0m11:08:53.081343 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_stg_staging_intermediate_fx_rates_filled_currency_iso_code.9c900535e4: ROLLBACK
[0m11:08:53.081830 [debug] [Thread-1 (]: Failed to rollback 'test.vg_casestudy.not_null_stg_staging_intermediate_fx_rates_filled_currency_iso_code.9c900535e4'
[0m11:08:53.082139 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_stg_staging_intermediate_fx_rates_filled_currency_iso_code.9c900535e4: Close
[0m11:08:53.084657 [info ] [Thread-1 (]: 1 of 4 PASS not_null_stg_staging_intermediate_fx_rates_filled_currency_iso_code  [[32mPASS[0m in 0.05s]
[0m11:08:53.085306 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.not_null_stg_staging_intermediate_fx_rates_filled_currency_iso_code.9c900535e4
[0m11:08:53.085723 [debug] [Thread-1 (]: Began running node test.vg_casestudy.not_null_stg_staging_intermediate_fx_rates_filled_fx_rate.91750a92be
[0m11:08:53.086107 [info ] [Thread-1 (]: 2 of 4 START test not_null_stg_staging_intermediate_fx_rates_filled_fx_rate .... [RUN]
[0m11:08:53.086852 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.not_null_stg_staging_intermediate_fx_rates_filled_currency_iso_code.9c900535e4, now test.vg_casestudy.not_null_stg_staging_intermediate_fx_rates_filled_fx_rate.91750a92be)
[0m11:08:53.087210 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.not_null_stg_staging_intermediate_fx_rates_filled_fx_rate.91750a92be
[0m11:08:53.093450 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.not_null_stg_staging_intermediate_fx_rates_filled_fx_rate.91750a92be"
[0m11:08:53.094561 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_stg_staging_intermediate_fx_rates_filled_fx_rate.91750a92be (compile): 11:08:53.087441 => 11:08:53.094164
[0m11:08:53.095048 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.not_null_stg_staging_intermediate_fx_rates_filled_fx_rate.91750a92be
[0m11:08:53.098298 [debug] [Thread-1 (]: Writing runtime sql for node "test.vg_casestudy.not_null_stg_staging_intermediate_fx_rates_filled_fx_rate.91750a92be"
[0m11:08:53.099068 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.not_null_stg_staging_intermediate_fx_rates_filled_fx_rate.91750a92be"
[0m11:08:53.099470 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_stg_staging_intermediate_fx_rates_filled_fx_rate.91750a92be: BEGIN
[0m11:08:53.099784 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:08:53.113200 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:08:53.113772 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.not_null_stg_staging_intermediate_fx_rates_filled_fx_rate.91750a92be"
[0m11:08:53.114210 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_stg_staging_intermediate_fx_rates_filled_fx_rate.91750a92be: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "test.vg_casestudy.not_null_stg_staging_intermediate_fx_rates_filled_fx_rate.91750a92be"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select fx_rate
from "casestudy"."intermediate"."stg_staging_intermediate_fx_rates_filled"
where fx_rate is null



      
    ) dbt_internal_test
[0m11:08:53.115641 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:08:53.117331 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_stg_staging_intermediate_fx_rates_filled_fx_rate.91750a92be (execute): 11:08:53.095447 => 11:08:53.117129
[0m11:08:53.117733 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_stg_staging_intermediate_fx_rates_filled_fx_rate.91750a92be: ROLLBACK
[0m11:08:53.118269 [debug] [Thread-1 (]: Failed to rollback 'test.vg_casestudy.not_null_stg_staging_intermediate_fx_rates_filled_fx_rate.91750a92be'
[0m11:08:53.118622 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_stg_staging_intermediate_fx_rates_filled_fx_rate.91750a92be: Close
[0m11:08:53.121142 [info ] [Thread-1 (]: 2 of 4 PASS not_null_stg_staging_intermediate_fx_rates_filled_fx_rate .......... [[32mPASS[0m in 0.03s]
[0m11:08:53.121810 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.not_null_stg_staging_intermediate_fx_rates_filled_fx_rate.91750a92be
[0m11:08:53.122220 [debug] [Thread-1 (]: Began running node test.vg_casestudy.not_null_stg_staging_intermediate_fx_rates_filled_fx_rate_date.9ee70a0615
[0m11:08:53.122608 [info ] [Thread-1 (]: 3 of 4 START test not_null_stg_staging_intermediate_fx_rates_filled_fx_rate_date  [RUN]
[0m11:08:53.123473 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.not_null_stg_staging_intermediate_fx_rates_filled_fx_rate.91750a92be, now test.vg_casestudy.not_null_stg_staging_intermediate_fx_rates_filled_fx_rate_date.9ee70a0615)
[0m11:08:53.123820 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.not_null_stg_staging_intermediate_fx_rates_filled_fx_rate_date.9ee70a0615
[0m11:08:53.127839 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.not_null_stg_staging_intermediate_fx_rates_filled_fx_rate_date.9ee70a0615"
[0m11:08:53.128705 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_stg_staging_intermediate_fx_rates_filled_fx_rate_date.9ee70a0615 (compile): 11:08:53.124052 => 11:08:53.128391
[0m11:08:53.129201 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.not_null_stg_staging_intermediate_fx_rates_filled_fx_rate_date.9ee70a0615
[0m11:08:53.132331 [debug] [Thread-1 (]: Writing runtime sql for node "test.vg_casestudy.not_null_stg_staging_intermediate_fx_rates_filled_fx_rate_date.9ee70a0615"
[0m11:08:53.133116 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.not_null_stg_staging_intermediate_fx_rates_filled_fx_rate_date.9ee70a0615"
[0m11:08:53.133517 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_stg_staging_intermediate_fx_rates_filled_fx_rate_date.9ee70a0615: BEGIN
[0m11:08:53.133844 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:08:53.150857 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:08:53.151345 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.not_null_stg_staging_intermediate_fx_rates_filled_fx_rate_date.9ee70a0615"
[0m11:08:53.151687 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_stg_staging_intermediate_fx_rates_filled_fx_rate_date.9ee70a0615: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "test.vg_casestudy.not_null_stg_staging_intermediate_fx_rates_filled_fx_rate_date.9ee70a0615"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select fx_rate_date
from "casestudy"."intermediate"."stg_staging_intermediate_fx_rates_filled"
where fx_rate_date is null



      
    ) dbt_internal_test
[0m11:08:53.152874 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:08:53.154399 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_stg_staging_intermediate_fx_rates_filled_fx_rate_date.9ee70a0615 (execute): 11:08:53.129516 => 11:08:53.154212
[0m11:08:53.154791 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_stg_staging_intermediate_fx_rates_filled_fx_rate_date.9ee70a0615: ROLLBACK
[0m11:08:53.155289 [debug] [Thread-1 (]: Failed to rollback 'test.vg_casestudy.not_null_stg_staging_intermediate_fx_rates_filled_fx_rate_date.9ee70a0615'
[0m11:08:53.155605 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_stg_staging_intermediate_fx_rates_filled_fx_rate_date.9ee70a0615: Close
[0m11:08:53.158056 [info ] [Thread-1 (]: 3 of 4 PASS not_null_stg_staging_intermediate_fx_rates_filled_fx_rate_date ..... [[32mPASS[0m in 0.03s]
[0m11:08:53.158750 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.not_null_stg_staging_intermediate_fx_rates_filled_fx_rate_date.9ee70a0615
[0m11:08:53.159152 [debug] [Thread-1 (]: Began running node test.vg_casestudy.numeric_range_stg_staging_intermediate_fx_rates_filled_fx_rate__0.c2731cf81b
[0m11:08:53.159508 [info ] [Thread-1 (]: 4 of 4 START test numeric_range_stg_staging_intermediate_fx_rates_filled_fx_rate__0  [RUN]
[0m11:08:53.160381 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.not_null_stg_staging_intermediate_fx_rates_filled_fx_rate_date.9ee70a0615, now test.vg_casestudy.numeric_range_stg_staging_intermediate_fx_rates_filled_fx_rate__0.c2731cf81b)
[0m11:08:53.160708 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.numeric_range_stg_staging_intermediate_fx_rates_filled_fx_rate__0.c2731cf81b
[0m11:08:53.165082 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.numeric_range_stg_staging_intermediate_fx_rates_filled_fx_rate__0.c2731cf81b"
[0m11:08:53.165821 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.numeric_range_stg_staging_intermediate_fx_rates_filled_fx_rate__0.c2731cf81b (compile): 11:08:53.160951 => 11:08:53.165598
[0m11:08:53.166241 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.numeric_range_stg_staging_intermediate_fx_rates_filled_fx_rate__0.c2731cf81b
[0m11:08:53.169779 [debug] [Thread-1 (]: Writing runtime sql for node "test.vg_casestudy.numeric_range_stg_staging_intermediate_fx_rates_filled_fx_rate__0.c2731cf81b"
[0m11:08:53.170560 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.numeric_range_stg_staging_intermediate_fx_rates_filled_fx_rate__0.c2731cf81b"
[0m11:08:53.171026 [debug] [Thread-1 (]: On test.vg_casestudy.numeric_range_stg_staging_intermediate_fx_rates_filled_fx_rate__0.c2731cf81b: BEGIN
[0m11:08:53.171401 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:08:53.185067 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:08:53.185551 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.numeric_range_stg_staging_intermediate_fx_rates_filled_fx_rate__0.c2731cf81b"
[0m11:08:53.185910 [debug] [Thread-1 (]: On test.vg_casestudy.numeric_range_stg_staging_intermediate_fx_rates_filled_fx_rate__0.c2731cf81b: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "test.vg_casestudy.numeric_range_stg_staging_intermediate_fx_rates_filled_fx_rate__0.c2731cf81b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

    
        select *
        from "casestudy"."intermediate"."stg_staging_intermediate_fx_rates_filled"
        where fx_rate < 0
    
    


      
    ) dbt_internal_test
[0m11:08:53.187148 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:08:53.188705 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.numeric_range_stg_staging_intermediate_fx_rates_filled_fx_rate__0.c2731cf81b (execute): 11:08:53.166628 => 11:08:53.188495
[0m11:08:53.189078 [debug] [Thread-1 (]: On test.vg_casestudy.numeric_range_stg_staging_intermediate_fx_rates_filled_fx_rate__0.c2731cf81b: ROLLBACK
[0m11:08:53.189547 [debug] [Thread-1 (]: Failed to rollback 'test.vg_casestudy.numeric_range_stg_staging_intermediate_fx_rates_filled_fx_rate__0.c2731cf81b'
[0m11:08:53.189870 [debug] [Thread-1 (]: On test.vg_casestudy.numeric_range_stg_staging_intermediate_fx_rates_filled_fx_rate__0.c2731cf81b: Close
[0m11:08:53.192185 [info ] [Thread-1 (]: 4 of 4 PASS numeric_range_stg_staging_intermediate_fx_rates_filled_fx_rate__0 .. [[32mPASS[0m in 0.03s]
[0m11:08:53.192799 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.numeric_range_stg_staging_intermediate_fx_rates_filled_fx_rate__0.c2731cf81b
[0m11:08:53.194641 [debug] [MainThread]: Using duckdb connection "master"
[0m11:08:53.195027 [debug] [MainThread]: On master: BEGIN
[0m11:08:53.195298 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:08:53.209764 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m11:08:53.210205 [debug] [MainThread]: On master: COMMIT
[0m11:08:53.210536 [debug] [MainThread]: Using duckdb connection "master"
[0m11:08:53.210829 [debug] [MainThread]: On master: COMMIT
[0m11:08:53.211532 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m11:08:53.211939 [debug] [MainThread]: On master: Close
[0m11:08:53.215505 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:08:53.215945 [debug] [MainThread]: Connection 'list_casestudy_intermediate' was properly closed.
[0m11:08:53.216223 [debug] [MainThread]: Connection 'test.vg_casestudy.numeric_range_stg_staging_intermediate_fx_rates_filled_fx_rate__0.c2731cf81b' was properly closed.
[0m11:08:53.216570 [info ] [MainThread]: 
[0m11:08:53.216924 [info ] [MainThread]: Finished running 4 tests in 0 hours 0 minutes and 0.31 seconds (0.31s).
[0m11:08:53.217816 [debug] [MainThread]: Command end result
[0m11:08:53.237505 [info ] [MainThread]: 
[0m11:08:53.238099 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:08:53.238501 [info ] [MainThread]: 
[0m11:08:53.238826 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m11:08:53.239297 [debug] [MainThread]: Command `dbt test` succeeded at 11:08:53.239203 after 0.75 seconds
[0m11:08:53.239632 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb068e94a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb068e97a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb06b0cdbd0>]}
[0m11:08:53.239984 [debug] [MainThread]: Flushing usage events
[0m13:13:33.112152 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0927cb890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa09260ccd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa092467590>]}


============================== 13:13:33.119102 | b91ee66a-1cd7-4894-a44a-5203ed0560d3 ==============================
[0m13:13:33.119102 [info ] [MainThread]: Running with dbt=1.6.18
[0m13:13:33.120260 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/workspaces/vg_case_study_tim/transformation', 'log_path': '/workspaces/vg_case_study_tim/transformation/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt debug', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:13:33.120726 [info ] [MainThread]: dbt version: 1.6.18
[0m13:13:33.121080 [info ] [MainThread]: python version: 3.11.6
[0m13:13:33.121403 [info ] [MainThread]: python path: /usr/local/bin/python
[0m13:13:33.121693 [info ] [MainThread]: os info: Linux-5.15.153.1-microsoft-standard-WSL2-x86_64-with-glibc2.31
[0m13:13:33.258490 [info ] [MainThread]: Using profiles dir at /workspaces/vg_case_study_tim/transformation
[0m13:13:33.259013 [info ] [MainThread]: Using profiles.yml file at /workspaces/vg_case_study_tim/transformation/profiles.yml
[0m13:13:33.259344 [info ] [MainThread]: Using dbt_project.yml file at /workspaces/vg_case_study_tim/transformation/dbt_project.yml
[0m13:13:33.260740 [info ] [MainThread]: adapter type: duckdb
[0m13:13:33.261143 [info ] [MainThread]: adapter version: 1.6.2
[0m13:13:33.293124 [info ] [MainThread]: Configuration:
[0m13:13:33.293647 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m13:13:33.294016 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m13:13:33.294341 [info ] [MainThread]: Required dependencies:
[0m13:13:33.294725 [debug] [MainThread]: Executing "git --help"
[0m13:13:33.296426 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m13:13:33.296877 [debug] [MainThread]: STDERR: "b''"
[0m13:13:33.297145 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m13:13:33.297485 [info ] [MainThread]: Connection:
[0m13:13:33.297809 [info ] [MainThread]:   database: casestudy
[0m13:13:33.298112 [info ] [MainThread]:   schema: main
[0m13:13:33.298402 [info ] [MainThread]:   path: casestudy.duckdb
[0m13:13:33.298673 [info ] [MainThread]:   config_options: None
[0m13:13:33.298939 [info ] [MainThread]:   extensions: ['icu']
[0m13:13:33.299203 [info ] [MainThread]:   settings: None
[0m13:13:33.299467 [info ] [MainThread]:   external_root: .
[0m13:13:33.299733 [info ] [MainThread]:   use_credential_provider: None
[0m13:13:33.300017 [info ] [MainThread]:   attach: None
[0m13:13:33.300285 [info ] [MainThread]:   filesystems: None
[0m13:13:33.300576 [info ] [MainThread]:   remote: None
[0m13:13:33.300860 [info ] [MainThread]:   plugins: None
[0m13:13:33.301187 [info ] [MainThread]:   disable_transactions: False
[0m13:13:33.301632 [info ] [MainThread]: Registered adapter: duckdb=1.6.2
[0m13:13:33.302354 [debug] [MainThread]: Acquiring new duckdb connection 'debug'
[0m13:13:33.302670 [debug] [MainThread]: Using duckdb connection "debug"
[0m13:13:33.302930 [debug] [MainThread]: On debug: select 1 as id
[0m13:13:33.303177 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:13:33.435253 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m13:13:33.436336 [debug] [MainThread]: On debug: Close
[0m13:13:33.439049 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m13:13:33.439565 [info ] [MainThread]: [32mAll checks passed![0m
[0m13:13:33.440051 [debug] [MainThread]: Command `dbt debug` succeeded at 13:13:33.439952 after 0.34 seconds
[0m13:13:33.440357 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m13:13:33.440686 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa092671910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0927b4f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0927b4ed0>]}
[0m13:13:33.441068 [debug] [MainThread]: Flushing usage events
[0m14:40:07.140922 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08de90d450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08debdbf50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08dec11850>]}


============================== 14:40:07.147166 | e8a6f5cc-bada-4119-b01c-1f252e4bfc06 ==============================
[0m14:40:07.147166 [info ] [MainThread]: Running with dbt=1.6.18
[0m14:40:07.147761 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/workspaces/vg_case_study_tim/transformation', 'version_check': 'True', 'debug': 'False', 'log_path': '/workspaces/vg_case_study_tim/transformation/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run --select stg_staging_intermediate__transactions', 'send_anonymous_usage_stats': 'True'}
[0m14:40:07.327874 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e8a6f5cc-bada-4119-b01c-1f252e4bfc06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08debdbf90>]}
[0m14:40:07.341868 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e8a6f5cc-bada-4119-b01c-1f252e4bfc06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08de8f98d0>]}
[0m14:40:07.343384 [info ] [MainThread]: Registered adapter: duckdb=1.6.2
[0m14:40:07.371769 [debug] [MainThread]: checksum: 7b9fab86a08e9e96a48a825af743c566d95b877e068b8c6d0dbafbf714447189, vars: {}, profile: , target: , version: 1.6.18
[0m14:40:07.468570 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 2 files changed.
[0m14:40:07.469299 [debug] [MainThread]: Partial parsing: added file: vg_casestudy://models/core/core__transactions_with_eur.sql
[0m14:40:07.470054 [debug] [MainThread]: Partial parsing: updated file: vg_casestudy://models/intermediate/schema.yml
[0m14:40:07.470423 [debug] [MainThread]: Partial parsing: updated file: vg_casestudy://models/intermediate/stg_staging_intermediate__transactions.sql
[0m14:40:07.637372 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.vg_casestudy.marts
- models.vg_casestudy.main
- models.vg_casestudy.reporting
[0m14:40:07.644160 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e8a6f5cc-bada-4119-b01c-1f252e4bfc06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08de91c450>]}
[0m14:40:07.675658 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e8a6f5cc-bada-4119-b01c-1f252e4bfc06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08e02fb4d0>]}
[0m14:40:07.676240 [info ] [MainThread]: Found 13 models, 1 analysis, 3 seeds, 80 tests, 5 sources, 0 exposures, 0 metrics, 632 macros, 0 groups, 0 semantic models
[0m14:40:07.676745 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e8a6f5cc-bada-4119-b01c-1f252e4bfc06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08da536410>]}
[0m14:40:07.679212 [info ] [MainThread]: 
[0m14:40:07.679997 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:40:07.681355 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_casestudy'
[0m14:40:07.695419 [debug] [ThreadPool]: Using duckdb connection "list_casestudy"
[0m14:40:07.695857 [debug] [ThreadPool]: On list_casestudy: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"casestudy"'
    
  
  
[0m14:40:07.696160 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:40:07.829897 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:40:07.831500 [debug] [ThreadPool]: On list_casestudy: Close
[0m14:40:07.835487 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy, now create_casestudy_intermediate)
[0m14:40:07.836342 [debug] [ThreadPool]: Creating schema "database: "casestudy"
schema: "intermediate"
"
[0m14:40:07.841029 [debug] [ThreadPool]: Using duckdb connection "create_casestudy_intermediate"
[0m14:40:07.841399 [debug] [ThreadPool]: On create_casestudy_intermediate: BEGIN
[0m14:40:07.841674 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:40:07.853430 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:40:07.854033 [debug] [ThreadPool]: Using duckdb connection "create_casestudy_intermediate"
[0m14:40:07.854483 [debug] [ThreadPool]: On create_casestudy_intermediate: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "create_casestudy_intermediate"} */
create schema if not exists "casestudy"."intermediate"
[0m14:40:07.855109 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:40:07.856007 [debug] [ThreadPool]: On create_casestudy_intermediate: COMMIT
[0m14:40:07.856339 [debug] [ThreadPool]: Using duckdb connection "create_casestudy_intermediate"
[0m14:40:07.856628 [debug] [ThreadPool]: On create_casestudy_intermediate: COMMIT
[0m14:40:07.857280 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:40:07.857641 [debug] [ThreadPool]: On create_casestudy_intermediate: Close
[0m14:40:07.861948 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_casestudy_intermediate, now list_casestudy_main)
[0m14:40:07.867484 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_main"
[0m14:40:07.867935 [debug] [ThreadPool]: On list_casestudy_main: BEGIN
[0m14:40:07.868213 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:40:07.880851 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:40:07.881296 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_main"
[0m14:40:07.881596 [debug] [ThreadPool]: On list_casestudy_main: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_main"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'casestudy'
  
[0m14:40:07.896488 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:40:07.898132 [debug] [ThreadPool]: On list_casestudy_main: ROLLBACK
[0m14:40:07.899705 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_main'
[0m14:40:07.900035 [debug] [ThreadPool]: On list_casestudy_main: Close
[0m14:40:07.903158 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy_main, now list_casestudy_raw)
[0m14:40:07.906239 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_raw"
[0m14:40:07.906622 [debug] [ThreadPool]: On list_casestudy_raw: BEGIN
[0m14:40:07.906994 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:40:07.917660 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:40:07.918095 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_raw"
[0m14:40:07.918374 [debug] [ThreadPool]: On list_casestudy_raw: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_raw"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'raw'
    and table_catalog = 'casestudy'
  
[0m14:40:07.927511 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:40:07.928854 [debug] [ThreadPool]: On list_casestudy_raw: ROLLBACK
[0m14:40:07.929352 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_raw'
[0m14:40:07.929615 [debug] [ThreadPool]: On list_casestudy_raw: Close
[0m14:40:07.932257 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy_raw, now list_casestudy_intermediate)
[0m14:40:07.934487 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_intermediate"
[0m14:40:07.934841 [debug] [ThreadPool]: On list_casestudy_intermediate: BEGIN
[0m14:40:07.935182 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:40:07.945680 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:40:07.946087 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_intermediate"
[0m14:40:07.946374 [debug] [ThreadPool]: On list_casestudy_intermediate: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_intermediate"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'intermediate'
    and table_catalog = 'casestudy'
  
[0m14:40:07.954532 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:40:07.955828 [debug] [ThreadPool]: On list_casestudy_intermediate: ROLLBACK
[0m14:40:07.956279 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_intermediate'
[0m14:40:07.956544 [debug] [ThreadPool]: On list_casestudy_intermediate: Close
[0m14:40:07.959298 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy_intermediate, now list_casestudy_staging)
[0m14:40:07.962417 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_staging"
[0m14:40:07.962708 [debug] [ThreadPool]: On list_casestudy_staging: BEGIN
[0m14:40:07.963056 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:40:07.973819 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:40:07.974250 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_staging"
[0m14:40:07.974550 [debug] [ThreadPool]: On list_casestudy_staging: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_staging"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'staging'
    and table_catalog = 'casestudy'
  
[0m14:40:07.982541 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:40:07.984252 [debug] [ThreadPool]: On list_casestudy_staging: ROLLBACK
[0m14:40:07.984786 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_staging'
[0m14:40:07.985093 [debug] [ThreadPool]: On list_casestudy_staging: Close
[0m14:40:07.989318 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e8a6f5cc-bada-4119-b01c-1f252e4bfc06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08df6169d0>]}
[0m14:40:07.989824 [debug] [MainThread]: Using duckdb connection "master"
[0m14:40:07.990132 [debug] [MainThread]: On master: BEGIN
[0m14:40:07.990421 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:40:08.003211 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:40:08.003854 [debug] [MainThread]: On master: COMMIT
[0m14:40:08.004133 [debug] [MainThread]: Using duckdb connection "master"
[0m14:40:08.004405 [debug] [MainThread]: On master: COMMIT
[0m14:40:08.005058 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:40:08.005384 [debug] [MainThread]: On master: Close
[0m14:40:08.008083 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:40:08.008534 [info ] [MainThread]: 
[0m14:40:08.014258 [debug] [Thread-1 (]: Began running node model.vg_casestudy.stg_staging_intermediate__transactions
[0m14:40:08.014876 [info ] [Thread-1 (]: 1 of 1 START sql table model intermediate.stg_staging_intermediate__transactions  [RUN]
[0m14:40:08.015850 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.vg_casestudy.stg_staging_intermediate__transactions'
[0m14:40:08.016373 [debug] [Thread-1 (]: Began compiling node model.vg_casestudy.stg_staging_intermediate__transactions
[0m14:40:08.026726 [debug] [Thread-1 (]: Writing injected SQL for node "model.vg_casestudy.stg_staging_intermediate__transactions"
[0m14:40:08.028040 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.stg_staging_intermediate__transactions (compile): 14:40:08.016708 => 14:40:08.027553
[0m14:40:08.028646 [debug] [Thread-1 (]: Began executing node model.vg_casestudy.stg_staging_intermediate__transactions
[0m14:40:08.062888 [debug] [Thread-1 (]: Writing runtime sql for node "model.vg_casestudy.stg_staging_intermediate__transactions"
[0m14:40:08.063846 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__transactions"
[0m14:40:08.064597 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__transactions: BEGIN
[0m14:40:08.065153 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:40:08.081467 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:40:08.082196 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__transactions"
[0m14:40:08.082761 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__transactions: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_staging_intermediate__transactions"} */

  
    
    

    create  table
      "casestudy"."intermediate"."stg_staging_intermediate__transactions__dbt_tmp"
  
    as (
      with staging as (
    select * from "casestudy"."staging"."stg_raw_staging__transactions"
),

filtered as (
    select
        transaction_id,
        transaction_date,
        account_id,
        transaction_type,
        transaction_amount,
        case 
            when transaction_currency = 'RON1' then 'RON'
            else transaction_currency
        end as transaction_currency
    from staging
    where not has_date_parsing_error
)

select * from filtered
    );
  
  
[0m14:40:08.163286 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:40:08.170112 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__transactions"
[0m14:40:08.170559 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__transactions: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_staging_intermediate__transactions"} */
alter table "casestudy"."intermediate"."stg_staging_intermediate__transactions" rename to "stg_staging_intermediate__transactions__dbt_backup"
[0m14:40:08.171545 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:40:08.174736 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__transactions"
[0m14:40:08.175116 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__transactions: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_staging_intermediate__transactions"} */
alter table "casestudy"."intermediate"."stg_staging_intermediate__transactions__dbt_tmp" rename to "stg_staging_intermediate__transactions"
[0m14:40:08.175926 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:40:08.194054 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__transactions: COMMIT
[0m14:40:08.194476 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__transactions"
[0m14:40:08.194809 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__transactions: COMMIT
[0m14:40:08.210851 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:40:08.220453 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.stg_staging_intermediate__transactions"
[0m14:40:08.221000 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__transactions: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.stg_staging_intermediate__transactions"} */
drop table if exists "casestudy"."intermediate"."stg_staging_intermediate__transactions__dbt_backup" cascade
[0m14:40:08.225728 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:40:08.227478 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.stg_staging_intermediate__transactions (execute): 14:40:08.029066 => 14:40:08.227289
[0m14:40:08.227911 [debug] [Thread-1 (]: On model.vg_casestudy.stg_staging_intermediate__transactions: Close
[0m14:40:08.283394 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e8a6f5cc-bada-4119-b01c-1f252e4bfc06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08e0430210>]}
[0m14:40:08.284499 [info ] [Thread-1 (]: 1 of 1 OK created sql table model intermediate.stg_staging_intermediate__transactions  [[32mOK[0m in 0.27s]
[0m14:40:08.285422 [debug] [Thread-1 (]: Finished running node model.vg_casestudy.stg_staging_intermediate__transactions
[0m14:40:08.287773 [debug] [MainThread]: Using duckdb connection "master"
[0m14:40:08.288284 [debug] [MainThread]: On master: BEGIN
[0m14:40:08.288646 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:40:08.306603 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:40:08.307068 [debug] [MainThread]: On master: COMMIT
[0m14:40:08.307407 [debug] [MainThread]: Using duckdb connection "master"
[0m14:40:08.307720 [debug] [MainThread]: On master: COMMIT
[0m14:40:08.308478 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:40:08.308908 [debug] [MainThread]: On master: Close
[0m14:40:08.312506 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:40:08.313137 [debug] [MainThread]: Connection 'list_casestudy_staging' was properly closed.
[0m14:40:08.313499 [debug] [MainThread]: Connection 'model.vg_casestudy.stg_staging_intermediate__transactions' was properly closed.
[0m14:40:08.313925 [info ] [MainThread]: 
[0m14:40:08.314429 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.63 seconds (0.63s).
[0m14:40:08.315206 [debug] [MainThread]: Command end result
[0m14:40:08.338282 [info ] [MainThread]: 
[0m14:40:08.338779 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:40:08.339112 [info ] [MainThread]: 
[0m14:40:08.339458 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m14:40:08.339945 [debug] [MainThread]: Command `dbt run` succeeded at 14:40:08.339845 after 1.21 seconds
[0m14:40:08.340298 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08de7fb890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08de644ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08de6487d0>]}
[0m14:40:08.340663 [debug] [MainThread]: Flushing usage events
[0m14:40:26.975868 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c69c288d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c69b3da90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c69ad2390>]}


============================== 14:40:26.978328 | 0910081f-7cc6-48d0-9a5f-384ad5000ffc ==============================
[0m14:40:26.978328 [info ] [MainThread]: Running with dbt=1.6.18
[0m14:40:26.978896 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/workspaces/vg_case_study_tim/transformation', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/workspaces/vg_case_study_tim/transformation/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt test --select stg_staging_intermediate__transactions', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:40:27.074598 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0910081f-7cc6-48d0-9a5f-384ad5000ffc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c69f87850>]}
[0m14:40:27.089965 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0910081f-7cc6-48d0-9a5f-384ad5000ffc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c697f1f90>]}
[0m14:40:27.090854 [info ] [MainThread]: Registered adapter: duckdb=1.6.2
[0m14:40:27.115865 [debug] [MainThread]: checksum: 7b9fab86a08e9e96a48a825af743c566d95b877e068b8c6d0dbafbf714447189, vars: {}, profile: , target: , version: 1.6.18
[0m14:40:27.157863 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:40:27.158298 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:40:27.159656 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.vg_casestudy.marts
- models.vg_casestudy.reporting
- models.vg_casestudy.main
[0m14:40:27.167625 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0910081f-7cc6-48d0-9a5f-384ad5000ffc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c69e0f950>]}
[0m14:40:27.238755 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0910081f-7cc6-48d0-9a5f-384ad5000ffc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c6582dc50>]}
[0m14:40:27.239306 [info ] [MainThread]: Found 13 models, 1 analysis, 3 seeds, 80 tests, 5 sources, 0 exposures, 0 metrics, 632 macros, 0 groups, 0 semantic models
[0m14:40:27.239711 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0910081f-7cc6-48d0-9a5f-384ad5000ffc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c657bfe90>]}
[0m14:40:27.242312 [info ] [MainThread]: 
[0m14:40:27.243100 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:40:27.246564 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_casestudy_raw'
[0m14:40:27.258324 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_raw"
[0m14:40:27.258901 [debug] [ThreadPool]: On list_casestudy_raw: BEGIN
[0m14:40:27.259236 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:40:27.276280 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:40:27.276735 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_raw"
[0m14:40:27.277079 [debug] [ThreadPool]: On list_casestudy_raw: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_raw"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'raw'
    and table_catalog = 'casestudy'
  
[0m14:40:27.289973 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:40:27.291592 [debug] [ThreadPool]: On list_casestudy_raw: ROLLBACK
[0m14:40:27.292282 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_raw'
[0m14:40:27.292611 [debug] [ThreadPool]: On list_casestudy_raw: Close
[0m14:40:27.295682 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy_raw, now list_casestudy_staging)
[0m14:40:27.298984 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_staging"
[0m14:40:27.299311 [debug] [ThreadPool]: On list_casestudy_staging: BEGIN
[0m14:40:27.299605 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:40:27.312840 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:40:27.313322 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_staging"
[0m14:40:27.313622 [debug] [ThreadPool]: On list_casestudy_staging: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_staging"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'staging'
    and table_catalog = 'casestudy'
  
[0m14:40:27.323857 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:40:27.325405 [debug] [ThreadPool]: On list_casestudy_staging: ROLLBACK
[0m14:40:27.325896 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_staging'
[0m14:40:27.326189 [debug] [ThreadPool]: On list_casestudy_staging: Close
[0m14:40:27.329361 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy_staging, now list_casestudy_main)
[0m14:40:27.331781 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_main"
[0m14:40:27.332139 [debug] [ThreadPool]: On list_casestudy_main: BEGIN
[0m14:40:27.332465 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:40:27.343257 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:40:27.343669 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_main"
[0m14:40:27.343986 [debug] [ThreadPool]: On list_casestudy_main: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_main"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'casestudy'
  
[0m14:40:27.352304 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:40:27.353583 [debug] [ThreadPool]: On list_casestudy_main: ROLLBACK
[0m14:40:27.354047 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_main'
[0m14:40:27.354307 [debug] [ThreadPool]: On list_casestudy_main: Close
[0m14:40:27.357273 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy_main, now list_casestudy_intermediate)
[0m14:40:27.359503 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_intermediate"
[0m14:40:27.359888 [debug] [ThreadPool]: On list_casestudy_intermediate: BEGIN
[0m14:40:27.360191 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:40:27.372936 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:40:27.373384 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_intermediate"
[0m14:40:27.373695 [debug] [ThreadPool]: On list_casestudy_intermediate: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_intermediate"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'intermediate'
    and table_catalog = 'casestudy'
  
[0m14:40:27.382989 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:40:27.384459 [debug] [ThreadPool]: On list_casestudy_intermediate: ROLLBACK
[0m14:40:27.384949 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_intermediate'
[0m14:40:27.385254 [debug] [ThreadPool]: On list_casestudy_intermediate: Close
[0m14:40:27.388943 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0910081f-7cc6-48d0-9a5f-384ad5000ffc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c65732ed0>]}
[0m14:40:27.389462 [debug] [MainThread]: Using duckdb connection "master"
[0m14:40:27.389777 [debug] [MainThread]: On master: BEGIN
[0m14:40:27.390047 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:40:27.401835 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:40:27.402245 [debug] [MainThread]: On master: COMMIT
[0m14:40:27.402523 [debug] [MainThread]: Using duckdb connection "master"
[0m14:40:27.402784 [debug] [MainThread]: On master: COMMIT
[0m14:40:27.403395 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:40:27.403719 [debug] [MainThread]: On master: Close
[0m14:40:27.406014 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:40:27.406444 [info ] [MainThread]: 
[0m14:40:27.409192 [debug] [Thread-1 (]: Began running node test.vg_casestudy.accepted_values_stg_staging_intermediate__transactions_transaction_currency__AUD__BGN__CHF__CZK__DKK__GBP__HUF__ISK__JPY__NOK__PLN__RON__SEK__TRY.93638c3051
[0m14:40:27.409593 [info ] [Thread-1 (]: 1 of 6 START test accepted_values_stg_staging_intermediate__transactions_transaction_currency__AUD__BGN__CHF__CZK__DKK__GBP__HUF__ISK__JPY__NOK__PLN__RON__SEK__TRY  [RUN]
[0m14:40:27.410463 [debug] [Thread-1 (]: Acquiring new duckdb connection 'test.vg_casestudy.accepted_values_stg_staging_intermediate__transactions_transaction_currency__AUD__BGN__CHF__CZK__DKK__GBP__HUF__ISK__JPY__NOK__PLN__RON__SEK__TRY.93638c3051'
[0m14:40:27.411079 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.accepted_values_stg_staging_intermediate__transactions_transaction_currency__AUD__BGN__CHF__CZK__DKK__GBP__HUF__ISK__JPY__NOK__PLN__RON__SEK__TRY.93638c3051
[0m14:40:27.435726 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.accepted_values_stg_staging_intermediate__transactions_transaction_currency__AUD__BGN__CHF__CZK__DKK__GBP__HUF__ISK__JPY__NOK__PLN__RON__SEK__TRY.93638c3051"
[0m14:40:27.436762 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.accepted_values_stg_staging_intermediate__transactions_transaction_currency__AUD__BGN__CHF__CZK__DKK__GBP__HUF__ISK__JPY__NOK__PLN__RON__SEK__TRY.93638c3051 (compile): 14:40:27.411305 => 14:40:27.436451
[0m14:40:27.437241 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.accepted_values_stg_staging_intermediate__transactions_transaction_currency__AUD__BGN__CHF__CZK__DKK__GBP__HUF__ISK__JPY__NOK__PLN__RON__SEK__TRY.93638c3051
[0m14:40:27.451942 [debug] [Thread-1 (]: Writing runtime sql for node "test.vg_casestudy.accepted_values_stg_staging_intermediate__transactions_transaction_currency__AUD__BGN__CHF__CZK__DKK__GBP__HUF__ISK__JPY__NOK__PLN__RON__SEK__TRY.93638c3051"
[0m14:40:27.452687 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.accepted_values_stg_staging_intermediate__transactions_transaction_currency__AUD__BGN__CHF__CZK__DKK__GBP__HUF__ISK__JPY__NOK__PLN__RON__SEK__TRY.93638c3051"
[0m14:40:27.453123 [debug] [Thread-1 (]: On test.vg_casestudy.accepted_values_stg_staging_intermediate__transactions_transaction_currency__AUD__BGN__CHF__CZK__DKK__GBP__HUF__ISK__JPY__NOK__PLN__RON__SEK__TRY.93638c3051: BEGIN
[0m14:40:27.453427 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:40:27.465087 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:40:27.465567 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.accepted_values_stg_staging_intermediate__transactions_transaction_currency__AUD__BGN__CHF__CZK__DKK__GBP__HUF__ISK__JPY__NOK__PLN__RON__SEK__TRY.93638c3051"
[0m14:40:27.465949 [debug] [Thread-1 (]: On test.vg_casestudy.accepted_values_stg_staging_intermediate__transactions_transaction_currency__AUD__BGN__CHF__CZK__DKK__GBP__HUF__ISK__JPY__NOK__PLN__RON__SEK__TRY.93638c3051: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "test.vg_casestudy.accepted_values_stg_staging_intermediate__transactions_transaction_currency__AUD__BGN__CHF__CZK__DKK__GBP__HUF__ISK__JPY__NOK__PLN__RON__SEK__TRY.93638c3051"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        transaction_currency as value_field,
        count(*) as n_records

    from "casestudy"."intermediate"."stg_staging_intermediate__transactions"
    group by transaction_currency

)

select *
from all_values
where value_field not in (
    'AUD','BGN','CHF','CZK','DKK','GBP','HUF','ISK','JPY','NOK','PLN','RON','SEK','TRY'
)



      
    ) dbt_internal_test
[0m14:40:27.480484 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:40:27.483696 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.accepted_values_stg_staging_intermediate__transactions_transaction_currency__AUD__BGN__CHF__CZK__DKK__GBP__HUF__ISK__JPY__NOK__PLN__RON__SEK__TRY.93638c3051 (execute): 14:40:27.437491 => 14:40:27.483472
[0m14:40:27.484135 [debug] [Thread-1 (]: On test.vg_casestudy.accepted_values_stg_staging_intermediate__transactions_transaction_currency__AUD__BGN__CHF__CZK__DKK__GBP__HUF__ISK__JPY__NOK__PLN__RON__SEK__TRY.93638c3051: ROLLBACK
[0m14:40:27.484654 [debug] [Thread-1 (]: Failed to rollback 'test.vg_casestudy.accepted_values_stg_staging_intermediate__transactions_transaction_currency__AUD__BGN__CHF__CZK__DKK__GBP__HUF__ISK__JPY__NOK__PLN__RON__SEK__TRY.93638c3051'
[0m14:40:27.484997 [debug] [Thread-1 (]: On test.vg_casestudy.accepted_values_stg_staging_intermediate__transactions_transaction_currency__AUD__BGN__CHF__CZK__DKK__GBP__HUF__ISK__JPY__NOK__PLN__RON__SEK__TRY.93638c3051: Close
[0m14:40:27.488162 [info ] [Thread-1 (]: 1 of 6 PASS accepted_values_stg_staging_intermediate__transactions_transaction_currency__AUD__BGN__CHF__CZK__DKK__GBP__HUF__ISK__JPY__NOK__PLN__RON__SEK__TRY  [[32mPASS[0m in 0.08s]
[0m14:40:27.488819 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.accepted_values_stg_staging_intermediate__transactions_transaction_currency__AUD__BGN__CHF__CZK__DKK__GBP__HUF__ISK__JPY__NOK__PLN__RON__SEK__TRY.93638c3051
[0m14:40:27.489254 [debug] [Thread-1 (]: Began running node test.vg_casestudy.not_null_stg_staging_intermediate__transactions_transaction_amount.8dc65a17fe
[0m14:40:27.489641 [info ] [Thread-1 (]: 2 of 6 START test not_null_stg_staging_intermediate__transactions_transaction_amount  [RUN]
[0m14:40:27.490549 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.accepted_values_stg_staging_intermediate__transactions_transaction_currency__AUD__BGN__CHF__CZK__DKK__GBP__HUF__ISK__JPY__NOK__PLN__RON__SEK__TRY.93638c3051, now test.vg_casestudy.not_null_stg_staging_intermediate__transactions_transaction_amount.8dc65a17fe)
[0m14:40:27.490915 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.not_null_stg_staging_intermediate__transactions_transaction_amount.8dc65a17fe
[0m14:40:27.498352 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.not_null_stg_staging_intermediate__transactions_transaction_amount.8dc65a17fe"
[0m14:40:27.499572 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_stg_staging_intermediate__transactions_transaction_amount.8dc65a17fe (compile): 14:40:27.491151 => 14:40:27.499197
[0m14:40:27.500174 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.not_null_stg_staging_intermediate__transactions_transaction_amount.8dc65a17fe
[0m14:40:27.504333 [debug] [Thread-1 (]: Writing runtime sql for node "test.vg_casestudy.not_null_stg_staging_intermediate__transactions_transaction_amount.8dc65a17fe"
[0m14:40:27.505283 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.not_null_stg_staging_intermediate__transactions_transaction_amount.8dc65a17fe"
[0m14:40:27.505804 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_stg_staging_intermediate__transactions_transaction_amount.8dc65a17fe: BEGIN
[0m14:40:27.506288 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:40:27.519364 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:40:27.519989 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.not_null_stg_staging_intermediate__transactions_transaction_amount.8dc65a17fe"
[0m14:40:27.520586 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_stg_staging_intermediate__transactions_transaction_amount.8dc65a17fe: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "test.vg_casestudy.not_null_stg_staging_intermediate__transactions_transaction_amount.8dc65a17fe"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select transaction_amount
from "casestudy"."intermediate"."stg_staging_intermediate__transactions"
where transaction_amount is null



      
    ) dbt_internal_test
[0m14:40:27.522055 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:40:27.523749 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_stg_staging_intermediate__transactions_transaction_amount.8dc65a17fe (execute): 14:40:27.500540 => 14:40:27.523513
[0m14:40:27.524167 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_stg_staging_intermediate__transactions_transaction_amount.8dc65a17fe: ROLLBACK
[0m14:40:27.524666 [debug] [Thread-1 (]: Failed to rollback 'test.vg_casestudy.not_null_stg_staging_intermediate__transactions_transaction_amount.8dc65a17fe'
[0m14:40:27.525076 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_stg_staging_intermediate__transactions_transaction_amount.8dc65a17fe: Close
[0m14:40:27.527895 [info ] [Thread-1 (]: 2 of 6 PASS not_null_stg_staging_intermediate__transactions_transaction_amount . [[32mPASS[0m in 0.04s]
[0m14:40:27.528601 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.not_null_stg_staging_intermediate__transactions_transaction_amount.8dc65a17fe
[0m14:40:27.529070 [debug] [Thread-1 (]: Began running node test.vg_casestudy.not_null_stg_staging_intermediate__transactions_transaction_currency.fd19959743
[0m14:40:27.529706 [info ] [Thread-1 (]: 3 of 6 START test not_null_stg_staging_intermediate__transactions_transaction_currency  [RUN]
[0m14:40:27.530527 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.not_null_stg_staging_intermediate__transactions_transaction_amount.8dc65a17fe, now test.vg_casestudy.not_null_stg_staging_intermediate__transactions_transaction_currency.fd19959743)
[0m14:40:27.530903 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.not_null_stg_staging_intermediate__transactions_transaction_currency.fd19959743
[0m14:40:27.536022 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.not_null_stg_staging_intermediate__transactions_transaction_currency.fd19959743"
[0m14:40:27.537391 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_stg_staging_intermediate__transactions_transaction_currency.fd19959743 (compile): 14:40:27.531136 => 14:40:27.536695
[0m14:40:27.538044 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.not_null_stg_staging_intermediate__transactions_transaction_currency.fd19959743
[0m14:40:27.541725 [debug] [Thread-1 (]: Writing runtime sql for node "test.vg_casestudy.not_null_stg_staging_intermediate__transactions_transaction_currency.fd19959743"
[0m14:40:27.542589 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.not_null_stg_staging_intermediate__transactions_transaction_currency.fd19959743"
[0m14:40:27.543161 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_stg_staging_intermediate__transactions_transaction_currency.fd19959743: BEGIN
[0m14:40:27.543602 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:40:27.559584 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:40:27.560119 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.not_null_stg_staging_intermediate__transactions_transaction_currency.fd19959743"
[0m14:40:27.560551 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_stg_staging_intermediate__transactions_transaction_currency.fd19959743: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "test.vg_casestudy.not_null_stg_staging_intermediate__transactions_transaction_currency.fd19959743"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select transaction_currency
from "casestudy"."intermediate"."stg_staging_intermediate__transactions"
where transaction_currency is null



      
    ) dbt_internal_test
[0m14:40:27.561981 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:40:27.563684 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_stg_staging_intermediate__transactions_transaction_currency.fd19959743 (execute): 14:40:27.538346 => 14:40:27.563448
[0m14:40:27.564096 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_stg_staging_intermediate__transactions_transaction_currency.fd19959743: ROLLBACK
[0m14:40:27.564586 [debug] [Thread-1 (]: Failed to rollback 'test.vg_casestudy.not_null_stg_staging_intermediate__transactions_transaction_currency.fd19959743'
[0m14:40:27.564948 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_stg_staging_intermediate__transactions_transaction_currency.fd19959743: Close
[0m14:40:27.567688 [info ] [Thread-1 (]: 3 of 6 PASS not_null_stg_staging_intermediate__transactions_transaction_currency  [[32mPASS[0m in 0.04s]
[0m14:40:27.568555 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.not_null_stg_staging_intermediate__transactions_transaction_currency.fd19959743
[0m14:40:27.569187 [debug] [Thread-1 (]: Began running node test.vg_casestudy.not_null_stg_staging_intermediate__transactions_transaction_id.cb7402fe02
[0m14:40:27.569904 [info ] [Thread-1 (]: 4 of 6 START test not_null_stg_staging_intermediate__transactions_transaction_id  [RUN]
[0m14:40:27.570742 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.not_null_stg_staging_intermediate__transactions_transaction_currency.fd19959743, now test.vg_casestudy.not_null_stg_staging_intermediate__transactions_transaction_id.cb7402fe02)
[0m14:40:27.571175 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.not_null_stg_staging_intermediate__transactions_transaction_id.cb7402fe02
[0m14:40:27.576414 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.not_null_stg_staging_intermediate__transactions_transaction_id.cb7402fe02"
[0m14:40:27.577465 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_stg_staging_intermediate__transactions_transaction_id.cb7402fe02 (compile): 14:40:27.571452 => 14:40:27.577179
[0m14:40:27.577900 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.not_null_stg_staging_intermediate__transactions_transaction_id.cb7402fe02
[0m14:40:27.580823 [debug] [Thread-1 (]: Writing runtime sql for node "test.vg_casestudy.not_null_stg_staging_intermediate__transactions_transaction_id.cb7402fe02"
[0m14:40:27.581573 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.not_null_stg_staging_intermediate__transactions_transaction_id.cb7402fe02"
[0m14:40:27.582006 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_stg_staging_intermediate__transactions_transaction_id.cb7402fe02: BEGIN
[0m14:40:27.582361 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:40:27.598074 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:40:27.598582 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.not_null_stg_staging_intermediate__transactions_transaction_id.cb7402fe02"
[0m14:40:27.598958 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_stg_staging_intermediate__transactions_transaction_id.cb7402fe02: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "test.vg_casestudy.not_null_stg_staging_intermediate__transactions_transaction_id.cb7402fe02"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select transaction_id
from "casestudy"."intermediate"."stg_staging_intermediate__transactions"
where transaction_id is null



      
    ) dbt_internal_test
[0m14:40:27.600270 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:40:27.601998 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_stg_staging_intermediate__transactions_transaction_id.cb7402fe02 (execute): 14:40:27.578142 => 14:40:27.601771
[0m14:40:27.602655 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_stg_staging_intermediate__transactions_transaction_id.cb7402fe02: ROLLBACK
[0m14:40:27.603245 [debug] [Thread-1 (]: Failed to rollback 'test.vg_casestudy.not_null_stg_staging_intermediate__transactions_transaction_id.cb7402fe02'
[0m14:40:27.603591 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_stg_staging_intermediate__transactions_transaction_id.cb7402fe02: Close
[0m14:40:27.606732 [info ] [Thread-1 (]: 4 of 6 PASS not_null_stg_staging_intermediate__transactions_transaction_id ..... [[32mPASS[0m in 0.04s]
[0m14:40:27.607689 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.not_null_stg_staging_intermediate__transactions_transaction_id.cb7402fe02
[0m14:40:27.608354 [debug] [Thread-1 (]: Began running node test.vg_casestudy.numeric_range_stg_staging_intermediate__transactions_transaction_amount__0.789e7a4361
[0m14:40:27.609066 [info ] [Thread-1 (]: 5 of 6 START test numeric_range_stg_staging_intermediate__transactions_transaction_amount__0  [RUN]
[0m14:40:27.610070 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.not_null_stg_staging_intermediate__transactions_transaction_id.cb7402fe02, now test.vg_casestudy.numeric_range_stg_staging_intermediate__transactions_transaction_amount__0.789e7a4361)
[0m14:40:27.611034 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.numeric_range_stg_staging_intermediate__transactions_transaction_amount__0.789e7a4361
[0m14:40:27.621368 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.numeric_range_stg_staging_intermediate__transactions_transaction_amount__0.789e7a4361"
[0m14:40:27.622473 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.numeric_range_stg_staging_intermediate__transactions_transaction_amount__0.789e7a4361 (compile): 14:40:27.611505 => 14:40:27.622092
[0m14:40:27.623162 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.numeric_range_stg_staging_intermediate__transactions_transaction_amount__0.789e7a4361
[0m14:40:27.626868 [debug] [Thread-1 (]: Writing runtime sql for node "test.vg_casestudy.numeric_range_stg_staging_intermediate__transactions_transaction_amount__0.789e7a4361"
[0m14:40:27.627575 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.numeric_range_stg_staging_intermediate__transactions_transaction_amount__0.789e7a4361"
[0m14:40:27.628024 [debug] [Thread-1 (]: On test.vg_casestudy.numeric_range_stg_staging_intermediate__transactions_transaction_amount__0.789e7a4361: BEGIN
[0m14:40:27.628431 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:40:27.643664 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:40:27.644149 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.numeric_range_stg_staging_intermediate__transactions_transaction_amount__0.789e7a4361"
[0m14:40:27.644538 [debug] [Thread-1 (]: On test.vg_casestudy.numeric_range_stg_staging_intermediate__transactions_transaction_amount__0.789e7a4361: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "test.vg_casestudy.numeric_range_stg_staging_intermediate__transactions_transaction_amount__0.789e7a4361"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

    
        select *
        from "casestudy"."intermediate"."stg_staging_intermediate__transactions"
        where transaction_amount < 0
    
    


      
    ) dbt_internal_test
[0m14:40:27.645917 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:40:27.649694 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.numeric_range_stg_staging_intermediate__transactions_transaction_amount__0.789e7a4361 (execute): 14:40:27.623580 => 14:40:27.649444
[0m14:40:27.650129 [debug] [Thread-1 (]: On test.vg_casestudy.numeric_range_stg_staging_intermediate__transactions_transaction_amount__0.789e7a4361: ROLLBACK
[0m14:40:27.650688 [debug] [Thread-1 (]: Failed to rollback 'test.vg_casestudy.numeric_range_stg_staging_intermediate__transactions_transaction_amount__0.789e7a4361'
[0m14:40:27.651024 [debug] [Thread-1 (]: On test.vg_casestudy.numeric_range_stg_staging_intermediate__transactions_transaction_amount__0.789e7a4361: Close
[0m14:40:27.653574 [info ] [Thread-1 (]: 5 of 6 PASS numeric_range_stg_staging_intermediate__transactions_transaction_amount__0  [[32mPASS[0m in 0.04s]
[0m14:40:27.654258 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.numeric_range_stg_staging_intermediate__transactions_transaction_amount__0.789e7a4361
[0m14:40:27.654715 [debug] [Thread-1 (]: Began running node test.vg_casestudy.unique_stg_staging_intermediate__transactions_transaction_id.dbfd7b9b66
[0m14:40:27.655279 [info ] [Thread-1 (]: 6 of 6 START test unique_stg_staging_intermediate__transactions_transaction_id . [RUN]
[0m14:40:27.656032 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.numeric_range_stg_staging_intermediate__transactions_transaction_amount__0.789e7a4361, now test.vg_casestudy.unique_stg_staging_intermediate__transactions_transaction_id.dbfd7b9b66)
[0m14:40:27.656387 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.unique_stg_staging_intermediate__transactions_transaction_id.dbfd7b9b66
[0m14:40:27.663035 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.unique_stg_staging_intermediate__transactions_transaction_id.dbfd7b9b66"
[0m14:40:27.663898 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.unique_stg_staging_intermediate__transactions_transaction_id.dbfd7b9b66 (compile): 14:40:27.656612 => 14:40:27.663599
[0m14:40:27.664465 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.unique_stg_staging_intermediate__transactions_transaction_id.dbfd7b9b66
[0m14:40:27.667364 [debug] [Thread-1 (]: Writing runtime sql for node "test.vg_casestudy.unique_stg_staging_intermediate__transactions_transaction_id.dbfd7b9b66"
[0m14:40:27.668135 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.unique_stg_staging_intermediate__transactions_transaction_id.dbfd7b9b66"
[0m14:40:27.668875 [debug] [Thread-1 (]: On test.vg_casestudy.unique_stg_staging_intermediate__transactions_transaction_id.dbfd7b9b66: BEGIN
[0m14:40:27.669673 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:40:27.683099 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:40:27.683587 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.unique_stg_staging_intermediate__transactions_transaction_id.dbfd7b9b66"
[0m14:40:27.683986 [debug] [Thread-1 (]: On test.vg_casestudy.unique_stg_staging_intermediate__transactions_transaction_id.dbfd7b9b66: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "test.vg_casestudy.unique_stg_staging_intermediate__transactions_transaction_id.dbfd7b9b66"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    transaction_id as unique_field,
    count(*) as n_records

from "casestudy"."intermediate"."stg_staging_intermediate__transactions"
where transaction_id is not null
group by transaction_id
having count(*) > 1



      
    ) dbt_internal_test
[0m14:40:27.694928 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:40:27.696791 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.unique_stg_staging_intermediate__transactions_transaction_id.dbfd7b9b66 (execute): 14:40:27.664824 => 14:40:27.696541
[0m14:40:27.697254 [debug] [Thread-1 (]: On test.vg_casestudy.unique_stg_staging_intermediate__transactions_transaction_id.dbfd7b9b66: ROLLBACK
[0m14:40:27.697728 [debug] [Thread-1 (]: Failed to rollback 'test.vg_casestudy.unique_stg_staging_intermediate__transactions_transaction_id.dbfd7b9b66'
[0m14:40:27.698120 [debug] [Thread-1 (]: On test.vg_casestudy.unique_stg_staging_intermediate__transactions_transaction_id.dbfd7b9b66: Close
[0m14:40:27.702017 [info ] [Thread-1 (]: 6 of 6 PASS unique_stg_staging_intermediate__transactions_transaction_id ....... [[32mPASS[0m in 0.05s]
[0m14:40:27.702728 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.unique_stg_staging_intermediate__transactions_transaction_id.dbfd7b9b66
[0m14:40:27.704702 [debug] [MainThread]: Using duckdb connection "master"
[0m14:40:27.705048 [debug] [MainThread]: On master: BEGIN
[0m14:40:27.705324 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:40:27.718449 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:40:27.718949 [debug] [MainThread]: On master: COMMIT
[0m14:40:27.719369 [debug] [MainThread]: Using duckdb connection "master"
[0m14:40:27.719684 [debug] [MainThread]: On master: COMMIT
[0m14:40:27.720494 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:40:27.720955 [debug] [MainThread]: On master: Close
[0m14:40:27.723739 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:40:27.724333 [debug] [MainThread]: Connection 'list_casestudy_intermediate' was properly closed.
[0m14:40:27.724662 [debug] [MainThread]: Connection 'test.vg_casestudy.unique_stg_staging_intermediate__transactions_transaction_id.dbfd7b9b66' was properly closed.
[0m14:40:27.725041 [info ] [MainThread]: 
[0m14:40:27.725507 [info ] [MainThread]: Finished running 6 tests in 0 hours 0 minutes and 0.48 seconds (0.48s).
[0m14:40:27.726707 [debug] [MainThread]: Command end result
[0m14:40:27.747699 [info ] [MainThread]: 
[0m14:40:27.748194 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:40:27.748550 [info ] [MainThread]: 
[0m14:40:27.748892 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m14:40:27.749373 [debug] [MainThread]: Command `dbt test` succeeded at 14:40:27.749276 after 0.78 seconds
[0m14:40:27.749728 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c6e5818d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c6997e350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c6b3e2f50>]}
[0m14:40:27.750098 [debug] [MainThread]: Flushing usage events
[0m14:45:31.923801 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9c1002c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9c0e7e950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9c12eba90>]}


============================== 14:45:31.929724 | 41f7ef0f-e0b0-4dce-886d-e17fa66f0951 ==============================
[0m14:45:31.929724 [info ] [MainThread]: Running with dbt=1.6.18
[0m14:45:31.930344 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/workspaces/vg_case_study_tim/transformation', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/workspaces/vg_case_study_tim/transformation/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select core__transactions_with_euro', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:45:32.129320 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '41f7ef0f-e0b0-4dce-886d-e17fa66f0951', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9c0b8f590>]}
[0m14:45:32.144291 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '41f7ef0f-e0b0-4dce-886d-e17fa66f0951', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9c1281150>]}
[0m14:45:32.145825 [info ] [MainThread]: Registered adapter: duckdb=1.6.2
[0m14:45:32.176911 [debug] [MainThread]: checksum: 7b9fab86a08e9e96a48a825af743c566d95b877e068b8c6d0dbafbf714447189, vars: {}, profile: , target: , version: 1.6.18
[0m14:45:32.271619 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 0 files changed.
[0m14:45:32.272378 [debug] [MainThread]: Partial parsing: added file: vg_casestudy://models/core/core__transactions_with_euro.sql
[0m14:45:32.272716 [debug] [MainThread]: Partial parsing: deleted file: vg_casestudy://models/core/core__transactions_with_eur.sql
[0m14:45:32.323631 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.vg_casestudy.main
- models.vg_casestudy.marts
- models.vg_casestudy.reporting
[0m14:45:32.373067 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '41f7ef0f-e0b0-4dce-886d-e17fa66f0951', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9c0b824d0>]}
[0m14:45:32.398942 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '41f7ef0f-e0b0-4dce-886d-e17fa66f0951', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9bd574290>]}
[0m14:45:32.399556 [info ] [MainThread]: Found 13 models, 1 analysis, 3 seeds, 80 tests, 5 sources, 0 exposures, 0 metrics, 632 macros, 0 groups, 0 semantic models
[0m14:45:32.399997 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '41f7ef0f-e0b0-4dce-886d-e17fa66f0951', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9c134a550>]}
[0m14:45:32.402315 [info ] [MainThread]: 
[0m14:45:32.403108 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:45:32.404249 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_casestudy'
[0m14:45:32.417401 [debug] [ThreadPool]: Using duckdb connection "list_casestudy"
[0m14:45:32.417869 [debug] [ThreadPool]: On list_casestudy: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"casestudy"'
    
  
  
[0m14:45:32.418183 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:45:32.544477 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:45:32.545912 [debug] [ThreadPool]: On list_casestudy: Close
[0m14:45:32.550119 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy, now create_casestudy_main)
[0m14:45:32.551002 [debug] [ThreadPool]: Creating schema "database: "casestudy"
schema: "main"
"
[0m14:45:32.555657 [debug] [ThreadPool]: Using duckdb connection "create_casestudy_main"
[0m14:45:32.556053 [debug] [ThreadPool]: On create_casestudy_main: BEGIN
[0m14:45:32.556344 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:45:32.569176 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:45:32.569609 [debug] [ThreadPool]: Using duckdb connection "create_casestudy_main"
[0m14:45:32.569907 [debug] [ThreadPool]: On create_casestudy_main: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "create_casestudy_main"} */
create schema if not exists "casestudy"."main"
[0m14:45:32.570724 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:45:32.571835 [debug] [ThreadPool]: On create_casestudy_main: COMMIT
[0m14:45:32.572273 [debug] [ThreadPool]: Using duckdb connection "create_casestudy_main"
[0m14:45:32.572630 [debug] [ThreadPool]: On create_casestudy_main: COMMIT
[0m14:45:32.573317 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:45:32.573646 [debug] [ThreadPool]: On create_casestudy_main: Close
[0m14:45:32.578102 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_casestudy_main, now list_casestudy_raw)
[0m14:45:32.583766 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_raw"
[0m14:45:32.584163 [debug] [ThreadPool]: On list_casestudy_raw: BEGIN
[0m14:45:32.584468 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:45:32.595886 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:45:32.596289 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_raw"
[0m14:45:32.596611 [debug] [ThreadPool]: On list_casestudy_raw: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_raw"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'raw'
    and table_catalog = 'casestudy'
  
[0m14:45:32.611779 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:45:32.613644 [debug] [ThreadPool]: On list_casestudy_raw: ROLLBACK
[0m14:45:32.615158 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_raw'
[0m14:45:32.615475 [debug] [ThreadPool]: On list_casestudy_raw: Close
[0m14:45:32.619494 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy_raw, now list_casestudy_main)
[0m14:45:32.621709 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_main"
[0m14:45:32.622065 [debug] [ThreadPool]: On list_casestudy_main: BEGIN
[0m14:45:32.622376 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:45:32.632972 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:45:32.633453 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_main"
[0m14:45:32.633749 [debug] [ThreadPool]: On list_casestudy_main: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_main"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'casestudy'
  
[0m14:45:32.641738 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:45:32.643365 [debug] [ThreadPool]: On list_casestudy_main: ROLLBACK
[0m14:45:32.643991 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_main'
[0m14:45:32.644444 [debug] [ThreadPool]: On list_casestudy_main: Close
[0m14:45:32.647556 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy_main, now list_casestudy_staging)
[0m14:45:32.650135 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_staging"
[0m14:45:32.650471 [debug] [ThreadPool]: On list_casestudy_staging: BEGIN
[0m14:45:32.650740 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:45:32.661058 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:45:32.661452 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_staging"
[0m14:45:32.661759 [debug] [ThreadPool]: On list_casestudy_staging: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_staging"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'staging'
    and table_catalog = 'casestudy'
  
[0m14:45:32.669928 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:45:32.671249 [debug] [ThreadPool]: On list_casestudy_staging: ROLLBACK
[0m14:45:32.671709 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_staging'
[0m14:45:32.671972 [debug] [ThreadPool]: On list_casestudy_staging: Close
[0m14:45:32.674905 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy_staging, now list_casestudy_intermediate)
[0m14:45:32.678706 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_intermediate"
[0m14:45:32.679173 [debug] [ThreadPool]: On list_casestudy_intermediate: BEGIN
[0m14:45:32.679503 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:45:32.690416 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:45:32.690843 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_intermediate"
[0m14:45:32.691182 [debug] [ThreadPool]: On list_casestudy_intermediate: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_intermediate"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'intermediate'
    and table_catalog = 'casestudy'
  
[0m14:45:32.699233 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:45:32.700820 [debug] [ThreadPool]: On list_casestudy_intermediate: ROLLBACK
[0m14:45:32.701284 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_intermediate'
[0m14:45:32.701551 [debug] [ThreadPool]: On list_casestudy_intermediate: Close
[0m14:45:32.705335 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '41f7ef0f-e0b0-4dce-886d-e17fa66f0951', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9c1003a90>]}
[0m14:45:32.705811 [debug] [MainThread]: Using duckdb connection "master"
[0m14:45:32.706119 [debug] [MainThread]: On master: BEGIN
[0m14:45:32.706412 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:45:32.719505 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:45:32.719926 [debug] [MainThread]: On master: COMMIT
[0m14:45:32.720232 [debug] [MainThread]: Using duckdb connection "master"
[0m14:45:32.720499 [debug] [MainThread]: On master: COMMIT
[0m14:45:32.720979 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:45:32.721295 [debug] [MainThread]: On master: Close
[0m14:45:32.724311 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:45:32.724781 [info ] [MainThread]: 
[0m14:45:32.731033 [debug] [Thread-1 (]: Began running node model.vg_casestudy.core__transactions_with_euro
[0m14:45:32.731642 [info ] [Thread-1 (]: 1 of 1 START sql view model main.core__transactions_with_euro .................. [RUN]
[0m14:45:32.732631 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.vg_casestudy.core__transactions_with_euro'
[0m14:45:32.733123 [debug] [Thread-1 (]: Began compiling node model.vg_casestudy.core__transactions_with_euro
[0m14:45:32.742734 [debug] [Thread-1 (]: Writing injected SQL for node "model.vg_casestudy.core__transactions_with_euro"
[0m14:45:32.744279 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.core__transactions_with_euro (compile): 14:45:32.733433 => 14:45:32.744027
[0m14:45:32.744710 [debug] [Thread-1 (]: Began executing node model.vg_casestudy.core__transactions_with_euro
[0m14:45:32.776777 [debug] [Thread-1 (]: Writing runtime sql for node "model.vg_casestudy.core__transactions_with_euro"
[0m14:45:32.778426 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.core__transactions_with_euro"
[0m14:45:32.778794 [debug] [Thread-1 (]: On model.vg_casestudy.core__transactions_with_euro: BEGIN
[0m14:45:32.779095 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:45:32.795386 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:45:32.796017 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.core__transactions_with_euro"
[0m14:45:32.796508 [debug] [Thread-1 (]: On model.vg_casestudy.core__transactions_with_euro: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.core__transactions_with_euro"} */

  
  create view "casestudy"."main"."core__transactions_with_euro__dbt_tmp" as (
    with transactions as (
    select *
    from "casestudy"."intermediate"."stg_staging_intermediate__transactions"
),

fx_rates_filled as (
    select *
    from "casestudy"."intermediate"."stg_staging_intermediate_fx_rates_filled"
),

joined as (
    select 
        transactions.transaction_id,
        transactions.transaction_date,
        transactions.account_id,
        transactions.transaction_type,
        transactions.transaction_amount,
        transactions.transaction_currency,
        fx_rates_filled.fx_rate,
        transactions.transaction_amount / nullif(coalesce(fx_rates_filled.fx_rate, 1.0),0) as transaction_amount_euro
    from transactions
    left join fx_rates_filled
    on transactions.transaction_currency = fx_rates_filled.currency_iso_code
    and transactions.transaction_date = fx_rates_filled.fx_rate_date
)

select *
from joined
  );

[0m14:45:32.801607 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:45:32.810686 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.core__transactions_with_euro"
[0m14:45:32.811236 [debug] [Thread-1 (]: On model.vg_casestudy.core__transactions_with_euro: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.core__transactions_with_euro"} */
alter view "casestudy"."main"."core__transactions_with_euro__dbt_tmp" rename to "core__transactions_with_euro"
[0m14:45:32.812667 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:45:32.828830 [debug] [Thread-1 (]: On model.vg_casestudy.core__transactions_with_euro: COMMIT
[0m14:45:32.829407 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.core__transactions_with_euro"
[0m14:45:32.829851 [debug] [Thread-1 (]: On model.vg_casestudy.core__transactions_with_euro: COMMIT
[0m14:45:32.837738 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:45:32.843722 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.core__transactions_with_euro"
[0m14:45:32.844290 [debug] [Thread-1 (]: On model.vg_casestudy.core__transactions_with_euro: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.core__transactions_with_euro"} */
drop view if exists "casestudy"."main"."core__transactions_with_euro__dbt_backup" cascade
[0m14:45:32.845345 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:45:32.847366 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.core__transactions_with_euro (execute): 14:45:32.744953 => 14:45:32.847178
[0m14:45:32.847830 [debug] [Thread-1 (]: On model.vg_casestudy.core__transactions_with_euro: Close
[0m14:45:32.882906 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '41f7ef0f-e0b0-4dce-886d-e17fa66f0951', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9bcb9efd0>]}
[0m14:45:32.884208 [info ] [Thread-1 (]: 1 of 1 OK created sql view model main.core__transactions_with_euro ............. [[32mOK[0m in 0.15s]
[0m14:45:32.884923 [debug] [Thread-1 (]: Finished running node model.vg_casestudy.core__transactions_with_euro
[0m14:45:32.887556 [debug] [MainThread]: Using duckdb connection "master"
[0m14:45:32.887942 [debug] [MainThread]: On master: BEGIN
[0m14:45:32.888288 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:45:32.912054 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:45:32.912683 [debug] [MainThread]: On master: COMMIT
[0m14:45:32.913091 [debug] [MainThread]: Using duckdb connection "master"
[0m14:45:32.913438 [debug] [MainThread]: On master: COMMIT
[0m14:45:32.914235 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:45:32.914673 [debug] [MainThread]: On master: Close
[0m14:45:32.918286 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:45:32.918859 [debug] [MainThread]: Connection 'list_casestudy_intermediate' was properly closed.
[0m14:45:32.919243 [debug] [MainThread]: Connection 'model.vg_casestudy.core__transactions_with_euro' was properly closed.
[0m14:45:32.919789 [info ] [MainThread]: 
[0m14:45:32.920329 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.52 seconds (0.52s).
[0m14:45:32.921139 [debug] [MainThread]: Command end result
[0m14:45:32.946137 [info ] [MainThread]: 
[0m14:45:32.946891 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:45:32.947397 [info ] [MainThread]: 
[0m14:45:32.947801 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m14:45:32.948562 [debug] [MainThread]: Command `dbt run` succeeded at 14:45:32.948406 after 1.04 seconds
[0m14:45:32.949134 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9c59bb410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9c59ba1d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9c0d43b90>]}
[0m14:45:32.949629 [debug] [MainThread]: Flushing usage events
[0m14:48:18.624014 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f766ec5b710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f766eaad510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f766edc5110>]}


============================== 14:48:18.629464 | dcfce918-0401-4fb5-b1d7-8e9a5a339175 ==============================
[0m14:48:18.629464 [info ] [MainThread]: Running with dbt=1.6.18
[0m14:48:18.630064 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/workspaces/vg_case_study_tim/transformation/logs', 'fail_fast': 'False', 'profiles_dir': '/workspaces/vg_case_study_tim/transformation', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test --select core__transactions_with_euro', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:48:18.853614 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dcfce918-0401-4fb5-b1d7-8e9a5a339175', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f766ed83a10>]}
[0m14:48:18.869244 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'dcfce918-0401-4fb5-b1d7-8e9a5a339175', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f766ed18dd0>]}
[0m14:48:18.870947 [info ] [MainThread]: Registered adapter: duckdb=1.6.2
[0m14:48:18.899099 [debug] [MainThread]: checksum: 7b9fab86a08e9e96a48a825af743c566d95b877e068b8c6d0dbafbf714447189, vars: {}, profile: , target: , version: 1.6.18
[0m14:48:18.993531 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m14:48:18.994343 [debug] [MainThread]: Partial parsing: added file: vg_casestudy://models/core/core__transactions_with_euro.yml
[0m14:48:19.130117 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.vg_casestudy.main
- models.vg_casestudy.reporting
- models.vg_casestudy.marts
[0m14:48:19.137237 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dcfce918-0401-4fb5-b1d7-8e9a5a339175', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f766e6ba510>]}
[0m14:48:19.167221 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dcfce918-0401-4fb5-b1d7-8e9a5a339175', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f766e6a1150>]}
[0m14:48:19.167772 [info ] [MainThread]: Found 13 models, 1 analysis, 3 seeds, 88 tests, 5 sources, 0 exposures, 0 metrics, 632 macros, 0 groups, 0 semantic models
[0m14:48:19.168152 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dcfce918-0401-4fb5-b1d7-8e9a5a339175', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f766a420090>]}
[0m14:48:19.170880 [info ] [MainThread]: 
[0m14:48:19.171657 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:48:19.174386 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_casestudy_raw'
[0m14:48:19.186131 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_raw"
[0m14:48:19.186776 [debug] [ThreadPool]: On list_casestudy_raw: BEGIN
[0m14:48:19.187132 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:48:19.318016 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:48:19.318562 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_raw"
[0m14:48:19.318956 [debug] [ThreadPool]: On list_casestudy_raw: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_raw"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'raw'
    and table_catalog = 'casestudy'
  
[0m14:48:19.339804 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:48:19.341474 [debug] [ThreadPool]: On list_casestudy_raw: ROLLBACK
[0m14:48:19.342812 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_raw'
[0m14:48:19.343153 [debug] [ThreadPool]: On list_casestudy_raw: Close
[0m14:48:19.347705 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy_raw, now list_casestudy_staging)
[0m14:48:19.351333 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_staging"
[0m14:48:19.351722 [debug] [ThreadPool]: On list_casestudy_staging: BEGIN
[0m14:48:19.351998 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:48:19.363372 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:48:19.363925 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_staging"
[0m14:48:19.364268 [debug] [ThreadPool]: On list_casestudy_staging: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_staging"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'staging'
    and table_catalog = 'casestudy'
  
[0m14:48:19.372942 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:48:19.374498 [debug] [ThreadPool]: On list_casestudy_staging: ROLLBACK
[0m14:48:19.375000 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_staging'
[0m14:48:19.375315 [debug] [ThreadPool]: On list_casestudy_staging: Close
[0m14:48:19.379855 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy_staging, now list_casestudy_intermediate)
[0m14:48:19.382158 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_intermediate"
[0m14:48:19.383567 [debug] [ThreadPool]: On list_casestudy_intermediate: BEGIN
[0m14:48:19.383874 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:48:19.394883 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:48:19.395306 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_intermediate"
[0m14:48:19.395634 [debug] [ThreadPool]: On list_casestudy_intermediate: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_intermediate"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'intermediate'
    and table_catalog = 'casestudy'
  
[0m14:48:19.404166 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:48:19.405725 [debug] [ThreadPool]: On list_casestudy_intermediate: ROLLBACK
[0m14:48:19.406239 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_intermediate'
[0m14:48:19.406554 [debug] [ThreadPool]: On list_casestudy_intermediate: Close
[0m14:48:19.409746 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy_intermediate, now list_casestudy_main)
[0m14:48:19.411955 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_main"
[0m14:48:19.412349 [debug] [ThreadPool]: On list_casestudy_main: BEGIN
[0m14:48:19.412650 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:48:19.423620 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:48:19.424051 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_main"
[0m14:48:19.424375 [debug] [ThreadPool]: On list_casestudy_main: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_main"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'casestudy'
  
[0m14:48:19.432790 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:48:19.434169 [debug] [ThreadPool]: On list_casestudy_main: ROLLBACK
[0m14:48:19.434670 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_main'
[0m14:48:19.434981 [debug] [ThreadPool]: On list_casestudy_main: Close
[0m14:48:19.438698 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dcfce918-0401-4fb5-b1d7-8e9a5a339175', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f766ec8b1d0>]}
[0m14:48:19.439233 [debug] [MainThread]: Using duckdb connection "master"
[0m14:48:19.439540 [debug] [MainThread]: On master: BEGIN
[0m14:48:19.439821 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:48:19.454359 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:48:19.454804 [debug] [MainThread]: On master: COMMIT
[0m14:48:19.455098 [debug] [MainThread]: Using duckdb connection "master"
[0m14:48:19.455367 [debug] [MainThread]: On master: COMMIT
[0m14:48:19.456005 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:48:19.456355 [debug] [MainThread]: On master: Close
[0m14:48:19.458981 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:48:19.459458 [info ] [MainThread]: 
[0m14:48:19.464703 [debug] [Thread-1 (]: Began running node test.vg_casestudy.not_null_core__transactions_with_euro_account_id.2c4215ab21
[0m14:48:19.465162 [info ] [Thread-1 (]: 1 of 8 START test not_null_core__transactions_with_euro_account_id ............. [RUN]
[0m14:48:19.465967 [debug] [Thread-1 (]: Acquiring new duckdb connection 'test.vg_casestudy.not_null_core__transactions_with_euro_account_id.2c4215ab21'
[0m14:48:19.466320 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.not_null_core__transactions_with_euro_account_id.2c4215ab21
[0m14:48:19.482618 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.not_null_core__transactions_with_euro_account_id.2c4215ab21"
[0m14:48:19.484246 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_core__transactions_with_euro_account_id.2c4215ab21 (compile): 14:48:19.466546 => 14:48:19.483957
[0m14:48:19.484732 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.not_null_core__transactions_with_euro_account_id.2c4215ab21
[0m14:48:19.499428 [debug] [Thread-1 (]: Writing runtime sql for node "test.vg_casestudy.not_null_core__transactions_with_euro_account_id.2c4215ab21"
[0m14:48:19.500959 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.not_null_core__transactions_with_euro_account_id.2c4215ab21"
[0m14:48:19.501379 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_core__transactions_with_euro_account_id.2c4215ab21: BEGIN
[0m14:48:19.501702 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:48:19.518513 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:48:19.518989 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.not_null_core__transactions_with_euro_account_id.2c4215ab21"
[0m14:48:19.519348 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_core__transactions_with_euro_account_id.2c4215ab21: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "test.vg_casestudy.not_null_core__transactions_with_euro_account_id.2c4215ab21"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select account_id
from "casestudy"."main"."core__transactions_with_euro"
where account_id is null



      
    ) dbt_internal_test
[0m14:48:19.534507 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:48:19.537977 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_core__transactions_with_euro_account_id.2c4215ab21 (execute): 14:48:19.485046 => 14:48:19.537739
[0m14:48:19.538488 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_core__transactions_with_euro_account_id.2c4215ab21: ROLLBACK
[0m14:48:19.539072 [debug] [Thread-1 (]: Failed to rollback 'test.vg_casestudy.not_null_core__transactions_with_euro_account_id.2c4215ab21'
[0m14:48:19.539465 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_core__transactions_with_euro_account_id.2c4215ab21: Close
[0m14:48:19.542335 [info ] [Thread-1 (]: 1 of 8 PASS not_null_core__transactions_with_euro_account_id ................... [[32mPASS[0m in 0.08s]
[0m14:48:19.543039 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.not_null_core__transactions_with_euro_account_id.2c4215ab21
[0m14:48:19.543583 [debug] [Thread-1 (]: Began running node test.vg_casestudy.not_null_core__transactions_with_euro_transaction_amount.7130175b19
[0m14:48:19.544208 [info ] [Thread-1 (]: 2 of 8 START test not_null_core__transactions_with_euro_transaction_amount ..... [RUN]
[0m14:48:19.544945 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.not_null_core__transactions_with_euro_account_id.2c4215ab21, now test.vg_casestudy.not_null_core__transactions_with_euro_transaction_amount.7130175b19)
[0m14:48:19.545291 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.not_null_core__transactions_with_euro_transaction_amount.7130175b19
[0m14:48:19.549531 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.not_null_core__transactions_with_euro_transaction_amount.7130175b19"
[0m14:48:19.550294 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_core__transactions_with_euro_transaction_amount.7130175b19 (compile): 14:48:19.545522 => 14:48:19.550048
[0m14:48:19.550682 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.not_null_core__transactions_with_euro_transaction_amount.7130175b19
[0m14:48:19.555237 [debug] [Thread-1 (]: Writing runtime sql for node "test.vg_casestudy.not_null_core__transactions_with_euro_transaction_amount.7130175b19"
[0m14:48:19.555988 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.not_null_core__transactions_with_euro_transaction_amount.7130175b19"
[0m14:48:19.556379 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_core__transactions_with_euro_transaction_amount.7130175b19: BEGIN
[0m14:48:19.556727 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:48:19.570219 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:48:19.570711 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.not_null_core__transactions_with_euro_transaction_amount.7130175b19"
[0m14:48:19.571086 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_core__transactions_with_euro_transaction_amount.7130175b19: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "test.vg_casestudy.not_null_core__transactions_with_euro_transaction_amount.7130175b19"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select transaction_amount
from "casestudy"."main"."core__transactions_with_euro"
where transaction_amount is null



      
    ) dbt_internal_test
[0m14:48:19.575564 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:48:19.577436 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_core__transactions_with_euro_transaction_amount.7130175b19 (execute): 14:48:19.550967 => 14:48:19.577204
[0m14:48:19.577887 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_core__transactions_with_euro_transaction_amount.7130175b19: ROLLBACK
[0m14:48:19.578378 [debug] [Thread-1 (]: Failed to rollback 'test.vg_casestudy.not_null_core__transactions_with_euro_transaction_amount.7130175b19'
[0m14:48:19.578722 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_core__transactions_with_euro_transaction_amount.7130175b19: Close
[0m14:48:19.581383 [info ] [Thread-1 (]: 2 of 8 PASS not_null_core__transactions_with_euro_transaction_amount ........... [[32mPASS[0m in 0.04s]
[0m14:48:19.582116 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.not_null_core__transactions_with_euro_transaction_amount.7130175b19
[0m14:48:19.582751 [debug] [Thread-1 (]: Began running node test.vg_casestudy.not_null_core__transactions_with_euro_transaction_amount_euro.d6c3b5cd24
[0m14:48:19.583302 [info ] [Thread-1 (]: 3 of 8 START test not_null_core__transactions_with_euro_transaction_amount_euro  [RUN]
[0m14:48:19.584441 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.not_null_core__transactions_with_euro_transaction_amount.7130175b19, now test.vg_casestudy.not_null_core__transactions_with_euro_transaction_amount_euro.d6c3b5cd24)
[0m14:48:19.584829 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.not_null_core__transactions_with_euro_transaction_amount_euro.d6c3b5cd24
[0m14:48:19.589192 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.not_null_core__transactions_with_euro_transaction_amount_euro.d6c3b5cd24"
[0m14:48:19.590562 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_core__transactions_with_euro_transaction_amount_euro.d6c3b5cd24 (compile): 14:48:19.585061 => 14:48:19.589739
[0m14:48:19.591395 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.not_null_core__transactions_with_euro_transaction_amount_euro.d6c3b5cd24
[0m14:48:19.594888 [debug] [Thread-1 (]: Writing runtime sql for node "test.vg_casestudy.not_null_core__transactions_with_euro_transaction_amount_euro.d6c3b5cd24"
[0m14:48:19.595595 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.not_null_core__transactions_with_euro_transaction_amount_euro.d6c3b5cd24"
[0m14:48:19.595971 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_core__transactions_with_euro_transaction_amount_euro.d6c3b5cd24: BEGIN
[0m14:48:19.596292 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:48:19.610094 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:48:19.610572 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.not_null_core__transactions_with_euro_transaction_amount_euro.d6c3b5cd24"
[0m14:48:19.610918 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_core__transactions_with_euro_transaction_amount_euro.d6c3b5cd24: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "test.vg_casestudy.not_null_core__transactions_with_euro_transaction_amount_euro.d6c3b5cd24"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select transaction_amount_euro
from "casestudy"."main"."core__transactions_with_euro"
where transaction_amount_euro is null



      
    ) dbt_internal_test
[0m14:48:19.624114 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:48:19.625831 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_core__transactions_with_euro_transaction_amount_euro.d6c3b5cd24 (execute): 14:48:19.591862 => 14:48:19.625620
[0m14:48:19.626216 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_core__transactions_with_euro_transaction_amount_euro.d6c3b5cd24: ROLLBACK
[0m14:48:19.626700 [debug] [Thread-1 (]: Failed to rollback 'test.vg_casestudy.not_null_core__transactions_with_euro_transaction_amount_euro.d6c3b5cd24'
[0m14:48:19.627012 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_core__transactions_with_euro_transaction_amount_euro.d6c3b5cd24: Close
[0m14:48:19.630269 [info ] [Thread-1 (]: 3 of 8 PASS not_null_core__transactions_with_euro_transaction_amount_euro ...... [[32mPASS[0m in 0.05s]
[0m14:48:19.630969 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.not_null_core__transactions_with_euro_transaction_amount_euro.d6c3b5cd24
[0m14:48:19.631427 [debug] [Thread-1 (]: Began running node test.vg_casestudy.not_null_core__transactions_with_euro_transaction_date.b09759e145
[0m14:48:19.631813 [info ] [Thread-1 (]: 4 of 8 START test not_null_core__transactions_with_euro_transaction_date ....... [RUN]
[0m14:48:19.632703 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.not_null_core__transactions_with_euro_transaction_amount_euro.d6c3b5cd24, now test.vg_casestudy.not_null_core__transactions_with_euro_transaction_date.b09759e145)
[0m14:48:19.633084 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.not_null_core__transactions_with_euro_transaction_date.b09759e145
[0m14:48:19.637346 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.not_null_core__transactions_with_euro_transaction_date.b09759e145"
[0m14:48:19.638077 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_core__transactions_with_euro_transaction_date.b09759e145 (compile): 14:48:19.633315 => 14:48:19.637848
[0m14:48:19.638571 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.not_null_core__transactions_with_euro_transaction_date.b09759e145
[0m14:48:19.641697 [debug] [Thread-1 (]: Writing runtime sql for node "test.vg_casestudy.not_null_core__transactions_with_euro_transaction_date.b09759e145"
[0m14:48:19.642343 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.not_null_core__transactions_with_euro_transaction_date.b09759e145"
[0m14:48:19.642707 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_core__transactions_with_euro_transaction_date.b09759e145: BEGIN
[0m14:48:19.643009 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:48:19.656513 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:48:19.657031 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.not_null_core__transactions_with_euro_transaction_date.b09759e145"
[0m14:48:19.657463 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_core__transactions_with_euro_transaction_date.b09759e145: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "test.vg_casestudy.not_null_core__transactions_with_euro_transaction_date.b09759e145"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select transaction_date
from "casestudy"."main"."core__transactions_with_euro"
where transaction_date is null



      
    ) dbt_internal_test
[0m14:48:19.660610 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:48:19.662355 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_core__transactions_with_euro_transaction_date.b09759e145 (execute): 14:48:19.638836 => 14:48:19.662106
[0m14:48:19.662852 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_core__transactions_with_euro_transaction_date.b09759e145: ROLLBACK
[0m14:48:19.663601 [debug] [Thread-1 (]: Failed to rollback 'test.vg_casestudy.not_null_core__transactions_with_euro_transaction_date.b09759e145'
[0m14:48:19.664306 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_core__transactions_with_euro_transaction_date.b09759e145: Close
[0m14:48:19.671386 [info ] [Thread-1 (]: 4 of 8 PASS not_null_core__transactions_with_euro_transaction_date ............. [[32mPASS[0m in 0.04s]
[0m14:48:19.674825 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.not_null_core__transactions_with_euro_transaction_date.b09759e145
[0m14:48:19.676088 [debug] [Thread-1 (]: Began running node test.vg_casestudy.not_null_core__transactions_with_euro_transaction_id.f75c556915
[0m14:48:19.677057 [info ] [Thread-1 (]: 5 of 8 START test not_null_core__transactions_with_euro_transaction_id ......... [RUN]
[0m14:48:19.678030 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.not_null_core__transactions_with_euro_transaction_date.b09759e145, now test.vg_casestudy.not_null_core__transactions_with_euro_transaction_id.f75c556915)
[0m14:48:19.678398 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.not_null_core__transactions_with_euro_transaction_id.f75c556915
[0m14:48:19.683501 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.not_null_core__transactions_with_euro_transaction_id.f75c556915"
[0m14:48:19.684421 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_core__transactions_with_euro_transaction_id.f75c556915 (compile): 14:48:19.678662 => 14:48:19.684122
[0m14:48:19.684912 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.not_null_core__transactions_with_euro_transaction_id.f75c556915
[0m14:48:19.687584 [debug] [Thread-1 (]: Writing runtime sql for node "test.vg_casestudy.not_null_core__transactions_with_euro_transaction_id.f75c556915"
[0m14:48:19.688299 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.not_null_core__transactions_with_euro_transaction_id.f75c556915"
[0m14:48:19.688666 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_core__transactions_with_euro_transaction_id.f75c556915: BEGIN
[0m14:48:19.688972 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:48:19.701974 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:48:19.702442 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.not_null_core__transactions_with_euro_transaction_id.f75c556915"
[0m14:48:19.702797 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_core__transactions_with_euro_transaction_id.f75c556915: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "test.vg_casestudy.not_null_core__transactions_with_euro_transaction_id.f75c556915"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select transaction_id
from "casestudy"."main"."core__transactions_with_euro"
where transaction_id is null



      
    ) dbt_internal_test
[0m14:48:19.705495 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:48:19.707087 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_core__transactions_with_euro_transaction_id.f75c556915 (execute): 14:48:19.685194 => 14:48:19.706844
[0m14:48:19.707512 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_core__transactions_with_euro_transaction_id.f75c556915: ROLLBACK
[0m14:48:19.708201 [debug] [Thread-1 (]: Failed to rollback 'test.vg_casestudy.not_null_core__transactions_with_euro_transaction_id.f75c556915'
[0m14:48:19.708639 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_core__transactions_with_euro_transaction_id.f75c556915: Close
[0m14:48:19.711620 [info ] [Thread-1 (]: 5 of 8 PASS not_null_core__transactions_with_euro_transaction_id ............... [[32mPASS[0m in 0.03s]
[0m14:48:19.712299 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.not_null_core__transactions_with_euro_transaction_id.f75c556915
[0m14:48:19.712708 [debug] [Thread-1 (]: Began running node test.vg_casestudy.numeric_range_core__transactions_with_euro_transaction_amount__0.b4dc525fde
[0m14:48:19.713076 [info ] [Thread-1 (]: 6 of 8 START test numeric_range_core__transactions_with_euro_transaction_amount__0  [RUN]
[0m14:48:19.714002 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.not_null_core__transactions_with_euro_transaction_id.f75c556915, now test.vg_casestudy.numeric_range_core__transactions_with_euro_transaction_amount__0.b4dc525fde)
[0m14:48:19.714374 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.numeric_range_core__transactions_with_euro_transaction_amount__0.b4dc525fde
[0m14:48:19.718432 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.numeric_range_core__transactions_with_euro_transaction_amount__0.b4dc525fde"
[0m14:48:19.719052 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.numeric_range_core__transactions_with_euro_transaction_amount__0.b4dc525fde (compile): 14:48:19.714599 => 14:48:19.718858
[0m14:48:19.719466 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.numeric_range_core__transactions_with_euro_transaction_amount__0.b4dc525fde
[0m14:48:19.722540 [debug] [Thread-1 (]: Writing runtime sql for node "test.vg_casestudy.numeric_range_core__transactions_with_euro_transaction_amount__0.b4dc525fde"
[0m14:48:19.723167 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.numeric_range_core__transactions_with_euro_transaction_amount__0.b4dc525fde"
[0m14:48:19.723607 [debug] [Thread-1 (]: On test.vg_casestudy.numeric_range_core__transactions_with_euro_transaction_amount__0.b4dc525fde: BEGIN
[0m14:48:19.723969 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:48:19.738056 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:48:19.738530 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.numeric_range_core__transactions_with_euro_transaction_amount__0.b4dc525fde"
[0m14:48:19.738877 [debug] [Thread-1 (]: On test.vg_casestudy.numeric_range_core__transactions_with_euro_transaction_amount__0.b4dc525fde: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "test.vg_casestudy.numeric_range_core__transactions_with_euro_transaction_amount__0.b4dc525fde"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

    
        select *
        from "casestudy"."main"."core__transactions_with_euro"
        where transaction_amount < 0
    
    


      
    ) dbt_internal_test
[0m14:48:19.742050 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:48:19.744053 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.numeric_range_core__transactions_with_euro_transaction_amount__0.b4dc525fde (execute): 14:48:19.719760 => 14:48:19.743747
[0m14:48:19.744476 [debug] [Thread-1 (]: On test.vg_casestudy.numeric_range_core__transactions_with_euro_transaction_amount__0.b4dc525fde: ROLLBACK
[0m14:48:19.744967 [debug] [Thread-1 (]: Failed to rollback 'test.vg_casestudy.numeric_range_core__transactions_with_euro_transaction_amount__0.b4dc525fde'
[0m14:48:19.745289 [debug] [Thread-1 (]: On test.vg_casestudy.numeric_range_core__transactions_with_euro_transaction_amount__0.b4dc525fde: Close
[0m14:48:19.747854 [info ] [Thread-1 (]: 6 of 8 PASS numeric_range_core__transactions_with_euro_transaction_amount__0 ... [[32mPASS[0m in 0.03s]
[0m14:48:19.748479 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.numeric_range_core__transactions_with_euro_transaction_amount__0.b4dc525fde
[0m14:48:19.748934 [debug] [Thread-1 (]: Began running node test.vg_casestudy.numeric_range_core__transactions_with_euro_transaction_amount_euro__0.751c1dfde7
[0m14:48:19.749400 [info ] [Thread-1 (]: 7 of 8 START test numeric_range_core__transactions_with_euro_transaction_amount_euro__0  [RUN]
[0m14:48:19.750079 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.numeric_range_core__transactions_with_euro_transaction_amount__0.b4dc525fde, now test.vg_casestudy.numeric_range_core__transactions_with_euro_transaction_amount_euro__0.751c1dfde7)
[0m14:48:19.750427 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.numeric_range_core__transactions_with_euro_transaction_amount_euro__0.751c1dfde7
[0m14:48:19.756317 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.numeric_range_core__transactions_with_euro_transaction_amount_euro__0.751c1dfde7"
[0m14:48:19.757295 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.numeric_range_core__transactions_with_euro_transaction_amount_euro__0.751c1dfde7 (compile): 14:48:19.750648 => 14:48:19.756905
[0m14:48:19.757877 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.numeric_range_core__transactions_with_euro_transaction_amount_euro__0.751c1dfde7
[0m14:48:19.761670 [debug] [Thread-1 (]: Writing runtime sql for node "test.vg_casestudy.numeric_range_core__transactions_with_euro_transaction_amount_euro__0.751c1dfde7"
[0m14:48:19.762507 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.numeric_range_core__transactions_with_euro_transaction_amount_euro__0.751c1dfde7"
[0m14:48:19.762999 [debug] [Thread-1 (]: On test.vg_casestudy.numeric_range_core__transactions_with_euro_transaction_amount_euro__0.751c1dfde7: BEGIN
[0m14:48:19.763507 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:48:19.777015 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:48:19.777516 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.numeric_range_core__transactions_with_euro_transaction_amount_euro__0.751c1dfde7"
[0m14:48:19.777890 [debug] [Thread-1 (]: On test.vg_casestudy.numeric_range_core__transactions_with_euro_transaction_amount_euro__0.751c1dfde7: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "test.vg_casestudy.numeric_range_core__transactions_with_euro_transaction_amount_euro__0.751c1dfde7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

    
        select *
        from "casestudy"."main"."core__transactions_with_euro"
        where transaction_amount_euro < 0
    
    


      
    ) dbt_internal_test
[0m14:48:19.786736 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:48:19.788357 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.numeric_range_core__transactions_with_euro_transaction_amount_euro__0.751c1dfde7 (execute): 14:48:19.758246 => 14:48:19.788121
[0m14:48:19.788740 [debug] [Thread-1 (]: On test.vg_casestudy.numeric_range_core__transactions_with_euro_transaction_amount_euro__0.751c1dfde7: ROLLBACK
[0m14:48:19.789200 [debug] [Thread-1 (]: Failed to rollback 'test.vg_casestudy.numeric_range_core__transactions_with_euro_transaction_amount_euro__0.751c1dfde7'
[0m14:48:19.789492 [debug] [Thread-1 (]: On test.vg_casestudy.numeric_range_core__transactions_with_euro_transaction_amount_euro__0.751c1dfde7: Close
[0m14:48:19.793342 [info ] [Thread-1 (]: 7 of 8 PASS numeric_range_core__transactions_with_euro_transaction_amount_euro__0  [[32mPASS[0m in 0.04s]
[0m14:48:19.794211 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.numeric_range_core__transactions_with_euro_transaction_amount_euro__0.751c1dfde7
[0m14:48:19.794632 [debug] [Thread-1 (]: Began running node test.vg_casestudy.unique_core__transactions_with_euro_transaction_id.524c820bba
[0m14:48:19.794997 [info ] [Thread-1 (]: 8 of 8 START test unique_core__transactions_with_euro_transaction_id ........... [RUN]
[0m14:48:19.795780 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.numeric_range_core__transactions_with_euro_transaction_amount_euro__0.751c1dfde7, now test.vg_casestudy.unique_core__transactions_with_euro_transaction_id.524c820bba)
[0m14:48:19.796118 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.unique_core__transactions_with_euro_transaction_id.524c820bba
[0m14:48:19.802626 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.unique_core__transactions_with_euro_transaction_id.524c820bba"
[0m14:48:19.803559 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.unique_core__transactions_with_euro_transaction_id.524c820bba (compile): 14:48:19.796341 => 14:48:19.803175
[0m14:48:19.804080 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.unique_core__transactions_with_euro_transaction_id.524c820bba
[0m14:48:19.807017 [debug] [Thread-1 (]: Writing runtime sql for node "test.vg_casestudy.unique_core__transactions_with_euro_transaction_id.524c820bba"
[0m14:48:19.808057 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.unique_core__transactions_with_euro_transaction_id.524c820bba"
[0m14:48:19.808640 [debug] [Thread-1 (]: On test.vg_casestudy.unique_core__transactions_with_euro_transaction_id.524c820bba: BEGIN
[0m14:48:19.809163 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:48:19.822561 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:48:19.823018 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.unique_core__transactions_with_euro_transaction_id.524c820bba"
[0m14:48:19.823398 [debug] [Thread-1 (]: On test.vg_casestudy.unique_core__transactions_with_euro_transaction_id.524c820bba: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "test.vg_casestudy.unique_core__transactions_with_euro_transaction_id.524c820bba"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    transaction_id as unique_field,
    count(*) as n_records

from "casestudy"."main"."core__transactions_with_euro"
where transaction_id is not null
group by transaction_id
having count(*) > 1



      
    ) dbt_internal_test
[0m14:48:19.840480 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:48:19.842150 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.unique_core__transactions_with_euro_transaction_id.524c820bba (execute): 14:48:19.804345 => 14:48:19.841933
[0m14:48:19.842536 [debug] [Thread-1 (]: On test.vg_casestudy.unique_core__transactions_with_euro_transaction_id.524c820bba: ROLLBACK
[0m14:48:19.843037 [debug] [Thread-1 (]: Failed to rollback 'test.vg_casestudy.unique_core__transactions_with_euro_transaction_id.524c820bba'
[0m14:48:19.843355 [debug] [Thread-1 (]: On test.vg_casestudy.unique_core__transactions_with_euro_transaction_id.524c820bba: Close
[0m14:48:19.846556 [info ] [Thread-1 (]: 8 of 8 PASS unique_core__transactions_with_euro_transaction_id ................. [[32mPASS[0m in 0.05s]
[0m14:48:19.847220 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.unique_core__transactions_with_euro_transaction_id.524c820bba
[0m14:48:19.849285 [debug] [MainThread]: Using duckdb connection "master"
[0m14:48:19.849607 [debug] [MainThread]: On master: BEGIN
[0m14:48:19.849878 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:48:19.864078 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:48:19.864517 [debug] [MainThread]: On master: COMMIT
[0m14:48:19.864804 [debug] [MainThread]: Using duckdb connection "master"
[0m14:48:19.865070 [debug] [MainThread]: On master: COMMIT
[0m14:48:19.865627 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:48:19.865980 [debug] [MainThread]: On master: Close
[0m14:48:19.868571 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:48:19.869024 [debug] [MainThread]: Connection 'list_casestudy_main' was properly closed.
[0m14:48:19.869309 [debug] [MainThread]: Connection 'test.vg_casestudy.unique_core__transactions_with_euro_transaction_id.524c820bba' was properly closed.
[0m14:48:19.869663 [info ] [MainThread]: 
[0m14:48:19.870067 [info ] [MainThread]: Finished running 8 tests in 0 hours 0 minutes and 0.70 seconds (0.70s).
[0m14:48:19.871453 [debug] [MainThread]: Command end result
[0m14:48:19.891564 [info ] [MainThread]: 
[0m14:48:19.892072 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:48:19.892417 [info ] [MainThread]: 
[0m14:48:19.892813 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=0 SKIP=0 TOTAL=8
[0m14:48:19.893363 [debug] [MainThread]: Command `dbt test` succeeded at 14:48:19.893245 after 1.28 seconds
[0m14:48:19.893747 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7671345bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76705bd1d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7670fbd8d0>]}
[0m14:48:19.894111 [debug] [MainThread]: Flushing usage events
[0m02:42:15.094512 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96d89e86d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96d8bbb890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96d965b090>]}


============================== 02:42:15.098348 | a50953d1-4999-45f3-8214-08c29760c991 ==============================
[0m02:42:15.098348 [info ] [MainThread]: Running with dbt=1.6.18
[0m02:42:15.098949 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/workspaces/vg_case_study_tim/transformation/logs', 'fail_fast': 'False', 'profiles_dir': '/workspaces/vg_case_study_tim/transformation', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt debug', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m02:42:15.099420 [info ] [MainThread]: dbt version: 1.6.18
[0m02:42:15.099790 [info ] [MainThread]: python version: 3.11.6
[0m02:42:15.100110 [info ] [MainThread]: python path: /usr/local/bin/python
[0m02:42:15.100405 [info ] [MainThread]: os info: Linux-5.15.153.1-microsoft-standard-WSL2-x86_64-with-glibc2.31
[0m02:42:15.227913 [info ] [MainThread]: Using profiles dir at /workspaces/vg_case_study_tim/transformation
[0m02:42:15.228385 [info ] [MainThread]: Using profiles.yml file at /workspaces/vg_case_study_tim/transformation/profiles.yml
[0m02:42:15.228756 [info ] [MainThread]: Using dbt_project.yml file at /workspaces/vg_case_study_tim/transformation/dbt_project.yml
[0m02:42:15.230662 [info ] [MainThread]: adapter type: duckdb
[0m02:42:15.231016 [info ] [MainThread]: adapter version: 1.6.2
[0m02:42:15.264005 [info ] [MainThread]: Configuration:
[0m02:42:15.264459 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m02:42:15.264786 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m02:42:15.265094 [info ] [MainThread]: Required dependencies:
[0m02:42:15.265413 [debug] [MainThread]: Executing "git --help"
[0m02:42:15.266898 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m02:42:15.267345 [debug] [MainThread]: STDERR: "b''"
[0m02:42:15.267632 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m02:42:15.267936 [info ] [MainThread]: Connection:
[0m02:42:15.268236 [info ] [MainThread]:   database: casestudy
[0m02:42:15.268519 [info ] [MainThread]:   schema: main
[0m02:42:15.268794 [info ] [MainThread]:   path: casestudy.duckdb
[0m02:42:15.269059 [info ] [MainThread]:   config_options: None
[0m02:42:15.269326 [info ] [MainThread]:   extensions: ['icu']
[0m02:42:15.269589 [info ] [MainThread]:   settings: None
[0m02:42:15.269866 [info ] [MainThread]:   external_root: .
[0m02:42:15.270131 [info ] [MainThread]:   use_credential_provider: None
[0m02:42:15.270406 [info ] [MainThread]:   attach: None
[0m02:42:15.270677 [info ] [MainThread]:   filesystems: None
[0m02:42:15.270947 [info ] [MainThread]:   remote: None
[0m02:42:15.271222 [info ] [MainThread]:   plugins: None
[0m02:42:15.271513 [info ] [MainThread]:   disable_transactions: False
[0m02:42:15.271929 [info ] [MainThread]: Registered adapter: duckdb=1.6.2
[0m02:42:15.272526 [debug] [MainThread]: Acquiring new duckdb connection 'debug'
[0m02:42:15.272897 [debug] [MainThread]: Using duckdb connection "debug"
[0m02:42:15.273185 [debug] [MainThread]: On debug: select 1 as id
[0m02:42:15.273441 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:42:15.410279 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m02:42:15.411331 [debug] [MainThread]: On debug: Close
[0m02:42:15.413929 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m02:42:15.414393 [info ] [MainThread]: [32mAll checks passed![0m
[0m02:42:15.414884 [debug] [MainThread]: Command `dbt debug` succeeded at 02:42:15.414785 after 0.33 seconds
[0m02:42:15.415200 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m02:42:15.415527 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96d8853910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96d8d04fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96dd201650>]}
[0m02:42:15.415908 [debug] [MainThread]: Flushing usage events
[0m04:31:48.873630 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c1b25fad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c1b5b0a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c1b5b19d0>]}


============================== 04:31:48.879799 | f5e7e522-1f23-4ba4-8bde-f0c8a39a7dcb ==============================
[0m04:31:48.879799 [info ] [MainThread]: Running with dbt=1.6.18
[0m04:31:48.880391 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/workspaces/vg_case_study_tim/transformation', 'debug': 'False', 'version_check': 'True', 'log_path': '/workspaces/vg_case_study_tim/transformation/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt debug', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m04:31:48.880771 [info ] [MainThread]: dbt version: 1.6.18
[0m04:31:48.881102 [info ] [MainThread]: python version: 3.11.6
[0m04:31:48.881469 [info ] [MainThread]: python path: /usr/local/bin/python
[0m04:31:48.881774 [info ] [MainThread]: os info: Linux-5.15.153.1-microsoft-standard-WSL2-x86_64-with-glibc2.31
[0m04:31:49.009280 [info ] [MainThread]: Using profiles dir at /workspaces/vg_case_study_tim/transformation
[0m04:31:49.009750 [info ] [MainThread]: Using profiles.yml file at /workspaces/vg_case_study_tim/transformation/profiles.yml
[0m04:31:49.010086 [info ] [MainThread]: Using dbt_project.yml file at /workspaces/vg_case_study_tim/transformation/dbt_project.yml
[0m04:31:49.011546 [info ] [MainThread]: adapter type: duckdb
[0m04:31:49.012043 [info ] [MainThread]: adapter version: 1.6.2
[0m04:31:49.043857 [info ] [MainThread]: Configuration:
[0m04:31:49.044347 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m04:31:49.044722 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m04:31:49.045065 [info ] [MainThread]: Required dependencies:
[0m04:31:49.045412 [debug] [MainThread]: Executing "git --help"
[0m04:31:49.047100 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m04:31:49.047551 [debug] [MainThread]: STDERR: "b''"
[0m04:31:49.047837 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m04:31:49.048175 [info ] [MainThread]: Connection:
[0m04:31:49.048470 [info ] [MainThread]:   database: casestudy
[0m04:31:49.048810 [info ] [MainThread]:   schema: main
[0m04:31:49.049124 [info ] [MainThread]:   path: casestudy.duckdb
[0m04:31:49.049403 [info ] [MainThread]:   config_options: None
[0m04:31:49.049718 [info ] [MainThread]:   extensions: ['icu']
[0m04:31:49.049999 [info ] [MainThread]:   settings: None
[0m04:31:49.050269 [info ] [MainThread]:   external_root: .
[0m04:31:49.050532 [info ] [MainThread]:   use_credential_provider: None
[0m04:31:49.050810 [info ] [MainThread]:   attach: None
[0m04:31:49.051060 [info ] [MainThread]:   filesystems: None
[0m04:31:49.051346 [info ] [MainThread]:   remote: None
[0m04:31:49.051618 [info ] [MainThread]:   plugins: None
[0m04:31:49.052043 [info ] [MainThread]:   disable_transactions: False
[0m04:31:49.052531 [info ] [MainThread]: Registered adapter: duckdb=1.6.2
[0m04:31:49.053077 [debug] [MainThread]: Acquiring new duckdb connection 'debug'
[0m04:31:49.053384 [debug] [MainThread]: Using duckdb connection "debug"
[0m04:31:49.053664 [debug] [MainThread]: On debug: select 1 as id
[0m04:31:49.053917 [debug] [MainThread]: Opening a new connection, currently in state init
[0m04:31:49.147418 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m04:31:49.147912 [info ] [MainThread]: [31m1 check failed:[0m
[0m04:31:49.148252 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Runtime Error
  IO Error: Could not set lock on file "/workspaces/vg_case_study_tim/transformation/casestudy.duckdb": Conflicting lock is held in /root/.duckdb/cli/1.3.2/duckdb (PID 6522). See also https://duckdb.org/docs/stable/connect/concurrency

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m04:31:49.148799 [debug] [MainThread]: Command `dbt debug` failed at 04:31:49.148631 after 0.28 seconds
[0m04:31:49.149129 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m04:31:49.149432 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c1b6f0350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c1b1561d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c1b437850>]}
[0m04:31:49.149784 [debug] [MainThread]: Flushing usage events
[0m04:32:57.253909 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efe6b0ee190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efe688edc10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efe6b563e90>]}


============================== 04:32:57.256780 | c8c8de6f-b9d2-4581-9623-deade9498a7d ==============================
[0m04:32:57.256780 [info ] [MainThread]: Running with dbt=1.6.18
[0m04:32:57.257436 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/workspaces/vg_case_study_tim/transformation', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/workspaces/vg_case_study_tim/transformation/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt debug', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m04:32:57.257847 [info ] [MainThread]: dbt version: 1.6.18
[0m04:32:57.258244 [info ] [MainThread]: python version: 3.11.6
[0m04:32:57.258619 [info ] [MainThread]: python path: /usr/local/bin/python
[0m04:32:57.258967 [info ] [MainThread]: os info: Linux-5.15.153.1-microsoft-standard-WSL2-x86_64-with-glibc2.31
[0m04:32:57.327351 [info ] [MainThread]: Using profiles dir at /workspaces/vg_case_study_tim/transformation
[0m04:32:57.327966 [info ] [MainThread]: Using profiles.yml file at /workspaces/vg_case_study_tim/transformation/profiles.yml
[0m04:32:57.328305 [info ] [MainThread]: Using dbt_project.yml file at /workspaces/vg_case_study_tim/transformation/dbt_project.yml
[0m04:32:57.328768 [info ] [MainThread]: adapter type: duckdb
[0m04:32:57.329091 [info ] [MainThread]: adapter version: 1.6.2
[0m04:32:57.363195 [info ] [MainThread]: Configuration:
[0m04:32:57.363699 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m04:32:57.364019 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m04:32:57.364304 [info ] [MainThread]: Required dependencies:
[0m04:32:57.364601 [debug] [MainThread]: Executing "git --help"
[0m04:32:57.366117 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m04:32:57.366505 [debug] [MainThread]: STDERR: "b''"
[0m04:32:57.366784 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m04:32:57.367071 [info ] [MainThread]: Connection:
[0m04:32:57.367361 [info ] [MainThread]:   database: casestudy
[0m04:32:57.367636 [info ] [MainThread]:   schema: main
[0m04:32:57.367925 [info ] [MainThread]:   path: casestudy.duckdb
[0m04:32:57.368204 [info ] [MainThread]:   config_options: None
[0m04:32:57.368480 [info ] [MainThread]:   extensions: ['icu']
[0m04:32:57.368745 [info ] [MainThread]:   settings: None
[0m04:32:57.369008 [info ] [MainThread]:   external_root: .
[0m04:32:57.369275 [info ] [MainThread]:   use_credential_provider: None
[0m04:32:57.369538 [info ] [MainThread]:   attach: None
[0m04:32:57.369889 [info ] [MainThread]:   filesystems: None
[0m04:32:57.370197 [info ] [MainThread]:   remote: None
[0m04:32:57.370557 [info ] [MainThread]:   plugins: None
[0m04:32:57.371054 [info ] [MainThread]:   disable_transactions: False
[0m04:32:57.371480 [info ] [MainThread]: Registered adapter: duckdb=1.6.2
[0m04:32:57.372082 [debug] [MainThread]: Acquiring new duckdb connection 'debug'
[0m04:32:57.372465 [debug] [MainThread]: Using duckdb connection "debug"
[0m04:32:57.372767 [debug] [MainThread]: On debug: select 1 as id
[0m04:32:57.373044 [debug] [MainThread]: Opening a new connection, currently in state init
[0m04:32:57.427886 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m04:32:57.429107 [debug] [MainThread]: On debug: Close
[0m04:32:57.431802 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m04:32:57.432273 [info ] [MainThread]: [32mAll checks passed![0m
[0m04:32:57.432757 [debug] [MainThread]: Command `dbt debug` succeeded at 04:32:57.432658 after 0.19 seconds
[0m04:32:57.433060 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m04:32:57.433384 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efe688e3910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efe6878ee90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efe6af7ce10>]}
[0m04:32:57.433733 [debug] [MainThread]: Flushing usage events
[0m05:30:54.533492 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1fdcf2150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1fdb79b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc20235ef90>]}


============================== 05:30:54.539582 | ae53826a-a442-4658-9d92-8c143816b937 ==============================
[0m05:30:54.539582 [info ] [MainThread]: Running with dbt=1.6.18
[0m05:30:54.540165 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/workspaces/vg_case_study_tim/transformation/logs', 'debug': 'False', 'profiles_dir': '/workspaces/vg_case_study_tim/transformation', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select core__customers_enriched', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m05:30:54.737757 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ae53826a-a442-4658-9d92-8c143816b937', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1fd52f6d0>]}
[0m05:30:54.751767 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ae53826a-a442-4658-9d92-8c143816b937', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1fd5a9610>]}
[0m05:30:54.753344 [info ] [MainThread]: Registered adapter: duckdb=1.6.2
[0m05:30:54.783433 [debug] [MainThread]: checksum: 7b9fab86a08e9e96a48a825af743c566d95b877e068b8c6d0dbafbf714447189, vars: {}, profile: , target: , version: 1.6.18
[0m05:30:54.883940 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m05:30:54.884781 [debug] [MainThread]: Partial parsing: added file: vg_casestudy://models/core/core__customers_enriched.sql
[0m05:30:54.944535 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.vg_casestudy.reporting
- models.vg_casestudy.main
- models.vg_casestudy.marts
[0m05:30:55.002372 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ae53826a-a442-4658-9d92-8c143816b937', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1fd708410>]}
[0m05:30:55.035697 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ae53826a-a442-4658-9d92-8c143816b937', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1fd558050>]}
[0m05:30:55.036428 [info ] [MainThread]: Found 14 models, 1 analysis, 3 seeds, 88 tests, 5 sources, 0 exposures, 0 metrics, 632 macros, 0 groups, 0 semantic models
[0m05:30:55.036982 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ae53826a-a442-4658-9d92-8c143816b937', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1fdba3750>]}
[0m05:30:55.039742 [info ] [MainThread]: 
[0m05:30:55.040640 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m05:30:55.042812 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_casestudy'
[0m05:30:55.060024 [debug] [ThreadPool]: Using duckdb connection "list_casestudy"
[0m05:30:55.060494 [debug] [ThreadPool]: On list_casestudy: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"casestudy"'
    
  
  
[0m05:30:55.060887 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:30:55.215503 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m05:30:55.217791 [debug] [ThreadPool]: On list_casestudy: Close
[0m05:30:55.224226 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy, now create_casestudy_main)
[0m05:30:55.225206 [debug] [ThreadPool]: Creating schema "database: "casestudy"
schema: "main"
"
[0m05:30:55.230883 [debug] [ThreadPool]: Using duckdb connection "create_casestudy_main"
[0m05:30:55.231384 [debug] [ThreadPool]: On create_casestudy_main: BEGIN
[0m05:30:55.231728 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:30:55.245926 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m05:30:55.246430 [debug] [ThreadPool]: Using duckdb connection "create_casestudy_main"
[0m05:30:55.246831 [debug] [ThreadPool]: On create_casestudy_main: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "create_casestudy_main"} */
create schema if not exists "casestudy"."main"
[0m05:30:55.247647 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m05:30:55.248798 [debug] [ThreadPool]: On create_casestudy_main: COMMIT
[0m05:30:55.249120 [debug] [ThreadPool]: Using duckdb connection "create_casestudy_main"
[0m05:30:55.249470 [debug] [ThreadPool]: On create_casestudy_main: COMMIT
[0m05:30:55.250234 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m05:30:55.250579 [debug] [ThreadPool]: On create_casestudy_main: Close
[0m05:30:55.257902 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_casestudy_main, now list_casestudy_raw)
[0m05:30:55.264784 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_raw"
[0m05:30:55.265211 [debug] [ThreadPool]: On list_casestudy_raw: BEGIN
[0m05:30:55.265521 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:30:55.280947 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m05:30:55.281363 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_raw"
[0m05:30:55.281645 [debug] [ThreadPool]: On list_casestudy_raw: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_raw"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'raw'
    and table_catalog = 'casestudy'
  
[0m05:30:55.295960 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m05:30:55.298326 [debug] [ThreadPool]: On list_casestudy_raw: ROLLBACK
[0m05:30:55.300205 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_raw'
[0m05:30:55.300542 [debug] [ThreadPool]: On list_casestudy_raw: Close
[0m05:30:55.303344 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy_raw, now list_casestudy_main)
[0m05:30:55.305510 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_main"
[0m05:30:55.307112 [debug] [ThreadPool]: On list_casestudy_main: BEGIN
[0m05:30:55.307430 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:30:55.317695 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m05:30:55.318065 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_main"
[0m05:30:55.318426 [debug] [ThreadPool]: On list_casestudy_main: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_main"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'casestudy'
  
[0m05:30:55.326550 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m05:30:55.327829 [debug] [ThreadPool]: On list_casestudy_main: ROLLBACK
[0m05:30:55.328367 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_main'
[0m05:30:55.328637 [debug] [ThreadPool]: On list_casestudy_main: Close
[0m05:30:55.331301 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy_main, now list_casestudy_staging)
[0m05:30:55.333829 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_staging"
[0m05:30:55.334119 [debug] [ThreadPool]: On list_casestudy_staging: BEGIN
[0m05:30:55.334400 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:30:55.344838 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m05:30:55.345226 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_staging"
[0m05:30:55.345528 [debug] [ThreadPool]: On list_casestudy_staging: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_staging"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'staging'
    and table_catalog = 'casestudy'
  
[0m05:30:55.353903 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m05:30:55.355350 [debug] [ThreadPool]: On list_casestudy_staging: ROLLBACK
[0m05:30:55.355835 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_staging'
[0m05:30:55.356099 [debug] [ThreadPool]: On list_casestudy_staging: Close
[0m05:30:55.359052 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy_staging, now list_casestudy_intermediate)
[0m05:30:55.362171 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_intermediate"
[0m05:30:55.362463 [debug] [ThreadPool]: On list_casestudy_intermediate: BEGIN
[0m05:30:55.362740 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:30:55.373006 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m05:30:55.373389 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_intermediate"
[0m05:30:55.373700 [debug] [ThreadPool]: On list_casestudy_intermediate: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_intermediate"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'intermediate'
    and table_catalog = 'casestudy'
  
[0m05:30:55.381691 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m05:30:55.383084 [debug] [ThreadPool]: On list_casestudy_intermediate: ROLLBACK
[0m05:30:55.383518 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_intermediate'
[0m05:30:55.383780 [debug] [ThreadPool]: On list_casestudy_intermediate: Close
[0m05:30:55.387798 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ae53826a-a442-4658-9d92-8c143816b937', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1f9e85990>]}
[0m05:30:55.388427 [debug] [MainThread]: Using duckdb connection "master"
[0m05:30:55.388719 [debug] [MainThread]: On master: BEGIN
[0m05:30:55.388999 [debug] [MainThread]: Opening a new connection, currently in state init
[0m05:30:55.400625 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m05:30:55.401034 [debug] [MainThread]: On master: COMMIT
[0m05:30:55.401312 [debug] [MainThread]: Using duckdb connection "master"
[0m05:30:55.401582 [debug] [MainThread]: On master: COMMIT
[0m05:30:55.402160 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m05:30:55.402486 [debug] [MainThread]: On master: Close
[0m05:30:55.404965 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m05:30:55.405400 [info ] [MainThread]: 
[0m05:30:55.411515 [debug] [Thread-1 (]: Began running node model.vg_casestudy.core__customers_enriched
[0m05:30:55.412066 [info ] [Thread-1 (]: 1 of 1 START sql view model main.core__customers_enriched ...................... [RUN]
[0m05:30:55.412922 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.vg_casestudy.core__customers_enriched'
[0m05:30:55.413334 [debug] [Thread-1 (]: Began compiling node model.vg_casestudy.core__customers_enriched
[0m05:30:55.424408 [debug] [Thread-1 (]: Writing injected SQL for node "model.vg_casestudy.core__customers_enriched"
[0m05:30:55.425551 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.core__customers_enriched (compile): 05:30:55.413663 => 05:30:55.425210
[0m05:30:55.426066 [debug] [Thread-1 (]: Began executing node model.vg_casestudy.core__customers_enriched
[0m05:30:55.462689 [debug] [Thread-1 (]: Writing runtime sql for node "model.vg_casestudy.core__customers_enriched"
[0m05:30:55.463499 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.core__customers_enriched"
[0m05:30:55.463874 [debug] [Thread-1 (]: On model.vg_casestudy.core__customers_enriched: BEGIN
[0m05:30:55.464196 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m05:30:55.477668 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m05:30:55.478149 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.core__customers_enriched"
[0m05:30:55.478544 [debug] [Thread-1 (]: On model.vg_casestudy.core__customers_enriched: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.core__customers_enriched"} */

  
  create view "casestudy"."main"."core__customers_enriched__dbt_tmp" as (
    with customers as (
    select *
    from "casestudy"."intermediate"."stg_staging_intermediate__customers"
),

accounts as (
    select *
    from "casestudy"."intermediate"."stg_staging_intermediate__accounts"
),


joined as (
    select 
        customers.customer_id,
        customers.firstname,
        customers.lastname,
        customers.age,
        customers.branch_id,
        accounts.account_id,
        accounts.account_type,
        accounts.account_opening_date,
        case 
            when accounts.account_id is null then false
            else true
        end as has_account

    from customers
    left join accounts
    on customers.customer_id = accounts.customer_id
)

select *
from joined
  );

[0m05:30:55.479555 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m05:30:55.485782 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.core__customers_enriched"
[0m05:30:55.486166 [debug] [Thread-1 (]: On model.vg_casestudy.core__customers_enriched: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.core__customers_enriched"} */
alter view "casestudy"."main"."core__customers_enriched__dbt_tmp" rename to "core__customers_enriched"
[0m05:30:55.487016 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m05:30:55.501017 [debug] [Thread-1 (]: On model.vg_casestudy.core__customers_enriched: COMMIT
[0m05:30:55.501501 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.core__customers_enriched"
[0m05:30:55.501838 [debug] [Thread-1 (]: On model.vg_casestudy.core__customers_enriched: COMMIT
[0m05:30:55.509000 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m05:30:55.514138 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.core__customers_enriched"
[0m05:30:55.514531 [debug] [Thread-1 (]: On model.vg_casestudy.core__customers_enriched: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.core__customers_enriched"} */
drop view if exists "casestudy"."main"."core__customers_enriched__dbt_backup" cascade
[0m05:30:55.515397 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m05:30:55.518050 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.core__customers_enriched (execute): 05:30:55.426397 => 05:30:55.517893
[0m05:30:55.518526 [debug] [Thread-1 (]: On model.vg_casestudy.core__customers_enriched: Close
[0m05:30:55.549643 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ae53826a-a442-4658-9d92-8c143816b937', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1fd854110>]}
[0m05:30:55.550390 [info ] [Thread-1 (]: 1 of 1 OK created sql view model main.core__customers_enriched ................. [[32mOK[0m in 0.14s]
[0m05:30:55.551021 [debug] [Thread-1 (]: Finished running node model.vg_casestudy.core__customers_enriched
[0m05:30:55.553023 [debug] [MainThread]: Using duckdb connection "master"
[0m05:30:55.553326 [debug] [MainThread]: On master: BEGIN
[0m05:30:55.553607 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m05:30:55.566894 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m05:30:55.567512 [debug] [MainThread]: On master: COMMIT
[0m05:30:55.567909 [debug] [MainThread]: Using duckdb connection "master"
[0m05:30:55.568213 [debug] [MainThread]: On master: COMMIT
[0m05:30:55.568813 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m05:30:55.569128 [debug] [MainThread]: On master: Close
[0m05:30:55.572160 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:30:55.572575 [debug] [MainThread]: Connection 'list_casestudy_intermediate' was properly closed.
[0m05:30:55.572856 [debug] [MainThread]: Connection 'model.vg_casestudy.core__customers_enriched' was properly closed.
[0m05:30:55.573244 [info ] [MainThread]: 
[0m05:30:55.573670 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.53 seconds (0.53s).
[0m05:30:55.574515 [debug] [MainThread]: Command end result
[0m05:30:55.593470 [info ] [MainThread]: 
[0m05:30:55.594151 [info ] [MainThread]: [32mCompleted successfully[0m
[0m05:30:55.595024 [info ] [MainThread]: 
[0m05:30:55.596353 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m05:30:55.597077 [debug] [MainThread]: Command `dbt run` succeeded at 05:30:55.596946 after 1.07 seconds
[0m05:30:55.597456 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1fd98a510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1fd989e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc2021e8e10>]}
[0m05:30:55.597806 [debug] [MainThread]: Flushing usage events
[0m05:41:06.621852 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4643b8ed50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4643eac290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4643b8d950>]}


============================== 05:41:06.627837 | 7761cba7-13b6-44ce-97d0-e1c46aaddb6c ==============================
[0m05:41:06.627837 [info ] [MainThread]: Running with dbt=1.6.18
[0m05:41:06.628433 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/workspaces/vg_case_study_tim/transformation', 'debug': 'False', 'version_check': 'True', 'log_path': '/workspaces/vg_case_study_tim/transformation/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt test --select core__transactions_with_euro', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m05:41:06.824438 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7761cba7-13b6-44ce-97d0-e1c46aaddb6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46436fca90>]}
[0m05:41:06.839343 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7761cba7-13b6-44ce-97d0-e1c46aaddb6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4643eaf590>]}
[0m05:41:06.840878 [info ] [MainThread]: Registered adapter: duckdb=1.6.2
[0m05:41:06.868212 [debug] [MainThread]: checksum: 7b9fab86a08e9e96a48a825af743c566d95b877e068b8c6d0dbafbf714447189, vars: {}, profile: , target: , version: 1.6.18
[0m05:41:06.967714 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m05:41:06.968545 [debug] [MainThread]: Partial parsing: added file: vg_casestudy://models/core/core__customers_enriched.yml
[0m05:41:06.969188 [debug] [MainThread]: Partial parsing: updated file: vg_casestudy://models/core/core__transactions_with_euro.yml
[0m05:41:07.134595 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.vg_casestudy.main
- models.vg_casestudy.marts
- models.vg_casestudy.reporting
[0m05:41:07.141514 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7761cba7-13b6-44ce-97d0-e1c46aaddb6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4643710ed0>]}
[0m05:41:07.173235 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7761cba7-13b6-44ce-97d0-e1c46aaddb6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f464486f890>]}
[0m05:41:07.173802 [info ] [MainThread]: Found 14 models, 1 analysis, 3 seeds, 91 tests, 5 sources, 0 exposures, 0 metrics, 632 macros, 0 groups, 0 semantic models
[0m05:41:07.174228 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7761cba7-13b6-44ce-97d0-e1c46aaddb6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4643a16490>]}
[0m05:41:07.176795 [info ] [MainThread]: 
[0m05:41:07.177543 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m05:41:07.179502 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_casestudy_staging'
[0m05:41:07.191484 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_staging"
[0m05:41:07.191987 [debug] [ThreadPool]: On list_casestudy_staging: BEGIN
[0m05:41:07.192353 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:41:07.319125 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m05:41:07.319576 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_staging"
[0m05:41:07.319896 [debug] [ThreadPool]: On list_casestudy_staging: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_staging"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'staging'
    and table_catalog = 'casestudy'
  
[0m05:41:07.340243 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m05:41:07.341954 [debug] [ThreadPool]: On list_casestudy_staging: ROLLBACK
[0m05:41:07.343117 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_staging'
[0m05:41:07.343458 [debug] [ThreadPool]: On list_casestudy_staging: Close
[0m05:41:07.347738 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy_staging, now list_casestudy_raw)
[0m05:41:07.351108 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_raw"
[0m05:41:07.351423 [debug] [ThreadPool]: On list_casestudy_raw: BEGIN
[0m05:41:07.351710 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:41:07.362789 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m05:41:07.363197 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_raw"
[0m05:41:07.363501 [debug] [ThreadPool]: On list_casestudy_raw: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_raw"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'raw'
    and table_catalog = 'casestudy'
  
[0m05:41:07.372042 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m05:41:07.373538 [debug] [ThreadPool]: On list_casestudy_raw: ROLLBACK
[0m05:41:07.374020 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_raw'
[0m05:41:07.374307 [debug] [ThreadPool]: On list_casestudy_raw: Close
[0m05:41:07.378741 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy_raw, now list_casestudy_intermediate)
[0m05:41:07.382562 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_intermediate"
[0m05:41:07.382876 [debug] [ThreadPool]: On list_casestudy_intermediate: BEGIN
[0m05:41:07.383146 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:41:07.393688 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m05:41:07.394077 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_intermediate"
[0m05:41:07.394390 [debug] [ThreadPool]: On list_casestudy_intermediate: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_intermediate"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'intermediate'
    and table_catalog = 'casestudy'
  
[0m05:41:07.402332 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m05:41:07.403837 [debug] [ThreadPool]: On list_casestudy_intermediate: ROLLBACK
[0m05:41:07.404333 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_intermediate'
[0m05:41:07.404616 [debug] [ThreadPool]: On list_casestudy_intermediate: Close
[0m05:41:07.407507 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy_intermediate, now list_casestudy_core)
[0m05:41:07.409727 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_core"
[0m05:41:07.410058 [debug] [ThreadPool]: On list_casestudy_core: BEGIN
[0m05:41:07.410384 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:41:07.421733 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m05:41:07.422122 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_core"
[0m05:41:07.422435 [debug] [ThreadPool]: On list_casestudy_core: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_core"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'core'
    and table_catalog = 'casestudy'
  
[0m05:41:07.430388 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m05:41:07.431578 [debug] [ThreadPool]: On list_casestudy_core: ROLLBACK
[0m05:41:07.432066 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_core'
[0m05:41:07.432332 [debug] [ThreadPool]: On list_casestudy_core: Close
[0m05:41:07.435377 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7761cba7-13b6-44ce-97d0-e1c46aaddb6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4644d4b010>]}
[0m05:41:07.435913 [debug] [MainThread]: Using duckdb connection "master"
[0m05:41:07.436198 [debug] [MainThread]: On master: BEGIN
[0m05:41:07.436477 [debug] [MainThread]: Opening a new connection, currently in state init
[0m05:41:07.448936 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m05:41:07.449328 [debug] [MainThread]: On master: COMMIT
[0m05:41:07.449608 [debug] [MainThread]: Using duckdb connection "master"
[0m05:41:07.449865 [debug] [MainThread]: On master: COMMIT
[0m05:41:07.450331 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m05:41:07.450734 [debug] [MainThread]: On master: Close
[0m05:41:07.453467 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m05:41:07.453922 [info ] [MainThread]: 
[0m05:41:07.459680 [debug] [Thread-1 (]: Began running node test.vg_casestudy.not_null_core__transactions_with_euro_account_id.2c4215ab21
[0m05:41:07.460262 [info ] [Thread-1 (]: 1 of 8 START test not_null_core__transactions_with_euro_account_id ............. [RUN]
[0m05:41:07.461085 [debug] [Thread-1 (]: Acquiring new duckdb connection 'test.vg_casestudy.not_null_core__transactions_with_euro_account_id.2c4215ab21'
[0m05:41:07.461504 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.not_null_core__transactions_with_euro_account_id.2c4215ab21
[0m05:41:07.479268 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.not_null_core__transactions_with_euro_account_id.2c4215ab21"
[0m05:41:07.480530 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_core__transactions_with_euro_account_id.2c4215ab21 (compile): 05:41:07.461757 => 05:41:07.480248
[0m05:41:07.480960 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.not_null_core__transactions_with_euro_account_id.2c4215ab21
[0m05:41:07.494910 [debug] [Thread-1 (]: Writing runtime sql for node "test.vg_casestudy.not_null_core__transactions_with_euro_account_id.2c4215ab21"
[0m05:41:07.495724 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.not_null_core__transactions_with_euro_account_id.2c4215ab21"
[0m05:41:07.496180 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_core__transactions_with_euro_account_id.2c4215ab21: BEGIN
[0m05:41:07.496604 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m05:41:07.510945 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m05:41:07.511695 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.not_null_core__transactions_with_euro_account_id.2c4215ab21"
[0m05:41:07.512277 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_core__transactions_with_euro_account_id.2c4215ab21: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "test.vg_casestudy.not_null_core__transactions_with_euro_account_id.2c4215ab21"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select account_id
from "casestudy"."core"."core__transactions_with_euro"
where account_id is null



      
    ) dbt_internal_test
[0m05:41:07.536433 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_core__transactions_with_euro_account_id.2c4215ab21 (execute): 05:41:07.481195 => 05:41:07.536136
[0m05:41:07.536894 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_core__transactions_with_euro_account_id.2c4215ab21: ROLLBACK
[0m05:41:07.546530 [debug] [Thread-1 (]: Failed to rollback 'test.vg_casestudy.not_null_core__transactions_with_euro_account_id.2c4215ab21'
[0m05:41:07.546982 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_core__transactions_with_euro_account_id.2c4215ab21: Close
[0m05:41:07.551196 [debug] [Thread-1 (]: Runtime Error in test not_null_core__transactions_with_euro_account_id (models/core/core__transactions_with_euro.yml)
  Catalog Error: Table with name core__transactions_with_euro does not exist!
  Did you mean "casestudy.core__transactions_with_euro"?
  
  LINE 14: from "casestudy"."core"."core__transactions_with_euro"
                ^
[0m05:41:07.551780 [error] [Thread-1 (]: 1 of 8 ERROR not_null_core__transactions_with_euro_account_id .................. [[31mERROR[0m in 0.09s]
[0m05:41:07.552362 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.not_null_core__transactions_with_euro_account_id.2c4215ab21
[0m05:41:07.552775 [debug] [Thread-1 (]: Began running node test.vg_casestudy.not_null_core__transactions_with_euro_transaction_amount.7130175b19
[0m05:41:07.553755 [info ] [Thread-1 (]: 2 of 8 START test not_null_core__transactions_with_euro_transaction_amount ..... [RUN]
[0m05:41:07.554447 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.not_null_core__transactions_with_euro_account_id.2c4215ab21, now test.vg_casestudy.not_null_core__transactions_with_euro_transaction_amount.7130175b19)
[0m05:41:07.554809 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.not_null_core__transactions_with_euro_transaction_amount.7130175b19
[0m05:41:07.558965 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.not_null_core__transactions_with_euro_transaction_amount.7130175b19"
[0m05:41:07.559792 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_core__transactions_with_euro_transaction_amount.7130175b19 (compile): 05:41:07.555028 => 05:41:07.559549
[0m05:41:07.560255 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.not_null_core__transactions_with_euro_transaction_amount.7130175b19
[0m05:41:07.563240 [debug] [Thread-1 (]: Writing runtime sql for node "test.vg_casestudy.not_null_core__transactions_with_euro_transaction_amount.7130175b19"
[0m05:41:07.563925 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.not_null_core__transactions_with_euro_transaction_amount.7130175b19"
[0m05:41:07.564314 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_core__transactions_with_euro_transaction_amount.7130175b19: BEGIN
[0m05:41:07.564660 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:41:07.578848 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m05:41:07.579399 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.not_null_core__transactions_with_euro_transaction_amount.7130175b19"
[0m05:41:07.579769 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_core__transactions_with_euro_transaction_amount.7130175b19: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "test.vg_casestudy.not_null_core__transactions_with_euro_transaction_amount.7130175b19"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select transaction_amount
from "casestudy"."core"."core__transactions_with_euro"
where transaction_amount is null



      
    ) dbt_internal_test
[0m05:41:07.587053 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_core__transactions_with_euro_transaction_amount.7130175b19 (execute): 05:41:07.560558 => 05:41:07.586796
[0m05:41:07.587476 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_core__transactions_with_euro_transaction_amount.7130175b19: ROLLBACK
[0m05:41:07.589464 [debug] [Thread-1 (]: Failed to rollback 'test.vg_casestudy.not_null_core__transactions_with_euro_transaction_amount.7130175b19'
[0m05:41:07.589806 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_core__transactions_with_euro_transaction_amount.7130175b19: Close
[0m05:41:07.593878 [debug] [Thread-1 (]: Runtime Error in test not_null_core__transactions_with_euro_transaction_amount (models/core/core__transactions_with_euro.yml)
  Catalog Error: Table with name core__transactions_with_euro does not exist!
  Did you mean "casestudy.core__transactions_with_euro"?
  
  LINE 14: from "casestudy"."core"."core__transactions_with_euro"
                ^
[0m05:41:07.594422 [error] [Thread-1 (]: 2 of 8 ERROR not_null_core__transactions_with_euro_transaction_amount .......... [[31mERROR[0m in 0.04s]
[0m05:41:07.595131 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.not_null_core__transactions_with_euro_transaction_amount.7130175b19
[0m05:41:07.595562 [debug] [Thread-1 (]: Began running node test.vg_casestudy.not_null_core__transactions_with_euro_transaction_amount_euro.d6c3b5cd24
[0m05:41:07.595919 [info ] [Thread-1 (]: 3 of 8 START test not_null_core__transactions_with_euro_transaction_amount_euro  [RUN]
[0m05:41:07.596698 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.not_null_core__transactions_with_euro_transaction_amount.7130175b19, now test.vg_casestudy.not_null_core__transactions_with_euro_transaction_amount_euro.d6c3b5cd24)
[0m05:41:07.597048 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.not_null_core__transactions_with_euro_transaction_amount_euro.d6c3b5cd24
[0m05:41:07.601236 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.not_null_core__transactions_with_euro_transaction_amount_euro.d6c3b5cd24"
[0m05:41:07.602624 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_core__transactions_with_euro_transaction_amount_euro.d6c3b5cd24 (compile): 05:41:07.597306 => 05:41:07.602345
[0m05:41:07.603136 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.not_null_core__transactions_with_euro_transaction_amount_euro.d6c3b5cd24
[0m05:41:07.606210 [debug] [Thread-1 (]: Writing runtime sql for node "test.vg_casestudy.not_null_core__transactions_with_euro_transaction_amount_euro.d6c3b5cd24"
[0m05:41:07.606939 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.not_null_core__transactions_with_euro_transaction_amount_euro.d6c3b5cd24"
[0m05:41:07.607344 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_core__transactions_with_euro_transaction_amount_euro.d6c3b5cd24: BEGIN
[0m05:41:07.607696 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:41:07.621694 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m05:41:07.622192 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.not_null_core__transactions_with_euro_transaction_amount_euro.d6c3b5cd24"
[0m05:41:07.622525 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_core__transactions_with_euro_transaction_amount_euro.d6c3b5cd24: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "test.vg_casestudy.not_null_core__transactions_with_euro_transaction_amount_euro.d6c3b5cd24"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select transaction_amount_euro
from "casestudy"."core"."core__transactions_with_euro"
where transaction_amount_euro is null



      
    ) dbt_internal_test
[0m05:41:07.629799 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_core__transactions_with_euro_transaction_amount_euro.d6c3b5cd24 (execute): 05:41:07.603448 => 05:41:07.629525
[0m05:41:07.630253 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_core__transactions_with_euro_transaction_amount_euro.d6c3b5cd24: ROLLBACK
[0m05:41:07.632534 [debug] [Thread-1 (]: Failed to rollback 'test.vg_casestudy.not_null_core__transactions_with_euro_transaction_amount_euro.d6c3b5cd24'
[0m05:41:07.633013 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_core__transactions_with_euro_transaction_amount_euro.d6c3b5cd24: Close
[0m05:41:07.637179 [debug] [Thread-1 (]: Runtime Error in test not_null_core__transactions_with_euro_transaction_amount_euro (models/core/core__transactions_with_euro.yml)
  Catalog Error: Table with name core__transactions_with_euro does not exist!
  Did you mean "casestudy.core__transactions_with_euro"?
  
  LINE 14: from "casestudy"."core"."core__transactions_with_euro"
                ^
[0m05:41:07.637758 [error] [Thread-1 (]: 3 of 8 ERROR not_null_core__transactions_with_euro_transaction_amount_euro ..... [[31mERROR[0m in 0.04s]
[0m05:41:07.638298 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.not_null_core__transactions_with_euro_transaction_amount_euro.d6c3b5cd24
[0m05:41:07.638686 [debug] [Thread-1 (]: Began running node test.vg_casestudy.not_null_core__transactions_with_euro_transaction_date.b09759e145
[0m05:41:07.639324 [info ] [Thread-1 (]: 4 of 8 START test not_null_core__transactions_with_euro_transaction_date ....... [RUN]
[0m05:41:07.640059 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.not_null_core__transactions_with_euro_transaction_amount_euro.d6c3b5cd24, now test.vg_casestudy.not_null_core__transactions_with_euro_transaction_date.b09759e145)
[0m05:41:07.640370 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.not_null_core__transactions_with_euro_transaction_date.b09759e145
[0m05:41:07.645880 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.not_null_core__transactions_with_euro_transaction_date.b09759e145"
[0m05:41:07.646628 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_core__transactions_with_euro_transaction_date.b09759e145 (compile): 05:41:07.640596 => 05:41:07.646391
[0m05:41:07.647132 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.not_null_core__transactions_with_euro_transaction_date.b09759e145
[0m05:41:07.650315 [debug] [Thread-1 (]: Writing runtime sql for node "test.vg_casestudy.not_null_core__transactions_with_euro_transaction_date.b09759e145"
[0m05:41:07.650974 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.not_null_core__transactions_with_euro_transaction_date.b09759e145"
[0m05:41:07.651327 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_core__transactions_with_euro_transaction_date.b09759e145: BEGIN
[0m05:41:07.651632 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:41:07.663577 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m05:41:07.664053 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.not_null_core__transactions_with_euro_transaction_date.b09759e145"
[0m05:41:07.664391 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_core__transactions_with_euro_transaction_date.b09759e145: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "test.vg_casestudy.not_null_core__transactions_with_euro_transaction_date.b09759e145"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select transaction_date
from "casestudy"."core"."core__transactions_with_euro"
where transaction_date is null



      
    ) dbt_internal_test
[0m05:41:07.671859 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_core__transactions_with_euro_transaction_date.b09759e145 (execute): 05:41:07.647426 => 05:41:07.671575
[0m05:41:07.672320 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_core__transactions_with_euro_transaction_date.b09759e145: ROLLBACK
[0m05:41:07.674324 [debug] [Thread-1 (]: Failed to rollback 'test.vg_casestudy.not_null_core__transactions_with_euro_transaction_date.b09759e145'
[0m05:41:07.674675 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_core__transactions_with_euro_transaction_date.b09759e145: Close
[0m05:41:07.679043 [debug] [Thread-1 (]: Runtime Error in test not_null_core__transactions_with_euro_transaction_date (models/core/core__transactions_with_euro.yml)
  Catalog Error: Table with name core__transactions_with_euro does not exist!
  Did you mean "casestudy.core__transactions_with_euro"?
  
  LINE 14: from "casestudy"."core"."core__transactions_with_euro"
                ^
[0m05:41:07.679788 [error] [Thread-1 (]: 4 of 8 ERROR not_null_core__transactions_with_euro_transaction_date ............ [[31mERROR[0m in 0.04s]
[0m05:41:07.680528 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.not_null_core__transactions_with_euro_transaction_date.b09759e145
[0m05:41:07.680989 [debug] [Thread-1 (]: Began running node test.vg_casestudy.not_null_core__transactions_with_euro_transaction_id.f75c556915
[0m05:41:07.681389 [info ] [Thread-1 (]: 5 of 8 START test not_null_core__transactions_with_euro_transaction_id ......... [RUN]
[0m05:41:07.682376 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.not_null_core__transactions_with_euro_transaction_date.b09759e145, now test.vg_casestudy.not_null_core__transactions_with_euro_transaction_id.f75c556915)
[0m05:41:07.682715 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.not_null_core__transactions_with_euro_transaction_id.f75c556915
[0m05:41:07.686719 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.not_null_core__transactions_with_euro_transaction_id.f75c556915"
[0m05:41:07.687414 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_core__transactions_with_euro_transaction_id.f75c556915 (compile): 05:41:07.682939 => 05:41:07.687192
[0m05:41:07.687837 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.not_null_core__transactions_with_euro_transaction_id.f75c556915
[0m05:41:07.690737 [debug] [Thread-1 (]: Writing runtime sql for node "test.vg_casestudy.not_null_core__transactions_with_euro_transaction_id.f75c556915"
[0m05:41:07.691410 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.not_null_core__transactions_with_euro_transaction_id.f75c556915"
[0m05:41:07.691794 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_core__transactions_with_euro_transaction_id.f75c556915: BEGIN
[0m05:41:07.692117 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:41:07.705239 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m05:41:07.705714 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.not_null_core__transactions_with_euro_transaction_id.f75c556915"
[0m05:41:07.706061 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_core__transactions_with_euro_transaction_id.f75c556915: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "test.vg_casestudy.not_null_core__transactions_with_euro_transaction_id.f75c556915"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select transaction_id
from "casestudy"."core"."core__transactions_with_euro"
where transaction_id is null



      
    ) dbt_internal_test
[0m05:41:07.713485 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_core__transactions_with_euro_transaction_id.f75c556915 (execute): 05:41:07.688092 => 05:41:07.713141
[0m05:41:07.714010 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_core__transactions_with_euro_transaction_id.f75c556915: ROLLBACK
[0m05:41:07.716047 [debug] [Thread-1 (]: Failed to rollback 'test.vg_casestudy.not_null_core__transactions_with_euro_transaction_id.f75c556915'
[0m05:41:07.716391 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_core__transactions_with_euro_transaction_id.f75c556915: Close
[0m05:41:07.720640 [debug] [Thread-1 (]: Runtime Error in test not_null_core__transactions_with_euro_transaction_id (models/core/core__transactions_with_euro.yml)
  Catalog Error: Table with name core__transactions_with_euro does not exist!
  Did you mean "casestudy.core__transactions_with_euro"?
  
  LINE 14: from "casestudy"."core"."core__transactions_with_euro"
                ^
[0m05:41:07.721171 [error] [Thread-1 (]: 5 of 8 ERROR not_null_core__transactions_with_euro_transaction_id .............. [[31mERROR[0m in 0.04s]
[0m05:41:07.721741 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.not_null_core__transactions_with_euro_transaction_id.f75c556915
[0m05:41:07.722122 [debug] [Thread-1 (]: Began running node test.vg_casestudy.numeric_range_core__transactions_with_euro_transaction_amount__0.b4dc525fde
[0m05:41:07.722465 [info ] [Thread-1 (]: 6 of 8 START test numeric_range_core__transactions_with_euro_transaction_amount__0  [RUN]
[0m05:41:07.723178 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.not_null_core__transactions_with_euro_transaction_id.f75c556915, now test.vg_casestudy.numeric_range_core__transactions_with_euro_transaction_amount__0.b4dc525fde)
[0m05:41:07.723509 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.numeric_range_core__transactions_with_euro_transaction_amount__0.b4dc525fde
[0m05:41:07.727487 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.numeric_range_core__transactions_with_euro_transaction_amount__0.b4dc525fde"
[0m05:41:07.729096 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.numeric_range_core__transactions_with_euro_transaction_amount__0.b4dc525fde (compile): 05:41:07.723734 => 05:41:07.728546
[0m05:41:07.729749 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.numeric_range_core__transactions_with_euro_transaction_amount__0.b4dc525fde
[0m05:41:07.733613 [debug] [Thread-1 (]: Writing runtime sql for node "test.vg_casestudy.numeric_range_core__transactions_with_euro_transaction_amount__0.b4dc525fde"
[0m05:41:07.734371 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.numeric_range_core__transactions_with_euro_transaction_amount__0.b4dc525fde"
[0m05:41:07.734789 [debug] [Thread-1 (]: On test.vg_casestudy.numeric_range_core__transactions_with_euro_transaction_amount__0.b4dc525fde: BEGIN
[0m05:41:07.735108 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:41:07.748175 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m05:41:07.748650 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.numeric_range_core__transactions_with_euro_transaction_amount__0.b4dc525fde"
[0m05:41:07.749094 [debug] [Thread-1 (]: On test.vg_casestudy.numeric_range_core__transactions_with_euro_transaction_amount__0.b4dc525fde: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "test.vg_casestudy.numeric_range_core__transactions_with_euro_transaction_amount__0.b4dc525fde"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

    
        select *
        from "casestudy"."core"."core__transactions_with_euro"
        where transaction_amount < 0
    
    


      
    ) dbt_internal_test
[0m05:41:07.755466 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.numeric_range_core__transactions_with_euro_transaction_amount__0.b4dc525fde (execute): 05:41:07.730046 => 05:41:07.755240
[0m05:41:07.755820 [debug] [Thread-1 (]: On test.vg_casestudy.numeric_range_core__transactions_with_euro_transaction_amount__0.b4dc525fde: ROLLBACK
[0m05:41:07.757709 [debug] [Thread-1 (]: Failed to rollback 'test.vg_casestudy.numeric_range_core__transactions_with_euro_transaction_amount__0.b4dc525fde'
[0m05:41:07.758014 [debug] [Thread-1 (]: On test.vg_casestudy.numeric_range_core__transactions_with_euro_transaction_amount__0.b4dc525fde: Close
[0m05:41:07.762602 [debug] [Thread-1 (]: Runtime Error in test numeric_range_core__transactions_with_euro_transaction_amount__0 (models/core/core__transactions_with_euro.yml)
  Catalog Error: Table with name core__transactions_with_euro does not exist!
  Did you mean "casestudy.core__transactions_with_euro"?
  
  LINE 11:         from "casestudy"."core"."core__transactions_with_euro"
                        ^
[0m05:41:07.763320 [error] [Thread-1 (]: 6 of 8 ERROR numeric_range_core__transactions_with_euro_transaction_amount__0 .. [[31mERROR[0m in 0.04s]
[0m05:41:07.764018 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.numeric_range_core__transactions_with_euro_transaction_amount__0.b4dc525fde
[0m05:41:07.764542 [debug] [Thread-1 (]: Began running node test.vg_casestudy.numeric_range_core__transactions_with_euro_transaction_amount_euro__0.751c1dfde7
[0m05:41:07.765186 [info ] [Thread-1 (]: 7 of 8 START test numeric_range_core__transactions_with_euro_transaction_amount_euro__0  [RUN]
[0m05:41:07.766040 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.numeric_range_core__transactions_with_euro_transaction_amount__0.b4dc525fde, now test.vg_casestudy.numeric_range_core__transactions_with_euro_transaction_amount_euro__0.751c1dfde7)
[0m05:41:07.766555 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.numeric_range_core__transactions_with_euro_transaction_amount_euro__0.751c1dfde7
[0m05:41:07.771683 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.numeric_range_core__transactions_with_euro_transaction_amount_euro__0.751c1dfde7"
[0m05:41:07.772562 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.numeric_range_core__transactions_with_euro_transaction_amount_euro__0.751c1dfde7 (compile): 05:41:07.766969 => 05:41:07.772234
[0m05:41:07.773064 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.numeric_range_core__transactions_with_euro_transaction_amount_euro__0.751c1dfde7
[0m05:41:07.776458 [debug] [Thread-1 (]: Writing runtime sql for node "test.vg_casestudy.numeric_range_core__transactions_with_euro_transaction_amount_euro__0.751c1dfde7"
[0m05:41:07.777296 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.numeric_range_core__transactions_with_euro_transaction_amount_euro__0.751c1dfde7"
[0m05:41:07.777894 [debug] [Thread-1 (]: On test.vg_casestudy.numeric_range_core__transactions_with_euro_transaction_amount_euro__0.751c1dfde7: BEGIN
[0m05:41:07.778333 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:41:07.795583 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m05:41:07.796342 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.numeric_range_core__transactions_with_euro_transaction_amount_euro__0.751c1dfde7"
[0m05:41:07.796923 [debug] [Thread-1 (]: On test.vg_casestudy.numeric_range_core__transactions_with_euro_transaction_amount_euro__0.751c1dfde7: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "test.vg_casestudy.numeric_range_core__transactions_with_euro_transaction_amount_euro__0.751c1dfde7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

    
        select *
        from "casestudy"."core"."core__transactions_with_euro"
        where transaction_amount_euro < 0
    
    


      
    ) dbt_internal_test
[0m05:41:07.805127 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.numeric_range_core__transactions_with_euro_transaction_amount_euro__0.751c1dfde7 (execute): 05:41:07.773354 => 05:41:07.804807
[0m05:41:07.805676 [debug] [Thread-1 (]: On test.vg_casestudy.numeric_range_core__transactions_with_euro_transaction_amount_euro__0.751c1dfde7: ROLLBACK
[0m05:41:07.807992 [debug] [Thread-1 (]: Failed to rollback 'test.vg_casestudy.numeric_range_core__transactions_with_euro_transaction_amount_euro__0.751c1dfde7'
[0m05:41:07.808433 [debug] [Thread-1 (]: On test.vg_casestudy.numeric_range_core__transactions_with_euro_transaction_amount_euro__0.751c1dfde7: Close
[0m05:41:07.813668 [debug] [Thread-1 (]: Runtime Error in test numeric_range_core__transactions_with_euro_transaction_amount_euro__0 (models/core/core__transactions_with_euro.yml)
  Catalog Error: Table with name core__transactions_with_euro does not exist!
  Did you mean "casestudy.core__transactions_with_euro"?
  
  LINE 11:         from "casestudy"."core"."core__transactions_with_euro"
                        ^
[0m05:41:07.814337 [error] [Thread-1 (]: 7 of 8 ERROR numeric_range_core__transactions_with_euro_transaction_amount_euro__0  [[31mERROR[0m in 0.05s]
[0m05:41:07.815202 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.numeric_range_core__transactions_with_euro_transaction_amount_euro__0.751c1dfde7
[0m05:41:07.815847 [debug] [Thread-1 (]: Began running node test.vg_casestudy.unique_core__transactions_with_euro_transaction_id.524c820bba
[0m05:41:07.816644 [info ] [Thread-1 (]: 8 of 8 START test unique_core__transactions_with_euro_transaction_id ........... [RUN]
[0m05:41:07.817606 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.numeric_range_core__transactions_with_euro_transaction_amount_euro__0.751c1dfde7, now test.vg_casestudy.unique_core__transactions_with_euro_transaction_id.524c820bba)
[0m05:41:07.818004 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.unique_core__transactions_with_euro_transaction_id.524c820bba
[0m05:41:07.826630 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.unique_core__transactions_with_euro_transaction_id.524c820bba"
[0m05:41:07.827897 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.unique_core__transactions_with_euro_transaction_id.524c820bba (compile): 05:41:07.818280 => 05:41:07.827493
[0m05:41:07.828624 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.unique_core__transactions_with_euro_transaction_id.524c820bba
[0m05:41:07.837471 [debug] [Thread-1 (]: Writing runtime sql for node "test.vg_casestudy.unique_core__transactions_with_euro_transaction_id.524c820bba"
[0m05:41:07.838742 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.unique_core__transactions_with_euro_transaction_id.524c820bba"
[0m05:41:07.839565 [debug] [Thread-1 (]: On test.vg_casestudy.unique_core__transactions_with_euro_transaction_id.524c820bba: BEGIN
[0m05:41:07.840259 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:41:07.857678 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m05:41:07.858239 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.unique_core__transactions_with_euro_transaction_id.524c820bba"
[0m05:41:07.858629 [debug] [Thread-1 (]: On test.vg_casestudy.unique_core__transactions_with_euro_transaction_id.524c820bba: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "test.vg_casestudy.unique_core__transactions_with_euro_transaction_id.524c820bba"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    transaction_id as unique_field,
    count(*) as n_records

from "casestudy"."core"."core__transactions_with_euro"
where transaction_id is not null
group by transaction_id
having count(*) > 1



      
    ) dbt_internal_test
[0m05:41:07.867829 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.unique_core__transactions_with_euro_transaction_id.524c820bba (execute): 05:41:07.829135 => 05:41:07.867521
[0m05:41:07.868347 [debug] [Thread-1 (]: On test.vg_casestudy.unique_core__transactions_with_euro_transaction_id.524c820bba: ROLLBACK
[0m05:41:07.870912 [debug] [Thread-1 (]: Failed to rollback 'test.vg_casestudy.unique_core__transactions_with_euro_transaction_id.524c820bba'
[0m05:41:07.871415 [debug] [Thread-1 (]: On test.vg_casestudy.unique_core__transactions_with_euro_transaction_id.524c820bba: Close
[0m05:41:07.876372 [debug] [Thread-1 (]: Runtime Error in test unique_core__transactions_with_euro_transaction_id (models/core/core__transactions_with_euro.yml)
  Catalog Error: Table with name core__transactions_with_euro does not exist!
  Did you mean "casestudy.core__transactions_with_euro"?
  
  LINE 15: from "casestudy"."core"."core__transactions_with_euro"
                ^
[0m05:41:07.877175 [error] [Thread-1 (]: 8 of 8 ERROR unique_core__transactions_with_euro_transaction_id ................ [[31mERROR[0m in 0.06s]
[0m05:41:07.877997 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.unique_core__transactions_with_euro_transaction_id.524c820bba
[0m05:41:07.880524 [debug] [MainThread]: Using duckdb connection "master"
[0m05:41:07.881165 [debug] [MainThread]: On master: BEGIN
[0m05:41:07.881632 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m05:41:07.896255 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m05:41:07.896858 [debug] [MainThread]: On master: COMMIT
[0m05:41:07.897190 [debug] [MainThread]: Using duckdb connection "master"
[0m05:41:07.897452 [debug] [MainThread]: On master: COMMIT
[0m05:41:07.898219 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m05:41:07.898701 [debug] [MainThread]: On master: Close
[0m05:41:07.901967 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:41:07.902602 [debug] [MainThread]: Connection 'list_casestudy_core' was properly closed.
[0m05:41:07.902886 [debug] [MainThread]: Connection 'test.vg_casestudy.unique_core__transactions_with_euro_transaction_id.524c820bba' was properly closed.
[0m05:41:07.903229 [info ] [MainThread]: 
[0m05:41:07.903620 [info ] [MainThread]: Finished running 8 tests in 0 hours 0 minutes and 0.73 seconds (0.73s).
[0m05:41:07.904929 [debug] [MainThread]: Command end result
[0m05:41:07.924112 [info ] [MainThread]: 
[0m05:41:07.924725 [info ] [MainThread]: [31mCompleted with 8 errors and 0 warnings:[0m
[0m05:41:07.925113 [info ] [MainThread]: 
[0m05:41:07.925509 [error] [MainThread]:   Runtime Error in test not_null_core__transactions_with_euro_account_id (models/core/core__transactions_with_euro.yml)
  Catalog Error: Table with name core__transactions_with_euro does not exist!
  Did you mean "casestudy.core__transactions_with_euro"?
  
  LINE 14: from "casestudy"."core"."core__transactions_with_euro"
                ^
[0m05:41:07.925907 [info ] [MainThread]: 
[0m05:41:07.926256 [error] [MainThread]:   Runtime Error in test not_null_core__transactions_with_euro_transaction_amount (models/core/core__transactions_with_euro.yml)
  Catalog Error: Table with name core__transactions_with_euro does not exist!
  Did you mean "casestudy.core__transactions_with_euro"?
  
  LINE 14: from "casestudy"."core"."core__transactions_with_euro"
                ^
[0m05:41:07.926599 [info ] [MainThread]: 
[0m05:41:07.926914 [error] [MainThread]:   Runtime Error in test not_null_core__transactions_with_euro_transaction_amount_euro (models/core/core__transactions_with_euro.yml)
  Catalog Error: Table with name core__transactions_with_euro does not exist!
  Did you mean "casestudy.core__transactions_with_euro"?
  
  LINE 14: from "casestudy"."core"."core__transactions_with_euro"
                ^
[0m05:41:07.927216 [info ] [MainThread]: 
[0m05:41:07.927524 [error] [MainThread]:   Runtime Error in test not_null_core__transactions_with_euro_transaction_date (models/core/core__transactions_with_euro.yml)
  Catalog Error: Table with name core__transactions_with_euro does not exist!
  Did you mean "casestudy.core__transactions_with_euro"?
  
  LINE 14: from "casestudy"."core"."core__transactions_with_euro"
                ^
[0m05:41:07.927856 [info ] [MainThread]: 
[0m05:41:07.928215 [error] [MainThread]:   Runtime Error in test not_null_core__transactions_with_euro_transaction_id (models/core/core__transactions_with_euro.yml)
  Catalog Error: Table with name core__transactions_with_euro does not exist!
  Did you mean "casestudy.core__transactions_with_euro"?
  
  LINE 14: from "casestudy"."core"."core__transactions_with_euro"
                ^
[0m05:41:07.928568 [info ] [MainThread]: 
[0m05:41:07.929002 [error] [MainThread]:   Runtime Error in test numeric_range_core__transactions_with_euro_transaction_amount__0 (models/core/core__transactions_with_euro.yml)
  Catalog Error: Table with name core__transactions_with_euro does not exist!
  Did you mean "casestudy.core__transactions_with_euro"?
  
  LINE 11:         from "casestudy"."core"."core__transactions_with_euro"
                        ^
[0m05:41:07.929407 [info ] [MainThread]: 
[0m05:41:07.929755 [error] [MainThread]:   Runtime Error in test numeric_range_core__transactions_with_euro_transaction_amount_euro__0 (models/core/core__transactions_with_euro.yml)
  Catalog Error: Table with name core__transactions_with_euro does not exist!
  Did you mean "casestudy.core__transactions_with_euro"?
  
  LINE 11:         from "casestudy"."core"."core__transactions_with_euro"
                        ^
[0m05:41:07.930091 [info ] [MainThread]: 
[0m05:41:07.930541 [error] [MainThread]:   Runtime Error in test unique_core__transactions_with_euro_transaction_id (models/core/core__transactions_with_euro.yml)
  Catalog Error: Table with name core__transactions_with_euro does not exist!
  Did you mean "casestudy.core__transactions_with_euro"?
  
  LINE 15: from "casestudy"."core"."core__transactions_with_euro"
                ^
[0m05:41:07.931082 [info ] [MainThread]: 
[0m05:41:07.931632 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=8 SKIP=0 TOTAL=8
[0m05:41:07.932342 [debug] [MainThread]: Command `dbt test` failed at 05:41:07.932206 after 1.32 seconds
[0m05:41:07.932809 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46438bdb10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4643d50f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4643eaca50>]}
[0m05:41:07.933384 [debug] [MainThread]: Flushing usage events
[0m05:44:37.264533 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdab9729b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdab9a3dc90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdab9a75c50>]}


============================== 05:44:37.270418 | 7403f016-ad34-4d79-b6fb-6c0da5e502cc ==============================
[0m05:44:37.270418 [info ] [MainThread]: Running with dbt=1.6.18
[0m05:44:37.270965 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/workspaces/vg_case_study_tim/transformation', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/workspaces/vg_case_study_tim/transformation/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --select core__transactions_with_euro --full-refresh', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m05:44:37.457789 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7403f016-ad34-4d79-b6fb-6c0da5e502cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdab9717790>]}
[0m05:44:37.471481 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7403f016-ad34-4d79-b6fb-6c0da5e502cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdab9a53ed0>]}
[0m05:44:37.473014 [info ] [MainThread]: Registered adapter: duckdb=1.6.2
[0m05:44:37.500794 [debug] [MainThread]: checksum: 7b9fab86a08e9e96a48a825af743c566d95b877e068b8c6d0dbafbf714447189, vars: {}, profile: , target: , version: 1.6.18
[0m05:44:37.605606 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m05:44:37.606037 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m05:44:37.607572 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.vg_casestudy.marts
- models.vg_casestudy.reporting
- models.vg_casestudy.main
[0m05:44:37.615715 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7403f016-ad34-4d79-b6fb-6c0da5e502cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdab9a3db50>]}
[0m05:44:37.688203 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7403f016-ad34-4d79-b6fb-6c0da5e502cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdab5334490>]}
[0m05:44:37.688847 [info ] [MainThread]: Found 14 models, 1 analysis, 3 seeds, 91 tests, 5 sources, 0 exposures, 0 metrics, 632 macros, 0 groups, 0 semantic models
[0m05:44:37.689225 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7403f016-ad34-4d79-b6fb-6c0da5e502cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdab55b3450>]}
[0m05:44:37.691642 [info ] [MainThread]: 
[0m05:44:37.692415 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m05:44:37.693530 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_casestudy'
[0m05:44:37.707712 [debug] [ThreadPool]: Using duckdb connection "list_casestudy"
[0m05:44:37.708286 [debug] [ThreadPool]: On list_casestudy: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"casestudy"'
    
  
  
[0m05:44:37.708623 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:44:37.847888 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m05:44:37.849324 [debug] [ThreadPool]: On list_casestudy: Close
[0m05:44:37.853389 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy, now create_casestudy_core)
[0m05:44:37.854256 [debug] [ThreadPool]: Creating schema "database: "casestudy"
schema: "core"
"
[0m05:44:37.859637 [debug] [ThreadPool]: Using duckdb connection "create_casestudy_core"
[0m05:44:37.860075 [debug] [ThreadPool]: On create_casestudy_core: BEGIN
[0m05:44:37.860363 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:44:37.871883 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m05:44:37.872315 [debug] [ThreadPool]: Using duckdb connection "create_casestudy_core"
[0m05:44:37.872663 [debug] [ThreadPool]: On create_casestudy_core: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "create_casestudy_core"} */
create schema if not exists "casestudy"."core"
[0m05:44:37.874070 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m05:44:37.874993 [debug] [ThreadPool]: On create_casestudy_core: COMMIT
[0m05:44:37.875305 [debug] [ThreadPool]: Using duckdb connection "create_casestudy_core"
[0m05:44:37.875572 [debug] [ThreadPool]: On create_casestudy_core: COMMIT
[0m05:44:37.880072 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m05:44:37.880474 [debug] [ThreadPool]: On create_casestudy_core: Close
[0m05:44:37.914048 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_casestudy_core, now list_casestudy_staging)
[0m05:44:37.919815 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_staging"
[0m05:44:37.920200 [debug] [ThreadPool]: On list_casestudy_staging: BEGIN
[0m05:44:37.920526 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:44:37.931139 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m05:44:37.931515 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_staging"
[0m05:44:37.931801 [debug] [ThreadPool]: On list_casestudy_staging: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_staging"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'staging'
    and table_catalog = 'casestudy'
  
[0m05:44:37.943985 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m05:44:37.945359 [debug] [ThreadPool]: On list_casestudy_staging: ROLLBACK
[0m05:44:37.946835 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_staging'
[0m05:44:37.947204 [debug] [ThreadPool]: On list_casestudy_staging: Close
[0m05:44:37.950002 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy_staging, now list_casestudy_intermediate)
[0m05:44:37.954118 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_intermediate"
[0m05:44:37.954471 [debug] [ThreadPool]: On list_casestudy_intermediate: BEGIN
[0m05:44:37.954775 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:44:37.965642 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m05:44:37.966011 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_intermediate"
[0m05:44:37.966312 [debug] [ThreadPool]: On list_casestudy_intermediate: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_intermediate"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'intermediate'
    and table_catalog = 'casestudy'
  
[0m05:44:37.974610 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m05:44:37.975944 [debug] [ThreadPool]: On list_casestudy_intermediate: ROLLBACK
[0m05:44:37.976406 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_intermediate'
[0m05:44:37.976688 [debug] [ThreadPool]: On list_casestudy_intermediate: Close
[0m05:44:37.979767 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy_intermediate, now list_casestudy_raw)
[0m05:44:37.981982 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_raw"
[0m05:44:37.982313 [debug] [ThreadPool]: On list_casestudy_raw: BEGIN
[0m05:44:37.983634 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:44:37.994474 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m05:44:37.994854 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_raw"
[0m05:44:37.995160 [debug] [ThreadPool]: On list_casestudy_raw: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_raw"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'raw'
    and table_catalog = 'casestudy'
  
[0m05:44:38.003801 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m05:44:38.005265 [debug] [ThreadPool]: On list_casestudy_raw: ROLLBACK
[0m05:44:38.005734 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_raw'
[0m05:44:38.005995 [debug] [ThreadPool]: On list_casestudy_raw: Close
[0m05:44:38.008998 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy_raw, now list_casestudy_core)
[0m05:44:38.011203 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_core"
[0m05:44:38.011547 [debug] [ThreadPool]: On list_casestudy_core: BEGIN
[0m05:44:38.011885 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:44:38.023419 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m05:44:38.023803 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_core"
[0m05:44:38.024114 [debug] [ThreadPool]: On list_casestudy_core: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_core"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'core'
    and table_catalog = 'casestudy'
  
[0m05:44:38.032424 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m05:44:38.033604 [debug] [ThreadPool]: On list_casestudy_core: ROLLBACK
[0m05:44:38.034061 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_core'
[0m05:44:38.034321 [debug] [ThreadPool]: On list_casestudy_core: Close
[0m05:44:38.037387 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7403f016-ad34-4d79-b6fb-6c0da5e502cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdabb2e4750>]}
[0m05:44:38.037892 [debug] [MainThread]: Using duckdb connection "master"
[0m05:44:38.038174 [debug] [MainThread]: On master: BEGIN
[0m05:44:38.038454 [debug] [MainThread]: Opening a new connection, currently in state init
[0m05:44:38.050739 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m05:44:38.051160 [debug] [MainThread]: On master: COMMIT
[0m05:44:38.051469 [debug] [MainThread]: Using duckdb connection "master"
[0m05:44:38.051740 [debug] [MainThread]: On master: COMMIT
[0m05:44:38.052222 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m05:44:38.052496 [debug] [MainThread]: On master: Close
[0m05:44:38.054784 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m05:44:38.055197 [info ] [MainThread]: 
[0m05:44:38.061083 [debug] [Thread-1 (]: Began running node model.vg_casestudy.core__transactions_with_euro
[0m05:44:38.061627 [info ] [Thread-1 (]: 1 of 1 START sql view model core.core__transactions_with_euro .................. [RUN]
[0m05:44:38.062596 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.vg_casestudy.core__transactions_with_euro'
[0m05:44:38.063050 [debug] [Thread-1 (]: Began compiling node model.vg_casestudy.core__transactions_with_euro
[0m05:44:38.074085 [debug] [Thread-1 (]: Writing injected SQL for node "model.vg_casestudy.core__transactions_with_euro"
[0m05:44:38.075215 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.core__transactions_with_euro (compile): 05:44:38.063335 => 05:44:38.074775
[0m05:44:38.075759 [debug] [Thread-1 (]: Began executing node model.vg_casestudy.core__transactions_with_euro
[0m05:44:38.107259 [debug] [Thread-1 (]: Writing runtime sql for node "model.vg_casestudy.core__transactions_with_euro"
[0m05:44:38.108095 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.core__transactions_with_euro"
[0m05:44:38.108567 [debug] [Thread-1 (]: On model.vg_casestudy.core__transactions_with_euro: BEGIN
[0m05:44:38.108911 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m05:44:38.121501 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m05:44:38.121995 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.core__transactions_with_euro"
[0m05:44:38.122419 [debug] [Thread-1 (]: On model.vg_casestudy.core__transactions_with_euro: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.core__transactions_with_euro"} */

  
  create view "casestudy"."core"."core__transactions_with_euro__dbt_tmp" as (
    with transactions as (
    select *
    from "casestudy"."intermediate"."stg_staging_intermediate__transactions"
),

fx_rates_filled as (
    select *
    from "casestudy"."intermediate"."stg_staging_intermediate_fx_rates_filled"
),

joined as (
    select 
        transactions.transaction_id,
        transactions.transaction_date,
        transactions.account_id,
        transactions.transaction_type,
        transactions.transaction_amount,
        transactions.transaction_currency,
        fx_rates_filled.fx_rate,
        transactions.transaction_amount / nullif(coalesce(fx_rates_filled.fx_rate, 1.0),0) as transaction_amount_euro
    from transactions
    left join fx_rates_filled
    on transactions.transaction_currency = fx_rates_filled.currency_iso_code
    and transactions.transaction_date = fx_rates_filled.fx_rate_date
)

select *
from joined
  );

[0m05:44:38.126488 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m05:44:38.133303 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.core__transactions_with_euro"
[0m05:44:38.133746 [debug] [Thread-1 (]: On model.vg_casestudy.core__transactions_with_euro: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.core__transactions_with_euro"} */
alter view "casestudy"."core"."core__transactions_with_euro__dbt_tmp" rename to "core__transactions_with_euro"
[0m05:44:38.134756 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m05:44:38.148108 [debug] [Thread-1 (]: On model.vg_casestudy.core__transactions_with_euro: COMMIT
[0m05:44:38.148529 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.core__transactions_with_euro"
[0m05:44:38.148854 [debug] [Thread-1 (]: On model.vg_casestudy.core__transactions_with_euro: COMMIT
[0m05:44:38.154324 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m05:44:38.159303 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.core__transactions_with_euro"
[0m05:44:38.159699 [debug] [Thread-1 (]: On model.vg_casestudy.core__transactions_with_euro: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.core__transactions_with_euro"} */
drop view if exists "casestudy"."core"."core__transactions_with_euro__dbt_backup" cascade
[0m05:44:38.160527 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m05:44:38.161773 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.core__transactions_with_euro (execute): 05:44:38.076022 => 05:44:38.161627
[0m05:44:38.162123 [debug] [Thread-1 (]: On model.vg_casestudy.core__transactions_with_euro: Close
[0m05:44:38.186540 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7403f016-ad34-4d79-b6fb-6c0da5e502cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdab949a190>]}
[0m05:44:38.187325 [info ] [Thread-1 (]: 1 of 1 OK created sql view model core.core__transactions_with_euro ............. [[32mOK[0m in 0.12s]
[0m05:44:38.188017 [debug] [Thread-1 (]: Finished running node model.vg_casestudy.core__transactions_with_euro
[0m05:44:38.189910 [debug] [MainThread]: Using duckdb connection "master"
[0m05:44:38.190249 [debug] [MainThread]: On master: BEGIN
[0m05:44:38.190537 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m05:44:38.204676 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m05:44:38.205117 [debug] [MainThread]: On master: COMMIT
[0m05:44:38.205463 [debug] [MainThread]: Using duckdb connection "master"
[0m05:44:38.205820 [debug] [MainThread]: On master: COMMIT
[0m05:44:38.206680 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m05:44:38.207298 [debug] [MainThread]: On master: Close
[0m05:44:38.209953 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:44:38.210305 [debug] [MainThread]: Connection 'list_casestudy_core' was properly closed.
[0m05:44:38.210570 [debug] [MainThread]: Connection 'model.vg_casestudy.core__transactions_with_euro' was properly closed.
[0m05:44:38.210884 [info ] [MainThread]: 
[0m05:44:38.211203 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.52 seconds (0.52s).
[0m05:44:38.211802 [debug] [MainThread]: Command end result
[0m05:44:38.231471 [info ] [MainThread]: 
[0m05:44:38.232014 [info ] [MainThread]: [32mCompleted successfully[0m
[0m05:44:38.232364 [info ] [MainThread]: 
[0m05:44:38.232682 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m05:44:38.233141 [debug] [MainThread]: Command `dbt run` succeeded at 05:44:38.233044 after 0.98 seconds
[0m05:44:38.233491 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdabe0f70d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdabe0f6390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdab9905190>]}
[0m05:44:38.233831 [debug] [MainThread]: Flushing usage events
[0m05:45:12.683472 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3cd7ae1ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3cd7ae0850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3cd92c2950>]}


============================== 05:45:12.688720 | fde7cc95-50c1-4d2c-ad97-f2a86e424d5e ==============================
[0m05:45:12.688720 [info ] [MainThread]: Running with dbt=1.6.18
[0m05:45:12.689306 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/workspaces/vg_case_study_tim/transformation', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/workspaces/vg_case_study_tim/transformation/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt test --select core__transactions_with_euro', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m05:45:12.914977 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fde7cc95-50c1-4d2c-ad97-f2a86e424d5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3cd7678290>]}
[0m05:45:12.930121 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fde7cc95-50c1-4d2c-ad97-f2a86e424d5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3cd76af4d0>]}
[0m05:45:12.931593 [info ] [MainThread]: Registered adapter: duckdb=1.6.2
[0m05:45:12.960271 [debug] [MainThread]: checksum: 7b9fab86a08e9e96a48a825af743c566d95b877e068b8c6d0dbafbf714447189, vars: {}, profile: , target: , version: 1.6.18
[0m05:45:13.065348 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m05:45:13.065787 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m05:45:13.067572 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.vg_casestudy.marts
- models.vg_casestudy.main
- models.vg_casestudy.reporting
[0m05:45:13.076278 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fde7cc95-50c1-4d2c-ad97-f2a86e424d5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3cd3649210>]}
[0m05:45:13.157202 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fde7cc95-50c1-4d2c-ad97-f2a86e424d5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3cd87d5ed0>]}
[0m05:45:13.157869 [info ] [MainThread]: Found 14 models, 1 analysis, 3 seeds, 91 tests, 5 sources, 0 exposures, 0 metrics, 632 macros, 0 groups, 0 semantic models
[0m05:45:13.158311 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fde7cc95-50c1-4d2c-ad97-f2a86e424d5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3cd79c4dd0>]}
[0m05:45:13.161459 [info ] [MainThread]: 
[0m05:45:13.162446 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m05:45:13.165720 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_casestudy_staging'
[0m05:45:13.179245 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_staging"
[0m05:45:13.179749 [debug] [ThreadPool]: On list_casestudy_staging: BEGIN
[0m05:45:13.180123 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:45:13.301686 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m05:45:13.302166 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_staging"
[0m05:45:13.302538 [debug] [ThreadPool]: On list_casestudy_staging: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_staging"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'staging'
    and table_catalog = 'casestudy'
  
[0m05:45:13.323266 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m05:45:13.324944 [debug] [ThreadPool]: On list_casestudy_staging: ROLLBACK
[0m05:45:13.326117 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_staging'
[0m05:45:13.326479 [debug] [ThreadPool]: On list_casestudy_staging: Close
[0m05:45:13.329821 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy_staging, now list_casestudy_core)
[0m05:45:13.333398 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_core"
[0m05:45:13.333811 [debug] [ThreadPool]: On list_casestudy_core: BEGIN
[0m05:45:13.334115 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:45:13.345431 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m05:45:13.345942 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_core"
[0m05:45:13.346321 [debug] [ThreadPool]: On list_casestudy_core: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_core"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'core'
    and table_catalog = 'casestudy'
  
[0m05:45:13.356212 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m05:45:13.357757 [debug] [ThreadPool]: On list_casestudy_core: ROLLBACK
[0m05:45:13.358482 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_core'
[0m05:45:13.358854 [debug] [ThreadPool]: On list_casestudy_core: Close
[0m05:45:13.362060 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy_core, now list_casestudy_raw)
[0m05:45:13.364421 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_raw"
[0m05:45:13.364772 [debug] [ThreadPool]: On list_casestudy_raw: BEGIN
[0m05:45:13.365077 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:45:13.376768 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m05:45:13.377188 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_raw"
[0m05:45:13.377541 [debug] [ThreadPool]: On list_casestudy_raw: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_raw"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'raw'
    and table_catalog = 'casestudy'
  
[0m05:45:13.385766 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m05:45:13.387112 [debug] [ThreadPool]: On list_casestudy_raw: ROLLBACK
[0m05:45:13.387584 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_raw'
[0m05:45:13.387850 [debug] [ThreadPool]: On list_casestudy_raw: Close
[0m05:45:13.392048 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy_raw, now list_casestudy_intermediate)
[0m05:45:13.395348 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_intermediate"
[0m05:45:13.395699 [debug] [ThreadPool]: On list_casestudy_intermediate: BEGIN
[0m05:45:13.395974 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:45:13.406461 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m05:45:13.406841 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_intermediate"
[0m05:45:13.407128 [debug] [ThreadPool]: On list_casestudy_intermediate: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_intermediate"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'intermediate'
    and table_catalog = 'casestudy'
  
[0m05:45:13.415836 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m05:45:13.417403 [debug] [ThreadPool]: On list_casestudy_intermediate: ROLLBACK
[0m05:45:13.417904 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_intermediate'
[0m05:45:13.418177 [debug] [ThreadPool]: On list_casestudy_intermediate: Close
[0m05:45:13.422443 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fde7cc95-50c1-4d2c-ad97-f2a86e424d5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3cd93570d0>]}
[0m05:45:13.423032 [debug] [MainThread]: Using duckdb connection "master"
[0m05:45:13.423426 [debug] [MainThread]: On master: BEGIN
[0m05:45:13.423728 [debug] [MainThread]: Opening a new connection, currently in state init
[0m05:45:13.437213 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m05:45:13.437625 [debug] [MainThread]: On master: COMMIT
[0m05:45:13.437921 [debug] [MainThread]: Using duckdb connection "master"
[0m05:45:13.438181 [debug] [MainThread]: On master: COMMIT
[0m05:45:13.438953 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m05:45:13.439364 [debug] [MainThread]: On master: Close
[0m05:45:13.443482 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m05:45:13.443994 [info ] [MainThread]: 
[0m05:45:13.450367 [debug] [Thread-1 (]: Began running node test.vg_casestudy.not_null_core__transactions_with_euro_account_id.2c4215ab21
[0m05:45:13.450832 [info ] [Thread-1 (]: 1 of 8 START test not_null_core__transactions_with_euro_account_id ............. [RUN]
[0m05:45:13.451732 [debug] [Thread-1 (]: Acquiring new duckdb connection 'test.vg_casestudy.not_null_core__transactions_with_euro_account_id.2c4215ab21'
[0m05:45:13.452134 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.not_null_core__transactions_with_euro_account_id.2c4215ab21
[0m05:45:13.471657 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.not_null_core__transactions_with_euro_account_id.2c4215ab21"
[0m05:45:13.472571 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_core__transactions_with_euro_account_id.2c4215ab21 (compile): 05:45:13.452391 => 05:45:13.472238
[0m05:45:13.472996 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.not_null_core__transactions_with_euro_account_id.2c4215ab21
[0m05:45:13.486529 [debug] [Thread-1 (]: Writing runtime sql for node "test.vg_casestudy.not_null_core__transactions_with_euro_account_id.2c4215ab21"
[0m05:45:13.487246 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.not_null_core__transactions_with_euro_account_id.2c4215ab21"
[0m05:45:13.487705 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_core__transactions_with_euro_account_id.2c4215ab21: BEGIN
[0m05:45:13.488024 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m05:45:13.503835 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m05:45:13.504324 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.not_null_core__transactions_with_euro_account_id.2c4215ab21"
[0m05:45:13.504691 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_core__transactions_with_euro_account_id.2c4215ab21: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "test.vg_casestudy.not_null_core__transactions_with_euro_account_id.2c4215ab21"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select account_id
from "casestudy"."core"."core__transactions_with_euro"
where account_id is null



      
    ) dbt_internal_test
[0m05:45:13.514778 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m05:45:13.518010 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_core__transactions_with_euro_account_id.2c4215ab21 (execute): 05:45:13.473282 => 05:45:13.517774
[0m05:45:13.518435 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_core__transactions_with_euro_account_id.2c4215ab21: ROLLBACK
[0m05:45:13.518931 [debug] [Thread-1 (]: Failed to rollback 'test.vg_casestudy.not_null_core__transactions_with_euro_account_id.2c4215ab21'
[0m05:45:13.519258 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_core__transactions_with_euro_account_id.2c4215ab21: Close
[0m05:45:13.521759 [info ] [Thread-1 (]: 1 of 8 PASS not_null_core__transactions_with_euro_account_id ................... [[32mPASS[0m in 0.07s]
[0m05:45:13.522406 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.not_null_core__transactions_with_euro_account_id.2c4215ab21
[0m05:45:13.522921 [debug] [Thread-1 (]: Began running node test.vg_casestudy.not_null_core__transactions_with_euro_transaction_amount.7130175b19
[0m05:45:13.523323 [info ] [Thread-1 (]: 2 of 8 START test not_null_core__transactions_with_euro_transaction_amount ..... [RUN]
[0m05:45:13.524245 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.not_null_core__transactions_with_euro_account_id.2c4215ab21, now test.vg_casestudy.not_null_core__transactions_with_euro_transaction_amount.7130175b19)
[0m05:45:13.525067 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.not_null_core__transactions_with_euro_transaction_amount.7130175b19
[0m05:45:13.530367 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.not_null_core__transactions_with_euro_transaction_amount.7130175b19"
[0m05:45:13.531266 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_core__transactions_with_euro_transaction_amount.7130175b19 (compile): 05:45:13.525382 => 05:45:13.530976
[0m05:45:13.531679 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.not_null_core__transactions_with_euro_transaction_amount.7130175b19
[0m05:45:13.535245 [debug] [Thread-1 (]: Writing runtime sql for node "test.vg_casestudy.not_null_core__transactions_with_euro_transaction_amount.7130175b19"
[0m05:45:13.536128 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.not_null_core__transactions_with_euro_transaction_amount.7130175b19"
[0m05:45:13.536631 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_core__transactions_with_euro_transaction_amount.7130175b19: BEGIN
[0m05:45:13.537109 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:45:13.550262 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m05:45:13.550768 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.not_null_core__transactions_with_euro_transaction_amount.7130175b19"
[0m05:45:13.551127 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_core__transactions_with_euro_transaction_amount.7130175b19: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "test.vg_casestudy.not_null_core__transactions_with_euro_transaction_amount.7130175b19"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select transaction_amount
from "casestudy"."core"."core__transactions_with_euro"
where transaction_amount is null



      
    ) dbt_internal_test
[0m05:45:13.554771 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m05:45:13.556341 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_core__transactions_with_euro_transaction_amount.7130175b19 (execute): 05:45:13.531927 => 05:45:13.556114
[0m05:45:13.556876 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_core__transactions_with_euro_transaction_amount.7130175b19: ROLLBACK
[0m05:45:13.557394 [debug] [Thread-1 (]: Failed to rollback 'test.vg_casestudy.not_null_core__transactions_with_euro_transaction_amount.7130175b19'
[0m05:45:13.557784 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_core__transactions_with_euro_transaction_amount.7130175b19: Close
[0m05:45:13.560954 [info ] [Thread-1 (]: 2 of 8 PASS not_null_core__transactions_with_euro_transaction_amount ........... [[32mPASS[0m in 0.04s]
[0m05:45:13.561663 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.not_null_core__transactions_with_euro_transaction_amount.7130175b19
[0m05:45:13.562088 [debug] [Thread-1 (]: Began running node test.vg_casestudy.not_null_core__transactions_with_euro_transaction_amount_euro.d6c3b5cd24
[0m05:45:13.562638 [info ] [Thread-1 (]: 3 of 8 START test not_null_core__transactions_with_euro_transaction_amount_euro  [RUN]
[0m05:45:13.563579 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.not_null_core__transactions_with_euro_transaction_amount.7130175b19, now test.vg_casestudy.not_null_core__transactions_with_euro_transaction_amount_euro.d6c3b5cd24)
[0m05:45:13.564059 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.not_null_core__transactions_with_euro_transaction_amount_euro.d6c3b5cd24
[0m05:45:13.568840 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.not_null_core__transactions_with_euro_transaction_amount_euro.d6c3b5cd24"
[0m05:45:13.569612 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_core__transactions_with_euro_transaction_amount_euro.d6c3b5cd24 (compile): 05:45:13.564354 => 05:45:13.569357
[0m05:45:13.570003 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.not_null_core__transactions_with_euro_transaction_amount_euro.d6c3b5cd24
[0m05:45:13.572708 [debug] [Thread-1 (]: Writing runtime sql for node "test.vg_casestudy.not_null_core__transactions_with_euro_transaction_amount_euro.d6c3b5cd24"
[0m05:45:13.573318 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.not_null_core__transactions_with_euro_transaction_amount_euro.d6c3b5cd24"
[0m05:45:13.573671 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_core__transactions_with_euro_transaction_amount_euro.d6c3b5cd24: BEGIN
[0m05:45:13.573997 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:45:13.586997 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m05:45:13.587482 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.not_null_core__transactions_with_euro_transaction_amount_euro.d6c3b5cd24"
[0m05:45:13.587826 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_core__transactions_with_euro_transaction_amount_euro.d6c3b5cd24: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "test.vg_casestudy.not_null_core__transactions_with_euro_transaction_amount_euro.d6c3b5cd24"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select transaction_amount_euro
from "casestudy"."core"."core__transactions_with_euro"
where transaction_amount_euro is null



      
    ) dbt_internal_test
[0m05:45:13.599836 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m05:45:13.601689 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_core__transactions_with_euro_transaction_amount_euro.d6c3b5cd24 (execute): 05:45:13.570233 => 05:45:13.601476
[0m05:45:13.602108 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_core__transactions_with_euro_transaction_amount_euro.d6c3b5cd24: ROLLBACK
[0m05:45:13.602664 [debug] [Thread-1 (]: Failed to rollback 'test.vg_casestudy.not_null_core__transactions_with_euro_transaction_amount_euro.d6c3b5cd24'
[0m05:45:13.603021 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_core__transactions_with_euro_transaction_amount_euro.d6c3b5cd24: Close
[0m05:45:13.605822 [info ] [Thread-1 (]: 3 of 8 PASS not_null_core__transactions_with_euro_transaction_amount_euro ...... [[32mPASS[0m in 0.04s]
[0m05:45:13.606445 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.not_null_core__transactions_with_euro_transaction_amount_euro.d6c3b5cd24
[0m05:45:13.606851 [debug] [Thread-1 (]: Began running node test.vg_casestudy.not_null_core__transactions_with_euro_transaction_date.b09759e145
[0m05:45:13.607428 [info ] [Thread-1 (]: 4 of 8 START test not_null_core__transactions_with_euro_transaction_date ....... [RUN]
[0m05:45:13.608216 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.not_null_core__transactions_with_euro_transaction_amount_euro.d6c3b5cd24, now test.vg_casestudy.not_null_core__transactions_with_euro_transaction_date.b09759e145)
[0m05:45:13.608672 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.not_null_core__transactions_with_euro_transaction_date.b09759e145
[0m05:45:13.613044 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.not_null_core__transactions_with_euro_transaction_date.b09759e145"
[0m05:45:13.613812 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_core__transactions_with_euro_transaction_date.b09759e145 (compile): 05:45:13.608934 => 05:45:13.613542
[0m05:45:13.614297 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.not_null_core__transactions_with_euro_transaction_date.b09759e145
[0m05:45:13.617115 [debug] [Thread-1 (]: Writing runtime sql for node "test.vg_casestudy.not_null_core__transactions_with_euro_transaction_date.b09759e145"
[0m05:45:13.617910 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.not_null_core__transactions_with_euro_transaction_date.b09759e145"
[0m05:45:13.618334 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_core__transactions_with_euro_transaction_date.b09759e145: BEGIN
[0m05:45:13.618645 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:45:13.632610 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m05:45:13.633130 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.not_null_core__transactions_with_euro_transaction_date.b09759e145"
[0m05:45:13.633502 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_core__transactions_with_euro_transaction_date.b09759e145: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "test.vg_casestudy.not_null_core__transactions_with_euro_transaction_date.b09759e145"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select transaction_date
from "casestudy"."core"."core__transactions_with_euro"
where transaction_date is null



      
    ) dbt_internal_test
[0m05:45:13.636369 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m05:45:13.637992 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_core__transactions_with_euro_transaction_date.b09759e145 (execute): 05:45:13.614576 => 05:45:13.637752
[0m05:45:13.638375 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_core__transactions_with_euro_transaction_date.b09759e145: ROLLBACK
[0m05:45:13.638857 [debug] [Thread-1 (]: Failed to rollback 'test.vg_casestudy.not_null_core__transactions_with_euro_transaction_date.b09759e145'
[0m05:45:13.639189 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_core__transactions_with_euro_transaction_date.b09759e145: Close
[0m05:45:13.641854 [info ] [Thread-1 (]: 4 of 8 PASS not_null_core__transactions_with_euro_transaction_date ............. [[32mPASS[0m in 0.03s]
[0m05:45:13.642767 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.not_null_core__transactions_with_euro_transaction_date.b09759e145
[0m05:45:13.643304 [debug] [Thread-1 (]: Began running node test.vg_casestudy.not_null_core__transactions_with_euro_transaction_id.f75c556915
[0m05:45:13.643875 [info ] [Thread-1 (]: 5 of 8 START test not_null_core__transactions_with_euro_transaction_id ......... [RUN]
[0m05:45:13.644621 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.not_null_core__transactions_with_euro_transaction_date.b09759e145, now test.vg_casestudy.not_null_core__transactions_with_euro_transaction_id.f75c556915)
[0m05:45:13.644962 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.not_null_core__transactions_with_euro_transaction_id.f75c556915
[0m05:45:13.649191 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.not_null_core__transactions_with_euro_transaction_id.f75c556915"
[0m05:45:13.649979 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_core__transactions_with_euro_transaction_id.f75c556915 (compile): 05:45:13.645184 => 05:45:13.649729
[0m05:45:13.650387 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.not_null_core__transactions_with_euro_transaction_id.f75c556915
[0m05:45:13.654837 [debug] [Thread-1 (]: Writing runtime sql for node "test.vg_casestudy.not_null_core__transactions_with_euro_transaction_id.f75c556915"
[0m05:45:13.655476 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.not_null_core__transactions_with_euro_transaction_id.f75c556915"
[0m05:45:13.655843 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_core__transactions_with_euro_transaction_id.f75c556915: BEGIN
[0m05:45:13.656141 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:45:13.668775 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m05:45:13.669249 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.not_null_core__transactions_with_euro_transaction_id.f75c556915"
[0m05:45:13.669579 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_core__transactions_with_euro_transaction_id.f75c556915: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "test.vg_casestudy.not_null_core__transactions_with_euro_transaction_id.f75c556915"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select transaction_id
from "casestudy"."core"."core__transactions_with_euro"
where transaction_id is null



      
    ) dbt_internal_test
[0m05:45:13.672087 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m05:45:13.673726 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_core__transactions_with_euro_transaction_id.f75c556915 (execute): 05:45:13.650724 => 05:45:13.673491
[0m05:45:13.674098 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_core__transactions_with_euro_transaction_id.f75c556915: ROLLBACK
[0m05:45:13.674572 [debug] [Thread-1 (]: Failed to rollback 'test.vg_casestudy.not_null_core__transactions_with_euro_transaction_id.f75c556915'
[0m05:45:13.674916 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_core__transactions_with_euro_transaction_id.f75c556915: Close
[0m05:45:13.677801 [info ] [Thread-1 (]: 5 of 8 PASS not_null_core__transactions_with_euro_transaction_id ............... [[32mPASS[0m in 0.03s]
[0m05:45:13.678488 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.not_null_core__transactions_with_euro_transaction_id.f75c556915
[0m05:45:13.678900 [debug] [Thread-1 (]: Began running node test.vg_casestudy.numeric_range_core__transactions_with_euro_transaction_amount__0.b4dc525fde
[0m05:45:13.679260 [info ] [Thread-1 (]: 6 of 8 START test numeric_range_core__transactions_with_euro_transaction_amount__0  [RUN]
[0m05:45:13.679977 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.not_null_core__transactions_with_euro_transaction_id.f75c556915, now test.vg_casestudy.numeric_range_core__transactions_with_euro_transaction_amount__0.b4dc525fde)
[0m05:45:13.680479 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.numeric_range_core__transactions_with_euro_transaction_amount__0.b4dc525fde
[0m05:45:13.688031 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.numeric_range_core__transactions_with_euro_transaction_amount__0.b4dc525fde"
[0m05:45:13.688811 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.numeric_range_core__transactions_with_euro_transaction_amount__0.b4dc525fde (compile): 05:45:13.680731 => 05:45:13.688586
[0m05:45:13.689183 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.numeric_range_core__transactions_with_euro_transaction_amount__0.b4dc525fde
[0m05:45:13.692129 [debug] [Thread-1 (]: Writing runtime sql for node "test.vg_casestudy.numeric_range_core__transactions_with_euro_transaction_amount__0.b4dc525fde"
[0m05:45:13.692899 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.numeric_range_core__transactions_with_euro_transaction_amount__0.b4dc525fde"
[0m05:45:13.693307 [debug] [Thread-1 (]: On test.vg_casestudy.numeric_range_core__transactions_with_euro_transaction_amount__0.b4dc525fde: BEGIN
[0m05:45:13.693624 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:45:13.706817 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m05:45:13.707349 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.numeric_range_core__transactions_with_euro_transaction_amount__0.b4dc525fde"
[0m05:45:13.707710 [debug] [Thread-1 (]: On test.vg_casestudy.numeric_range_core__transactions_with_euro_transaction_amount__0.b4dc525fde: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "test.vg_casestudy.numeric_range_core__transactions_with_euro_transaction_amount__0.b4dc525fde"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

    
        select *
        from "casestudy"."core"."core__transactions_with_euro"
        where transaction_amount < 0
    
    


      
    ) dbt_internal_test
[0m05:45:13.710791 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m05:45:13.712456 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.numeric_range_core__transactions_with_euro_transaction_amount__0.b4dc525fde (execute): 05:45:13.689420 => 05:45:13.712241
[0m05:45:13.712930 [debug] [Thread-1 (]: On test.vg_casestudy.numeric_range_core__transactions_with_euro_transaction_amount__0.b4dc525fde: ROLLBACK
[0m05:45:13.713386 [debug] [Thread-1 (]: Failed to rollback 'test.vg_casestudy.numeric_range_core__transactions_with_euro_transaction_amount__0.b4dc525fde'
[0m05:45:13.713710 [debug] [Thread-1 (]: On test.vg_casestudy.numeric_range_core__transactions_with_euro_transaction_amount__0.b4dc525fde: Close
[0m05:45:13.716312 [info ] [Thread-1 (]: 6 of 8 PASS numeric_range_core__transactions_with_euro_transaction_amount__0 ... [[32mPASS[0m in 0.04s]
[0m05:45:13.716907 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.numeric_range_core__transactions_with_euro_transaction_amount__0.b4dc525fde
[0m05:45:13.717323 [debug] [Thread-1 (]: Began running node test.vg_casestudy.numeric_range_core__transactions_with_euro_transaction_amount_euro__0.751c1dfde7
[0m05:45:13.717709 [info ] [Thread-1 (]: 7 of 8 START test numeric_range_core__transactions_with_euro_transaction_amount_euro__0  [RUN]
[0m05:45:13.718613 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.numeric_range_core__transactions_with_euro_transaction_amount__0.b4dc525fde, now test.vg_casestudy.numeric_range_core__transactions_with_euro_transaction_amount_euro__0.751c1dfde7)
[0m05:45:13.718987 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.numeric_range_core__transactions_with_euro_transaction_amount_euro__0.751c1dfde7
[0m05:45:13.723210 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.numeric_range_core__transactions_with_euro_transaction_amount_euro__0.751c1dfde7"
[0m05:45:13.723867 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.numeric_range_core__transactions_with_euro_transaction_amount_euro__0.751c1dfde7 (compile): 05:45:13.719212 => 05:45:13.723641
[0m05:45:13.724329 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.numeric_range_core__transactions_with_euro_transaction_amount_euro__0.751c1dfde7
[0m05:45:13.727476 [debug] [Thread-1 (]: Writing runtime sql for node "test.vg_casestudy.numeric_range_core__transactions_with_euro_transaction_amount_euro__0.751c1dfde7"
[0m05:45:13.728493 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.numeric_range_core__transactions_with_euro_transaction_amount_euro__0.751c1dfde7"
[0m05:45:13.729236 [debug] [Thread-1 (]: On test.vg_casestudy.numeric_range_core__transactions_with_euro_transaction_amount_euro__0.751c1dfde7: BEGIN
[0m05:45:13.729811 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:45:13.742451 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m05:45:13.743110 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.numeric_range_core__transactions_with_euro_transaction_amount_euro__0.751c1dfde7"
[0m05:45:13.743485 [debug] [Thread-1 (]: On test.vg_casestudy.numeric_range_core__transactions_with_euro_transaction_amount_euro__0.751c1dfde7: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "test.vg_casestudy.numeric_range_core__transactions_with_euro_transaction_amount_euro__0.751c1dfde7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

    
        select *
        from "casestudy"."core"."core__transactions_with_euro"
        where transaction_amount_euro < 0
    
    


      
    ) dbt_internal_test
[0m05:45:13.750630 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m05:45:13.752195 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.numeric_range_core__transactions_with_euro_transaction_amount_euro__0.751c1dfde7 (execute): 05:45:13.724671 => 05:45:13.751957
[0m05:45:13.752622 [debug] [Thread-1 (]: On test.vg_casestudy.numeric_range_core__transactions_with_euro_transaction_amount_euro__0.751c1dfde7: ROLLBACK
[0m05:45:13.753098 [debug] [Thread-1 (]: Failed to rollback 'test.vg_casestudy.numeric_range_core__transactions_with_euro_transaction_amount_euro__0.751c1dfde7'
[0m05:45:13.753418 [debug] [Thread-1 (]: On test.vg_casestudy.numeric_range_core__transactions_with_euro_transaction_amount_euro__0.751c1dfde7: Close
[0m05:45:13.756017 [info ] [Thread-1 (]: 7 of 8 PASS numeric_range_core__transactions_with_euro_transaction_amount_euro__0  [[32mPASS[0m in 0.04s]
[0m05:45:13.756647 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.numeric_range_core__transactions_with_euro_transaction_amount_euro__0.751c1dfde7
[0m05:45:13.757073 [debug] [Thread-1 (]: Began running node test.vg_casestudy.unique_core__transactions_with_euro_transaction_id.524c820bba
[0m05:45:13.757443 [info ] [Thread-1 (]: 8 of 8 START test unique_core__transactions_with_euro_transaction_id ........... [RUN]
[0m05:45:13.758370 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.numeric_range_core__transactions_with_euro_transaction_amount_euro__0.751c1dfde7, now test.vg_casestudy.unique_core__transactions_with_euro_transaction_id.524c820bba)
[0m05:45:13.758772 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.unique_core__transactions_with_euro_transaction_id.524c820bba
[0m05:45:13.765348 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.unique_core__transactions_with_euro_transaction_id.524c820bba"
[0m05:45:13.766332 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.unique_core__transactions_with_euro_transaction_id.524c820bba (compile): 05:45:13.759025 => 05:45:13.766055
[0m05:45:13.766816 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.unique_core__transactions_with_euro_transaction_id.524c820bba
[0m05:45:13.769778 [debug] [Thread-1 (]: Writing runtime sql for node "test.vg_casestudy.unique_core__transactions_with_euro_transaction_id.524c820bba"
[0m05:45:13.770509 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.unique_core__transactions_with_euro_transaction_id.524c820bba"
[0m05:45:13.770879 [debug] [Thread-1 (]: On test.vg_casestudy.unique_core__transactions_with_euro_transaction_id.524c820bba: BEGIN
[0m05:45:13.771184 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:45:13.784080 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m05:45:13.784589 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.unique_core__transactions_with_euro_transaction_id.524c820bba"
[0m05:45:13.784949 [debug] [Thread-1 (]: On test.vg_casestudy.unique_core__transactions_with_euro_transaction_id.524c820bba: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "test.vg_casestudy.unique_core__transactions_with_euro_transaction_id.524c820bba"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    transaction_id as unique_field,
    count(*) as n_records

from "casestudy"."core"."core__transactions_with_euro"
where transaction_id is not null
group by transaction_id
having count(*) > 1



      
    ) dbt_internal_test
[0m05:45:13.800573 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m05:45:13.802322 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.unique_core__transactions_with_euro_transaction_id.524c820bba (execute): 05:45:13.767091 => 05:45:13.802112
[0m05:45:13.802787 [debug] [Thread-1 (]: On test.vg_casestudy.unique_core__transactions_with_euro_transaction_id.524c820bba: ROLLBACK
[0m05:45:13.803247 [debug] [Thread-1 (]: Failed to rollback 'test.vg_casestudy.unique_core__transactions_with_euro_transaction_id.524c820bba'
[0m05:45:13.803546 [debug] [Thread-1 (]: On test.vg_casestudy.unique_core__transactions_with_euro_transaction_id.524c820bba: Close
[0m05:45:13.806702 [info ] [Thread-1 (]: 8 of 8 PASS unique_core__transactions_with_euro_transaction_id ................. [[32mPASS[0m in 0.05s]
[0m05:45:13.807374 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.unique_core__transactions_with_euro_transaction_id.524c820bba
[0m05:45:13.809730 [debug] [MainThread]: Using duckdb connection "master"
[0m05:45:13.810078 [debug] [MainThread]: On master: BEGIN
[0m05:45:13.810358 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m05:45:13.825676 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m05:45:13.826166 [debug] [MainThread]: On master: COMMIT
[0m05:45:13.826590 [debug] [MainThread]: Using duckdb connection "master"
[0m05:45:13.826912 [debug] [MainThread]: On master: COMMIT
[0m05:45:13.828109 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m05:45:13.828650 [debug] [MainThread]: On master: Close
[0m05:45:13.831537 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:45:13.831982 [debug] [MainThread]: Connection 'list_casestudy_intermediate' was properly closed.
[0m05:45:13.832303 [debug] [MainThread]: Connection 'test.vg_casestudy.unique_core__transactions_with_euro_transaction_id.524c820bba' was properly closed.
[0m05:45:13.832777 [info ] [MainThread]: 
[0m05:45:13.833173 [info ] [MainThread]: Finished running 8 tests in 0 hours 0 minutes and 0.67 seconds (0.67s).
[0m05:45:13.834674 [debug] [MainThread]: Command end result
[0m05:45:13.854267 [info ] [MainThread]: 
[0m05:45:13.854757 [info ] [MainThread]: [32mCompleted successfully[0m
[0m05:45:13.855093 [info ] [MainThread]: 
[0m05:45:13.855410 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=0 SKIP=0 TOTAL=8
[0m05:45:13.855909 [debug] [MainThread]: Command `dbt test` succeeded at 05:45:13.855810 after 1.18 seconds
[0m05:45:13.856255 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3cd7806990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3cd7802c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3cd943dc50>]}
[0m05:45:13.856677 [debug] [MainThread]: Flushing usage events
[0m05:50:02.388384 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f869f8c2090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f869faa2290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f869f757b10>]}


============================== 05:50:02.393847 | ff348ac6-1147-498f-b1f5-704d05c84426 ==============================
[0m05:50:02.393847 [info ] [MainThread]: Running with dbt=1.6.18
[0m05:50:02.394401 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/workspaces/vg_case_study_tim/transformation', 'version_check': 'True', 'debug': 'False', 'log_path': '/workspaces/vg_case_study_tim/transformation/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --select core__customers_enriched --full-refresh', 'send_anonymous_usage_stats': 'True'}
[0m05:50:02.588256 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ff348ac6-1147-498f-b1f5-704d05c84426', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f869f8c36d0>]}
[0m05:50:02.603087 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ff348ac6-1147-498f-b1f5-704d05c84426', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f869fa979d0>]}
[0m05:50:02.604543 [info ] [MainThread]: Registered adapter: duckdb=1.6.2
[0m05:50:02.632727 [debug] [MainThread]: checksum: 7b9fab86a08e9e96a48a825af743c566d95b877e068b8c6d0dbafbf714447189, vars: {}, profile: , target: , version: 1.6.18
[0m05:50:02.732981 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m05:50:02.733417 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m05:50:02.734878 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.vg_casestudy.reporting
- models.vg_casestudy.marts
- models.vg_casestudy.main
[0m05:50:02.742992 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ff348ac6-1147-498f-b1f5-704d05c84426', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f869b43e510>]}
[0m05:50:02.815433 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ff348ac6-1147-498f-b1f5-704d05c84426', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f869b4a1290>]}
[0m05:50:02.816010 [info ] [MainThread]: Found 14 models, 1 analysis, 3 seeds, 91 tests, 5 sources, 0 exposures, 0 metrics, 632 macros, 0 groups, 0 semantic models
[0m05:50:02.816423 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ff348ac6-1147-498f-b1f5-704d05c84426', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f869b3fbe90>]}
[0m05:50:02.818898 [info ] [MainThread]: 
[0m05:50:02.819708 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m05:50:02.821602 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_casestudy'
[0m05:50:02.834764 [debug] [ThreadPool]: Using duckdb connection "list_casestudy"
[0m05:50:02.835268 [debug] [ThreadPool]: On list_casestudy: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"casestudy"'
    
  
  
[0m05:50:02.835630 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:50:02.970473 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m05:50:02.972025 [debug] [ThreadPool]: On list_casestudy: Close
[0m05:50:03.000835 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy, now create_casestudy_core)
[0m05:50:03.001761 [debug] [ThreadPool]: Creating schema "database: "casestudy"
schema: "core"
"
[0m05:50:03.006239 [debug] [ThreadPool]: Using duckdb connection "create_casestudy_core"
[0m05:50:03.006605 [debug] [ThreadPool]: On create_casestudy_core: BEGIN
[0m05:50:03.006883 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:50:03.017782 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m05:50:03.018188 [debug] [ThreadPool]: Using duckdb connection "create_casestudy_core"
[0m05:50:03.018470 [debug] [ThreadPool]: On create_casestudy_core: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "create_casestudy_core"} */
create schema if not exists "casestudy"."core"
[0m05:50:03.019142 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m05:50:03.019993 [debug] [ThreadPool]: On create_casestudy_core: COMMIT
[0m05:50:03.020271 [debug] [ThreadPool]: Using duckdb connection "create_casestudy_core"
[0m05:50:03.020547 [debug] [ThreadPool]: On create_casestudy_core: COMMIT
[0m05:50:03.021033 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m05:50:03.021351 [debug] [ThreadPool]: On create_casestudy_core: Close
[0m05:50:03.025604 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_casestudy_core, now list_casestudy_staging)
[0m05:50:03.030804 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_staging"
[0m05:50:03.031139 [debug] [ThreadPool]: On list_casestudy_staging: BEGIN
[0m05:50:03.031522 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:50:03.043057 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m05:50:03.043469 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_staging"
[0m05:50:03.043781 [debug] [ThreadPool]: On list_casestudy_staging: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_staging"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'staging'
    and table_catalog = 'casestudy'
  
[0m05:50:03.056556 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m05:50:03.057958 [debug] [ThreadPool]: On list_casestudy_staging: ROLLBACK
[0m05:50:03.059371 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_staging'
[0m05:50:03.059666 [debug] [ThreadPool]: On list_casestudy_staging: Close
[0m05:50:03.062657 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy_staging, now list_casestudy_intermediate)
[0m05:50:03.064944 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_intermediate"
[0m05:50:03.065327 [debug] [ThreadPool]: On list_casestudy_intermediate: BEGIN
[0m05:50:03.065659 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:50:03.076203 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m05:50:03.076578 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_intermediate"
[0m05:50:03.076865 [debug] [ThreadPool]: On list_casestudy_intermediate: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_intermediate"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'intermediate'
    and table_catalog = 'casestudy'
  
[0m05:50:03.085271 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m05:50:03.086616 [debug] [ThreadPool]: On list_casestudy_intermediate: ROLLBACK
[0m05:50:03.087065 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_intermediate'
[0m05:50:03.087336 [debug] [ThreadPool]: On list_casestudy_intermediate: Close
[0m05:50:03.090058 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy_intermediate, now list_casestudy_raw)
[0m05:50:03.092334 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_raw"
[0m05:50:03.092674 [debug] [ThreadPool]: On list_casestudy_raw: BEGIN
[0m05:50:03.092953 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:50:03.103972 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m05:50:03.104369 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_raw"
[0m05:50:03.104665 [debug] [ThreadPool]: On list_casestudy_raw: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_raw"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'raw'
    and table_catalog = 'casestudy'
  
[0m05:50:03.112758 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m05:50:03.114232 [debug] [ThreadPool]: On list_casestudy_raw: ROLLBACK
[0m05:50:03.114702 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_raw'
[0m05:50:03.114958 [debug] [ThreadPool]: On list_casestudy_raw: Close
[0m05:50:03.117693 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy_raw, now list_casestudy_core)
[0m05:50:03.119784 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_core"
[0m05:50:03.120117 [debug] [ThreadPool]: On list_casestudy_core: BEGIN
[0m05:50:03.120412 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:50:03.131728 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m05:50:03.132126 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_core"
[0m05:50:03.132418 [debug] [ThreadPool]: On list_casestudy_core: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_core"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'core'
    and table_catalog = 'casestudy'
  
[0m05:50:03.140455 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m05:50:03.141743 [debug] [ThreadPool]: On list_casestudy_core: ROLLBACK
[0m05:50:03.142199 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_core'
[0m05:50:03.142450 [debug] [ThreadPool]: On list_casestudy_core: Close
[0m05:50:03.146224 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ff348ac6-1147-498f-b1f5-704d05c84426', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f869f4eaa10>]}
[0m05:50:03.146706 [debug] [MainThread]: Using duckdb connection "master"
[0m05:50:03.147001 [debug] [MainThread]: On master: BEGIN
[0m05:50:03.147251 [debug] [MainThread]: Opening a new connection, currently in state init
[0m05:50:03.159740 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m05:50:03.160149 [debug] [MainThread]: On master: COMMIT
[0m05:50:03.160428 [debug] [MainThread]: Using duckdb connection "master"
[0m05:50:03.160687 [debug] [MainThread]: On master: COMMIT
[0m05:50:03.161181 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m05:50:03.161553 [debug] [MainThread]: On master: Close
[0m05:50:03.163975 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m05:50:03.164398 [info ] [MainThread]: 
[0m05:50:03.170368 [debug] [Thread-1 (]: Began running node model.vg_casestudy.core__customers_enriched
[0m05:50:03.170883 [info ] [Thread-1 (]: 1 of 1 START sql view model core.core__customers_enriched ...................... [RUN]
[0m05:50:03.171813 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.vg_casestudy.core__customers_enriched'
[0m05:50:03.172233 [debug] [Thread-1 (]: Began compiling node model.vg_casestudy.core__customers_enriched
[0m05:50:03.183852 [debug] [Thread-1 (]: Writing injected SQL for node "model.vg_casestudy.core__customers_enriched"
[0m05:50:03.184790 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.core__customers_enriched (compile): 05:50:03.172490 => 05:50:03.184538
[0m05:50:03.185285 [debug] [Thread-1 (]: Began executing node model.vg_casestudy.core__customers_enriched
[0m05:50:03.217475 [debug] [Thread-1 (]: Writing runtime sql for node "model.vg_casestudy.core__customers_enriched"
[0m05:50:03.218132 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.core__customers_enriched"
[0m05:50:03.218577 [debug] [Thread-1 (]: On model.vg_casestudy.core__customers_enriched: BEGIN
[0m05:50:03.218912 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m05:50:03.233100 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m05:50:03.233571 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.core__customers_enriched"
[0m05:50:03.233952 [debug] [Thread-1 (]: On model.vg_casestudy.core__customers_enriched: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.core__customers_enriched"} */

  
  create view "casestudy"."core"."core__customers_enriched__dbt_tmp" as (
    with customers as (
    select *
    from "casestudy"."intermediate"."stg_staging_intermediate__customers"
),

accounts as (
    select *
    from "casestudy"."intermediate"."stg_staging_intermediate__accounts"
),


joined as (
    select 
        customers.customer_id,
        customers.firstname,
        customers.lastname,
        customers.age,
        customers.branch_id,
        accounts.account_id,
        accounts.account_type,
        accounts.account_opening_date,
        case 
            when accounts.account_id is null then false
            else true
        end as has_account

    from customers
    left join accounts
    on customers.customer_id = accounts.customer_id
)

select *
from joined
  );

[0m05:50:03.234933 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m05:50:03.241364 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.core__customers_enriched"
[0m05:50:03.241837 [debug] [Thread-1 (]: On model.vg_casestudy.core__customers_enriched: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.core__customers_enriched"} */
alter view "casestudy"."core"."core__customers_enriched__dbt_tmp" rename to "core__customers_enriched"
[0m05:50:03.242997 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m05:50:03.257104 [debug] [Thread-1 (]: On model.vg_casestudy.core__customers_enriched: COMMIT
[0m05:50:03.257587 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.core__customers_enriched"
[0m05:50:03.257925 [debug] [Thread-1 (]: On model.vg_casestudy.core__customers_enriched: COMMIT
[0m05:50:03.263106 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m05:50:03.268273 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.core__customers_enriched"
[0m05:50:03.268782 [debug] [Thread-1 (]: On model.vg_casestudy.core__customers_enriched: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.core__customers_enriched"} */
drop view if exists "casestudy"."core"."core__customers_enriched__dbt_backup" cascade
[0m05:50:03.269601 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m05:50:03.270908 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.core__customers_enriched (execute): 05:50:03.185538 => 05:50:03.270764
[0m05:50:03.271233 [debug] [Thread-1 (]: On model.vg_casestudy.core__customers_enriched: Close
[0m05:50:03.295884 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ff348ac6-1147-498f-b1f5-704d05c84426', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f869f5fbc10>]}
[0m05:50:03.296602 [info ] [Thread-1 (]: 1 of 1 OK created sql view model core.core__customers_enriched ................. [[32mOK[0m in 0.12s]
[0m05:50:03.297204 [debug] [Thread-1 (]: Finished running node model.vg_casestudy.core__customers_enriched
[0m05:50:03.298969 [debug] [MainThread]: Using duckdb connection "master"
[0m05:50:03.299339 [debug] [MainThread]: On master: BEGIN
[0m05:50:03.299636 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m05:50:03.314003 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m05:50:03.314482 [debug] [MainThread]: On master: COMMIT
[0m05:50:03.314824 [debug] [MainThread]: Using duckdb connection "master"
[0m05:50:03.315138 [debug] [MainThread]: On master: COMMIT
[0m05:50:03.315845 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m05:50:03.316222 [debug] [MainThread]: On master: Close
[0m05:50:03.318733 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:50:03.319096 [debug] [MainThread]: Connection 'list_casestudy_core' was properly closed.
[0m05:50:03.319365 [debug] [MainThread]: Connection 'model.vg_casestudy.core__customers_enriched' was properly closed.
[0m05:50:03.319677 [info ] [MainThread]: 
[0m05:50:03.320025 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.50 seconds (0.50s).
[0m05:50:03.320617 [debug] [MainThread]: Command end result
[0m05:50:03.340959 [info ] [MainThread]: 
[0m05:50:03.341738 [info ] [MainThread]: [32mCompleted successfully[0m
[0m05:50:03.342153 [info ] [MainThread]: 
[0m05:50:03.342521 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m05:50:03.343046 [debug] [MainThread]: Command `dbt run` succeeded at 05:50:03.342923 after 0.96 seconds
[0m05:50:03.343456 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86a426b650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86a426a510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86a0553290>]}
[0m05:50:03.344067 [debug] [MainThread]: Flushing usage events
[0m05:50:36.013255 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5629046010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5628d59390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5628b1d4d0>]}


============================== 05:50:36.016278 | e951172d-3b37-44ca-bdbc-be76527c7830 ==============================
[0m05:50:36.016278 [info ] [MainThread]: Running with dbt=1.6.18
[0m05:50:36.016872 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/workspaces/vg_case_study_tim/transformation', 'log_path': '/workspaces/vg_case_study_tim/transformation/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt test --select core__customers_enriched', 'send_anonymous_usage_stats': 'True'}
[0m05:50:36.127139 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e951172d-3b37-44ca-bdbc-be76527c7830', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5628bcae10>]}
[0m05:50:36.141507 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e951172d-3b37-44ca-bdbc-be76527c7830', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5628e7e390>]}
[0m05:50:36.142562 [info ] [MainThread]: Registered adapter: duckdb=1.6.2
[0m05:50:36.167400 [debug] [MainThread]: checksum: 7b9fab86a08e9e96a48a825af743c566d95b877e068b8c6d0dbafbf714447189, vars: {}, profile: , target: , version: 1.6.18
[0m05:50:36.214654 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m05:50:36.215102 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m05:50:36.216537 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.vg_casestudy.reporting
- models.vg_casestudy.marts
- models.vg_casestudy.main
[0m05:50:36.224654 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e951172d-3b37-44ca-bdbc-be76527c7830', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5624aff350>]}
[0m05:50:36.296140 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e951172d-3b37-44ca-bdbc-be76527c7830', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5624a1c4d0>]}
[0m05:50:36.296717 [info ] [MainThread]: Found 14 models, 1 analysis, 3 seeds, 91 tests, 5 sources, 0 exposures, 0 metrics, 632 macros, 0 groups, 0 semantic models
[0m05:50:36.297114 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e951172d-3b37-44ca-bdbc-be76527c7830', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56249f7ed0>]}
[0m05:50:36.299935 [info ] [MainThread]: 
[0m05:50:36.300902 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m05:50:36.303648 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_casestudy_core'
[0m05:50:36.315248 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_core"
[0m05:50:36.315868 [debug] [ThreadPool]: On list_casestudy_core: BEGIN
[0m05:50:36.316193 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:50:36.336589 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m05:50:36.337002 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_core"
[0m05:50:36.337297 [debug] [ThreadPool]: On list_casestudy_core: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_core"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'core'
    and table_catalog = 'casestudy'
  
[0m05:50:36.348584 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m05:50:36.350031 [debug] [ThreadPool]: On list_casestudy_core: ROLLBACK
[0m05:50:36.350805 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_core'
[0m05:50:36.351102 [debug] [ThreadPool]: On list_casestudy_core: Close
[0m05:50:36.355817 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy_core, now list_casestudy_raw)
[0m05:50:36.359164 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_raw"
[0m05:50:36.359765 [debug] [ThreadPool]: On list_casestudy_raw: BEGIN
[0m05:50:36.360744 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:50:36.372842 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m05:50:36.373272 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_raw"
[0m05:50:36.373567 [debug] [ThreadPool]: On list_casestudy_raw: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_raw"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'raw'
    and table_catalog = 'casestudy'
  
[0m05:50:36.384990 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m05:50:36.386426 [debug] [ThreadPool]: On list_casestudy_raw: ROLLBACK
[0m05:50:36.386892 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_raw'
[0m05:50:36.387165 [debug] [ThreadPool]: On list_casestudy_raw: Close
[0m05:50:36.391163 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy_raw, now list_casestudy_intermediate)
[0m05:50:36.393753 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_intermediate"
[0m05:50:36.394201 [debug] [ThreadPool]: On list_casestudy_intermediate: BEGIN
[0m05:50:36.394517 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:50:36.405093 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m05:50:36.405491 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_intermediate"
[0m05:50:36.405782 [debug] [ThreadPool]: On list_casestudy_intermediate: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_intermediate"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'intermediate'
    and table_catalog = 'casestudy'
  
[0m05:50:36.414094 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m05:50:36.415433 [debug] [ThreadPool]: On list_casestudy_intermediate: ROLLBACK
[0m05:50:36.415886 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_intermediate'
[0m05:50:36.416145 [debug] [ThreadPool]: On list_casestudy_intermediate: Close
[0m05:50:36.419774 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy_intermediate, now list_casestudy_staging)
[0m05:50:36.423069 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_staging"
[0m05:50:36.423391 [debug] [ThreadPool]: On list_casestudy_staging: BEGIN
[0m05:50:36.423679 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:50:36.435394 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m05:50:36.435850 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_staging"
[0m05:50:36.436190 [debug] [ThreadPool]: On list_casestudy_staging: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_staging"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'staging'
    and table_catalog = 'casestudy'
  
[0m05:50:36.445368 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m05:50:36.446756 [debug] [ThreadPool]: On list_casestudy_staging: ROLLBACK
[0m05:50:36.447236 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_staging'
[0m05:50:36.447505 [debug] [ThreadPool]: On list_casestudy_staging: Close
[0m05:50:36.451177 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e951172d-3b37-44ca-bdbc-be76527c7830', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56249f78d0>]}
[0m05:50:36.451683 [debug] [MainThread]: Using duckdb connection "master"
[0m05:50:36.451954 [debug] [MainThread]: On master: BEGIN
[0m05:50:36.452224 [debug] [MainThread]: Opening a new connection, currently in state init
[0m05:50:36.465175 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m05:50:36.465595 [debug] [MainThread]: On master: COMMIT
[0m05:50:36.465902 [debug] [MainThread]: Using duckdb connection "master"
[0m05:50:36.466166 [debug] [MainThread]: On master: COMMIT
[0m05:50:36.466669 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m05:50:36.466966 [debug] [MainThread]: On master: Close
[0m05:50:36.469397 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m05:50:36.469834 [info ] [MainThread]: 
[0m05:50:36.472473 [debug] [Thread-1 (]: Began running node test.vg_casestudy.not_null_core__customers_enriched_customer_id.1243948ba4
[0m05:50:36.472975 [info ] [Thread-1 (]: 1 of 3 START test not_null_core__customers_enriched_customer_id ................ [RUN]
[0m05:50:36.473882 [debug] [Thread-1 (]: Acquiring new duckdb connection 'test.vg_casestudy.not_null_core__customers_enriched_customer_id.1243948ba4'
[0m05:50:36.474205 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.not_null_core__customers_enriched_customer_id.1243948ba4
[0m05:50:36.495770 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.not_null_core__customers_enriched_customer_id.1243948ba4"
[0m05:50:36.499043 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_core__customers_enriched_customer_id.1243948ba4 (compile): 05:50:36.474427 => 05:50:36.498740
[0m05:50:36.499481 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.not_null_core__customers_enriched_customer_id.1243948ba4
[0m05:50:36.514003 [debug] [Thread-1 (]: Writing runtime sql for node "test.vg_casestudy.not_null_core__customers_enriched_customer_id.1243948ba4"
[0m05:50:36.515920 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.not_null_core__customers_enriched_customer_id.1243948ba4"
[0m05:50:36.516397 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_core__customers_enriched_customer_id.1243948ba4: BEGIN
[0m05:50:36.516737 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m05:50:36.533819 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m05:50:36.534300 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.not_null_core__customers_enriched_customer_id.1243948ba4"
[0m05:50:36.534680 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_core__customers_enriched_customer_id.1243948ba4: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "test.vg_casestudy.not_null_core__customers_enriched_customer_id.1243948ba4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from "casestudy"."core"."core__customers_enriched"
where customer_id is null



      
    ) dbt_internal_test
[0m05:50:36.543889 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m05:50:36.547177 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_core__customers_enriched_customer_id.1243948ba4 (execute): 05:50:36.499736 => 05:50:36.546921
[0m05:50:36.547720 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_core__customers_enriched_customer_id.1243948ba4: ROLLBACK
[0m05:50:36.548299 [debug] [Thread-1 (]: Failed to rollback 'test.vg_casestudy.not_null_core__customers_enriched_customer_id.1243948ba4'
[0m05:50:36.548643 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_core__customers_enriched_customer_id.1243948ba4: Close
[0m05:50:36.551824 [info ] [Thread-1 (]: 1 of 3 PASS not_null_core__customers_enriched_customer_id ...................... [[32mPASS[0m in 0.08s]
[0m05:50:36.552460 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.not_null_core__customers_enriched_customer_id.1243948ba4
[0m05:50:36.552903 [debug] [Thread-1 (]: Began running node test.vg_casestudy.not_null_core__customers_enriched_has_account.ca9073011d
[0m05:50:36.553395 [info ] [Thread-1 (]: 2 of 3 START test not_null_core__customers_enriched_has_account ................ [RUN]
[0m05:50:36.554067 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.not_null_core__customers_enriched_customer_id.1243948ba4, now test.vg_casestudy.not_null_core__customers_enriched_has_account.ca9073011d)
[0m05:50:36.554398 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.not_null_core__customers_enriched_has_account.ca9073011d
[0m05:50:36.558990 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.not_null_core__customers_enriched_has_account.ca9073011d"
[0m05:50:36.559958 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_core__customers_enriched_has_account.ca9073011d (compile): 05:50:36.554618 => 05:50:36.559700
[0m05:50:36.560567 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.not_null_core__customers_enriched_has_account.ca9073011d
[0m05:50:36.563346 [debug] [Thread-1 (]: Writing runtime sql for node "test.vg_casestudy.not_null_core__customers_enriched_has_account.ca9073011d"
[0m05:50:36.563933 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.not_null_core__customers_enriched_has_account.ca9073011d"
[0m05:50:36.564266 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_core__customers_enriched_has_account.ca9073011d: BEGIN
[0m05:50:36.564582 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:50:36.576733 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m05:50:36.577258 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.not_null_core__customers_enriched_has_account.ca9073011d"
[0m05:50:36.577755 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_core__customers_enriched_has_account.ca9073011d: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "test.vg_casestudy.not_null_core__customers_enriched_has_account.ca9073011d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select has_account
from "casestudy"."core"."core__customers_enriched"
where has_account is null



      
    ) dbt_internal_test
[0m05:50:36.581276 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m05:50:36.583200 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_core__customers_enriched_has_account.ca9073011d (execute): 05:50:36.560953 => 05:50:36.582981
[0m05:50:36.583596 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_core__customers_enriched_has_account.ca9073011d: ROLLBACK
[0m05:50:36.584058 [debug] [Thread-1 (]: Failed to rollback 'test.vg_casestudy.not_null_core__customers_enriched_has_account.ca9073011d'
[0m05:50:36.584374 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_core__customers_enriched_has_account.ca9073011d: Close
[0m05:50:36.586827 [info ] [Thread-1 (]: 2 of 3 PASS not_null_core__customers_enriched_has_account ...................... [[32mPASS[0m in 0.03s]
[0m05:50:36.587428 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.not_null_core__customers_enriched_has_account.ca9073011d
[0m05:50:36.587903 [debug] [Thread-1 (]: Began running node test.vg_casestudy.unique_core__customers_enriched_customer_id.5c411c2b35
[0m05:50:36.588425 [info ] [Thread-1 (]: 3 of 3 START test unique_core__customers_enriched_customer_id .................. [RUN]
[0m05:50:36.589128 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.not_null_core__customers_enriched_has_account.ca9073011d, now test.vg_casestudy.unique_core__customers_enriched_customer_id.5c411c2b35)
[0m05:50:36.589465 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.unique_core__customers_enriched_customer_id.5c411c2b35
[0m05:50:36.596222 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.unique_core__customers_enriched_customer_id.5c411c2b35"
[0m05:50:36.597053 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.unique_core__customers_enriched_customer_id.5c411c2b35 (compile): 05:50:36.589688 => 05:50:36.596833
[0m05:50:36.597419 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.unique_core__customers_enriched_customer_id.5c411c2b35
[0m05:50:36.600061 [debug] [Thread-1 (]: Writing runtime sql for node "test.vg_casestudy.unique_core__customers_enriched_customer_id.5c411c2b35"
[0m05:50:36.600679 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.unique_core__customers_enriched_customer_id.5c411c2b35"
[0m05:50:36.601004 [debug] [Thread-1 (]: On test.vg_casestudy.unique_core__customers_enriched_customer_id.5c411c2b35: BEGIN
[0m05:50:36.601295 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:50:36.614587 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m05:50:36.615066 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.unique_core__customers_enriched_customer_id.5c411c2b35"
[0m05:50:36.615400 [debug] [Thread-1 (]: On test.vg_casestudy.unique_core__customers_enriched_customer_id.5c411c2b35: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "test.vg_casestudy.unique_core__customers_enriched_customer_id.5c411c2b35"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from "casestudy"."core"."core__customers_enriched"
where customer_id is not null
group by customer_id
having count(*) > 1



      
    ) dbt_internal_test
[0m05:50:36.625869 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m05:50:36.628264 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.unique_core__customers_enriched_customer_id.5c411c2b35 (execute): 05:50:36.597690 => 05:50:36.628018
[0m05:50:36.628697 [debug] [Thread-1 (]: On test.vg_casestudy.unique_core__customers_enriched_customer_id.5c411c2b35: ROLLBACK
[0m05:50:36.629176 [debug] [Thread-1 (]: Failed to rollback 'test.vg_casestudy.unique_core__customers_enriched_customer_id.5c411c2b35'
[0m05:50:36.629529 [debug] [Thread-1 (]: On test.vg_casestudy.unique_core__customers_enriched_customer_id.5c411c2b35: Close
[0m05:50:36.632519 [info ] [Thread-1 (]: 3 of 3 PASS unique_core__customers_enriched_customer_id ........................ [[32mPASS[0m in 0.04s]
[0m05:50:36.633188 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.unique_core__customers_enriched_customer_id.5c411c2b35
[0m05:50:36.635087 [debug] [MainThread]: Using duckdb connection "master"
[0m05:50:36.635406 [debug] [MainThread]: On master: BEGIN
[0m05:50:36.635688 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m05:50:36.651127 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m05:50:36.651636 [debug] [MainThread]: On master: COMMIT
[0m05:50:36.651977 [debug] [MainThread]: Using duckdb connection "master"
[0m05:50:36.652357 [debug] [MainThread]: On master: COMMIT
[0m05:50:36.653169 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m05:50:36.653557 [debug] [MainThread]: On master: Close
[0m05:50:36.656727 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:50:36.657302 [debug] [MainThread]: Connection 'list_casestudy_staging' was properly closed.
[0m05:50:36.657669 [debug] [MainThread]: Connection 'test.vg_casestudy.unique_core__customers_enriched_customer_id.5c411c2b35' was properly closed.
[0m05:50:36.658048 [info ] [MainThread]: 
[0m05:50:36.658441 [info ] [MainThread]: Finished running 3 tests in 0 hours 0 minutes and 0.36 seconds (0.36s).
[0m05:50:36.659253 [debug] [MainThread]: Command end result
[0m05:50:36.679760 [info ] [MainThread]: 
[0m05:50:36.680425 [info ] [MainThread]: [32mCompleted successfully[0m
[0m05:50:36.680965 [info ] [MainThread]: 
[0m05:50:36.681428 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m05:50:36.682115 [debug] [MainThread]: Command `dbt test` succeeded at 05:50:36.681920 after 0.68 seconds
[0m05:50:36.682503 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f562a994c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f562d82b410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f562d82b490>]}
[0m05:50:36.682878 [debug] [MainThread]: Flushing usage events
[0m06:36:39.134722 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f75c2aeaf50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f75c2964dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f75c27b04d0>]}


============================== 06:36:39.139738 | 6179fcf5-be36-45c8-8afc-3e2dff9e1bf8 ==============================
[0m06:36:39.139738 [info ] [MainThread]: Running with dbt=1.6.18
[0m06:36:39.140287 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/workspaces/vg_case_study_tim/transformation', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/workspaces/vg_case_study_tim/transformation/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt seed --select branch_names', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:36:39.332325 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6179fcf5-be36-45c8-8afc-3e2dff9e1bf8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f75c27ab510>]}
[0m06:36:39.347562 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6179fcf5-be36-45c8-8afc-3e2dff9e1bf8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f75c2aebd90>]}
[0m06:36:39.348951 [info ] [MainThread]: Registered adapter: duckdb=1.6.2
[0m06:36:39.378614 [debug] [MainThread]: checksum: 7b9fab86a08e9e96a48a825af743c566d95b877e068b8c6d0dbafbf714447189, vars: {}, profile: , target: , version: 1.6.18
[0m06:36:39.477517 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m06:36:39.478381 [debug] [MainThread]: Partial parsing: added file: vg_casestudy://seeds/branch_names.csv
[0m06:36:39.566450 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.vg_casestudy.main
- models.vg_casestudy.reporting
- models.vg_casestudy.marts
[0m06:36:39.573381 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6179fcf5-be36-45c8-8afc-3e2dff9e1bf8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f75becd4850>]}
[0m06:36:39.605816 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6179fcf5-be36-45c8-8afc-3e2dff9e1bf8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f75be3dae50>]}
[0m06:36:39.606366 [info ] [MainThread]: Found 14 models, 1 analysis, 4 seeds, 91 tests, 5 sources, 0 exposures, 0 metrics, 632 macros, 0 groups, 0 semantic models
[0m06:36:39.606798 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6179fcf5-be36-45c8-8afc-3e2dff9e1bf8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f75c27a9890>]}
[0m06:36:39.609677 [info ] [MainThread]: 
[0m06:36:39.610622 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m06:36:39.612080 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_casestudy'
[0m06:36:39.625341 [debug] [ThreadPool]: Using duckdb connection "list_casestudy"
[0m06:36:39.625809 [debug] [ThreadPool]: On list_casestudy: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"casestudy"'
    
  
  
[0m06:36:39.626186 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:36:39.759203 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:36:39.760741 [debug] [ThreadPool]: On list_casestudy: Close
[0m06:36:39.765169 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy, now create_casestudy_raw)
[0m06:36:39.765958 [debug] [ThreadPool]: Creating schema "database: "casestudy"
schema: "raw"
"
[0m06:36:39.771064 [debug] [ThreadPool]: Using duckdb connection "create_casestudy_raw"
[0m06:36:39.771629 [debug] [ThreadPool]: On create_casestudy_raw: BEGIN
[0m06:36:39.772066 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:36:39.785134 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:36:39.785554 [debug] [ThreadPool]: Using duckdb connection "create_casestudy_raw"
[0m06:36:39.785869 [debug] [ThreadPool]: On create_casestudy_raw: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "create_casestudy_raw"} */
create schema if not exists "casestudy"."raw"
[0m06:36:39.786722 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:36:39.787639 [debug] [ThreadPool]: On create_casestudy_raw: COMMIT
[0m06:36:39.787932 [debug] [ThreadPool]: Using duckdb connection "create_casestudy_raw"
[0m06:36:39.788226 [debug] [ThreadPool]: On create_casestudy_raw: COMMIT
[0m06:36:39.788749 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:36:39.789022 [debug] [ThreadPool]: On create_casestudy_raw: Close
[0m06:36:39.793638 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_casestudy_raw, now list_casestudy_core)
[0m06:36:39.799379 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_core"
[0m06:36:39.799872 [debug] [ThreadPool]: On list_casestudy_core: BEGIN
[0m06:36:39.800185 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:36:39.811997 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:36:39.812454 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_core"
[0m06:36:39.812826 [debug] [ThreadPool]: On list_casestudy_core: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_core"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'core'
    and table_catalog = 'casestudy'
  
[0m06:36:39.828538 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:36:39.830407 [debug] [ThreadPool]: On list_casestudy_core: ROLLBACK
[0m06:36:39.831605 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_core'
[0m06:36:39.831988 [debug] [ThreadPool]: On list_casestudy_core: Close
[0m06:36:39.836128 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy_core, now list_casestudy_staging)
[0m06:36:39.839092 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_staging"
[0m06:36:39.839520 [debug] [ThreadPool]: On list_casestudy_staging: BEGIN
[0m06:36:39.839877 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:36:39.850923 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:36:39.851323 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_staging"
[0m06:36:39.851649 [debug] [ThreadPool]: On list_casestudy_staging: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_staging"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'staging'
    and table_catalog = 'casestudy'
  
[0m06:36:39.860193 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:36:39.861793 [debug] [ThreadPool]: On list_casestudy_staging: ROLLBACK
[0m06:36:39.862444 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_staging'
[0m06:36:39.862792 [debug] [ThreadPool]: On list_casestudy_staging: Close
[0m06:36:39.865809 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy_staging, now list_casestudy_raw)
[0m06:36:39.868087 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_raw"
[0m06:36:39.868458 [debug] [ThreadPool]: On list_casestudy_raw: BEGIN
[0m06:36:39.869747 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:36:39.880448 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:36:39.880865 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_raw"
[0m06:36:39.881178 [debug] [ThreadPool]: On list_casestudy_raw: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_raw"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'raw'
    and table_catalog = 'casestudy'
  
[0m06:36:39.889150 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:36:39.890484 [debug] [ThreadPool]: On list_casestudy_raw: ROLLBACK
[0m06:36:39.890972 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_raw'
[0m06:36:39.891333 [debug] [ThreadPool]: On list_casestudy_raw: Close
[0m06:36:39.894398 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy_raw, now list_casestudy_intermediate)
[0m06:36:39.896806 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_intermediate"
[0m06:36:39.897241 [debug] [ThreadPool]: On list_casestudy_intermediate: BEGIN
[0m06:36:39.897557 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:36:39.908337 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:36:39.908705 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_intermediate"
[0m06:36:39.908993 [debug] [ThreadPool]: On list_casestudy_intermediate: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_intermediate"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'intermediate'
    and table_catalog = 'casestudy'
  
[0m06:36:39.917263 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:36:39.918593 [debug] [ThreadPool]: On list_casestudy_intermediate: ROLLBACK
[0m06:36:39.919052 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_intermediate'
[0m06:36:39.919315 [debug] [ThreadPool]: On list_casestudy_intermediate: Close
[0m06:36:39.923258 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6179fcf5-be36-45c8-8afc-3e2dff9e1bf8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f75c2793c90>]}
[0m06:36:39.923723 [debug] [MainThread]: Using duckdb connection "master"
[0m06:36:39.923989 [debug] [MainThread]: On master: BEGIN
[0m06:36:39.924247 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:36:39.937344 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:36:39.937752 [debug] [MainThread]: On master: COMMIT
[0m06:36:39.938045 [debug] [MainThread]: Using duckdb connection "master"
[0m06:36:39.938306 [debug] [MainThread]: On master: COMMIT
[0m06:36:39.938807 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:36:39.939094 [debug] [MainThread]: On master: Close
[0m06:36:39.942092 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m06:36:39.942688 [info ] [MainThread]: 
[0m06:36:39.948608 [debug] [Thread-1 (]: Began running node seed.vg_casestudy.branch_names
[0m06:36:39.949179 [info ] [Thread-1 (]: 1 of 1 START seed file raw.branch_names ........................................ [RUN]
[0m06:36:39.950056 [debug] [Thread-1 (]: Acquiring new duckdb connection 'seed.vg_casestudy.branch_names'
[0m06:36:39.950481 [debug] [Thread-1 (]: Began compiling node seed.vg_casestudy.branch_names
[0m06:36:39.950920 [debug] [Thread-1 (]: Timing info for seed.vg_casestudy.branch_names (compile): 06:36:39.950736 => 06:36:39.950739
[0m06:36:39.951389 [debug] [Thread-1 (]: Began executing node seed.vg_casestudy.branch_names
[0m06:36:39.980387 [debug] [Thread-1 (]: Using duckdb connection "seed.vg_casestudy.branch_names"
[0m06:36:39.981029 [debug] [Thread-1 (]: On seed.vg_casestudy.branch_names: BEGIN
[0m06:36:39.981488 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m06:36:39.997625 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:36:39.998064 [debug] [Thread-1 (]: Using duckdb connection "seed.vg_casestudy.branch_names"
[0m06:36:39.998397 [debug] [Thread-1 (]: On seed.vg_casestudy.branch_names: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "seed.vg_casestudy.branch_names"} */

    create table "casestudy"."raw"."branch_names" ("branch_id" integer,"branch_name" text)
  
[0m06:36:39.999281 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:36:40.009675 [debug] [Thread-1 (]: Using duckdb connection "seed.vg_casestudy.branch_names"
[0m06:36:40.010124 [debug] [Thread-1 (]: On seed.vg_casestudy.branch_names: 
          COPY "casestudy"."raw"."branch_names" FROM '/workspaces/vg_case_study_tim/transformation/seeds/branch_names.csv' (FORMAT CSV, HEADER TRUE)
        ...
[0m06:36:40.032059 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:36:40.037477 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.vg_casestudy.branch_names"
[0m06:36:40.055837 [debug] [Thread-1 (]: On seed.vg_casestudy.branch_names: COMMIT
[0m06:36:40.056249 [debug] [Thread-1 (]: Using duckdb connection "seed.vg_casestudy.branch_names"
[0m06:36:40.056569 [debug] [Thread-1 (]: On seed.vg_casestudy.branch_names: COMMIT
[0m06:36:40.062018 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:36:40.063318 [debug] [Thread-1 (]: Timing info for seed.vg_casestudy.branch_names (execute): 06:36:39.951678 => 06:36:40.063165
[0m06:36:40.063681 [debug] [Thread-1 (]: On seed.vg_casestudy.branch_names: Close
[0m06:36:40.095575 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6179fcf5-be36-45c8-8afc-3e2dff9e1bf8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f75c23cd490>]}
[0m06:36:40.096234 [info ] [Thread-1 (]: 1 of 1 OK loaded seed file raw.branch_names .................................... [[32mINSERT 99[0m in 0.15s]
[0m06:36:40.096826 [debug] [Thread-1 (]: Finished running node seed.vg_casestudy.branch_names
[0m06:36:40.098496 [debug] [MainThread]: Using duckdb connection "master"
[0m06:36:40.098836 [debug] [MainThread]: On master: BEGIN
[0m06:36:40.099126 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:36:40.116224 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:36:40.116731 [debug] [MainThread]: On master: COMMIT
[0m06:36:40.117041 [debug] [MainThread]: Using duckdb connection "master"
[0m06:36:40.117301 [debug] [MainThread]: On master: COMMIT
[0m06:36:40.118025 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:36:40.118368 [debug] [MainThread]: On master: Close
[0m06:36:40.120856 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:36:40.121209 [debug] [MainThread]: Connection 'list_casestudy_intermediate' was properly closed.
[0m06:36:40.121475 [debug] [MainThread]: Connection 'seed.vg_casestudy.branch_names' was properly closed.
[0m06:36:40.121781 [info ] [MainThread]: 
[0m06:36:40.122138 [info ] [MainThread]: Finished running 1 seed in 0 hours 0 minutes and 0.51 seconds (0.51s).
[0m06:36:40.122735 [debug] [MainThread]: Command end result
[0m06:36:40.144233 [info ] [MainThread]: 
[0m06:36:40.144822 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:36:40.145261 [info ] [MainThread]: 
[0m06:36:40.145605 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m06:36:40.146299 [debug] [MainThread]: Command `dbt seed` succeeded at 06:36:40.146064 after 1.02 seconds
[0m06:36:40.147108 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f75c2689790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f75c2ac7890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f75c24ebb10>]}
[0m06:36:40.147626 [debug] [MainThread]: Flushing usage events
[0m06:41:27.038925 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff903ab1c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff903f2c750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9040b7010>]}


============================== 06:41:27.042045 | c430618c-87d3-46b8-9293-0996fe7b8a87 ==============================
[0m06:41:27.042045 [info ] [MainThread]: Running with dbt=1.6.18
[0m06:41:27.042658 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/workspaces/vg_case_study_tim/transformation', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/workspaces/vg_case_study_tim/transformation/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test --select branch_names', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:41:27.157373 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c430618c-87d3-46b8-9293-0996fe7b8a87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff903974dd0>]}
[0m06:41:27.171636 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c430618c-87d3-46b8-9293-0996fe7b8a87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9039001d0>]}
[0m06:41:27.172431 [info ] [MainThread]: Registered adapter: duckdb=1.6.2
[0m06:41:27.196641 [debug] [MainThread]: checksum: 7b9fab86a08e9e96a48a825af743c566d95b877e068b8c6d0dbafbf714447189, vars: {}, profile: , target: , version: 1.6.18
[0m06:41:27.238861 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m06:41:27.239672 [debug] [MainThread]: Partial parsing: added file: vg_casestudy://seeds/branch_names.yml
[0m06:41:27.338024 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.vg_casestudy.main
- models.vg_casestudy.reporting
- models.vg_casestudy.marts
[0m06:41:27.345008 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c430618c-87d3-46b8-9293-0996fe7b8a87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8ff923450>]}
[0m06:41:27.380250 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c430618c-87d3-46b8-9293-0996fe7b8a87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8ff97f990>]}
[0m06:41:27.381012 [info ] [MainThread]: Found 14 models, 1 analysis, 4 seeds, 94 tests, 5 sources, 0 exposures, 0 metrics, 632 macros, 0 groups, 0 semantic models
[0m06:41:27.381462 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c430618c-87d3-46b8-9293-0996fe7b8a87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8ff7833d0>]}
[0m06:41:27.384233 [info ] [MainThread]: 
[0m06:41:27.385087 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m06:41:27.386994 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_casestudy_intermediate'
[0m06:41:27.397527 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_intermediate"
[0m06:41:27.397969 [debug] [ThreadPool]: On list_casestudy_intermediate: BEGIN
[0m06:41:27.398264 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:41:27.421344 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:41:27.421836 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_intermediate"
[0m06:41:27.422149 [debug] [ThreadPool]: On list_casestudy_intermediate: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_intermediate"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'intermediate'
    and table_catalog = 'casestudy'
  
[0m06:41:27.432708 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:41:27.434264 [debug] [ThreadPool]: On list_casestudy_intermediate: ROLLBACK
[0m06:41:27.435045 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_intermediate'
[0m06:41:27.435464 [debug] [ThreadPool]: On list_casestudy_intermediate: Close
[0m06:41:27.443101 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy_intermediate, now list_casestudy_raw)
[0m06:41:27.446052 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_raw"
[0m06:41:27.447932 [debug] [ThreadPool]: On list_casestudy_raw: BEGIN
[0m06:41:27.448292 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:41:27.460545 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:41:27.461088 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_raw"
[0m06:41:27.461442 [debug] [ThreadPool]: On list_casestudy_raw: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_raw"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'raw'
    and table_catalog = 'casestudy'
  
[0m06:41:27.470253 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:41:27.471758 [debug] [ThreadPool]: On list_casestudy_raw: ROLLBACK
[0m06:41:27.472366 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_raw'
[0m06:41:27.472783 [debug] [ThreadPool]: On list_casestudy_raw: Close
[0m06:41:27.477899 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy_raw, now list_casestudy_staging)
[0m06:41:27.480530 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_staging"
[0m06:41:27.480979 [debug] [ThreadPool]: On list_casestudy_staging: BEGIN
[0m06:41:27.481338 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:41:27.492237 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:41:27.492623 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_staging"
[0m06:41:27.492937 [debug] [ThreadPool]: On list_casestudy_staging: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_staging"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'staging'
    and table_catalog = 'casestudy'
  
[0m06:41:27.501341 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:41:27.502890 [debug] [ThreadPool]: On list_casestudy_staging: ROLLBACK
[0m06:41:27.503370 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_staging'
[0m06:41:27.503663 [debug] [ThreadPool]: On list_casestudy_staging: Close
[0m06:41:27.506469 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy_staging, now list_casestudy_core)
[0m06:41:27.508586 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_core"
[0m06:41:27.508922 [debug] [ThreadPool]: On list_casestudy_core: BEGIN
[0m06:41:27.509221 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:41:27.521033 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:41:27.521489 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_core"
[0m06:41:27.521997 [debug] [ThreadPool]: On list_casestudy_core: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_core"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'core'
    and table_catalog = 'casestudy'
  
[0m06:41:27.534056 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:41:27.535411 [debug] [ThreadPool]: On list_casestudy_core: ROLLBACK
[0m06:41:27.535903 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_core'
[0m06:41:27.536181 [debug] [ThreadPool]: On list_casestudy_core: Close
[0m06:41:27.539451 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c430618c-87d3-46b8-9293-0996fe7b8a87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9002b8cd0>]}
[0m06:41:27.539943 [debug] [MainThread]: Using duckdb connection "master"
[0m06:41:27.540240 [debug] [MainThread]: On master: BEGIN
[0m06:41:27.540501 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:41:27.557412 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:41:27.557821 [debug] [MainThread]: On master: COMMIT
[0m06:41:27.558124 [debug] [MainThread]: Using duckdb connection "master"
[0m06:41:27.558394 [debug] [MainThread]: On master: COMMIT
[0m06:41:27.558870 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:41:27.559158 [debug] [MainThread]: On master: Close
[0m06:41:27.561754 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m06:41:27.562298 [info ] [MainThread]: 
[0m06:41:27.564982 [debug] [Thread-1 (]: Began running node test.vg_casestudy.not_null_branch_names_branch_id.c1ec52996d
[0m06:41:27.565382 [info ] [Thread-1 (]: 1 of 3 START test not_null_branch_names_branch_id .............................. [RUN]
[0m06:41:27.566148 [debug] [Thread-1 (]: Acquiring new duckdb connection 'test.vg_casestudy.not_null_branch_names_branch_id.c1ec52996d'
[0m06:41:27.566446 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.not_null_branch_names_branch_id.c1ec52996d
[0m06:41:27.584340 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.not_null_branch_names_branch_id.c1ec52996d"
[0m06:41:27.588007 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_branch_names_branch_id.c1ec52996d (compile): 06:41:27.566684 => 06:41:27.587754
[0m06:41:27.588443 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.not_null_branch_names_branch_id.c1ec52996d
[0m06:41:27.601329 [debug] [Thread-1 (]: Writing runtime sql for node "test.vg_casestudy.not_null_branch_names_branch_id.c1ec52996d"
[0m06:41:27.602919 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.not_null_branch_names_branch_id.c1ec52996d"
[0m06:41:27.603281 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_branch_names_branch_id.c1ec52996d: BEGIN
[0m06:41:27.603601 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m06:41:27.618628 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:41:27.619097 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.not_null_branch_names_branch_id.c1ec52996d"
[0m06:41:27.619427 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_branch_names_branch_id.c1ec52996d: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "test.vg_casestudy.not_null_branch_names_branch_id.c1ec52996d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select branch_id
from "casestudy"."raw"."branch_names"
where branch_id is null



      
    ) dbt_internal_test
[0m06:41:27.623494 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:41:27.627226 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_branch_names_branch_id.c1ec52996d (execute): 06:41:27.588729 => 06:41:27.627003
[0m06:41:27.627617 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_branch_names_branch_id.c1ec52996d: ROLLBACK
[0m06:41:27.628115 [debug] [Thread-1 (]: Failed to rollback 'test.vg_casestudy.not_null_branch_names_branch_id.c1ec52996d'
[0m06:41:27.628475 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_branch_names_branch_id.c1ec52996d: Close
[0m06:41:27.632228 [info ] [Thread-1 (]: 1 of 3 PASS not_null_branch_names_branch_id .................................... [[32mPASS[0m in 0.07s]
[0m06:41:27.632995 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.not_null_branch_names_branch_id.c1ec52996d
[0m06:41:27.633437 [debug] [Thread-1 (]: Began running node test.vg_casestudy.not_null_branch_names_branch_name.886056654c
[0m06:41:27.633991 [info ] [Thread-1 (]: 2 of 3 START test not_null_branch_names_branch_name ............................ [RUN]
[0m06:41:27.634722 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.not_null_branch_names_branch_id.c1ec52996d, now test.vg_casestudy.not_null_branch_names_branch_name.886056654c)
[0m06:41:27.635067 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.not_null_branch_names_branch_name.886056654c
[0m06:41:27.640839 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.not_null_branch_names_branch_name.886056654c"
[0m06:41:27.641624 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_branch_names_branch_name.886056654c (compile): 06:41:27.635297 => 06:41:27.641381
[0m06:41:27.642051 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.not_null_branch_names_branch_name.886056654c
[0m06:41:27.644964 [debug] [Thread-1 (]: Writing runtime sql for node "test.vg_casestudy.not_null_branch_names_branch_name.886056654c"
[0m06:41:27.645779 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.not_null_branch_names_branch_name.886056654c"
[0m06:41:27.646303 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_branch_names_branch_name.886056654c: BEGIN
[0m06:41:27.646674 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:41:27.659161 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:41:27.659624 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.not_null_branch_names_branch_name.886056654c"
[0m06:41:27.659984 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_branch_names_branch_name.886056654c: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "test.vg_casestudy.not_null_branch_names_branch_name.886056654c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select branch_name
from "casestudy"."raw"."branch_names"
where branch_name is null



      
    ) dbt_internal_test
[0m06:41:27.661097 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:41:27.663091 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_branch_names_branch_name.886056654c (execute): 06:41:27.642290 => 06:41:27.662792
[0m06:41:27.663798 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_branch_names_branch_name.886056654c: ROLLBACK
[0m06:41:27.664295 [debug] [Thread-1 (]: Failed to rollback 'test.vg_casestudy.not_null_branch_names_branch_name.886056654c'
[0m06:41:27.664619 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_branch_names_branch_name.886056654c: Close
[0m06:41:27.667149 [info ] [Thread-1 (]: 2 of 3 PASS not_null_branch_names_branch_name .................................. [[32mPASS[0m in 0.03s]
[0m06:41:27.667844 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.not_null_branch_names_branch_name.886056654c
[0m06:41:27.668277 [debug] [Thread-1 (]: Began running node test.vg_casestudy.unique_branch_names_branch_id.483a257391
[0m06:41:27.668833 [info ] [Thread-1 (]: 3 of 3 START test unique_branch_names_branch_id ................................ [RUN]
[0m06:41:27.669574 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.not_null_branch_names_branch_name.886056654c, now test.vg_casestudy.unique_branch_names_branch_id.483a257391)
[0m06:41:27.669899 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.unique_branch_names_branch_id.483a257391
[0m06:41:27.676281 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.unique_branch_names_branch_id.483a257391"
[0m06:41:27.677074 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.unique_branch_names_branch_id.483a257391 (compile): 06:41:27.670124 => 06:41:27.676856
[0m06:41:27.677445 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.unique_branch_names_branch_id.483a257391
[0m06:41:27.680273 [debug] [Thread-1 (]: Writing runtime sql for node "test.vg_casestudy.unique_branch_names_branch_id.483a257391"
[0m06:41:27.680906 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.unique_branch_names_branch_id.483a257391"
[0m06:41:27.681251 [debug] [Thread-1 (]: On test.vg_casestudy.unique_branch_names_branch_id.483a257391: BEGIN
[0m06:41:27.681562 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:41:27.694407 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:41:27.694875 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.unique_branch_names_branch_id.483a257391"
[0m06:41:27.695252 [debug] [Thread-1 (]: On test.vg_casestudy.unique_branch_names_branch_id.483a257391: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "test.vg_casestudy.unique_branch_names_branch_id.483a257391"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    branch_id as unique_field,
    count(*) as n_records

from "casestudy"."raw"."branch_names"
where branch_id is not null
group by branch_id
having count(*) > 1



      
    ) dbt_internal_test
[0m06:41:27.702374 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:41:27.704091 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.unique_branch_names_branch_id.483a257391 (execute): 06:41:27.677741 => 06:41:27.703873
[0m06:41:27.704480 [debug] [Thread-1 (]: On test.vg_casestudy.unique_branch_names_branch_id.483a257391: ROLLBACK
[0m06:41:27.704958 [debug] [Thread-1 (]: Failed to rollback 'test.vg_casestudy.unique_branch_names_branch_id.483a257391'
[0m06:41:27.705281 [debug] [Thread-1 (]: On test.vg_casestudy.unique_branch_names_branch_id.483a257391: Close
[0m06:41:27.707749 [info ] [Thread-1 (]: 3 of 3 PASS unique_branch_names_branch_id ...................................... [[32mPASS[0m in 0.04s]
[0m06:41:27.708416 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.unique_branch_names_branch_id.483a257391
[0m06:41:27.710204 [debug] [MainThread]: Using duckdb connection "master"
[0m06:41:27.710562 [debug] [MainThread]: On master: BEGIN
[0m06:41:27.710845 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:41:27.725287 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:41:27.725934 [debug] [MainThread]: On master: COMMIT
[0m06:41:27.726513 [debug] [MainThread]: Using duckdb connection "master"
[0m06:41:27.726939 [debug] [MainThread]: On master: COMMIT
[0m06:41:27.727689 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:41:27.728034 [debug] [MainThread]: On master: Close
[0m06:41:27.731650 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:41:27.732144 [debug] [MainThread]: Connection 'list_casestudy_core' was properly closed.
[0m06:41:27.732441 [debug] [MainThread]: Connection 'test.vg_casestudy.unique_branch_names_branch_id.483a257391' was properly closed.
[0m06:41:27.732764 [info ] [MainThread]: 
[0m06:41:27.733128 [info ] [MainThread]: Finished running 3 tests in 0 hours 0 minutes and 0.35 seconds (0.35s).
[0m06:41:27.733923 [debug] [MainThread]: Command end result
[0m06:41:27.752869 [info ] [MainThread]: 
[0m06:41:27.753443 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:41:27.753873 [info ] [MainThread]: 
[0m06:41:27.754291 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m06:41:27.754779 [debug] [MainThread]: Command `dbt test` succeeded at 06:41:27.754686 after 0.72 seconds
[0m06:41:27.755118 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff903c553d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff903a9e6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff905503210>]}
[0m06:41:27.755475 [debug] [MainThread]: Flushing usage events
[0m07:38:35.864215 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b58a0cc90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b58d620d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b5b302010>]}


============================== 07:38:35.870046 | 12fd9015-151c-4d10-8de7-7dc76c3b7cd3 ==============================
[0m07:38:35.870046 [info ] [MainThread]: Running with dbt=1.6.18
[0m07:38:35.870611 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/workspaces/vg_case_study_tim/transformation', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/workspaces/vg_case_study_tim/transformation/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt debug', 'send_anonymous_usage_stats': 'True'}
[0m07:38:35.870971 [info ] [MainThread]: dbt version: 1.6.18
[0m07:38:35.871302 [info ] [MainThread]: python version: 3.11.6
[0m07:38:35.871668 [info ] [MainThread]: python path: /usr/local/bin/python
[0m07:38:35.871978 [info ] [MainThread]: os info: Linux-5.15.153.1-microsoft-standard-WSL2-x86_64-with-glibc2.31
[0m07:38:36.007662 [info ] [MainThread]: Using profiles dir at /workspaces/vg_case_study_tim/transformation
[0m07:38:36.008213 [info ] [MainThread]: Using profiles.yml file at /workspaces/vg_case_study_tim/transformation/profiles.yml
[0m07:38:36.008605 [info ] [MainThread]: Using dbt_project.yml file at /workspaces/vg_case_study_tim/transformation/dbt_project.yml
[0m07:38:36.010090 [info ] [MainThread]: adapter type: duckdb
[0m07:38:36.010533 [info ] [MainThread]: adapter version: 1.6.2
[0m07:38:36.041821 [info ] [MainThread]: Configuration:
[0m07:38:36.042410 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m07:38:36.042734 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m07:38:36.043032 [info ] [MainThread]: Required dependencies:
[0m07:38:36.043338 [debug] [MainThread]: Executing "git --help"
[0m07:38:36.044873 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m07:38:36.045282 [debug] [MainThread]: STDERR: "b''"
[0m07:38:36.045570 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m07:38:36.045891 [info ] [MainThread]: Connection:
[0m07:38:36.046199 [info ] [MainThread]:   database: casestudy
[0m07:38:36.046496 [info ] [MainThread]:   schema: main
[0m07:38:36.046772 [info ] [MainThread]:   path: casestudy.duckdb
[0m07:38:36.047043 [info ] [MainThread]:   config_options: None
[0m07:38:36.047313 [info ] [MainThread]:   extensions: ['icu']
[0m07:38:36.047676 [info ] [MainThread]:   settings: None
[0m07:38:36.048011 [info ] [MainThread]:   external_root: .
[0m07:38:36.048314 [info ] [MainThread]:   use_credential_provider: None
[0m07:38:36.048601 [info ] [MainThread]:   attach: None
[0m07:38:36.048873 [info ] [MainThread]:   filesystems: None
[0m07:38:36.049144 [info ] [MainThread]:   remote: None
[0m07:38:36.049432 [info ] [MainThread]:   plugins: None
[0m07:38:36.049752 [info ] [MainThread]:   disable_transactions: False
[0m07:38:36.050180 [info ] [MainThread]: Registered adapter: duckdb=1.6.2
[0m07:38:36.050799 [debug] [MainThread]: Acquiring new duckdb connection 'debug'
[0m07:38:36.051238 [debug] [MainThread]: Using duckdb connection "debug"
[0m07:38:36.051662 [debug] [MainThread]: On debug: select 1 as id
[0m07:38:36.052061 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:38:36.182903 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m07:38:36.184034 [debug] [MainThread]: On debug: Close
[0m07:38:36.187666 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m07:38:36.188163 [info ] [MainThread]: [32mAll checks passed![0m
[0m07:38:36.188646 [debug] [MainThread]: Command `dbt debug` succeeded at 07:38:36.188549 after 0.34 seconds
[0m07:38:36.188995 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m07:38:36.189402 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b5d40ad50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b5d40a090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b5a56bd90>]}
[0m07:38:36.189827 [debug] [MainThread]: Flushing usage events
[0m07:54:59.619973 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c729cab50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c729cae10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c72866190>]}


============================== 07:54:59.624752 | 0e7833e7-13d2-4d3e-8c23-936c2342944b ==============================
[0m07:54:59.624752 [info ] [MainThread]: Running with dbt=1.6.18
[0m07:54:59.625351 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/workspaces/vg_case_study_tim/transformation', 'debug': 'False', 'version_check': 'True', 'log_path': '/workspaces/vg_case_study_tim/transformation/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --select intermediate__fx_rates_filled --full-refresh', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m07:54:59.830146 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0e7833e7-13d2-4d3e-8c23-936c2342944b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c727246d0>]}
[0m07:54:59.844985 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0e7833e7-13d2-4d3e-8c23-936c2342944b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c7457b250>]}
[0m07:54:59.846386 [info ] [MainThread]: Registered adapter: duckdb=1.6.2
[0m07:54:59.875541 [debug] [MainThread]: checksum: 7b9fab86a08e9e96a48a825af743c566d95b877e068b8c6d0dbafbf714447189, vars: {}, profile: , target: , version: 1.6.18
[0m07:54:59.979440 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 2 files added, 2 files changed.
[0m07:54:59.980238 [debug] [MainThread]: Partial parsing: added file: vg_casestudy://models/intermediate/intermediate__branch_names.sql
[0m07:54:59.980626 [debug] [MainThread]: Partial parsing: added file: vg_casestudy://models/intermediate/intermediate_fx_rates_filled.sql
[0m07:54:59.981335 [debug] [MainThread]: Partial parsing: updated file: vg_casestudy://models/intermediate/schema.yml
[0m07:54:59.981742 [debug] [MainThread]: Partial parsing: deleted file: vg_casestudy://models/intermediate/stg_staging_intermediate_fx_rates_filled.sql
[0m07:54:59.982065 [debug] [MainThread]: Partial parsing: updated file: vg_casestudy://models/core/core__transactions_with_euro.sql
[0m07:55:00.073688 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'intermediate_branch_names' in the 'models' section of file 'models/intermediate/schema.yml'
[0m07:55:00.183311 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.vg_casestudy.not_null_intermediate_branch_names_branch_id.ef2919adcb' (models/intermediate/schema.yml) depends on a node named 'intermediate_branch_names' in package '' which was not found
[0m07:55:00.183857 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.vg_casestudy.unique_intermediate_branch_names_branch_id.a88e4e405f' (models/intermediate/schema.yml) depends on a node named 'intermediate_branch_names' in package '' which was not found
[0m07:55:00.184291 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.vg_casestudy.not_null_intermediate_branch_names_branch_name.4bc35e17bd' (models/intermediate/schema.yml) depends on a node named 'intermediate_branch_names' in package '' which was not found
[0m07:55:00.199568 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.vg_casestudy.reporting
- models.vg_casestudy.marts
- models.vg_casestudy.main
[0m07:55:00.207768 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0e7833e7-13d2-4d3e-8c23-936c2342944b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c72d1db90>]}
[0m07:55:00.240718 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0e7833e7-13d2-4d3e-8c23-936c2342944b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c6e55fed0>]}
[0m07:55:00.241255 [info ] [MainThread]: Found 15 models, 1 analysis, 4 seeds, 94 tests, 5 sources, 0 exposures, 0 metrics, 632 macros, 0 groups, 0 semantic models
[0m07:55:00.241643 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0e7833e7-13d2-4d3e-8c23-936c2342944b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c6eeef450>]}
[0m07:55:00.242886 [warn ] [MainThread]: The selection criterion 'intermediate__fx_rates_filled' does not match any nodes
[0m07:55:00.244718 [info ] [MainThread]: 
[0m07:55:00.245252 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m07:55:00.245824 [debug] [MainThread]: Command end result
[0m07:55:00.263150 [debug] [MainThread]: Command `dbt run` succeeded at 07:55:00.262941 after 0.65 seconds
[0m07:55:00.263622 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c73270410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c72b99190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c772e4150>]}
[0m07:55:00.264000 [debug] [MainThread]: Flushing usage events
[0m07:55:58.505083 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb252c34a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb252ab7190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb252c0cf10>]}


============================== 07:55:58.510702 | ea7b9e57-06a5-4546-a04b-ec086e5745b8 ==============================
[0m07:55:58.510702 [info ] [MainThread]: Running with dbt=1.6.18
[0m07:55:58.511264 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/workspaces/vg_case_study_tim/transformation/logs', 'profiles_dir': '/workspaces/vg_case_study_tim/transformation', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --select intermediate__fx_rates_filled --full-refresh', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m07:55:58.705876 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ea7b9e57-06a5-4546-a04b-ec086e5745b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb2527ccd10>]}
[0m07:55:58.719544 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ea7b9e57-06a5-4546-a04b-ec086e5745b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb25291f410>]}
[0m07:55:58.721188 [info ] [MainThread]: Registered adapter: duckdb=1.6.2
[0m07:55:58.748168 [debug] [MainThread]: checksum: 7b9fab86a08e9e96a48a825af743c566d95b877e068b8c6d0dbafbf714447189, vars: {}, profile: , target: , version: 1.6.18
[0m07:55:58.846105 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 1 files changed.
[0m07:55:58.846892 [debug] [MainThread]: Partial parsing: added file: vg_casestudy://models/intermediate/intermediate__fx_rates_filled.sql
[0m07:55:58.847639 [debug] [MainThread]: Partial parsing: updated file: vg_casestudy://models/intermediate/schema.yml
[0m07:55:58.848120 [debug] [MainThread]: Partial parsing: deleted file: vg_casestudy://models/intermediate/intermediate_fx_rates_filled.sql
[0m07:55:59.030209 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.vg_casestudy.core__transactions_with_euro' (models/core/core__transactions_with_euro.sql) depends on a node named 'intermediate_fx_rates_filled' which was not found
[0m07:55:59.030857 [debug] [MainThread]: Command `dbt run` failed at 07:55:59.030746 after 0.54 seconds
[0m07:55:59.031209 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb25278b050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb2527e5710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb24e536890>]}
[0m07:55:59.031571 [debug] [MainThread]: Flushing usage events
[0m07:56:20.075420 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16fa7a6310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16fa673bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16fa646cd0>]}


============================== 07:56:20.079112 | e3bdbf45-19af-44cf-aa1b-754d9066769d ==============================
[0m07:56:20.079112 [info ] [MainThread]: Running with dbt=1.6.18
[0m07:56:20.079893 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/workspaces/vg_case_study_tim/transformation/logs', 'debug': 'False', 'profiles_dir': '/workspaces/vg_case_study_tim/transformation', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --select intermediate__fx_rates_filled --full-refresh', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m07:56:20.173575 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e3bdbf45-19af-44cf-aa1b-754d9066769d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16fa673890>]}
[0m07:56:20.187163 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e3bdbf45-19af-44cf-aa1b-754d9066769d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16fa00f910>]}
[0m07:56:20.187851 [info ] [MainThread]: Registered adapter: duckdb=1.6.2
[0m07:56:20.212849 [debug] [MainThread]: checksum: 7b9fab86a08e9e96a48a825af743c566d95b877e068b8c6d0dbafbf714447189, vars: {}, profile: , target: , version: 1.6.18
[0m07:56:20.257650 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 2 files changed.
[0m07:56:20.258522 [debug] [MainThread]: Partial parsing: added file: vg_casestudy://models/intermediate/intermediate__fx_rates_filled.sql
[0m07:56:20.259356 [debug] [MainThread]: Partial parsing: updated file: vg_casestudy://models/intermediate/schema.yml
[0m07:56:20.259904 [debug] [MainThread]: Partial parsing: deleted file: vg_casestudy://models/intermediate/intermediate_fx_rates_filled.sql
[0m07:56:20.260300 [debug] [MainThread]: Partial parsing: updated file: vg_casestudy://models/core/core__transactions_with_euro.sql
[0m07:56:20.457477 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.vg_casestudy.main
- models.vg_casestudy.marts
- models.vg_casestudy.reporting
[0m07:56:20.464353 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e3bdbf45-19af-44cf-aa1b-754d9066769d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16fa021b10>]}
[0m07:56:20.499124 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e3bdbf45-19af-44cf-aa1b-754d9066769d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16fa0e5310>]}
[0m07:56:20.499674 [info ] [MainThread]: Found 15 models, 1 analysis, 4 seeds, 94 tests, 5 sources, 0 exposures, 0 metrics, 632 macros, 0 groups, 0 semantic models
[0m07:56:20.500066 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e3bdbf45-19af-44cf-aa1b-754d9066769d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16f4d43ed0>]}
[0m07:56:20.502785 [info ] [MainThread]: 
[0m07:56:20.503635 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m07:56:20.504815 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_casestudy'
[0m07:56:20.513940 [debug] [ThreadPool]: Using duckdb connection "list_casestudy"
[0m07:56:20.514729 [debug] [ThreadPool]: On list_casestudy: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"casestudy"'
    
  
  
[0m07:56:20.515229 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:56:20.653171 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m07:56:20.654601 [debug] [ThreadPool]: On list_casestudy: Close
[0m07:56:20.658791 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy, now create_casestudy_intermediate)
[0m07:56:20.659711 [debug] [ThreadPool]: Creating schema "database: "casestudy"
schema: "intermediate"
"
[0m07:56:20.664404 [debug] [ThreadPool]: Using duckdb connection "create_casestudy_intermediate"
[0m07:56:20.664772 [debug] [ThreadPool]: On create_casestudy_intermediate: BEGIN
[0m07:56:20.665047 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:56:20.677130 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m07:56:20.677722 [debug] [ThreadPool]: Using duckdb connection "create_casestudy_intermediate"
[0m07:56:20.678069 [debug] [ThreadPool]: On create_casestudy_intermediate: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "create_casestudy_intermediate"} */
create schema if not exists "casestudy"."intermediate"
[0m07:56:20.678843 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m07:56:20.679726 [debug] [ThreadPool]: On create_casestudy_intermediate: COMMIT
[0m07:56:20.680034 [debug] [ThreadPool]: Using duckdb connection "create_casestudy_intermediate"
[0m07:56:20.680330 [debug] [ThreadPool]: On create_casestudy_intermediate: COMMIT
[0m07:56:20.681055 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m07:56:20.681365 [debug] [ThreadPool]: On create_casestudy_intermediate: Close
[0m07:56:20.686565 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_casestudy_intermediate, now list_casestudy_staging)
[0m07:56:20.692035 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_staging"
[0m07:56:20.692403 [debug] [ThreadPool]: On list_casestudy_staging: BEGIN
[0m07:56:20.692681 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:56:20.703891 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m07:56:20.704297 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_staging"
[0m07:56:20.704590 [debug] [ThreadPool]: On list_casestudy_staging: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_staging"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'staging'
    and table_catalog = 'casestudy'
  
[0m07:56:20.720090 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m07:56:20.721594 [debug] [ThreadPool]: On list_casestudy_staging: ROLLBACK
[0m07:56:20.723040 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_staging'
[0m07:56:20.723349 [debug] [ThreadPool]: On list_casestudy_staging: Close
[0m07:56:20.727440 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy_staging, now list_casestudy_raw)
[0m07:56:20.729655 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_raw"
[0m07:56:20.730080 [debug] [ThreadPool]: On list_casestudy_raw: BEGIN
[0m07:56:20.730397 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:56:20.741450 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m07:56:20.741836 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_raw"
[0m07:56:20.742125 [debug] [ThreadPool]: On list_casestudy_raw: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_raw"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'raw'
    and table_catalog = 'casestudy'
  
[0m07:56:20.750004 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m07:56:20.751426 [debug] [ThreadPool]: On list_casestudy_raw: ROLLBACK
[0m07:56:20.751925 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_raw'
[0m07:56:20.752200 [debug] [ThreadPool]: On list_casestudy_raw: Close
[0m07:56:20.755186 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy_raw, now list_casestudy_core)
[0m07:56:20.758383 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_core"
[0m07:56:20.758682 [debug] [ThreadPool]: On list_casestudy_core: BEGIN
[0m07:56:20.758969 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:56:20.770297 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m07:56:20.770690 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_core"
[0m07:56:20.771067 [debug] [ThreadPool]: On list_casestudy_core: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_core"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'core'
    and table_catalog = 'casestudy'
  
[0m07:56:20.779015 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m07:56:20.780209 [debug] [ThreadPool]: On list_casestudy_core: ROLLBACK
[0m07:56:20.780662 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_core'
[0m07:56:20.780958 [debug] [ThreadPool]: On list_casestudy_core: Close
[0m07:56:20.783860 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy_core, now list_casestudy_intermediate)
[0m07:56:20.786047 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_intermediate"
[0m07:56:20.786392 [debug] [ThreadPool]: On list_casestudy_intermediate: BEGIN
[0m07:56:20.786693 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:56:20.797390 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m07:56:20.797764 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_intermediate"
[0m07:56:20.798069 [debug] [ThreadPool]: On list_casestudy_intermediate: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_intermediate"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'intermediate'
    and table_catalog = 'casestudy'
  
[0m07:56:20.806254 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m07:56:20.807577 [debug] [ThreadPool]: On list_casestudy_intermediate: ROLLBACK
[0m07:56:20.808052 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_intermediate'
[0m07:56:20.808308 [debug] [ThreadPool]: On list_casestudy_intermediate: Close
[0m07:56:20.812148 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e3bdbf45-19af-44cf-aa1b-754d9066769d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16fa1d4fd0>]}
[0m07:56:20.812619 [debug] [MainThread]: Using duckdb connection "master"
[0m07:56:20.812896 [debug] [MainThread]: On master: BEGIN
[0m07:56:20.813154 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:56:20.826026 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m07:56:20.826425 [debug] [MainThread]: On master: COMMIT
[0m07:56:20.826701 [debug] [MainThread]: Using duckdb connection "master"
[0m07:56:20.826964 [debug] [MainThread]: On master: COMMIT
[0m07:56:20.827446 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m07:56:20.827736 [debug] [MainThread]: On master: Close
[0m07:56:20.830151 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m07:56:20.830741 [info ] [MainThread]: 
[0m07:56:20.836825 [debug] [Thread-1 (]: Began running node model.vg_casestudy.intermediate__fx_rates_filled
[0m07:56:20.837491 [info ] [Thread-1 (]: 1 of 1 START sql table model intermediate.intermediate__fx_rates_filled ........ [RUN]
[0m07:56:20.838441 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.vg_casestudy.intermediate__fx_rates_filled'
[0m07:56:20.838888 [debug] [Thread-1 (]: Began compiling node model.vg_casestudy.intermediate__fx_rates_filled
[0m07:56:20.861801 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.intermediate__fx_rates_filled"
[0m07:56:20.862319 [debug] [Thread-1 (]: On model.vg_casestudy.intermediate__fx_rates_filled: BEGIN
[0m07:56:20.862671 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m07:56:20.876824 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m07:56:20.877266 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.intermediate__fx_rates_filled"
[0m07:56:20.877602 [debug] [Thread-1 (]: On model.vg_casestudy.intermediate__fx_rates_filled: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.intermediate__fx_rates_filled"} */


        select 
        ((date('2025-03-11'))::date - (date('2024-12-31'))::date)
    
[0m07:56:20.879646 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m07:56:20.883336 [debug] [Thread-1 (]: Writing injected SQL for node "model.vg_casestudy.intermediate__fx_rates_filled"
[0m07:56:20.884110 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.intermediate__fx_rates_filled (compile): 07:56:20.839167 => 07:56:20.883866
[0m07:56:20.884464 [debug] [Thread-1 (]: Began executing node model.vg_casestudy.intermediate__fx_rates_filled
[0m07:56:20.921377 [debug] [Thread-1 (]: Writing runtime sql for node "model.vg_casestudy.intermediate__fx_rates_filled"
[0m07:56:20.922179 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.intermediate__fx_rates_filled"
[0m07:56:20.922688 [debug] [Thread-1 (]: On model.vg_casestudy.intermediate__fx_rates_filled: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.intermediate__fx_rates_filled"} */

  
    
    

    create  table
      "casestudy"."intermediate"."intermediate__fx_rates_filled__dbt_tmp"
  
    as (
      with calendar as (

    





with rawdata as (

    

    

    with p as (
        select 0 as generated_number union all select 1
    ), unioned as (

    select

    
    p0.generated_number * power(2, 0)
     + 
    
    p1.generated_number * power(2, 1)
     + 
    
    p2.generated_number * power(2, 2)
     + 
    
    p3.generated_number * power(2, 3)
     + 
    
    p4.generated_number * power(2, 4)
     + 
    
    p5.generated_number * power(2, 5)
     + 
    
    p6.generated_number * power(2, 6)
    
    
    + 1
    as generated_number

    from

    
    p as p0
     cross join 
    
    p as p1
     cross join 
    
    p as p2
     cross join 
    
    p as p3
     cross join 
    
    p as p4
     cross join 
    
    p as p5
     cross join 
    
    p as p6
    
    

    )

    select *
    from unioned
    where generated_number <= 70
    order by generated_number



),

all_periods as (

    select (
        

    date('2024-12-31') + ((interval '1 day') * (row_number() over (order by 1) - 1))


    ) as date_day
    from rawdata

),

filtered as (

    select *
    from all_periods
    where date_day <= date('2025-03-11')

)

select * from filtered



),

currencies as (
    select distinct trim(currency_iso_code) as currency_iso_code
    from "casestudy"."raw"."fx_rates_full_history"
),

date_matrix as (
    select 
        currencies.currency_iso_code,
        calendar.date_day as fx_rate_date
    from currencies
    cross join calendar 

),

joined as (
    select 
        date_matrix.currency_iso_code,
        date_matrix.fx_rate_date,
        fx_rates_full_history.fx_rate
    from date_matrix
    left join "casestudy"."raw"."fx_rates_full_history" as fx_rates_full_history
    on date_matrix.currency_iso_code = fx_rates_full_history.currency_iso_code
    and date_matrix.fx_rate_date = fx_rates_full_history.fx_rate_date
),

forward_fill_dates as (
    select 
        currency_iso_code,
        fx_rate_date::date as fx_rate_date,

        last_value(fx_rate ignore nulls) over(
            partition by currency_iso_code
            order by fx_rate_date asc
            rows between unbounded preceding and current row
        ) as fx_rate
    from joined
)

select *
from forward_fill_dates
    );
  
  
[0m07:56:20.946740 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m07:56:20.953277 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.intermediate__fx_rates_filled"
[0m07:56:20.953729 [debug] [Thread-1 (]: On model.vg_casestudy.intermediate__fx_rates_filled: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.intermediate__fx_rates_filled"} */
alter table "casestudy"."intermediate"."intermediate__fx_rates_filled__dbt_tmp" rename to "intermediate__fx_rates_filled"
[0m07:56:20.954731 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m07:56:20.973073 [debug] [Thread-1 (]: On model.vg_casestudy.intermediate__fx_rates_filled: COMMIT
[0m07:56:20.973561 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.intermediate__fx_rates_filled"
[0m07:56:20.973932 [debug] [Thread-1 (]: On model.vg_casestudy.intermediate__fx_rates_filled: COMMIT
[0m07:56:20.978890 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m07:56:20.985002 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.intermediate__fx_rates_filled"
[0m07:56:20.985515 [debug] [Thread-1 (]: On model.vg_casestudy.intermediate__fx_rates_filled: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.intermediate__fx_rates_filled"} */
drop table if exists "casestudy"."intermediate"."intermediate__fx_rates_filled__dbt_backup" cascade
[0m07:56:20.986453 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m07:56:20.987906 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.intermediate__fx_rates_filled (execute): 07:56:20.884702 => 07:56:20.987741
[0m07:56:20.988313 [debug] [Thread-1 (]: On model.vg_casestudy.intermediate__fx_rates_filled: Close
[0m07:56:21.018268 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e3bdbf45-19af-44cf-aa1b-754d9066769d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16f602bed0>]}
[0m07:56:21.019038 [info ] [Thread-1 (]: 1 of 1 OK created sql table model intermediate.intermediate__fx_rates_filled ... [[32mOK[0m in 0.18s]
[0m07:56:21.019648 [debug] [Thread-1 (]: Finished running node model.vg_casestudy.intermediate__fx_rates_filled
[0m07:56:21.021448 [debug] [MainThread]: Using duckdb connection "master"
[0m07:56:21.021811 [debug] [MainThread]: On master: BEGIN
[0m07:56:21.022094 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m07:56:21.036744 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m07:56:21.037417 [debug] [MainThread]: On master: COMMIT
[0m07:56:21.038016 [debug] [MainThread]: Using duckdb connection "master"
[0m07:56:21.038463 [debug] [MainThread]: On master: COMMIT
[0m07:56:21.039302 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m07:56:21.039670 [debug] [MainThread]: On master: Close
[0m07:56:21.042320 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:56:21.042743 [debug] [MainThread]: Connection 'list_casestudy_intermediate' was properly closed.
[0m07:56:21.043080 [debug] [MainThread]: Connection 'model.vg_casestudy.intermediate__fx_rates_filled' was properly closed.
[0m07:56:21.043493 [info ] [MainThread]: 
[0m07:56:21.043873 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.54 seconds (0.54s).
[0m07:56:21.044479 [debug] [MainThread]: Command end result
[0m07:56:21.064012 [info ] [MainThread]: 
[0m07:56:21.064633 [info ] [MainThread]: [32mCompleted successfully[0m
[0m07:56:21.065039 [info ] [MainThread]: 
[0m07:56:21.065425 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m07:56:21.065933 [debug] [MainThread]: Command `dbt run` succeeded at 07:56:21.065834 after 1.00 seconds
[0m07:56:21.066286 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16fa36c550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16fa47fe90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16fa47f590>]}
[0m07:56:21.066657 [debug] [MainThread]: Flushing usage events
[0m07:57:37.858871 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6094939c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f60947bd5d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f60948cfe10>]}


============================== 07:57:37.864611 | b8b45085-7147-4804-a175-42ed5b8cb9c3 ==============================
[0m07:57:37.864611 [info ] [MainThread]: Running with dbt=1.6.18
[0m07:57:37.865183 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/workspaces/vg_case_study_tim/transformation/logs', 'debug': 'False', 'profiles_dir': '/workspaces/vg_case_study_tim/transformation', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --select intermediate__branch_names --full-refresh', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m07:57:38.061485 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b8b45085-7147-4804-a175-42ed5b8cb9c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f609433c8d0>]}
[0m07:57:38.075882 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b8b45085-7147-4804-a175-42ed5b8cb9c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f60947bcc10>]}
[0m07:57:38.077280 [info ] [MainThread]: Registered adapter: duckdb=1.6.2
[0m07:57:38.105811 [debug] [MainThread]: checksum: 7b9fab86a08e9e96a48a825af743c566d95b877e068b8c6d0dbafbf714447189, vars: {}, profile: , target: , version: 1.6.18
[0m07:57:38.203830 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m07:57:38.205002 [debug] [MainThread]: Partial parsing: updated file: vg_casestudy://models/intermediate/schema.yml
[0m07:57:38.318803 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.vg_casestudy.main
- models.vg_casestudy.reporting
- models.vg_casestudy.marts
[0m07:57:38.325578 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b8b45085-7147-4804-a175-42ed5b8cb9c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6094233fd0>]}
[0m07:57:38.362713 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b8b45085-7147-4804-a175-42ed5b8cb9c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6090ae56d0>]}
[0m07:57:38.363259 [info ] [MainThread]: Found 15 models, 1 analysis, 4 seeds, 97 tests, 5 sources, 0 exposures, 0 metrics, 632 macros, 0 groups, 0 semantic models
[0m07:57:38.363672 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b8b45085-7147-4804-a175-42ed5b8cb9c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f608ff3f650>]}
[0m07:57:38.366170 [info ] [MainThread]: 
[0m07:57:38.366945 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m07:57:38.368114 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_casestudy'
[0m07:57:38.380847 [debug] [ThreadPool]: Using duckdb connection "list_casestudy"
[0m07:57:38.381305 [debug] [ThreadPool]: On list_casestudy: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"casestudy"'
    
  
  
[0m07:57:38.381676 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:57:38.520816 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m07:57:38.522300 [debug] [ThreadPool]: On list_casestudy: Close
[0m07:57:38.526683 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy, now create_casestudy_intermediate)
[0m07:57:38.527563 [debug] [ThreadPool]: Creating schema "database: "casestudy"
schema: "intermediate"
"
[0m07:57:38.532550 [debug] [ThreadPool]: Using duckdb connection "create_casestudy_intermediate"
[0m07:57:38.532977 [debug] [ThreadPool]: On create_casestudy_intermediate: BEGIN
[0m07:57:38.533266 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:57:38.545084 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m07:57:38.545507 [debug] [ThreadPool]: Using duckdb connection "create_casestudy_intermediate"
[0m07:57:38.545819 [debug] [ThreadPool]: On create_casestudy_intermediate: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "create_casestudy_intermediate"} */
create schema if not exists "casestudy"."intermediate"
[0m07:57:38.546548 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m07:57:38.547503 [debug] [ThreadPool]: On create_casestudy_intermediate: COMMIT
[0m07:57:38.547916 [debug] [ThreadPool]: Using duckdb connection "create_casestudy_intermediate"
[0m07:57:38.548224 [debug] [ThreadPool]: On create_casestudy_intermediate: COMMIT
[0m07:57:38.548797 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m07:57:38.549106 [debug] [ThreadPool]: On create_casestudy_intermediate: Close
[0m07:57:38.554311 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_casestudy_intermediate, now list_casestudy_raw)
[0m07:57:38.559454 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_raw"
[0m07:57:38.559781 [debug] [ThreadPool]: On list_casestudy_raw: BEGIN
[0m07:57:38.560068 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:57:38.571742 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m07:57:38.572145 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_raw"
[0m07:57:38.572438 [debug] [ThreadPool]: On list_casestudy_raw: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_raw"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'raw'
    and table_catalog = 'casestudy'
  
[0m07:57:38.586206 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m07:57:38.587938 [debug] [ThreadPool]: On list_casestudy_raw: ROLLBACK
[0m07:57:38.589425 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_raw'
[0m07:57:38.589730 [debug] [ThreadPool]: On list_casestudy_raw: Close
[0m07:57:38.593979 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy_raw, now list_casestudy_intermediate)
[0m07:57:38.596176 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_intermediate"
[0m07:57:38.596540 [debug] [ThreadPool]: On list_casestudy_intermediate: BEGIN
[0m07:57:38.598034 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:57:38.608293 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m07:57:38.608667 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_intermediate"
[0m07:57:38.608950 [debug] [ThreadPool]: On list_casestudy_intermediate: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_intermediate"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'intermediate'
    and table_catalog = 'casestudy'
  
[0m07:57:38.617226 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m07:57:38.618717 [debug] [ThreadPool]: On list_casestudy_intermediate: ROLLBACK
[0m07:57:38.619185 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_intermediate'
[0m07:57:38.619449 [debug] [ThreadPool]: On list_casestudy_intermediate: Close
[0m07:57:38.622333 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy_intermediate, now list_casestudy_staging)
[0m07:57:38.624467 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_staging"
[0m07:57:38.624807 [debug] [ThreadPool]: On list_casestudy_staging: BEGIN
[0m07:57:38.625137 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:57:38.635923 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m07:57:38.636309 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_staging"
[0m07:57:38.636621 [debug] [ThreadPool]: On list_casestudy_staging: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_staging"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'staging'
    and table_catalog = 'casestudy'
  
[0m07:57:38.644959 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m07:57:38.646341 [debug] [ThreadPool]: On list_casestudy_staging: ROLLBACK
[0m07:57:38.646837 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_staging'
[0m07:57:38.647095 [debug] [ThreadPool]: On list_casestudy_staging: Close
[0m07:57:38.650064 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy_staging, now list_casestudy_core)
[0m07:57:38.652233 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_core"
[0m07:57:38.652568 [debug] [ThreadPool]: On list_casestudy_core: BEGIN
[0m07:57:38.652899 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:57:38.663936 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m07:57:38.664330 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_core"
[0m07:57:38.664616 [debug] [ThreadPool]: On list_casestudy_core: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_core"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'core'
    and table_catalog = 'casestudy'
  
[0m07:57:38.672544 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m07:57:38.673753 [debug] [ThreadPool]: On list_casestudy_core: ROLLBACK
[0m07:57:38.674205 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_core'
[0m07:57:38.674557 [debug] [ThreadPool]: On list_casestudy_core: Close
[0m07:57:38.678005 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b8b45085-7147-4804-a175-42ed5b8cb9c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6095d73010>]}
[0m07:57:38.678495 [debug] [MainThread]: Using duckdb connection "master"
[0m07:57:38.678785 [debug] [MainThread]: On master: BEGIN
[0m07:57:38.679032 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:57:38.691513 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m07:57:38.692029 [debug] [MainThread]: On master: COMMIT
[0m07:57:38.692310 [debug] [MainThread]: Using duckdb connection "master"
[0m07:57:38.692567 [debug] [MainThread]: On master: COMMIT
[0m07:57:38.693155 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m07:57:38.693446 [debug] [MainThread]: On master: Close
[0m07:57:38.695970 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m07:57:38.696390 [info ] [MainThread]: 
[0m07:57:38.700259 [debug] [Thread-1 (]: Began running node model.vg_casestudy.intermediate__branch_names
[0m07:57:38.700769 [info ] [Thread-1 (]: 1 of 1 START sql table model intermediate.intermediate__branch_names ........... [RUN]
[0m07:57:38.701576 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.vg_casestudy.intermediate__branch_names'
[0m07:57:38.701898 [debug] [Thread-1 (]: Began compiling node model.vg_casestudy.intermediate__branch_names
[0m07:57:38.710717 [debug] [Thread-1 (]: Writing injected SQL for node "model.vg_casestudy.intermediate__branch_names"
[0m07:57:38.712007 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.intermediate__branch_names (compile): 07:57:38.702120 => 07:57:38.711597
[0m07:57:38.712835 [debug] [Thread-1 (]: Began executing node model.vg_casestudy.intermediate__branch_names
[0m07:57:38.747098 [debug] [Thread-1 (]: Writing runtime sql for node "model.vg_casestudy.intermediate__branch_names"
[0m07:57:38.747903 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.intermediate__branch_names"
[0m07:57:38.748289 [debug] [Thread-1 (]: On model.vg_casestudy.intermediate__branch_names: BEGIN
[0m07:57:38.748610 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m07:57:38.762932 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m07:57:38.763409 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.intermediate__branch_names"
[0m07:57:38.763760 [debug] [Thread-1 (]: On model.vg_casestudy.intermediate__branch_names: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.intermediate__branch_names"} */

  
    
    

    create  table
      "casestudy"."intermediate"."intermediate__branch_names__dbt_tmp"
  
    as (
      with branch_names as (
    select *
    from "casestudy"."raw"."branch_names"
)

select
    branch_id,
    branch_name 
from branch_names
    );
  
  
[0m07:57:38.771017 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m07:57:38.778040 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.intermediate__branch_names"
[0m07:57:38.778516 [debug] [Thread-1 (]: On model.vg_casestudy.intermediate__branch_names: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.intermediate__branch_names"} */
alter table "casestudy"."intermediate"."intermediate__branch_names__dbt_tmp" rename to "intermediate__branch_names"
[0m07:57:38.779582 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m07:57:38.796708 [debug] [Thread-1 (]: On model.vg_casestudy.intermediate__branch_names: COMMIT
[0m07:57:38.797147 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.intermediate__branch_names"
[0m07:57:38.797478 [debug] [Thread-1 (]: On model.vg_casestudy.intermediate__branch_names: COMMIT
[0m07:57:38.803963 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m07:57:38.809269 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.intermediate__branch_names"
[0m07:57:38.809667 [debug] [Thread-1 (]: On model.vg_casestudy.intermediate__branch_names: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.intermediate__branch_names"} */
drop table if exists "casestudy"."intermediate"."intermediate__branch_names__dbt_backup" cascade
[0m07:57:38.810590 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m07:57:38.811864 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.intermediate__branch_names (execute): 07:57:38.713179 => 07:57:38.811721
[0m07:57:38.812201 [debug] [Thread-1 (]: On model.vg_casestudy.intermediate__branch_names: Close
[0m07:57:38.844810 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b8b45085-7147-4804-a175-42ed5b8cb9c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f609434f810>]}
[0m07:57:38.845518 [info ] [Thread-1 (]: 1 of 1 OK created sql table model intermediate.intermediate__branch_names ...... [[32mOK[0m in 0.14s]
[0m07:57:38.846119 [debug] [Thread-1 (]: Finished running node model.vg_casestudy.intermediate__branch_names
[0m07:57:38.848106 [debug] [MainThread]: Using duckdb connection "master"
[0m07:57:38.848440 [debug] [MainThread]: On master: BEGIN
[0m07:57:38.848727 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m07:57:38.862863 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m07:57:38.863377 [debug] [MainThread]: On master: COMMIT
[0m07:57:38.863732 [debug] [MainThread]: Using duckdb connection "master"
[0m07:57:38.864026 [debug] [MainThread]: On master: COMMIT
[0m07:57:38.864715 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m07:57:38.865083 [debug] [MainThread]: On master: Close
[0m07:57:38.867554 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:57:38.867951 [debug] [MainThread]: Connection 'list_casestudy_core' was properly closed.
[0m07:57:38.868212 [debug] [MainThread]: Connection 'model.vg_casestudy.intermediate__branch_names' was properly closed.
[0m07:57:38.868514 [info ] [MainThread]: 
[0m07:57:38.868849 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.50 seconds (0.50s).
[0m07:57:38.869525 [debug] [MainThread]: Command end result
[0m07:57:38.889156 [info ] [MainThread]: 
[0m07:57:38.889663 [info ] [MainThread]: [32mCompleted successfully[0m
[0m07:57:38.890003 [info ] [MainThread]: 
[0m07:57:38.890368 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m07:57:38.890872 [debug] [MainThread]: Command `dbt run` succeeded at 07:57:38.890774 after 1.04 seconds
[0m07:57:38.891212 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6094e31d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6098e0ed10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f60945b3290>]}
[0m07:57:38.891595 [debug] [MainThread]: Flushing usage events
[0m07:59:22.197955 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa508e70890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa50b1bae50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa508d1cd10>]}


============================== 07:59:22.200422 | 6ca9e900-753d-445d-943d-bc5d4ef586f6 ==============================
[0m07:59:22.200422 [info ] [MainThread]: Running with dbt=1.6.18
[0m07:59:22.200989 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/workspaces/vg_case_study_tim/transformation', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/workspaces/vg_case_study_tim/transformation/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt test --select intermediate__branch_names', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m07:59:22.298352 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6ca9e900-753d-445d-943d-bc5d4ef586f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa50889e9d0>]}
[0m07:59:22.312488 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6ca9e900-753d-445d-943d-bc5d4ef586f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa508e5d210>]}
[0m07:59:22.313215 [info ] [MainThread]: Registered adapter: duckdb=1.6.2
[0m07:59:22.339646 [debug] [MainThread]: checksum: 7b9fab86a08e9e96a48a825af743c566d95b877e068b8c6d0dbafbf714447189, vars: {}, profile: , target: , version: 1.6.18
[0m07:59:22.384557 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:59:22.384991 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:59:22.386491 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.vg_casestudy.reporting
- models.vg_casestudy.main
- models.vg_casestudy.marts
[0m07:59:22.395174 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6ca9e900-753d-445d-943d-bc5d4ef586f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa508e943d0>]}
[0m07:59:22.465523 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6ca9e900-753d-445d-943d-bc5d4ef586f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa508d00750>]}
[0m07:59:22.466095 [info ] [MainThread]: Found 15 models, 1 analysis, 4 seeds, 97 tests, 5 sources, 0 exposures, 0 metrics, 632 macros, 0 groups, 0 semantic models
[0m07:59:22.466501 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6ca9e900-753d-445d-943d-bc5d4ef586f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5046d3d10>]}
[0m07:59:22.469120 [info ] [MainThread]: 
[0m07:59:22.469928 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m07:59:22.471942 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_casestudy_raw'
[0m07:59:22.484326 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_raw"
[0m07:59:22.484870 [debug] [ThreadPool]: On list_casestudy_raw: BEGIN
[0m07:59:22.485397 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:59:22.503599 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m07:59:22.504045 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_raw"
[0m07:59:22.504352 [debug] [ThreadPool]: On list_casestudy_raw: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_raw"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'raw'
    and table_catalog = 'casestudy'
  
[0m07:59:22.514830 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m07:59:22.516357 [debug] [ThreadPool]: On list_casestudy_raw: ROLLBACK
[0m07:59:22.517052 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_raw'
[0m07:59:22.517361 [debug] [ThreadPool]: On list_casestudy_raw: Close
[0m07:59:22.522485 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy_raw, now list_casestudy_core)
[0m07:59:22.525023 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_core"
[0m07:59:22.525439 [debug] [ThreadPool]: On list_casestudy_core: BEGIN
[0m07:59:22.527288 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:59:22.540283 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m07:59:22.540718 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_core"
[0m07:59:22.541055 [debug] [ThreadPool]: On list_casestudy_core: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_core"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'core'
    and table_catalog = 'casestudy'
  
[0m07:59:22.549695 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m07:59:22.550985 [debug] [ThreadPool]: On list_casestudy_core: ROLLBACK
[0m07:59:22.551463 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_core'
[0m07:59:22.551779 [debug] [ThreadPool]: On list_casestudy_core: Close
[0m07:59:22.555644 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy_core, now list_casestudy_staging)
[0m07:59:22.558443 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_staging"
[0m07:59:22.559438 [debug] [ThreadPool]: On list_casestudy_staging: BEGIN
[0m07:59:22.559842 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:59:22.572157 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m07:59:22.572685 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_staging"
[0m07:59:22.572983 [debug] [ThreadPool]: On list_casestudy_staging: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_staging"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'staging'
    and table_catalog = 'casestudy'
  
[0m07:59:22.581219 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m07:59:22.582575 [debug] [ThreadPool]: On list_casestudy_staging: ROLLBACK
[0m07:59:22.583123 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_staging'
[0m07:59:22.583415 [debug] [ThreadPool]: On list_casestudy_staging: Close
[0m07:59:22.586198 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy_staging, now list_casestudy_intermediate)
[0m07:59:22.588645 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_intermediate"
[0m07:59:22.589025 [debug] [ThreadPool]: On list_casestudy_intermediate: BEGIN
[0m07:59:22.589339 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:59:22.600776 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m07:59:22.601150 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_intermediate"
[0m07:59:22.601438 [debug] [ThreadPool]: On list_casestudy_intermediate: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_intermediate"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'intermediate'
    and table_catalog = 'casestudy'
  
[0m07:59:22.609681 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m07:59:22.611026 [debug] [ThreadPool]: On list_casestudy_intermediate: ROLLBACK
[0m07:59:22.611500 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_intermediate'
[0m07:59:22.611837 [debug] [ThreadPool]: On list_casestudy_intermediate: Close
[0m07:59:22.615918 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6ca9e900-753d-445d-943d-bc5d4ef586f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa50478ea10>]}
[0m07:59:22.616397 [debug] [MainThread]: Using duckdb connection "master"
[0m07:59:22.616673 [debug] [MainThread]: On master: BEGIN
[0m07:59:22.616928 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:59:22.629490 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m07:59:22.629902 [debug] [MainThread]: On master: COMMIT
[0m07:59:22.630183 [debug] [MainThread]: Using duckdb connection "master"
[0m07:59:22.630471 [debug] [MainThread]: On master: COMMIT
[0m07:59:22.630974 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m07:59:22.631256 [debug] [MainThread]: On master: Close
[0m07:59:22.633605 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m07:59:22.634020 [info ] [MainThread]: 
[0m07:59:22.636695 [debug] [Thread-1 (]: Began running node test.vg_casestudy.not_null_intermediate__branch_names_branch_id.7edecde87c
[0m07:59:22.637135 [info ] [Thread-1 (]: 1 of 3 START test not_null_intermediate__branch_names_branch_id ................ [RUN]
[0m07:59:22.637938 [debug] [Thread-1 (]: Acquiring new duckdb connection 'test.vg_casestudy.not_null_intermediate__branch_names_branch_id.7edecde87c'
[0m07:59:22.638259 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.not_null_intermediate__branch_names_branch_id.7edecde87c
[0m07:59:22.658003 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.not_null_intermediate__branch_names_branch_id.7edecde87c"
[0m07:59:22.658855 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_intermediate__branch_names_branch_id.7edecde87c (compile): 07:59:22.638485 => 07:59:22.658572
[0m07:59:22.659335 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.not_null_intermediate__branch_names_branch_id.7edecde87c
[0m07:59:22.672144 [debug] [Thread-1 (]: Writing runtime sql for node "test.vg_casestudy.not_null_intermediate__branch_names_branch_id.7edecde87c"
[0m07:59:22.672850 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.not_null_intermediate__branch_names_branch_id.7edecde87c"
[0m07:59:22.673204 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_intermediate__branch_names_branch_id.7edecde87c: BEGIN
[0m07:59:22.673506 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m07:59:22.687573 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m07:59:22.688022 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.not_null_intermediate__branch_names_branch_id.7edecde87c"
[0m07:59:22.688342 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_intermediate__branch_names_branch_id.7edecde87c: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "test.vg_casestudy.not_null_intermediate__branch_names_branch_id.7edecde87c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select branch_id
from "casestudy"."intermediate"."intermediate__branch_names"
where branch_id is null



      
    ) dbt_internal_test
[0m07:59:22.695022 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m07:59:22.698717 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_intermediate__branch_names_branch_id.7edecde87c (execute): 07:59:22.659642 => 07:59:22.698489
[0m07:59:22.699115 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_intermediate__branch_names_branch_id.7edecde87c: ROLLBACK
[0m07:59:22.699624 [debug] [Thread-1 (]: Failed to rollback 'test.vg_casestudy.not_null_intermediate__branch_names_branch_id.7edecde87c'
[0m07:59:22.699912 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_intermediate__branch_names_branch_id.7edecde87c: Close
[0m07:59:22.703387 [info ] [Thread-1 (]: 1 of 3 PASS not_null_intermediate__branch_names_branch_id ...................... [[32mPASS[0m in 0.07s]
[0m07:59:22.704059 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.not_null_intermediate__branch_names_branch_id.7edecde87c
[0m07:59:22.704474 [debug] [Thread-1 (]: Began running node test.vg_casestudy.not_null_intermediate__branch_names_branch_name.f5e9aa109d
[0m07:59:22.704828 [info ] [Thread-1 (]: 2 of 3 START test not_null_intermediate__branch_names_branch_name .............. [RUN]
[0m07:59:22.705608 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.not_null_intermediate__branch_names_branch_id.7edecde87c, now test.vg_casestudy.not_null_intermediate__branch_names_branch_name.f5e9aa109d)
[0m07:59:22.705949 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.not_null_intermediate__branch_names_branch_name.f5e9aa109d
[0m07:59:22.711051 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.not_null_intermediate__branch_names_branch_name.f5e9aa109d"
[0m07:59:22.712347 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_intermediate__branch_names_branch_name.f5e9aa109d (compile): 07:59:22.706179 => 07:59:22.712084
[0m07:59:22.712764 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.not_null_intermediate__branch_names_branch_name.f5e9aa109d
[0m07:59:22.715930 [debug] [Thread-1 (]: Writing runtime sql for node "test.vg_casestudy.not_null_intermediate__branch_names_branch_name.f5e9aa109d"
[0m07:59:22.716973 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.not_null_intermediate__branch_names_branch_name.f5e9aa109d"
[0m07:59:22.717734 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_intermediate__branch_names_branch_name.f5e9aa109d: BEGIN
[0m07:59:22.718432 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:59:22.731129 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m07:59:22.731613 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.not_null_intermediate__branch_names_branch_name.f5e9aa109d"
[0m07:59:22.732027 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_intermediate__branch_names_branch_name.f5e9aa109d: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "test.vg_casestudy.not_null_intermediate__branch_names_branch_name.f5e9aa109d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select branch_name
from "casestudy"."intermediate"."intermediate__branch_names"
where branch_name is null



      
    ) dbt_internal_test
[0m07:59:22.733987 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m07:59:22.735734 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_intermediate__branch_names_branch_name.f5e9aa109d (execute): 07:59:22.713045 => 07:59:22.735528
[0m07:59:22.736112 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_intermediate__branch_names_branch_name.f5e9aa109d: ROLLBACK
[0m07:59:22.736581 [debug] [Thread-1 (]: Failed to rollback 'test.vg_casestudy.not_null_intermediate__branch_names_branch_name.f5e9aa109d'
[0m07:59:22.736903 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_intermediate__branch_names_branch_name.f5e9aa109d: Close
[0m07:59:22.739264 [info ] [Thread-1 (]: 2 of 3 PASS not_null_intermediate__branch_names_branch_name .................... [[32mPASS[0m in 0.03s]
[0m07:59:22.739864 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.not_null_intermediate__branch_names_branch_name.f5e9aa109d
[0m07:59:22.740276 [debug] [Thread-1 (]: Began running node test.vg_casestudy.unique_intermediate__branch_names_branch_id.f3fd1c7d86
[0m07:59:22.740848 [info ] [Thread-1 (]: 3 of 3 START test unique_intermediate__branch_names_branch_id .................. [RUN]
[0m07:59:22.741741 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.not_null_intermediate__branch_names_branch_name.f5e9aa109d, now test.vg_casestudy.unique_intermediate__branch_names_branch_id.f3fd1c7d86)
[0m07:59:22.742146 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.unique_intermediate__branch_names_branch_id.f3fd1c7d86
[0m07:59:22.748122 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.unique_intermediate__branch_names_branch_id.f3fd1c7d86"
[0m07:59:22.749072 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.unique_intermediate__branch_names_branch_id.f3fd1c7d86 (compile): 07:59:22.742381 => 07:59:22.748808
[0m07:59:22.749597 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.unique_intermediate__branch_names_branch_id.f3fd1c7d86
[0m07:59:22.753039 [debug] [Thread-1 (]: Writing runtime sql for node "test.vg_casestudy.unique_intermediate__branch_names_branch_id.f3fd1c7d86"
[0m07:59:22.753853 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.unique_intermediate__branch_names_branch_id.f3fd1c7d86"
[0m07:59:22.754221 [debug] [Thread-1 (]: On test.vg_casestudy.unique_intermediate__branch_names_branch_id.f3fd1c7d86: BEGIN
[0m07:59:22.754543 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:59:22.769279 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m07:59:22.769753 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.unique_intermediate__branch_names_branch_id.f3fd1c7d86"
[0m07:59:22.770093 [debug] [Thread-1 (]: On test.vg_casestudy.unique_intermediate__branch_names_branch_id.f3fd1c7d86: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "test.vg_casestudy.unique_intermediate__branch_names_branch_id.f3fd1c7d86"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    branch_id as unique_field,
    count(*) as n_records

from "casestudy"."intermediate"."intermediate__branch_names"
where branch_id is not null
group by branch_id
having count(*) > 1



      
    ) dbt_internal_test
[0m07:59:22.777593 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m07:59:22.779348 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.unique_intermediate__branch_names_branch_id.f3fd1c7d86 (execute): 07:59:22.749939 => 07:59:22.779127
[0m07:59:22.779721 [debug] [Thread-1 (]: On test.vg_casestudy.unique_intermediate__branch_names_branch_id.f3fd1c7d86: ROLLBACK
[0m07:59:22.780245 [debug] [Thread-1 (]: Failed to rollback 'test.vg_casestudy.unique_intermediate__branch_names_branch_id.f3fd1c7d86'
[0m07:59:22.780578 [debug] [Thread-1 (]: On test.vg_casestudy.unique_intermediate__branch_names_branch_id.f3fd1c7d86: Close
[0m07:59:22.783185 [info ] [Thread-1 (]: 3 of 3 PASS unique_intermediate__branch_names_branch_id ........................ [[32mPASS[0m in 0.04s]
[0m07:59:22.783809 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.unique_intermediate__branch_names_branch_id.f3fd1c7d86
[0m07:59:22.785573 [debug] [MainThread]: Using duckdb connection "master"
[0m07:59:22.785909 [debug] [MainThread]: On master: BEGIN
[0m07:59:22.786178 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m07:59:22.802710 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m07:59:22.803156 [debug] [MainThread]: On master: COMMIT
[0m07:59:22.803545 [debug] [MainThread]: Using duckdb connection "master"
[0m07:59:22.803880 [debug] [MainThread]: On master: COMMIT
[0m07:59:22.804602 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m07:59:22.804949 [debug] [MainThread]: On master: Close
[0m07:59:22.807837 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:59:22.808219 [debug] [MainThread]: Connection 'list_casestudy_intermediate' was properly closed.
[0m07:59:22.808485 [debug] [MainThread]: Connection 'test.vg_casestudy.unique_intermediate__branch_names_branch_id.f3fd1c7d86' was properly closed.
[0m07:59:22.808839 [info ] [MainThread]: 
[0m07:59:22.809224 [info ] [MainThread]: Finished running 3 tests in 0 hours 0 minutes and 0.34 seconds (0.34s).
[0m07:59:22.810028 [debug] [MainThread]: Command end result
[0m07:59:22.830174 [info ] [MainThread]: 
[0m07:59:22.830936 [info ] [MainThread]: [32mCompleted successfully[0m
[0m07:59:22.831429 [info ] [MainThread]: 
[0m07:59:22.832022 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m07:59:22.832668 [debug] [MainThread]: Command `dbt test` succeeded at 07:59:22.832551 after 0.64 seconds
[0m07:59:22.833075 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa50d503390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa50d502250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa508cf6790>]}
[0m07:59:22.833552 [debug] [MainThread]: Flushing usage events
[0m07:59:30.928298 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f773bce7e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f773d120290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f773c2d2790>]}


============================== 07:59:30.930792 | e6010434-db94-47c0-a82c-6a0df509be50 ==============================
[0m07:59:30.930792 [info ] [MainThread]: Running with dbt=1.6.18
[0m07:59:30.931339 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/workspaces/vg_case_study_tim/transformation/logs', 'fail_fast': 'False', 'profiles_dir': '/workspaces/vg_case_study_tim/transformation', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt test --select path:models/intermediate', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m07:59:31.030913 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e6010434-db94-47c0-a82c-6a0df509be50', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f773bfb4cd0>]}
[0m07:59:31.045418 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e6010434-db94-47c0-a82c-6a0df509be50', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f773c2f6fd0>]}
[0m07:59:31.046153 [info ] [MainThread]: Registered adapter: duckdb=1.6.2
[0m07:59:31.070998 [debug] [MainThread]: checksum: 7b9fab86a08e9e96a48a825af743c566d95b877e068b8c6d0dbafbf714447189, vars: {}, profile: , target: , version: 1.6.18
[0m07:59:31.116893 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:59:31.117357 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:59:31.118822 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.vg_casestudy.reporting
- models.vg_casestudy.main
- models.vg_casestudy.marts
[0m07:59:31.126988 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e6010434-db94-47c0-a82c-6a0df509be50', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7737a16b50>]}
[0m07:59:31.198839 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e6010434-db94-47c0-a82c-6a0df509be50', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f773bfb6c50>]}
[0m07:59:31.199427 [info ] [MainThread]: Found 15 models, 1 analysis, 4 seeds, 97 tests, 5 sources, 0 exposures, 0 metrics, 632 macros, 0 groups, 0 semantic models
[0m07:59:31.199836 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e6010434-db94-47c0-a82c-6a0df509be50', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f773db3a510>]}
[0m07:59:31.205211 [info ] [MainThread]: 
[0m07:59:31.206056 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m07:59:31.208128 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_casestudy_staging'
[0m07:59:31.219964 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_staging"
[0m07:59:31.220413 [debug] [ThreadPool]: On list_casestudy_staging: BEGIN
[0m07:59:31.220762 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:59:31.237481 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m07:59:31.237927 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_staging"
[0m07:59:31.238230 [debug] [ThreadPool]: On list_casestudy_staging: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_staging"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'staging'
    and table_catalog = 'casestudy'
  
[0m07:59:31.248247 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m07:59:31.249853 [debug] [ThreadPool]: On list_casestudy_staging: ROLLBACK
[0m07:59:31.250535 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_staging'
[0m07:59:31.250865 [debug] [ThreadPool]: On list_casestudy_staging: Close
[0m07:59:31.255010 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy_staging, now list_casestudy_core)
[0m07:59:31.258729 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_core"
[0m07:59:31.259386 [debug] [ThreadPool]: On list_casestudy_core: BEGIN
[0m07:59:31.259806 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:59:31.270917 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m07:59:31.271330 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_core"
[0m07:59:31.271654 [debug] [ThreadPool]: On list_casestudy_core: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_core"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'core'
    and table_catalog = 'casestudy'
  
[0m07:59:31.282885 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m07:59:31.284554 [debug] [ThreadPool]: On list_casestudy_core: ROLLBACK
[0m07:59:31.285207 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_core'
[0m07:59:31.285579 [debug] [ThreadPool]: On list_casestudy_core: Close
[0m07:59:31.289909 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy_core, now list_casestudy_raw)
[0m07:59:31.293024 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_raw"
[0m07:59:31.293392 [debug] [ThreadPool]: On list_casestudy_raw: BEGIN
[0m07:59:31.293666 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:59:31.305039 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m07:59:31.305436 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_raw"
[0m07:59:31.305756 [debug] [ThreadPool]: On list_casestudy_raw: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_raw"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'raw'
    and table_catalog = 'casestudy'
  
[0m07:59:31.314536 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m07:59:31.315937 [debug] [ThreadPool]: On list_casestudy_raw: ROLLBACK
[0m07:59:31.316412 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_raw'
[0m07:59:31.316680 [debug] [ThreadPool]: On list_casestudy_raw: Close
[0m07:59:31.319774 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy_raw, now list_casestudy_intermediate)
[0m07:59:31.322782 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_intermediate"
[0m07:59:31.323151 [debug] [ThreadPool]: On list_casestudy_intermediate: BEGIN
[0m07:59:31.323480 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:59:31.336874 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m07:59:31.337325 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_intermediate"
[0m07:59:31.337634 [debug] [ThreadPool]: On list_casestudy_intermediate: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_intermediate"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'intermediate'
    and table_catalog = 'casestudy'
  
[0m07:59:31.346294 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m07:59:31.347648 [debug] [ThreadPool]: On list_casestudy_intermediate: ROLLBACK
[0m07:59:31.348120 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_intermediate'
[0m07:59:31.348390 [debug] [ThreadPool]: On list_casestudy_intermediate: Close
[0m07:59:31.352556 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e6010434-db94-47c0-a82c-6a0df509be50', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f773c223f90>]}
[0m07:59:31.353022 [debug] [MainThread]: Using duckdb connection "master"
[0m07:59:31.353294 [debug] [MainThread]: On master: BEGIN
[0m07:59:31.353562 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:59:31.365530 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m07:59:31.365948 [debug] [MainThread]: On master: COMMIT
[0m07:59:31.366240 [debug] [MainThread]: Using duckdb connection "master"
[0m07:59:31.366500 [debug] [MainThread]: On master: COMMIT
[0m07:59:31.367142 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m07:59:31.367474 [debug] [MainThread]: On master: Close
[0m07:59:31.370534 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m07:59:31.371112 [info ] [MainThread]: 
[0m07:59:31.374663 [debug] [Thread-1 (]: Began running node test.vg_casestudy.accepted_values_stg_staging_intermediate__loans_loan_status__approved__rejected__closed.3143a4d227
[0m07:59:31.375084 [info ] [Thread-1 (]: 1 of 42 START test accepted_values_stg_staging_intermediate__loans_loan_status__approved__rejected__closed  [RUN]
[0m07:59:31.375914 [debug] [Thread-1 (]: Acquiring new duckdb connection 'test.vg_casestudy.accepted_values_stg_staging_intermediate__loans_loan_status__approved__rejected__closed.3143a4d227'
[0m07:59:31.376257 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.accepted_values_stg_staging_intermediate__loans_loan_status__approved__rejected__closed.3143a4d227
[0m07:59:31.396008 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.accepted_values_stg_staging_intermediate__loans_loan_status__approved__rejected__closed.3143a4d227"
[0m07:59:31.399030 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.accepted_values_stg_staging_intermediate__loans_loan_status__approved__rejected__closed.3143a4d227 (compile): 07:59:31.376487 => 07:59:31.398755
[0m07:59:31.399489 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.accepted_values_stg_staging_intermediate__loans_loan_status__approved__rejected__closed.3143a4d227
[0m07:59:31.413858 [debug] [Thread-1 (]: Writing runtime sql for node "test.vg_casestudy.accepted_values_stg_staging_intermediate__loans_loan_status__approved__rejected__closed.3143a4d227"
[0m07:59:31.414522 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.accepted_values_stg_staging_intermediate__loans_loan_status__approved__rejected__closed.3143a4d227"
[0m07:59:31.414917 [debug] [Thread-1 (]: On test.vg_casestudy.accepted_values_stg_staging_intermediate__loans_loan_status__approved__rejected__closed.3143a4d227: BEGIN
[0m07:59:31.415280 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m07:59:31.433437 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m07:59:31.434060 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.accepted_values_stg_staging_intermediate__loans_loan_status__approved__rejected__closed.3143a4d227"
[0m07:59:31.434504 [debug] [Thread-1 (]: On test.vg_casestudy.accepted_values_stg_staging_intermediate__loans_loan_status__approved__rejected__closed.3143a4d227: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "test.vg_casestudy.accepted_values_stg_staging_intermediate__loans_loan_status__approved__rejected__closed.3143a4d227"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        loan_status as value_field,
        count(*) as n_records

    from "casestudy"."intermediate"."stg_staging_intermediate__loans"
    group by loan_status

)

select *
from all_values
where value_field not in (
    'approved','rejected','closed'
)



      
    ) dbt_internal_test
[0m07:59:31.439284 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m07:59:31.441740 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.accepted_values_stg_staging_intermediate__loans_loan_status__approved__rejected__closed.3143a4d227 (execute): 07:59:31.399722 => 07:59:31.441493
[0m07:59:31.442217 [debug] [Thread-1 (]: On test.vg_casestudy.accepted_values_stg_staging_intermediate__loans_loan_status__approved__rejected__closed.3143a4d227: ROLLBACK
[0m07:59:31.442720 [debug] [Thread-1 (]: Failed to rollback 'test.vg_casestudy.accepted_values_stg_staging_intermediate__loans_loan_status__approved__rejected__closed.3143a4d227'
[0m07:59:31.443118 [debug] [Thread-1 (]: On test.vg_casestudy.accepted_values_stg_staging_intermediate__loans_loan_status__approved__rejected__closed.3143a4d227: Close
[0m07:59:31.446340 [info ] [Thread-1 (]: 1 of 42 PASS accepted_values_stg_staging_intermediate__loans_loan_status__approved__rejected__closed  [[32mPASS[0m in 0.07s]
[0m07:59:31.446989 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.accepted_values_stg_staging_intermediate__loans_loan_status__approved__rejected__closed.3143a4d227
[0m07:59:31.447431 [debug] [Thread-1 (]: Began running node test.vg_casestudy.accepted_values_stg_staging_intermediate__loans_loan_term__12__24__36__48__60.5ea4cabc39
[0m07:59:31.447992 [info ] [Thread-1 (]: 2 of 42 START test accepted_values_stg_staging_intermediate__loans_loan_term__12__24__36__48__60  [RUN]
[0m07:59:31.448716 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.accepted_values_stg_staging_intermediate__loans_loan_status__approved__rejected__closed.3143a4d227, now test.vg_casestudy.accepted_values_stg_staging_intermediate__loans_loan_term__12__24__36__48__60.5ea4cabc39)
[0m07:59:31.449082 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.accepted_values_stg_staging_intermediate__loans_loan_term__12__24__36__48__60.5ea4cabc39
[0m07:59:31.453459 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.accepted_values_stg_staging_intermediate__loans_loan_term__12__24__36__48__60.5ea4cabc39"
[0m07:59:31.454111 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.accepted_values_stg_staging_intermediate__loans_loan_term__12__24__36__48__60.5ea4cabc39 (compile): 07:59:31.449309 => 07:59:31.453873
[0m07:59:31.454607 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.accepted_values_stg_staging_intermediate__loans_loan_term__12__24__36__48__60.5ea4cabc39
[0m07:59:31.457643 [debug] [Thread-1 (]: Writing runtime sql for node "test.vg_casestudy.accepted_values_stg_staging_intermediate__loans_loan_term__12__24__36__48__60.5ea4cabc39"
[0m07:59:31.458487 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.accepted_values_stg_staging_intermediate__loans_loan_term__12__24__36__48__60.5ea4cabc39"
[0m07:59:31.459043 [debug] [Thread-1 (]: On test.vg_casestudy.accepted_values_stg_staging_intermediate__loans_loan_term__12__24__36__48__60.5ea4cabc39: BEGIN
[0m07:59:31.459418 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:59:31.472222 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m07:59:31.472719 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.accepted_values_stg_staging_intermediate__loans_loan_term__12__24__36__48__60.5ea4cabc39"
[0m07:59:31.473081 [debug] [Thread-1 (]: On test.vg_casestudy.accepted_values_stg_staging_intermediate__loans_loan_term__12__24__36__48__60.5ea4cabc39: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "test.vg_casestudy.accepted_values_stg_staging_intermediate__loans_loan_term__12__24__36__48__60.5ea4cabc39"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        loan_term as value_field,
        count(*) as n_records

    from "casestudy"."intermediate"."stg_staging_intermediate__loans"
    group by loan_term

)

select *
from all_values
where value_field not in (
    '12','24','36','48','60'
)



      
    ) dbt_internal_test
[0m07:59:31.474905 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m07:59:31.476705 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.accepted_values_stg_staging_intermediate__loans_loan_term__12__24__36__48__60.5ea4cabc39 (execute): 07:59:31.454926 => 07:59:31.476409
[0m07:59:31.477257 [debug] [Thread-1 (]: On test.vg_casestudy.accepted_values_stg_staging_intermediate__loans_loan_term__12__24__36__48__60.5ea4cabc39: ROLLBACK
[0m07:59:31.477757 [debug] [Thread-1 (]: Failed to rollback 'test.vg_casestudy.accepted_values_stg_staging_intermediate__loans_loan_term__12__24__36__48__60.5ea4cabc39'
[0m07:59:31.478089 [debug] [Thread-1 (]: On test.vg_casestudy.accepted_values_stg_staging_intermediate__loans_loan_term__12__24__36__48__60.5ea4cabc39: Close
[0m07:59:31.480657 [info ] [Thread-1 (]: 2 of 42 PASS accepted_values_stg_staging_intermediate__loans_loan_term__12__24__36__48__60  [[32mPASS[0m in 0.03s]
[0m07:59:31.481283 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.accepted_values_stg_staging_intermediate__loans_loan_term__12__24__36__48__60.5ea4cabc39
[0m07:59:31.481749 [debug] [Thread-1 (]: Began running node test.vg_casestudy.accepted_values_stg_staging_intermediate__transactions_transaction_currency__AUD__BGN__CHF__CZK__DKK__GBP__HUF__ISK__JPY__NOK__PLN__RON__SEK__TRY.93638c3051
[0m07:59:31.482120 [info ] [Thread-1 (]: 3 of 42 START test accepted_values_stg_staging_intermediate__transactions_transaction_currency__AUD__BGN__CHF__CZK__DKK__GBP__HUF__ISK__JPY__NOK__PLN__RON__SEK__TRY  [RUN]
[0m07:59:31.482938 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.accepted_values_stg_staging_intermediate__loans_loan_term__12__24__36__48__60.5ea4cabc39, now test.vg_casestudy.accepted_values_stg_staging_intermediate__transactions_transaction_currency__AUD__BGN__CHF__CZK__DKK__GBP__HUF__ISK__JPY__NOK__PLN__RON__SEK__TRY.93638c3051)
[0m07:59:31.483301 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.accepted_values_stg_staging_intermediate__transactions_transaction_currency__AUD__BGN__CHF__CZK__DKK__GBP__HUF__ISK__JPY__NOK__PLN__RON__SEK__TRY.93638c3051
[0m07:59:31.496145 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.accepted_values_stg_staging_intermediate__transactions_transaction_currency__AUD__BGN__CHF__CZK__DKK__GBP__HUF__ISK__JPY__NOK__PLN__RON__SEK__TRY.93638c3051"
[0m07:59:31.497951 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.accepted_values_stg_staging_intermediate__transactions_transaction_currency__AUD__BGN__CHF__CZK__DKK__GBP__HUF__ISK__JPY__NOK__PLN__RON__SEK__TRY.93638c3051 (compile): 07:59:31.483541 => 07:59:31.497646
[0m07:59:31.498456 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.accepted_values_stg_staging_intermediate__transactions_transaction_currency__AUD__BGN__CHF__CZK__DKK__GBP__HUF__ISK__JPY__NOK__PLN__RON__SEK__TRY.93638c3051
[0m07:59:31.501836 [debug] [Thread-1 (]: Writing runtime sql for node "test.vg_casestudy.accepted_values_stg_staging_intermediate__transactions_transaction_currency__AUD__BGN__CHF__CZK__DKK__GBP__HUF__ISK__JPY__NOK__PLN__RON__SEK__TRY.93638c3051"
[0m07:59:31.502765 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.accepted_values_stg_staging_intermediate__transactions_transaction_currency__AUD__BGN__CHF__CZK__DKK__GBP__HUF__ISK__JPY__NOK__PLN__RON__SEK__TRY.93638c3051"
[0m07:59:31.503448 [debug] [Thread-1 (]: On test.vg_casestudy.accepted_values_stg_staging_intermediate__transactions_transaction_currency__AUD__BGN__CHF__CZK__DKK__GBP__HUF__ISK__JPY__NOK__PLN__RON__SEK__TRY.93638c3051: BEGIN
[0m07:59:31.503946 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:59:31.516208 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m07:59:31.516693 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.accepted_values_stg_staging_intermediate__transactions_transaction_currency__AUD__BGN__CHF__CZK__DKK__GBP__HUF__ISK__JPY__NOK__PLN__RON__SEK__TRY.93638c3051"
[0m07:59:31.517077 [debug] [Thread-1 (]: On test.vg_casestudy.accepted_values_stg_staging_intermediate__transactions_transaction_currency__AUD__BGN__CHF__CZK__DKK__GBP__HUF__ISK__JPY__NOK__PLN__RON__SEK__TRY.93638c3051: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "test.vg_casestudy.accepted_values_stg_staging_intermediate__transactions_transaction_currency__AUD__BGN__CHF__CZK__DKK__GBP__HUF__ISK__JPY__NOK__PLN__RON__SEK__TRY.93638c3051"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        transaction_currency as value_field,
        count(*) as n_records

    from "casestudy"."intermediate"."stg_staging_intermediate__transactions"
    group by transaction_currency

)

select *
from all_values
where value_field not in (
    'AUD','BGN','CHF','CZK','DKK','GBP','HUF','ISK','JPY','NOK','PLN','RON','SEK','TRY'
)



      
    ) dbt_internal_test
[0m07:59:31.522064 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m07:59:31.523786 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.accepted_values_stg_staging_intermediate__transactions_transaction_currency__AUD__BGN__CHF__CZK__DKK__GBP__HUF__ISK__JPY__NOK__PLN__RON__SEK__TRY.93638c3051 (execute): 07:59:31.498855 => 07:59:31.523573
[0m07:59:31.524183 [debug] [Thread-1 (]: On test.vg_casestudy.accepted_values_stg_staging_intermediate__transactions_transaction_currency__AUD__BGN__CHF__CZK__DKK__GBP__HUF__ISK__JPY__NOK__PLN__RON__SEK__TRY.93638c3051: ROLLBACK
[0m07:59:31.524710 [debug] [Thread-1 (]: Failed to rollback 'test.vg_casestudy.accepted_values_stg_staging_intermediate__transactions_transaction_currency__AUD__BGN__CHF__CZK__DKK__GBP__HUF__ISK__JPY__NOK__PLN__RON__SEK__TRY.93638c3051'
[0m07:59:31.525029 [debug] [Thread-1 (]: On test.vg_casestudy.accepted_values_stg_staging_intermediate__transactions_transaction_currency__AUD__BGN__CHF__CZK__DKK__GBP__HUF__ISK__JPY__NOK__PLN__RON__SEK__TRY.93638c3051: Close
[0m07:59:31.527830 [info ] [Thread-1 (]: 3 of 42 PASS accepted_values_stg_staging_intermediate__transactions_transaction_currency__AUD__BGN__CHF__CZK__DKK__GBP__HUF__ISK__JPY__NOK__PLN__RON__SEK__TRY  [[32mPASS[0m in 0.05s]
[0m07:59:31.528502 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.accepted_values_stg_staging_intermediate__transactions_transaction_currency__AUD__BGN__CHF__CZK__DKK__GBP__HUF__ISK__JPY__NOK__PLN__RON__SEK__TRY.93638c3051
[0m07:59:31.528921 [debug] [Thread-1 (]: Began running node test.vg_casestudy.date_is_past_stg_staging_intermediate__accounts_account_opening_date.f0a9449f31
[0m07:59:31.529295 [info ] [Thread-1 (]: 4 of 42 START test date_is_past_stg_staging_intermediate__accounts_account_opening_date  [RUN]
[0m07:59:31.530194 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.accepted_values_stg_staging_intermediate__transactions_transaction_currency__AUD__BGN__CHF__CZK__DKK__GBP__HUF__ISK__JPY__NOK__PLN__RON__SEK__TRY.93638c3051, now test.vg_casestudy.date_is_past_stg_staging_intermediate__accounts_account_opening_date.f0a9449f31)
[0m07:59:31.530542 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.date_is_past_stg_staging_intermediate__accounts_account_opening_date.f0a9449f31
[0m07:59:31.537199 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.date_is_past_stg_staging_intermediate__accounts_account_opening_date.f0a9449f31"
[0m07:59:31.538254 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.date_is_past_stg_staging_intermediate__accounts_account_opening_date.f0a9449f31 (compile): 07:59:31.530770 => 07:59:31.537885
[0m07:59:31.538865 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.date_is_past_stg_staging_intermediate__accounts_account_opening_date.f0a9449f31
[0m07:59:31.541882 [debug] [Thread-1 (]: Writing runtime sql for node "test.vg_casestudy.date_is_past_stg_staging_intermediate__accounts_account_opening_date.f0a9449f31"
[0m07:59:31.542706 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.date_is_past_stg_staging_intermediate__accounts_account_opening_date.f0a9449f31"
[0m07:59:31.543114 [debug] [Thread-1 (]: On test.vg_casestudy.date_is_past_stg_staging_intermediate__accounts_account_opening_date.f0a9449f31: BEGIN
[0m07:59:31.543592 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:59:31.556711 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m07:59:31.557209 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.date_is_past_stg_staging_intermediate__accounts_account_opening_date.f0a9449f31"
[0m07:59:31.557582 [debug] [Thread-1 (]: On test.vg_casestudy.date_is_past_stg_staging_intermediate__accounts_account_opening_date.f0a9449f31: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "test.vg_casestudy.date_is_past_stg_staging_intermediate__accounts_account_opening_date.f0a9449f31"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

    select *
    from "casestudy"."intermediate"."stg_staging_intermediate__accounts"
    where account_opening_date > current_date()
    

      
    ) dbt_internal_test
[0m07:59:31.560969 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m07:59:31.562989 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.date_is_past_stg_staging_intermediate__accounts_account_opening_date.f0a9449f31 (execute): 07:59:31.539174 => 07:59:31.562715
[0m07:59:31.563519 [debug] [Thread-1 (]: On test.vg_casestudy.date_is_past_stg_staging_intermediate__accounts_account_opening_date.f0a9449f31: ROLLBACK
[0m07:59:31.564138 [debug] [Thread-1 (]: Failed to rollback 'test.vg_casestudy.date_is_past_stg_staging_intermediate__accounts_account_opening_date.f0a9449f31'
[0m07:59:31.564480 [debug] [Thread-1 (]: On test.vg_casestudy.date_is_past_stg_staging_intermediate__accounts_account_opening_date.f0a9449f31: Close
[0m07:59:31.567226 [info ] [Thread-1 (]: 4 of 42 PASS date_is_past_stg_staging_intermediate__accounts_account_opening_date  [[32mPASS[0m in 0.04s]
[0m07:59:31.567995 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.date_is_past_stg_staging_intermediate__accounts_account_opening_date.f0a9449f31
[0m07:59:31.568487 [debug] [Thread-1 (]: Began running node test.vg_casestudy.date_is_past_stg_staging_intermediate__fx_rates_fx_rate_date.6dd6ccf2e2
[0m07:59:31.569139 [info ] [Thread-1 (]: 5 of 42 START test date_is_past_stg_staging_intermediate__fx_rates_fx_rate_date  [RUN]
[0m07:59:31.569956 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.date_is_past_stg_staging_intermediate__accounts_account_opening_date.f0a9449f31, now test.vg_casestudy.date_is_past_stg_staging_intermediate__fx_rates_fx_rate_date.6dd6ccf2e2)
[0m07:59:31.570363 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.date_is_past_stg_staging_intermediate__fx_rates_fx_rate_date.6dd6ccf2e2
[0m07:59:31.574999 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.date_is_past_stg_staging_intermediate__fx_rates_fx_rate_date.6dd6ccf2e2"
[0m07:59:31.576119 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.date_is_past_stg_staging_intermediate__fx_rates_fx_rate_date.6dd6ccf2e2 (compile): 07:59:31.570617 => 07:59:31.575780
[0m07:59:31.576712 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.date_is_past_stg_staging_intermediate__fx_rates_fx_rate_date.6dd6ccf2e2
[0m07:59:31.580658 [debug] [Thread-1 (]: Writing runtime sql for node "test.vg_casestudy.date_is_past_stg_staging_intermediate__fx_rates_fx_rate_date.6dd6ccf2e2"
[0m07:59:31.581787 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.date_is_past_stg_staging_intermediate__fx_rates_fx_rate_date.6dd6ccf2e2"
[0m07:59:31.582444 [debug] [Thread-1 (]: On test.vg_casestudy.date_is_past_stg_staging_intermediate__fx_rates_fx_rate_date.6dd6ccf2e2: BEGIN
[0m07:59:31.583092 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:59:31.595547 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m07:59:31.596039 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.date_is_past_stg_staging_intermediate__fx_rates_fx_rate_date.6dd6ccf2e2"
[0m07:59:31.596403 [debug] [Thread-1 (]: On test.vg_casestudy.date_is_past_stg_staging_intermediate__fx_rates_fx_rate_date.6dd6ccf2e2: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "test.vg_casestudy.date_is_past_stg_staging_intermediate__fx_rates_fx_rate_date.6dd6ccf2e2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

    select *
    from "casestudy"."intermediate"."stg_staging_intermediate__fx_rates"
    where fx_rate_date > current_date()
    

      
    ) dbt_internal_test
[0m07:59:31.597780 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m07:59:31.599225 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.date_is_past_stg_staging_intermediate__fx_rates_fx_rate_date.6dd6ccf2e2 (execute): 07:59:31.577098 => 07:59:31.599044
[0m07:59:31.599610 [debug] [Thread-1 (]: On test.vg_casestudy.date_is_past_stg_staging_intermediate__fx_rates_fx_rate_date.6dd6ccf2e2: ROLLBACK
[0m07:59:31.600055 [debug] [Thread-1 (]: Failed to rollback 'test.vg_casestudy.date_is_past_stg_staging_intermediate__fx_rates_fx_rate_date.6dd6ccf2e2'
[0m07:59:31.600379 [debug] [Thread-1 (]: On test.vg_casestudy.date_is_past_stg_staging_intermediate__fx_rates_fx_rate_date.6dd6ccf2e2: Close
[0m07:59:31.602846 [info ] [Thread-1 (]: 5 of 42 PASS date_is_past_stg_staging_intermediate__fx_rates_fx_rate_date ...... [[32mPASS[0m in 0.03s]
[0m07:59:31.603464 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.date_is_past_stg_staging_intermediate__fx_rates_fx_rate_date.6dd6ccf2e2
[0m07:59:31.603887 [debug] [Thread-1 (]: Began running node test.vg_casestudy.date_is_past_stg_staging_intermediate__loans_approval_rejection_date.61c247afe7
[0m07:59:31.604305 [info ] [Thread-1 (]: 6 of 42 START test date_is_past_stg_staging_intermediate__loans_approval_rejection_date  [RUN]
[0m07:59:31.605199 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.date_is_past_stg_staging_intermediate__fx_rates_fx_rate_date.6dd6ccf2e2, now test.vg_casestudy.date_is_past_stg_staging_intermediate__loans_approval_rejection_date.61c247afe7)
[0m07:59:31.605635 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.date_is_past_stg_staging_intermediate__loans_approval_rejection_date.61c247afe7
[0m07:59:31.610314 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.date_is_past_stg_staging_intermediate__loans_approval_rejection_date.61c247afe7"
[0m07:59:31.611374 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.date_is_past_stg_staging_intermediate__loans_approval_rejection_date.61c247afe7 (compile): 07:59:31.605866 => 07:59:31.611040
[0m07:59:31.611970 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.date_is_past_stg_staging_intermediate__loans_approval_rejection_date.61c247afe7
[0m07:59:31.614899 [debug] [Thread-1 (]: Writing runtime sql for node "test.vg_casestudy.date_is_past_stg_staging_intermediate__loans_approval_rejection_date.61c247afe7"
[0m07:59:31.615692 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.date_is_past_stg_staging_intermediate__loans_approval_rejection_date.61c247afe7"
[0m07:59:31.616065 [debug] [Thread-1 (]: On test.vg_casestudy.date_is_past_stg_staging_intermediate__loans_approval_rejection_date.61c247afe7: BEGIN
[0m07:59:31.616390 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:59:31.628727 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m07:59:31.629200 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.date_is_past_stg_staging_intermediate__loans_approval_rejection_date.61c247afe7"
[0m07:59:31.629566 [debug] [Thread-1 (]: On test.vg_casestudy.date_is_past_stg_staging_intermediate__loans_approval_rejection_date.61c247afe7: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "test.vg_casestudy.date_is_past_stg_staging_intermediate__loans_approval_rejection_date.61c247afe7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

    select *
    from "casestudy"."intermediate"."stg_staging_intermediate__loans"
    where approval_rejection_date > current_date()
    

      
    ) dbt_internal_test
[0m07:59:31.630821 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m07:59:31.632331 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.date_is_past_stg_staging_intermediate__loans_approval_rejection_date.61c247afe7 (execute): 07:59:31.612322 => 07:59:31.632139
[0m07:59:31.632720 [debug] [Thread-1 (]: On test.vg_casestudy.date_is_past_stg_staging_intermediate__loans_approval_rejection_date.61c247afe7: ROLLBACK
[0m07:59:31.633166 [debug] [Thread-1 (]: Failed to rollback 'test.vg_casestudy.date_is_past_stg_staging_intermediate__loans_approval_rejection_date.61c247afe7'
[0m07:59:31.633481 [debug] [Thread-1 (]: On test.vg_casestudy.date_is_past_stg_staging_intermediate__loans_approval_rejection_date.61c247afe7: Close
[0m07:59:31.635861 [info ] [Thread-1 (]: 6 of 42 PASS date_is_past_stg_staging_intermediate__loans_approval_rejection_date  [[32mPASS[0m in 0.03s]
[0m07:59:31.636475 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.date_is_past_stg_staging_intermediate__loans_approval_rejection_date.61c247afe7
[0m07:59:31.636888 [debug] [Thread-1 (]: Began running node test.vg_casestudy.not_null_intermediate__branch_names_branch_id.7edecde87c
[0m07:59:31.637425 [info ] [Thread-1 (]: 7 of 42 START test not_null_intermediate__branch_names_branch_id ............... [RUN]
[0m07:59:31.638148 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.date_is_past_stg_staging_intermediate__loans_approval_rejection_date.61c247afe7, now test.vg_casestudy.not_null_intermediate__branch_names_branch_id.7edecde87c)
[0m07:59:31.638481 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.not_null_intermediate__branch_names_branch_id.7edecde87c
[0m07:59:31.646301 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.not_null_intermediate__branch_names_branch_id.7edecde87c"
[0m07:59:31.647409 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_intermediate__branch_names_branch_id.7edecde87c (compile): 07:59:31.638705 => 07:59:31.647089
[0m07:59:31.647972 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.not_null_intermediate__branch_names_branch_id.7edecde87c
[0m07:59:31.651966 [debug] [Thread-1 (]: Writing runtime sql for node "test.vg_casestudy.not_null_intermediate__branch_names_branch_id.7edecde87c"
[0m07:59:31.653020 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.not_null_intermediate__branch_names_branch_id.7edecde87c"
[0m07:59:31.653471 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_intermediate__branch_names_branch_id.7edecde87c: BEGIN
[0m07:59:31.653782 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:59:31.666516 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m07:59:31.666996 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.not_null_intermediate__branch_names_branch_id.7edecde87c"
[0m07:59:31.667341 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_intermediate__branch_names_branch_id.7edecde87c: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "test.vg_casestudy.not_null_intermediate__branch_names_branch_id.7edecde87c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select branch_id
from "casestudy"."intermediate"."intermediate__branch_names"
where branch_id is null



      
    ) dbt_internal_test
[0m07:59:31.668543 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m07:59:31.670010 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_intermediate__branch_names_branch_id.7edecde87c (execute): 07:59:31.648314 => 07:59:31.669826
[0m07:59:31.670398 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_intermediate__branch_names_branch_id.7edecde87c: ROLLBACK
[0m07:59:31.670845 [debug] [Thread-1 (]: Failed to rollback 'test.vg_casestudy.not_null_intermediate__branch_names_branch_id.7edecde87c'
[0m07:59:31.671172 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_intermediate__branch_names_branch_id.7edecde87c: Close
[0m07:59:31.673968 [info ] [Thread-1 (]: 7 of 42 PASS not_null_intermediate__branch_names_branch_id ..................... [[32mPASS[0m in 0.04s]
[0m07:59:31.674730 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.not_null_intermediate__branch_names_branch_id.7edecde87c
[0m07:59:31.675221 [debug] [Thread-1 (]: Began running node test.vg_casestudy.not_null_intermediate__branch_names_branch_name.f5e9aa109d
[0m07:59:31.675760 [info ] [Thread-1 (]: 8 of 42 START test not_null_intermediate__branch_names_branch_name ............. [RUN]
[0m07:59:31.676526 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.not_null_intermediate__branch_names_branch_id.7edecde87c, now test.vg_casestudy.not_null_intermediate__branch_names_branch_name.f5e9aa109d)
[0m07:59:31.676888 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.not_null_intermediate__branch_names_branch_name.f5e9aa109d
[0m07:59:31.681002 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.not_null_intermediate__branch_names_branch_name.f5e9aa109d"
[0m07:59:31.681777 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_intermediate__branch_names_branch_name.f5e9aa109d (compile): 07:59:31.677110 => 07:59:31.681522
[0m07:59:31.682230 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.not_null_intermediate__branch_names_branch_name.f5e9aa109d
[0m07:59:31.685099 [debug] [Thread-1 (]: Writing runtime sql for node "test.vg_casestudy.not_null_intermediate__branch_names_branch_name.f5e9aa109d"
[0m07:59:31.685819 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.not_null_intermediate__branch_names_branch_name.f5e9aa109d"
[0m07:59:31.686200 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_intermediate__branch_names_branch_name.f5e9aa109d: BEGIN
[0m07:59:31.686507 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:59:31.699651 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m07:59:31.700135 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.not_null_intermediate__branch_names_branch_name.f5e9aa109d"
[0m07:59:31.700484 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_intermediate__branch_names_branch_name.f5e9aa109d: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "test.vg_casestudy.not_null_intermediate__branch_names_branch_name.f5e9aa109d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select branch_name
from "casestudy"."intermediate"."intermediate__branch_names"
where branch_name is null



      
    ) dbt_internal_test
[0m07:59:31.701534 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m07:59:31.703044 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_intermediate__branch_names_branch_name.f5e9aa109d (execute): 07:59:31.682492 => 07:59:31.702866
[0m07:59:31.703423 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_intermediate__branch_names_branch_name.f5e9aa109d: ROLLBACK
[0m07:59:31.703869 [debug] [Thread-1 (]: Failed to rollback 'test.vg_casestudy.not_null_intermediate__branch_names_branch_name.f5e9aa109d'
[0m07:59:31.704193 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_intermediate__branch_names_branch_name.f5e9aa109d: Close
[0m07:59:31.706552 [info ] [Thread-1 (]: 8 of 42 PASS not_null_intermediate__branch_names_branch_name ................... [[32mPASS[0m in 0.03s]
[0m07:59:31.707171 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.not_null_intermediate__branch_names_branch_name.f5e9aa109d
[0m07:59:31.707592 [debug] [Thread-1 (]: Began running node test.vg_casestudy.not_null_intermediate__fx_rates_filled_currency_iso_code.1f6a8ce5a9
[0m07:59:31.708126 [info ] [Thread-1 (]: 9 of 42 START test not_null_intermediate__fx_rates_filled_currency_iso_code .... [RUN]
[0m07:59:31.708913 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.not_null_intermediate__branch_names_branch_name.f5e9aa109d, now test.vg_casestudy.not_null_intermediate__fx_rates_filled_currency_iso_code.1f6a8ce5a9)
[0m07:59:31.709282 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.not_null_intermediate__fx_rates_filled_currency_iso_code.1f6a8ce5a9
[0m07:59:31.715627 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.not_null_intermediate__fx_rates_filled_currency_iso_code.1f6a8ce5a9"
[0m07:59:31.716415 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_intermediate__fx_rates_filled_currency_iso_code.1f6a8ce5a9 (compile): 07:59:31.709512 => 07:59:31.716192
[0m07:59:31.716778 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.not_null_intermediate__fx_rates_filled_currency_iso_code.1f6a8ce5a9
[0m07:59:31.719443 [debug] [Thread-1 (]: Writing runtime sql for node "test.vg_casestudy.not_null_intermediate__fx_rates_filled_currency_iso_code.1f6a8ce5a9"
[0m07:59:31.720160 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.not_null_intermediate__fx_rates_filled_currency_iso_code.1f6a8ce5a9"
[0m07:59:31.720545 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_intermediate__fx_rates_filled_currency_iso_code.1f6a8ce5a9: BEGIN
[0m07:59:31.721796 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:59:31.749721 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m07:59:31.750406 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.not_null_intermediate__fx_rates_filled_currency_iso_code.1f6a8ce5a9"
[0m07:59:31.750944 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_intermediate__fx_rates_filled_currency_iso_code.1f6a8ce5a9: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "test.vg_casestudy.not_null_intermediate__fx_rates_filled_currency_iso_code.1f6a8ce5a9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select currency_iso_code
from "casestudy"."intermediate"."intermediate__fx_rates_filled"
where currency_iso_code is null



      
    ) dbt_internal_test
[0m07:59:31.752840 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m07:59:31.758100 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_intermediate__fx_rates_filled_currency_iso_code.1f6a8ce5a9 (execute): 07:59:31.717021 => 07:59:31.754816
[0m07:59:31.759325 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_intermediate__fx_rates_filled_currency_iso_code.1f6a8ce5a9: ROLLBACK
[0m07:59:31.760715 [debug] [Thread-1 (]: Failed to rollback 'test.vg_casestudy.not_null_intermediate__fx_rates_filled_currency_iso_code.1f6a8ce5a9'
[0m07:59:31.761284 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_intermediate__fx_rates_filled_currency_iso_code.1f6a8ce5a9: Close
[0m07:59:31.764246 [info ] [Thread-1 (]: 9 of 42 PASS not_null_intermediate__fx_rates_filled_currency_iso_code .......... [[32mPASS[0m in 0.06s]
[0m07:59:31.764961 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.not_null_intermediate__fx_rates_filled_currency_iso_code.1f6a8ce5a9
[0m07:59:31.765419 [debug] [Thread-1 (]: Began running node test.vg_casestudy.not_null_intermediate__fx_rates_filled_fx_rate.f3c3b417b4
[0m07:59:31.766007 [info ] [Thread-1 (]: 10 of 42 START test not_null_intermediate__fx_rates_filled_fx_rate ............. [RUN]
[0m07:59:31.766873 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.not_null_intermediate__fx_rates_filled_currency_iso_code.1f6a8ce5a9, now test.vg_casestudy.not_null_intermediate__fx_rates_filled_fx_rate.f3c3b417b4)
[0m07:59:31.767294 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.not_null_intermediate__fx_rates_filled_fx_rate.f3c3b417b4
[0m07:59:31.775110 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.not_null_intermediate__fx_rates_filled_fx_rate.f3c3b417b4"
[0m07:59:31.776526 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_intermediate__fx_rates_filled_fx_rate.f3c3b417b4 (compile): 07:59:31.767536 => 07:59:31.776142
[0m07:59:31.777375 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.not_null_intermediate__fx_rates_filled_fx_rate.f3c3b417b4
[0m07:59:31.780669 [debug] [Thread-1 (]: Writing runtime sql for node "test.vg_casestudy.not_null_intermediate__fx_rates_filled_fx_rate.f3c3b417b4"
[0m07:59:31.781454 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.not_null_intermediate__fx_rates_filled_fx_rate.f3c3b417b4"
[0m07:59:31.781988 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_intermediate__fx_rates_filled_fx_rate.f3c3b417b4: BEGIN
[0m07:59:31.782441 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:59:31.796200 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m07:59:31.796865 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.not_null_intermediate__fx_rates_filled_fx_rate.f3c3b417b4"
[0m07:59:31.797358 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_intermediate__fx_rates_filled_fx_rate.f3c3b417b4: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "test.vg_casestudy.not_null_intermediate__fx_rates_filled_fx_rate.f3c3b417b4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select fx_rate
from "casestudy"."intermediate"."intermediate__fx_rates_filled"
where fx_rate is null



      
    ) dbt_internal_test
[0m07:59:31.798768 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m07:59:31.800335 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_intermediate__fx_rates_filled_fx_rate.f3c3b417b4 (execute): 07:59:31.777790 => 07:59:31.800099
[0m07:59:31.800736 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_intermediate__fx_rates_filled_fx_rate.f3c3b417b4: ROLLBACK
[0m07:59:31.801206 [debug] [Thread-1 (]: Failed to rollback 'test.vg_casestudy.not_null_intermediate__fx_rates_filled_fx_rate.f3c3b417b4'
[0m07:59:31.801531 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_intermediate__fx_rates_filled_fx_rate.f3c3b417b4: Close
[0m07:59:31.804213 [info ] [Thread-1 (]: 10 of 42 PASS not_null_intermediate__fx_rates_filled_fx_rate ................... [[32mPASS[0m in 0.04s]
[0m07:59:31.805089 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.not_null_intermediate__fx_rates_filled_fx_rate.f3c3b417b4
[0m07:59:31.805506 [debug] [Thread-1 (]: Began running node test.vg_casestudy.not_null_intermediate__fx_rates_filled_fx_rate_date.c67f41ac31
[0m07:59:31.805856 [info ] [Thread-1 (]: 11 of 42 START test not_null_intermediate__fx_rates_filled_fx_rate_date ........ [RUN]
[0m07:59:31.806595 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.not_null_intermediate__fx_rates_filled_fx_rate.f3c3b417b4, now test.vg_casestudy.not_null_intermediate__fx_rates_filled_fx_rate_date.c67f41ac31)
[0m07:59:31.806932 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.not_null_intermediate__fx_rates_filled_fx_rate_date.c67f41ac31
[0m07:59:31.811344 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.not_null_intermediate__fx_rates_filled_fx_rate_date.c67f41ac31"
[0m07:59:31.812372 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_intermediate__fx_rates_filled_fx_rate_date.c67f41ac31 (compile): 07:59:31.807163 => 07:59:31.812090
[0m07:59:31.812836 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.not_null_intermediate__fx_rates_filled_fx_rate_date.c67f41ac31
[0m07:59:31.815828 [debug] [Thread-1 (]: Writing runtime sql for node "test.vg_casestudy.not_null_intermediate__fx_rates_filled_fx_rate_date.c67f41ac31"
[0m07:59:31.816468 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.not_null_intermediate__fx_rates_filled_fx_rate_date.c67f41ac31"
[0m07:59:31.816830 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_intermediate__fx_rates_filled_fx_rate_date.c67f41ac31: BEGIN
[0m07:59:31.817172 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:59:31.830123 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m07:59:31.830638 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.not_null_intermediate__fx_rates_filled_fx_rate_date.c67f41ac31"
[0m07:59:31.830991 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_intermediate__fx_rates_filled_fx_rate_date.c67f41ac31: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "test.vg_casestudy.not_null_intermediate__fx_rates_filled_fx_rate_date.c67f41ac31"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select fx_rate_date
from "casestudy"."intermediate"."intermediate__fx_rates_filled"
where fx_rate_date is null



      
    ) dbt_internal_test
[0m07:59:31.832219 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m07:59:31.833706 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_intermediate__fx_rates_filled_fx_rate_date.c67f41ac31 (execute): 07:59:31.813136 => 07:59:31.833515
[0m07:59:31.834099 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_intermediate__fx_rates_filled_fx_rate_date.c67f41ac31: ROLLBACK
[0m07:59:31.834548 [debug] [Thread-1 (]: Failed to rollback 'test.vg_casestudy.not_null_intermediate__fx_rates_filled_fx_rate_date.c67f41ac31'
[0m07:59:31.834860 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_intermediate__fx_rates_filled_fx_rate_date.c67f41ac31: Close
[0m07:59:31.837258 [info ] [Thread-1 (]: 11 of 42 PASS not_null_intermediate__fx_rates_filled_fx_rate_date .............. [[32mPASS[0m in 0.03s]
[0m07:59:31.837858 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.not_null_intermediate__fx_rates_filled_fx_rate_date.c67f41ac31
[0m07:59:31.838280 [debug] [Thread-1 (]: Began running node test.vg_casestudy.not_null_stg_staging_intermediate__accounts_account_id.ce9f8bf6f5
[0m07:59:31.838643 [info ] [Thread-1 (]: 12 of 42 START test not_null_stg_staging_intermediate__accounts_account_id ..... [RUN]
[0m07:59:31.839384 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.not_null_intermediate__fx_rates_filled_fx_rate_date.c67f41ac31, now test.vg_casestudy.not_null_stg_staging_intermediate__accounts_account_id.ce9f8bf6f5)
[0m07:59:31.839837 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.not_null_stg_staging_intermediate__accounts_account_id.ce9f8bf6f5
[0m07:59:31.844577 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.not_null_stg_staging_intermediate__accounts_account_id.ce9f8bf6f5"
[0m07:59:31.845424 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_stg_staging_intermediate__accounts_account_id.ce9f8bf6f5 (compile): 07:59:31.840069 => 07:59:31.845150
[0m07:59:31.845844 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.not_null_stg_staging_intermediate__accounts_account_id.ce9f8bf6f5
[0m07:59:31.848532 [debug] [Thread-1 (]: Writing runtime sql for node "test.vg_casestudy.not_null_stg_staging_intermediate__accounts_account_id.ce9f8bf6f5"
[0m07:59:31.849136 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.not_null_stg_staging_intermediate__accounts_account_id.ce9f8bf6f5"
[0m07:59:31.849541 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_stg_staging_intermediate__accounts_account_id.ce9f8bf6f5: BEGIN
[0m07:59:31.849840 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:59:31.861684 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m07:59:31.862348 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.not_null_stg_staging_intermediate__accounts_account_id.ce9f8bf6f5"
[0m07:59:31.862725 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_stg_staging_intermediate__accounts_account_id.ce9f8bf6f5: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "test.vg_casestudy.not_null_stg_staging_intermediate__accounts_account_id.ce9f8bf6f5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select account_id
from "casestudy"."intermediate"."stg_staging_intermediate__accounts"
where account_id is null



      
    ) dbt_internal_test
[0m07:59:31.864257 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m07:59:31.866157 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_stg_staging_intermediate__accounts_account_id.ce9f8bf6f5 (execute): 07:59:31.846086 => 07:59:31.865934
[0m07:59:31.866545 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_stg_staging_intermediate__accounts_account_id.ce9f8bf6f5: ROLLBACK
[0m07:59:31.867019 [debug] [Thread-1 (]: Failed to rollback 'test.vg_casestudy.not_null_stg_staging_intermediate__accounts_account_id.ce9f8bf6f5'
[0m07:59:31.867341 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_stg_staging_intermediate__accounts_account_id.ce9f8bf6f5: Close
[0m07:59:31.869961 [info ] [Thread-1 (]: 12 of 42 PASS not_null_stg_staging_intermediate__accounts_account_id ........... [[32mPASS[0m in 0.03s]
[0m07:59:31.870576 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.not_null_stg_staging_intermediate__accounts_account_id.ce9f8bf6f5
[0m07:59:31.870985 [debug] [Thread-1 (]: Began running node test.vg_casestudy.not_null_stg_staging_intermediate__accounts_account_opening_date.14abf76bb5
[0m07:59:31.871451 [info ] [Thread-1 (]: 13 of 42 START test not_null_stg_staging_intermediate__accounts_account_opening_date  [RUN]
[0m07:59:31.872234 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.not_null_stg_staging_intermediate__accounts_account_id.ce9f8bf6f5, now test.vg_casestudy.not_null_stg_staging_intermediate__accounts_account_opening_date.14abf76bb5)
[0m07:59:31.872572 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.not_null_stg_staging_intermediate__accounts_account_opening_date.14abf76bb5
[0m07:59:31.877606 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.not_null_stg_staging_intermediate__accounts_account_opening_date.14abf76bb5"
[0m07:59:31.878526 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_stg_staging_intermediate__accounts_account_opening_date.14abf76bb5 (compile): 07:59:31.872798 => 07:59:31.878252
[0m07:59:31.878943 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.not_null_stg_staging_intermediate__accounts_account_opening_date.14abf76bb5
[0m07:59:31.883147 [debug] [Thread-1 (]: Writing runtime sql for node "test.vg_casestudy.not_null_stg_staging_intermediate__accounts_account_opening_date.14abf76bb5"
[0m07:59:31.883824 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.not_null_stg_staging_intermediate__accounts_account_opening_date.14abf76bb5"
[0m07:59:31.884191 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_stg_staging_intermediate__accounts_account_opening_date.14abf76bb5: BEGIN
[0m07:59:31.884495 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:59:31.897032 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m07:59:31.897606 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.not_null_stg_staging_intermediate__accounts_account_opening_date.14abf76bb5"
[0m07:59:31.898018 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_stg_staging_intermediate__accounts_account_opening_date.14abf76bb5: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "test.vg_casestudy.not_null_stg_staging_intermediate__accounts_account_opening_date.14abf76bb5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select account_opening_date
from "casestudy"."intermediate"."stg_staging_intermediate__accounts"
where account_opening_date is null



      
    ) dbt_internal_test
[0m07:59:31.899246 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m07:59:31.900698 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_stg_staging_intermediate__accounts_account_opening_date.14abf76bb5 (execute): 07:59:31.879228 => 07:59:31.900513
[0m07:59:31.901083 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_stg_staging_intermediate__accounts_account_opening_date.14abf76bb5: ROLLBACK
[0m07:59:31.901527 [debug] [Thread-1 (]: Failed to rollback 'test.vg_casestudy.not_null_stg_staging_intermediate__accounts_account_opening_date.14abf76bb5'
[0m07:59:31.901941 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_stg_staging_intermediate__accounts_account_opening_date.14abf76bb5: Close
[0m07:59:31.904305 [info ] [Thread-1 (]: 13 of 42 PASS not_null_stg_staging_intermediate__accounts_account_opening_date . [[32mPASS[0m in 0.03s]
[0m07:59:31.904893 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.not_null_stg_staging_intermediate__accounts_account_opening_date.14abf76bb5
[0m07:59:31.905300 [debug] [Thread-1 (]: Began running node test.vg_casestudy.not_null_stg_staging_intermediate__accounts_customer_id.2a8ddb333d
[0m07:59:31.905646 [info ] [Thread-1 (]: 14 of 42 START test not_null_stg_staging_intermediate__accounts_customer_id .... [RUN]
[0m07:59:31.906382 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.not_null_stg_staging_intermediate__accounts_account_opening_date.14abf76bb5, now test.vg_casestudy.not_null_stg_staging_intermediate__accounts_customer_id.2a8ddb333d)
[0m07:59:31.906825 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.not_null_stg_staging_intermediate__accounts_customer_id.2a8ddb333d
[0m07:59:31.911505 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.not_null_stg_staging_intermediate__accounts_customer_id.2a8ddb333d"
[0m07:59:31.912310 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_stg_staging_intermediate__accounts_customer_id.2a8ddb333d (compile): 07:59:31.907045 => 07:59:31.912084
[0m07:59:31.912748 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.not_null_stg_staging_intermediate__accounts_customer_id.2a8ddb333d
[0m07:59:31.915611 [debug] [Thread-1 (]: Writing runtime sql for node "test.vg_casestudy.not_null_stg_staging_intermediate__accounts_customer_id.2a8ddb333d"
[0m07:59:31.916265 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.not_null_stg_staging_intermediate__accounts_customer_id.2a8ddb333d"
[0m07:59:31.916633 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_stg_staging_intermediate__accounts_customer_id.2a8ddb333d: BEGIN
[0m07:59:31.916943 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:59:31.929765 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m07:59:31.930290 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.not_null_stg_staging_intermediate__accounts_customer_id.2a8ddb333d"
[0m07:59:31.930714 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_stg_staging_intermediate__accounts_customer_id.2a8ddb333d: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "test.vg_casestudy.not_null_stg_staging_intermediate__accounts_customer_id.2a8ddb333d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from "casestudy"."intermediate"."stg_staging_intermediate__accounts"
where customer_id is null



      
    ) dbt_internal_test
[0m07:59:31.932311 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m07:59:31.933803 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_stg_staging_intermediate__accounts_customer_id.2a8ddb333d (execute): 07:59:31.913025 => 07:59:31.933605
[0m07:59:31.934201 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_stg_staging_intermediate__accounts_customer_id.2a8ddb333d: ROLLBACK
[0m07:59:31.934661 [debug] [Thread-1 (]: Failed to rollback 'test.vg_casestudy.not_null_stg_staging_intermediate__accounts_customer_id.2a8ddb333d'
[0m07:59:31.934981 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_stg_staging_intermediate__accounts_customer_id.2a8ddb333d: Close
[0m07:59:31.937424 [info ] [Thread-1 (]: 14 of 42 PASS not_null_stg_staging_intermediate__accounts_customer_id .......... [[32mPASS[0m in 0.03s]
[0m07:59:31.938083 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.not_null_stg_staging_intermediate__accounts_customer_id.2a8ddb333d
[0m07:59:31.938506 [debug] [Thread-1 (]: Began running node test.vg_casestudy.not_null_stg_staging_intermediate__currencies_currency_iso_code.f7ebb4618b
[0m07:59:31.938951 [info ] [Thread-1 (]: 15 of 42 START test not_null_stg_staging_intermediate__currencies_currency_iso_code  [RUN]
[0m07:59:31.939621 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.not_null_stg_staging_intermediate__accounts_customer_id.2a8ddb333d, now test.vg_casestudy.not_null_stg_staging_intermediate__currencies_currency_iso_code.f7ebb4618b)
[0m07:59:31.939962 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.not_null_stg_staging_intermediate__currencies_currency_iso_code.f7ebb4618b
[0m07:59:31.944373 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.not_null_stg_staging_intermediate__currencies_currency_iso_code.f7ebb4618b"
[0m07:59:31.945078 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_stg_staging_intermediate__currencies_currency_iso_code.f7ebb4618b (compile): 07:59:31.940195 => 07:59:31.944866
[0m07:59:31.945456 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.not_null_stg_staging_intermediate__currencies_currency_iso_code.f7ebb4618b
[0m07:59:31.948442 [debug] [Thread-1 (]: Writing runtime sql for node "test.vg_casestudy.not_null_stg_staging_intermediate__currencies_currency_iso_code.f7ebb4618b"
[0m07:59:31.949102 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.not_null_stg_staging_intermediate__currencies_currency_iso_code.f7ebb4618b"
[0m07:59:31.949496 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_stg_staging_intermediate__currencies_currency_iso_code.f7ebb4618b: BEGIN
[0m07:59:31.949913 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:59:31.962486 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m07:59:31.963063 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.not_null_stg_staging_intermediate__currencies_currency_iso_code.f7ebb4618b"
[0m07:59:31.963647 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_stg_staging_intermediate__currencies_currency_iso_code.f7ebb4618b: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "test.vg_casestudy.not_null_stg_staging_intermediate__currencies_currency_iso_code.f7ebb4618b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select currency_iso_code
from "casestudy"."intermediate"."stg_staging_intermediate__currencies"
where currency_iso_code is null



      
    ) dbt_internal_test
[0m07:59:31.965424 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m07:59:31.967001 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_stg_staging_intermediate__currencies_currency_iso_code.f7ebb4618b (execute): 07:59:31.945756 => 07:59:31.966764
[0m07:59:31.967379 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_stg_staging_intermediate__currencies_currency_iso_code.f7ebb4618b: ROLLBACK
[0m07:59:31.967841 [debug] [Thread-1 (]: Failed to rollback 'test.vg_casestudy.not_null_stg_staging_intermediate__currencies_currency_iso_code.f7ebb4618b'
[0m07:59:31.968170 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_stg_staging_intermediate__currencies_currency_iso_code.f7ebb4618b: Close
[0m07:59:31.970751 [info ] [Thread-1 (]: 15 of 42 PASS not_null_stg_staging_intermediate__currencies_currency_iso_code .. [[32mPASS[0m in 0.03s]
[0m07:59:31.971364 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.not_null_stg_staging_intermediate__currencies_currency_iso_code.f7ebb4618b
[0m07:59:31.971813 [debug] [Thread-1 (]: Began running node test.vg_casestudy.not_null_stg_staging_intermediate__customers_branch_id.de895a293b
[0m07:59:31.972173 [info ] [Thread-1 (]: 16 of 42 START test not_null_stg_staging_intermediate__customers_branch_id ..... [RUN]
[0m07:59:31.972884 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.not_null_stg_staging_intermediate__currencies_currency_iso_code.f7ebb4618b, now test.vg_casestudy.not_null_stg_staging_intermediate__customers_branch_id.de895a293b)
[0m07:59:31.973331 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.not_null_stg_staging_intermediate__customers_branch_id.de895a293b
[0m07:59:31.978396 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.not_null_stg_staging_intermediate__customers_branch_id.de895a293b"
[0m07:59:31.979172 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_stg_staging_intermediate__customers_branch_id.de895a293b (compile): 07:59:31.973574 => 07:59:31.978900
[0m07:59:31.979648 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.not_null_stg_staging_intermediate__customers_branch_id.de895a293b
[0m07:59:31.982430 [debug] [Thread-1 (]: Writing runtime sql for node "test.vg_casestudy.not_null_stg_staging_intermediate__customers_branch_id.de895a293b"
[0m07:59:31.983126 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.not_null_stg_staging_intermediate__customers_branch_id.de895a293b"
[0m07:59:31.983487 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_stg_staging_intermediate__customers_branch_id.de895a293b: BEGIN
[0m07:59:31.983787 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:59:31.995879 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m07:59:31.996527 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.not_null_stg_staging_intermediate__customers_branch_id.de895a293b"
[0m07:59:31.996963 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_stg_staging_intermediate__customers_branch_id.de895a293b: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "test.vg_casestudy.not_null_stg_staging_intermediate__customers_branch_id.de895a293b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select branch_id
from "casestudy"."intermediate"."stg_staging_intermediate__customers"
where branch_id is null



      
    ) dbt_internal_test
[0m07:59:31.998587 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m07:59:32.000187 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_stg_staging_intermediate__customers_branch_id.de895a293b (execute): 07:59:31.979935 => 07:59:31.999967
[0m07:59:32.000558 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_stg_staging_intermediate__customers_branch_id.de895a293b: ROLLBACK
[0m07:59:32.001013 [debug] [Thread-1 (]: Failed to rollback 'test.vg_casestudy.not_null_stg_staging_intermediate__customers_branch_id.de895a293b'
[0m07:59:32.001338 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_stg_staging_intermediate__customers_branch_id.de895a293b: Close
[0m07:59:32.003815 [info ] [Thread-1 (]: 16 of 42 PASS not_null_stg_staging_intermediate__customers_branch_id ........... [[32mPASS[0m in 0.03s]
[0m07:59:32.004405 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.not_null_stg_staging_intermediate__customers_branch_id.de895a293b
[0m07:59:32.004807 [debug] [Thread-1 (]: Began running node test.vg_casestudy.not_null_stg_staging_intermediate__customers_customer_id.10f4ae76d7
[0m07:59:32.005305 [info ] [Thread-1 (]: 17 of 42 START test not_null_stg_staging_intermediate__customers_customer_id ... [RUN]
[0m07:59:32.006006 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.not_null_stg_staging_intermediate__customers_branch_id.de895a293b, now test.vg_casestudy.not_null_stg_staging_intermediate__customers_customer_id.10f4ae76d7)
[0m07:59:32.006348 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.not_null_stg_staging_intermediate__customers_customer_id.10f4ae76d7
[0m07:59:32.011121 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.not_null_stg_staging_intermediate__customers_customer_id.10f4ae76d7"
[0m07:59:32.011930 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_stg_staging_intermediate__customers_customer_id.10f4ae76d7 (compile): 07:59:32.006704 => 07:59:32.011638
[0m07:59:32.012312 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.not_null_stg_staging_intermediate__customers_customer_id.10f4ae76d7
[0m07:59:32.015132 [debug] [Thread-1 (]: Writing runtime sql for node "test.vg_casestudy.not_null_stg_staging_intermediate__customers_customer_id.10f4ae76d7"
[0m07:59:32.015816 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.not_null_stg_staging_intermediate__customers_customer_id.10f4ae76d7"
[0m07:59:32.016163 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_stg_staging_intermediate__customers_customer_id.10f4ae76d7: BEGIN
[0m07:59:32.016485 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:59:32.029193 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m07:59:32.029795 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.not_null_stg_staging_intermediate__customers_customer_id.10f4ae76d7"
[0m07:59:32.030202 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_stg_staging_intermediate__customers_customer_id.10f4ae76d7: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "test.vg_casestudy.not_null_stg_staging_intermediate__customers_customer_id.10f4ae76d7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from "casestudy"."intermediate"."stg_staging_intermediate__customers"
where customer_id is null



      
    ) dbt_internal_test
[0m07:59:32.031847 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m07:59:32.033475 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_stg_staging_intermediate__customers_customer_id.10f4ae76d7 (execute): 07:59:32.012628 => 07:59:32.033233
[0m07:59:32.033863 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_stg_staging_intermediate__customers_customer_id.10f4ae76d7: ROLLBACK
[0m07:59:32.034322 [debug] [Thread-1 (]: Failed to rollback 'test.vg_casestudy.not_null_stg_staging_intermediate__customers_customer_id.10f4ae76d7'
[0m07:59:32.034644 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_stg_staging_intermediate__customers_customer_id.10f4ae76d7: Close
[0m07:59:32.037205 [info ] [Thread-1 (]: 17 of 42 PASS not_null_stg_staging_intermediate__customers_customer_id ......... [[32mPASS[0m in 0.03s]
[0m07:59:32.037811 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.not_null_stg_staging_intermediate__customers_customer_id.10f4ae76d7
[0m07:59:32.038215 [debug] [Thread-1 (]: Began running node test.vg_casestudy.not_null_stg_staging_intermediate__fx_rates_currency_iso_code.95d2907ece
[0m07:59:32.038568 [info ] [Thread-1 (]: 18 of 42 START test not_null_stg_staging_intermediate__fx_rates_currency_iso_code  [RUN]
[0m07:59:32.039270 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.not_null_stg_staging_intermediate__customers_customer_id.10f4ae76d7, now test.vg_casestudy.not_null_stg_staging_intermediate__fx_rates_currency_iso_code.95d2907ece)
[0m07:59:32.039769 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.not_null_stg_staging_intermediate__fx_rates_currency_iso_code.95d2907ece
[0m07:59:32.046781 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.not_null_stg_staging_intermediate__fx_rates_currency_iso_code.95d2907ece"
[0m07:59:32.047560 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_stg_staging_intermediate__fx_rates_currency_iso_code.95d2907ece (compile): 07:59:32.040039 => 07:59:32.047289
[0m07:59:32.047932 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.not_null_stg_staging_intermediate__fx_rates_currency_iso_code.95d2907ece
[0m07:59:32.050451 [debug] [Thread-1 (]: Writing runtime sql for node "test.vg_casestudy.not_null_stg_staging_intermediate__fx_rates_currency_iso_code.95d2907ece"
[0m07:59:32.050943 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.not_null_stg_staging_intermediate__fx_rates_currency_iso_code.95d2907ece"
[0m07:59:32.051263 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_stg_staging_intermediate__fx_rates_currency_iso_code.95d2907ece: BEGIN
[0m07:59:32.051568 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:59:32.064204 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m07:59:32.064889 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.not_null_stg_staging_intermediate__fx_rates_currency_iso_code.95d2907ece"
[0m07:59:32.065433 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_stg_staging_intermediate__fx_rates_currency_iso_code.95d2907ece: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "test.vg_casestudy.not_null_stg_staging_intermediate__fx_rates_currency_iso_code.95d2907ece"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select currency_iso_code
from "casestudy"."intermediate"."stg_staging_intermediate__fx_rates"
where currency_iso_code is null



      
    ) dbt_internal_test
[0m07:59:32.067234 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m07:59:32.069019 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_stg_staging_intermediate__fx_rates_currency_iso_code.95d2907ece (execute): 07:59:32.048157 => 07:59:32.068807
[0m07:59:32.069429 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_stg_staging_intermediate__fx_rates_currency_iso_code.95d2907ece: ROLLBACK
[0m07:59:32.069891 [debug] [Thread-1 (]: Failed to rollback 'test.vg_casestudy.not_null_stg_staging_intermediate__fx_rates_currency_iso_code.95d2907ece'
[0m07:59:32.070230 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_stg_staging_intermediate__fx_rates_currency_iso_code.95d2907ece: Close
[0m07:59:32.073111 [info ] [Thread-1 (]: 18 of 42 PASS not_null_stg_staging_intermediate__fx_rates_currency_iso_code .... [[32mPASS[0m in 0.03s]
[0m07:59:32.073806 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.not_null_stg_staging_intermediate__fx_rates_currency_iso_code.95d2907ece
[0m07:59:32.074237 [debug] [Thread-1 (]: Began running node test.vg_casestudy.not_null_stg_staging_intermediate__fx_rates_fx_rate.bec8509027
[0m07:59:32.074707 [info ] [Thread-1 (]: 19 of 42 START test not_null_stg_staging_intermediate__fx_rates_fx_rate ........ [RUN]
[0m07:59:32.075490 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.not_null_stg_staging_intermediate__fx_rates_currency_iso_code.95d2907ece, now test.vg_casestudy.not_null_stg_staging_intermediate__fx_rates_fx_rate.bec8509027)
[0m07:59:32.075879 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.not_null_stg_staging_intermediate__fx_rates_fx_rate.bec8509027
[0m07:59:32.080837 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.not_null_stg_staging_intermediate__fx_rates_fx_rate.bec8509027"
[0m07:59:32.081777 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_stg_staging_intermediate__fx_rates_fx_rate.bec8509027 (compile): 07:59:32.076135 => 07:59:32.081450
[0m07:59:32.082189 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.not_null_stg_staging_intermediate__fx_rates_fx_rate.bec8509027
[0m07:59:32.084931 [debug] [Thread-1 (]: Writing runtime sql for node "test.vg_casestudy.not_null_stg_staging_intermediate__fx_rates_fx_rate.bec8509027"
[0m07:59:32.085555 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.not_null_stg_staging_intermediate__fx_rates_fx_rate.bec8509027"
[0m07:59:32.085903 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_stg_staging_intermediate__fx_rates_fx_rate.bec8509027: BEGIN
[0m07:59:32.086213 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:59:32.099156 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m07:59:32.099650 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.not_null_stg_staging_intermediate__fx_rates_fx_rate.bec8509027"
[0m07:59:32.100000 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_stg_staging_intermediate__fx_rates_fx_rate.bec8509027: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "test.vg_casestudy.not_null_stg_staging_intermediate__fx_rates_fx_rate.bec8509027"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select fx_rate
from "casestudy"."intermediate"."stg_staging_intermediate__fx_rates"
where fx_rate is null



      
    ) dbt_internal_test
[0m07:59:32.101286 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m07:59:32.102979 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_stg_staging_intermediate__fx_rates_fx_rate.bec8509027 (execute): 07:59:32.082464 => 07:59:32.102760
[0m07:59:32.103349 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_stg_staging_intermediate__fx_rates_fx_rate.bec8509027: ROLLBACK
[0m07:59:32.103799 [debug] [Thread-1 (]: Failed to rollback 'test.vg_casestudy.not_null_stg_staging_intermediate__fx_rates_fx_rate.bec8509027'
[0m07:59:32.104144 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_stg_staging_intermediate__fx_rates_fx_rate.bec8509027: Close
[0m07:59:32.106547 [info ] [Thread-1 (]: 19 of 42 PASS not_null_stg_staging_intermediate__fx_rates_fx_rate .............. [[32mPASS[0m in 0.03s]
[0m07:59:32.107145 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.not_null_stg_staging_intermediate__fx_rates_fx_rate.bec8509027
[0m07:59:32.107568 [debug] [Thread-1 (]: Began running node test.vg_casestudy.not_null_stg_staging_intermediate__fx_rates_fx_rate_date.0f5280bc57
[0m07:59:32.107916 [info ] [Thread-1 (]: 20 of 42 START test not_null_stg_staging_intermediate__fx_rates_fx_rate_date ... [RUN]
[0m07:59:32.108669 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.not_null_stg_staging_intermediate__fx_rates_fx_rate.bec8509027, now test.vg_casestudy.not_null_stg_staging_intermediate__fx_rates_fx_rate_date.0f5280bc57)
[0m07:59:32.109410 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.not_null_stg_staging_intermediate__fx_rates_fx_rate_date.0f5280bc57
[0m07:59:32.114355 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.not_null_stg_staging_intermediate__fx_rates_fx_rate_date.0f5280bc57"
[0m07:59:32.115203 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_stg_staging_intermediate__fx_rates_fx_rate_date.0f5280bc57 (compile): 07:59:32.109784 => 07:59:32.114925
[0m07:59:32.115679 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.not_null_stg_staging_intermediate__fx_rates_fx_rate_date.0f5280bc57
[0m07:59:32.118488 [debug] [Thread-1 (]: Writing runtime sql for node "test.vg_casestudy.not_null_stg_staging_intermediate__fx_rates_fx_rate_date.0f5280bc57"
[0m07:59:32.119162 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.not_null_stg_staging_intermediate__fx_rates_fx_rate_date.0f5280bc57"
[0m07:59:32.119553 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_stg_staging_intermediate__fx_rates_fx_rate_date.0f5280bc57: BEGIN
[0m07:59:32.119888 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:59:32.133345 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m07:59:32.134182 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.not_null_stg_staging_intermediate__fx_rates_fx_rate_date.0f5280bc57"
[0m07:59:32.134822 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_stg_staging_intermediate__fx_rates_fx_rate_date.0f5280bc57: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "test.vg_casestudy.not_null_stg_staging_intermediate__fx_rates_fx_rate_date.0f5280bc57"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select fx_rate_date
from "casestudy"."intermediate"."stg_staging_intermediate__fx_rates"
where fx_rate_date is null



      
    ) dbt_internal_test
[0m07:59:32.136307 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m07:59:32.137956 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_stg_staging_intermediate__fx_rates_fx_rate_date.0f5280bc57 (execute): 07:59:32.115959 => 07:59:32.137767
[0m07:59:32.138361 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_stg_staging_intermediate__fx_rates_fx_rate_date.0f5280bc57: ROLLBACK
[0m07:59:32.138837 [debug] [Thread-1 (]: Failed to rollback 'test.vg_casestudy.not_null_stg_staging_intermediate__fx_rates_fx_rate_date.0f5280bc57'
[0m07:59:32.139200 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_stg_staging_intermediate__fx_rates_fx_rate_date.0f5280bc57: Close
[0m07:59:32.141939 [info ] [Thread-1 (]: 20 of 42 PASS not_null_stg_staging_intermediate__fx_rates_fx_rate_date ......... [[32mPASS[0m in 0.03s]
[0m07:59:32.142698 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.not_null_stg_staging_intermediate__fx_rates_fx_rate_date.0f5280bc57
[0m07:59:32.143284 [debug] [Thread-1 (]: Began running node test.vg_casestudy.not_null_stg_staging_intermediate__loans_approval_rejection_date.28f5951b2f
[0m07:59:32.144013 [info ] [Thread-1 (]: 21 of 42 START test not_null_stg_staging_intermediate__loans_approval_rejection_date  [RUN]
[0m07:59:32.144865 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.not_null_stg_staging_intermediate__fx_rates_fx_rate_date.0f5280bc57, now test.vg_casestudy.not_null_stg_staging_intermediate__loans_approval_rejection_date.28f5951b2f)
[0m07:59:32.145248 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.not_null_stg_staging_intermediate__loans_approval_rejection_date.28f5951b2f
[0m07:59:32.149806 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.not_null_stg_staging_intermediate__loans_approval_rejection_date.28f5951b2f"
[0m07:59:32.150682 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_stg_staging_intermediate__loans_approval_rejection_date.28f5951b2f (compile): 07:59:32.145483 => 07:59:32.150424
[0m07:59:32.151137 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.not_null_stg_staging_intermediate__loans_approval_rejection_date.28f5951b2f
[0m07:59:32.154072 [debug] [Thread-1 (]: Writing runtime sql for node "test.vg_casestudy.not_null_stg_staging_intermediate__loans_approval_rejection_date.28f5951b2f"
[0m07:59:32.154789 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.not_null_stg_staging_intermediate__loans_approval_rejection_date.28f5951b2f"
[0m07:59:32.155201 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_stg_staging_intermediate__loans_approval_rejection_date.28f5951b2f: BEGIN
[0m07:59:32.155513 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:59:32.170097 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m07:59:32.170596 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.not_null_stg_staging_intermediate__loans_approval_rejection_date.28f5951b2f"
[0m07:59:32.170985 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_stg_staging_intermediate__loans_approval_rejection_date.28f5951b2f: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "test.vg_casestudy.not_null_stg_staging_intermediate__loans_approval_rejection_date.28f5951b2f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select approval_rejection_date
from "casestudy"."intermediate"."stg_staging_intermediate__loans"
where approval_rejection_date is null



      
    ) dbt_internal_test
[0m07:59:32.172368 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m07:59:32.173860 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_stg_staging_intermediate__loans_approval_rejection_date.28f5951b2f (execute): 07:59:32.151432 => 07:59:32.173654
[0m07:59:32.174281 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_stg_staging_intermediate__loans_approval_rejection_date.28f5951b2f: ROLLBACK
[0m07:59:32.174740 [debug] [Thread-1 (]: Failed to rollback 'test.vg_casestudy.not_null_stg_staging_intermediate__loans_approval_rejection_date.28f5951b2f'
[0m07:59:32.175046 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_stg_staging_intermediate__loans_approval_rejection_date.28f5951b2f: Close
[0m07:59:32.178322 [info ] [Thread-1 (]: 21 of 42 PASS not_null_stg_staging_intermediate__loans_approval_rejection_date . [[32mPASS[0m in 0.03s]
[0m07:59:32.179039 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.not_null_stg_staging_intermediate__loans_approval_rejection_date.28f5951b2f
[0m07:59:32.179462 [debug] [Thread-1 (]: Began running node test.vg_casestudy.not_null_stg_staging_intermediate__loans_interest_rate.290100bb78
[0m07:59:32.180020 [info ] [Thread-1 (]: 22 of 42 START test not_null_stg_staging_intermediate__loans_interest_rate ..... [RUN]
[0m07:59:32.180759 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.not_null_stg_staging_intermediate__loans_approval_rejection_date.28f5951b2f, now test.vg_casestudy.not_null_stg_staging_intermediate__loans_interest_rate.290100bb78)
[0m07:59:32.181101 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.not_null_stg_staging_intermediate__loans_interest_rate.290100bb78
[0m07:59:32.185094 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.not_null_stg_staging_intermediate__loans_interest_rate.290100bb78"
[0m07:59:32.185729 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_stg_staging_intermediate__loans_interest_rate.290100bb78 (compile): 07:59:32.181316 => 07:59:32.185498
[0m07:59:32.186104 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.not_null_stg_staging_intermediate__loans_interest_rate.290100bb78
[0m07:59:32.189126 [debug] [Thread-1 (]: Writing runtime sql for node "test.vg_casestudy.not_null_stg_staging_intermediate__loans_interest_rate.290100bb78"
[0m07:59:32.189838 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.not_null_stg_staging_intermediate__loans_interest_rate.290100bb78"
[0m07:59:32.190210 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_stg_staging_intermediate__loans_interest_rate.290100bb78: BEGIN
[0m07:59:32.190516 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:59:32.203438 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m07:59:32.203926 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.not_null_stg_staging_intermediate__loans_interest_rate.290100bb78"
[0m07:59:32.204277 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_stg_staging_intermediate__loans_interest_rate.290100bb78: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "test.vg_casestudy.not_null_stg_staging_intermediate__loans_interest_rate.290100bb78"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select interest_rate
from "casestudy"."intermediate"."stg_staging_intermediate__loans"
where interest_rate is null



      
    ) dbt_internal_test
[0m07:59:32.205470 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m07:59:32.206906 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_stg_staging_intermediate__loans_interest_rate.290100bb78 (execute): 07:59:32.186344 => 07:59:32.206725
[0m07:59:32.207340 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_stg_staging_intermediate__loans_interest_rate.290100bb78: ROLLBACK
[0m07:59:32.207847 [debug] [Thread-1 (]: Failed to rollback 'test.vg_casestudy.not_null_stg_staging_intermediate__loans_interest_rate.290100bb78'
[0m07:59:32.208166 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_stg_staging_intermediate__loans_interest_rate.290100bb78: Close
[0m07:59:32.211154 [info ] [Thread-1 (]: 22 of 42 PASS not_null_stg_staging_intermediate__loans_interest_rate ........... [[32mPASS[0m in 0.03s]
[0m07:59:32.211949 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.not_null_stg_staging_intermediate__loans_interest_rate.290100bb78
[0m07:59:32.212401 [debug] [Thread-1 (]: Began running node test.vg_casestudy.not_null_stg_staging_intermediate__loans_loan_amount.3aa0f79ca3
[0m07:59:32.212746 [info ] [Thread-1 (]: 23 of 42 START test not_null_stg_staging_intermediate__loans_loan_amount ....... [RUN]
[0m07:59:32.213533 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.not_null_stg_staging_intermediate__loans_interest_rate.290100bb78, now test.vg_casestudy.not_null_stg_staging_intermediate__loans_loan_amount.3aa0f79ca3)
[0m07:59:32.213862 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.not_null_stg_staging_intermediate__loans_loan_amount.3aa0f79ca3
[0m07:59:32.219600 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.not_null_stg_staging_intermediate__loans_loan_amount.3aa0f79ca3"
[0m07:59:32.220543 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_stg_staging_intermediate__loans_loan_amount.3aa0f79ca3 (compile): 07:59:32.214073 => 07:59:32.220210
[0m07:59:32.221059 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.not_null_stg_staging_intermediate__loans_loan_amount.3aa0f79ca3
[0m07:59:32.224003 [debug] [Thread-1 (]: Writing runtime sql for node "test.vg_casestudy.not_null_stg_staging_intermediate__loans_loan_amount.3aa0f79ca3"
[0m07:59:32.224709 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.not_null_stg_staging_intermediate__loans_loan_amount.3aa0f79ca3"
[0m07:59:32.225071 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_stg_staging_intermediate__loans_loan_amount.3aa0f79ca3: BEGIN
[0m07:59:32.225401 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:59:32.238014 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m07:59:32.238511 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.not_null_stg_staging_intermediate__loans_loan_amount.3aa0f79ca3"
[0m07:59:32.238877 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_stg_staging_intermediate__loans_loan_amount.3aa0f79ca3: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "test.vg_casestudy.not_null_stg_staging_intermediate__loans_loan_amount.3aa0f79ca3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select loan_amount
from "casestudy"."intermediate"."stg_staging_intermediate__loans"
where loan_amount is null



      
    ) dbt_internal_test
[0m07:59:32.240070 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m07:59:32.241518 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_stg_staging_intermediate__loans_loan_amount.3aa0f79ca3 (execute): 07:59:32.221317 => 07:59:32.241337
[0m07:59:32.241942 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_stg_staging_intermediate__loans_loan_amount.3aa0f79ca3: ROLLBACK
[0m07:59:32.242418 [debug] [Thread-1 (]: Failed to rollback 'test.vg_casestudy.not_null_stg_staging_intermediate__loans_loan_amount.3aa0f79ca3'
[0m07:59:32.242797 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_stg_staging_intermediate__loans_loan_amount.3aa0f79ca3: Close
[0m07:59:32.245671 [info ] [Thread-1 (]: 23 of 42 PASS not_null_stg_staging_intermediate__loans_loan_amount ............. [[32mPASS[0m in 0.03s]
[0m07:59:32.246336 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.not_null_stg_staging_intermediate__loans_loan_amount.3aa0f79ca3
[0m07:59:32.246751 [debug] [Thread-1 (]: Began running node test.vg_casestudy.not_null_stg_staging_intermediate__loans_loan_id.bbf464e57e
[0m07:59:32.247270 [info ] [Thread-1 (]: 24 of 42 START test not_null_stg_staging_intermediate__loans_loan_id ........... [RUN]
[0m07:59:32.247992 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.not_null_stg_staging_intermediate__loans_loan_amount.3aa0f79ca3, now test.vg_casestudy.not_null_stg_staging_intermediate__loans_loan_id.bbf464e57e)
[0m07:59:32.248324 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.not_null_stg_staging_intermediate__loans_loan_id.bbf464e57e
[0m07:59:32.252519 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.not_null_stg_staging_intermediate__loans_loan_id.bbf464e57e"
[0m07:59:32.253179 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_stg_staging_intermediate__loans_loan_id.bbf464e57e (compile): 07:59:32.248543 => 07:59:32.252988
[0m07:59:32.253555 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.not_null_stg_staging_intermediate__loans_loan_id.bbf464e57e
[0m07:59:32.256598 [debug] [Thread-1 (]: Writing runtime sql for node "test.vg_casestudy.not_null_stg_staging_intermediate__loans_loan_id.bbf464e57e"
[0m07:59:32.257315 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.not_null_stg_staging_intermediate__loans_loan_id.bbf464e57e"
[0m07:59:32.257673 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_stg_staging_intermediate__loans_loan_id.bbf464e57e: BEGIN
[0m07:59:32.258009 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:59:32.271726 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m07:59:32.272224 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.not_null_stg_staging_intermediate__loans_loan_id.bbf464e57e"
[0m07:59:32.272567 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_stg_staging_intermediate__loans_loan_id.bbf464e57e: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "test.vg_casestudy.not_null_stg_staging_intermediate__loans_loan_id.bbf464e57e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select loan_id
from "casestudy"."intermediate"."stg_staging_intermediate__loans"
where loan_id is null



      
    ) dbt_internal_test
[0m07:59:32.273739 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m07:59:32.275153 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_stg_staging_intermediate__loans_loan_id.bbf464e57e (execute): 07:59:32.253819 => 07:59:32.274963
[0m07:59:32.275543 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_stg_staging_intermediate__loans_loan_id.bbf464e57e: ROLLBACK
[0m07:59:32.276035 [debug] [Thread-1 (]: Failed to rollback 'test.vg_casestudy.not_null_stg_staging_intermediate__loans_loan_id.bbf464e57e'
[0m07:59:32.276491 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_stg_staging_intermediate__loans_loan_id.bbf464e57e: Close
[0m07:59:32.279475 [info ] [Thread-1 (]: 24 of 42 PASS not_null_stg_staging_intermediate__loans_loan_id ................. [[32mPASS[0m in 0.03s]
[0m07:59:32.280118 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.not_null_stg_staging_intermediate__loans_loan_id.bbf464e57e
[0m07:59:32.280527 [debug] [Thread-1 (]: Began running node test.vg_casestudy.not_null_stg_staging_intermediate__loans_loan_status.6519e56cae
[0m07:59:32.280877 [info ] [Thread-1 (]: 25 of 42 START test not_null_stg_staging_intermediate__loans_loan_status ....... [RUN]
[0m07:59:32.281767 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.not_null_stg_staging_intermediate__loans_loan_id.bbf464e57e, now test.vg_casestudy.not_null_stg_staging_intermediate__loans_loan_status.6519e56cae)
[0m07:59:32.282122 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.not_null_stg_staging_intermediate__loans_loan_status.6519e56cae
[0m07:59:32.286439 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.not_null_stg_staging_intermediate__loans_loan_status.6519e56cae"
[0m07:59:32.287107 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_stg_staging_intermediate__loans_loan_status.6519e56cae (compile): 07:59:32.282353 => 07:59:32.286895
[0m07:59:32.287491 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.not_null_stg_staging_intermediate__loans_loan_status.6519e56cae
[0m07:59:32.290244 [debug] [Thread-1 (]: Writing runtime sql for node "test.vg_casestudy.not_null_stg_staging_intermediate__loans_loan_status.6519e56cae"
[0m07:59:32.290959 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.not_null_stg_staging_intermediate__loans_loan_status.6519e56cae"
[0m07:59:32.291313 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_stg_staging_intermediate__loans_loan_status.6519e56cae: BEGIN
[0m07:59:32.291619 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:59:32.304633 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m07:59:32.305111 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.not_null_stg_staging_intermediate__loans_loan_status.6519e56cae"
[0m07:59:32.305453 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_stg_staging_intermediate__loans_loan_status.6519e56cae: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "test.vg_casestudy.not_null_stg_staging_intermediate__loans_loan_status.6519e56cae"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select loan_status
from "casestudy"."intermediate"."stg_staging_intermediate__loans"
where loan_status is null



      
    ) dbt_internal_test
[0m07:59:32.306734 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m07:59:32.308346 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_stg_staging_intermediate__loans_loan_status.6519e56cae (execute): 07:59:32.287722 => 07:59:32.308123
[0m07:59:32.308899 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_stg_staging_intermediate__loans_loan_status.6519e56cae: ROLLBACK
[0m07:59:32.309521 [debug] [Thread-1 (]: Failed to rollback 'test.vg_casestudy.not_null_stg_staging_intermediate__loans_loan_status.6519e56cae'
[0m07:59:32.310045 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_stg_staging_intermediate__loans_loan_status.6519e56cae: Close
[0m07:59:32.313166 [info ] [Thread-1 (]: 25 of 42 PASS not_null_stg_staging_intermediate__loans_loan_status ............. [[32mPASS[0m in 0.03s]
[0m07:59:32.313887 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.not_null_stg_staging_intermediate__loans_loan_status.6519e56cae
[0m07:59:32.314305 [debug] [Thread-1 (]: Began running node test.vg_casestudy.not_null_stg_staging_intermediate__loans_loan_term.c98571f396
[0m07:59:32.314662 [info ] [Thread-1 (]: 26 of 42 START test not_null_stg_staging_intermediate__loans_loan_term ......... [RUN]
[0m07:59:32.315391 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.not_null_stg_staging_intermediate__loans_loan_status.6519e56cae, now test.vg_casestudy.not_null_stg_staging_intermediate__loans_loan_term.c98571f396)
[0m07:59:32.315907 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.not_null_stg_staging_intermediate__loans_loan_term.c98571f396
[0m07:59:32.320622 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.not_null_stg_staging_intermediate__loans_loan_term.c98571f396"
[0m07:59:32.321346 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_stg_staging_intermediate__loans_loan_term.c98571f396 (compile): 07:59:32.316183 => 07:59:32.321094
[0m07:59:32.321859 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.not_null_stg_staging_intermediate__loans_loan_term.c98571f396
[0m07:59:32.324564 [debug] [Thread-1 (]: Writing runtime sql for node "test.vg_casestudy.not_null_stg_staging_intermediate__loans_loan_term.c98571f396"
[0m07:59:32.325116 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.not_null_stg_staging_intermediate__loans_loan_term.c98571f396"
[0m07:59:32.325546 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_stg_staging_intermediate__loans_loan_term.c98571f396: BEGIN
[0m07:59:32.325880 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:59:32.338706 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m07:59:32.339177 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.not_null_stg_staging_intermediate__loans_loan_term.c98571f396"
[0m07:59:32.339522 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_stg_staging_intermediate__loans_loan_term.c98571f396: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "test.vg_casestudy.not_null_stg_staging_intermediate__loans_loan_term.c98571f396"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select loan_term
from "casestudy"."intermediate"."stg_staging_intermediate__loans"
where loan_term is null



      
    ) dbt_internal_test
[0m07:59:32.340621 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m07:59:32.342154 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_stg_staging_intermediate__loans_loan_term.c98571f396 (execute): 07:59:32.322123 => 07:59:32.341953
[0m07:59:32.342581 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_stg_staging_intermediate__loans_loan_term.c98571f396: ROLLBACK
[0m07:59:32.343069 [debug] [Thread-1 (]: Failed to rollback 'test.vg_casestudy.not_null_stg_staging_intermediate__loans_loan_term.c98571f396'
[0m07:59:32.343416 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_stg_staging_intermediate__loans_loan_term.c98571f396: Close
[0m07:59:32.346162 [info ] [Thread-1 (]: 26 of 42 PASS not_null_stg_staging_intermediate__loans_loan_term ............... [[32mPASS[0m in 0.03s]
[0m07:59:32.346804 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.not_null_stg_staging_intermediate__loans_loan_term.c98571f396
[0m07:59:32.347227 [debug] [Thread-1 (]: Began running node test.vg_casestudy.not_null_stg_staging_intermediate__transactions_transaction_amount.8dc65a17fe
[0m07:59:32.347740 [info ] [Thread-1 (]: 27 of 42 START test not_null_stg_staging_intermediate__transactions_transaction_amount  [RUN]
[0m07:59:32.348452 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.not_null_stg_staging_intermediate__loans_loan_term.c98571f396, now test.vg_casestudy.not_null_stg_staging_intermediate__transactions_transaction_amount.8dc65a17fe)
[0m07:59:32.348789 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.not_null_stg_staging_intermediate__transactions_transaction_amount.8dc65a17fe
[0m07:59:32.353291 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.not_null_stg_staging_intermediate__transactions_transaction_amount.8dc65a17fe"
[0m07:59:32.354202 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_stg_staging_intermediate__transactions_transaction_amount.8dc65a17fe (compile): 07:59:32.349010 => 07:59:32.353914
[0m07:59:32.354666 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.not_null_stg_staging_intermediate__transactions_transaction_amount.8dc65a17fe
[0m07:59:32.359470 [debug] [Thread-1 (]: Writing runtime sql for node "test.vg_casestudy.not_null_stg_staging_intermediate__transactions_transaction_amount.8dc65a17fe"
[0m07:59:32.360148 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.not_null_stg_staging_intermediate__transactions_transaction_amount.8dc65a17fe"
[0m07:59:32.360556 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_stg_staging_intermediate__transactions_transaction_amount.8dc65a17fe: BEGIN
[0m07:59:32.360866 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:59:32.373789 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m07:59:32.374272 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.not_null_stg_staging_intermediate__transactions_transaction_amount.8dc65a17fe"
[0m07:59:32.374630 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_stg_staging_intermediate__transactions_transaction_amount.8dc65a17fe: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "test.vg_casestudy.not_null_stg_staging_intermediate__transactions_transaction_amount.8dc65a17fe"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select transaction_amount
from "casestudy"."intermediate"."stg_staging_intermediate__transactions"
where transaction_amount is null



      
    ) dbt_internal_test
[0m07:59:32.376073 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m07:59:32.378298 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_stg_staging_intermediate__transactions_transaction_amount.8dc65a17fe (execute): 07:59:32.354972 => 07:59:32.378026
[0m07:59:32.378752 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_stg_staging_intermediate__transactions_transaction_amount.8dc65a17fe: ROLLBACK
[0m07:59:32.379241 [debug] [Thread-1 (]: Failed to rollback 'test.vg_casestudy.not_null_stg_staging_intermediate__transactions_transaction_amount.8dc65a17fe'
[0m07:59:32.379591 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_stg_staging_intermediate__transactions_transaction_amount.8dc65a17fe: Close
[0m07:59:32.382260 [info ] [Thread-1 (]: 27 of 42 PASS not_null_stg_staging_intermediate__transactions_transaction_amount  [[32mPASS[0m in 0.03s]
[0m07:59:32.382884 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.not_null_stg_staging_intermediate__transactions_transaction_amount.8dc65a17fe
[0m07:59:32.383283 [debug] [Thread-1 (]: Began running node test.vg_casestudy.not_null_stg_staging_intermediate__transactions_transaction_currency.fd19959743
[0m07:59:32.383810 [info ] [Thread-1 (]: 28 of 42 START test not_null_stg_staging_intermediate__transactions_transaction_currency  [RUN]
[0m07:59:32.384504 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.not_null_stg_staging_intermediate__transactions_transaction_amount.8dc65a17fe, now test.vg_casestudy.not_null_stg_staging_intermediate__transactions_transaction_currency.fd19959743)
[0m07:59:32.384838 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.not_null_stg_staging_intermediate__transactions_transaction_currency.fd19959743
[0m07:59:32.388959 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.not_null_stg_staging_intermediate__transactions_transaction_currency.fd19959743"
[0m07:59:32.389573 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_stg_staging_intermediate__transactions_transaction_currency.fd19959743 (compile): 07:59:32.385057 => 07:59:32.389353
[0m07:59:32.389977 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.not_null_stg_staging_intermediate__transactions_transaction_currency.fd19959743
[0m07:59:32.393449 [debug] [Thread-1 (]: Writing runtime sql for node "test.vg_casestudy.not_null_stg_staging_intermediate__transactions_transaction_currency.fd19959743"
[0m07:59:32.394189 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.not_null_stg_staging_intermediate__transactions_transaction_currency.fd19959743"
[0m07:59:32.394617 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_stg_staging_intermediate__transactions_transaction_currency.fd19959743: BEGIN
[0m07:59:32.394955 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:59:32.408226 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m07:59:32.408737 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.not_null_stg_staging_intermediate__transactions_transaction_currency.fd19959743"
[0m07:59:32.409102 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_stg_staging_intermediate__transactions_transaction_currency.fd19959743: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "test.vg_casestudy.not_null_stg_staging_intermediate__transactions_transaction_currency.fd19959743"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select transaction_currency
from "casestudy"."intermediate"."stg_staging_intermediate__transactions"
where transaction_currency is null



      
    ) dbt_internal_test
[0m07:59:32.410550 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m07:59:32.412390 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_stg_staging_intermediate__transactions_transaction_currency.fd19959743 (execute): 07:59:32.390220 => 07:59:32.412166
[0m07:59:32.412808 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_stg_staging_intermediate__transactions_transaction_currency.fd19959743: ROLLBACK
[0m07:59:32.413276 [debug] [Thread-1 (]: Failed to rollback 'test.vg_casestudy.not_null_stg_staging_intermediate__transactions_transaction_currency.fd19959743'
[0m07:59:32.413601 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_stg_staging_intermediate__transactions_transaction_currency.fd19959743: Close
[0m07:59:32.416135 [info ] [Thread-1 (]: 28 of 42 PASS not_null_stg_staging_intermediate__transactions_transaction_currency  [[32mPASS[0m in 0.03s]
[0m07:59:32.416749 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.not_null_stg_staging_intermediate__transactions_transaction_currency.fd19959743
[0m07:59:32.417182 [debug] [Thread-1 (]: Began running node test.vg_casestudy.not_null_stg_staging_intermediate__transactions_transaction_id.cb7402fe02
[0m07:59:32.417684 [info ] [Thread-1 (]: 29 of 42 START test not_null_stg_staging_intermediate__transactions_transaction_id  [RUN]
[0m07:59:32.418392 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.not_null_stg_staging_intermediate__transactions_transaction_currency.fd19959743, now test.vg_casestudy.not_null_stg_staging_intermediate__transactions_transaction_id.cb7402fe02)
[0m07:59:32.418730 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.not_null_stg_staging_intermediate__transactions_transaction_id.cb7402fe02
[0m07:59:32.423320 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.not_null_stg_staging_intermediate__transactions_transaction_id.cb7402fe02"
[0m07:59:32.424659 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_stg_staging_intermediate__transactions_transaction_id.cb7402fe02 (compile): 07:59:32.418966 => 07:59:32.424345
[0m07:59:32.425084 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.not_null_stg_staging_intermediate__transactions_transaction_id.cb7402fe02
[0m07:59:32.428017 [debug] [Thread-1 (]: Writing runtime sql for node "test.vg_casestudy.not_null_stg_staging_intermediate__transactions_transaction_id.cb7402fe02"
[0m07:59:32.428686 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.not_null_stg_staging_intermediate__transactions_transaction_id.cb7402fe02"
[0m07:59:32.429130 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_stg_staging_intermediate__transactions_transaction_id.cb7402fe02: BEGIN
[0m07:59:32.429588 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:59:32.441925 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m07:59:32.442434 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.not_null_stg_staging_intermediate__transactions_transaction_id.cb7402fe02"
[0m07:59:32.442921 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_stg_staging_intermediate__transactions_transaction_id.cb7402fe02: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "test.vg_casestudy.not_null_stg_staging_intermediate__transactions_transaction_id.cb7402fe02"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select transaction_id
from "casestudy"."intermediate"."stg_staging_intermediate__transactions"
where transaction_id is null



      
    ) dbt_internal_test
[0m07:59:32.444552 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m07:59:32.446085 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_stg_staging_intermediate__transactions_transaction_id.cb7402fe02 (execute): 07:59:32.425345 => 07:59:32.445859
[0m07:59:32.446460 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_stg_staging_intermediate__transactions_transaction_id.cb7402fe02: ROLLBACK
[0m07:59:32.446911 [debug] [Thread-1 (]: Failed to rollback 'test.vg_casestudy.not_null_stg_staging_intermediate__transactions_transaction_id.cb7402fe02'
[0m07:59:32.447241 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_stg_staging_intermediate__transactions_transaction_id.cb7402fe02: Close
[0m07:59:32.449698 [info ] [Thread-1 (]: 29 of 42 PASS not_null_stg_staging_intermediate__transactions_transaction_id ... [[32mPASS[0m in 0.03s]
[0m07:59:32.450324 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.not_null_stg_staging_intermediate__transactions_transaction_id.cb7402fe02
[0m07:59:32.450724 [debug] [Thread-1 (]: Began running node test.vg_casestudy.numeric_range_intermediate__fx_rates_filled_fx_rate__0.9f1d0149fd
[0m07:59:32.451078 [info ] [Thread-1 (]: 30 of 42 START test numeric_range_intermediate__fx_rates_filled_fx_rate__0 ..... [RUN]
[0m07:59:32.451850 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.not_null_stg_staging_intermediate__transactions_transaction_id.cb7402fe02, now test.vg_casestudy.numeric_range_intermediate__fx_rates_filled_fx_rate__0.9f1d0149fd)
[0m07:59:32.452226 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.numeric_range_intermediate__fx_rates_filled_fx_rate__0.9f1d0149fd
[0m07:59:32.459962 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.numeric_range_intermediate__fx_rates_filled_fx_rate__0.9f1d0149fd"
[0m07:59:32.460883 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.numeric_range_intermediate__fx_rates_filled_fx_rate__0.9f1d0149fd (compile): 07:59:32.452489 => 07:59:32.460602
[0m07:59:32.461337 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.numeric_range_intermediate__fx_rates_filled_fx_rate__0.9f1d0149fd
[0m07:59:32.464206 [debug] [Thread-1 (]: Writing runtime sql for node "test.vg_casestudy.numeric_range_intermediate__fx_rates_filled_fx_rate__0.9f1d0149fd"
[0m07:59:32.464927 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.numeric_range_intermediate__fx_rates_filled_fx_rate__0.9f1d0149fd"
[0m07:59:32.465398 [debug] [Thread-1 (]: On test.vg_casestudy.numeric_range_intermediate__fx_rates_filled_fx_rate__0.9f1d0149fd: BEGIN
[0m07:59:32.465798 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:59:32.478217 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m07:59:32.478713 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.numeric_range_intermediate__fx_rates_filled_fx_rate__0.9f1d0149fd"
[0m07:59:32.479071 [debug] [Thread-1 (]: On test.vg_casestudy.numeric_range_intermediate__fx_rates_filled_fx_rate__0.9f1d0149fd: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "test.vg_casestudy.numeric_range_intermediate__fx_rates_filled_fx_rate__0.9f1d0149fd"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

    
        select *
        from "casestudy"."intermediate"."intermediate__fx_rates_filled"
        where fx_rate < 0
    
    


      
    ) dbt_internal_test
[0m07:59:32.480249 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m07:59:32.481615 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.numeric_range_intermediate__fx_rates_filled_fx_rate__0.9f1d0149fd (execute): 07:59:32.461622 => 07:59:32.481436
[0m07:59:32.482083 [debug] [Thread-1 (]: On test.vg_casestudy.numeric_range_intermediate__fx_rates_filled_fx_rate__0.9f1d0149fd: ROLLBACK
[0m07:59:32.482541 [debug] [Thread-1 (]: Failed to rollback 'test.vg_casestudy.numeric_range_intermediate__fx_rates_filled_fx_rate__0.9f1d0149fd'
[0m07:59:32.482849 [debug] [Thread-1 (]: On test.vg_casestudy.numeric_range_intermediate__fx_rates_filled_fx_rate__0.9f1d0149fd: Close
[0m07:59:32.485434 [info ] [Thread-1 (]: 30 of 42 PASS numeric_range_intermediate__fx_rates_filled_fx_rate__0 ........... [[32mPASS[0m in 0.03s]
[0m07:59:32.486095 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.numeric_range_intermediate__fx_rates_filled_fx_rate__0.9f1d0149fd
[0m07:59:32.486494 [debug] [Thread-1 (]: Began running node test.vg_casestudy.numeric_range_stg_staging_intermediate__fx_rates_fx_rate__0.2d4a929b3f
[0m07:59:32.487089 [info ] [Thread-1 (]: 31 of 42 START test numeric_range_stg_staging_intermediate__fx_rates_fx_rate__0  [RUN]
[0m07:59:32.487782 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.numeric_range_intermediate__fx_rates_filled_fx_rate__0.9f1d0149fd, now test.vg_casestudy.numeric_range_stg_staging_intermediate__fx_rates_fx_rate__0.2d4a929b3f)
[0m07:59:32.488108 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.numeric_range_stg_staging_intermediate__fx_rates_fx_rate__0.2d4a929b3f
[0m07:59:32.491906 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.numeric_range_stg_staging_intermediate__fx_rates_fx_rate__0.2d4a929b3f"
[0m07:59:32.492838 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.numeric_range_stg_staging_intermediate__fx_rates_fx_rate__0.2d4a929b3f (compile): 07:59:32.488324 => 07:59:32.492519
[0m07:59:32.493253 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.numeric_range_stg_staging_intermediate__fx_rates_fx_rate__0.2d4a929b3f
[0m07:59:32.496338 [debug] [Thread-1 (]: Writing runtime sql for node "test.vg_casestudy.numeric_range_stg_staging_intermediate__fx_rates_fx_rate__0.2d4a929b3f"
[0m07:59:32.497081 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.numeric_range_stg_staging_intermediate__fx_rates_fx_rate__0.2d4a929b3f"
[0m07:59:32.497468 [debug] [Thread-1 (]: On test.vg_casestudy.numeric_range_stg_staging_intermediate__fx_rates_fx_rate__0.2d4a929b3f: BEGIN
[0m07:59:32.497782 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:59:32.511487 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m07:59:32.512042 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.numeric_range_stg_staging_intermediate__fx_rates_fx_rate__0.2d4a929b3f"
[0m07:59:32.512420 [debug] [Thread-1 (]: On test.vg_casestudy.numeric_range_stg_staging_intermediate__fx_rates_fx_rate__0.2d4a929b3f: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "test.vg_casestudy.numeric_range_stg_staging_intermediate__fx_rates_fx_rate__0.2d4a929b3f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

    
        select *
        from "casestudy"."intermediate"."stg_staging_intermediate__fx_rates"
        where fx_rate < 0
    
    


      
    ) dbt_internal_test
[0m07:59:32.513660 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m07:59:32.515155 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.numeric_range_stg_staging_intermediate__fx_rates_fx_rate__0.2d4a929b3f (execute): 07:59:32.493532 => 07:59:32.514956
[0m07:59:32.515635 [debug] [Thread-1 (]: On test.vg_casestudy.numeric_range_stg_staging_intermediate__fx_rates_fx_rate__0.2d4a929b3f: ROLLBACK
[0m07:59:32.516109 [debug] [Thread-1 (]: Failed to rollback 'test.vg_casestudy.numeric_range_stg_staging_intermediate__fx_rates_fx_rate__0.2d4a929b3f'
[0m07:59:32.516432 [debug] [Thread-1 (]: On test.vg_casestudy.numeric_range_stg_staging_intermediate__fx_rates_fx_rate__0.2d4a929b3f: Close
[0m07:59:32.518946 [info ] [Thread-1 (]: 31 of 42 PASS numeric_range_stg_staging_intermediate__fx_rates_fx_rate__0 ...... [[32mPASS[0m in 0.03s]
[0m07:59:32.519547 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.numeric_range_stg_staging_intermediate__fx_rates_fx_rate__0.2d4a929b3f
[0m07:59:32.519977 [debug] [Thread-1 (]: Began running node test.vg_casestudy.numeric_range_stg_staging_intermediate__loans_interest_rate__0.049a21d6b9
[0m07:59:32.520525 [info ] [Thread-1 (]: 32 of 42 START test numeric_range_stg_staging_intermediate__loans_interest_rate__0  [RUN]
[0m07:59:32.521237 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.numeric_range_stg_staging_intermediate__fx_rates_fx_rate__0.2d4a929b3f, now test.vg_casestudy.numeric_range_stg_staging_intermediate__loans_interest_rate__0.049a21d6b9)
[0m07:59:32.521580 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.numeric_range_stg_staging_intermediate__loans_interest_rate__0.049a21d6b9
[0m07:59:32.528103 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.numeric_range_stg_staging_intermediate__loans_interest_rate__0.049a21d6b9"
[0m07:59:32.528922 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.numeric_range_stg_staging_intermediate__loans_interest_rate__0.049a21d6b9 (compile): 07:59:32.521840 => 07:59:32.528664
[0m07:59:32.529319 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.numeric_range_stg_staging_intermediate__loans_interest_rate__0.049a21d6b9
[0m07:59:32.532052 [debug] [Thread-1 (]: Writing runtime sql for node "test.vg_casestudy.numeric_range_stg_staging_intermediate__loans_interest_rate__0.049a21d6b9"
[0m07:59:32.532704 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.numeric_range_stg_staging_intermediate__loans_interest_rate__0.049a21d6b9"
[0m07:59:32.533071 [debug] [Thread-1 (]: On test.vg_casestudy.numeric_range_stg_staging_intermediate__loans_interest_rate__0.049a21d6b9: BEGIN
[0m07:59:32.533409 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:59:32.550252 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m07:59:32.550767 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.numeric_range_stg_staging_intermediate__loans_interest_rate__0.049a21d6b9"
[0m07:59:32.551151 [debug] [Thread-1 (]: On test.vg_casestudy.numeric_range_stg_staging_intermediate__loans_interest_rate__0.049a21d6b9: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "test.vg_casestudy.numeric_range_stg_staging_intermediate__loans_interest_rate__0.049a21d6b9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

    
        select *
        from "casestudy"."intermediate"."stg_staging_intermediate__loans"
        where interest_rate < 0
    
    


      
    ) dbt_internal_test
[0m07:59:32.552662 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m07:59:32.554025 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.numeric_range_stg_staging_intermediate__loans_interest_rate__0.049a21d6b9 (execute): 07:59:32.529573 => 07:59:32.553852
[0m07:59:32.554374 [debug] [Thread-1 (]: On test.vg_casestudy.numeric_range_stg_staging_intermediate__loans_interest_rate__0.049a21d6b9: ROLLBACK
[0m07:59:32.554835 [debug] [Thread-1 (]: Failed to rollback 'test.vg_casestudy.numeric_range_stg_staging_intermediate__loans_interest_rate__0.049a21d6b9'
[0m07:59:32.555126 [debug] [Thread-1 (]: On test.vg_casestudy.numeric_range_stg_staging_intermediate__loans_interest_rate__0.049a21d6b9: Close
[0m07:59:32.557519 [info ] [Thread-1 (]: 32 of 42 PASS numeric_range_stg_staging_intermediate__loans_interest_rate__0 ... [[32mPASS[0m in 0.04s]
[0m07:59:32.558120 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.numeric_range_stg_staging_intermediate__loans_interest_rate__0.049a21d6b9
[0m07:59:32.558531 [debug] [Thread-1 (]: Began running node test.vg_casestudy.numeric_range_stg_staging_intermediate__loans_loan_amount__0.68f9ee0c26
[0m07:59:32.559213 [info ] [Thread-1 (]: 33 of 42 START test numeric_range_stg_staging_intermediate__loans_loan_amount__0  [RUN]
[0m07:59:32.560048 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.numeric_range_stg_staging_intermediate__loans_interest_rate__0.049a21d6b9, now test.vg_casestudy.numeric_range_stg_staging_intermediate__loans_loan_amount__0.68f9ee0c26)
[0m07:59:32.560375 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.numeric_range_stg_staging_intermediate__loans_loan_amount__0.68f9ee0c26
[0m07:59:32.565481 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.numeric_range_stg_staging_intermediate__loans_loan_amount__0.68f9ee0c26"
[0m07:59:32.566524 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.numeric_range_stg_staging_intermediate__loans_loan_amount__0.68f9ee0c26 (compile): 07:59:32.560646 => 07:59:32.566205
[0m07:59:32.566949 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.numeric_range_stg_staging_intermediate__loans_loan_amount__0.68f9ee0c26
[0m07:59:32.569761 [debug] [Thread-1 (]: Writing runtime sql for node "test.vg_casestudy.numeric_range_stg_staging_intermediate__loans_loan_amount__0.68f9ee0c26"
[0m07:59:32.570462 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.numeric_range_stg_staging_intermediate__loans_loan_amount__0.68f9ee0c26"
[0m07:59:32.570846 [debug] [Thread-1 (]: On test.vg_casestudy.numeric_range_stg_staging_intermediate__loans_loan_amount__0.68f9ee0c26: BEGIN
[0m07:59:32.571226 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:59:32.585424 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m07:59:32.586103 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.numeric_range_stg_staging_intermediate__loans_loan_amount__0.68f9ee0c26"
[0m07:59:32.586513 [debug] [Thread-1 (]: On test.vg_casestudy.numeric_range_stg_staging_intermediate__loans_loan_amount__0.68f9ee0c26: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "test.vg_casestudy.numeric_range_stg_staging_intermediate__loans_loan_amount__0.68f9ee0c26"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

    
        select *
        from "casestudy"."intermediate"."stg_staging_intermediate__loans"
        where loan_amount < 0
    
    


      
    ) dbt_internal_test
[0m07:59:32.588250 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m07:59:32.589978 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.numeric_range_stg_staging_intermediate__loans_loan_amount__0.68f9ee0c26 (execute): 07:59:32.567187 => 07:59:32.589713
[0m07:59:32.590411 [debug] [Thread-1 (]: On test.vg_casestudy.numeric_range_stg_staging_intermediate__loans_loan_amount__0.68f9ee0c26: ROLLBACK
[0m07:59:32.590890 [debug] [Thread-1 (]: Failed to rollback 'test.vg_casestudy.numeric_range_stg_staging_intermediate__loans_loan_amount__0.68f9ee0c26'
[0m07:59:32.591215 [debug] [Thread-1 (]: On test.vg_casestudy.numeric_range_stg_staging_intermediate__loans_loan_amount__0.68f9ee0c26: Close
[0m07:59:32.594138 [info ] [Thread-1 (]: 33 of 42 PASS numeric_range_stg_staging_intermediate__loans_loan_amount__0 ..... [[32mPASS[0m in 0.03s]
[0m07:59:32.594807 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.numeric_range_stg_staging_intermediate__loans_loan_amount__0.68f9ee0c26
[0m07:59:32.595228 [debug] [Thread-1 (]: Began running node test.vg_casestudy.numeric_range_stg_staging_intermediate__transactions_transaction_amount__0.789e7a4361
[0m07:59:32.595684 [info ] [Thread-1 (]: 34 of 42 START test numeric_range_stg_staging_intermediate__transactions_transaction_amount__0  [RUN]
[0m07:59:32.596353 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.numeric_range_stg_staging_intermediate__loans_loan_amount__0.68f9ee0c26, now test.vg_casestudy.numeric_range_stg_staging_intermediate__transactions_transaction_amount__0.789e7a4361)
[0m07:59:32.596695 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.numeric_range_stg_staging_intermediate__transactions_transaction_amount__0.789e7a4361
[0m07:59:32.601125 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.numeric_range_stg_staging_intermediate__transactions_transaction_amount__0.789e7a4361"
[0m07:59:32.601822 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.numeric_range_stg_staging_intermediate__transactions_transaction_amount__0.789e7a4361 (compile): 07:59:32.596920 => 07:59:32.601584
[0m07:59:32.602203 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.numeric_range_stg_staging_intermediate__transactions_transaction_amount__0.789e7a4361
[0m07:59:32.604998 [debug] [Thread-1 (]: Writing runtime sql for node "test.vg_casestudy.numeric_range_stg_staging_intermediate__transactions_transaction_amount__0.789e7a4361"
[0m07:59:32.605687 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.numeric_range_stg_staging_intermediate__transactions_transaction_amount__0.789e7a4361"
[0m07:59:32.606071 [debug] [Thread-1 (]: On test.vg_casestudy.numeric_range_stg_staging_intermediate__transactions_transaction_amount__0.789e7a4361: BEGIN
[0m07:59:32.606390 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:59:32.619027 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m07:59:32.619503 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.numeric_range_stg_staging_intermediate__transactions_transaction_amount__0.789e7a4361"
[0m07:59:32.619870 [debug] [Thread-1 (]: On test.vg_casestudy.numeric_range_stg_staging_intermediate__transactions_transaction_amount__0.789e7a4361: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "test.vg_casestudy.numeric_range_stg_staging_intermediate__transactions_transaction_amount__0.789e7a4361"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

    
        select *
        from "casestudy"."intermediate"."stg_staging_intermediate__transactions"
        where transaction_amount < 0
    
    


      
    ) dbt_internal_test
[0m07:59:32.621075 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m07:59:32.622623 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.numeric_range_stg_staging_intermediate__transactions_transaction_amount__0.789e7a4361 (execute): 07:59:32.602488 => 07:59:32.622434
[0m07:59:32.623016 [debug] [Thread-1 (]: On test.vg_casestudy.numeric_range_stg_staging_intermediate__transactions_transaction_amount__0.789e7a4361: ROLLBACK
[0m07:59:32.623463 [debug] [Thread-1 (]: Failed to rollback 'test.vg_casestudy.numeric_range_stg_staging_intermediate__transactions_transaction_amount__0.789e7a4361'
[0m07:59:32.623784 [debug] [Thread-1 (]: On test.vg_casestudy.numeric_range_stg_staging_intermediate__transactions_transaction_amount__0.789e7a4361: Close
[0m07:59:32.626687 [info ] [Thread-1 (]: 34 of 42 PASS numeric_range_stg_staging_intermediate__transactions_transaction_amount__0  [[32mPASS[0m in 0.03s]
[0m07:59:32.627537 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.numeric_range_stg_staging_intermediate__transactions_transaction_amount__0.789e7a4361
[0m07:59:32.628023 [debug] [Thread-1 (]: Began running node test.vg_casestudy.relationships_stg_staging_intermediate__accounts_customer_id__customer_id__ref_stg_staging_intermediate__customers_.d3a09ede96
[0m07:59:32.628437 [info ] [Thread-1 (]: 35 of 42 START test relationships_stg_staging_intermediate__accounts_customer_id__customer_id__ref_stg_staging_intermediate__customers_  [RUN]
[0m07:59:32.629337 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.numeric_range_stg_staging_intermediate__transactions_transaction_amount__0.789e7a4361, now test.vg_casestudy.relationships_stg_staging_intermediate__accounts_customer_id__customer_id__ref_stg_staging_intermediate__customers_.d3a09ede96)
[0m07:59:32.629810 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.relationships_stg_staging_intermediate__accounts_customer_id__customer_id__ref_stg_staging_intermediate__customers_.d3a09ede96
[0m07:59:32.639986 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.relationships_stg_staging_intermediate__accounts_customer_id__customer_id__ref_stg_staging_intermediate__customers_.d3a09ede96"
[0m07:59:32.641035 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.relationships_stg_staging_intermediate__accounts_customer_id__customer_id__ref_stg_staging_intermediate__customers_.d3a09ede96 (compile): 07:59:32.630074 => 07:59:32.640716
[0m07:59:32.641509 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.relationships_stg_staging_intermediate__accounts_customer_id__customer_id__ref_stg_staging_intermediate__customers_.d3a09ede96
[0m07:59:32.645126 [debug] [Thread-1 (]: Writing runtime sql for node "test.vg_casestudy.relationships_stg_staging_intermediate__accounts_customer_id__customer_id__ref_stg_staging_intermediate__customers_.d3a09ede96"
[0m07:59:32.646086 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.relationships_stg_staging_intermediate__accounts_customer_id__customer_id__ref_stg_staging_intermediate__customers_.d3a09ede96"
[0m07:59:32.646588 [debug] [Thread-1 (]: On test.vg_casestudy.relationships_stg_staging_intermediate__accounts_customer_id__customer_id__ref_stg_staging_intermediate__customers_.d3a09ede96: BEGIN
[0m07:59:32.647041 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:59:32.659370 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m07:59:32.659934 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.relationships_stg_staging_intermediate__accounts_customer_id__customer_id__ref_stg_staging_intermediate__customers_.d3a09ede96"
[0m07:59:32.660401 [debug] [Thread-1 (]: On test.vg_casestudy.relationships_stg_staging_intermediate__accounts_customer_id__customer_id__ref_stg_staging_intermediate__customers_.d3a09ede96: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "test.vg_casestudy.relationships_stg_staging_intermediate__accounts_customer_id__customer_id__ref_stg_staging_intermediate__customers_.d3a09ede96"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select customer_id as from_field
    from "casestudy"."intermediate"."stg_staging_intermediate__accounts"
    where customer_id is not null
),

parent as (
    select customer_id as to_field
    from "casestudy"."intermediate"."stg_staging_intermediate__customers"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m07:59:32.664585 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m07:59:32.666334 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.relationships_stg_staging_intermediate__accounts_customer_id__customer_id__ref_stg_staging_intermediate__customers_.d3a09ede96 (execute): 07:59:32.641804 => 07:59:32.666107
[0m07:59:32.666746 [debug] [Thread-1 (]: On test.vg_casestudy.relationships_stg_staging_intermediate__accounts_customer_id__customer_id__ref_stg_staging_intermediate__customers_.d3a09ede96: ROLLBACK
[0m07:59:32.667221 [debug] [Thread-1 (]: Failed to rollback 'test.vg_casestudy.relationships_stg_staging_intermediate__accounts_customer_id__customer_id__ref_stg_staging_intermediate__customers_.d3a09ede96'
[0m07:59:32.667556 [debug] [Thread-1 (]: On test.vg_casestudy.relationships_stg_staging_intermediate__accounts_customer_id__customer_id__ref_stg_staging_intermediate__customers_.d3a09ede96: Close
[0m07:59:32.670398 [info ] [Thread-1 (]: 35 of 42 PASS relationships_stg_staging_intermediate__accounts_customer_id__customer_id__ref_stg_staging_intermediate__customers_  [[32mPASS[0m in 0.04s]
[0m07:59:32.671080 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.relationships_stg_staging_intermediate__accounts_customer_id__customer_id__ref_stg_staging_intermediate__customers_.d3a09ede96
[0m07:59:32.671505 [debug] [Thread-1 (]: Began running node test.vg_casestudy.unique_intermediate__branch_names_branch_id.f3fd1c7d86
[0m07:59:32.672155 [info ] [Thread-1 (]: 36 of 42 START test unique_intermediate__branch_names_branch_id ................ [RUN]
[0m07:59:32.672910 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.relationships_stg_staging_intermediate__accounts_customer_id__customer_id__ref_stg_staging_intermediate__customers_.d3a09ede96, now test.vg_casestudy.unique_intermediate__branch_names_branch_id.f3fd1c7d86)
[0m07:59:32.673276 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.unique_intermediate__branch_names_branch_id.f3fd1c7d86
[0m07:59:32.680421 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.unique_intermediate__branch_names_branch_id.f3fd1c7d86"
[0m07:59:32.681330 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.unique_intermediate__branch_names_branch_id.f3fd1c7d86 (compile): 07:59:32.673509 => 07:59:32.681006
[0m07:59:32.681812 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.unique_intermediate__branch_names_branch_id.f3fd1c7d86
[0m07:59:32.685040 [debug] [Thread-1 (]: Writing runtime sql for node "test.vg_casestudy.unique_intermediate__branch_names_branch_id.f3fd1c7d86"
[0m07:59:32.685938 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.unique_intermediate__branch_names_branch_id.f3fd1c7d86"
[0m07:59:32.686425 [debug] [Thread-1 (]: On test.vg_casestudy.unique_intermediate__branch_names_branch_id.f3fd1c7d86: BEGIN
[0m07:59:32.686772 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:59:32.700986 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m07:59:32.701478 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.unique_intermediate__branch_names_branch_id.f3fd1c7d86"
[0m07:59:32.702092 [debug] [Thread-1 (]: On test.vg_casestudy.unique_intermediate__branch_names_branch_id.f3fd1c7d86: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "test.vg_casestudy.unique_intermediate__branch_names_branch_id.f3fd1c7d86"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    branch_id as unique_field,
    count(*) as n_records

from "casestudy"."intermediate"."intermediate__branch_names"
where branch_id is not null
group by branch_id
having count(*) > 1



      
    ) dbt_internal_test
[0m07:59:32.703896 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m07:59:32.705375 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.unique_intermediate__branch_names_branch_id.f3fd1c7d86 (execute): 07:59:32.682184 => 07:59:32.705183
[0m07:59:32.705764 [debug] [Thread-1 (]: On test.vg_casestudy.unique_intermediate__branch_names_branch_id.f3fd1c7d86: ROLLBACK
[0m07:59:32.706220 [debug] [Thread-1 (]: Failed to rollback 'test.vg_casestudy.unique_intermediate__branch_names_branch_id.f3fd1c7d86'
[0m07:59:32.706543 [debug] [Thread-1 (]: On test.vg_casestudy.unique_intermediate__branch_names_branch_id.f3fd1c7d86: Close
[0m07:59:32.709577 [info ] [Thread-1 (]: 36 of 42 PASS unique_intermediate__branch_names_branch_id ...................... [[32mPASS[0m in 0.04s]
[0m07:59:32.710273 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.unique_intermediate__branch_names_branch_id.f3fd1c7d86
[0m07:59:32.710700 [debug] [Thread-1 (]: Began running node test.vg_casestudy.unique_stg_staging_intermediate__accounts_account_id.b2f9fdea72
[0m07:59:32.711060 [info ] [Thread-1 (]: 37 of 42 START test unique_stg_staging_intermediate__accounts_account_id ....... [RUN]
[0m07:59:32.711860 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.unique_intermediate__branch_names_branch_id.f3fd1c7d86, now test.vg_casestudy.unique_stg_staging_intermediate__accounts_account_id.b2f9fdea72)
[0m07:59:32.712217 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.unique_stg_staging_intermediate__accounts_account_id.b2f9fdea72
[0m07:59:32.718691 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.unique_stg_staging_intermediate__accounts_account_id.b2f9fdea72"
[0m07:59:32.719533 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.unique_stg_staging_intermediate__accounts_account_id.b2f9fdea72 (compile): 07:59:32.712597 => 07:59:32.719221
[0m07:59:32.719929 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.unique_stg_staging_intermediate__accounts_account_id.b2f9fdea72
[0m07:59:32.722760 [debug] [Thread-1 (]: Writing runtime sql for node "test.vg_casestudy.unique_stg_staging_intermediate__accounts_account_id.b2f9fdea72"
[0m07:59:32.723495 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.unique_stg_staging_intermediate__accounts_account_id.b2f9fdea72"
[0m07:59:32.724118 [debug] [Thread-1 (]: On test.vg_casestudy.unique_stg_staging_intermediate__accounts_account_id.b2f9fdea72: BEGIN
[0m07:59:32.724842 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:59:32.738781 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m07:59:32.739340 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.unique_stg_staging_intermediate__accounts_account_id.b2f9fdea72"
[0m07:59:32.739754 [debug] [Thread-1 (]: On test.vg_casestudy.unique_stg_staging_intermediate__accounts_account_id.b2f9fdea72: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "test.vg_casestudy.unique_stg_staging_intermediate__accounts_account_id.b2f9fdea72"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    account_id as unique_field,
    count(*) as n_records

from "casestudy"."intermediate"."stg_staging_intermediate__accounts"
where account_id is not null
group by account_id
having count(*) > 1



      
    ) dbt_internal_test
[0m07:59:32.745150 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m07:59:32.746766 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.unique_stg_staging_intermediate__accounts_account_id.b2f9fdea72 (execute): 07:59:32.720159 => 07:59:32.746541
[0m07:59:32.747149 [debug] [Thread-1 (]: On test.vg_casestudy.unique_stg_staging_intermediate__accounts_account_id.b2f9fdea72: ROLLBACK
[0m07:59:32.747617 [debug] [Thread-1 (]: Failed to rollback 'test.vg_casestudy.unique_stg_staging_intermediate__accounts_account_id.b2f9fdea72'
[0m07:59:32.747927 [debug] [Thread-1 (]: On test.vg_casestudy.unique_stg_staging_intermediate__accounts_account_id.b2f9fdea72: Close
[0m07:59:32.751469 [info ] [Thread-1 (]: 37 of 42 PASS unique_stg_staging_intermediate__accounts_account_id ............. [[32mPASS[0m in 0.04s]
[0m07:59:32.752234 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.unique_stg_staging_intermediate__accounts_account_id.b2f9fdea72
[0m07:59:32.752636 [debug] [Thread-1 (]: Began running node test.vg_casestudy.unique_stg_staging_intermediate__currencies_currency_iso_code.4396247af3
[0m07:59:32.752997 [info ] [Thread-1 (]: 38 of 42 START test unique_stg_staging_intermediate__currencies_currency_iso_code  [RUN]
[0m07:59:32.753844 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.unique_stg_staging_intermediate__accounts_account_id.b2f9fdea72, now test.vg_casestudy.unique_stg_staging_intermediate__currencies_currency_iso_code.4396247af3)
[0m07:59:32.754177 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.unique_stg_staging_intermediate__currencies_currency_iso_code.4396247af3
[0m07:59:32.758229 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.unique_stg_staging_intermediate__currencies_currency_iso_code.4396247af3"
[0m07:59:32.758921 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.unique_stg_staging_intermediate__currencies_currency_iso_code.4396247af3 (compile): 07:59:32.754408 => 07:59:32.758688
[0m07:59:32.759305 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.unique_stg_staging_intermediate__currencies_currency_iso_code.4396247af3
[0m07:59:32.762376 [debug] [Thread-1 (]: Writing runtime sql for node "test.vg_casestudy.unique_stg_staging_intermediate__currencies_currency_iso_code.4396247af3"
[0m07:59:32.763059 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.unique_stg_staging_intermediate__currencies_currency_iso_code.4396247af3"
[0m07:59:32.763442 [debug] [Thread-1 (]: On test.vg_casestudy.unique_stg_staging_intermediate__currencies_currency_iso_code.4396247af3: BEGIN
[0m07:59:32.763743 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:59:32.775866 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m07:59:32.776403 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.unique_stg_staging_intermediate__currencies_currency_iso_code.4396247af3"
[0m07:59:32.776794 [debug] [Thread-1 (]: On test.vg_casestudy.unique_stg_staging_intermediate__currencies_currency_iso_code.4396247af3: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "test.vg_casestudy.unique_stg_staging_intermediate__currencies_currency_iso_code.4396247af3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    currency_iso_code as unique_field,
    count(*) as n_records

from "casestudy"."intermediate"."stg_staging_intermediate__currencies"
where currency_iso_code is not null
group by currency_iso_code
having count(*) > 1



      
    ) dbt_internal_test
[0m07:59:32.779362 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m07:59:32.781250 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.unique_stg_staging_intermediate__currencies_currency_iso_code.4396247af3 (execute): 07:59:32.759593 => 07:59:32.780985
[0m07:59:32.781960 [debug] [Thread-1 (]: On test.vg_casestudy.unique_stg_staging_intermediate__currencies_currency_iso_code.4396247af3: ROLLBACK
[0m07:59:32.782499 [debug] [Thread-1 (]: Failed to rollback 'test.vg_casestudy.unique_stg_staging_intermediate__currencies_currency_iso_code.4396247af3'
[0m07:59:32.782863 [debug] [Thread-1 (]: On test.vg_casestudy.unique_stg_staging_intermediate__currencies_currency_iso_code.4396247af3: Close
[0m07:59:32.785852 [info ] [Thread-1 (]: 38 of 42 PASS unique_stg_staging_intermediate__currencies_currency_iso_code .... [[32mPASS[0m in 0.03s]
[0m07:59:32.786500 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.unique_stg_staging_intermediate__currencies_currency_iso_code.4396247af3
[0m07:59:32.786914 [debug] [Thread-1 (]: Began running node test.vg_casestudy.unique_stg_staging_intermediate__customers_customer_id.5bded562dd
[0m07:59:32.787385 [info ] [Thread-1 (]: 39 of 42 START test unique_stg_staging_intermediate__customers_customer_id ..... [RUN]
[0m07:59:32.788069 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.unique_stg_staging_intermediate__currencies_currency_iso_code.4396247af3, now test.vg_casestudy.unique_stg_staging_intermediate__customers_customer_id.5bded562dd)
[0m07:59:32.788397 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.unique_stg_staging_intermediate__customers_customer_id.5bded562dd
[0m07:59:32.793006 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.unique_stg_staging_intermediate__customers_customer_id.5bded562dd"
[0m07:59:32.794120 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.unique_stg_staging_intermediate__customers_customer_id.5bded562dd (compile): 07:59:32.788612 => 07:59:32.793734
[0m07:59:32.794758 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.unique_stg_staging_intermediate__customers_customer_id.5bded562dd
[0m07:59:32.797453 [debug] [Thread-1 (]: Writing runtime sql for node "test.vg_casestudy.unique_stg_staging_intermediate__customers_customer_id.5bded562dd"
[0m07:59:32.797988 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.unique_stg_staging_intermediate__customers_customer_id.5bded562dd"
[0m07:59:32.798331 [debug] [Thread-1 (]: On test.vg_casestudy.unique_stg_staging_intermediate__customers_customer_id.5bded562dd: BEGIN
[0m07:59:32.798643 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:59:32.812900 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m07:59:32.813498 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.unique_stg_staging_intermediate__customers_customer_id.5bded562dd"
[0m07:59:32.813955 [debug] [Thread-1 (]: On test.vg_casestudy.unique_stg_staging_intermediate__customers_customer_id.5bded562dd: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "test.vg_casestudy.unique_stg_staging_intermediate__customers_customer_id.5bded562dd"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from "casestudy"."intermediate"."stg_staging_intermediate__customers"
where customer_id is not null
group by customer_id
having count(*) > 1



      
    ) dbt_internal_test
[0m07:59:32.817146 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m07:59:32.818780 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.unique_stg_staging_intermediate__customers_customer_id.5bded562dd (execute): 07:59:32.795055 => 07:59:32.818519
[0m07:59:32.819161 [debug] [Thread-1 (]: On test.vg_casestudy.unique_stg_staging_intermediate__customers_customer_id.5bded562dd: ROLLBACK
[0m07:59:32.819609 [debug] [Thread-1 (]: Failed to rollback 'test.vg_casestudy.unique_stg_staging_intermediate__customers_customer_id.5bded562dd'
[0m07:59:32.819921 [debug] [Thread-1 (]: On test.vg_casestudy.unique_stg_staging_intermediate__customers_customer_id.5bded562dd: Close
[0m07:59:32.822830 [info ] [Thread-1 (]: 39 of 42 PASS unique_stg_staging_intermediate__customers_customer_id ........... [[32mPASS[0m in 0.03s]
[0m07:59:32.823460 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.unique_stg_staging_intermediate__customers_customer_id.5bded562dd
[0m07:59:32.823870 [debug] [Thread-1 (]: Began running node test.vg_casestudy.unique_stg_staging_intermediate__fx_rates_currency_iso_code.a28e4eee53
[0m07:59:32.824231 [info ] [Thread-1 (]: 40 of 42 START test unique_stg_staging_intermediate__fx_rates_currency_iso_code  [RUN]
[0m07:59:32.824993 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.unique_stg_staging_intermediate__customers_customer_id.5bded562dd, now test.vg_casestudy.unique_stg_staging_intermediate__fx_rates_currency_iso_code.a28e4eee53)
[0m07:59:32.825298 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.unique_stg_staging_intermediate__fx_rates_currency_iso_code.a28e4eee53
[0m07:59:32.830608 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.unique_stg_staging_intermediate__fx_rates_currency_iso_code.a28e4eee53"
[0m07:59:32.831540 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.unique_stg_staging_intermediate__fx_rates_currency_iso_code.a28e4eee53 (compile): 07:59:32.825530 => 07:59:32.831209
[0m07:59:32.832162 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.unique_stg_staging_intermediate__fx_rates_currency_iso_code.a28e4eee53
[0m07:59:32.834911 [debug] [Thread-1 (]: Writing runtime sql for node "test.vg_casestudy.unique_stg_staging_intermediate__fx_rates_currency_iso_code.a28e4eee53"
[0m07:59:32.835573 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.unique_stg_staging_intermediate__fx_rates_currency_iso_code.a28e4eee53"
[0m07:59:32.835922 [debug] [Thread-1 (]: On test.vg_casestudy.unique_stg_staging_intermediate__fx_rates_currency_iso_code.a28e4eee53: BEGIN
[0m07:59:32.836221 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:59:32.848979 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m07:59:32.849479 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.unique_stg_staging_intermediate__fx_rates_currency_iso_code.a28e4eee53"
[0m07:59:32.849846 [debug] [Thread-1 (]: On test.vg_casestudy.unique_stg_staging_intermediate__fx_rates_currency_iso_code.a28e4eee53: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "test.vg_casestudy.unique_stg_staging_intermediate__fx_rates_currency_iso_code.a28e4eee53"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    currency_iso_code as unique_field,
    count(*) as n_records

from "casestudy"."intermediate"."stg_staging_intermediate__fx_rates"
where currency_iso_code is not null
group by currency_iso_code
having count(*) > 1



      
    ) dbt_internal_test
[0m07:59:32.852189 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m07:59:32.853754 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.unique_stg_staging_intermediate__fx_rates_currency_iso_code.a28e4eee53 (execute): 07:59:32.832453 => 07:59:32.853538
[0m07:59:32.854171 [debug] [Thread-1 (]: On test.vg_casestudy.unique_stg_staging_intermediate__fx_rates_currency_iso_code.a28e4eee53: ROLLBACK
[0m07:59:32.854622 [debug] [Thread-1 (]: Failed to rollback 'test.vg_casestudy.unique_stg_staging_intermediate__fx_rates_currency_iso_code.a28e4eee53'
[0m07:59:32.854939 [debug] [Thread-1 (]: On test.vg_casestudy.unique_stg_staging_intermediate__fx_rates_currency_iso_code.a28e4eee53: Close
[0m07:59:32.857789 [info ] [Thread-1 (]: 40 of 42 PASS unique_stg_staging_intermediate__fx_rates_currency_iso_code ...... [[32mPASS[0m in 0.03s]
[0m07:59:32.858403 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.unique_stg_staging_intermediate__fx_rates_currency_iso_code.a28e4eee53
[0m07:59:32.858931 [debug] [Thread-1 (]: Began running node test.vg_casestudy.unique_stg_staging_intermediate__loans_loan_id.7800e8cbcc
[0m07:59:32.859657 [info ] [Thread-1 (]: 41 of 42 START test unique_stg_staging_intermediate__loans_loan_id ............. [RUN]
[0m07:59:32.860580 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.unique_stg_staging_intermediate__fx_rates_currency_iso_code.a28e4eee53, now test.vg_casestudy.unique_stg_staging_intermediate__loans_loan_id.7800e8cbcc)
[0m07:59:32.861233 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.unique_stg_staging_intermediate__loans_loan_id.7800e8cbcc
[0m07:59:32.865640 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.unique_stg_staging_intermediate__loans_loan_id.7800e8cbcc"
[0m07:59:32.866576 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.unique_stg_staging_intermediate__loans_loan_id.7800e8cbcc (compile): 07:59:32.861563 => 07:59:32.866289
[0m07:59:32.867030 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.unique_stg_staging_intermediate__loans_loan_id.7800e8cbcc
[0m07:59:32.871504 [debug] [Thread-1 (]: Writing runtime sql for node "test.vg_casestudy.unique_stg_staging_intermediate__loans_loan_id.7800e8cbcc"
[0m07:59:32.872228 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.unique_stg_staging_intermediate__loans_loan_id.7800e8cbcc"
[0m07:59:32.872590 [debug] [Thread-1 (]: On test.vg_casestudy.unique_stg_staging_intermediate__loans_loan_id.7800e8cbcc: BEGIN
[0m07:59:32.872912 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:59:32.886218 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m07:59:32.886707 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.unique_stg_staging_intermediate__loans_loan_id.7800e8cbcc"
[0m07:59:32.887057 [debug] [Thread-1 (]: On test.vg_casestudy.unique_stg_staging_intermediate__loans_loan_id.7800e8cbcc: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "test.vg_casestudy.unique_stg_staging_intermediate__loans_loan_id.7800e8cbcc"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    loan_id as unique_field,
    count(*) as n_records

from "casestudy"."intermediate"."stg_staging_intermediate__loans"
where loan_id is not null
group by loan_id
having count(*) > 1



      
    ) dbt_internal_test
[0m07:59:32.889680 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m07:59:32.891166 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.unique_stg_staging_intermediate__loans_loan_id.7800e8cbcc (execute): 07:59:32.867290 => 07:59:32.890973
[0m07:59:32.891560 [debug] [Thread-1 (]: On test.vg_casestudy.unique_stg_staging_intermediate__loans_loan_id.7800e8cbcc: ROLLBACK
[0m07:59:32.892134 [debug] [Thread-1 (]: Failed to rollback 'test.vg_casestudy.unique_stg_staging_intermediate__loans_loan_id.7800e8cbcc'
[0m07:59:32.892569 [debug] [Thread-1 (]: On test.vg_casestudy.unique_stg_staging_intermediate__loans_loan_id.7800e8cbcc: Close
[0m07:59:32.896007 [info ] [Thread-1 (]: 41 of 42 PASS unique_stg_staging_intermediate__loans_loan_id ................... [[32mPASS[0m in 0.04s]
[0m07:59:32.896757 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.unique_stg_staging_intermediate__loans_loan_id.7800e8cbcc
[0m07:59:32.897163 [debug] [Thread-1 (]: Began running node test.vg_casestudy.unique_stg_staging_intermediate__transactions_transaction_id.dbfd7b9b66
[0m07:59:32.897526 [info ] [Thread-1 (]: 42 of 42 START test unique_stg_staging_intermediate__transactions_transaction_id  [RUN]
[0m07:59:32.898246 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.unique_stg_staging_intermediate__loans_loan_id.7800e8cbcc, now test.vg_casestudy.unique_stg_staging_intermediate__transactions_transaction_id.dbfd7b9b66)
[0m07:59:32.898595 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.unique_stg_staging_intermediate__transactions_transaction_id.dbfd7b9b66
[0m07:59:32.902547 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.unique_stg_staging_intermediate__transactions_transaction_id.dbfd7b9b66"
[0m07:59:32.903417 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.unique_stg_staging_intermediate__transactions_transaction_id.dbfd7b9b66 (compile): 07:59:32.898828 => 07:59:32.903178
[0m07:59:32.903995 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.unique_stg_staging_intermediate__transactions_transaction_id.dbfd7b9b66
[0m07:59:32.906866 [debug] [Thread-1 (]: Writing runtime sql for node "test.vg_casestudy.unique_stg_staging_intermediate__transactions_transaction_id.dbfd7b9b66"
[0m07:59:32.907491 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.unique_stg_staging_intermediate__transactions_transaction_id.dbfd7b9b66"
[0m07:59:32.907856 [debug] [Thread-1 (]: On test.vg_casestudy.unique_stg_staging_intermediate__transactions_transaction_id.dbfd7b9b66: BEGIN
[0m07:59:32.908164 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:59:32.922058 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m07:59:32.922600 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.unique_stg_staging_intermediate__transactions_transaction_id.dbfd7b9b66"
[0m07:59:32.923044 [debug] [Thread-1 (]: On test.vg_casestudy.unique_stg_staging_intermediate__transactions_transaction_id.dbfd7b9b66: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "test.vg_casestudy.unique_stg_staging_intermediate__transactions_transaction_id.dbfd7b9b66"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    transaction_id as unique_field,
    count(*) as n_records

from "casestudy"."intermediate"."stg_staging_intermediate__transactions"
where transaction_id is not null
group by transaction_id
having count(*) > 1



      
    ) dbt_internal_test
[0m07:59:32.931045 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m07:59:32.932975 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.unique_stg_staging_intermediate__transactions_transaction_id.dbfd7b9b66 (execute): 07:59:32.904277 => 07:59:32.932742
[0m07:59:32.933394 [debug] [Thread-1 (]: On test.vg_casestudy.unique_stg_staging_intermediate__transactions_transaction_id.dbfd7b9b66: ROLLBACK
[0m07:59:32.933860 [debug] [Thread-1 (]: Failed to rollback 'test.vg_casestudy.unique_stg_staging_intermediate__transactions_transaction_id.dbfd7b9b66'
[0m07:59:32.934185 [debug] [Thread-1 (]: On test.vg_casestudy.unique_stg_staging_intermediate__transactions_transaction_id.dbfd7b9b66: Close
[0m07:59:32.937454 [info ] [Thread-1 (]: 42 of 42 PASS unique_stg_staging_intermediate__transactions_transaction_id ..... [[32mPASS[0m in 0.04s]
[0m07:59:32.938081 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.unique_stg_staging_intermediate__transactions_transaction_id.dbfd7b9b66
[0m07:59:32.939997 [debug] [MainThread]: Using duckdb connection "master"
[0m07:59:32.940345 [debug] [MainThread]: On master: BEGIN
[0m07:59:32.940623 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m07:59:32.953787 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m07:59:32.954239 [debug] [MainThread]: On master: COMMIT
[0m07:59:32.954541 [debug] [MainThread]: Using duckdb connection "master"
[0m07:59:32.954810 [debug] [MainThread]: On master: COMMIT
[0m07:59:32.955380 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m07:59:32.955755 [debug] [MainThread]: On master: Close
[0m07:59:32.958443 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:59:32.958904 [debug] [MainThread]: Connection 'list_casestudy_intermediate' was properly closed.
[0m07:59:32.959208 [debug] [MainThread]: Connection 'test.vg_casestudy.unique_stg_staging_intermediate__transactions_transaction_id.dbfd7b9b66' was properly closed.
[0m07:59:32.959778 [info ] [MainThread]: 
[0m07:59:32.960222 [info ] [MainThread]: Finished running 42 tests in 0 hours 0 minutes and 1.75 seconds (1.75s).
[0m07:59:32.965124 [debug] [MainThread]: Command end result
[0m07:59:32.986643 [info ] [MainThread]: 
[0m07:59:32.987123 [info ] [MainThread]: [32mCompleted successfully[0m
[0m07:59:32.987519 [info ] [MainThread]: 
[0m07:59:32.987844 [info ] [MainThread]: Done. PASS=42 WARN=0 ERROR=0 SKIP=0 TOTAL=42
[0m07:59:32.988373 [debug] [MainThread]: Command `dbt test` succeeded at 07:59:32.988259 after 2.07 seconds
[0m07:59:32.988717 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f773d868150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f773be99110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7740953310>]}
[0m07:59:32.989073 [debug] [MainThread]: Flushing usage events
[0m08:11:36.588708 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd868085c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd867f18950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd867f69650>]}


============================== 08:11:36.594743 | 0678ada5-9659-409e-83a1-cb2bcaba4629 ==============================
[0m08:11:36.594743 [info ] [MainThread]: Running with dbt=1.6.18
[0m08:11:36.595371 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/workspaces/vg_case_study_tim/transformation', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/workspaces/vg_case_study_tim/transformation/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --select core__customers_enriched --full-refresh', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m08:11:36.813414 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0678ada5-9659-409e-83a1-cb2bcaba4629', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd867f0f890>]}
[0m08:11:36.828424 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0678ada5-9659-409e-83a1-cb2bcaba4629', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd867d0bb50>]}
[0m08:11:36.829987 [info ] [MainThread]: Registered adapter: duckdb=1.6.2
[0m08:11:36.858314 [debug] [MainThread]: checksum: 7b9fab86a08e9e96a48a825af743c566d95b877e068b8c6d0dbafbf714447189, vars: {}, profile: , target: , version: 1.6.18
[0m08:11:36.961105 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m08:11:36.962071 [debug] [MainThread]: Partial parsing: updated file: vg_casestudy://models/core/core__customers_enriched.yml
[0m08:11:36.962465 [debug] [MainThread]: Partial parsing: updated file: vg_casestudy://models/core/core__customers_enriched.sql
[0m08:11:37.103269 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.vg_casestudy.main
- models.vg_casestudy.reporting
- models.vg_casestudy.marts
[0m08:11:37.111192 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0678ada5-9659-409e-83a1-cb2bcaba4629', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd867c15550>]}
[0m08:11:37.145028 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0678ada5-9659-409e-83a1-cb2bcaba4629', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd863a86e50>]}
[0m08:11:37.145558 [info ] [MainThread]: Found 15 models, 1 analysis, 4 seeds, 97 tests, 5 sources, 0 exposures, 0 metrics, 632 macros, 0 groups, 0 semantic models
[0m08:11:37.145960 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0678ada5-9659-409e-83a1-cb2bcaba4629', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd863dc0310>]}
[0m08:11:37.148359 [info ] [MainThread]: 
[0m08:11:37.149126 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m08:11:37.150240 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_casestudy'
[0m08:11:37.163828 [debug] [ThreadPool]: Using duckdb connection "list_casestudy"
[0m08:11:37.164332 [debug] [ThreadPool]: On list_casestudy: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"casestudy"'
    
  
  
[0m08:11:37.164709 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:11:37.312885 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m08:11:37.314302 [debug] [ThreadPool]: On list_casestudy: Close
[0m08:11:37.318789 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy, now create_casestudy_core)
[0m08:11:37.319544 [debug] [ThreadPool]: Creating schema "database: "casestudy"
schema: "core"
"
[0m08:11:37.323733 [debug] [ThreadPool]: Using duckdb connection "create_casestudy_core"
[0m08:11:37.324042 [debug] [ThreadPool]: On create_casestudy_core: BEGIN
[0m08:11:37.324336 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:11:37.335412 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m08:11:37.335804 [debug] [ThreadPool]: Using duckdb connection "create_casestudy_core"
[0m08:11:37.336091 [debug] [ThreadPool]: On create_casestudy_core: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "create_casestudy_core"} */
create schema if not exists "casestudy"."core"
[0m08:11:37.336674 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m08:11:37.337537 [debug] [ThreadPool]: On create_casestudy_core: COMMIT
[0m08:11:37.337899 [debug] [ThreadPool]: Using duckdb connection "create_casestudy_core"
[0m08:11:37.338168 [debug] [ThreadPool]: On create_casestudy_core: COMMIT
[0m08:11:37.338641 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m08:11:37.338917 [debug] [ThreadPool]: On create_casestudy_core: Close
[0m08:11:37.344369 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_casestudy_core, now list_casestudy_core)
[0m08:11:37.350727 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_core"
[0m08:11:37.351209 [debug] [ThreadPool]: On list_casestudy_core: BEGIN
[0m08:11:37.351572 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:11:37.364325 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m08:11:37.364731 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_core"
[0m08:11:37.365028 [debug] [ThreadPool]: On list_casestudy_core: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_core"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'core'
    and table_catalog = 'casestudy'
  
[0m08:11:37.381455 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m08:11:37.383224 [debug] [ThreadPool]: On list_casestudy_core: ROLLBACK
[0m08:11:37.384912 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_core'
[0m08:11:37.385327 [debug] [ThreadPool]: On list_casestudy_core: Close
[0m08:11:37.388802 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy_core, now list_casestudy_raw)
[0m08:11:37.391660 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_raw"
[0m08:11:37.392035 [debug] [ThreadPool]: On list_casestudy_raw: BEGIN
[0m08:11:37.392339 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:11:37.403804 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m08:11:37.404328 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_raw"
[0m08:11:37.404717 [debug] [ThreadPool]: On list_casestudy_raw: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_raw"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'raw'
    and table_catalog = 'casestudy'
  
[0m08:11:37.413679 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m08:11:37.415122 [debug] [ThreadPool]: On list_casestudy_raw: ROLLBACK
[0m08:11:37.415601 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_raw'
[0m08:11:37.415864 [debug] [ThreadPool]: On list_casestudy_raw: Close
[0m08:11:37.419316 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy_raw, now list_casestudy_staging)
[0m08:11:37.421561 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_staging"
[0m08:11:37.423046 [debug] [ThreadPool]: On list_casestudy_staging: BEGIN
[0m08:11:37.423332 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:11:37.434083 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m08:11:37.434820 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_staging"
[0m08:11:37.435118 [debug] [ThreadPool]: On list_casestudy_staging: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_staging"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'staging'
    and table_catalog = 'casestudy'
  
[0m08:11:37.443163 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m08:11:37.444475 [debug] [ThreadPool]: On list_casestudy_staging: ROLLBACK
[0m08:11:37.444928 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_staging'
[0m08:11:37.445177 [debug] [ThreadPool]: On list_casestudy_staging: Close
[0m08:11:37.448067 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy_staging, now list_casestudy_intermediate)
[0m08:11:37.450429 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_intermediate"
[0m08:11:37.451865 [debug] [ThreadPool]: On list_casestudy_intermediate: BEGIN
[0m08:11:37.452156 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:11:37.463172 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m08:11:37.463697 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_intermediate"
[0m08:11:37.463996 [debug] [ThreadPool]: On list_casestudy_intermediate: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_intermediate"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'intermediate'
    and table_catalog = 'casestudy'
  
[0m08:11:37.472382 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m08:11:37.473728 [debug] [ThreadPool]: On list_casestudy_intermediate: ROLLBACK
[0m08:11:37.474204 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_intermediate'
[0m08:11:37.474462 [debug] [ThreadPool]: On list_casestudy_intermediate: Close
[0m08:11:37.478390 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0678ada5-9659-409e-83a1-cb2bcaba4629', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd863d7e6d0>]}
[0m08:11:37.478859 [debug] [MainThread]: Using duckdb connection "master"
[0m08:11:37.479131 [debug] [MainThread]: On master: BEGIN
[0m08:11:37.479386 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:11:37.492339 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m08:11:37.492750 [debug] [MainThread]: On master: COMMIT
[0m08:11:37.493028 [debug] [MainThread]: Using duckdb connection "master"
[0m08:11:37.493287 [debug] [MainThread]: On master: COMMIT
[0m08:11:37.493764 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m08:11:37.494054 [debug] [MainThread]: On master: Close
[0m08:11:37.496649 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m08:11:37.497110 [info ] [MainThread]: 
[0m08:11:37.503251 [debug] [Thread-1 (]: Began running node model.vg_casestudy.core__customers_enriched
[0m08:11:37.503813 [info ] [Thread-1 (]: 1 of 1 START sql view model core.core__customers_enriched ...................... [RUN]
[0m08:11:37.504675 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.vg_casestudy.core__customers_enriched'
[0m08:11:37.505091 [debug] [Thread-1 (]: Began compiling node model.vg_casestudy.core__customers_enriched
[0m08:11:37.514440 [debug] [Thread-1 (]: Writing injected SQL for node "model.vg_casestudy.core__customers_enriched"
[0m08:11:37.515693 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.core__customers_enriched (compile): 08:11:37.505400 => 08:11:37.515322
[0m08:11:37.516265 [debug] [Thread-1 (]: Began executing node model.vg_casestudy.core__customers_enriched
[0m08:11:37.562957 [debug] [Thread-1 (]: Writing runtime sql for node "model.vg_casestudy.core__customers_enriched"
[0m08:11:37.564026 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.core__customers_enriched"
[0m08:11:37.564595 [debug] [Thread-1 (]: On model.vg_casestudy.core__customers_enriched: BEGIN
[0m08:11:37.565029 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m08:11:37.589266 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m08:11:37.590024 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.core__customers_enriched"
[0m08:11:37.590635 [debug] [Thread-1 (]: On model.vg_casestudy.core__customers_enriched: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.core__customers_enriched"} */

  
  create view "casestudy"."core"."core__customers_enriched__dbt_tmp" as (
    with customers as (
    select *
    from "casestudy"."intermediate"."stg_staging_intermediate__customers"
),

accounts as (
    select *
    from "casestudy"."intermediate"."stg_staging_intermediate__accounts"
),

branch_names as (
    select *
    from "casestudy"."intermediate"."intermediate__branch_names"
)


joined as (
    select 
        customers.customer_id,
        customers.firstname,
        customers.lastname,
        customers.age,
        customers.branch_id,
        branch_names.branch_name,
        accounts.account_id,
        accounts.account_type,
        accounts.account_opening_date,
        case 
            when accounts.account_id is null then false
            else true
        end as has_account

    from customers
    left join accounts
    on customers.customer_id = accounts.customer_id
    left join branch_names
    on customers.branch_id = branch_names.branch_id
)

select *
from joined
  );

[0m08:11:37.602912 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.core__customers_enriched (execute): 08:11:37.516654 => 08:11:37.602611
[0m08:11:37.603365 [debug] [Thread-1 (]: On model.vg_casestudy.core__customers_enriched: ROLLBACK
[0m08:11:37.613500 [debug] [Thread-1 (]: Failed to rollback 'model.vg_casestudy.core__customers_enriched'
[0m08:11:37.613890 [debug] [Thread-1 (]: On model.vg_casestudy.core__customers_enriched: Close
[0m08:11:37.618065 [debug] [Thread-1 (]: Runtime Error in model core__customers_enriched (models/core/core__customers_enriched.sql)
  Parser Error: syntax error at or near "joined"
[0m08:11:37.618645 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0678ada5-9659-409e-83a1-cb2bcaba4629', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd863a18490>]}
[0m08:11:37.619282 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model core.core__customers_enriched ............. [[31mERROR[0m in 0.11s]
[0m08:11:37.619828 [debug] [Thread-1 (]: Finished running node model.vg_casestudy.core__customers_enriched
[0m08:11:37.622236 [debug] [MainThread]: Using duckdb connection "master"
[0m08:11:37.622576 [debug] [MainThread]: On master: BEGIN
[0m08:11:37.622876 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:11:37.637198 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m08:11:37.637723 [debug] [MainThread]: On master: COMMIT
[0m08:11:37.638130 [debug] [MainThread]: Using duckdb connection "master"
[0m08:11:37.638526 [debug] [MainThread]: On master: COMMIT
[0m08:11:37.639307 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m08:11:37.639708 [debug] [MainThread]: On master: Close
[0m08:11:37.642314 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:11:37.642674 [debug] [MainThread]: Connection 'list_casestudy_intermediate' was properly closed.
[0m08:11:37.642936 [debug] [MainThread]: Connection 'model.vg_casestudy.core__customers_enriched' was properly closed.
[0m08:11:37.643276 [info ] [MainThread]: 
[0m08:11:37.643615 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.49 seconds (0.49s).
[0m08:11:37.644264 [debug] [MainThread]: Command end result
[0m08:11:37.663808 [info ] [MainThread]: 
[0m08:11:37.664269 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m08:11:37.664578 [info ] [MainThread]: 
[0m08:11:37.664864 [error] [MainThread]:   Runtime Error in model core__customers_enriched (models/core/core__customers_enriched.sql)
  Parser Error: syntax error at or near "joined"
[0m08:11:37.665150 [info ] [MainThread]: 
[0m08:11:37.665464 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m08:11:37.665906 [debug] [MainThread]: Command `dbt run` failed at 08:11:37.665816 after 1.09 seconds
[0m08:11:37.666250 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd867dd7690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8683b4150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8683b5010>]}
[0m08:11:37.666569 [debug] [MainThread]: Flushing usage events
[0m08:11:54.740463 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f45c80dd310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f45c8275890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f45c83eda90>]}


============================== 08:11:54.742954 | 5e3d34e4-f51e-4a3c-bab2-4e46e24d5996 ==============================
[0m08:11:54.742954 [info ] [MainThread]: Running with dbt=1.6.18
[0m08:11:54.743502 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/workspaces/vg_case_study_tim/transformation/logs', 'fail_fast': 'False', 'profiles_dir': '/workspaces/vg_case_study_tim/transformation', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --select core__customers_enriched --full-refresh', 'send_anonymous_usage_stats': 'True'}
[0m08:11:54.847397 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5e3d34e4-f51e-4a3c-bab2-4e46e24d5996', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f45c7e01610>]}
[0m08:11:54.861215 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5e3d34e4-f51e-4a3c-bab2-4e46e24d5996', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f45c7dede90>]}
[0m08:11:54.861978 [info ] [MainThread]: Registered adapter: duckdb=1.6.2
[0m08:11:54.885794 [debug] [MainThread]: checksum: 7b9fab86a08e9e96a48a825af743c566d95b877e068b8c6d0dbafbf714447189, vars: {}, profile: , target: , version: 1.6.18
[0m08:11:54.935340 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m08:11:54.936364 [debug] [MainThread]: Partial parsing: updated file: vg_casestudy://models/core/core__customers_enriched.sql
[0m08:11:55.080768 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.vg_casestudy.reporting
- models.vg_casestudy.marts
- models.vg_casestudy.main
[0m08:11:55.088519 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5e3d34e4-f51e-4a3c-bab2-4e46e24d5996', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f45c3d33b50>]}
[0m08:11:55.120719 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5e3d34e4-f51e-4a3c-bab2-4e46e24d5996', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f45c3c63ad0>]}
[0m08:11:55.121313 [info ] [MainThread]: Found 15 models, 1 analysis, 4 seeds, 97 tests, 5 sources, 0 exposures, 0 metrics, 632 macros, 0 groups, 0 semantic models
[0m08:11:55.121762 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5e3d34e4-f51e-4a3c-bab2-4e46e24d5996', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f45c7cb3c90>]}
[0m08:11:55.124312 [info ] [MainThread]: 
[0m08:11:55.125068 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m08:11:55.126216 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_casestudy'
[0m08:11:55.139010 [debug] [ThreadPool]: Using duckdb connection "list_casestudy"
[0m08:11:55.139592 [debug] [ThreadPool]: On list_casestudy: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"casestudy"'
    
  
  
[0m08:11:55.140101 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:11:55.162810 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m08:11:55.164185 [debug] [ThreadPool]: On list_casestudy: Close
[0m08:11:55.171335 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy, now create_casestudy_core)
[0m08:11:55.172117 [debug] [ThreadPool]: Creating schema "database: "casestudy"
schema: "core"
"
[0m08:11:55.176115 [debug] [ThreadPool]: Using duckdb connection "create_casestudy_core"
[0m08:11:55.176425 [debug] [ThreadPool]: On create_casestudy_core: BEGIN
[0m08:11:55.176744 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:11:55.190456 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m08:11:55.190933 [debug] [ThreadPool]: Using duckdb connection "create_casestudy_core"
[0m08:11:55.191285 [debug] [ThreadPool]: On create_casestudy_core: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "create_casestudy_core"} */
create schema if not exists "casestudy"."core"
[0m08:11:55.192077 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m08:11:55.193036 [debug] [ThreadPool]: On create_casestudy_core: COMMIT
[0m08:11:55.193362 [debug] [ThreadPool]: Using duckdb connection "create_casestudy_core"
[0m08:11:55.193666 [debug] [ThreadPool]: On create_casestudy_core: COMMIT
[0m08:11:55.194303 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m08:11:55.194703 [debug] [ThreadPool]: On create_casestudy_core: Close
[0m08:11:55.200983 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_casestudy_core, now list_casestudy_intermediate)
[0m08:11:55.207419 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_intermediate"
[0m08:11:55.207864 [debug] [ThreadPool]: On list_casestudy_intermediate: BEGIN
[0m08:11:55.208168 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:11:55.219826 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m08:11:55.220238 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_intermediate"
[0m08:11:55.220571 [debug] [ThreadPool]: On list_casestudy_intermediate: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_intermediate"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'intermediate'
    and table_catalog = 'casestudy'
  
[0m08:11:55.232087 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m08:11:55.234235 [debug] [ThreadPool]: On list_casestudy_intermediate: ROLLBACK
[0m08:11:55.235167 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_intermediate'
[0m08:11:55.235562 [debug] [ThreadPool]: On list_casestudy_intermediate: Close
[0m08:11:55.238604 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy_intermediate, now list_casestudy_staging)
[0m08:11:55.242054 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_staging"
[0m08:11:55.242390 [debug] [ThreadPool]: On list_casestudy_staging: BEGIN
[0m08:11:55.242654 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:11:55.254950 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m08:11:55.255409 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_staging"
[0m08:11:55.255726 [debug] [ThreadPool]: On list_casestudy_staging: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_staging"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'staging'
    and table_catalog = 'casestudy'
  
[0m08:11:55.265077 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m08:11:55.266455 [debug] [ThreadPool]: On list_casestudy_staging: ROLLBACK
[0m08:11:55.267022 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_staging'
[0m08:11:55.267317 [debug] [ThreadPool]: On list_casestudy_staging: Close
[0m08:11:55.270146 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy_staging, now list_casestudy_raw)
[0m08:11:55.273539 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_raw"
[0m08:11:55.273892 [debug] [ThreadPool]: On list_casestudy_raw: BEGIN
[0m08:11:55.274154 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:11:55.284724 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m08:11:55.285334 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_raw"
[0m08:11:55.285662 [debug] [ThreadPool]: On list_casestudy_raw: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_raw"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'raw'
    and table_catalog = 'casestudy'
  
[0m08:11:55.293870 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m08:11:55.295187 [debug] [ThreadPool]: On list_casestudy_raw: ROLLBACK
[0m08:11:55.295699 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_raw'
[0m08:11:55.295955 [debug] [ThreadPool]: On list_casestudy_raw: Close
[0m08:11:55.298764 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy_raw, now list_casestudy_core)
[0m08:11:55.301047 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_core"
[0m08:11:55.302616 [debug] [ThreadPool]: On list_casestudy_core: BEGIN
[0m08:11:55.302920 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:11:55.314212 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m08:11:55.314575 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_core"
[0m08:11:55.314905 [debug] [ThreadPool]: On list_casestudy_core: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_core"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'core'
    and table_catalog = 'casestudy'
  
[0m08:11:55.323348 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m08:11:55.324668 [debug] [ThreadPool]: On list_casestudy_core: ROLLBACK
[0m08:11:55.325137 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_core'
[0m08:11:55.325395 [debug] [ThreadPool]: On list_casestudy_core: Close
[0m08:11:55.328563 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5e3d34e4-f51e-4a3c-bab2-4e46e24d5996', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f45c7f50950>]}
[0m08:11:55.329059 [debug] [MainThread]: Using duckdb connection "master"
[0m08:11:55.329352 [debug] [MainThread]: On master: BEGIN
[0m08:11:55.329629 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:11:55.343449 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m08:11:55.343861 [debug] [MainThread]: On master: COMMIT
[0m08:11:55.344135 [debug] [MainThread]: Using duckdb connection "master"
[0m08:11:55.344395 [debug] [MainThread]: On master: COMMIT
[0m08:11:55.344988 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m08:11:55.345311 [debug] [MainThread]: On master: Close
[0m08:11:55.347975 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m08:11:55.348499 [info ] [MainThread]: 
[0m08:11:55.351231 [debug] [Thread-1 (]: Began running node model.vg_casestudy.core__customers_enriched
[0m08:11:55.351691 [info ] [Thread-1 (]: 1 of 1 START sql view model core.core__customers_enriched ...................... [RUN]
[0m08:11:55.352453 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.vg_casestudy.core__customers_enriched'
[0m08:11:55.352766 [debug] [Thread-1 (]: Began compiling node model.vg_casestudy.core__customers_enriched
[0m08:11:55.361076 [debug] [Thread-1 (]: Writing injected SQL for node "model.vg_casestudy.core__customers_enriched"
[0m08:11:55.361833 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.core__customers_enriched (compile): 08:11:55.352996 => 08:11:55.361611
[0m08:11:55.362210 [debug] [Thread-1 (]: Began executing node model.vg_casestudy.core__customers_enriched
[0m08:11:55.392729 [debug] [Thread-1 (]: Writing runtime sql for node "model.vg_casestudy.core__customers_enriched"
[0m08:11:55.393384 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.core__customers_enriched"
[0m08:11:55.393794 [debug] [Thread-1 (]: On model.vg_casestudy.core__customers_enriched: BEGIN
[0m08:11:55.394110 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m08:11:55.409635 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m08:11:55.410082 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.core__customers_enriched"
[0m08:11:55.410468 [debug] [Thread-1 (]: On model.vg_casestudy.core__customers_enriched: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.core__customers_enriched"} */

  
  create view "casestudy"."core"."core__customers_enriched__dbt_tmp" as (
    with customers as (
    select *
    from "casestudy"."intermediate"."stg_staging_intermediate__customers"
),

accounts as (
    select *
    from "casestudy"."intermediate"."stg_staging_intermediate__accounts"
),

branch_names as (
    select *
    from "casestudy"."intermediate"."intermediate__branch_names"
),


joined as (
    select 
        customers.customer_id,
        customers.firstname,
        customers.lastname,
        customers.age,
        customers.branch_id,
        branch_names.branch_name,
        accounts.account_id,
        accounts.account_type,
        accounts.account_opening_date,
        case 
            when accounts.account_id is null then false
            else true
        end as has_account

    from customers
    left join accounts
    on customers.customer_id = accounts.customer_id
    left join branch_names
    on customers.branch_id = branch_names.branch_id
)

select *
from joined
  );

[0m08:11:55.411797 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m08:11:55.418395 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.core__customers_enriched"
[0m08:11:55.419009 [debug] [Thread-1 (]: On model.vg_casestudy.core__customers_enriched: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.core__customers_enriched"} */
alter view "casestudy"."core"."core__customers_enriched" rename to "core__customers_enriched__dbt_backup"
[0m08:11:55.420052 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m08:11:55.424856 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.core__customers_enriched"
[0m08:11:55.425318 [debug] [Thread-1 (]: On model.vg_casestudy.core__customers_enriched: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.core__customers_enriched"} */
alter view "casestudy"."core"."core__customers_enriched__dbt_tmp" rename to "core__customers_enriched"
[0m08:11:55.426283 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m08:11:55.442696 [debug] [Thread-1 (]: On model.vg_casestudy.core__customers_enriched: COMMIT
[0m08:11:55.443306 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.core__customers_enriched"
[0m08:11:55.443806 [debug] [Thread-1 (]: On model.vg_casestudy.core__customers_enriched: COMMIT
[0m08:11:55.447388 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m08:11:55.452939 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.core__customers_enriched"
[0m08:11:55.453407 [debug] [Thread-1 (]: On model.vg_casestudy.core__customers_enriched: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.core__customers_enriched"} */
drop view if exists "casestudy"."core"."core__customers_enriched__dbt_backup" cascade
[0m08:11:55.457395 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m08:11:55.458985 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.core__customers_enriched (execute): 08:11:55.362469 => 08:11:55.458776
[0m08:11:55.459373 [debug] [Thread-1 (]: On model.vg_casestudy.core__customers_enriched: Close
[0m08:11:55.488707 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5e3d34e4-f51e-4a3c-bab2-4e46e24d5996', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f45c3ca0990>]}
[0m08:11:55.489408 [info ] [Thread-1 (]: 1 of 1 OK created sql view model core.core__customers_enriched ................. [[32mOK[0m in 0.14s]
[0m08:11:55.490080 [debug] [Thread-1 (]: Finished running node model.vg_casestudy.core__customers_enriched
[0m08:11:55.492022 [debug] [MainThread]: Using duckdb connection "master"
[0m08:11:55.492424 [debug] [MainThread]: On master: BEGIN
[0m08:11:55.492704 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:11:55.506129 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m08:11:55.506822 [debug] [MainThread]: On master: COMMIT
[0m08:11:55.507558 [debug] [MainThread]: Using duckdb connection "master"
[0m08:11:55.507896 [debug] [MainThread]: On master: COMMIT
[0m08:11:55.508533 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m08:11:55.508838 [debug] [MainThread]: On master: Close
[0m08:11:55.511909 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:11:55.512325 [debug] [MainThread]: Connection 'list_casestudy_core' was properly closed.
[0m08:11:55.512600 [debug] [MainThread]: Connection 'model.vg_casestudy.core__customers_enriched' was properly closed.
[0m08:11:55.512919 [info ] [MainThread]: 
[0m08:11:55.513271 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.39 seconds (0.39s).
[0m08:11:55.513855 [debug] [MainThread]: Command end result
[0m08:11:55.532900 [info ] [MainThread]: 
[0m08:11:55.533424 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:11:55.533744 [info ] [MainThread]: 
[0m08:11:55.534066 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m08:11:55.534544 [debug] [MainThread]: Command `dbt run` succeeded at 08:11:55.534435 after 0.80 seconds
[0m08:11:55.535035 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f45cca5b150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f45cca5a510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f45cca5b6d0>]}
[0m08:11:55.535519 [debug] [MainThread]: Flushing usage events
[0m08:12:06.807091 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff87cd37810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff87d354cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff87d028750>]}


============================== 08:12:06.809569 | b16d949a-cf2f-46a3-a7e2-efd2b0687a74 ==============================
[0m08:12:06.809569 [info ] [MainThread]: Running with dbt=1.6.18
[0m08:12:06.810133 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/workspaces/vg_case_study_tim/transformation/logs', 'debug': 'False', 'profiles_dir': '/workspaces/vg_case_study_tim/transformation', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt test --select core__customers_enriched', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m08:12:06.906186 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b16d949a-cf2f-46a3-a7e2-efd2b0687a74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff87d02a550>]}
[0m08:12:06.920140 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b16d949a-cf2f-46a3-a7e2-efd2b0687a74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff87d333b50>]}
[0m08:12:06.920851 [info ] [MainThread]: Registered adapter: duckdb=1.6.2
[0m08:12:06.946799 [debug] [MainThread]: checksum: 7b9fab86a08e9e96a48a825af743c566d95b877e068b8c6d0dbafbf714447189, vars: {}, profile: , target: , version: 1.6.18
[0m08:12:06.991997 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:12:06.992443 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:12:06.993899 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.vg_casestudy.reporting
- models.vg_casestudy.marts
- models.vg_casestudy.main
[0m08:12:07.002118 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b16d949a-cf2f-46a3-a7e2-efd2b0687a74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff87d204b10>]}
[0m08:12:07.077115 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b16d949a-cf2f-46a3-a7e2-efd2b0687a74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff87cd45f50>]}
[0m08:12:07.077697 [info ] [MainThread]: Found 15 models, 1 analysis, 4 seeds, 97 tests, 5 sources, 0 exposures, 0 metrics, 632 macros, 0 groups, 0 semantic models
[0m08:12:07.078103 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b16d949a-cf2f-46a3-a7e2-efd2b0687a74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff878ad3950>]}
[0m08:12:07.080728 [info ] [MainThread]: 
[0m08:12:07.081586 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m08:12:07.083653 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_casestudy_intermediate'
[0m08:12:07.095693 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_intermediate"
[0m08:12:07.096201 [debug] [ThreadPool]: On list_casestudy_intermediate: BEGIN
[0m08:12:07.096538 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:12:07.114745 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m08:12:07.115208 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_intermediate"
[0m08:12:07.115532 [debug] [ThreadPool]: On list_casestudy_intermediate: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_intermediate"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'intermediate'
    and table_catalog = 'casestudy'
  
[0m08:12:07.126517 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m08:12:07.128263 [debug] [ThreadPool]: On list_casestudy_intermediate: ROLLBACK
[0m08:12:07.129005 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_intermediate'
[0m08:12:07.129331 [debug] [ThreadPool]: On list_casestudy_intermediate: Close
[0m08:12:07.132463 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy_intermediate, now list_casestudy_core)
[0m08:12:07.136487 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_core"
[0m08:12:07.137078 [debug] [ThreadPool]: On list_casestudy_core: BEGIN
[0m08:12:07.137415 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:12:07.150515 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m08:12:07.150950 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_core"
[0m08:12:07.151270 [debug] [ThreadPool]: On list_casestudy_core: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_core"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'core'
    and table_catalog = 'casestudy'
  
[0m08:12:07.160777 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m08:12:07.162222 [debug] [ThreadPool]: On list_casestudy_core: ROLLBACK
[0m08:12:07.162742 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_core'
[0m08:12:07.163061 [debug] [ThreadPool]: On list_casestudy_core: Close
[0m08:12:07.167615 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy_core, now list_casestudy_staging)
[0m08:12:07.170891 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_staging"
[0m08:12:07.171325 [debug] [ThreadPool]: On list_casestudy_staging: BEGIN
[0m08:12:07.171604 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:12:07.182929 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m08:12:07.183373 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_staging"
[0m08:12:07.183666 [debug] [ThreadPool]: On list_casestudy_staging: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_staging"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'staging'
    and table_catalog = 'casestudy'
  
[0m08:12:07.192273 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m08:12:07.193623 [debug] [ThreadPool]: On list_casestudy_staging: ROLLBACK
[0m08:12:07.194088 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_staging'
[0m08:12:07.194348 [debug] [ThreadPool]: On list_casestudy_staging: Close
[0m08:12:07.197339 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy_staging, now list_casestudy_raw)
[0m08:12:07.200009 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_raw"
[0m08:12:07.201376 [debug] [ThreadPool]: On list_casestudy_raw: BEGIN
[0m08:12:07.201695 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:12:07.213642 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m08:12:07.214027 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_raw"
[0m08:12:07.214314 [debug] [ThreadPool]: On list_casestudy_raw: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_raw"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'raw'
    and table_catalog = 'casestudy'
  
[0m08:12:07.223105 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m08:12:07.224492 [debug] [ThreadPool]: On list_casestudy_raw: ROLLBACK
[0m08:12:07.224964 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_raw'
[0m08:12:07.225227 [debug] [ThreadPool]: On list_casestudy_raw: Close
[0m08:12:07.229236 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b16d949a-cf2f-46a3-a7e2-efd2b0687a74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff878b5aa10>]}
[0m08:12:07.229704 [debug] [MainThread]: Using duckdb connection "master"
[0m08:12:07.229999 [debug] [MainThread]: On master: BEGIN
[0m08:12:07.230261 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:12:07.242192 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m08:12:07.242607 [debug] [MainThread]: On master: COMMIT
[0m08:12:07.242919 [debug] [MainThread]: Using duckdb connection "master"
[0m08:12:07.243189 [debug] [MainThread]: On master: COMMIT
[0m08:12:07.243769 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m08:12:07.244052 [debug] [MainThread]: On master: Close
[0m08:12:07.246376 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m08:12:07.246887 [info ] [MainThread]: 
[0m08:12:07.249352 [debug] [Thread-1 (]: Began running node test.vg_casestudy.not_null_core__customers_enriched_customer_id.1243948ba4
[0m08:12:07.249722 [info ] [Thread-1 (]: 1 of 3 START test not_null_core__customers_enriched_customer_id ................ [RUN]
[0m08:12:07.250657 [debug] [Thread-1 (]: Acquiring new duckdb connection 'test.vg_casestudy.not_null_core__customers_enriched_customer_id.1243948ba4'
[0m08:12:07.251144 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.not_null_core__customers_enriched_customer_id.1243948ba4
[0m08:12:07.271970 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.not_null_core__customers_enriched_customer_id.1243948ba4"
[0m08:12:07.272752 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_core__customers_enriched_customer_id.1243948ba4 (compile): 08:12:07.251386 => 08:12:07.272527
[0m08:12:07.273126 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.not_null_core__customers_enriched_customer_id.1243948ba4
[0m08:12:07.285941 [debug] [Thread-1 (]: Writing runtime sql for node "test.vg_casestudy.not_null_core__customers_enriched_customer_id.1243948ba4"
[0m08:12:07.286637 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.not_null_core__customers_enriched_customer_id.1243948ba4"
[0m08:12:07.287077 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_core__customers_enriched_customer_id.1243948ba4: BEGIN
[0m08:12:07.287385 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m08:12:07.302401 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m08:12:07.302921 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.not_null_core__customers_enriched_customer_id.1243948ba4"
[0m08:12:07.303365 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_core__customers_enriched_customer_id.1243948ba4: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "test.vg_casestudy.not_null_core__customers_enriched_customer_id.1243948ba4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from "casestudy"."core"."core__customers_enriched"
where customer_id is null



      
    ) dbt_internal_test
[0m08:12:07.314175 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m08:12:07.317608 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_core__customers_enriched_customer_id.1243948ba4 (execute): 08:12:07.273402 => 08:12:07.317336
[0m08:12:07.318156 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_core__customers_enriched_customer_id.1243948ba4: ROLLBACK
[0m08:12:07.318789 [debug] [Thread-1 (]: Failed to rollback 'test.vg_casestudy.not_null_core__customers_enriched_customer_id.1243948ba4'
[0m08:12:07.319252 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_core__customers_enriched_customer_id.1243948ba4: Close
[0m08:12:07.322432 [info ] [Thread-1 (]: 1 of 3 PASS not_null_core__customers_enriched_customer_id ...................... [[32mPASS[0m in 0.07s]
[0m08:12:07.323106 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.not_null_core__customers_enriched_customer_id.1243948ba4
[0m08:12:07.323543 [debug] [Thread-1 (]: Began running node test.vg_casestudy.not_null_core__customers_enriched_has_account.ca9073011d
[0m08:12:07.324040 [info ] [Thread-1 (]: 2 of 3 START test not_null_core__customers_enriched_has_account ................ [RUN]
[0m08:12:07.324821 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.not_null_core__customers_enriched_customer_id.1243948ba4, now test.vg_casestudy.not_null_core__customers_enriched_has_account.ca9073011d)
[0m08:12:07.325185 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.not_null_core__customers_enriched_has_account.ca9073011d
[0m08:12:07.329756 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.not_null_core__customers_enriched_has_account.ca9073011d"
[0m08:12:07.330545 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_core__customers_enriched_has_account.ca9073011d (compile): 08:12:07.325418 => 08:12:07.330310
[0m08:12:07.330924 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.not_null_core__customers_enriched_has_account.ca9073011d
[0m08:12:07.333866 [debug] [Thread-1 (]: Writing runtime sql for node "test.vg_casestudy.not_null_core__customers_enriched_has_account.ca9073011d"
[0m08:12:07.334562 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.not_null_core__customers_enriched_has_account.ca9073011d"
[0m08:12:07.334940 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_core__customers_enriched_has_account.ca9073011d: BEGIN
[0m08:12:07.335250 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:12:07.348148 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m08:12:07.348630 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.not_null_core__customers_enriched_has_account.ca9073011d"
[0m08:12:07.348980 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_core__customers_enriched_has_account.ca9073011d: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "test.vg_casestudy.not_null_core__customers_enriched_has_account.ca9073011d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select has_account
from "casestudy"."core"."core__customers_enriched"
where has_account is null



      
    ) dbt_internal_test
[0m08:12:07.355349 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m08:12:07.357280 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_core__customers_enriched_has_account.ca9073011d (execute): 08:12:07.331255 => 08:12:07.357061
[0m08:12:07.357681 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_core__customers_enriched_has_account.ca9073011d: ROLLBACK
[0m08:12:07.358160 [debug] [Thread-1 (]: Failed to rollback 'test.vg_casestudy.not_null_core__customers_enriched_has_account.ca9073011d'
[0m08:12:07.358490 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_core__customers_enriched_has_account.ca9073011d: Close
[0m08:12:07.361097 [info ] [Thread-1 (]: 2 of 3 PASS not_null_core__customers_enriched_has_account ...................... [[32mPASS[0m in 0.04s]
[0m08:12:07.361728 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.not_null_core__customers_enriched_has_account.ca9073011d
[0m08:12:07.362159 [debug] [Thread-1 (]: Began running node test.vg_casestudy.unique_core__customers_enriched_customer_id.5c411c2b35
[0m08:12:07.362719 [info ] [Thread-1 (]: 3 of 3 START test unique_core__customers_enriched_customer_id .................. [RUN]
[0m08:12:07.363448 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.not_null_core__customers_enriched_has_account.ca9073011d, now test.vg_casestudy.unique_core__customers_enriched_customer_id.5c411c2b35)
[0m08:12:07.363809 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.unique_core__customers_enriched_customer_id.5c411c2b35
[0m08:12:07.371057 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.unique_core__customers_enriched_customer_id.5c411c2b35"
[0m08:12:07.371950 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.unique_core__customers_enriched_customer_id.5c411c2b35 (compile): 08:12:07.364030 => 08:12:07.371670
[0m08:12:07.372386 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.unique_core__customers_enriched_customer_id.5c411c2b35
[0m08:12:07.375500 [debug] [Thread-1 (]: Writing runtime sql for node "test.vg_casestudy.unique_core__customers_enriched_customer_id.5c411c2b35"
[0m08:12:07.376689 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.unique_core__customers_enriched_customer_id.5c411c2b35"
[0m08:12:07.377381 [debug] [Thread-1 (]: On test.vg_casestudy.unique_core__customers_enriched_customer_id.5c411c2b35: BEGIN
[0m08:12:07.378040 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:12:07.392711 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m08:12:07.393256 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.unique_core__customers_enriched_customer_id.5c411c2b35"
[0m08:12:07.393804 [debug] [Thread-1 (]: On test.vg_casestudy.unique_core__customers_enriched_customer_id.5c411c2b35: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "test.vg_casestudy.unique_core__customers_enriched_customer_id.5c411c2b35"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from "casestudy"."core"."core__customers_enriched"
where customer_id is not null
group by customer_id
having count(*) > 1



      
    ) dbt_internal_test
[0m08:12:07.402764 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m08:12:07.404608 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.unique_core__customers_enriched_customer_id.5c411c2b35 (execute): 08:12:07.372719 => 08:12:07.404379
[0m08:12:07.405015 [debug] [Thread-1 (]: On test.vg_casestudy.unique_core__customers_enriched_customer_id.5c411c2b35: ROLLBACK
[0m08:12:07.405501 [debug] [Thread-1 (]: Failed to rollback 'test.vg_casestudy.unique_core__customers_enriched_customer_id.5c411c2b35'
[0m08:12:07.405844 [debug] [Thread-1 (]: On test.vg_casestudy.unique_core__customers_enriched_customer_id.5c411c2b35: Close
[0m08:12:07.408977 [info ] [Thread-1 (]: 3 of 3 PASS unique_core__customers_enriched_customer_id ........................ [[32mPASS[0m in 0.05s]
[0m08:12:07.409609 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.unique_core__customers_enriched_customer_id.5c411c2b35
[0m08:12:07.411580 [debug] [MainThread]: Using duckdb connection "master"
[0m08:12:07.411916 [debug] [MainThread]: On master: BEGIN
[0m08:12:07.412193 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:12:07.426481 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m08:12:07.427114 [debug] [MainThread]: On master: COMMIT
[0m08:12:07.427432 [debug] [MainThread]: Using duckdb connection "master"
[0m08:12:07.427788 [debug] [MainThread]: On master: COMMIT
[0m08:12:07.428704 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m08:12:07.429126 [debug] [MainThread]: On master: Close
[0m08:12:07.432096 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:12:07.432491 [debug] [MainThread]: Connection 'list_casestudy_raw' was properly closed.
[0m08:12:07.432755 [debug] [MainThread]: Connection 'test.vg_casestudy.unique_core__customers_enriched_customer_id.5c411c2b35' was properly closed.
[0m08:12:07.433097 [info ] [MainThread]: 
[0m08:12:07.433443 [info ] [MainThread]: Finished running 3 tests in 0 hours 0 minutes and 0.35 seconds (0.35s).
[0m08:12:07.434249 [debug] [MainThread]: Command end result
[0m08:12:07.456850 [info ] [MainThread]: 
[0m08:12:07.457360 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:12:07.457712 [info ] [MainThread]: 
[0m08:12:07.458083 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m08:12:07.458616 [debug] [MainThread]: Command `dbt test` succeeded at 08:12:07.458511 after 0.66 seconds
[0m08:12:07.459223 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff881942590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8819d6250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8819d7410>]}
[0m08:12:07.461308 [debug] [MainThread]: Flushing usage events
[0m09:19:26.149740 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4f9175250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4f9024bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4f913d010>]}


============================== 09:19:26.154418 | 13143ee3-d30b-49b3-a1e5-2d855eee7267 ==============================
[0m09:19:26.154418 [info ] [MainThread]: Running with dbt=1.6.18
[0m09:19:26.154961 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/workspaces/vg_case_study_tim/transformation', 'debug': 'False', 'warn_error': 'None', 'log_path': '/workspaces/vg_case_study_tim/transformation/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --select core__loans_enriched --full-refresh', 'send_anonymous_usage_stats': 'True'}
[0m09:19:26.360327 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '13143ee3-d30b-49b3-a1e5-2d855eee7267', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4f8d03890>]}
[0m09:19:26.375714 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '13143ee3-d30b-49b3-a1e5-2d855eee7267', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4f5483d10>]}
[0m09:19:26.377234 [info ] [MainThread]: Registered adapter: duckdb=1.6.2
[0m09:19:26.409768 [debug] [MainThread]: checksum: 7b9fab86a08e9e96a48a825af743c566d95b877e068b8c6d0dbafbf714447189, vars: {}, profile: , target: , version: 1.6.18
[0m09:19:26.537237 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 3 files changed.
[0m09:19:26.538345 [debug] [MainThread]: Partial parsing: added file: vg_casestudy://models/core/core__loans_enriched.yml
[0m09:19:26.539025 [debug] [MainThread]: Partial parsing: added file: vg_casestudy://models/core/core__loans_enriched.sql
[0m09:19:26.540102 [debug] [MainThread]: Partial parsing: updated file: vg_casestudy://models/core/core__customers_enriched.yml
[0m09:19:26.540865 [debug] [MainThread]: Partial parsing: updated file: vg_casestudy://models/core/core__transactions_with_euro.yml
[0m09:19:26.541441 [debug] [MainThread]: Partial parsing: updated file: vg_casestudy://seeds/branch_names.yml
[0m09:19:26.783385 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.vg_casestudy.marts
- models.vg_casestudy.reporting
- models.vg_casestudy.main
[0m09:19:26.790787 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '13143ee3-d30b-49b3-a1e5-2d855eee7267', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4f4bf3550>]}
[0m09:19:26.827473 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '13143ee3-d30b-49b3-a1e5-2d855eee7267', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4f4a03790>]}
[0m09:19:26.828103 [info ] [MainThread]: Found 16 models, 1 analysis, 4 seeds, 112 tests, 5 sources, 0 exposures, 0 metrics, 632 macros, 0 groups, 0 semantic models
[0m09:19:26.828531 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '13143ee3-d30b-49b3-a1e5-2d855eee7267', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4f4a9a4d0>]}
[0m09:19:26.832832 [info ] [MainThread]: 
[0m09:19:26.833840 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m09:19:26.835183 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_casestudy'
[0m09:19:26.850032 [debug] [ThreadPool]: Using duckdb connection "list_casestudy"
[0m09:19:26.850501 [debug] [ThreadPool]: On list_casestudy: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"casestudy"'
    
  
  
[0m09:19:26.850828 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:19:26.975902 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m09:19:26.977477 [debug] [ThreadPool]: On list_casestudy: Close
[0m09:19:26.983361 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy, now create_casestudy_core)
[0m09:19:26.984139 [debug] [ThreadPool]: Creating schema "database: "casestudy"
schema: "core"
"
[0m09:19:26.988536 [debug] [ThreadPool]: Using duckdb connection "create_casestudy_core"
[0m09:19:26.988942 [debug] [ThreadPool]: On create_casestudy_core: BEGIN
[0m09:19:26.989215 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:19:27.001686 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m09:19:27.002125 [debug] [ThreadPool]: Using duckdb connection "create_casestudy_core"
[0m09:19:27.002527 [debug] [ThreadPool]: On create_casestudy_core: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "create_casestudy_core"} */
create schema if not exists "casestudy"."core"
[0m09:19:27.003488 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m09:19:27.004495 [debug] [ThreadPool]: On create_casestudy_core: COMMIT
[0m09:19:27.004810 [debug] [ThreadPool]: Using duckdb connection "create_casestudy_core"
[0m09:19:27.005084 [debug] [ThreadPool]: On create_casestudy_core: COMMIT
[0m09:19:27.005818 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m09:19:27.006154 [debug] [ThreadPool]: On create_casestudy_core: Close
[0m09:19:27.012495 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_casestudy_core, now list_casestudy_staging)
[0m09:19:27.018302 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_staging"
[0m09:19:27.018696 [debug] [ThreadPool]: On list_casestudy_staging: BEGIN
[0m09:19:27.018981 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:19:27.030176 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m09:19:27.030584 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_staging"
[0m09:19:27.030900 [debug] [ThreadPool]: On list_casestudy_staging: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_staging"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'staging'
    and table_catalog = 'casestudy'
  
[0m09:19:27.046560 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m09:19:27.048196 [debug] [ThreadPool]: On list_casestudy_staging: ROLLBACK
[0m09:19:27.049762 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_staging'
[0m09:19:27.050081 [debug] [ThreadPool]: On list_casestudy_staging: Close
[0m09:19:27.053045 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy_staging, now list_casestudy_raw)
[0m09:19:27.055245 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_raw"
[0m09:19:27.055609 [debug] [ThreadPool]: On list_casestudy_raw: BEGIN
[0m09:19:27.055906 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:19:27.066736 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m09:19:27.067091 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_raw"
[0m09:19:27.067396 [debug] [ThreadPool]: On list_casestudy_raw: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_raw"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'raw'
    and table_catalog = 'casestudy'
  
[0m09:19:27.075920 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m09:19:27.077299 [debug] [ThreadPool]: On list_casestudy_raw: ROLLBACK
[0m09:19:27.077770 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_raw'
[0m09:19:27.078034 [debug] [ThreadPool]: On list_casestudy_raw: Close
[0m09:19:27.080805 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy_raw, now list_casestudy_intermediate)
[0m09:19:27.083053 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_intermediate"
[0m09:19:27.083393 [debug] [ThreadPool]: On list_casestudy_intermediate: BEGIN
[0m09:19:27.083717 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:19:27.095168 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m09:19:27.095566 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_intermediate"
[0m09:19:27.095860 [debug] [ThreadPool]: On list_casestudy_intermediate: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_intermediate"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'intermediate'
    and table_catalog = 'casestudy'
  
[0m09:19:27.105478 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m09:19:27.106801 [debug] [ThreadPool]: On list_casestudy_intermediate: ROLLBACK
[0m09:19:27.107259 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_intermediate'
[0m09:19:27.107517 [debug] [ThreadPool]: On list_casestudy_intermediate: Close
[0m09:19:27.110435 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy_intermediate, now list_casestudy_core)
[0m09:19:27.112654 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_core"
[0m09:19:27.113032 [debug] [ThreadPool]: On list_casestudy_core: BEGIN
[0m09:19:27.113316 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:19:27.124172 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m09:19:27.124558 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_core"
[0m09:19:27.124847 [debug] [ThreadPool]: On list_casestudy_core: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_core"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'core'
    and table_catalog = 'casestudy'
  
[0m09:19:27.132729 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m09:19:27.133946 [debug] [ThreadPool]: On list_casestudy_core: ROLLBACK
[0m09:19:27.134394 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_core'
[0m09:19:27.134748 [debug] [ThreadPool]: On list_casestudy_core: Close
[0m09:19:27.138046 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '13143ee3-d30b-49b3-a1e5-2d855eee7267', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4f8e27390>]}
[0m09:19:27.138514 [debug] [MainThread]: Using duckdb connection "master"
[0m09:19:27.138792 [debug] [MainThread]: On master: BEGIN
[0m09:19:27.139044 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:19:27.151447 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m09:19:27.151912 [debug] [MainThread]: On master: COMMIT
[0m09:19:27.152253 [debug] [MainThread]: Using duckdb connection "master"
[0m09:19:27.152547 [debug] [MainThread]: On master: COMMIT
[0m09:19:27.153386 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m09:19:27.153759 [debug] [MainThread]: On master: Close
[0m09:19:27.156901 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:19:27.157473 [info ] [MainThread]: 
[0m09:19:27.161167 [debug] [Thread-1 (]: Began running node model.vg_casestudy.core__loans_enriched
[0m09:19:27.161792 [info ] [Thread-1 (]: 1 of 1 START sql view model core.core__loans_enriched .......................... [RUN]
[0m09:19:27.162748 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.vg_casestudy.core__loans_enriched'
[0m09:19:27.163165 [debug] [Thread-1 (]: Began compiling node model.vg_casestudy.core__loans_enriched
[0m09:19:27.175410 [debug] [Thread-1 (]: Writing injected SQL for node "model.vg_casestudy.core__loans_enriched"
[0m09:19:27.176463 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.core__loans_enriched (compile): 09:19:27.163407 => 09:19:27.176121
[0m09:19:27.176926 [debug] [Thread-1 (]: Began executing node model.vg_casestudy.core__loans_enriched
[0m09:19:27.210226 [debug] [Thread-1 (]: Writing runtime sql for node "model.vg_casestudy.core__loans_enriched"
[0m09:19:27.211095 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.core__loans_enriched"
[0m09:19:27.211485 [debug] [Thread-1 (]: On model.vg_casestudy.core__loans_enriched: BEGIN
[0m09:19:27.211810 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m09:19:27.225383 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:19:27.225862 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.core__loans_enriched"
[0m09:19:27.226254 [debug] [Thread-1 (]: On model.vg_casestudy.core__loans_enriched: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.core__loans_enriched"} */

  
  create view "casestudy"."core"."core__loans_enriched__dbt_tmp" as (
    with loans as (
    select *
    from "casestudy"."intermediate"."stg_staging_intermediate__loans"
),

customers_enriched as (
    select *
    from "casestudy"."core"."core__customers_enriched"
),

joined (
    select
        loans.loan_id,
        loans.customer_id,
        customers_enriched.firstname,
        customers_enriched.lastname,
        customers_enriched.age,
        customers_enriched.branch_id,
        customers_enriched.branch_name,
        customers_enriched.account_id,
        customers_enriched.account_type,
        customers_enriched.account_opening_date,
        customers_enriched.has_account,
        loans.loan_type,
        loans.loan_amount,
        loans.interest_rate,
        loans.loan_term,
        loans.loan_status,
        loans.approval_rejection_date

    from loans
    left join customers_enriched
        on loans.customer_id = customers_enriched.customer_id    
)

select * 
from joined
  );

[0m09:19:27.238643 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.core__loans_enriched (execute): 09:19:27.177201 => 09:19:27.238337
[0m09:19:27.239196 [debug] [Thread-1 (]: On model.vg_casestudy.core__loans_enriched: ROLLBACK
[0m09:19:27.247429 [debug] [Thread-1 (]: Failed to rollback 'model.vg_casestudy.core__loans_enriched'
[0m09:19:27.247908 [debug] [Thread-1 (]: On model.vg_casestudy.core__loans_enriched: Close
[0m09:19:27.251915 [debug] [Thread-1 (]: Runtime Error in model core__loans_enriched (models/core/core__loans_enriched.sql)
  Parser Error: syntax error at or near "select"
[0m09:19:27.252458 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '13143ee3-d30b-49b3-a1e5-2d855eee7267', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4f8bc9c50>]}
[0m09:19:27.253100 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model core.core__loans_enriched ................. [[31mERROR[0m in 0.09s]
[0m09:19:27.253681 [debug] [Thread-1 (]: Finished running node model.vg_casestudy.core__loans_enriched
[0m09:19:27.256145 [debug] [MainThread]: Using duckdb connection "master"
[0m09:19:27.256619 [debug] [MainThread]: On master: BEGIN
[0m09:19:27.256913 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:19:27.272234 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m09:19:27.272743 [debug] [MainThread]: On master: COMMIT
[0m09:19:27.273099 [debug] [MainThread]: Using duckdb connection "master"
[0m09:19:27.273405 [debug] [MainThread]: On master: COMMIT
[0m09:19:27.274221 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m09:19:27.274647 [debug] [MainThread]: On master: Close
[0m09:19:27.277203 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:19:27.277608 [debug] [MainThread]: Connection 'list_casestudy_core' was properly closed.
[0m09:19:27.277883 [debug] [MainThread]: Connection 'model.vg_casestudy.core__loans_enriched' was properly closed.
[0m09:19:27.278266 [info ] [MainThread]: 
[0m09:19:27.278680 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.44 seconds (0.44s).
[0m09:19:27.279351 [debug] [MainThread]: Command end result
[0m09:19:27.302447 [info ] [MainThread]: 
[0m09:19:27.302994 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m09:19:27.303348 [info ] [MainThread]: 
[0m09:19:27.303653 [error] [MainThread]:   Runtime Error in model core__loans_enriched (models/core/core__loans_enriched.sql)
  Parser Error: syntax error at or near "select"
[0m09:19:27.303959 [info ] [MainThread]: 
[0m09:19:27.304279 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m09:19:27.304757 [debug] [MainThread]: Command `dbt run` failed at 09:19:27.304655 after 1.16 seconds
[0m09:19:27.305130 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4fb37d8d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4fd77ff90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4f8be6a10>]}
[0m09:19:27.305488 [debug] [MainThread]: Flushing usage events
[0m09:20:49.026085 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68a4a8eb90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68a4a781d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68a4804390>]}


============================== 09:20:49.031568 | a2954b20-51a3-4aa1-a673-aa6f14ca07f8 ==============================
[0m09:20:49.031568 [info ] [MainThread]: Running with dbt=1.6.18
[0m09:20:49.032282 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/workspaces/vg_case_study_tim/transformation', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/workspaces/vg_case_study_tim/transformation/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run --select core__loans_enriched --full-refresh', 'send_anonymous_usage_stats': 'True'}
[0m09:20:49.272314 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a2954b20-51a3-4aa1-a673-aa6f14ca07f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68a4749190>]}
[0m09:20:49.306263 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a2954b20-51a3-4aa1-a673-aa6f14ca07f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68a4a88bd0>]}
[0m09:20:49.308173 [info ] [MainThread]: Registered adapter: duckdb=1.6.2
[0m09:20:49.349974 [debug] [MainThread]: checksum: 7b9fab86a08e9e96a48a825af743c566d95b877e068b8c6d0dbafbf714447189, vars: {}, profile: , target: , version: 1.6.18
[0m09:20:49.458252 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:20:49.459283 [debug] [MainThread]: Partial parsing: updated file: vg_casestudy://models/core/core__loans_enriched.sql
[0m09:20:49.666950 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.vg_casestudy.marts
- models.vg_casestudy.main
- models.vg_casestudy.reporting
[0m09:20:49.674682 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a2954b20-51a3-4aa1-a673-aa6f14ca07f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68a0563750>]}
[0m09:20:49.712963 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a2954b20-51a3-4aa1-a673-aa6f14ca07f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f689ef0fdd0>]}
[0m09:20:49.713564 [info ] [MainThread]: Found 16 models, 1 analysis, 4 seeds, 112 tests, 5 sources, 0 exposures, 0 metrics, 632 macros, 0 groups, 0 semantic models
[0m09:20:49.713984 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a2954b20-51a3-4aa1-a673-aa6f14ca07f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68a0480850>]}
[0m09:20:49.716857 [info ] [MainThread]: 
[0m09:20:49.718011 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m09:20:49.719528 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_casestudy'
[0m09:20:49.741347 [debug] [ThreadPool]: Using duckdb connection "list_casestudy"
[0m09:20:49.742165 [debug] [ThreadPool]: On list_casestudy: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"casestudy"'
    
  
  
[0m09:20:49.742596 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:20:49.889466 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m09:20:49.891233 [debug] [ThreadPool]: On list_casestudy: Close
[0m09:20:49.896758 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy, now create_casestudy_core)
[0m09:20:49.897711 [debug] [ThreadPool]: Creating schema "database: "casestudy"
schema: "core"
"
[0m09:20:49.904185 [debug] [ThreadPool]: Using duckdb connection "create_casestudy_core"
[0m09:20:49.904692 [debug] [ThreadPool]: On create_casestudy_core: BEGIN
[0m09:20:49.905013 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:20:49.917398 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m09:20:49.918020 [debug] [ThreadPool]: Using duckdb connection "create_casestudy_core"
[0m09:20:49.918377 [debug] [ThreadPool]: On create_casestudy_core: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "create_casestudy_core"} */
create schema if not exists "casestudy"."core"
[0m09:20:49.919320 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m09:20:49.920278 [debug] [ThreadPool]: On create_casestudy_core: COMMIT
[0m09:20:49.920599 [debug] [ThreadPool]: Using duckdb connection "create_casestudy_core"
[0m09:20:49.920917 [debug] [ThreadPool]: On create_casestudy_core: COMMIT
[0m09:20:49.921582 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m09:20:49.921925 [debug] [ThreadPool]: On create_casestudy_core: Close
[0m09:20:49.926670 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_casestudy_core, now list_casestudy_core)
[0m09:20:49.932209 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_core"
[0m09:20:49.932659 [debug] [ThreadPool]: On list_casestudy_core: BEGIN
[0m09:20:49.932977 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:20:49.948244 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m09:20:49.948760 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_core"
[0m09:20:49.949113 [debug] [ThreadPool]: On list_casestudy_core: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_core"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'core'
    and table_catalog = 'casestudy'
  
[0m09:20:49.966455 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m09:20:49.968472 [debug] [ThreadPool]: On list_casestudy_core: ROLLBACK
[0m09:20:49.970141 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_core'
[0m09:20:49.970555 [debug] [ThreadPool]: On list_casestudy_core: Close
[0m09:20:49.974086 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy_core, now list_casestudy_intermediate)
[0m09:20:49.976488 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_intermediate"
[0m09:20:49.977882 [debug] [ThreadPool]: On list_casestudy_intermediate: BEGIN
[0m09:20:49.978410 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:20:49.995304 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m09:20:49.995751 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_intermediate"
[0m09:20:49.996077 [debug] [ThreadPool]: On list_casestudy_intermediate: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_intermediate"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'intermediate'
    and table_catalog = 'casestudy'
  
[0m09:20:50.006374 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m09:20:50.008198 [debug] [ThreadPool]: On list_casestudy_intermediate: ROLLBACK
[0m09:20:50.009055 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_intermediate'
[0m09:20:50.009578 [debug] [ThreadPool]: On list_casestudy_intermediate: Close
[0m09:20:50.014030 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy_intermediate, now list_casestudy_staging)
[0m09:20:50.019756 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_staging"
[0m09:20:50.020461 [debug] [ThreadPool]: On list_casestudy_staging: BEGIN
[0m09:20:50.020988 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:20:50.076745 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m09:20:50.077451 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_staging"
[0m09:20:50.077923 [debug] [ThreadPool]: On list_casestudy_staging: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_staging"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'staging'
    and table_catalog = 'casestudy'
  
[0m09:20:50.112706 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m09:20:50.124764 [debug] [ThreadPool]: On list_casestudy_staging: ROLLBACK
[0m09:20:50.125639 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_staging'
[0m09:20:50.126138 [debug] [ThreadPool]: On list_casestudy_staging: Close
[0m09:20:50.130569 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy_staging, now list_casestudy_raw)
[0m09:20:50.146259 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_raw"
[0m09:20:50.146962 [debug] [ThreadPool]: On list_casestudy_raw: BEGIN
[0m09:20:50.156526 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:20:50.198782 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m09:20:50.199230 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_raw"
[0m09:20:50.199527 [debug] [ThreadPool]: On list_casestudy_raw: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_raw"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'raw'
    and table_catalog = 'casestudy'
  
[0m09:20:50.209308 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m09:20:50.211716 [debug] [ThreadPool]: On list_casestudy_raw: ROLLBACK
[0m09:20:50.212640 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_raw'
[0m09:20:50.213155 [debug] [ThreadPool]: On list_casestudy_raw: Close
[0m09:20:50.219437 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a2954b20-51a3-4aa1-a673-aa6f14ca07f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68a017b1d0>]}
[0m09:20:50.220346 [debug] [MainThread]: Using duckdb connection "master"
[0m09:20:50.220893 [debug] [MainThread]: On master: BEGIN
[0m09:20:50.221324 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:20:50.245663 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m09:20:50.246118 [debug] [MainThread]: On master: COMMIT
[0m09:20:50.246419 [debug] [MainThread]: Using duckdb connection "master"
[0m09:20:50.246674 [debug] [MainThread]: On master: COMMIT
[0m09:20:50.247248 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m09:20:50.247616 [debug] [MainThread]: On master: Close
[0m09:20:50.250011 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:20:50.250423 [info ] [MainThread]: 
[0m09:20:50.255383 [debug] [Thread-1 (]: Began running node model.vg_casestudy.core__loans_enriched
[0m09:20:50.255972 [info ] [Thread-1 (]: 1 of 1 START sql view model core.core__loans_enriched .......................... [RUN]
[0m09:20:50.256800 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.vg_casestudy.core__loans_enriched'
[0m09:20:50.257244 [debug] [Thread-1 (]: Began compiling node model.vg_casestudy.core__loans_enriched
[0m09:20:50.266541 [debug] [Thread-1 (]: Writing injected SQL for node "model.vg_casestudy.core__loans_enriched"
[0m09:20:50.267958 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.core__loans_enriched (compile): 09:20:50.257521 => 09:20:50.267534
[0m09:20:50.268669 [debug] [Thread-1 (]: Began executing node model.vg_casestudy.core__loans_enriched
[0m09:20:50.301949 [debug] [Thread-1 (]: Writing runtime sql for node "model.vg_casestudy.core__loans_enriched"
[0m09:20:50.302695 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.core__loans_enriched"
[0m09:20:50.303104 [debug] [Thread-1 (]: On model.vg_casestudy.core__loans_enriched: BEGIN
[0m09:20:50.303431 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m09:20:50.317576 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:20:50.318098 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.core__loans_enriched"
[0m09:20:50.318482 [debug] [Thread-1 (]: On model.vg_casestudy.core__loans_enriched: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.core__loans_enriched"} */

  
  create view "casestudy"."core"."core__loans_enriched__dbt_tmp" as (
    with loans as (
    select *
    from "casestudy"."intermediate"."stg_staging_intermediate__loans"
),

customers_enriched as (
    select *
    from "casestudy"."core"."core__customers_enriched"
),

joined as (
    select
        loans.loan_id,
        loans.customer_id,
        customers_enriched.firstname,
        customers_enriched.lastname,
        customers_enriched.age,
        customers_enriched.branch_id,
        customers_enriched.branch_name,
        customers_enriched.account_id,
        customers_enriched.account_type,
        customers_enriched.account_opening_date,
        customers_enriched.has_account,
        loans.loan_type,
        loans.loan_amount,
        loans.interest_rate,
        loans.loan_term,
        loans.loan_status,
        loans.approval_rejection_date

    from loans
    left join customers_enriched
        on loans.customer_id = customers_enriched.customer_id    
)

select * 
from joined
  );

[0m09:20:50.321665 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:20:50.328197 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.core__loans_enriched"
[0m09:20:50.328609 [debug] [Thread-1 (]: On model.vg_casestudy.core__loans_enriched: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.core__loans_enriched"} */
alter view "casestudy"."core"."core__loans_enriched__dbt_tmp" rename to "core__loans_enriched"
[0m09:20:50.329546 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:20:50.342494 [debug] [Thread-1 (]: On model.vg_casestudy.core__loans_enriched: COMMIT
[0m09:20:50.342939 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.core__loans_enriched"
[0m09:20:50.343316 [debug] [Thread-1 (]: On model.vg_casestudy.core__loans_enriched: COMMIT
[0m09:20:50.349157 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:20:50.359038 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.core__loans_enriched"
[0m09:20:50.360126 [debug] [Thread-1 (]: On model.vg_casestudy.core__loans_enriched: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.core__loans_enriched"} */
drop view if exists "casestudy"."core"."core__loans_enriched__dbt_backup" cascade
[0m09:20:50.361397 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:20:50.362809 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.core__loans_enriched (execute): 09:20:50.269032 => 09:20:50.362665
[0m09:20:50.363266 [debug] [Thread-1 (]: On model.vg_casestudy.core__loans_enriched: Close
[0m09:20:50.389922 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a2954b20-51a3-4aa1-a673-aa6f14ca07f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68a03b2e90>]}
[0m09:20:50.390653 [info ] [Thread-1 (]: 1 of 1 OK created sql view model core.core__loans_enriched ..................... [[32mOK[0m in 0.13s]
[0m09:20:50.391319 [debug] [Thread-1 (]: Finished running node model.vg_casestudy.core__loans_enriched
[0m09:20:50.393058 [debug] [MainThread]: Using duckdb connection "master"
[0m09:20:50.393402 [debug] [MainThread]: On master: BEGIN
[0m09:20:50.393679 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:20:50.409682 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m09:20:50.410159 [debug] [MainThread]: On master: COMMIT
[0m09:20:50.410464 [debug] [MainThread]: Using duckdb connection "master"
[0m09:20:50.410732 [debug] [MainThread]: On master: COMMIT
[0m09:20:50.411305 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m09:20:50.411693 [debug] [MainThread]: On master: Close
[0m09:20:50.414505 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:20:50.414885 [debug] [MainThread]: Connection 'list_casestudy_raw' was properly closed.
[0m09:20:50.415155 [debug] [MainThread]: Connection 'model.vg_casestudy.core__loans_enriched' was properly closed.
[0m09:20:50.415464 [info ] [MainThread]: 
[0m09:20:50.415811 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.70 seconds (0.70s).
[0m09:20:50.416406 [debug] [MainThread]: Command end result
[0m09:20:50.437293 [info ] [MainThread]: 
[0m09:20:50.437810 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:20:50.438154 [info ] [MainThread]: 
[0m09:20:50.438514 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m09:20:50.438993 [debug] [MainThread]: Command `dbt run` succeeded at 09:20:50.438893 after 1.42 seconds
[0m09:20:50.439463 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68a44a3390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68a58e9350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68a90c8050>]}
[0m09:20:50.439980 [debug] [MainThread]: Flushing usage events
[0m09:21:08.935594 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5027a6d510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5027a548d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5027b77b10>]}


============================== 09:21:08.939338 | 4f17d662-c89b-4f5a-b85a-cb995d90682c ==============================
[0m09:21:08.939338 [info ] [MainThread]: Running with dbt=1.6.18
[0m09:21:08.939975 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/workspaces/vg_case_study_tim/transformation', 'debug': 'False', 'warn_error': 'None', 'log_path': '/workspaces/vg_case_study_tim/transformation/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt test --select core__loans_enriched', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m09:21:09.043636 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4f17d662-c89b-4f5a-b85a-cb995d90682c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f502771b890>]}
[0m09:21:09.057902 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4f17d662-c89b-4f5a-b85a-cb995d90682c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5027b90ad0>]}
[0m09:21:09.058704 [info ] [MainThread]: Registered adapter: duckdb=1.6.2
[0m09:21:09.088143 [debug] [MainThread]: checksum: 7b9fab86a08e9e96a48a825af743c566d95b877e068b8c6d0dbafbf714447189, vars: {}, profile: , target: , version: 1.6.18
[0m09:21:09.142664 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:21:09.143364 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:21:09.145051 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.vg_casestudy.reporting
- models.vg_casestudy.main
- models.vg_casestudy.marts
[0m09:21:09.154951 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4f17d662-c89b-4f5a-b85a-cb995d90682c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5027d751d0>]}
[0m09:21:09.245758 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4f17d662-c89b-4f5a-b85a-cb995d90682c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50277866d0>]}
[0m09:21:09.246358 [info ] [MainThread]: Found 16 models, 1 analysis, 4 seeds, 112 tests, 5 sources, 0 exposures, 0 metrics, 632 macros, 0 groups, 0 semantic models
[0m09:21:09.246842 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4f17d662-c89b-4f5a-b85a-cb995d90682c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50276ff350>]}
[0m09:21:09.250386 [info ] [MainThread]: 
[0m09:21:09.251613 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m09:21:09.255374 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_casestudy_core'
[0m09:21:09.279630 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_core"
[0m09:21:09.280354 [debug] [ThreadPool]: On list_casestudy_core: BEGIN
[0m09:21:09.280910 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:21:09.306331 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m09:21:09.306973 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_core"
[0m09:21:09.307482 [debug] [ThreadPool]: On list_casestudy_core: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_core"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'core'
    and table_catalog = 'casestudy'
  
[0m09:21:09.321502 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m09:21:09.323179 [debug] [ThreadPool]: On list_casestudy_core: ROLLBACK
[0m09:21:09.324070 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_core'
[0m09:21:09.324640 [debug] [ThreadPool]: On list_casestudy_core: Close
[0m09:21:09.329548 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy_core, now list_casestudy_raw)
[0m09:21:09.333568 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_raw"
[0m09:21:09.334125 [debug] [ThreadPool]: On list_casestudy_raw: BEGIN
[0m09:21:09.334605 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:21:09.351212 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m09:21:09.351673 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_raw"
[0m09:21:09.351990 [debug] [ThreadPool]: On list_casestudy_raw: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_raw"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'raw'
    and table_catalog = 'casestudy'
  
[0m09:21:09.364171 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m09:21:09.365798 [debug] [ThreadPool]: On list_casestudy_raw: ROLLBACK
[0m09:21:09.366331 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_raw'
[0m09:21:09.366634 [debug] [ThreadPool]: On list_casestudy_raw: Close
[0m09:21:09.370602 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy_raw, now list_casestudy_staging)
[0m09:21:09.375671 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_staging"
[0m09:21:09.376122 [debug] [ThreadPool]: On list_casestudy_staging: BEGIN
[0m09:21:09.376436 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:21:09.389905 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m09:21:09.390584 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_staging"
[0m09:21:09.391041 [debug] [ThreadPool]: On list_casestudy_staging: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_staging"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'staging'
    and table_catalog = 'casestudy'
  
[0m09:21:09.400407 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m09:21:09.401971 [debug] [ThreadPool]: On list_casestudy_staging: ROLLBACK
[0m09:21:09.402505 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_staging'
[0m09:21:09.402846 [debug] [ThreadPool]: On list_casestudy_staging: Close
[0m09:21:09.406929 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy_staging, now list_casestudy_intermediate)
[0m09:21:09.409988 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_intermediate"
[0m09:21:09.411401 [debug] [ThreadPool]: On list_casestudy_intermediate: BEGIN
[0m09:21:09.411752 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:21:09.425154 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m09:21:09.425691 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_intermediate"
[0m09:21:09.426024 [debug] [ThreadPool]: On list_casestudy_intermediate: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_intermediate"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'intermediate'
    and table_catalog = 'casestudy'
  
[0m09:21:09.435181 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m09:21:09.437417 [debug] [ThreadPool]: On list_casestudy_intermediate: ROLLBACK
[0m09:21:09.438091 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_intermediate'
[0m09:21:09.438428 [debug] [ThreadPool]: On list_casestudy_intermediate: Close
[0m09:21:09.442787 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4f17d662-c89b-4f5a-b85a-cb995d90682c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5027765bd0>]}
[0m09:21:09.443341 [debug] [MainThread]: Using duckdb connection "master"
[0m09:21:09.443661 [debug] [MainThread]: On master: BEGIN
[0m09:21:09.443933 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:21:09.458302 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m09:21:09.458893 [debug] [MainThread]: On master: COMMIT
[0m09:21:09.459195 [debug] [MainThread]: Using duckdb connection "master"
[0m09:21:09.459462 [debug] [MainThread]: On master: COMMIT
[0m09:21:09.460198 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m09:21:09.460556 [debug] [MainThread]: On master: Close
[0m09:21:09.463096 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:21:09.463582 [info ] [MainThread]: 
[0m09:21:09.466384 [debug] [Thread-1 (]: Began running node test.vg_casestudy.accepted_values_core__loans_enriched_loan_term__12__24__36__48__60.d9ac56a512
[0m09:21:09.466919 [info ] [Thread-1 (]: 1 of 15 START test accepted_values_core__loans_enriched_loan_term__12__24__36__48__60  [RUN]
[0m09:21:09.467750 [debug] [Thread-1 (]: Acquiring new duckdb connection 'test.vg_casestudy.accepted_values_core__loans_enriched_loan_term__12__24__36__48__60.d9ac56a512'
[0m09:21:09.468140 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.accepted_values_core__loans_enriched_loan_term__12__24__36__48__60.d9ac56a512
[0m09:21:09.485407 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.accepted_values_core__loans_enriched_loan_term__12__24__36__48__60.d9ac56a512"
[0m09:21:09.488991 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.accepted_values_core__loans_enriched_loan_term__12__24__36__48__60.d9ac56a512 (compile): 09:21:09.468374 => 09:21:09.488560
[0m09:21:09.489475 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.accepted_values_core__loans_enriched_loan_term__12__24__36__48__60.d9ac56a512
[0m09:21:09.505237 [debug] [Thread-1 (]: Writing runtime sql for node "test.vg_casestudy.accepted_values_core__loans_enriched_loan_term__12__24__36__48__60.d9ac56a512"
[0m09:21:09.507007 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.accepted_values_core__loans_enriched_loan_term__12__24__36__48__60.d9ac56a512"
[0m09:21:09.507520 [debug] [Thread-1 (]: On test.vg_casestudy.accepted_values_core__loans_enriched_loan_term__12__24__36__48__60.d9ac56a512: BEGIN
[0m09:21:09.507849 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m09:21:09.522017 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:21:09.522537 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.accepted_values_core__loans_enriched_loan_term__12__24__36__48__60.d9ac56a512"
[0m09:21:09.522922 [debug] [Thread-1 (]: On test.vg_casestudy.accepted_values_core__loans_enriched_loan_term__12__24__36__48__60.d9ac56a512: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "test.vg_casestudy.accepted_values_core__loans_enriched_loan_term__12__24__36__48__60.d9ac56a512"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        loan_term as value_field,
        count(*) as n_records

    from "casestudy"."core"."core__loans_enriched"
    group by loan_term

)

select *
from all_values
where value_field not in (
    '12','24','36','48','60'
)



      
    ) dbt_internal_test
[0m09:21:09.537722 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:21:09.541209 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.accepted_values_core__loans_enriched_loan_term__12__24__36__48__60.d9ac56a512 (execute): 09:21:09.489741 => 09:21:09.540936
[0m09:21:09.541733 [debug] [Thread-1 (]: On test.vg_casestudy.accepted_values_core__loans_enriched_loan_term__12__24__36__48__60.d9ac56a512: ROLLBACK
[0m09:21:09.542328 [debug] [Thread-1 (]: Failed to rollback 'test.vg_casestudy.accepted_values_core__loans_enriched_loan_term__12__24__36__48__60.d9ac56a512'
[0m09:21:09.542700 [debug] [Thread-1 (]: On test.vg_casestudy.accepted_values_core__loans_enriched_loan_term__12__24__36__48__60.d9ac56a512: Close
[0m09:21:09.545748 [info ] [Thread-1 (]: 1 of 15 PASS accepted_values_core__loans_enriched_loan_term__12__24__36__48__60  [[32mPASS[0m in 0.08s]
[0m09:21:09.546444 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.accepted_values_core__loans_enriched_loan_term__12__24__36__48__60.d9ac56a512
[0m09:21:09.546900 [debug] [Thread-1 (]: Began running node test.vg_casestudy.date_is_past_core__loans_enriched_approval_rejection_date.664c96484a
[0m09:21:09.547484 [info ] [Thread-1 (]: 2 of 15 START test date_is_past_core__loans_enriched_approval_rejection_date ... [RUN]
[0m09:21:09.548219 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.accepted_values_core__loans_enriched_loan_term__12__24__36__48__60.d9ac56a512, now test.vg_casestudy.date_is_past_core__loans_enriched_approval_rejection_date.664c96484a)
[0m09:21:09.548580 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.date_is_past_core__loans_enriched_approval_rejection_date.664c96484a
[0m09:21:09.554328 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.date_is_past_core__loans_enriched_approval_rejection_date.664c96484a"
[0m09:21:09.555732 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.date_is_past_core__loans_enriched_approval_rejection_date.664c96484a (compile): 09:21:09.548812 => 09:21:09.555194
[0m09:21:09.556335 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.date_is_past_core__loans_enriched_approval_rejection_date.664c96484a
[0m09:21:09.560134 [debug] [Thread-1 (]: Writing runtime sql for node "test.vg_casestudy.date_is_past_core__loans_enriched_approval_rejection_date.664c96484a"
[0m09:21:09.561183 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.date_is_past_core__loans_enriched_approval_rejection_date.664c96484a"
[0m09:21:09.561658 [debug] [Thread-1 (]: On test.vg_casestudy.date_is_past_core__loans_enriched_approval_rejection_date.664c96484a: BEGIN
[0m09:21:09.561967 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:21:09.575370 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:21:09.576189 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.date_is_past_core__loans_enriched_approval_rejection_date.664c96484a"
[0m09:21:09.576630 [debug] [Thread-1 (]: On test.vg_casestudy.date_is_past_core__loans_enriched_approval_rejection_date.664c96484a: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "test.vg_casestudy.date_is_past_core__loans_enriched_approval_rejection_date.664c96484a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

    select *
    from "casestudy"."core"."core__loans_enriched"
    where approval_rejection_date > current_date()
    

      
    ) dbt_internal_test
[0m09:21:09.584438 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:21:09.586256 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.date_is_past_core__loans_enriched_approval_rejection_date.664c96484a (execute): 09:21:09.556693 => 09:21:09.585984
[0m09:21:09.586895 [debug] [Thread-1 (]: On test.vg_casestudy.date_is_past_core__loans_enriched_approval_rejection_date.664c96484a: ROLLBACK
[0m09:21:09.587669 [debug] [Thread-1 (]: Failed to rollback 'test.vg_casestudy.date_is_past_core__loans_enriched_approval_rejection_date.664c96484a'
[0m09:21:09.588045 [debug] [Thread-1 (]: On test.vg_casestudy.date_is_past_core__loans_enriched_approval_rejection_date.664c96484a: Close
[0m09:21:09.591384 [info ] [Thread-1 (]: 2 of 15 PASS date_is_past_core__loans_enriched_approval_rejection_date ......... [[32mPASS[0m in 0.04s]
[0m09:21:09.592123 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.date_is_past_core__loans_enriched_approval_rejection_date.664c96484a
[0m09:21:09.592572 [debug] [Thread-1 (]: Began running node test.vg_casestudy.not_null_core__loans_enriched_approval_rejection_date.733d5a44fa
[0m09:21:09.593167 [info ] [Thread-1 (]: 3 of 15 START test not_null_core__loans_enriched_approval_rejection_date ....... [RUN]
[0m09:21:09.594041 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.date_is_past_core__loans_enriched_approval_rejection_date.664c96484a, now test.vg_casestudy.not_null_core__loans_enriched_approval_rejection_date.733d5a44fa)
[0m09:21:09.594469 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.not_null_core__loans_enriched_approval_rejection_date.733d5a44fa
[0m09:21:09.602067 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.not_null_core__loans_enriched_approval_rejection_date.733d5a44fa"
[0m09:21:09.603049 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_core__loans_enriched_approval_rejection_date.733d5a44fa (compile): 09:21:09.594753 => 09:21:09.602714
[0m09:21:09.603748 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.not_null_core__loans_enriched_approval_rejection_date.733d5a44fa
[0m09:21:09.609082 [debug] [Thread-1 (]: Writing runtime sql for node "test.vg_casestudy.not_null_core__loans_enriched_approval_rejection_date.733d5a44fa"
[0m09:21:09.610226 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.not_null_core__loans_enriched_approval_rejection_date.733d5a44fa"
[0m09:21:09.610991 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_core__loans_enriched_approval_rejection_date.733d5a44fa: BEGIN
[0m09:21:09.611389 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:21:09.626866 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:21:09.627478 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.not_null_core__loans_enriched_approval_rejection_date.733d5a44fa"
[0m09:21:09.627856 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_core__loans_enriched_approval_rejection_date.733d5a44fa: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "test.vg_casestudy.not_null_core__loans_enriched_approval_rejection_date.733d5a44fa"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select approval_rejection_date
from "casestudy"."core"."core__loans_enriched"
where approval_rejection_date is null



      
    ) dbt_internal_test
[0m09:21:09.631769 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:21:09.633520 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_core__loans_enriched_approval_rejection_date.733d5a44fa (execute): 09:21:09.604193 => 09:21:09.633283
[0m09:21:09.633936 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_core__loans_enriched_approval_rejection_date.733d5a44fa: ROLLBACK
[0m09:21:09.634420 [debug] [Thread-1 (]: Failed to rollback 'test.vg_casestudy.not_null_core__loans_enriched_approval_rejection_date.733d5a44fa'
[0m09:21:09.634760 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_core__loans_enriched_approval_rejection_date.733d5a44fa: Close
[0m09:21:09.638578 [info ] [Thread-1 (]: 3 of 15 PASS not_null_core__loans_enriched_approval_rejection_date ............. [[32mPASS[0m in 0.04s]
[0m09:21:09.639520 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.not_null_core__loans_enriched_approval_rejection_date.733d5a44fa
[0m09:21:09.640035 [debug] [Thread-1 (]: Began running node test.vg_casestudy.not_null_core__loans_enriched_customer_id.29651406d1
[0m09:21:09.640608 [info ] [Thread-1 (]: 4 of 15 START test not_null_core__loans_enriched_customer_id ................... [RUN]
[0m09:21:09.641406 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.not_null_core__loans_enriched_approval_rejection_date.733d5a44fa, now test.vg_casestudy.not_null_core__loans_enriched_customer_id.29651406d1)
[0m09:21:09.641783 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.not_null_core__loans_enriched_customer_id.29651406d1
[0m09:21:09.646391 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.not_null_core__loans_enriched_customer_id.29651406d1"
[0m09:21:09.647432 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_core__loans_enriched_customer_id.29651406d1 (compile): 09:21:09.642015 => 09:21:09.647120
[0m09:21:09.647828 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.not_null_core__loans_enriched_customer_id.29651406d1
[0m09:21:09.650573 [debug] [Thread-1 (]: Writing runtime sql for node "test.vg_casestudy.not_null_core__loans_enriched_customer_id.29651406d1"
[0m09:21:09.651278 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.not_null_core__loans_enriched_customer_id.29651406d1"
[0m09:21:09.651641 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_core__loans_enriched_customer_id.29651406d1: BEGIN
[0m09:21:09.651941 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:21:09.665408 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:21:09.665913 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.not_null_core__loans_enriched_customer_id.29651406d1"
[0m09:21:09.666292 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_core__loans_enriched_customer_id.29651406d1: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "test.vg_casestudy.not_null_core__loans_enriched_customer_id.29651406d1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from "casestudy"."core"."core__loans_enriched"
where customer_id is null



      
    ) dbt_internal_test
[0m09:21:09.670907 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:21:09.673484 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_core__loans_enriched_customer_id.29651406d1 (execute): 09:21:09.648071 => 09:21:09.673096
[0m09:21:09.674171 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_core__loans_enriched_customer_id.29651406d1: ROLLBACK
[0m09:21:09.674753 [debug] [Thread-1 (]: Failed to rollback 'test.vg_casestudy.not_null_core__loans_enriched_customer_id.29651406d1'
[0m09:21:09.675088 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_core__loans_enriched_customer_id.29651406d1: Close
[0m09:21:09.678076 [info ] [Thread-1 (]: 4 of 15 PASS not_null_core__loans_enriched_customer_id ......................... [[32mPASS[0m in 0.04s]
[0m09:21:09.678813 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.not_null_core__loans_enriched_customer_id.29651406d1
[0m09:21:09.679263 [debug] [Thread-1 (]: Began running node test.vg_casestudy.not_null_core__loans_enriched_has_account.d6264958b7
[0m09:21:09.679794 [info ] [Thread-1 (]: 5 of 15 START test not_null_core__loans_enriched_has_account ................... [RUN]
[0m09:21:09.680631 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.not_null_core__loans_enriched_customer_id.29651406d1, now test.vg_casestudy.not_null_core__loans_enriched_has_account.d6264958b7)
[0m09:21:09.681015 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.not_null_core__loans_enriched_has_account.d6264958b7
[0m09:21:09.686553 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.not_null_core__loans_enriched_has_account.d6264958b7"
[0m09:21:09.687957 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_core__loans_enriched_has_account.d6264958b7 (compile): 09:21:09.681274 => 09:21:09.687564
[0m09:21:09.688468 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.not_null_core__loans_enriched_has_account.d6264958b7
[0m09:21:09.691572 [debug] [Thread-1 (]: Writing runtime sql for node "test.vg_casestudy.not_null_core__loans_enriched_has_account.d6264958b7"
[0m09:21:09.692504 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.not_null_core__loans_enriched_has_account.d6264958b7"
[0m09:21:09.693136 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_core__loans_enriched_has_account.d6264958b7: BEGIN
[0m09:21:09.693519 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:21:09.706384 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:21:09.706879 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.not_null_core__loans_enriched_has_account.d6264958b7"
[0m09:21:09.707407 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_core__loans_enriched_has_account.d6264958b7: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "test.vg_casestudy.not_null_core__loans_enriched_has_account.d6264958b7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select has_account
from "casestudy"."core"."core__loans_enriched"
where has_account is null



      
    ) dbt_internal_test
[0m09:21:09.714293 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:21:09.716164 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_core__loans_enriched_has_account.d6264958b7 (execute): 09:21:09.688781 => 09:21:09.715918
[0m09:21:09.716607 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_core__loans_enriched_has_account.d6264958b7: ROLLBACK
[0m09:21:09.717152 [debug] [Thread-1 (]: Failed to rollback 'test.vg_casestudy.not_null_core__loans_enriched_has_account.d6264958b7'
[0m09:21:09.717525 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_core__loans_enriched_has_account.d6264958b7: Close
[0m09:21:09.721412 [info ] [Thread-1 (]: 5 of 15 PASS not_null_core__loans_enriched_has_account ......................... [[32mPASS[0m in 0.04s]
[0m09:21:09.722370 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.not_null_core__loans_enriched_has_account.d6264958b7
[0m09:21:09.722884 [debug] [Thread-1 (]: Began running node test.vg_casestudy.not_null_core__loans_enriched_interest_rate.1699d97f39
[0m09:21:09.723361 [info ] [Thread-1 (]: 6 of 15 START test not_null_core__loans_enriched_interest_rate ................. [RUN]
[0m09:21:09.724199 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.not_null_core__loans_enriched_has_account.d6264958b7, now test.vg_casestudy.not_null_core__loans_enriched_interest_rate.1699d97f39)
[0m09:21:09.724584 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.not_null_core__loans_enriched_interest_rate.1699d97f39
[0m09:21:09.729041 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.not_null_core__loans_enriched_interest_rate.1699d97f39"
[0m09:21:09.730002 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_core__loans_enriched_interest_rate.1699d97f39 (compile): 09:21:09.724832 => 09:21:09.729750
[0m09:21:09.730425 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.not_null_core__loans_enriched_interest_rate.1699d97f39
[0m09:21:09.733531 [debug] [Thread-1 (]: Writing runtime sql for node "test.vg_casestudy.not_null_core__loans_enriched_interest_rate.1699d97f39"
[0m09:21:09.734268 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.not_null_core__loans_enriched_interest_rate.1699d97f39"
[0m09:21:09.734638 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_core__loans_enriched_interest_rate.1699d97f39: BEGIN
[0m09:21:09.734962 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:21:09.747987 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:21:09.748550 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.not_null_core__loans_enriched_interest_rate.1699d97f39"
[0m09:21:09.748897 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_core__loans_enriched_interest_rate.1699d97f39: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "test.vg_casestudy.not_null_core__loans_enriched_interest_rate.1699d97f39"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select interest_rate
from "casestudy"."core"."core__loans_enriched"
where interest_rate is null



      
    ) dbt_internal_test
[0m09:21:09.752921 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:21:09.755381 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_core__loans_enriched_interest_rate.1699d97f39 (execute): 09:21:09.730719 => 09:21:09.754998
[0m09:21:09.755901 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_core__loans_enriched_interest_rate.1699d97f39: ROLLBACK
[0m09:21:09.756454 [debug] [Thread-1 (]: Failed to rollback 'test.vg_casestudy.not_null_core__loans_enriched_interest_rate.1699d97f39'
[0m09:21:09.756821 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_core__loans_enriched_interest_rate.1699d97f39: Close
[0m09:21:09.760219 [info ] [Thread-1 (]: 6 of 15 PASS not_null_core__loans_enriched_interest_rate ....................... [[32mPASS[0m in 0.04s]
[0m09:21:09.760956 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.not_null_core__loans_enriched_interest_rate.1699d97f39
[0m09:21:09.761462 [debug] [Thread-1 (]: Began running node test.vg_casestudy.not_null_core__loans_enriched_loan_amount.aedf20e73b
[0m09:21:09.761998 [info ] [Thread-1 (]: 7 of 15 START test not_null_core__loans_enriched_loan_amount ................... [RUN]
[0m09:21:09.762763 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.not_null_core__loans_enriched_interest_rate.1699d97f39, now test.vg_casestudy.not_null_core__loans_enriched_loan_amount.aedf20e73b)
[0m09:21:09.763129 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.not_null_core__loans_enriched_loan_amount.aedf20e73b
[0m09:21:09.768058 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.not_null_core__loans_enriched_loan_amount.aedf20e73b"
[0m09:21:09.769023 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_core__loans_enriched_loan_amount.aedf20e73b (compile): 09:21:09.763357 => 09:21:09.768740
[0m09:21:09.769471 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.not_null_core__loans_enriched_loan_amount.aedf20e73b
[0m09:21:09.772813 [debug] [Thread-1 (]: Writing runtime sql for node "test.vg_casestudy.not_null_core__loans_enriched_loan_amount.aedf20e73b"
[0m09:21:09.773985 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.not_null_core__loans_enriched_loan_amount.aedf20e73b"
[0m09:21:09.774598 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_core__loans_enriched_loan_amount.aedf20e73b: BEGIN
[0m09:21:09.775277 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:21:09.790655 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:21:09.791154 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.not_null_core__loans_enriched_loan_amount.aedf20e73b"
[0m09:21:09.791568 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_core__loans_enriched_loan_amount.aedf20e73b: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "test.vg_casestudy.not_null_core__loans_enriched_loan_amount.aedf20e73b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select loan_amount
from "casestudy"."core"."core__loans_enriched"
where loan_amount is null



      
    ) dbt_internal_test
[0m09:21:09.795599 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:21:09.797372 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_core__loans_enriched_loan_amount.aedf20e73b (execute): 09:21:09.769852 => 09:21:09.797134
[0m09:21:09.797804 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_core__loans_enriched_loan_amount.aedf20e73b: ROLLBACK
[0m09:21:09.798303 [debug] [Thread-1 (]: Failed to rollback 'test.vg_casestudy.not_null_core__loans_enriched_loan_amount.aedf20e73b'
[0m09:21:09.798652 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_core__loans_enriched_loan_amount.aedf20e73b: Close
[0m09:21:09.802534 [info ] [Thread-1 (]: 7 of 15 PASS not_null_core__loans_enriched_loan_amount ......................... [[32mPASS[0m in 0.04s]
[0m09:21:09.803457 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.not_null_core__loans_enriched_loan_amount.aedf20e73b
[0m09:21:09.803964 [debug] [Thread-1 (]: Began running node test.vg_casestudy.not_null_core__loans_enriched_loan_id.0c443fac99
[0m09:21:09.804590 [info ] [Thread-1 (]: 8 of 15 START test not_null_core__loans_enriched_loan_id ....................... [RUN]
[0m09:21:09.805581 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.not_null_core__loans_enriched_loan_amount.aedf20e73b, now test.vg_casestudy.not_null_core__loans_enriched_loan_id.0c443fac99)
[0m09:21:09.806032 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.not_null_core__loans_enriched_loan_id.0c443fac99
[0m09:21:09.812690 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.not_null_core__loans_enriched_loan_id.0c443fac99"
[0m09:21:09.813571 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_core__loans_enriched_loan_id.0c443fac99 (compile): 09:21:09.806300 => 09:21:09.813327
[0m09:21:09.813948 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.not_null_core__loans_enriched_loan_id.0c443fac99
[0m09:21:09.817227 [debug] [Thread-1 (]: Writing runtime sql for node "test.vg_casestudy.not_null_core__loans_enriched_loan_id.0c443fac99"
[0m09:21:09.818041 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.not_null_core__loans_enriched_loan_id.0c443fac99"
[0m09:21:09.818440 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_core__loans_enriched_loan_id.0c443fac99: BEGIN
[0m09:21:09.818773 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:21:09.832167 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:21:09.832686 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.not_null_core__loans_enriched_loan_id.0c443fac99"
[0m09:21:09.833031 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_core__loans_enriched_loan_id.0c443fac99: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "test.vg_casestudy.not_null_core__loans_enriched_loan_id.0c443fac99"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select loan_id
from "casestudy"."core"."core__loans_enriched"
where loan_id is null



      
    ) dbt_internal_test
[0m09:21:09.837549 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:21:09.839507 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_core__loans_enriched_loan_id.0c443fac99 (execute): 09:21:09.814192 => 09:21:09.839195
[0m09:21:09.839949 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_core__loans_enriched_loan_id.0c443fac99: ROLLBACK
[0m09:21:09.840461 [debug] [Thread-1 (]: Failed to rollback 'test.vg_casestudy.not_null_core__loans_enriched_loan_id.0c443fac99'
[0m09:21:09.840784 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_core__loans_enriched_loan_id.0c443fac99: Close
[0m09:21:09.843542 [info ] [Thread-1 (]: 8 of 15 PASS not_null_core__loans_enriched_loan_id ............................. [[32mPASS[0m in 0.04s]
[0m09:21:09.844176 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.not_null_core__loans_enriched_loan_id.0c443fac99
[0m09:21:09.844575 [debug] [Thread-1 (]: Began running node test.vg_casestudy.not_null_core__loans_enriched_loan_status.5602c59b7c
[0m09:21:09.844942 [info ] [Thread-1 (]: 9 of 15 START test not_null_core__loans_enriched_loan_status ................... [RUN]
[0m09:21:09.845643 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.not_null_core__loans_enriched_loan_id.0c443fac99, now test.vg_casestudy.not_null_core__loans_enriched_loan_status.5602c59b7c)
[0m09:21:09.845982 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.not_null_core__loans_enriched_loan_status.5602c59b7c
[0m09:21:09.850130 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.not_null_core__loans_enriched_loan_status.5602c59b7c"
[0m09:21:09.850894 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_core__loans_enriched_loan_status.5602c59b7c (compile): 09:21:09.846212 => 09:21:09.850619
[0m09:21:09.851296 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.not_null_core__loans_enriched_loan_status.5602c59b7c
[0m09:21:09.854520 [debug] [Thread-1 (]: Writing runtime sql for node "test.vg_casestudy.not_null_core__loans_enriched_loan_status.5602c59b7c"
[0m09:21:09.855278 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.not_null_core__loans_enriched_loan_status.5602c59b7c"
[0m09:21:09.855688 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_core__loans_enriched_loan_status.5602c59b7c: BEGIN
[0m09:21:09.856065 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:21:09.869443 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:21:09.869967 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.not_null_core__loans_enriched_loan_status.5602c59b7c"
[0m09:21:09.870319 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_core__loans_enriched_loan_status.5602c59b7c: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "test.vg_casestudy.not_null_core__loans_enriched_loan_status.5602c59b7c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select loan_status
from "casestudy"."core"."core__loans_enriched"
where loan_status is null



      
    ) dbt_internal_test
[0m09:21:09.874725 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:21:09.876739 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_core__loans_enriched_loan_status.5602c59b7c (execute): 09:21:09.851540 => 09:21:09.876517
[0m09:21:09.877178 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_core__loans_enriched_loan_status.5602c59b7c: ROLLBACK
[0m09:21:09.877673 [debug] [Thread-1 (]: Failed to rollback 'test.vg_casestudy.not_null_core__loans_enriched_loan_status.5602c59b7c'
[0m09:21:09.877993 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_core__loans_enriched_loan_status.5602c59b7c: Close
[0m09:21:09.880784 [info ] [Thread-1 (]: 9 of 15 PASS not_null_core__loans_enriched_loan_status ......................... [[32mPASS[0m in 0.04s]
[0m09:21:09.881433 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.not_null_core__loans_enriched_loan_status.5602c59b7c
[0m09:21:09.881872 [debug] [Thread-1 (]: Began running node test.vg_casestudy.not_null_core__loans_enriched_loan_term.d0a8554ce3
[0m09:21:09.882229 [info ] [Thread-1 (]: 10 of 15 START test not_null_core__loans_enriched_loan_term .................... [RUN]
[0m09:21:09.882978 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.not_null_core__loans_enriched_loan_status.5602c59b7c, now test.vg_casestudy.not_null_core__loans_enriched_loan_term.d0a8554ce3)
[0m09:21:09.883362 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.not_null_core__loans_enriched_loan_term.d0a8554ce3
[0m09:21:09.888031 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.not_null_core__loans_enriched_loan_term.d0a8554ce3"
[0m09:21:09.889295 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_core__loans_enriched_loan_term.d0a8554ce3 (compile): 09:21:09.883612 => 09:21:09.889022
[0m09:21:09.889773 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.not_null_core__loans_enriched_loan_term.d0a8554ce3
[0m09:21:09.892716 [debug] [Thread-1 (]: Writing runtime sql for node "test.vg_casestudy.not_null_core__loans_enriched_loan_term.d0a8554ce3"
[0m09:21:09.893402 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.not_null_core__loans_enriched_loan_term.d0a8554ce3"
[0m09:21:09.893772 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_core__loans_enriched_loan_term.d0a8554ce3: BEGIN
[0m09:21:09.894063 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:21:09.906394 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:21:09.907103 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.not_null_core__loans_enriched_loan_term.d0a8554ce3"
[0m09:21:09.907846 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_core__loans_enriched_loan_term.d0a8554ce3: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "test.vg_casestudy.not_null_core__loans_enriched_loan_term.d0a8554ce3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select loan_term
from "casestudy"."core"."core__loans_enriched"
where loan_term is null



      
    ) dbt_internal_test
[0m09:21:09.912364 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:21:09.914022 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_core__loans_enriched_loan_term.d0a8554ce3 (execute): 09:21:09.890081 => 09:21:09.913785
[0m09:21:09.914402 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_core__loans_enriched_loan_term.d0a8554ce3: ROLLBACK
[0m09:21:09.914859 [debug] [Thread-1 (]: Failed to rollback 'test.vg_casestudy.not_null_core__loans_enriched_loan_term.d0a8554ce3'
[0m09:21:09.915179 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_core__loans_enriched_loan_term.d0a8554ce3: Close
[0m09:21:09.918063 [info ] [Thread-1 (]: 10 of 15 PASS not_null_core__loans_enriched_loan_term .......................... [[32mPASS[0m in 0.04s]
[0m09:21:09.918707 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.not_null_core__loans_enriched_loan_term.d0a8554ce3
[0m09:21:09.919106 [debug] [Thread-1 (]: Began running node test.vg_casestudy.not_null_core__loans_enriched_loan_type.3917d1c0c9
[0m09:21:09.919824 [info ] [Thread-1 (]: 11 of 15 START test not_null_core__loans_enriched_loan_type .................... [RUN]
[0m09:21:09.920813 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.not_null_core__loans_enriched_loan_term.d0a8554ce3, now test.vg_casestudy.not_null_core__loans_enriched_loan_type.3917d1c0c9)
[0m09:21:09.921360 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.not_null_core__loans_enriched_loan_type.3917d1c0c9
[0m09:21:09.926153 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.not_null_core__loans_enriched_loan_type.3917d1c0c9"
[0m09:21:09.927379 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_core__loans_enriched_loan_type.3917d1c0c9 (compile): 09:21:09.921731 => 09:21:09.926893
[0m09:21:09.927933 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.not_null_core__loans_enriched_loan_type.3917d1c0c9
[0m09:21:09.930706 [debug] [Thread-1 (]: Writing runtime sql for node "test.vg_casestudy.not_null_core__loans_enriched_loan_type.3917d1c0c9"
[0m09:21:09.931406 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.not_null_core__loans_enriched_loan_type.3917d1c0c9"
[0m09:21:09.931773 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_core__loans_enriched_loan_type.3917d1c0c9: BEGIN
[0m09:21:09.932086 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:21:09.946388 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:21:09.946877 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.not_null_core__loans_enriched_loan_type.3917d1c0c9"
[0m09:21:09.947328 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_core__loans_enriched_loan_type.3917d1c0c9: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "test.vg_casestudy.not_null_core__loans_enriched_loan_type.3917d1c0c9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select loan_type
from "casestudy"."core"."core__loans_enriched"
where loan_type is null



      
    ) dbt_internal_test
[0m09:21:09.951350 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:21:09.953139 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_core__loans_enriched_loan_type.3917d1c0c9 (execute): 09:21:09.928195 => 09:21:09.952897
[0m09:21:09.953650 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_core__loans_enriched_loan_type.3917d1c0c9: ROLLBACK
[0m09:21:09.954158 [debug] [Thread-1 (]: Failed to rollback 'test.vg_casestudy.not_null_core__loans_enriched_loan_type.3917d1c0c9'
[0m09:21:09.954510 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_core__loans_enriched_loan_type.3917d1c0c9: Close
[0m09:21:09.958496 [info ] [Thread-1 (]: 11 of 15 PASS not_null_core__loans_enriched_loan_type .......................... [[32mPASS[0m in 0.04s]
[0m09:21:09.959228 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.not_null_core__loans_enriched_loan_type.3917d1c0c9
[0m09:21:09.959637 [debug] [Thread-1 (]: Began running node test.vg_casestudy.numeric_range_core__loans_enriched_interest_rate__0.d592c61ff0
[0m09:21:09.959990 [info ] [Thread-1 (]: 12 of 15 START test numeric_range_core__loans_enriched_interest_rate__0 ........ [RUN]
[0m09:21:09.960863 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.not_null_core__loans_enriched_loan_type.3917d1c0c9, now test.vg_casestudy.numeric_range_core__loans_enriched_interest_rate__0.d592c61ff0)
[0m09:21:09.961234 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.numeric_range_core__loans_enriched_interest_rate__0.d592c61ff0
[0m09:21:09.968721 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.numeric_range_core__loans_enriched_interest_rate__0.d592c61ff0"
[0m09:21:09.969674 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.numeric_range_core__loans_enriched_interest_rate__0.d592c61ff0 (compile): 09:21:09.961471 => 09:21:09.969352
[0m09:21:09.970290 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.numeric_range_core__loans_enriched_interest_rate__0.d592c61ff0
[0m09:21:09.976767 [debug] [Thread-1 (]: Writing runtime sql for node "test.vg_casestudy.numeric_range_core__loans_enriched_interest_rate__0.d592c61ff0"
[0m09:21:09.977837 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.numeric_range_core__loans_enriched_interest_rate__0.d592c61ff0"
[0m09:21:09.978324 [debug] [Thread-1 (]: On test.vg_casestudy.numeric_range_core__loans_enriched_interest_rate__0.d592c61ff0: BEGIN
[0m09:21:09.978749 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:21:09.991145 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:21:09.991644 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.numeric_range_core__loans_enriched_interest_rate__0.d592c61ff0"
[0m09:21:09.992024 [debug] [Thread-1 (]: On test.vg_casestudy.numeric_range_core__loans_enriched_interest_rate__0.d592c61ff0: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "test.vg_casestudy.numeric_range_core__loans_enriched_interest_rate__0.d592c61ff0"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

    
        select *
        from "casestudy"."core"."core__loans_enriched"
        where interest_rate < 0
    
    


      
    ) dbt_internal_test
[0m09:21:09.996012 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:21:09.997844 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.numeric_range_core__loans_enriched_interest_rate__0.d592c61ff0 (execute): 09:21:09.970659 => 09:21:09.997607
[0m09:21:09.998258 [debug] [Thread-1 (]: On test.vg_casestudy.numeric_range_core__loans_enriched_interest_rate__0.d592c61ff0: ROLLBACK
[0m09:21:09.998735 [debug] [Thread-1 (]: Failed to rollback 'test.vg_casestudy.numeric_range_core__loans_enriched_interest_rate__0.d592c61ff0'
[0m09:21:09.999086 [debug] [Thread-1 (]: On test.vg_casestudy.numeric_range_core__loans_enriched_interest_rate__0.d592c61ff0: Close
[0m09:21:10.002029 [info ] [Thread-1 (]: 12 of 15 PASS numeric_range_core__loans_enriched_interest_rate__0 .............. [[32mPASS[0m in 0.04s]
[0m09:21:10.002941 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.numeric_range_core__loans_enriched_interest_rate__0.d592c61ff0
[0m09:21:10.003494 [debug] [Thread-1 (]: Began running node test.vg_casestudy.numeric_range_core__loans_enriched_loan_amount__0.681e805342
[0m09:21:10.003882 [info ] [Thread-1 (]: 13 of 15 START test numeric_range_core__loans_enriched_loan_amount__0 .......... [RUN]
[0m09:21:10.004697 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.numeric_range_core__loans_enriched_interest_rate__0.d592c61ff0, now test.vg_casestudy.numeric_range_core__loans_enriched_loan_amount__0.681e805342)
[0m09:21:10.005085 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.numeric_range_core__loans_enriched_loan_amount__0.681e805342
[0m09:21:10.009265 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.numeric_range_core__loans_enriched_loan_amount__0.681e805342"
[0m09:21:10.010376 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.numeric_range_core__loans_enriched_loan_amount__0.681e805342 (compile): 09:21:10.005337 => 09:21:10.010060
[0m09:21:10.010910 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.numeric_range_core__loans_enriched_loan_amount__0.681e805342
[0m09:21:10.014041 [debug] [Thread-1 (]: Writing runtime sql for node "test.vg_casestudy.numeric_range_core__loans_enriched_loan_amount__0.681e805342"
[0m09:21:10.014828 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.numeric_range_core__loans_enriched_loan_amount__0.681e805342"
[0m09:21:10.015241 [debug] [Thread-1 (]: On test.vg_casestudy.numeric_range_core__loans_enriched_loan_amount__0.681e805342: BEGIN
[0m09:21:10.015710 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:21:10.030322 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:21:10.030807 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.numeric_range_core__loans_enriched_loan_amount__0.681e805342"
[0m09:21:10.031175 [debug] [Thread-1 (]: On test.vg_casestudy.numeric_range_core__loans_enriched_loan_amount__0.681e805342: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "test.vg_casestudy.numeric_range_core__loans_enriched_loan_amount__0.681e805342"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

    
        select *
        from "casestudy"."core"."core__loans_enriched"
        where loan_amount < 0
    
    


      
    ) dbt_internal_test
[0m09:21:10.035347 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:21:10.037240 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.numeric_range_core__loans_enriched_loan_amount__0.681e805342 (execute): 09:21:10.011261 => 09:21:10.036933
[0m09:21:10.037701 [debug] [Thread-1 (]: On test.vg_casestudy.numeric_range_core__loans_enriched_loan_amount__0.681e805342: ROLLBACK
[0m09:21:10.038223 [debug] [Thread-1 (]: Failed to rollback 'test.vg_casestudy.numeric_range_core__loans_enriched_loan_amount__0.681e805342'
[0m09:21:10.038549 [debug] [Thread-1 (]: On test.vg_casestudy.numeric_range_core__loans_enriched_loan_amount__0.681e805342: Close
[0m09:21:10.041812 [info ] [Thread-1 (]: 13 of 15 PASS numeric_range_core__loans_enriched_loan_amount__0 ................ [[32mPASS[0m in 0.04s]
[0m09:21:10.042593 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.numeric_range_core__loans_enriched_loan_amount__0.681e805342
[0m09:21:10.043026 [debug] [Thread-1 (]: Began running node test.vg_casestudy.unique_core__loans_enriched_customer_id.7855894340
[0m09:21:10.043631 [info ] [Thread-1 (]: 14 of 15 START test unique_core__loans_enriched_customer_id .................... [RUN]
[0m09:21:10.044608 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.numeric_range_core__loans_enriched_loan_amount__0.681e805342, now test.vg_casestudy.unique_core__loans_enriched_customer_id.7855894340)
[0m09:21:10.045084 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.unique_core__loans_enriched_customer_id.7855894340
[0m09:21:10.053949 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.unique_core__loans_enriched_customer_id.7855894340"
[0m09:21:10.054934 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.unique_core__loans_enriched_customer_id.7855894340 (compile): 09:21:10.045421 => 09:21:10.054605
[0m09:21:10.055353 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.unique_core__loans_enriched_customer_id.7855894340
[0m09:21:10.058959 [debug] [Thread-1 (]: Writing runtime sql for node "test.vg_casestudy.unique_core__loans_enriched_customer_id.7855894340"
[0m09:21:10.060081 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.unique_core__loans_enriched_customer_id.7855894340"
[0m09:21:10.060670 [debug] [Thread-1 (]: On test.vg_casestudy.unique_core__loans_enriched_customer_id.7855894340: BEGIN
[0m09:21:10.061116 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:21:10.075889 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:21:10.076641 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.unique_core__loans_enriched_customer_id.7855894340"
[0m09:21:10.077200 [debug] [Thread-1 (]: On test.vg_casestudy.unique_core__loans_enriched_customer_id.7855894340: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "test.vg_casestudy.unique_core__loans_enriched_customer_id.7855894340"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from "casestudy"."core"."core__loans_enriched"
where customer_id is not null
group by customer_id
having count(*) > 1



      
    ) dbt_internal_test
[0m09:21:10.086631 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:21:10.088552 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.unique_core__loans_enriched_customer_id.7855894340 (execute): 09:21:10.055601 => 09:21:10.088318
[0m09:21:10.088993 [debug] [Thread-1 (]: On test.vg_casestudy.unique_core__loans_enriched_customer_id.7855894340: ROLLBACK
[0m09:21:10.089556 [debug] [Thread-1 (]: Failed to rollback 'test.vg_casestudy.unique_core__loans_enriched_customer_id.7855894340'
[0m09:21:10.089887 [debug] [Thread-1 (]: On test.vg_casestudy.unique_core__loans_enriched_customer_id.7855894340: Close
[0m09:21:10.094975 [info ] [Thread-1 (]: 14 of 15 PASS unique_core__loans_enriched_customer_id .......................... [[32mPASS[0m in 0.05s]
[0m09:21:10.096036 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.unique_core__loans_enriched_customer_id.7855894340
[0m09:21:10.096906 [debug] [Thread-1 (]: Began running node test.vg_casestudy.unique_core__loans_enriched_loan_id.6bcfd497cd
[0m09:21:10.097829 [info ] [Thread-1 (]: 15 of 15 START test unique_core__loans_enriched_loan_id ........................ [RUN]
[0m09:21:10.099125 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.unique_core__loans_enriched_customer_id.7855894340, now test.vg_casestudy.unique_core__loans_enriched_loan_id.6bcfd497cd)
[0m09:21:10.099865 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.unique_core__loans_enriched_loan_id.6bcfd497cd
[0m09:21:10.107010 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.unique_core__loans_enriched_loan_id.6bcfd497cd"
[0m09:21:10.108171 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.unique_core__loans_enriched_loan_id.6bcfd497cd (compile): 09:21:10.100354 => 09:21:10.107926
[0m09:21:10.108594 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.unique_core__loans_enriched_loan_id.6bcfd497cd
[0m09:21:10.111700 [debug] [Thread-1 (]: Writing runtime sql for node "test.vg_casestudy.unique_core__loans_enriched_loan_id.6bcfd497cd"
[0m09:21:10.112449 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.unique_core__loans_enriched_loan_id.6bcfd497cd"
[0m09:21:10.112815 [debug] [Thread-1 (]: On test.vg_casestudy.unique_core__loans_enriched_loan_id.6bcfd497cd: BEGIN
[0m09:21:10.113157 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:21:10.126576 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:21:10.127111 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.unique_core__loans_enriched_loan_id.6bcfd497cd"
[0m09:21:10.127513 [debug] [Thread-1 (]: On test.vg_casestudy.unique_core__loans_enriched_loan_id.6bcfd497cd: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "test.vg_casestudy.unique_core__loans_enriched_loan_id.6bcfd497cd"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    loan_id as unique_field,
    count(*) as n_records

from "casestudy"."core"."core__loans_enriched"
where loan_id is not null
group by loan_id
having count(*) > 1



      
    ) dbt_internal_test
[0m09:21:10.133744 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:21:10.135426 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.unique_core__loans_enriched_loan_id.6bcfd497cd (execute): 09:21:10.108952 => 09:21:10.135184
[0m09:21:10.135837 [debug] [Thread-1 (]: On test.vg_casestudy.unique_core__loans_enriched_loan_id.6bcfd497cd: ROLLBACK
[0m09:21:10.136436 [debug] [Thread-1 (]: Failed to rollback 'test.vg_casestudy.unique_core__loans_enriched_loan_id.6bcfd497cd'
[0m09:21:10.136890 [debug] [Thread-1 (]: On test.vg_casestudy.unique_core__loans_enriched_loan_id.6bcfd497cd: Close
[0m09:21:10.141812 [info ] [Thread-1 (]: 15 of 15 PASS unique_core__loans_enriched_loan_id .............................. [[32mPASS[0m in 0.04s]
[0m09:21:10.142549 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.unique_core__loans_enriched_loan_id.6bcfd497cd
[0m09:21:10.144675 [debug] [MainThread]: Using duckdb connection "master"
[0m09:21:10.145101 [debug] [MainThread]: On master: BEGIN
[0m09:21:10.145421 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:21:10.161603 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m09:21:10.162310 [debug] [MainThread]: On master: COMMIT
[0m09:21:10.163784 [debug] [MainThread]: Using duckdb connection "master"
[0m09:21:10.164383 [debug] [MainThread]: On master: COMMIT
[0m09:21:10.165416 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m09:21:10.165943 [debug] [MainThread]: On master: Close
[0m09:21:10.215149 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:21:10.215950 [debug] [MainThread]: Connection 'list_casestudy_intermediate' was properly closed.
[0m09:21:10.216466 [debug] [MainThread]: Connection 'test.vg_casestudy.unique_core__loans_enriched_loan_id.6bcfd497cd' was properly closed.
[0m09:21:10.217168 [info ] [MainThread]: 
[0m09:21:10.217891 [info ] [MainThread]: Finished running 15 tests in 0 hours 0 minutes and 0.97 seconds (0.97s).
[0m09:21:10.230966 [debug] [MainThread]: Command end result
[0m09:21:10.379430 [info ] [MainThread]: 
[0m09:21:10.380177 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:21:10.380618 [info ] [MainThread]: 
[0m09:21:10.380981 [info ] [MainThread]: Done. PASS=15 WARN=0 ERROR=0 SKIP=0 TOTAL=15
[0m09:21:10.382081 [debug] [MainThread]: Command `dbt test` succeeded at 09:21:10.381843 after 1.45 seconds
[0m09:21:10.382790 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5027a64a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f502c49c0d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5027e5fd50>]}
[0m09:21:10.383544 [debug] [MainThread]: Flushing usage events
[0m09:55:46.904411 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe701792a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe701941490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe701928950>]}


============================== 09:55:46.908799 | b2110eba-1c68-40eb-9d9b-0eb6186405ff ==============================
[0m09:55:46.908799 [info ] [MainThread]: Running with dbt=1.6.18
[0m09:55:46.909398 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/workspaces/vg_case_study_tim/transformation', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/workspaces/vg_case_study_tim/transformation/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run --select path:models/marts --full-refresh', 'send_anonymous_usage_stats': 'True'}
[0m09:55:47.103591 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b2110eba-1c68-40eb-9d9b-0eb6186405ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe7017c6810>]}
[0m09:55:47.117804 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b2110eba-1c68-40eb-9d9b-0eb6186405ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe703f22810>]}
[0m09:55:47.119297 [info ] [MainThread]: Registered adapter: duckdb=1.6.2
[0m09:55:47.147101 [debug] [MainThread]: checksum: 7b9fab86a08e9e96a48a825af743c566d95b877e068b8c6d0dbafbf714447189, vars: {}, profile: , target: , version: 1.6.18
[0m09:55:47.243802 [debug] [MainThread]: Partial parsing enabled: 6 files deleted, 6 files added, 0 files changed.
[0m09:55:47.244628 [debug] [MainThread]: Partial parsing: added file: vg_casestudy://models/marts/marts__transactions_with_euro.sql
[0m09:55:47.245090 [debug] [MainThread]: Partial parsing: added file: vg_casestudy://models/marts/marts__transactions_with_euro.yml
[0m09:55:47.245499 [debug] [MainThread]: Partial parsing: added file: vg_casestudy://models/marts/marts__loans_enriched.sql
[0m09:55:47.245805 [debug] [MainThread]: Partial parsing: added file: vg_casestudy://models/marts/marts__customers_enriched.sql
[0m09:55:47.246195 [debug] [MainThread]: Partial parsing: added file: vg_casestudy://models/marts/marts__loans_enriched.yml
[0m09:55:47.246547 [debug] [MainThread]: Partial parsing: added file: vg_casestudy://models/marts/marts__customers_enriched.yml
[0m09:55:47.247007 [debug] [MainThread]: Partial parsing: deleted file: vg_casestudy://models/core/core__transactions_with_euro.sql
[0m09:55:47.247305 [debug] [MainThread]: Partial parsing: deleted file: vg_casestudy://models/core/core__loans_enriched.sql
[0m09:55:47.247558 [debug] [MainThread]: Partial parsing: deleted file: vg_casestudy://models/core/core__customers_enriched.sql
[0m09:55:47.450400 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.vg_casestudy.marts__loans_enriched' (models/marts/marts__loans_enriched.sql) depends on a node named 'core__customers_enriched' which was not found
[0m09:55:47.451120 [debug] [MainThread]: Command `dbt run` failed at 09:55:47.450967 after 0.56 seconds
[0m09:55:47.451473 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe701a47590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe70179e4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe70296a510>]}
[0m09:55:47.451839 [debug] [MainThread]: Flushing usage events
[0m09:57:05.327666 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b6d632e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b6c489750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b6d633a90>]}


============================== 09:57:05.333396 | 0facdfd6-9394-4226-9ab8-ed87693a8c48 ==============================
[0m09:57:05.333396 [info ] [MainThread]: Running with dbt=1.6.18
[0m09:57:05.333982 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/workspaces/vg_case_study_tim/transformation/logs', 'debug': 'False', 'profiles_dir': '/workspaces/vg_case_study_tim/transformation', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select path:models/marts --full-refresh', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m09:57:05.532557 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0facdfd6-9394-4226-9ab8-ed87693a8c48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b68a9cf10>]}
[0m09:57:05.547935 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0facdfd6-9394-4226-9ab8-ed87693a8c48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b68a9d150>]}
[0m09:57:05.549494 [info ] [MainThread]: Registered adapter: duckdb=1.6.2
[0m09:57:05.577384 [debug] [MainThread]: checksum: 7b9fab86a08e9e96a48a825af743c566d95b877e068b8c6d0dbafbf714447189, vars: {}, profile: , target: , version: 1.6.18
[0m09:57:05.683881 [debug] [MainThread]: Partial parsing enabled: 6 files deleted, 6 files added, 0 files changed.
[0m09:57:05.684754 [debug] [MainThread]: Partial parsing: added file: vg_casestudy://models/marts/marts__customers_enriched.yml
[0m09:57:05.685153 [debug] [MainThread]: Partial parsing: added file: vg_casestudy://models/marts/marts__customers_enriched.sql
[0m09:57:05.685496 [debug] [MainThread]: Partial parsing: added file: vg_casestudy://models/marts/marts__loans_enriched.sql
[0m09:57:05.685863 [debug] [MainThread]: Partial parsing: added file: vg_casestudy://models/marts/marts__transactions_with_euro.yml
[0m09:57:05.686164 [debug] [MainThread]: Partial parsing: added file: vg_casestudy://models/marts/marts__transactions_with_euro.sql
[0m09:57:05.686547 [debug] [MainThread]: Partial parsing: added file: vg_casestudy://models/marts/marts__loans_enriched.yml
[0m09:57:05.687031 [debug] [MainThread]: Partial parsing: deleted file: vg_casestudy://models/core/core__loans_enriched.sql
[0m09:57:05.687326 [debug] [MainThread]: Partial parsing: deleted file: vg_casestudy://models/core/core__customers_enriched.sql
[0m09:57:05.687599 [debug] [MainThread]: Partial parsing: deleted file: vg_casestudy://models/core/core__transactions_with_euro.sql
[0m09:57:05.903013 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.vg_casestudy.reporting
- models.vg_casestudy.main
[0m09:57:05.910266 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0facdfd6-9394-4226-9ab8-ed87693a8c48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b67f5bdd0>]}
[0m09:57:05.945221 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0facdfd6-9394-4226-9ab8-ed87693a8c48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b68055850>]}
[0m09:57:05.945802 [info ] [MainThread]: Found 16 models, 1 analysis, 4 seeds, 112 tests, 5 sources, 0 exposures, 0 metrics, 632 macros, 0 groups, 0 semantic models
[0m09:57:05.946195 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0facdfd6-9394-4226-9ab8-ed87693a8c48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b6c21d3d0>]}
[0m09:57:05.950272 [info ] [MainThread]: 
[0m09:57:05.951086 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m09:57:05.952370 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_casestudy'
[0m09:57:05.966719 [debug] [ThreadPool]: Using duckdb connection "list_casestudy"
[0m09:57:05.967539 [debug] [ThreadPool]: On list_casestudy: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"casestudy"'
    
  
  
[0m09:57:05.967903 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:57:06.102911 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m09:57:06.104355 [debug] [ThreadPool]: On list_casestudy: Close
[0m09:57:06.110585 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy, now create_casestudy_marts)
[0m09:57:06.111467 [debug] [ThreadPool]: Creating schema "database: "casestudy"
schema: "marts"
"
[0m09:57:06.116354 [debug] [ThreadPool]: Using duckdb connection "create_casestudy_marts"
[0m09:57:06.116957 [debug] [ThreadPool]: On create_casestudy_marts: BEGIN
[0m09:57:06.117333 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:57:06.129480 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m09:57:06.129929 [debug] [ThreadPool]: Using duckdb connection "create_casestudy_marts"
[0m09:57:06.130249 [debug] [ThreadPool]: On create_casestudy_marts: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "create_casestudy_marts"} */
create schema if not exists "casestudy"."marts"
[0m09:57:06.130816 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m09:57:06.131725 [debug] [ThreadPool]: On create_casestudy_marts: COMMIT
[0m09:57:06.132040 [debug] [ThreadPool]: Using duckdb connection "create_casestudy_marts"
[0m09:57:06.132305 [debug] [ThreadPool]: On create_casestudy_marts: COMMIT
[0m09:57:06.136945 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m09:57:06.137426 [debug] [ThreadPool]: On create_casestudy_marts: Close
[0m09:57:06.170469 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_casestudy_marts, now list_casestudy_raw)
[0m09:57:06.175522 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_raw"
[0m09:57:06.176125 [debug] [ThreadPool]: On list_casestudy_raw: BEGIN
[0m09:57:06.176418 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:57:06.187837 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m09:57:06.188238 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_raw"
[0m09:57:06.188547 [debug] [ThreadPool]: On list_casestudy_raw: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_raw"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'raw'
    and table_catalog = 'casestudy'
  
[0m09:57:06.200632 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m09:57:06.202191 [debug] [ThreadPool]: On list_casestudy_raw: ROLLBACK
[0m09:57:06.204038 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_raw'
[0m09:57:06.204400 [debug] [ThreadPool]: On list_casestudy_raw: Close
[0m09:57:06.208582 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy_raw, now list_casestudy_marts)
[0m09:57:06.210731 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_marts"
[0m09:57:06.211075 [debug] [ThreadPool]: On list_casestudy_marts: BEGIN
[0m09:57:06.211396 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:57:06.222326 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m09:57:06.222725 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_marts"
[0m09:57:06.223014 [debug] [ThreadPool]: On list_casestudy_marts: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_marts"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'marts'
    and table_catalog = 'casestudy'
  
[0m09:57:06.231076 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m09:57:06.232253 [debug] [ThreadPool]: On list_casestudy_marts: ROLLBACK
[0m09:57:06.232721 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_marts'
[0m09:57:06.232985 [debug] [ThreadPool]: On list_casestudy_marts: Close
[0m09:57:06.235897 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy_marts, now list_casestudy_intermediate)
[0m09:57:06.238256 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_intermediate"
[0m09:57:06.238618 [debug] [ThreadPool]: On list_casestudy_intermediate: BEGIN
[0m09:57:06.238927 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:57:06.249691 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m09:57:06.250118 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_intermediate"
[0m09:57:06.250536 [debug] [ThreadPool]: On list_casestudy_intermediate: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_intermediate"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'intermediate'
    and table_catalog = 'casestudy'
  
[0m09:57:06.258897 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m09:57:06.260241 [debug] [ThreadPool]: On list_casestudy_intermediate: ROLLBACK
[0m09:57:06.260715 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_intermediate'
[0m09:57:06.260982 [debug] [ThreadPool]: On list_casestudy_intermediate: Close
[0m09:57:06.263800 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy_intermediate, now list_casestudy_staging)
[0m09:57:06.266168 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_staging"
[0m09:57:06.267801 [debug] [ThreadPool]: On list_casestudy_staging: BEGIN
[0m09:57:06.268105 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:57:06.279244 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m09:57:06.279618 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_staging"
[0m09:57:06.279895 [debug] [ThreadPool]: On list_casestudy_staging: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_staging"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'staging'
    and table_catalog = 'casestudy'
  
[0m09:57:06.288248 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m09:57:06.289672 [debug] [ThreadPool]: On list_casestudy_staging: ROLLBACK
[0m09:57:06.290149 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_staging'
[0m09:57:06.290423 [debug] [ThreadPool]: On list_casestudy_staging: Close
[0m09:57:06.294148 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0facdfd6-9394-4226-9ab8-ed87693a8c48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b6d681d90>]}
[0m09:57:06.294627 [debug] [MainThread]: Using duckdb connection "master"
[0m09:57:06.294909 [debug] [MainThread]: On master: BEGIN
[0m09:57:06.295172 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:57:06.308126 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m09:57:06.308542 [debug] [MainThread]: On master: COMMIT
[0m09:57:06.308817 [debug] [MainThread]: Using duckdb connection "master"
[0m09:57:06.309087 [debug] [MainThread]: On master: COMMIT
[0m09:57:06.309600 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m09:57:06.309899 [debug] [MainThread]: On master: Close
[0m09:57:06.312274 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:57:06.312706 [info ] [MainThread]: 
[0m09:57:06.317681 [debug] [Thread-1 (]: Began running node model.vg_casestudy.marts__customers_enriched
[0m09:57:06.318181 [info ] [Thread-1 (]: 1 of 3 START sql view model marts.marts__customers_enriched .................... [RUN]
[0m09:57:06.318967 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.vg_casestudy.marts__customers_enriched'
[0m09:57:06.319286 [debug] [Thread-1 (]: Began compiling node model.vg_casestudy.marts__customers_enriched
[0m09:57:06.329965 [debug] [Thread-1 (]: Writing injected SQL for node "model.vg_casestudy.marts__customers_enriched"
[0m09:57:06.331480 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.marts__customers_enriched (compile): 09:57:06.319510 => 09:57:06.331152
[0m09:57:06.331935 [debug] [Thread-1 (]: Began executing node model.vg_casestudy.marts__customers_enriched
[0m09:57:06.365082 [debug] [Thread-1 (]: Writing runtime sql for node "model.vg_casestudy.marts__customers_enriched"
[0m09:57:06.366879 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.marts__customers_enriched"
[0m09:57:06.367258 [debug] [Thread-1 (]: On model.vg_casestudy.marts__customers_enriched: BEGIN
[0m09:57:06.367566 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m09:57:06.381814 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:57:06.382285 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.marts__customers_enriched"
[0m09:57:06.382667 [debug] [Thread-1 (]: On model.vg_casestudy.marts__customers_enriched: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.marts__customers_enriched"} */

  
  create view "casestudy"."marts"."marts__customers_enriched__dbt_tmp" as (
    with customers as (
    select *
    from "casestudy"."intermediate"."stg_staging_intermediate__customers"
),

accounts as (
    select *
    from "casestudy"."intermediate"."stg_staging_intermediate__accounts"
),

branch_names as (
    select *
    from "casestudy"."intermediate"."intermediate__branch_names"
),


joined as (
    select 
        customers.customer_id,
        customers.firstname,
        customers.lastname,
        customers.age,
        customers.branch_id,
        branch_names.branch_name,
        accounts.account_id,
        accounts.account_type,
        accounts.account_opening_date,
        case 
            when accounts.account_id is null then false
            else true
        end as has_account

    from customers
    left join accounts
    on customers.customer_id = accounts.customer_id
    left join branch_names
    on customers.branch_id = branch_names.branch_id
)

select *
from joined
  );

[0m09:57:06.383746 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:57:06.391120 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.marts__customers_enriched"
[0m09:57:06.391771 [debug] [Thread-1 (]: On model.vg_casestudy.marts__customers_enriched: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.marts__customers_enriched"} */
alter view "casestudy"."marts"."marts__customers_enriched__dbt_tmp" rename to "marts__customers_enriched"
[0m09:57:06.392821 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:57:06.407055 [debug] [Thread-1 (]: On model.vg_casestudy.marts__customers_enriched: COMMIT
[0m09:57:06.407643 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.marts__customers_enriched"
[0m09:57:06.408018 [debug] [Thread-1 (]: On model.vg_casestudy.marts__customers_enriched: COMMIT
[0m09:57:06.412087 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:57:06.417265 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.marts__customers_enriched"
[0m09:57:06.417672 [debug] [Thread-1 (]: On model.vg_casestudy.marts__customers_enriched: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.marts__customers_enriched"} */
drop view if exists "casestudy"."marts"."marts__customers_enriched__dbt_backup" cascade
[0m09:57:06.418483 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:57:06.419759 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.marts__customers_enriched (execute): 09:57:06.332178 => 09:57:06.419613
[0m09:57:06.420099 [debug] [Thread-1 (]: On model.vg_casestudy.marts__customers_enriched: Close
[0m09:57:06.444747 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0facdfd6-9394-4226-9ab8-ed87693a8c48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b67ec6990>]}
[0m09:57:06.445503 [info ] [Thread-1 (]: 1 of 3 OK created sql view model marts.marts__customers_enriched ............... [[32mOK[0m in 0.13s]
[0m09:57:06.446092 [debug] [Thread-1 (]: Finished running node model.vg_casestudy.marts__customers_enriched
[0m09:57:06.446494 [debug] [Thread-1 (]: Began running node model.vg_casestudy.marts__transactions_with_euro
[0m09:57:06.447015 [info ] [Thread-1 (]: 2 of 3 START sql view model marts.marts__transactions_with_euro ................ [RUN]
[0m09:57:06.447872 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.vg_casestudy.marts__customers_enriched, now model.vg_casestudy.marts__transactions_with_euro)
[0m09:57:06.448340 [debug] [Thread-1 (]: Began compiling node model.vg_casestudy.marts__transactions_with_euro
[0m09:57:06.451500 [debug] [Thread-1 (]: Writing injected SQL for node "model.vg_casestudy.marts__transactions_with_euro"
[0m09:57:06.452149 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.marts__transactions_with_euro (compile): 09:57:06.448596 => 09:57:06.451944
[0m09:57:06.452470 [debug] [Thread-1 (]: Began executing node model.vg_casestudy.marts__transactions_with_euro
[0m09:57:06.457294 [debug] [Thread-1 (]: Writing runtime sql for node "model.vg_casestudy.marts__transactions_with_euro"
[0m09:57:06.458486 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.marts__transactions_with_euro"
[0m09:57:06.459090 [debug] [Thread-1 (]: On model.vg_casestudy.marts__transactions_with_euro: BEGIN
[0m09:57:06.459531 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:57:06.472198 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:57:06.472711 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.marts__transactions_with_euro"
[0m09:57:06.473113 [debug] [Thread-1 (]: On model.vg_casestudy.marts__transactions_with_euro: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.marts__transactions_with_euro"} */

  
  create view "casestudy"."marts"."marts__transactions_with_euro__dbt_tmp" as (
    with transactions as (
    select *
    from "casestudy"."intermediate"."stg_staging_intermediate__transactions"
),

fx_rates_filled as (
    select *
    from "casestudy"."intermediate"."intermediate__fx_rates_filled"
),

joined as (
    select 
        transactions.transaction_id,
        transactions.transaction_date,
        transactions.account_id,
        transactions.transaction_type,
        transactions.transaction_amount,
        transactions.transaction_currency,
        fx_rates_filled.fx_rate,
        transactions.transaction_amount / nullif(coalesce(fx_rates_filled.fx_rate, 1.0),0) as transaction_amount_euro
    from transactions
    left join fx_rates_filled
    on transactions.transaction_currency = fx_rates_filled.currency_iso_code
    and transactions.transaction_date = fx_rates_filled.fx_rate_date
)

select *
from joined
  );

[0m09:57:06.476651 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:57:06.480244 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.marts__transactions_with_euro"
[0m09:57:06.480770 [debug] [Thread-1 (]: On model.vg_casestudy.marts__transactions_with_euro: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.marts__transactions_with_euro"} */
alter view "casestudy"."marts"."marts__transactions_with_euro__dbt_tmp" rename to "marts__transactions_with_euro"
[0m09:57:06.481632 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:57:06.483100 [debug] [Thread-1 (]: On model.vg_casestudy.marts__transactions_with_euro: COMMIT
[0m09:57:06.483448 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.marts__transactions_with_euro"
[0m09:57:06.483767 [debug] [Thread-1 (]: On model.vg_casestudy.marts__transactions_with_euro: COMMIT
[0m09:57:06.487562 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:57:06.490202 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.marts__transactions_with_euro"
[0m09:57:06.490777 [debug] [Thread-1 (]: On model.vg_casestudy.marts__transactions_with_euro: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.marts__transactions_with_euro"} */
drop view if exists "casestudy"."marts"."marts__transactions_with_euro__dbt_backup" cascade
[0m09:57:06.491834 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:57:06.493550 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.marts__transactions_with_euro (execute): 09:57:06.452700 => 09:57:06.493377
[0m09:57:06.493912 [debug] [Thread-1 (]: On model.vg_casestudy.marts__transactions_with_euro: Close
[0m09:57:06.516791 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0facdfd6-9394-4226-9ab8-ed87693a8c48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b66c1f610>]}
[0m09:57:06.517499 [info ] [Thread-1 (]: 2 of 3 OK created sql view model marts.marts__transactions_with_euro ........... [[32mOK[0m in 0.07s]
[0m09:57:06.518107 [debug] [Thread-1 (]: Finished running node model.vg_casestudy.marts__transactions_with_euro
[0m09:57:06.518530 [debug] [Thread-1 (]: Began running node model.vg_casestudy.marts__loans_enriched
[0m09:57:06.519060 [info ] [Thread-1 (]: 3 of 3 START sql view model marts.marts__loans_enriched ........................ [RUN]
[0m09:57:06.519752 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.vg_casestudy.marts__transactions_with_euro, now model.vg_casestudy.marts__loans_enriched)
[0m09:57:06.520083 [debug] [Thread-1 (]: Began compiling node model.vg_casestudy.marts__loans_enriched
[0m09:57:06.523361 [debug] [Thread-1 (]: Writing injected SQL for node "model.vg_casestudy.marts__loans_enriched"
[0m09:57:06.523961 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.marts__loans_enriched (compile): 09:57:06.520303 => 09:57:06.523777
[0m09:57:06.524305 [debug] [Thread-1 (]: Began executing node model.vg_casestudy.marts__loans_enriched
[0m09:57:06.528673 [debug] [Thread-1 (]: Writing runtime sql for node "model.vg_casestudy.marts__loans_enriched"
[0m09:57:06.529412 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.marts__loans_enriched"
[0m09:57:06.529788 [debug] [Thread-1 (]: On model.vg_casestudy.marts__loans_enriched: BEGIN
[0m09:57:06.530090 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:57:06.544007 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:57:06.544505 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.marts__loans_enriched"
[0m09:57:06.545071 [debug] [Thread-1 (]: On model.vg_casestudy.marts__loans_enriched: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.marts__loans_enriched"} */

  
  create view "casestudy"."marts"."marts__loans_enriched__dbt_tmp" as (
    with loans as (
    select *
    from "casestudy"."intermediate"."stg_staging_intermediate__loans"
),

customers_enriched as (
    select *
    from "casestudy"."marts"."marts__customers_enriched"
),

joined as (
    select
        loans.loan_id,
        loans.customer_id,
        customers_enriched.firstname,
        customers_enriched.lastname,
        customers_enriched.age,
        customers_enriched.branch_id,
        customers_enriched.branch_name,
        customers_enriched.account_id,
        customers_enriched.account_type,
        customers_enriched.account_opening_date,
        customers_enriched.has_account,
        loans.loan_type,
        loans.loan_amount,
        loans.interest_rate,
        loans.loan_term,
        loans.loan_status,
        loans.approval_rejection_date

    from loans
    left join customers_enriched
        on loans.customer_id = customers_enriched.customer_id    
)

select * 
from joined
  );

[0m09:57:06.547078 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:57:06.550366 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.marts__loans_enriched"
[0m09:57:06.550752 [debug] [Thread-1 (]: On model.vg_casestudy.marts__loans_enriched: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.marts__loans_enriched"} */
alter view "casestudy"."marts"."marts__loans_enriched__dbt_tmp" rename to "marts__loans_enriched"
[0m09:57:06.552452 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:57:06.554040 [debug] [Thread-1 (]: On model.vg_casestudy.marts__loans_enriched: COMMIT
[0m09:57:06.554378 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.marts__loans_enriched"
[0m09:57:06.554684 [debug] [Thread-1 (]: On model.vg_casestudy.marts__loans_enriched: COMMIT
[0m09:57:06.558825 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:57:06.563693 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.marts__loans_enriched"
[0m09:57:06.564210 [debug] [Thread-1 (]: On model.vg_casestudy.marts__loans_enriched: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.marts__loans_enriched"} */
drop view if exists "casestudy"."marts"."marts__loans_enriched__dbt_backup" cascade
[0m09:57:06.565053 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:57:06.566327 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.marts__loans_enriched (execute): 09:57:06.524535 => 09:57:06.566187
[0m09:57:06.566685 [debug] [Thread-1 (]: On model.vg_casestudy.marts__loans_enriched: Close
[0m09:57:06.594170 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0facdfd6-9394-4226-9ab8-ed87693a8c48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b66d64f10>]}
[0m09:57:06.594898 [info ] [Thread-1 (]: 3 of 3 OK created sql view model marts.marts__loans_enriched ................... [[32mOK[0m in 0.07s]
[0m09:57:06.595514 [debug] [Thread-1 (]: Finished running node model.vg_casestudy.marts__loans_enriched
[0m09:57:06.597440 [debug] [MainThread]: Using duckdb connection "master"
[0m09:57:06.597858 [debug] [MainThread]: On master: BEGIN
[0m09:57:06.598177 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:57:06.613673 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m09:57:06.614179 [debug] [MainThread]: On master: COMMIT
[0m09:57:06.614492 [debug] [MainThread]: Using duckdb connection "master"
[0m09:57:06.614766 [debug] [MainThread]: On master: COMMIT
[0m09:57:06.615373 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m09:57:06.615724 [debug] [MainThread]: On master: Close
[0m09:57:06.618405 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:57:06.618759 [debug] [MainThread]: Connection 'list_casestudy_staging' was properly closed.
[0m09:57:06.619017 [debug] [MainThread]: Connection 'model.vg_casestudy.marts__loans_enriched' was properly closed.
[0m09:57:06.619338 [info ] [MainThread]: 
[0m09:57:06.619670 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 0.67 seconds (0.67s).
[0m09:57:06.620452 [debug] [MainThread]: Command end result
[0m09:57:06.640058 [info ] [MainThread]: 
[0m09:57:06.640575 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:57:06.640977 [info ] [MainThread]: 
[0m09:57:06.641348 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m09:57:06.641914 [debug] [MainThread]: Command `dbt run` succeeded at 09:57:06.641802 after 1.33 seconds
[0m09:57:06.642292 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b6c38e990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b6c7c9450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b70e83350>]}
[0m09:57:06.642636 [debug] [MainThread]: Flushing usage events
[0m09:57:49.105089 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95d6381690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95d5f0b110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95d6014950>]}


============================== 09:57:49.110890 | 70835633-22ba-4a43-910d-b079941c5c58 ==============================
[0m09:57:49.110890 [info ] [MainThread]: Running with dbt=1.6.18
[0m09:57:49.111501 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/workspaces/vg_case_study_tim/transformation', 'version_check': 'True', 'debug': 'False', 'log_path': '/workspaces/vg_case_study_tim/transformation/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt test --select path:models/marts', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m09:57:49.310991 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '70835633-22ba-4a43-910d-b079941c5c58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95d6053b50>]}
[0m09:57:49.326060 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '70835633-22ba-4a43-910d-b079941c5c58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95d68bbfd0>]}
[0m09:57:49.327919 [info ] [MainThread]: Registered adapter: duckdb=1.6.2
[0m09:57:49.356356 [debug] [MainThread]: checksum: 7b9fab86a08e9e96a48a825af743c566d95b877e068b8c6d0dbafbf714447189, vars: {}, profile: , target: , version: 1.6.18
[0m09:57:49.464376 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:57:49.464834 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:57:49.466513 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.vg_casestudy.main
- models.vg_casestudy.reporting
[0m09:57:49.475281 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '70835633-22ba-4a43-910d-b079941c5c58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95d1b6b450>]}
[0m09:57:49.553067 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '70835633-22ba-4a43-910d-b079941c5c58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95d5d91bd0>]}
[0m09:57:49.553618 [info ] [MainThread]: Found 16 models, 1 analysis, 4 seeds, 112 tests, 5 sources, 0 exposures, 0 metrics, 632 macros, 0 groups, 0 semantic models
[0m09:57:49.554093 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '70835633-22ba-4a43-910d-b079941c5c58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95d5f22950>]}
[0m09:57:49.558841 [info ] [MainThread]: 
[0m09:57:49.560001 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m09:57:49.563515 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_casestudy_intermediate'
[0m09:57:49.576114 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_intermediate"
[0m09:57:49.576634 [debug] [ThreadPool]: On list_casestudy_intermediate: BEGIN
[0m09:57:49.577079 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:57:49.701865 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m09:57:49.702385 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_intermediate"
[0m09:57:49.702733 [debug] [ThreadPool]: On list_casestudy_intermediate: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_intermediate"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'intermediate'
    and table_catalog = 'casestudy'
  
[0m09:57:49.723450 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m09:57:49.725225 [debug] [ThreadPool]: On list_casestudy_intermediate: ROLLBACK
[0m09:57:49.726369 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_intermediate'
[0m09:57:49.726754 [debug] [ThreadPool]: On list_casestudy_intermediate: Close
[0m09:57:49.729966 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy_intermediate, now list_casestudy_marts)
[0m09:57:49.734332 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_marts"
[0m09:57:49.734708 [debug] [ThreadPool]: On list_casestudy_marts: BEGIN
[0m09:57:49.735009 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:57:49.747238 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m09:57:49.747738 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_marts"
[0m09:57:49.748085 [debug] [ThreadPool]: On list_casestudy_marts: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_marts"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'marts'
    and table_catalog = 'casestudy'
  
[0m09:57:49.757294 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m09:57:49.758647 [debug] [ThreadPool]: On list_casestudy_marts: ROLLBACK
[0m09:57:49.759191 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_marts'
[0m09:57:49.759556 [debug] [ThreadPool]: On list_casestudy_marts: Close
[0m09:57:49.762914 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy_marts, now list_casestudy_staging)
[0m09:57:49.766112 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_staging"
[0m09:57:49.766496 [debug] [ThreadPool]: On list_casestudy_staging: BEGIN
[0m09:57:49.766784 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:57:49.777909 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m09:57:49.778366 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_staging"
[0m09:57:49.778679 [debug] [ThreadPool]: On list_casestudy_staging: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_staging"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'staging'
    and table_catalog = 'casestudy'
  
[0m09:57:49.788089 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m09:57:49.789542 [debug] [ThreadPool]: On list_casestudy_staging: ROLLBACK
[0m09:57:49.790041 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_staging'
[0m09:57:49.790313 [debug] [ThreadPool]: On list_casestudy_staging: Close
[0m09:57:49.793318 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy_staging, now list_casestudy_raw)
[0m09:57:49.795939 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_raw"
[0m09:57:49.797398 [debug] [ThreadPool]: On list_casestudy_raw: BEGIN
[0m09:57:49.797750 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:57:49.809006 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m09:57:49.809571 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_raw"
[0m09:57:49.809932 [debug] [ThreadPool]: On list_casestudy_raw: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_raw"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'raw'
    and table_catalog = 'casestudy'
  
[0m09:57:49.818149 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m09:57:49.819506 [debug] [ThreadPool]: On list_casestudy_raw: ROLLBACK
[0m09:57:49.819981 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_raw'
[0m09:57:49.820262 [debug] [ThreadPool]: On list_casestudy_raw: Close
[0m09:57:49.824180 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '70835633-22ba-4a43-910d-b079941c5c58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95d1ba3150>]}
[0m09:57:49.824677 [debug] [MainThread]: Using duckdb connection "master"
[0m09:57:49.825139 [debug] [MainThread]: On master: BEGIN
[0m09:57:49.825462 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:57:49.837888 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m09:57:49.838297 [debug] [MainThread]: On master: COMMIT
[0m09:57:49.838603 [debug] [MainThread]: Using duckdb connection "master"
[0m09:57:49.838866 [debug] [MainThread]: On master: COMMIT
[0m09:57:49.839338 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m09:57:49.839641 [debug] [MainThread]: On master: Close
[0m09:57:49.841982 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:57:49.842398 [info ] [MainThread]: 
[0m09:57:49.849445 [debug] [Thread-1 (]: Began running node test.vg_casestudy.accepted_values_marts__loans_enriched_loan_term__12__24__36__48__60.21f8e81786
[0m09:57:49.850097 [info ] [Thread-1 (]: 1 of 26 START test accepted_values_marts__loans_enriched_loan_term__12__24__36__48__60  [RUN]
[0m09:57:49.851135 [debug] [Thread-1 (]: Acquiring new duckdb connection 'test.vg_casestudy.accepted_values_marts__loans_enriched_loan_term__12__24__36__48__60.21f8e81786'
[0m09:57:49.851601 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.accepted_values_marts__loans_enriched_loan_term__12__24__36__48__60.21f8e81786
[0m09:57:49.869533 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.accepted_values_marts__loans_enriched_loan_term__12__24__36__48__60.21f8e81786"
[0m09:57:49.871472 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.accepted_values_marts__loans_enriched_loan_term__12__24__36__48__60.21f8e81786 (compile): 09:57:49.851862 => 09:57:49.871139
[0m09:57:49.871959 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.accepted_values_marts__loans_enriched_loan_term__12__24__36__48__60.21f8e81786
[0m09:57:49.887989 [debug] [Thread-1 (]: Writing runtime sql for node "test.vg_casestudy.accepted_values_marts__loans_enriched_loan_term__12__24__36__48__60.21f8e81786"
[0m09:57:49.890317 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.accepted_values_marts__loans_enriched_loan_term__12__24__36__48__60.21f8e81786"
[0m09:57:49.890701 [debug] [Thread-1 (]: On test.vg_casestudy.accepted_values_marts__loans_enriched_loan_term__12__24__36__48__60.21f8e81786: BEGIN
[0m09:57:49.891007 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m09:57:49.906277 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:57:49.906997 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.accepted_values_marts__loans_enriched_loan_term__12__24__36__48__60.21f8e81786"
[0m09:57:49.907429 [debug] [Thread-1 (]: On test.vg_casestudy.accepted_values_marts__loans_enriched_loan_term__12__24__36__48__60.21f8e81786: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "test.vg_casestudy.accepted_values_marts__loans_enriched_loan_term__12__24__36__48__60.21f8e81786"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        loan_term as value_field,
        count(*) as n_records

    from "casestudy"."marts"."marts__loans_enriched"
    group by loan_term

)

select *
from all_values
where value_field not in (
    '12','24','36','48','60'
)



      
    ) dbt_internal_test
[0m09:57:49.922184 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:57:49.925462 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.accepted_values_marts__loans_enriched_loan_term__12__24__36__48__60.21f8e81786 (execute): 09:57:49.872223 => 09:57:49.925193
[0m09:57:49.925954 [debug] [Thread-1 (]: On test.vg_casestudy.accepted_values_marts__loans_enriched_loan_term__12__24__36__48__60.21f8e81786: ROLLBACK
[0m09:57:49.926580 [debug] [Thread-1 (]: Failed to rollback 'test.vg_casestudy.accepted_values_marts__loans_enriched_loan_term__12__24__36__48__60.21f8e81786'
[0m09:57:49.926949 [debug] [Thread-1 (]: On test.vg_casestudy.accepted_values_marts__loans_enriched_loan_term__12__24__36__48__60.21f8e81786: Close
[0m09:57:49.930233 [info ] [Thread-1 (]: 1 of 26 PASS accepted_values_marts__loans_enriched_loan_term__12__24__36__48__60  [[32mPASS[0m in 0.08s]
[0m09:57:49.930953 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.accepted_values_marts__loans_enriched_loan_term__12__24__36__48__60.21f8e81786
[0m09:57:49.931390 [debug] [Thread-1 (]: Began running node test.vg_casestudy.date_is_past_marts__loans_enriched_approval_rejection_date.a81ce407f3
[0m09:57:49.931912 [info ] [Thread-1 (]: 2 of 26 START test date_is_past_marts__loans_enriched_approval_rejection_date .. [RUN]
[0m09:57:49.932633 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.accepted_values_marts__loans_enriched_loan_term__12__24__36__48__60.21f8e81786, now test.vg_casestudy.date_is_past_marts__loans_enriched_approval_rejection_date.a81ce407f3)
[0m09:57:49.932976 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.date_is_past_marts__loans_enriched_approval_rejection_date.a81ce407f3
[0m09:57:49.937923 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.date_is_past_marts__loans_enriched_approval_rejection_date.a81ce407f3"
[0m09:57:49.938753 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.date_is_past_marts__loans_enriched_approval_rejection_date.a81ce407f3 (compile): 09:57:49.933213 => 09:57:49.938472
[0m09:57:49.939195 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.date_is_past_marts__loans_enriched_approval_rejection_date.a81ce407f3
[0m09:57:49.942140 [debug] [Thread-1 (]: Writing runtime sql for node "test.vg_casestudy.date_is_past_marts__loans_enriched_approval_rejection_date.a81ce407f3"
[0m09:57:49.942869 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.date_is_past_marts__loans_enriched_approval_rejection_date.a81ce407f3"
[0m09:57:49.943235 [debug] [Thread-1 (]: On test.vg_casestudy.date_is_past_marts__loans_enriched_approval_rejection_date.a81ce407f3: BEGIN
[0m09:57:49.943731 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:57:49.956829 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:57:49.957301 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.date_is_past_marts__loans_enriched_approval_rejection_date.a81ce407f3"
[0m09:57:49.957644 [debug] [Thread-1 (]: On test.vg_casestudy.date_is_past_marts__loans_enriched_approval_rejection_date.a81ce407f3: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "test.vg_casestudy.date_is_past_marts__loans_enriched_approval_rejection_date.a81ce407f3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

    select *
    from "casestudy"."marts"."marts__loans_enriched"
    where approval_rejection_date > current_date()
    

      
    ) dbt_internal_test
[0m09:57:49.963606 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:57:49.965387 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.date_is_past_marts__loans_enriched_approval_rejection_date.a81ce407f3 (execute): 09:57:49.939451 => 09:57:49.965165
[0m09:57:49.965789 [debug] [Thread-1 (]: On test.vg_casestudy.date_is_past_marts__loans_enriched_approval_rejection_date.a81ce407f3: ROLLBACK
[0m09:57:49.966283 [debug] [Thread-1 (]: Failed to rollback 'test.vg_casestudy.date_is_past_marts__loans_enriched_approval_rejection_date.a81ce407f3'
[0m09:57:49.966614 [debug] [Thread-1 (]: On test.vg_casestudy.date_is_past_marts__loans_enriched_approval_rejection_date.a81ce407f3: Close
[0m09:57:49.969390 [info ] [Thread-1 (]: 2 of 26 PASS date_is_past_marts__loans_enriched_approval_rejection_date ........ [[32mPASS[0m in 0.04s]
[0m09:57:49.970038 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.date_is_past_marts__loans_enriched_approval_rejection_date.a81ce407f3
[0m09:57:49.970459 [debug] [Thread-1 (]: Began running node test.vg_casestudy.not_null_marts__customers_enriched_customer_id.9f6b6e0d1d
[0m09:57:49.970971 [info ] [Thread-1 (]: 3 of 26 START test not_null_marts__customers_enriched_customer_id .............. [RUN]
[0m09:57:49.971684 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.date_is_past_marts__loans_enriched_approval_rejection_date.a81ce407f3, now test.vg_casestudy.not_null_marts__customers_enriched_customer_id.9f6b6e0d1d)
[0m09:57:49.972036 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.not_null_marts__customers_enriched_customer_id.9f6b6e0d1d
[0m09:57:49.980731 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.not_null_marts__customers_enriched_customer_id.9f6b6e0d1d"
[0m09:57:49.982236 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_marts__customers_enriched_customer_id.9f6b6e0d1d (compile): 09:57:49.972278 => 09:57:49.981964
[0m09:57:49.982667 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.not_null_marts__customers_enriched_customer_id.9f6b6e0d1d
[0m09:57:49.985801 [debug] [Thread-1 (]: Writing runtime sql for node "test.vg_casestudy.not_null_marts__customers_enriched_customer_id.9f6b6e0d1d"
[0m09:57:49.987581 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.not_null_marts__customers_enriched_customer_id.9f6b6e0d1d"
[0m09:57:49.988026 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_marts__customers_enriched_customer_id.9f6b6e0d1d: BEGIN
[0m09:57:49.988402 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:57:50.000983 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:57:50.001633 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.not_null_marts__customers_enriched_customer_id.9f6b6e0d1d"
[0m09:57:50.002044 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_marts__customers_enriched_customer_id.9f6b6e0d1d: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "test.vg_casestudy.not_null_marts__customers_enriched_customer_id.9f6b6e0d1d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from "casestudy"."marts"."marts__customers_enriched"
where customer_id is null



      
    ) dbt_internal_test
[0m09:57:50.004976 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:57:50.006638 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_marts__customers_enriched_customer_id.9f6b6e0d1d (execute): 09:57:49.982941 => 09:57:50.006407
[0m09:57:50.007043 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_marts__customers_enriched_customer_id.9f6b6e0d1d: ROLLBACK
[0m09:57:50.007529 [debug] [Thread-1 (]: Failed to rollback 'test.vg_casestudy.not_null_marts__customers_enriched_customer_id.9f6b6e0d1d'
[0m09:57:50.007867 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_marts__customers_enriched_customer_id.9f6b6e0d1d: Close
[0m09:57:50.010796 [info ] [Thread-1 (]: 3 of 26 PASS not_null_marts__customers_enriched_customer_id .................... [[32mPASS[0m in 0.04s]
[0m09:57:50.011502 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.not_null_marts__customers_enriched_customer_id.9f6b6e0d1d
[0m09:57:50.011920 [debug] [Thread-1 (]: Began running node test.vg_casestudy.not_null_marts__customers_enriched_has_account.138534d95d
[0m09:57:50.012300 [info ] [Thread-1 (]: 4 of 26 START test not_null_marts__customers_enriched_has_account .............. [RUN]
[0m09:57:50.013163 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.not_null_marts__customers_enriched_customer_id.9f6b6e0d1d, now test.vg_casestudy.not_null_marts__customers_enriched_has_account.138534d95d)
[0m09:57:50.013541 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.not_null_marts__customers_enriched_has_account.138534d95d
[0m09:57:50.017879 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.not_null_marts__customers_enriched_has_account.138534d95d"
[0m09:57:50.018617 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_marts__customers_enriched_has_account.138534d95d (compile): 09:57:50.013845 => 09:57:50.018322
[0m09:57:50.019037 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.not_null_marts__customers_enriched_has_account.138534d95d
[0m09:57:50.022144 [debug] [Thread-1 (]: Writing runtime sql for node "test.vg_casestudy.not_null_marts__customers_enriched_has_account.138534d95d"
[0m09:57:50.022882 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.not_null_marts__customers_enriched_has_account.138534d95d"
[0m09:57:50.023301 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_marts__customers_enriched_has_account.138534d95d: BEGIN
[0m09:57:50.023628 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:57:50.037332 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:57:50.037814 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.not_null_marts__customers_enriched_has_account.138534d95d"
[0m09:57:50.038178 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_marts__customers_enriched_has_account.138534d95d: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "test.vg_casestudy.not_null_marts__customers_enriched_has_account.138534d95d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select has_account
from "casestudy"."marts"."marts__customers_enriched"
where has_account is null



      
    ) dbt_internal_test
[0m09:57:50.041718 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:57:50.044302 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_marts__customers_enriched_has_account.138534d95d (execute): 09:57:50.019329 => 09:57:50.043959
[0m09:57:50.044769 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_marts__customers_enriched_has_account.138534d95d: ROLLBACK
[0m09:57:50.045305 [debug] [Thread-1 (]: Failed to rollback 'test.vg_casestudy.not_null_marts__customers_enriched_has_account.138534d95d'
[0m09:57:50.045658 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_marts__customers_enriched_has_account.138534d95d: Close
[0m09:57:50.048549 [info ] [Thread-1 (]: 4 of 26 PASS not_null_marts__customers_enriched_has_account .................... [[32mPASS[0m in 0.04s]
[0m09:57:50.049283 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.not_null_marts__customers_enriched_has_account.138534d95d
[0m09:57:50.049734 [debug] [Thread-1 (]: Began running node test.vg_casestudy.not_null_marts__loans_enriched_approval_rejection_date.02c905742e
[0m09:57:50.050098 [info ] [Thread-1 (]: 5 of 26 START test not_null_marts__loans_enriched_approval_rejection_date ...... [RUN]
[0m09:57:50.050909 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.not_null_marts__customers_enriched_has_account.138534d95d, now test.vg_casestudy.not_null_marts__loans_enriched_approval_rejection_date.02c905742e)
[0m09:57:50.051255 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.not_null_marts__loans_enriched_approval_rejection_date.02c905742e
[0m09:57:50.055605 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.not_null_marts__loans_enriched_approval_rejection_date.02c905742e"
[0m09:57:50.056489 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_marts__loans_enriched_approval_rejection_date.02c905742e (compile): 09:57:50.051488 => 09:57:50.056240
[0m09:57:50.056933 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.not_null_marts__loans_enriched_approval_rejection_date.02c905742e
[0m09:57:50.060422 [debug] [Thread-1 (]: Writing runtime sql for node "test.vg_casestudy.not_null_marts__loans_enriched_approval_rejection_date.02c905742e"
[0m09:57:50.061329 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.not_null_marts__loans_enriched_approval_rejection_date.02c905742e"
[0m09:57:50.061770 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_marts__loans_enriched_approval_rejection_date.02c905742e: BEGIN
[0m09:57:50.062127 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:57:50.077323 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:57:50.078010 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.not_null_marts__loans_enriched_approval_rejection_date.02c905742e"
[0m09:57:50.078388 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_marts__loans_enriched_approval_rejection_date.02c905742e: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "test.vg_casestudy.not_null_marts__loans_enriched_approval_rejection_date.02c905742e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select approval_rejection_date
from "casestudy"."marts"."marts__loans_enriched"
where approval_rejection_date is null



      
    ) dbt_internal_test
[0m09:57:50.084037 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:57:50.085772 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_marts__loans_enriched_approval_rejection_date.02c905742e (execute): 09:57:50.057207 => 09:57:50.085548
[0m09:57:50.086179 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_marts__loans_enriched_approval_rejection_date.02c905742e: ROLLBACK
[0m09:57:50.086656 [debug] [Thread-1 (]: Failed to rollback 'test.vg_casestudy.not_null_marts__loans_enriched_approval_rejection_date.02c905742e'
[0m09:57:50.086983 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_marts__loans_enriched_approval_rejection_date.02c905742e: Close
[0m09:57:50.090010 [info ] [Thread-1 (]: 5 of 26 PASS not_null_marts__loans_enriched_approval_rejection_date ............ [[32mPASS[0m in 0.04s]
[0m09:57:50.090860 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.not_null_marts__loans_enriched_approval_rejection_date.02c905742e
[0m09:57:50.091375 [debug] [Thread-1 (]: Began running node test.vg_casestudy.not_null_marts__loans_enriched_customer_id.00cac09a92
[0m09:57:50.091741 [info ] [Thread-1 (]: 6 of 26 START test not_null_marts__loans_enriched_customer_id .................. [RUN]
[0m09:57:50.092663 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.not_null_marts__loans_enriched_approval_rejection_date.02c905742e, now test.vg_casestudy.not_null_marts__loans_enriched_customer_id.00cac09a92)
[0m09:57:50.093089 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.not_null_marts__loans_enriched_customer_id.00cac09a92
[0m09:57:50.098051 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.not_null_marts__loans_enriched_customer_id.00cac09a92"
[0m09:57:50.099065 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_marts__loans_enriched_customer_id.00cac09a92 (compile): 09:57:50.093344 => 09:57:50.098755
[0m09:57:50.099503 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.not_null_marts__loans_enriched_customer_id.00cac09a92
[0m09:57:50.102250 [debug] [Thread-1 (]: Writing runtime sql for node "test.vg_casestudy.not_null_marts__loans_enriched_customer_id.00cac09a92"
[0m09:57:50.102958 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.not_null_marts__loans_enriched_customer_id.00cac09a92"
[0m09:57:50.103307 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_marts__loans_enriched_customer_id.00cac09a92: BEGIN
[0m09:57:50.103625 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:57:50.118622 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:57:50.119122 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.not_null_marts__loans_enriched_customer_id.00cac09a92"
[0m09:57:50.119493 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_marts__loans_enriched_customer_id.00cac09a92: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "test.vg_casestudy.not_null_marts__loans_enriched_customer_id.00cac09a92"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from "casestudy"."marts"."marts__loans_enriched"
where customer_id is null



      
    ) dbt_internal_test
[0m09:57:50.123568 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:57:50.125511 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_marts__loans_enriched_customer_id.00cac09a92 (execute): 09:57:50.099762 => 09:57:50.125294
[0m09:57:50.126053 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_marts__loans_enriched_customer_id.00cac09a92: ROLLBACK
[0m09:57:50.126619 [debug] [Thread-1 (]: Failed to rollback 'test.vg_casestudy.not_null_marts__loans_enriched_customer_id.00cac09a92'
[0m09:57:50.126955 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_marts__loans_enriched_customer_id.00cac09a92: Close
[0m09:57:50.129900 [info ] [Thread-1 (]: 6 of 26 PASS not_null_marts__loans_enriched_customer_id ........................ [[32mPASS[0m in 0.04s]
[0m09:57:50.130660 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.not_null_marts__loans_enriched_customer_id.00cac09a92
[0m09:57:50.131119 [debug] [Thread-1 (]: Began running node test.vg_casestudy.not_null_marts__loans_enriched_has_account.210268f1d2
[0m09:57:50.131486 [info ] [Thread-1 (]: 7 of 26 START test not_null_marts__loans_enriched_has_account .................. [RUN]
[0m09:57:50.132619 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.not_null_marts__loans_enriched_customer_id.00cac09a92, now test.vg_casestudy.not_null_marts__loans_enriched_has_account.210268f1d2)
[0m09:57:50.133113 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.not_null_marts__loans_enriched_has_account.210268f1d2
[0m09:57:50.137466 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.not_null_marts__loans_enriched_has_account.210268f1d2"
[0m09:57:50.138404 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_marts__loans_enriched_has_account.210268f1d2 (compile): 09:57:50.133355 => 09:57:50.138131
[0m09:57:50.138818 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.not_null_marts__loans_enriched_has_account.210268f1d2
[0m09:57:50.141673 [debug] [Thread-1 (]: Writing runtime sql for node "test.vg_casestudy.not_null_marts__loans_enriched_has_account.210268f1d2"
[0m09:57:50.142478 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.not_null_marts__loans_enriched_has_account.210268f1d2"
[0m09:57:50.143076 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_marts__loans_enriched_has_account.210268f1d2: BEGIN
[0m09:57:50.143619 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:57:50.161409 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:57:50.161955 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.not_null_marts__loans_enriched_has_account.210268f1d2"
[0m09:57:50.162302 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_marts__loans_enriched_has_account.210268f1d2: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "test.vg_casestudy.not_null_marts__loans_enriched_has_account.210268f1d2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select has_account
from "casestudy"."marts"."marts__loans_enriched"
where has_account is null



      
    ) dbt_internal_test
[0m09:57:50.167482 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:57:50.169204 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_marts__loans_enriched_has_account.210268f1d2 (execute): 09:57:50.139067 => 09:57:50.168921
[0m09:57:50.169677 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_marts__loans_enriched_has_account.210268f1d2: ROLLBACK
[0m09:57:50.170195 [debug] [Thread-1 (]: Failed to rollback 'test.vg_casestudy.not_null_marts__loans_enriched_has_account.210268f1d2'
[0m09:57:50.170527 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_marts__loans_enriched_has_account.210268f1d2: Close
[0m09:57:50.173572 [info ] [Thread-1 (]: 7 of 26 PASS not_null_marts__loans_enriched_has_account ........................ [[32mPASS[0m in 0.04s]
[0m09:57:50.174356 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.not_null_marts__loans_enriched_has_account.210268f1d2
[0m09:57:50.174770 [debug] [Thread-1 (]: Began running node test.vg_casestudy.not_null_marts__loans_enriched_interest_rate.d5d58de544
[0m09:57:50.175120 [info ] [Thread-1 (]: 8 of 26 START test not_null_marts__loans_enriched_interest_rate ................ [RUN]
[0m09:57:50.176070 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.not_null_marts__loans_enriched_has_account.210268f1d2, now test.vg_casestudy.not_null_marts__loans_enriched_interest_rate.d5d58de544)
[0m09:57:50.176550 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.not_null_marts__loans_enriched_interest_rate.d5d58de544
[0m09:57:50.181262 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.not_null_marts__loans_enriched_interest_rate.d5d58de544"
[0m09:57:50.182312 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_marts__loans_enriched_interest_rate.d5d58de544 (compile): 09:57:50.176804 => 09:57:50.182005
[0m09:57:50.182784 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.not_null_marts__loans_enriched_interest_rate.d5d58de544
[0m09:57:50.186726 [debug] [Thread-1 (]: Writing runtime sql for node "test.vg_casestudy.not_null_marts__loans_enriched_interest_rate.d5d58de544"
[0m09:57:50.187632 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.not_null_marts__loans_enriched_interest_rate.d5d58de544"
[0m09:57:50.188047 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_marts__loans_enriched_interest_rate.d5d58de544: BEGIN
[0m09:57:50.188361 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:57:50.203073 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:57:50.203571 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.not_null_marts__loans_enriched_interest_rate.d5d58de544"
[0m09:57:50.203965 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_marts__loans_enriched_interest_rate.d5d58de544: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "test.vg_casestudy.not_null_marts__loans_enriched_interest_rate.d5d58de544"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select interest_rate
from "casestudy"."marts"."marts__loans_enriched"
where interest_rate is null



      
    ) dbt_internal_test
[0m09:57:50.208369 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:57:50.210871 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_marts__loans_enriched_interest_rate.d5d58de544 (execute): 09:57:50.183170 => 09:57:50.210555
[0m09:57:50.211417 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_marts__loans_enriched_interest_rate.d5d58de544: ROLLBACK
[0m09:57:50.212348 [debug] [Thread-1 (]: Failed to rollback 'test.vg_casestudy.not_null_marts__loans_enriched_interest_rate.d5d58de544'
[0m09:57:50.212878 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_marts__loans_enriched_interest_rate.d5d58de544: Close
[0m09:57:50.217266 [info ] [Thread-1 (]: 8 of 26 PASS not_null_marts__loans_enriched_interest_rate ...................... [[32mPASS[0m in 0.04s]
[0m09:57:50.218205 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.not_null_marts__loans_enriched_interest_rate.d5d58de544
[0m09:57:50.218699 [debug] [Thread-1 (]: Began running node test.vg_casestudy.not_null_marts__loans_enriched_loan_amount.7ac237f98a
[0m09:57:50.219081 [info ] [Thread-1 (]: 9 of 26 START test not_null_marts__loans_enriched_loan_amount .................. [RUN]
[0m09:57:50.220043 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.not_null_marts__loans_enriched_interest_rate.d5d58de544, now test.vg_casestudy.not_null_marts__loans_enriched_loan_amount.7ac237f98a)
[0m09:57:50.220472 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.not_null_marts__loans_enriched_loan_amount.7ac237f98a
[0m09:57:50.225106 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.not_null_marts__loans_enriched_loan_amount.7ac237f98a"
[0m09:57:50.226032 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_marts__loans_enriched_loan_amount.7ac237f98a (compile): 09:57:50.220735 => 09:57:50.225756
[0m09:57:50.226547 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.not_null_marts__loans_enriched_loan_amount.7ac237f98a
[0m09:57:50.229687 [debug] [Thread-1 (]: Writing runtime sql for node "test.vg_casestudy.not_null_marts__loans_enriched_loan_amount.7ac237f98a"
[0m09:57:50.230370 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.not_null_marts__loans_enriched_loan_amount.7ac237f98a"
[0m09:57:50.230737 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_marts__loans_enriched_loan_amount.7ac237f98a: BEGIN
[0m09:57:50.231059 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:57:50.245074 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:57:50.245739 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.not_null_marts__loans_enriched_loan_amount.7ac237f98a"
[0m09:57:50.246242 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_marts__loans_enriched_loan_amount.7ac237f98a: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "test.vg_casestudy.not_null_marts__loans_enriched_loan_amount.7ac237f98a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select loan_amount
from "casestudy"."marts"."marts__loans_enriched"
where loan_amount is null



      
    ) dbt_internal_test
[0m09:57:50.252154 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:57:50.254053 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_marts__loans_enriched_loan_amount.7ac237f98a (execute): 09:57:50.226809 => 09:57:50.253796
[0m09:57:50.254501 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_marts__loans_enriched_loan_amount.7ac237f98a: ROLLBACK
[0m09:57:50.254984 [debug] [Thread-1 (]: Failed to rollback 'test.vg_casestudy.not_null_marts__loans_enriched_loan_amount.7ac237f98a'
[0m09:57:50.255324 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_marts__loans_enriched_loan_amount.7ac237f98a: Close
[0m09:57:50.259154 [info ] [Thread-1 (]: 9 of 26 PASS not_null_marts__loans_enriched_loan_amount ........................ [[32mPASS[0m in 0.04s]
[0m09:57:50.260026 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.not_null_marts__loans_enriched_loan_amount.7ac237f98a
[0m09:57:50.260578 [debug] [Thread-1 (]: Began running node test.vg_casestudy.not_null_marts__loans_enriched_loan_id.b4ebbacf31
[0m09:57:50.261251 [info ] [Thread-1 (]: 10 of 26 START test not_null_marts__loans_enriched_loan_id ..................... [RUN]
[0m09:57:50.262136 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.not_null_marts__loans_enriched_loan_amount.7ac237f98a, now test.vg_casestudy.not_null_marts__loans_enriched_loan_id.b4ebbacf31)
[0m09:57:50.262517 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.not_null_marts__loans_enriched_loan_id.b4ebbacf31
[0m09:57:50.267473 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.not_null_marts__loans_enriched_loan_id.b4ebbacf31"
[0m09:57:50.268318 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_marts__loans_enriched_loan_id.b4ebbacf31 (compile): 09:57:50.262769 => 09:57:50.268086
[0m09:57:50.268693 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.not_null_marts__loans_enriched_loan_id.b4ebbacf31
[0m09:57:50.271310 [debug] [Thread-1 (]: Writing runtime sql for node "test.vg_casestudy.not_null_marts__loans_enriched_loan_id.b4ebbacf31"
[0m09:57:50.271894 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.not_null_marts__loans_enriched_loan_id.b4ebbacf31"
[0m09:57:50.272222 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_marts__loans_enriched_loan_id.b4ebbacf31: BEGIN
[0m09:57:50.272519 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:57:50.287177 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:57:50.287619 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.not_null_marts__loans_enriched_loan_id.b4ebbacf31"
[0m09:57:50.287974 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_marts__loans_enriched_loan_id.b4ebbacf31: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "test.vg_casestudy.not_null_marts__loans_enriched_loan_id.b4ebbacf31"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select loan_id
from "casestudy"."marts"."marts__loans_enriched"
where loan_id is null



      
    ) dbt_internal_test
[0m09:57:50.292304 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:57:50.294725 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_marts__loans_enriched_loan_id.b4ebbacf31 (execute): 09:57:50.268942 => 09:57:50.294388
[0m09:57:50.295372 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_marts__loans_enriched_loan_id.b4ebbacf31: ROLLBACK
[0m09:57:50.295888 [debug] [Thread-1 (]: Failed to rollback 'test.vg_casestudy.not_null_marts__loans_enriched_loan_id.b4ebbacf31'
[0m09:57:50.296220 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_marts__loans_enriched_loan_id.b4ebbacf31: Close
[0m09:57:50.299355 [info ] [Thread-1 (]: 10 of 26 PASS not_null_marts__loans_enriched_loan_id ........................... [[32mPASS[0m in 0.04s]
[0m09:57:50.300099 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.not_null_marts__loans_enriched_loan_id.b4ebbacf31
[0m09:57:50.300525 [debug] [Thread-1 (]: Began running node test.vg_casestudy.not_null_marts__loans_enriched_loan_status.4490ac67ad
[0m09:57:50.300900 [info ] [Thread-1 (]: 11 of 26 START test not_null_marts__loans_enriched_loan_status ................. [RUN]
[0m09:57:50.301974 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.not_null_marts__loans_enriched_loan_id.b4ebbacf31, now test.vg_casestudy.not_null_marts__loans_enriched_loan_status.4490ac67ad)
[0m09:57:50.302368 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.not_null_marts__loans_enriched_loan_status.4490ac67ad
[0m09:57:50.307196 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.not_null_marts__loans_enriched_loan_status.4490ac67ad"
[0m09:57:50.308047 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_marts__loans_enriched_loan_status.4490ac67ad (compile): 09:57:50.302613 => 09:57:50.307808
[0m09:57:50.308477 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.not_null_marts__loans_enriched_loan_status.4490ac67ad
[0m09:57:50.311587 [debug] [Thread-1 (]: Writing runtime sql for node "test.vg_casestudy.not_null_marts__loans_enriched_loan_status.4490ac67ad"
[0m09:57:50.312441 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.not_null_marts__loans_enriched_loan_status.4490ac67ad"
[0m09:57:50.312859 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_marts__loans_enriched_loan_status.4490ac67ad: BEGIN
[0m09:57:50.313217 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:57:50.346135 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:57:50.357262 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.not_null_marts__loans_enriched_loan_status.4490ac67ad"
[0m09:57:50.358062 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_marts__loans_enriched_loan_status.4490ac67ad: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "test.vg_casestudy.not_null_marts__loans_enriched_loan_status.4490ac67ad"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select loan_status
from "casestudy"."marts"."marts__loans_enriched"
where loan_status is null



      
    ) dbt_internal_test
[0m09:57:50.364667 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:57:50.366688 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_marts__loans_enriched_loan_status.4490ac67ad (execute): 09:57:50.308804 => 09:57:50.366439
[0m09:57:50.369259 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_marts__loans_enriched_loan_status.4490ac67ad: ROLLBACK
[0m09:57:50.370302 [debug] [Thread-1 (]: Failed to rollback 'test.vg_casestudy.not_null_marts__loans_enriched_loan_status.4490ac67ad'
[0m09:57:50.372091 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_marts__loans_enriched_loan_status.4490ac67ad: Close
[0m09:57:50.376524 [info ] [Thread-1 (]: 11 of 26 PASS not_null_marts__loans_enriched_loan_status ....................... [[32mPASS[0m in 0.07s]
[0m09:57:50.377571 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.not_null_marts__loans_enriched_loan_status.4490ac67ad
[0m09:57:50.378257 [debug] [Thread-1 (]: Began running node test.vg_casestudy.not_null_marts__loans_enriched_loan_term.ed68e0638e
[0m09:57:50.378919 [info ] [Thread-1 (]: 12 of 26 START test not_null_marts__loans_enriched_loan_term ................... [RUN]
[0m09:57:50.379757 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.not_null_marts__loans_enriched_loan_status.4490ac67ad, now test.vg_casestudy.not_null_marts__loans_enriched_loan_term.ed68e0638e)
[0m09:57:50.380264 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.not_null_marts__loans_enriched_loan_term.ed68e0638e
[0m09:57:50.385560 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.not_null_marts__loans_enriched_loan_term.ed68e0638e"
[0m09:57:50.386636 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_marts__loans_enriched_loan_term.ed68e0638e (compile): 09:57:50.380601 => 09:57:50.386287
[0m09:57:50.387132 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.not_null_marts__loans_enriched_loan_term.ed68e0638e
[0m09:57:50.391813 [debug] [Thread-1 (]: Writing runtime sql for node "test.vg_casestudy.not_null_marts__loans_enriched_loan_term.ed68e0638e"
[0m09:57:50.393003 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.not_null_marts__loans_enriched_loan_term.ed68e0638e"
[0m09:57:50.393658 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_marts__loans_enriched_loan_term.ed68e0638e: BEGIN
[0m09:57:50.394560 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:57:50.407483 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:57:50.407969 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.not_null_marts__loans_enriched_loan_term.ed68e0638e"
[0m09:57:50.408317 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_marts__loans_enriched_loan_term.ed68e0638e: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "test.vg_casestudy.not_null_marts__loans_enriched_loan_term.ed68e0638e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select loan_term
from "casestudy"."marts"."marts__loans_enriched"
where loan_term is null



      
    ) dbt_internal_test
[0m09:57:50.413115 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:57:50.415490 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_marts__loans_enriched_loan_term.ed68e0638e (execute): 09:57:50.387394 => 09:57:50.415146
[0m09:57:50.416081 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_marts__loans_enriched_loan_term.ed68e0638e: ROLLBACK
[0m09:57:50.416737 [debug] [Thread-1 (]: Failed to rollback 'test.vg_casestudy.not_null_marts__loans_enriched_loan_term.ed68e0638e'
[0m09:57:50.417174 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_marts__loans_enriched_loan_term.ed68e0638e: Close
[0m09:57:50.420242 [info ] [Thread-1 (]: 12 of 26 PASS not_null_marts__loans_enriched_loan_term ......................... [[32mPASS[0m in 0.04s]
[0m09:57:50.420938 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.not_null_marts__loans_enriched_loan_term.ed68e0638e
[0m09:57:50.421358 [debug] [Thread-1 (]: Began running node test.vg_casestudy.not_null_marts__loans_enriched_loan_type.9ad7e6410e
[0m09:57:50.421721 [info ] [Thread-1 (]: 13 of 26 START test not_null_marts__loans_enriched_loan_type ................... [RUN]
[0m09:57:50.422438 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.not_null_marts__loans_enriched_loan_term.ed68e0638e, now test.vg_casestudy.not_null_marts__loans_enriched_loan_type.9ad7e6410e)
[0m09:57:50.422897 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.not_null_marts__loans_enriched_loan_type.9ad7e6410e
[0m09:57:50.428844 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.not_null_marts__loans_enriched_loan_type.9ad7e6410e"
[0m09:57:50.430178 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_marts__loans_enriched_loan_type.9ad7e6410e (compile): 09:57:50.423146 => 09:57:50.429633
[0m09:57:50.430892 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.not_null_marts__loans_enriched_loan_type.9ad7e6410e
[0m09:57:50.434861 [debug] [Thread-1 (]: Writing runtime sql for node "test.vg_casestudy.not_null_marts__loans_enriched_loan_type.9ad7e6410e"
[0m09:57:50.435785 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.not_null_marts__loans_enriched_loan_type.9ad7e6410e"
[0m09:57:50.436198 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_marts__loans_enriched_loan_type.9ad7e6410e: BEGIN
[0m09:57:50.436545 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:57:50.452743 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:57:50.453466 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.not_null_marts__loans_enriched_loan_type.9ad7e6410e"
[0m09:57:50.454014 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_marts__loans_enriched_loan_type.9ad7e6410e: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "test.vg_casestudy.not_null_marts__loans_enriched_loan_type.9ad7e6410e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select loan_type
from "casestudy"."marts"."marts__loans_enriched"
where loan_type is null



      
    ) dbt_internal_test
[0m09:57:50.458959 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:57:50.461242 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_marts__loans_enriched_loan_type.9ad7e6410e (execute): 09:57:50.431369 => 09:57:50.460984
[0m09:57:50.461819 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_marts__loans_enriched_loan_type.9ad7e6410e: ROLLBACK
[0m09:57:50.462574 [debug] [Thread-1 (]: Failed to rollback 'test.vg_casestudy.not_null_marts__loans_enriched_loan_type.9ad7e6410e'
[0m09:57:50.463042 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_marts__loans_enriched_loan_type.9ad7e6410e: Close
[0m09:57:50.467912 [info ] [Thread-1 (]: 13 of 26 PASS not_null_marts__loans_enriched_loan_type ......................... [[32mPASS[0m in 0.05s]
[0m09:57:50.469012 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.not_null_marts__loans_enriched_loan_type.9ad7e6410e
[0m09:57:50.469591 [debug] [Thread-1 (]: Began running node test.vg_casestudy.not_null_marts__transactions_with_euro_account_id.4f3997d532
[0m09:57:50.470307 [info ] [Thread-1 (]: 14 of 26 START test not_null_marts__transactions_with_euro_account_id .......... [RUN]
[0m09:57:50.471448 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.not_null_marts__loans_enriched_loan_type.9ad7e6410e, now test.vg_casestudy.not_null_marts__transactions_with_euro_account_id.4f3997d532)
[0m09:57:50.472071 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.not_null_marts__transactions_with_euro_account_id.4f3997d532
[0m09:57:50.480878 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.not_null_marts__transactions_with_euro_account_id.4f3997d532"
[0m09:57:50.484601 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_marts__transactions_with_euro_account_id.4f3997d532 (compile): 09:57:50.472377 => 09:57:50.484154
[0m09:57:50.485121 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.not_null_marts__transactions_with_euro_account_id.4f3997d532
[0m09:57:50.488721 [debug] [Thread-1 (]: Writing runtime sql for node "test.vg_casestudy.not_null_marts__transactions_with_euro_account_id.4f3997d532"
[0m09:57:50.490095 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.not_null_marts__transactions_with_euro_account_id.4f3997d532"
[0m09:57:50.490552 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_marts__transactions_with_euro_account_id.4f3997d532: BEGIN
[0m09:57:50.491023 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:57:50.510780 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:57:50.511603 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.not_null_marts__transactions_with_euro_account_id.4f3997d532"
[0m09:57:50.512333 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_marts__transactions_with_euro_account_id.4f3997d532: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "test.vg_casestudy.not_null_marts__transactions_with_euro_account_id.4f3997d532"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select account_id
from "casestudy"."marts"."marts__transactions_with_euro"
where account_id is null



      
    ) dbt_internal_test
[0m09:57:50.517771 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:57:50.520032 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_marts__transactions_with_euro_account_id.4f3997d532 (execute): 09:57:50.485443 => 09:57:50.519730
[0m09:57:50.520500 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_marts__transactions_with_euro_account_id.4f3997d532: ROLLBACK
[0m09:57:50.521098 [debug] [Thread-1 (]: Failed to rollback 'test.vg_casestudy.not_null_marts__transactions_with_euro_account_id.4f3997d532'
[0m09:57:50.521607 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_marts__transactions_with_euro_account_id.4f3997d532: Close
[0m09:57:50.525442 [info ] [Thread-1 (]: 14 of 26 PASS not_null_marts__transactions_with_euro_account_id ................ [[32mPASS[0m in 0.05s]
[0m09:57:50.526448 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.not_null_marts__transactions_with_euro_account_id.4f3997d532
[0m09:57:50.527178 [debug] [Thread-1 (]: Began running node test.vg_casestudy.not_null_marts__transactions_with_euro_transaction_amount.69049a90b0
[0m09:57:50.528058 [info ] [Thread-1 (]: 15 of 26 START test not_null_marts__transactions_with_euro_transaction_amount .. [RUN]
[0m09:57:50.529051 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.not_null_marts__transactions_with_euro_account_id.4f3997d532, now test.vg_casestudy.not_null_marts__transactions_with_euro_transaction_amount.69049a90b0)
[0m09:57:50.529686 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.not_null_marts__transactions_with_euro_transaction_amount.69049a90b0
[0m09:57:50.537750 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.not_null_marts__transactions_with_euro_transaction_amount.69049a90b0"
[0m09:57:50.538759 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_marts__transactions_with_euro_transaction_amount.69049a90b0 (compile): 09:57:50.530115 => 09:57:50.538404
[0m09:57:50.539377 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.not_null_marts__transactions_with_euro_transaction_amount.69049a90b0
[0m09:57:50.543741 [debug] [Thread-1 (]: Writing runtime sql for node "test.vg_casestudy.not_null_marts__transactions_with_euro_transaction_amount.69049a90b0"
[0m09:57:50.544906 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.not_null_marts__transactions_with_euro_transaction_amount.69049a90b0"
[0m09:57:50.545558 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_marts__transactions_with_euro_transaction_amount.69049a90b0: BEGIN
[0m09:57:50.546098 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:57:50.564348 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:57:50.565130 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.not_null_marts__transactions_with_euro_transaction_amount.69049a90b0"
[0m09:57:50.565754 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_marts__transactions_with_euro_transaction_amount.69049a90b0: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "test.vg_casestudy.not_null_marts__transactions_with_euro_transaction_amount.69049a90b0"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select transaction_amount
from "casestudy"."marts"."marts__transactions_with_euro"
where transaction_amount is null



      
    ) dbt_internal_test
[0m09:57:50.569262 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:57:50.571604 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_marts__transactions_with_euro_transaction_amount.69049a90b0 (execute): 09:57:50.539740 => 09:57:50.571240
[0m09:57:50.572136 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_marts__transactions_with_euro_transaction_amount.69049a90b0: ROLLBACK
[0m09:57:50.572739 [debug] [Thread-1 (]: Failed to rollback 'test.vg_casestudy.not_null_marts__transactions_with_euro_transaction_amount.69049a90b0'
[0m09:57:50.573127 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_marts__transactions_with_euro_transaction_amount.69049a90b0: Close
[0m09:57:50.576651 [info ] [Thread-1 (]: 15 of 26 PASS not_null_marts__transactions_with_euro_transaction_amount ........ [[32mPASS[0m in 0.05s]
[0m09:57:50.577813 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.not_null_marts__transactions_with_euro_transaction_amount.69049a90b0
[0m09:57:50.578441 [debug] [Thread-1 (]: Began running node test.vg_casestudy.not_null_marts__transactions_with_euro_transaction_amount_euro.97d050c1ee
[0m09:57:50.579201 [info ] [Thread-1 (]: 16 of 26 START test not_null_marts__transactions_with_euro_transaction_amount_euro  [RUN]
[0m09:57:50.580141 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.not_null_marts__transactions_with_euro_transaction_amount.69049a90b0, now test.vg_casestudy.not_null_marts__transactions_with_euro_transaction_amount_euro.97d050c1ee)
[0m09:57:50.580592 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.not_null_marts__transactions_with_euro_transaction_amount_euro.97d050c1ee
[0m09:57:50.585800 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.not_null_marts__transactions_with_euro_transaction_amount_euro.97d050c1ee"
[0m09:57:50.586776 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_marts__transactions_with_euro_transaction_amount_euro.97d050c1ee (compile): 09:57:50.580852 => 09:57:50.586442
[0m09:57:50.587345 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.not_null_marts__transactions_with_euro_transaction_amount_euro.97d050c1ee
[0m09:57:50.590690 [debug] [Thread-1 (]: Writing runtime sql for node "test.vg_casestudy.not_null_marts__transactions_with_euro_transaction_amount_euro.97d050c1ee"
[0m09:57:50.591510 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.not_null_marts__transactions_with_euro_transaction_amount_euro.97d050c1ee"
[0m09:57:50.591989 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_marts__transactions_with_euro_transaction_amount_euro.97d050c1ee: BEGIN
[0m09:57:50.592422 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:57:50.609055 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:57:50.611284 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.not_null_marts__transactions_with_euro_transaction_amount_euro.97d050c1ee"
[0m09:57:50.612408 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_marts__transactions_with_euro_transaction_amount_euro.97d050c1ee: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "test.vg_casestudy.not_null_marts__transactions_with_euro_transaction_amount_euro.97d050c1ee"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select transaction_amount_euro
from "casestudy"."marts"."marts__transactions_with_euro"
where transaction_amount_euro is null



      
    ) dbt_internal_test
[0m09:57:50.630205 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:57:50.635109 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_marts__transactions_with_euro_transaction_amount_euro.97d050c1ee (execute): 09:57:50.587623 => 09:57:50.634596
[0m09:57:50.636062 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_marts__transactions_with_euro_transaction_amount_euro.97d050c1ee: ROLLBACK
[0m09:57:50.637201 [debug] [Thread-1 (]: Failed to rollback 'test.vg_casestudy.not_null_marts__transactions_with_euro_transaction_amount_euro.97d050c1ee'
[0m09:57:50.637991 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_marts__transactions_with_euro_transaction_amount_euro.97d050c1ee: Close
[0m09:57:50.645031 [info ] [Thread-1 (]: 16 of 26 PASS not_null_marts__transactions_with_euro_transaction_amount_euro ... [[32mPASS[0m in 0.06s]
[0m09:57:50.646312 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.not_null_marts__transactions_with_euro_transaction_amount_euro.97d050c1ee
[0m09:57:50.647027 [debug] [Thread-1 (]: Began running node test.vg_casestudy.not_null_marts__transactions_with_euro_transaction_date.721c98ce00
[0m09:57:50.647776 [info ] [Thread-1 (]: 17 of 26 START test not_null_marts__transactions_with_euro_transaction_date .... [RUN]
[0m09:57:50.648713 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.not_null_marts__transactions_with_euro_transaction_amount_euro.97d050c1ee, now test.vg_casestudy.not_null_marts__transactions_with_euro_transaction_date.721c98ce00)
[0m09:57:50.649197 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.not_null_marts__transactions_with_euro_transaction_date.721c98ce00
[0m09:57:50.658465 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.not_null_marts__transactions_with_euro_transaction_date.721c98ce00"
[0m09:57:50.659549 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_marts__transactions_with_euro_transaction_date.721c98ce00 (compile): 09:57:50.649460 => 09:57:50.659187
[0m09:57:50.660093 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.not_null_marts__transactions_with_euro_transaction_date.721c98ce00
[0m09:57:50.664408 [debug] [Thread-1 (]: Writing runtime sql for node "test.vg_casestudy.not_null_marts__transactions_with_euro_transaction_date.721c98ce00"
[0m09:57:50.665583 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.not_null_marts__transactions_with_euro_transaction_date.721c98ce00"
[0m09:57:50.666207 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_marts__transactions_with_euro_transaction_date.721c98ce00: BEGIN
[0m09:57:50.666681 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:57:50.686507 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:57:50.687395 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.not_null_marts__transactions_with_euro_transaction_date.721c98ce00"
[0m09:57:50.687999 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_marts__transactions_with_euro_transaction_date.721c98ce00: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "test.vg_casestudy.not_null_marts__transactions_with_euro_transaction_date.721c98ce00"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select transaction_date
from "casestudy"."marts"."marts__transactions_with_euro"
where transaction_date is null



      
    ) dbt_internal_test
[0m09:57:50.691331 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:57:50.693931 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_marts__transactions_with_euro_transaction_date.721c98ce00 (execute): 09:57:50.660521 => 09:57:50.693394
[0m09:57:50.694582 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_marts__transactions_with_euro_transaction_date.721c98ce00: ROLLBACK
[0m09:57:50.695595 [debug] [Thread-1 (]: Failed to rollback 'test.vg_casestudy.not_null_marts__transactions_with_euro_transaction_date.721c98ce00'
[0m09:57:50.696375 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_marts__transactions_with_euro_transaction_date.721c98ce00: Close
[0m09:57:50.700031 [info ] [Thread-1 (]: 17 of 26 PASS not_null_marts__transactions_with_euro_transaction_date .......... [[32mPASS[0m in 0.05s]
[0m09:57:50.701014 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.not_null_marts__transactions_with_euro_transaction_date.721c98ce00
[0m09:57:50.701580 [debug] [Thread-1 (]: Began running node test.vg_casestudy.not_null_marts__transactions_with_euro_transaction_id.6e046ff102
[0m09:57:50.702240 [info ] [Thread-1 (]: 18 of 26 START test not_null_marts__transactions_with_euro_transaction_id ...... [RUN]
[0m09:57:50.703280 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.not_null_marts__transactions_with_euro_transaction_date.721c98ce00, now test.vg_casestudy.not_null_marts__transactions_with_euro_transaction_id.6e046ff102)
[0m09:57:50.703772 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.not_null_marts__transactions_with_euro_transaction_id.6e046ff102
[0m09:57:50.710798 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.not_null_marts__transactions_with_euro_transaction_id.6e046ff102"
[0m09:57:50.712086 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_marts__transactions_with_euro_transaction_id.6e046ff102 (compile): 09:57:50.704130 => 09:57:50.711726
[0m09:57:50.712792 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.not_null_marts__transactions_with_euro_transaction_id.6e046ff102
[0m09:57:50.717342 [debug] [Thread-1 (]: Writing runtime sql for node "test.vg_casestudy.not_null_marts__transactions_with_euro_transaction_id.6e046ff102"
[0m09:57:50.718335 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.not_null_marts__transactions_with_euro_transaction_id.6e046ff102"
[0m09:57:50.718938 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_marts__transactions_with_euro_transaction_id.6e046ff102: BEGIN
[0m09:57:50.719472 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:57:50.736525 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:57:50.737082 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.not_null_marts__transactions_with_euro_transaction_id.6e046ff102"
[0m09:57:50.737493 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_marts__transactions_with_euro_transaction_id.6e046ff102: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "test.vg_casestudy.not_null_marts__transactions_with_euro_transaction_id.6e046ff102"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select transaction_id
from "casestudy"."marts"."marts__transactions_with_euro"
where transaction_id is null



      
    ) dbt_internal_test
[0m09:57:50.740508 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:57:50.742365 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_marts__transactions_with_euro_transaction_id.6e046ff102 (execute): 09:57:50.713271 => 09:57:50.742128
[0m09:57:50.742903 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_marts__transactions_with_euro_transaction_id.6e046ff102: ROLLBACK
[0m09:57:50.743686 [debug] [Thread-1 (]: Failed to rollback 'test.vg_casestudy.not_null_marts__transactions_with_euro_transaction_id.6e046ff102'
[0m09:57:50.744441 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_marts__transactions_with_euro_transaction_id.6e046ff102: Close
[0m09:57:50.747988 [info ] [Thread-1 (]: 18 of 26 PASS not_null_marts__transactions_with_euro_transaction_id ............ [[32mPASS[0m in 0.04s]
[0m09:57:50.748713 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.not_null_marts__transactions_with_euro_transaction_id.6e046ff102
[0m09:57:50.749214 [debug] [Thread-1 (]: Began running node test.vg_casestudy.numeric_range_marts__loans_enriched_interest_rate__0.a85a00acdc
[0m09:57:50.749779 [info ] [Thread-1 (]: 19 of 26 START test numeric_range_marts__loans_enriched_interest_rate__0 ....... [RUN]
[0m09:57:50.750579 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.not_null_marts__transactions_with_euro_transaction_id.6e046ff102, now test.vg_casestudy.numeric_range_marts__loans_enriched_interest_rate__0.a85a00acdc)
[0m09:57:50.750966 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.numeric_range_marts__loans_enriched_interest_rate__0.a85a00acdc
[0m09:57:50.758624 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.numeric_range_marts__loans_enriched_interest_rate__0.a85a00acdc"
[0m09:57:50.759554 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.numeric_range_marts__loans_enriched_interest_rate__0.a85a00acdc (compile): 09:57:50.751216 => 09:57:50.759253
[0m09:57:50.760077 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.numeric_range_marts__loans_enriched_interest_rate__0.a85a00acdc
[0m09:57:50.763655 [debug] [Thread-1 (]: Writing runtime sql for node "test.vg_casestudy.numeric_range_marts__loans_enriched_interest_rate__0.a85a00acdc"
[0m09:57:50.764524 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.numeric_range_marts__loans_enriched_interest_rate__0.a85a00acdc"
[0m09:57:50.764947 [debug] [Thread-1 (]: On test.vg_casestudy.numeric_range_marts__loans_enriched_interest_rate__0.a85a00acdc: BEGIN
[0m09:57:50.765350 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:57:50.779127 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:57:50.779679 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.numeric_range_marts__loans_enriched_interest_rate__0.a85a00acdc"
[0m09:57:50.780049 [debug] [Thread-1 (]: On test.vg_casestudy.numeric_range_marts__loans_enriched_interest_rate__0.a85a00acdc: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "test.vg_casestudy.numeric_range_marts__loans_enriched_interest_rate__0.a85a00acdc"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

    
        select *
        from "casestudy"."marts"."marts__loans_enriched"
        where interest_rate < 0
    
    


      
    ) dbt_internal_test
[0m09:57:50.785103 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:57:50.787625 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.numeric_range_marts__loans_enriched_interest_rate__0.a85a00acdc (execute): 09:57:50.760494 => 09:57:50.787353
[0m09:57:50.788211 [debug] [Thread-1 (]: On test.vg_casestudy.numeric_range_marts__loans_enriched_interest_rate__0.a85a00acdc: ROLLBACK
[0m09:57:50.788773 [debug] [Thread-1 (]: Failed to rollback 'test.vg_casestudy.numeric_range_marts__loans_enriched_interest_rate__0.a85a00acdc'
[0m09:57:50.789193 [debug] [Thread-1 (]: On test.vg_casestudy.numeric_range_marts__loans_enriched_interest_rate__0.a85a00acdc: Close
[0m09:57:50.793024 [info ] [Thread-1 (]: 19 of 26 PASS numeric_range_marts__loans_enriched_interest_rate__0 ............. [[32mPASS[0m in 0.04s]
[0m09:57:50.793930 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.numeric_range_marts__loans_enriched_interest_rate__0.a85a00acdc
[0m09:57:50.794474 [debug] [Thread-1 (]: Began running node test.vg_casestudy.numeric_range_marts__loans_enriched_loan_amount__0.fae897c4b6
[0m09:57:50.795036 [info ] [Thread-1 (]: 20 of 26 START test numeric_range_marts__loans_enriched_loan_amount__0 ......... [RUN]
[0m09:57:50.795835 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.numeric_range_marts__loans_enriched_interest_rate__0.a85a00acdc, now test.vg_casestudy.numeric_range_marts__loans_enriched_loan_amount__0.fae897c4b6)
[0m09:57:50.796237 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.numeric_range_marts__loans_enriched_loan_amount__0.fae897c4b6
[0m09:57:50.801355 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.numeric_range_marts__loans_enriched_loan_amount__0.fae897c4b6"
[0m09:57:50.802428 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.numeric_range_marts__loans_enriched_loan_amount__0.fae897c4b6 (compile): 09:57:50.796500 => 09:57:50.802091
[0m09:57:50.802997 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.numeric_range_marts__loans_enriched_loan_amount__0.fae897c4b6
[0m09:57:50.806330 [debug] [Thread-1 (]: Writing runtime sql for node "test.vg_casestudy.numeric_range_marts__loans_enriched_loan_amount__0.fae897c4b6"
[0m09:57:50.807512 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.numeric_range_marts__loans_enriched_loan_amount__0.fae897c4b6"
[0m09:57:50.808628 [debug] [Thread-1 (]: On test.vg_casestudy.numeric_range_marts__loans_enriched_loan_amount__0.fae897c4b6: BEGIN
[0m09:57:50.809916 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:57:50.826732 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:57:50.827406 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.numeric_range_marts__loans_enriched_loan_amount__0.fae897c4b6"
[0m09:57:50.827926 [debug] [Thread-1 (]: On test.vg_casestudy.numeric_range_marts__loans_enriched_loan_amount__0.fae897c4b6: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "test.vg_casestudy.numeric_range_marts__loans_enriched_loan_amount__0.fae897c4b6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

    
        select *
        from "casestudy"."marts"."marts__loans_enriched"
        where loan_amount < 0
    
    


      
    ) dbt_internal_test
[0m09:57:50.832834 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:57:50.835272 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.numeric_range_marts__loans_enriched_loan_amount__0.fae897c4b6 (execute): 09:57:50.803362 => 09:57:50.834716
[0m09:57:50.836082 [debug] [Thread-1 (]: On test.vg_casestudy.numeric_range_marts__loans_enriched_loan_amount__0.fae897c4b6: ROLLBACK
[0m09:57:50.837189 [debug] [Thread-1 (]: Failed to rollback 'test.vg_casestudy.numeric_range_marts__loans_enriched_loan_amount__0.fae897c4b6'
[0m09:57:50.838039 [debug] [Thread-1 (]: On test.vg_casestudy.numeric_range_marts__loans_enriched_loan_amount__0.fae897c4b6: Close
[0m09:57:50.841569 [info ] [Thread-1 (]: 20 of 26 PASS numeric_range_marts__loans_enriched_loan_amount__0 ............... [[32mPASS[0m in 0.05s]
[0m09:57:50.842288 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.numeric_range_marts__loans_enriched_loan_amount__0.fae897c4b6
[0m09:57:50.842740 [debug] [Thread-1 (]: Began running node test.vg_casestudy.numeric_range_marts__transactions_with_euro_transaction_amount__0.05fc32c05a
[0m09:57:50.843290 [info ] [Thread-1 (]: 21 of 26 START test numeric_range_marts__transactions_with_euro_transaction_amount__0  [RUN]
[0m09:57:50.844139 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.numeric_range_marts__loans_enriched_loan_amount__0.fae897c4b6, now test.vg_casestudy.numeric_range_marts__transactions_with_euro_transaction_amount__0.05fc32c05a)
[0m09:57:50.844538 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.numeric_range_marts__transactions_with_euro_transaction_amount__0.05fc32c05a
[0m09:57:50.849242 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.numeric_range_marts__transactions_with_euro_transaction_amount__0.05fc32c05a"
[0m09:57:50.849940 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.numeric_range_marts__transactions_with_euro_transaction_amount__0.05fc32c05a (compile): 09:57:50.844782 => 09:57:50.849709
[0m09:57:50.850345 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.numeric_range_marts__transactions_with_euro_transaction_amount__0.05fc32c05a
[0m09:57:50.853127 [debug] [Thread-1 (]: Writing runtime sql for node "test.vg_casestudy.numeric_range_marts__transactions_with_euro_transaction_amount__0.05fc32c05a"
[0m09:57:50.853855 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.numeric_range_marts__transactions_with_euro_transaction_amount__0.05fc32c05a"
[0m09:57:50.854233 [debug] [Thread-1 (]: On test.vg_casestudy.numeric_range_marts__transactions_with_euro_transaction_amount__0.05fc32c05a: BEGIN
[0m09:57:50.854558 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:57:50.868072 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:57:50.868608 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.numeric_range_marts__transactions_with_euro_transaction_amount__0.05fc32c05a"
[0m09:57:50.869018 [debug] [Thread-1 (]: On test.vg_casestudy.numeric_range_marts__transactions_with_euro_transaction_amount__0.05fc32c05a: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "test.vg_casestudy.numeric_range_marts__transactions_with_euro_transaction_amount__0.05fc32c05a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

    
        select *
        from "casestudy"."marts"."marts__transactions_with_euro"
        where transaction_amount < 0
    
    


      
    ) dbt_internal_test
[0m09:57:50.873179 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:57:50.876978 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.numeric_range_marts__transactions_with_euro_transaction_amount__0.05fc32c05a (execute): 09:57:50.850621 => 09:57:50.876706
[0m09:57:50.877478 [debug] [Thread-1 (]: On test.vg_casestudy.numeric_range_marts__transactions_with_euro_transaction_amount__0.05fc32c05a: ROLLBACK
[0m09:57:50.878056 [debug] [Thread-1 (]: Failed to rollback 'test.vg_casestudy.numeric_range_marts__transactions_with_euro_transaction_amount__0.05fc32c05a'
[0m09:57:50.878452 [debug] [Thread-1 (]: On test.vg_casestudy.numeric_range_marts__transactions_with_euro_transaction_amount__0.05fc32c05a: Close
[0m09:57:50.881590 [info ] [Thread-1 (]: 21 of 26 PASS numeric_range_marts__transactions_with_euro_transaction_amount__0  [[32mPASS[0m in 0.04s]
[0m09:57:50.882282 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.numeric_range_marts__transactions_with_euro_transaction_amount__0.05fc32c05a
[0m09:57:50.882737 [debug] [Thread-1 (]: Began running node test.vg_casestudy.numeric_range_marts__transactions_with_euro_transaction_amount_euro__0.f1f40b7198
[0m09:57:50.883262 [info ] [Thread-1 (]: 22 of 26 START test numeric_range_marts__transactions_with_euro_transaction_amount_euro__0  [RUN]
[0m09:57:50.884008 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.numeric_range_marts__transactions_with_euro_transaction_amount__0.05fc32c05a, now test.vg_casestudy.numeric_range_marts__transactions_with_euro_transaction_amount_euro__0.f1f40b7198)
[0m09:57:50.884350 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.numeric_range_marts__transactions_with_euro_transaction_amount_euro__0.f1f40b7198
[0m09:57:50.888519 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.numeric_range_marts__transactions_with_euro_transaction_amount_euro__0.f1f40b7198"
[0m09:57:50.889293 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.numeric_range_marts__transactions_with_euro_transaction_amount_euro__0.f1f40b7198 (compile): 09:57:50.884573 => 09:57:50.889087
[0m09:57:50.889664 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.numeric_range_marts__transactions_with_euro_transaction_amount_euro__0.f1f40b7198
[0m09:57:50.892311 [debug] [Thread-1 (]: Writing runtime sql for node "test.vg_casestudy.numeric_range_marts__transactions_with_euro_transaction_amount_euro__0.f1f40b7198"
[0m09:57:50.892981 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.numeric_range_marts__transactions_with_euro_transaction_amount_euro__0.f1f40b7198"
[0m09:57:50.893341 [debug] [Thread-1 (]: On test.vg_casestudy.numeric_range_marts__transactions_with_euro_transaction_amount_euro__0.f1f40b7198: BEGIN
[0m09:57:50.893644 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:57:50.908173 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:57:50.908751 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.numeric_range_marts__transactions_with_euro_transaction_amount_euro__0.f1f40b7198"
[0m09:57:50.909175 [debug] [Thread-1 (]: On test.vg_casestudy.numeric_range_marts__transactions_with_euro_transaction_amount_euro__0.f1f40b7198: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "test.vg_casestudy.numeric_range_marts__transactions_with_euro_transaction_amount_euro__0.f1f40b7198"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

    
        select *
        from "casestudy"."marts"."marts__transactions_with_euro"
        where transaction_amount_euro < 0
    
    


      
    ) dbt_internal_test
[0m09:57:50.918924 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:57:50.920551 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.numeric_range_marts__transactions_with_euro_transaction_amount_euro__0.f1f40b7198 (execute): 09:57:50.889907 => 09:57:50.920311
[0m09:57:50.920918 [debug] [Thread-1 (]: On test.vg_casestudy.numeric_range_marts__transactions_with_euro_transaction_amount_euro__0.f1f40b7198: ROLLBACK
[0m09:57:50.921434 [debug] [Thread-1 (]: Failed to rollback 'test.vg_casestudy.numeric_range_marts__transactions_with_euro_transaction_amount_euro__0.f1f40b7198'
[0m09:57:50.921730 [debug] [Thread-1 (]: On test.vg_casestudy.numeric_range_marts__transactions_with_euro_transaction_amount_euro__0.f1f40b7198: Close
[0m09:57:50.924594 [info ] [Thread-1 (]: 22 of 26 PASS numeric_range_marts__transactions_with_euro_transaction_amount_euro__0  [[32mPASS[0m in 0.04s]
[0m09:57:50.925221 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.numeric_range_marts__transactions_with_euro_transaction_amount_euro__0.f1f40b7198
[0m09:57:50.925621 [debug] [Thread-1 (]: Began running node test.vg_casestudy.unique_marts__customers_enriched_customer_id.357be759c5
[0m09:57:50.925974 [info ] [Thread-1 (]: 23 of 26 START test unique_marts__customers_enriched_customer_id ............... [RUN]
[0m09:57:50.927332 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.numeric_range_marts__transactions_with_euro_transaction_amount_euro__0.f1f40b7198, now test.vg_casestudy.unique_marts__customers_enriched_customer_id.357be759c5)
[0m09:57:50.928105 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.unique_marts__customers_enriched_customer_id.357be759c5
[0m09:57:50.938026 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.unique_marts__customers_enriched_customer_id.357be759c5"
[0m09:57:50.938793 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.unique_marts__customers_enriched_customer_id.357be759c5 (compile): 09:57:50.928563 => 09:57:50.938559
[0m09:57:50.939159 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.unique_marts__customers_enriched_customer_id.357be759c5
[0m09:57:50.942721 [debug] [Thread-1 (]: Writing runtime sql for node "test.vg_casestudy.unique_marts__customers_enriched_customer_id.357be759c5"
[0m09:57:50.944023 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.unique_marts__customers_enriched_customer_id.357be759c5"
[0m09:57:50.944663 [debug] [Thread-1 (]: On test.vg_casestudy.unique_marts__customers_enriched_customer_id.357be759c5: BEGIN
[0m09:57:50.945176 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:57:50.956833 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:57:50.957273 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.unique_marts__customers_enriched_customer_id.357be759c5"
[0m09:57:50.957627 [debug] [Thread-1 (]: On test.vg_casestudy.unique_marts__customers_enriched_customer_id.357be759c5: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "test.vg_casestudy.unique_marts__customers_enriched_customer_id.357be759c5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from "casestudy"."marts"."marts__customers_enriched"
where customer_id is not null
group by customer_id
having count(*) > 1



      
    ) dbt_internal_test
[0m09:57:50.965216 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:57:50.966978 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.unique_marts__customers_enriched_customer_id.357be759c5 (execute): 09:57:50.939386 => 09:57:50.966750
[0m09:57:50.967381 [debug] [Thread-1 (]: On test.vg_casestudy.unique_marts__customers_enriched_customer_id.357be759c5: ROLLBACK
[0m09:57:50.967838 [debug] [Thread-1 (]: Failed to rollback 'test.vg_casestudy.unique_marts__customers_enriched_customer_id.357be759c5'
[0m09:57:50.968190 [debug] [Thread-1 (]: On test.vg_casestudy.unique_marts__customers_enriched_customer_id.357be759c5: Close
[0m09:57:50.971839 [info ] [Thread-1 (]: 23 of 26 PASS unique_marts__customers_enriched_customer_id ..................... [[32mPASS[0m in 0.05s]
[0m09:57:50.972604 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.unique_marts__customers_enriched_customer_id.357be759c5
[0m09:57:50.973066 [debug] [Thread-1 (]: Began running node test.vg_casestudy.unique_marts__loans_enriched_customer_id.6bdf2f639d
[0m09:57:50.973429 [info ] [Thread-1 (]: 24 of 26 START test unique_marts__loans_enriched_customer_id ................... [RUN]
[0m09:57:50.974251 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.unique_marts__customers_enriched_customer_id.357be759c5, now test.vg_casestudy.unique_marts__loans_enriched_customer_id.6bdf2f639d)
[0m09:57:50.974622 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.unique_marts__loans_enriched_customer_id.6bdf2f639d
[0m09:57:50.979290 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.unique_marts__loans_enriched_customer_id.6bdf2f639d"
[0m09:57:50.980214 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.unique_marts__loans_enriched_customer_id.6bdf2f639d (compile): 09:57:50.975100 => 09:57:50.979957
[0m09:57:50.980630 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.unique_marts__loans_enriched_customer_id.6bdf2f639d
[0m09:57:50.983311 [debug] [Thread-1 (]: Writing runtime sql for node "test.vg_casestudy.unique_marts__loans_enriched_customer_id.6bdf2f639d"
[0m09:57:50.983989 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.unique_marts__loans_enriched_customer_id.6bdf2f639d"
[0m09:57:50.984335 [debug] [Thread-1 (]: On test.vg_casestudy.unique_marts__loans_enriched_customer_id.6bdf2f639d: BEGIN
[0m09:57:50.984640 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:57:50.997323 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:57:50.998065 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.unique_marts__loans_enriched_customer_id.6bdf2f639d"
[0m09:57:50.998736 [debug] [Thread-1 (]: On test.vg_casestudy.unique_marts__loans_enriched_customer_id.6bdf2f639d: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "test.vg_casestudy.unique_marts__loans_enriched_customer_id.6bdf2f639d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from "casestudy"."marts"."marts__loans_enriched"
where customer_id is not null
group by customer_id
having count(*) > 1



      
    ) dbt_internal_test
[0m09:57:51.005478 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:57:51.007276 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.unique_marts__loans_enriched_customer_id.6bdf2f639d (execute): 09:57:50.980900 => 09:57:51.007030
[0m09:57:51.007695 [debug] [Thread-1 (]: On test.vg_casestudy.unique_marts__loans_enriched_customer_id.6bdf2f639d: ROLLBACK
[0m09:57:51.008164 [debug] [Thread-1 (]: Failed to rollback 'test.vg_casestudy.unique_marts__loans_enriched_customer_id.6bdf2f639d'
[0m09:57:51.008494 [debug] [Thread-1 (]: On test.vg_casestudy.unique_marts__loans_enriched_customer_id.6bdf2f639d: Close
[0m09:57:51.012803 [info ] [Thread-1 (]: 24 of 26 PASS unique_marts__loans_enriched_customer_id ......................... [[32mPASS[0m in 0.04s]
[0m09:57:51.013562 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.unique_marts__loans_enriched_customer_id.6bdf2f639d
[0m09:57:51.014076 [debug] [Thread-1 (]: Began running node test.vg_casestudy.unique_marts__loans_enriched_loan_id.8812d67526
[0m09:57:51.014588 [info ] [Thread-1 (]: 25 of 26 START test unique_marts__loans_enriched_loan_id ....................... [RUN]
[0m09:57:51.015407 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.unique_marts__loans_enriched_customer_id.6bdf2f639d, now test.vg_casestudy.unique_marts__loans_enriched_loan_id.8812d67526)
[0m09:57:51.015762 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.unique_marts__loans_enriched_loan_id.8812d67526
[0m09:57:51.019901 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.unique_marts__loans_enriched_loan_id.8812d67526"
[0m09:57:51.020593 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.unique_marts__loans_enriched_loan_id.8812d67526 (compile): 09:57:51.015992 => 09:57:51.020386
[0m09:57:51.021004 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.unique_marts__loans_enriched_loan_id.8812d67526
[0m09:57:51.023975 [debug] [Thread-1 (]: Writing runtime sql for node "test.vg_casestudy.unique_marts__loans_enriched_loan_id.8812d67526"
[0m09:57:51.024955 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.unique_marts__loans_enriched_loan_id.8812d67526"
[0m09:57:51.025448 [debug] [Thread-1 (]: On test.vg_casestudy.unique_marts__loans_enriched_loan_id.8812d67526: BEGIN
[0m09:57:51.025771 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:57:51.038531 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:57:51.039004 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.unique_marts__loans_enriched_loan_id.8812d67526"
[0m09:57:51.039353 [debug] [Thread-1 (]: On test.vg_casestudy.unique_marts__loans_enriched_loan_id.8812d67526: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "test.vg_casestudy.unique_marts__loans_enriched_loan_id.8812d67526"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    loan_id as unique_field,
    count(*) as n_records

from "casestudy"."marts"."marts__loans_enriched"
where loan_id is not null
group by loan_id
having count(*) > 1



      
    ) dbt_internal_test
[0m09:57:51.045807 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:57:51.047545 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.unique_marts__loans_enriched_loan_id.8812d67526 (execute): 09:57:51.021256 => 09:57:51.047321
[0m09:57:51.047957 [debug] [Thread-1 (]: On test.vg_casestudy.unique_marts__loans_enriched_loan_id.8812d67526: ROLLBACK
[0m09:57:51.048425 [debug] [Thread-1 (]: Failed to rollback 'test.vg_casestudy.unique_marts__loans_enriched_loan_id.8812d67526'
[0m09:57:51.048762 [debug] [Thread-1 (]: On test.vg_casestudy.unique_marts__loans_enriched_loan_id.8812d67526: Close
[0m09:57:51.051996 [info ] [Thread-1 (]: 25 of 26 PASS unique_marts__loans_enriched_loan_id ............................. [[32mPASS[0m in 0.04s]
[0m09:57:51.052616 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.unique_marts__loans_enriched_loan_id.8812d67526
[0m09:57:51.053038 [debug] [Thread-1 (]: Began running node test.vg_casestudy.unique_marts__transactions_with_euro_transaction_id.f76d81c454
[0m09:57:51.053516 [info ] [Thread-1 (]: 26 of 26 START test unique_marts__transactions_with_euro_transaction_id ........ [RUN]
[0m09:57:51.054226 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.unique_marts__loans_enriched_loan_id.8812d67526, now test.vg_casestudy.unique_marts__transactions_with_euro_transaction_id.f76d81c454)
[0m09:57:51.054561 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.unique_marts__transactions_with_euro_transaction_id.f76d81c454
[0m09:57:51.058580 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.unique_marts__transactions_with_euro_transaction_id.f76d81c454"
[0m09:57:51.059681 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.unique_marts__transactions_with_euro_transaction_id.f76d81c454 (compile): 09:57:51.054782 => 09:57:51.059328
[0m09:57:51.060145 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.unique_marts__transactions_with_euro_transaction_id.f76d81c454
[0m09:57:51.064860 [debug] [Thread-1 (]: Writing runtime sql for node "test.vg_casestudy.unique_marts__transactions_with_euro_transaction_id.f76d81c454"
[0m09:57:51.065614 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.unique_marts__transactions_with_euro_transaction_id.f76d81c454"
[0m09:57:51.065993 [debug] [Thread-1 (]: On test.vg_casestudy.unique_marts__transactions_with_euro_transaction_id.f76d81c454: BEGIN
[0m09:57:51.066292 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:57:51.079715 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:57:51.080183 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.unique_marts__transactions_with_euro_transaction_id.f76d81c454"
[0m09:57:51.080526 [debug] [Thread-1 (]: On test.vg_casestudy.unique_marts__transactions_with_euro_transaction_id.f76d81c454: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "test.vg_casestudy.unique_marts__transactions_with_euro_transaction_id.f76d81c454"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    transaction_id as unique_field,
    count(*) as n_records

from "casestudy"."marts"."marts__transactions_with_euro"
where transaction_id is not null
group by transaction_id
having count(*) > 1



      
    ) dbt_internal_test
[0m09:57:51.092082 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:57:51.093935 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.unique_marts__transactions_with_euro_transaction_id.f76d81c454 (execute): 09:57:51.060406 => 09:57:51.093612
[0m09:57:51.094331 [debug] [Thread-1 (]: On test.vg_casestudy.unique_marts__transactions_with_euro_transaction_id.f76d81c454: ROLLBACK
[0m09:57:51.094813 [debug] [Thread-1 (]: Failed to rollback 'test.vg_casestudy.unique_marts__transactions_with_euro_transaction_id.f76d81c454'
[0m09:57:51.095118 [debug] [Thread-1 (]: On test.vg_casestudy.unique_marts__transactions_with_euro_transaction_id.f76d81c454: Close
[0m09:57:51.098372 [info ] [Thread-1 (]: 26 of 26 PASS unique_marts__transactions_with_euro_transaction_id .............. [[32mPASS[0m in 0.04s]
[0m09:57:51.099001 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.unique_marts__transactions_with_euro_transaction_id.f76d81c454
[0m09:57:51.101285 [debug] [MainThread]: Using duckdb connection "master"
[0m09:57:51.101597 [debug] [MainThread]: On master: BEGIN
[0m09:57:51.101880 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:57:51.116751 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m09:57:51.117235 [debug] [MainThread]: On master: COMMIT
[0m09:57:51.117610 [debug] [MainThread]: Using duckdb connection "master"
[0m09:57:51.118021 [debug] [MainThread]: On master: COMMIT
[0m09:57:51.118897 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m09:57:51.119290 [debug] [MainThread]: On master: Close
[0m09:57:51.122651 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:57:51.123087 [debug] [MainThread]: Connection 'list_casestudy_raw' was properly closed.
[0m09:57:51.123367 [debug] [MainThread]: Connection 'test.vg_casestudy.unique_marts__transactions_with_euro_transaction_id.f76d81c454' was properly closed.
[0m09:57:51.123758 [info ] [MainThread]: 
[0m09:57:51.124117 [info ] [MainThread]: Finished running 26 tests in 0 hours 0 minutes and 1.56 seconds (1.56s).
[0m09:57:51.127523 [debug] [MainThread]: Command end result
[0m09:57:51.150735 [info ] [MainThread]: 
[0m09:57:51.151462 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:57:51.151961 [info ] [MainThread]: 
[0m09:57:51.152378 [info ] [MainThread]: Done. PASS=26 WARN=0 ERROR=0 SKIP=0 TOTAL=26
[0m09:57:51.152987 [debug] [MainThread]: Command `dbt test` succeeded at 09:57:51.152868 after 2.06 seconds
[0m09:57:51.153410 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95da9df490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95da9de250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95da856bd0>]}
[0m09:57:51.153864 [debug] [MainThread]: Flushing usage events
[0m10:52:45.627306 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0273dac290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0274084250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0273dab490>]}


============================== 10:52:45.632261 | 889aa526-681a-4a64-9ba8-62ac908f79ca ==============================
[0m10:52:45.632261 [info ] [MainThread]: Running with dbt=1.6.18
[0m10:52:45.632824 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/workspaces/vg_case_study_tim/transformation', 'log_path': '/workspaces/vg_case_study_tim/transformation/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt debug', 'send_anonymous_usage_stats': 'True'}
[0m10:52:45.633202 [info ] [MainThread]: dbt version: 1.6.18
[0m10:52:45.633580 [info ] [MainThread]: python version: 3.11.6
[0m10:52:45.633982 [info ] [MainThread]: python path: /usr/local/bin/python
[0m10:52:45.634303 [info ] [MainThread]: os info: Linux-5.15.153.1-microsoft-standard-WSL2-x86_64-with-glibc2.31
[0m10:52:45.768982 [info ] [MainThread]: Using profiles dir at /workspaces/vg_case_study_tim/transformation
[0m10:52:45.769545 [info ] [MainThread]: Using profiles.yml file at /workspaces/vg_case_study_tim/transformation/profiles.yml
[0m10:52:45.769948 [info ] [MainThread]: Using dbt_project.yml file at /workspaces/vg_case_study_tim/transformation/dbt_project.yml
[0m10:52:45.771067 [info ] [MainThread]: adapter type: duckdb
[0m10:52:45.771414 [info ] [MainThread]: adapter version: 1.6.2
[0m10:52:45.802358 [info ] [MainThread]: Configuration:
[0m10:52:45.802889 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m10:52:45.803266 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m10:52:45.803610 [info ] [MainThread]: Required dependencies:
[0m10:52:45.803972 [debug] [MainThread]: Executing "git --help"
[0m10:52:45.805735 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m10:52:45.806202 [debug] [MainThread]: STDERR: "b''"
[0m10:52:45.806492 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m10:52:45.806792 [info ] [MainThread]: Connection:
[0m10:52:45.807083 [info ] [MainThread]:   database: casestudy
[0m10:52:45.807371 [info ] [MainThread]:   schema: main
[0m10:52:45.807635 [info ] [MainThread]:   path: casestudy.duckdb
[0m10:52:45.807901 [info ] [MainThread]:   config_options: None
[0m10:52:45.808164 [info ] [MainThread]:   extensions: ['icu']
[0m10:52:45.808423 [info ] [MainThread]:   settings: None
[0m10:52:45.808684 [info ] [MainThread]:   external_root: .
[0m10:52:45.808947 [info ] [MainThread]:   use_credential_provider: None
[0m10:52:45.809208 [info ] [MainThread]:   attach: None
[0m10:52:45.809500 [info ] [MainThread]:   filesystems: None
[0m10:52:45.809788 [info ] [MainThread]:   remote: None
[0m10:52:45.810108 [info ] [MainThread]:   plugins: None
[0m10:52:45.810413 [info ] [MainThread]:   disable_transactions: False
[0m10:52:45.810899 [info ] [MainThread]: Registered adapter: duckdb=1.6.2
[0m10:52:45.811498 [debug] [MainThread]: Acquiring new duckdb connection 'debug'
[0m10:52:45.811882 [debug] [MainThread]: Using duckdb connection "debug"
[0m10:52:45.812262 [debug] [MainThread]: On debug: select 1 as id
[0m10:52:45.812625 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:52:45.947897 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m10:52:45.948940 [debug] [MainThread]: On debug: Close
[0m10:52:45.952153 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m10:52:45.952646 [info ] [MainThread]: [32mAll checks passed![0m
[0m10:52:45.953168 [debug] [MainThread]: Command `dbt debug` succeeded at 10:52:45.953050 after 0.34 seconds
[0m10:52:45.953533 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m10:52:45.953896 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0273f4d9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0274353d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0273ee28d0>]}
[0m10:52:45.954310 [debug] [MainThread]: Flushing usage events
[0m12:00:08.841385 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1980dd8a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f19807efe90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1980ab2910>]}


============================== 12:00:08.847478 | 29f4ec12-2d22-4928-8623-ce8fc950a523 ==============================
[0m12:00:08.847478 [info ] [MainThread]: Running with dbt=1.6.18
[0m12:00:08.848026 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/workspaces/vg_case_study_tim/transformation', 'debug': 'False', 'version_check': 'True', 'log_path': '/workspaces/vg_case_study_tim/transformation/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --select reporting__high_lvl_branch_loan_kpis --full-refresh', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:00:09.056654 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '29f4ec12-2d22-4928-8623-ce8fc950a523', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1980ddd850>]}
[0m12:00:09.071414 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '29f4ec12-2d22-4928-8623-ce8fc950a523', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1980c81910>]}
[0m12:00:09.073161 [info ] [MainThread]: Registered adapter: duckdb=1.6.2
[0m12:00:09.100208 [debug] [MainThread]: checksum: 7b9fab86a08e9e96a48a825af743c566d95b877e068b8c6d0dbafbf714447189, vars: {}, profile: , target: , version: 1.6.18
[0m12:00:09.145890 [error] [MainThread]: Encountered an error:
Parsing Error
  Error reading vg_casestudy: reporting/reporting__high_lvl_branch_loan_kpis.yml - Runtime Error
    Syntax error near line 11
    ------------------------------
    8  |       schema: reporting
    9  |     columns:
    10 |       - name: branch_id
    11 |         description: "Unique identifier of the branch"
    12 |         data_type: integer
    13 |         tests:
    14 |           - not_null
    
    Raw Error:
    ------------------------------
    while parsing a block mapping
      in "<unicode string>", line 4, column 5
    did not find expected key
      in "<unicode string>", line 11, column 23
[0m12:00:09.146599 [debug] [MainThread]: Command `dbt run` failed at 12:00:09.146431 after 0.32 seconds
[0m12:00:09.146983 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1980a83010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1980650bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1980651910>]}
[0m12:00:09.147369 [debug] [MainThread]: Flushing usage events
[0m12:02:15.406694 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc32e0fc90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc33291e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc3315bb10>]}


============================== 12:02:15.411182 | fa95555f-72ee-4795-8d4a-c4c15e4427f6 ==============================
[0m12:02:15.411182 [info ] [MainThread]: Running with dbt=1.6.18
[0m12:02:15.411892 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/workspaces/vg_case_study_tim/transformation', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/workspaces/vg_case_study_tim/transformation/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --select reporting__high_lvl_branch_loan_kpis --full-refresh', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:02:15.606706 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fa95555f-72ee-4795-8d4a-c4c15e4427f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc32e48290>]}
[0m12:02:15.621575 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fa95555f-72ee-4795-8d4a-c4c15e4427f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc33292b50>]}
[0m12:02:15.623089 [info ] [MainThread]: Registered adapter: duckdb=1.6.2
[0m12:02:15.651353 [debug] [MainThread]: checksum: 7b9fab86a08e9e96a48a825af743c566d95b877e068b8c6d0dbafbf714447189, vars: {}, profile: , target: , version: 1.6.18
[0m12:02:15.761088 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 0 files changed.
[0m12:02:15.762088 [debug] [MainThread]: Partial parsing: added file: vg_casestudy://models/reporting/reporting__high_lvl_branch_loan_kpis.yml
[0m12:02:15.762495 [debug] [MainThread]: Partial parsing: added file: vg_casestudy://models/reporting/reporting__high_lvl_branch_loan_kpis.sql
[0m12:02:15.908346 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.vg_casestudy.main
[0m12:02:15.918233 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fa95555f-72ee-4795-8d4a-c4c15e4427f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc32e191d0>]}
[0m12:02:15.953217 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fa95555f-72ee-4795-8d4a-c4c15e4427f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc2d81bf10>]}
[0m12:02:15.953804 [info ] [MainThread]: Found 17 models, 1 analysis, 4 seeds, 113 tests, 5 sources, 0 exposures, 0 metrics, 632 macros, 0 groups, 0 semantic models
[0m12:02:15.954206 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fa95555f-72ee-4795-8d4a-c4c15e4427f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc2ecc0e50>]}
[0m12:02:15.957011 [info ] [MainThread]: 
[0m12:02:15.957861 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m12:02:15.959023 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_casestudy'
[0m12:02:15.972887 [debug] [ThreadPool]: Using duckdb connection "list_casestudy"
[0m12:02:15.973549 [debug] [ThreadPool]: On list_casestudy: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"casestudy"'
    
  
  
[0m12:02:15.974070 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:02:16.067165 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:02:16.067590 [debug] [MainThread]: Connection 'list_casestudy' was properly closed.
[0m12:02:16.067941 [info ] [MainThread]: 
[0m12:02:16.068291 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.11 seconds (0.11s).
[0m12:02:16.068742 [error] [MainThread]: Encountered an error:
Runtime Error
  IO Error: Could not set lock on file "/workspaces/vg_case_study_tim/transformation/casestudy.duckdb": Conflicting lock is held in /root/.duckdb/cli/1.3.2/duckdb (PID 26892). See also https://duckdb.org/docs/stable/connect/concurrency
[0m12:02:16.069200 [debug] [MainThread]: Command `dbt run` failed at 12:02:16.069112 after 0.67 seconds
[0m12:02:16.069527 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc333e0750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc330d7410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc34c208d0>]}
[0m12:02:16.069876 [debug] [MainThread]: Flushing usage events
[0m12:02:41.062585 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc417abc90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc41c5ef10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc4194df10>]}


============================== 12:02:41.065211 | eb12b4fd-0c3b-4006-affc-959830236800 ==============================
[0m12:02:41.065211 [info ] [MainThread]: Running with dbt=1.6.18
[0m12:02:41.065840 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/workspaces/vg_case_study_tim/transformation', 'debug': 'False', 'warn_error': 'None', 'log_path': '/workspaces/vg_case_study_tim/transformation/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run --select reporting__high_lvl_branch_loan_kpis --full-refresh', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:02:41.171811 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'eb12b4fd-0c3b-4006-affc-959830236800', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc417ec4d0>]}
[0m12:02:41.187015 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'eb12b4fd-0c3b-4006-affc-959830236800', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc41a719d0>]}
[0m12:02:41.187907 [info ] [MainThread]: Registered adapter: duckdb=1.6.2
[0m12:02:41.221043 [debug] [MainThread]: checksum: 7b9fab86a08e9e96a48a825af743c566d95b877e068b8c6d0dbafbf714447189, vars: {}, profile: , target: , version: 1.6.18
[0m12:02:41.270879 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:02:41.271417 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:02:41.273111 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.vg_casestudy.main
[0m12:02:41.281631 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'eb12b4fd-0c3b-4006-affc-959830236800', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc3d6a3a50>]}
[0m12:02:41.364394 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'eb12b4fd-0c3b-4006-affc-959830236800', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc41c35550>]}
[0m12:02:41.364991 [info ] [MainThread]: Found 17 models, 1 analysis, 4 seeds, 113 tests, 5 sources, 0 exposures, 0 metrics, 632 macros, 0 groups, 0 semantic models
[0m12:02:41.365407 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eb12b4fd-0c3b-4006-affc-959830236800', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc3d56d2d0>]}
[0m12:02:41.368173 [info ] [MainThread]: 
[0m12:02:41.369019 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m12:02:41.370936 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_casestudy'
[0m12:02:41.384458 [debug] [ThreadPool]: Using duckdb connection "list_casestudy"
[0m12:02:41.385114 [debug] [ThreadPool]: On list_casestudy: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"casestudy"'
    
  
  
[0m12:02:41.385575 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:02:41.448294 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:02:41.450028 [debug] [ThreadPool]: On list_casestudy: Close
[0m12:02:41.480153 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy, now create_casestudy_reporting)
[0m12:02:41.480971 [debug] [ThreadPool]: Creating schema "database: "casestudy"
schema: "reporting"
"
[0m12:02:41.486049 [debug] [ThreadPool]: Using duckdb connection "create_casestudy_reporting"
[0m12:02:41.486449 [debug] [ThreadPool]: On create_casestudy_reporting: BEGIN
[0m12:02:41.486737 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:02:41.498697 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:02:41.499134 [debug] [ThreadPool]: Using duckdb connection "create_casestudy_reporting"
[0m12:02:41.499432 [debug] [ThreadPool]: On create_casestudy_reporting: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "create_casestudy_reporting"} */
create schema if not exists "casestudy"."reporting"
[0m12:02:41.500929 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:02:41.501922 [debug] [ThreadPool]: On create_casestudy_reporting: COMMIT
[0m12:02:41.502244 [debug] [ThreadPool]: Using duckdb connection "create_casestudy_reporting"
[0m12:02:41.502510 [debug] [ThreadPool]: On create_casestudy_reporting: COMMIT
[0m12:02:41.505672 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:02:41.506068 [debug] [ThreadPool]: On create_casestudy_reporting: Close
[0m12:02:41.534940 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_casestudy_reporting, now list_casestudy_marts)
[0m12:02:41.540411 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_marts"
[0m12:02:41.541057 [debug] [ThreadPool]: On list_casestudy_marts: BEGIN
[0m12:02:41.541373 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:02:41.554007 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:02:41.554436 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_marts"
[0m12:02:41.554785 [debug] [ThreadPool]: On list_casestudy_marts: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_marts"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'marts'
    and table_catalog = 'casestudy'
  
[0m12:02:41.569510 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:02:41.571220 [debug] [ThreadPool]: On list_casestudy_marts: ROLLBACK
[0m12:02:41.572731 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_marts'
[0m12:02:41.573056 [debug] [ThreadPool]: On list_casestudy_marts: Close
[0m12:02:41.576090 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy_marts, now list_casestudy_intermediate)
[0m12:02:41.578317 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_intermediate"
[0m12:02:41.578659 [debug] [ThreadPool]: On list_casestudy_intermediate: BEGIN
[0m12:02:41.578955 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:02:41.590119 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:02:41.590542 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_intermediate"
[0m12:02:41.590870 [debug] [ThreadPool]: On list_casestudy_intermediate: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_intermediate"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'intermediate'
    and table_catalog = 'casestudy'
  
[0m12:02:41.599888 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:02:41.601553 [debug] [ThreadPool]: On list_casestudy_intermediate: ROLLBACK
[0m12:02:41.602055 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_intermediate'
[0m12:02:41.602345 [debug] [ThreadPool]: On list_casestudy_intermediate: Close
[0m12:02:41.605259 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy_intermediate, now list_casestudy_staging)
[0m12:02:41.607559 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_staging"
[0m12:02:41.607926 [debug] [ThreadPool]: On list_casestudy_staging: BEGIN
[0m12:02:41.608214 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:02:41.623303 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:02:41.623716 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_staging"
[0m12:02:41.624007 [debug] [ThreadPool]: On list_casestudy_staging: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_staging"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'staging'
    and table_catalog = 'casestudy'
  
[0m12:02:41.633540 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:02:41.635021 [debug] [ThreadPool]: On list_casestudy_staging: ROLLBACK
[0m12:02:41.635560 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_staging'
[0m12:02:41.635854 [debug] [ThreadPool]: On list_casestudy_staging: Close
[0m12:02:41.638673 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy_staging, now list_casestudy_raw)
[0m12:02:41.640911 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_raw"
[0m12:02:41.641257 [debug] [ThreadPool]: On list_casestudy_raw: BEGIN
[0m12:02:41.642728 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:02:41.654801 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:02:41.655246 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_raw"
[0m12:02:41.655546 [debug] [ThreadPool]: On list_casestudy_raw: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_raw"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'raw'
    and table_catalog = 'casestudy'
  
[0m12:02:41.664613 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:02:41.666556 [debug] [ThreadPool]: On list_casestudy_raw: ROLLBACK
[0m12:02:41.667234 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_raw'
[0m12:02:41.667657 [debug] [ThreadPool]: On list_casestudy_raw: Close
[0m12:02:41.671340 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy_raw, now list_casestudy_reporting)
[0m12:02:41.675378 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_reporting"
[0m12:02:41.675758 [debug] [ThreadPool]: On list_casestudy_reporting: BEGIN
[0m12:02:41.676029 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:02:41.687531 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:02:41.687958 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_reporting"
[0m12:02:41.688279 [debug] [ThreadPool]: On list_casestudy_reporting: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_reporting"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'reporting'
    and table_catalog = 'casestudy'
  
[0m12:02:41.700969 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:02:41.702295 [debug] [ThreadPool]: On list_casestudy_reporting: ROLLBACK
[0m12:02:41.702800 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_reporting'
[0m12:02:41.703080 [debug] [ThreadPool]: On list_casestudy_reporting: Close
[0m12:02:41.706098 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eb12b4fd-0c3b-4006-affc-959830236800', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc3d7e9c10>]}
[0m12:02:41.706654 [debug] [MainThread]: Using duckdb connection "master"
[0m12:02:41.706965 [debug] [MainThread]: On master: BEGIN
[0m12:02:41.707236 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:02:41.721423 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m12:02:41.721876 [debug] [MainThread]: On master: COMMIT
[0m12:02:41.722168 [debug] [MainThread]: Using duckdb connection "master"
[0m12:02:41.722426 [debug] [MainThread]: On master: COMMIT
[0m12:02:41.723016 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m12:02:41.723376 [debug] [MainThread]: On master: Close
[0m12:02:41.726033 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:02:41.726484 [info ] [MainThread]: 
[0m12:02:41.729961 [debug] [Thread-1 (]: Began running node model.vg_casestudy.reporting__high_lvl_branch_loan_kpis
[0m12:02:41.730481 [info ] [Thread-1 (]: 1 of 1 START sql view model reporting.reporting__high_lvl_branch_loan_kpis ..... [RUN]
[0m12:02:41.731532 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.vg_casestudy.reporting__high_lvl_branch_loan_kpis'
[0m12:02:41.731905 [debug] [Thread-1 (]: Began compiling node model.vg_casestudy.reporting__high_lvl_branch_loan_kpis
[0m12:02:41.740369 [debug] [Thread-1 (]: Writing injected SQL for node "model.vg_casestudy.reporting__high_lvl_branch_loan_kpis"
[0m12:02:41.741896 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.reporting__high_lvl_branch_loan_kpis (compile): 12:02:41.732134 => 12:02:41.741563
[0m12:02:41.742689 [debug] [Thread-1 (]: Began executing node model.vg_casestudy.reporting__high_lvl_branch_loan_kpis
[0m12:02:41.777599 [debug] [Thread-1 (]: Writing runtime sql for node "model.vg_casestudy.reporting__high_lvl_branch_loan_kpis"
[0m12:02:41.779313 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.reporting__high_lvl_branch_loan_kpis"
[0m12:02:41.779726 [debug] [Thread-1 (]: On model.vg_casestudy.reporting__high_lvl_branch_loan_kpis: BEGIN
[0m12:02:41.780061 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:02:41.798861 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m12:02:41.799471 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.reporting__high_lvl_branch_loan_kpis"
[0m12:02:41.799980 [debug] [Thread-1 (]: On model.vg_casestudy.reporting__high_lvl_branch_loan_kpis: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.reporting__high_lvl_branch_loan_kpis"} */

  
  create view "casestudy"."reporting"."reporting__high_lvl_branch_loan_kpis__dbt_tmp" as (
    with loans as (
    select *
    from "casestudy"."marts"."marts__loans_enriched"
),

aggregated as (
    select 
        branch_id,
        branch_name,

        -- loan count by status
        count(loan_id) as count_of_loans,
        count(case when loan_status = 'approved' then loan_id end) as loans_approved,
        count(case when loan_status = 'rejected' then loan_id end) as loans_rejected,
        count(case when loan_status = 'closed' then loan_id end) as loans_closed,

        -- approval rate
        count(case when loan_status = 'approved' then loan_id end)::float
            / nullif(count(loan_id), 0) as approval_rate,
        count(case when loan_status = 'rejected' then loan_id end)::float
            / nullif(count(loan_id), 0) as rejection_rate,
        count(case when loan_status = 'closed' then loan_id end)::float
            / nullif(count(loan_id), 0) as closed_rate,

        -- loan kpis
        sum(loan_amount) as total_loan_amount,
        sum(loan_amount)::float / nullif(count(loan_id), 0) as avg_loan_amount,
        avg(interest_rate) as avg_interest_rate,
        avg(loan_term)  as avg_loan_term_months,
        count(case when loan_term > 36 then loan_id end)::float / count(loan_id) as long_term_loan_share_more_than_36,
        count(case when loan_term < 24 then loan_id end)::float / count(loan_id) as short_term_loan_share_less_than_24,
        min(case when loans.loan_status = 'approved' then approval_rejection_date end) as earliest_approval_date,
        max(case when loans.loan_status = 'approved' then approval_rejection_date end) as latest_approval_date

    from loans
    group by branch_id,branch_name
)

select *
from aggregated
  );

[0m12:02:41.804507 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m12:02:41.811130 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.reporting__high_lvl_branch_loan_kpis"
[0m12:02:41.811592 [debug] [Thread-1 (]: On model.vg_casestudy.reporting__high_lvl_branch_loan_kpis: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.reporting__high_lvl_branch_loan_kpis"} */
alter view "casestudy"."reporting"."reporting__high_lvl_branch_loan_kpis__dbt_tmp" rename to "reporting__high_lvl_branch_loan_kpis"
[0m12:02:41.812493 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m12:02:41.826759 [debug] [Thread-1 (]: On model.vg_casestudy.reporting__high_lvl_branch_loan_kpis: COMMIT
[0m12:02:41.827223 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.reporting__high_lvl_branch_loan_kpis"
[0m12:02:41.827562 [debug] [Thread-1 (]: On model.vg_casestudy.reporting__high_lvl_branch_loan_kpis: COMMIT
[0m12:02:41.831975 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m12:02:41.841460 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.reporting__high_lvl_branch_loan_kpis"
[0m12:02:41.842055 [debug] [Thread-1 (]: On model.vg_casestudy.reporting__high_lvl_branch_loan_kpis: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.reporting__high_lvl_branch_loan_kpis"} */
drop view if exists "casestudy"."reporting"."reporting__high_lvl_branch_loan_kpis__dbt_backup" cascade
[0m12:02:41.842818 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m12:02:41.844194 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.reporting__high_lvl_branch_loan_kpis (execute): 12:02:41.743276 => 12:02:41.844033
[0m12:02:41.844546 [debug] [Thread-1 (]: On model.vg_casestudy.reporting__high_lvl_branch_loan_kpis: Close
[0m12:02:41.870761 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eb12b4fd-0c3b-4006-affc-959830236800', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc3e162690>]}
[0m12:02:41.871555 [info ] [Thread-1 (]: 1 of 1 OK created sql view model reporting.reporting__high_lvl_branch_loan_kpis  [[32mOK[0m in 0.14s]
[0m12:02:41.872139 [debug] [Thread-1 (]: Finished running node model.vg_casestudy.reporting__high_lvl_branch_loan_kpis
[0m12:02:41.874066 [debug] [MainThread]: Using duckdb connection "master"
[0m12:02:41.874437 [debug] [MainThread]: On master: BEGIN
[0m12:02:41.874748 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:02:41.889476 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m12:02:41.890165 [debug] [MainThread]: On master: COMMIT
[0m12:02:41.890509 [debug] [MainThread]: Using duckdb connection "master"
[0m12:02:41.890860 [debug] [MainThread]: On master: COMMIT
[0m12:02:41.891792 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m12:02:41.892343 [debug] [MainThread]: On master: Close
[0m12:02:41.895176 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:02:41.895595 [debug] [MainThread]: Connection 'list_casestudy_reporting' was properly closed.
[0m12:02:41.895878 [debug] [MainThread]: Connection 'model.vg_casestudy.reporting__high_lvl_branch_loan_kpis' was properly closed.
[0m12:02:41.896190 [info ] [MainThread]: 
[0m12:02:41.896558 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.53 seconds (0.53s).
[0m12:02:41.897174 [debug] [MainThread]: Command end result
[0m12:02:41.919363 [info ] [MainThread]: 
[0m12:02:41.919977 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:02:41.920423 [info ] [MainThread]: 
[0m12:02:41.920810 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:02:41.921400 [debug] [MainThread]: Command `dbt run` succeeded at 12:02:41.921254 after 0.87 seconds
[0m12:02:41.921830 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc41c2a5d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc4645f490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc4645f510>]}
[0m12:02:41.922241 [debug] [MainThread]: Flushing usage events
[0m12:03:43.194903 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f66e5486390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f66e52ff3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f66e5337850>]}


============================== 12:03:43.200909 | 56b37e5d-239e-4b07-82ad-7aac40151757 ==============================
[0m12:03:43.200909 [info ] [MainThread]: Running with dbt=1.6.18
[0m12:03:43.201488 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/workspaces/vg_case_study_tim/transformation', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/workspaces/vg_case_study_tim/transformation/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt test --select reporting__high_lvl_branch_loan_kpis', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:03:43.401193 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '56b37e5d-239e-4b07-82ad-7aac40151757', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f66e4ceacd0>]}
[0m12:03:43.416846 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '56b37e5d-239e-4b07-82ad-7aac40151757', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f66e4e9c050>]}
[0m12:03:43.419182 [info ] [MainThread]: Registered adapter: duckdb=1.6.2
[0m12:03:43.450602 [debug] [MainThread]: checksum: 7b9fab86a08e9e96a48a825af743c566d95b877e068b8c6d0dbafbf714447189, vars: {}, profile: , target: , version: 1.6.18
[0m12:03:43.558391 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:03:43.558833 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:03:43.560536 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.vg_casestudy.main
[0m12:03:43.568677 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '56b37e5d-239e-4b07-82ad-7aac40151757', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f66e0d7b310>]}
[0m12:03:43.649244 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '56b37e5d-239e-4b07-82ad-7aac40151757', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f66e547bbd0>]}
[0m12:03:43.649880 [info ] [MainThread]: Found 17 models, 1 analysis, 4 seeds, 113 tests, 5 sources, 0 exposures, 0 metrics, 632 macros, 0 groups, 0 semantic models
[0m12:03:43.650280 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '56b37e5d-239e-4b07-82ad-7aac40151757', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f66e4e9f6d0>]}
[0m12:03:43.652902 [info ] [MainThread]: 
[0m12:03:43.653727 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m12:03:43.657010 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_casestudy_reporting'
[0m12:03:43.670360 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_reporting"
[0m12:03:43.670947 [debug] [ThreadPool]: On list_casestudy_reporting: BEGIN
[0m12:03:43.671302 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:03:43.795957 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:03:43.796394 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_reporting"
[0m12:03:43.796701 [debug] [ThreadPool]: On list_casestudy_reporting: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_reporting"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'reporting'
    and table_catalog = 'casestudy'
  
[0m12:03:43.819199 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:03:43.820676 [debug] [ThreadPool]: On list_casestudy_reporting: ROLLBACK
[0m12:03:43.822037 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_reporting'
[0m12:03:43.822364 [debug] [ThreadPool]: On list_casestudy_reporting: Close
[0m12:03:43.826766 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy_reporting, now list_casestudy_marts)
[0m12:03:43.829684 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_marts"
[0m12:03:43.830057 [debug] [ThreadPool]: On list_casestudy_marts: BEGIN
[0m12:03:43.830346 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:03:43.842395 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:03:43.842895 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_marts"
[0m12:03:43.843239 [debug] [ThreadPool]: On list_casestudy_marts: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_marts"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'marts'
    and table_catalog = 'casestudy'
  
[0m12:03:43.852110 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:03:43.853500 [debug] [ThreadPool]: On list_casestudy_marts: ROLLBACK
[0m12:03:43.853986 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_marts'
[0m12:03:43.854273 [debug] [ThreadPool]: On list_casestudy_marts: Close
[0m12:03:43.857180 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy_marts, now list_casestudy_raw)
[0m12:03:43.859451 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_raw"
[0m12:03:43.859801 [debug] [ThreadPool]: On list_casestudy_raw: BEGIN
[0m12:03:43.860130 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:03:43.871249 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:03:43.871646 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_raw"
[0m12:03:43.871931 [debug] [ThreadPool]: On list_casestudy_raw: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_raw"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'raw'
    and table_catalog = 'casestudy'
  
[0m12:03:43.880138 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:03:43.881530 [debug] [ThreadPool]: On list_casestudy_raw: ROLLBACK
[0m12:03:43.882008 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_raw'
[0m12:03:43.882275 [debug] [ThreadPool]: On list_casestudy_raw: Close
[0m12:03:43.886101 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy_raw, now list_casestudy_staging)
[0m12:03:43.888463 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_staging"
[0m12:03:43.888830 [debug] [ThreadPool]: On list_casestudy_staging: BEGIN
[0m12:03:43.889156 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:03:43.900184 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:03:43.900583 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_staging"
[0m12:03:43.900865 [debug] [ThreadPool]: On list_casestudy_staging: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_staging"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'staging'
    and table_catalog = 'casestudy'
  
[0m12:03:43.909234 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:03:43.910537 [debug] [ThreadPool]: On list_casestudy_staging: ROLLBACK
[0m12:03:43.911101 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_staging'
[0m12:03:43.911387 [debug] [ThreadPool]: On list_casestudy_staging: Close
[0m12:03:43.914427 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy_staging, now list_casestudy_intermediate)
[0m12:03:43.916557 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_intermediate"
[0m12:03:43.916895 [debug] [ThreadPool]: On list_casestudy_intermediate: BEGIN
[0m12:03:43.917233 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:03:43.928386 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:03:43.928873 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_intermediate"
[0m12:03:43.929199 [debug] [ThreadPool]: On list_casestudy_intermediate: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_intermediate"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'intermediate'
    and table_catalog = 'casestudy'
  
[0m12:03:43.939983 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:03:43.941516 [debug] [ThreadPool]: On list_casestudy_intermediate: ROLLBACK
[0m12:03:43.942042 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_intermediate'
[0m12:03:43.942413 [debug] [ThreadPool]: On list_casestudy_intermediate: Close
[0m12:03:43.946860 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '56b37e5d-239e-4b07-82ad-7aac40151757', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f66e4d74a50>]}
[0m12:03:43.947392 [debug] [MainThread]: Using duckdb connection "master"
[0m12:03:43.947711 [debug] [MainThread]: On master: BEGIN
[0m12:03:43.947988 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:03:43.961332 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m12:03:43.961784 [debug] [MainThread]: On master: COMMIT
[0m12:03:43.962089 [debug] [MainThread]: Using duckdb connection "master"
[0m12:03:43.962358 [debug] [MainThread]: On master: COMMIT
[0m12:03:43.962930 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m12:03:43.963320 [debug] [MainThread]: On master: Close
[0m12:03:43.965893 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:03:43.966371 [info ] [MainThread]: 
[0m12:03:43.969065 [debug] [Thread-1 (]: Began running node test.vg_casestudy.not_null_reporting__high_lvl_branch_loan_kpis_branch_id.1ad6d682e7
[0m12:03:43.969508 [info ] [Thread-1 (]: 1 of 1 START test not_null_reporting__high_lvl_branch_loan_kpis_branch_id ...... [RUN]
[0m12:03:43.970307 [debug] [Thread-1 (]: Acquiring new duckdb connection 'test.vg_casestudy.not_null_reporting__high_lvl_branch_loan_kpis_branch_id.1ad6d682e7'
[0m12:03:43.970674 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.not_null_reporting__high_lvl_branch_loan_kpis_branch_id.1ad6d682e7
[0m12:03:43.991053 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.not_null_reporting__high_lvl_branch_loan_kpis_branch_id.1ad6d682e7"
[0m12:03:43.993186 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_reporting__high_lvl_branch_loan_kpis_branch_id.1ad6d682e7 (compile): 12:03:43.970908 => 12:03:43.992925
[0m12:03:43.993597 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.not_null_reporting__high_lvl_branch_loan_kpis_branch_id.1ad6d682e7
[0m12:03:44.006869 [debug] [Thread-1 (]: Writing runtime sql for node "test.vg_casestudy.not_null_reporting__high_lvl_branch_loan_kpis_branch_id.1ad6d682e7"
[0m12:03:44.008528 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.not_null_reporting__high_lvl_branch_loan_kpis_branch_id.1ad6d682e7"
[0m12:03:44.008941 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_reporting__high_lvl_branch_loan_kpis_branch_id.1ad6d682e7: BEGIN
[0m12:03:44.009269 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:03:44.026131 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m12:03:44.026656 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.not_null_reporting__high_lvl_branch_loan_kpis_branch_id.1ad6d682e7"
[0m12:03:44.027016 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_reporting__high_lvl_branch_loan_kpis_branch_id.1ad6d682e7: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "test.vg_casestudy.not_null_reporting__high_lvl_branch_loan_kpis_branch_id.1ad6d682e7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select branch_id
from "casestudy"."reporting"."reporting__high_lvl_branch_loan_kpis"
where branch_id is null



      
    ) dbt_internal_test
[0m12:03:44.047856 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m12:03:44.051229 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_reporting__high_lvl_branch_loan_kpis_branch_id.1ad6d682e7 (execute): 12:03:43.993842 => 12:03:44.050894
[0m12:03:44.051882 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_reporting__high_lvl_branch_loan_kpis_branch_id.1ad6d682e7: ROLLBACK
[0m12:03:44.052578 [debug] [Thread-1 (]: Failed to rollback 'test.vg_casestudy.not_null_reporting__high_lvl_branch_loan_kpis_branch_id.1ad6d682e7'
[0m12:03:44.052952 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_reporting__high_lvl_branch_loan_kpis_branch_id.1ad6d682e7: Close
[0m12:03:44.057656 [info ] [Thread-1 (]: 1 of 1 PASS not_null_reporting__high_lvl_branch_loan_kpis_branch_id ............ [[32mPASS[0m in 0.09s]
[0m12:03:44.058465 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.not_null_reporting__high_lvl_branch_loan_kpis_branch_id.1ad6d682e7
[0m12:03:44.060373 [debug] [MainThread]: Using duckdb connection "master"
[0m12:03:44.060737 [debug] [MainThread]: On master: BEGIN
[0m12:03:44.061027 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:03:44.077162 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m12:03:44.077668 [debug] [MainThread]: On master: COMMIT
[0m12:03:44.077999 [debug] [MainThread]: Using duckdb connection "master"
[0m12:03:44.078336 [debug] [MainThread]: On master: COMMIT
[0m12:03:44.079021 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m12:03:44.079375 [debug] [MainThread]: On master: Close
[0m12:03:44.081931 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:03:44.082297 [debug] [MainThread]: Connection 'list_casestudy_intermediate' was properly closed.
[0m12:03:44.082570 [debug] [MainThread]: Connection 'test.vg_casestudy.not_null_reporting__high_lvl_branch_loan_kpis_branch_id.1ad6d682e7' was properly closed.
[0m12:03:44.082982 [info ] [MainThread]: 
[0m12:03:44.083334 [info ] [MainThread]: Finished running 1 test in 0 hours 0 minutes and 0.43 seconds (0.43s).
[0m12:03:44.083941 [debug] [MainThread]: Command end result
[0m12:03:44.105440 [info ] [MainThread]: 
[0m12:03:44.105951 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:03:44.106387 [info ] [MainThread]: 
[0m12:03:44.106744 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:03:44.107275 [debug] [MainThread]: Command `dbt test` succeeded at 12:03:44.107170 after 0.92 seconds
[0m12:03:44.107624 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f66e53b50d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f66e4e89fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f66e4e8dcd0>]}
[0m12:03:44.107980 [debug] [MainThread]: Flushing usage events
[0m12:09:14.795347 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f06b261b0d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f06afd12790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f06b0809f10>]}


============================== 12:09:14.801226 | 54b72349-f955-4edd-a09d-a65fea148f0e ==============================
[0m12:09:14.801226 [info ] [MainThread]: Running with dbt=1.6.18
[0m12:09:14.801818 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/workspaces/vg_case_study_tim/transformation', 'debug': 'False', 'warn_error': 'None', 'log_path': '/workspaces/vg_case_study_tim/transformation/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --select reporting__high_lvl_branch_loan_kpis --full-refresh', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:09:15.028730 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '54b72349-f955-4edd-a09d-a65fea148f0e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f06afe30350>]}
[0m12:09:15.044428 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '54b72349-f955-4edd-a09d-a65fea148f0e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f06ab976e10>]}
[0m12:09:15.045983 [info ] [MainThread]: Registered adapter: duckdb=1.6.2
[0m12:09:15.078226 [debug] [MainThread]: checksum: 7b9fab86a08e9e96a48a825af743c566d95b877e068b8c6d0dbafbf714447189, vars: {}, profile: , target: , version: 1.6.18
[0m12:09:15.188140 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m12:09:15.189559 [debug] [MainThread]: Partial parsing: updated file: vg_casestudy://models/reporting/reporting__high_lvl_branch_loan_kpis.yml
[0m12:09:15.190104 [debug] [MainThread]: Partial parsing: updated file: vg_casestudy://models/reporting/reporting__high_lvl_branch_loan_kpis.sql
[0m12:09:15.378390 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.vg_casestudy.main
[0m12:09:15.386135 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '54b72349-f955-4edd-a09d-a65fea148f0e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f06ab987450>]}
[0m12:09:15.423748 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '54b72349-f955-4edd-a09d-a65fea148f0e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f06afe55410>]}
[0m12:09:15.424352 [info ] [MainThread]: Found 17 models, 1 analysis, 4 seeds, 113 tests, 5 sources, 0 exposures, 0 metrics, 632 macros, 0 groups, 0 semantic models
[0m12:09:15.424800 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '54b72349-f955-4edd-a09d-a65fea148f0e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f06ab7ca250>]}
[0m12:09:15.428816 [info ] [MainThread]: 
[0m12:09:15.430085 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m12:09:15.431592 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_casestudy'
[0m12:09:15.446375 [debug] [ThreadPool]: Using duckdb connection "list_casestudy"
[0m12:09:15.446840 [debug] [ThreadPool]: On list_casestudy: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"casestudy"'
    
  
  
[0m12:09:15.447180 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:09:15.607437 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:09:15.610586 [debug] [ThreadPool]: On list_casestudy: Close
[0m12:09:15.615909 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy, now create_casestudy_reporting)
[0m12:09:15.617013 [debug] [ThreadPool]: Creating schema "database: "casestudy"
schema: "reporting"
"
[0m12:09:15.623870 [debug] [ThreadPool]: Using duckdb connection "create_casestudy_reporting"
[0m12:09:15.624501 [debug] [ThreadPool]: On create_casestudy_reporting: BEGIN
[0m12:09:15.624936 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:09:15.643416 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:09:15.644030 [debug] [ThreadPool]: Using duckdb connection "create_casestudy_reporting"
[0m12:09:15.644420 [debug] [ThreadPool]: On create_casestudy_reporting: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "create_casestudy_reporting"} */
create schema if not exists "casestudy"."reporting"
[0m12:09:15.645359 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:09:15.646757 [debug] [ThreadPool]: On create_casestudy_reporting: COMMIT
[0m12:09:15.647285 [debug] [ThreadPool]: Using duckdb connection "create_casestudy_reporting"
[0m12:09:15.647679 [debug] [ThreadPool]: On create_casestudy_reporting: COMMIT
[0m12:09:15.648609 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:09:15.649060 [debug] [ThreadPool]: On create_casestudy_reporting: Close
[0m12:09:15.659532 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_casestudy_reporting, now list_casestudy_staging)
[0m12:09:15.667796 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_staging"
[0m12:09:15.668284 [debug] [ThreadPool]: On list_casestudy_staging: BEGIN
[0m12:09:15.668732 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:09:15.690729 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:09:15.691620 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_staging"
[0m12:09:15.692370 [debug] [ThreadPool]: On list_casestudy_staging: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_staging"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'staging'
    and table_catalog = 'casestudy'
  
[0m12:09:15.749042 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:09:15.751646 [debug] [ThreadPool]: On list_casestudy_staging: ROLLBACK
[0m12:09:15.754321 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_staging'
[0m12:09:15.755046 [debug] [ThreadPool]: On list_casestudy_staging: Close
[0m12:09:15.770006 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy_staging, now list_casestudy_raw)
[0m12:09:15.773949 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_raw"
[0m12:09:15.774691 [debug] [ThreadPool]: On list_casestudy_raw: BEGIN
[0m12:09:15.775252 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:09:15.801217 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:09:15.802000 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_raw"
[0m12:09:15.802598 [debug] [ThreadPool]: On list_casestudy_raw: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_raw"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'raw'
    and table_catalog = 'casestudy'
  
[0m12:09:15.824221 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:09:15.826648 [debug] [ThreadPool]: On list_casestudy_raw: ROLLBACK
[0m12:09:15.827394 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_raw'
[0m12:09:15.827814 [debug] [ThreadPool]: On list_casestudy_raw: Close
[0m12:09:15.832490 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy_raw, now list_casestudy_reporting)
[0m12:09:15.837745 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_reporting"
[0m12:09:15.838478 [debug] [ThreadPool]: On list_casestudy_reporting: BEGIN
[0m12:09:15.838999 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:09:15.859321 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:09:15.859987 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_reporting"
[0m12:09:15.860474 [debug] [ThreadPool]: On list_casestudy_reporting: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_reporting"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'reporting'
    and table_catalog = 'casestudy'
  
[0m12:09:15.878587 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:09:15.880426 [debug] [ThreadPool]: On list_casestudy_reporting: ROLLBACK
[0m12:09:15.880995 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_reporting'
[0m12:09:15.881350 [debug] [ThreadPool]: On list_casestudy_reporting: Close
[0m12:09:15.886332 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy_reporting, now list_casestudy_marts)
[0m12:09:15.892649 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_marts"
[0m12:09:15.893332 [debug] [ThreadPool]: On list_casestudy_marts: BEGIN
[0m12:09:15.893817 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:09:15.913339 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:09:15.914015 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_marts"
[0m12:09:15.914717 [debug] [ThreadPool]: On list_casestudy_marts: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_marts"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'marts'
    and table_catalog = 'casestudy'
  
[0m12:09:15.932905 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:09:15.935008 [debug] [ThreadPool]: On list_casestudy_marts: ROLLBACK
[0m12:09:15.935755 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_marts'
[0m12:09:15.936187 [debug] [ThreadPool]: On list_casestudy_marts: Close
[0m12:09:15.943234 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy_marts, now list_casestudy_intermediate)
[0m12:09:15.946286 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_intermediate"
[0m12:09:15.946883 [debug] [ThreadPool]: On list_casestudy_intermediate: BEGIN
[0m12:09:15.947347 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:09:15.969519 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:09:15.970244 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_intermediate"
[0m12:09:15.972600 [debug] [ThreadPool]: On list_casestudy_intermediate: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_intermediate"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'intermediate'
    and table_catalog = 'casestudy'
  
[0m12:09:15.985473 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:09:15.989571 [debug] [ThreadPool]: On list_casestudy_intermediate: ROLLBACK
[0m12:09:15.990469 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_intermediate'
[0m12:09:15.990872 [debug] [ThreadPool]: On list_casestudy_intermediate: Close
[0m12:09:15.996676 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '54b72349-f955-4edd-a09d-a65fea148f0e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f06ab978c50>]}
[0m12:09:15.997397 [debug] [MainThread]: Using duckdb connection "master"
[0m12:09:15.997806 [debug] [MainThread]: On master: BEGIN
[0m12:09:15.998147 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:09:16.015878 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m12:09:16.016389 [debug] [MainThread]: On master: COMMIT
[0m12:09:16.016747 [debug] [MainThread]: Using duckdb connection "master"
[0m12:09:16.017065 [debug] [MainThread]: On master: COMMIT
[0m12:09:16.017702 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m12:09:16.018048 [debug] [MainThread]: On master: Close
[0m12:09:16.021500 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:09:16.022696 [info ] [MainThread]: 
[0m12:09:16.028518 [debug] [Thread-1 (]: Began running node model.vg_casestudy.reporting__high_lvl_branch_loan_kpis
[0m12:09:16.029351 [info ] [Thread-1 (]: 1 of 1 START sql view model reporting.reporting__high_lvl_branch_loan_kpis ..... [RUN]
[0m12:09:16.030509 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.vg_casestudy.reporting__high_lvl_branch_loan_kpis'
[0m12:09:16.031045 [debug] [Thread-1 (]: Began compiling node model.vg_casestudy.reporting__high_lvl_branch_loan_kpis
[0m12:09:16.051331 [debug] [Thread-1 (]: Writing injected SQL for node "model.vg_casestudy.reporting__high_lvl_branch_loan_kpis"
[0m12:09:16.052478 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.reporting__high_lvl_branch_loan_kpis (compile): 12:09:16.031430 => 12:09:16.052106
[0m12:09:16.053221 [debug] [Thread-1 (]: Began executing node model.vg_casestudy.reporting__high_lvl_branch_loan_kpis
[0m12:09:16.103322 [debug] [Thread-1 (]: Writing runtime sql for node "model.vg_casestudy.reporting__high_lvl_branch_loan_kpis"
[0m12:09:16.104335 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.reporting__high_lvl_branch_loan_kpis"
[0m12:09:16.105033 [debug] [Thread-1 (]: On model.vg_casestudy.reporting__high_lvl_branch_loan_kpis: BEGIN
[0m12:09:16.105593 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:09:16.124039 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m12:09:16.124562 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.reporting__high_lvl_branch_loan_kpis"
[0m12:09:16.124978 [debug] [Thread-1 (]: On model.vg_casestudy.reporting__high_lvl_branch_loan_kpis: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.reporting__high_lvl_branch_loan_kpis"} */

  
  create view "casestudy"."reporting"."reporting__high_lvl_branch_loan_kpis__dbt_tmp" as (
    with loans as (
    select *
    from "casestudy"."marts"."marts__loans_enriched"
),

aggregated as (
    select 
        branch_id,
        branch_name,

        -- loan count by status
        count(loan_id) as count_of_loans,
        count(case when loan_status = 'approved' then loan_id end) as loans_approved,
        count(case when loan_status = 'rejected' then loan_id end) as loans_rejected,
        count(case when loan_status = 'closed' then loan_id end) as loans_closed,

        -- loan count by type
        count(case when loan_status = 'personal' then loan_id end) as loans_personal,
        count(case when loan_status = 'mortgage' then loan_id end) as loans_mortgage,
        count(case when loan_status = 'auto' then loan_id end) as loans_auto,

        -- approval rate
        count(case when loan_status = 'approved' then loan_id end)::float
            / nullif(count(loan_id), 0) as approval_rate,
        count(case when loan_status = 'rejected' then loan_id end)::float
            / nullif(count(loan_id), 0) as rejection_rate,
        count(case when loan_status = 'closed' then loan_id end)::float
            / nullif(count(loan_id), 0) as closed_rate,

        -- loan kpis
        sum(loan_amount) as total_loan_amount,
        sum(loan_amount)::float / nullif(count(loan_id), 0) as avg_loan_amount,
        avg(interest_rate) as avg_interest_rate,
        avg(loan_term)  as avg_loan_term_months,
        count(case when loan_term > 36 then loan_id end)::float / count(loan_id) as long_term_loan_share_more_than_36,
        count(case when loan_term < 24 then loan_id end)::float / count(loan_id) as short_term_loan_share_less_than_24,
        min(case when loans.loan_status = 'approved' then approval_rejection_date end) as earliest_approval_date,
        max(case when loans.loan_status = 'approved' then approval_rejection_date end) as latest_approval_date

    from loans
    group by branch_id,branch_name
)

select *
from aggregated
  );

[0m12:09:16.128688 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m12:09:16.135455 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.reporting__high_lvl_branch_loan_kpis"
[0m12:09:16.136694 [debug] [Thread-1 (]: On model.vg_casestudy.reporting__high_lvl_branch_loan_kpis: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.reporting__high_lvl_branch_loan_kpis"} */
alter view "casestudy"."reporting"."reporting__high_lvl_branch_loan_kpis" rename to "reporting__high_lvl_branch_loan_kpis__dbt_backup"
[0m12:09:16.138341 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m12:09:16.142488 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.reporting__high_lvl_branch_loan_kpis"
[0m12:09:16.143018 [debug] [Thread-1 (]: On model.vg_casestudy.reporting__high_lvl_branch_loan_kpis: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.reporting__high_lvl_branch_loan_kpis"} */
alter view "casestudy"."reporting"."reporting__high_lvl_branch_loan_kpis__dbt_tmp" rename to "reporting__high_lvl_branch_loan_kpis"
[0m12:09:16.144132 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m12:09:16.161153 [debug] [Thread-1 (]: On model.vg_casestudy.reporting__high_lvl_branch_loan_kpis: COMMIT
[0m12:09:16.161660 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.reporting__high_lvl_branch_loan_kpis"
[0m12:09:16.162002 [debug] [Thread-1 (]: On model.vg_casestudy.reporting__high_lvl_branch_loan_kpis: COMMIT
[0m12:09:16.165622 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m12:09:16.170834 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.reporting__high_lvl_branch_loan_kpis"
[0m12:09:16.171574 [debug] [Thread-1 (]: On model.vg_casestudy.reporting__high_lvl_branch_loan_kpis: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.reporting__high_lvl_branch_loan_kpis"} */
drop view if exists "casestudy"."reporting"."reporting__high_lvl_branch_loan_kpis__dbt_backup" cascade
[0m12:09:16.175282 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m12:09:16.176869 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.reporting__high_lvl_branch_loan_kpis (execute): 12:09:16.053637 => 12:09:16.176665
[0m12:09:16.177265 [debug] [Thread-1 (]: On model.vg_casestudy.reporting__high_lvl_branch_loan_kpis: Close
[0m12:09:16.203316 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '54b72349-f955-4edd-a09d-a65fea148f0e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f06ab5c5110>]}
[0m12:09:16.204088 [info ] [Thread-1 (]: 1 of 1 OK created sql view model reporting.reporting__high_lvl_branch_loan_kpis  [[32mOK[0m in 0.17s]
[0m12:09:16.204877 [debug] [Thread-1 (]: Finished running node model.vg_casestudy.reporting__high_lvl_branch_loan_kpis
[0m12:09:16.206979 [debug] [MainThread]: Using duckdb connection "master"
[0m12:09:16.207388 [debug] [MainThread]: On master: BEGIN
[0m12:09:16.207675 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:09:16.223432 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m12:09:16.224103 [debug] [MainThread]: On master: COMMIT
[0m12:09:16.224421 [debug] [MainThread]: Using duckdb connection "master"
[0m12:09:16.224690 [debug] [MainThread]: On master: COMMIT
[0m12:09:16.225380 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m12:09:16.225754 [debug] [MainThread]: On master: Close
[0m12:09:16.228388 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:09:16.228753 [debug] [MainThread]: Connection 'list_casestudy_intermediate' was properly closed.
[0m12:09:16.229025 [debug] [MainThread]: Connection 'model.vg_casestudy.reporting__high_lvl_branch_loan_kpis' was properly closed.
[0m12:09:16.229363 [info ] [MainThread]: 
[0m12:09:16.229714 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.80 seconds (0.80s).
[0m12:09:16.230308 [debug] [MainThread]: Command end result
[0m12:09:16.251383 [info ] [MainThread]: 
[0m12:09:16.251868 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:09:16.252194 [info ] [MainThread]: 
[0m12:09:16.252512 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:09:16.252993 [debug] [MainThread]: Command `dbt run` succeeded at 12:09:16.252897 after 1.47 seconds
[0m12:09:16.253340 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f06b13da650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f06ab843590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f06b45123d0>]}
[0m12:09:16.253686 [debug] [MainThread]: Flushing usage events
[0m12:09:25.248543 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5aa6bcb810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5aa6e47890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5aa6ea0590>]}


============================== 12:09:25.251031 | c5111f5e-ac14-4b18-9883-95ca443bffaf ==============================
[0m12:09:25.251031 [info ] [MainThread]: Running with dbt=1.6.18
[0m12:09:25.251653 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/workspaces/vg_case_study_tim/transformation', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/workspaces/vg_case_study_tim/transformation/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt test --select reporting__high_lvl_branch_loan_kpis', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:09:25.348706 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c5111f5e-ac14-4b18-9883-95ca443bffaf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5aa6c24650>]}
[0m12:09:25.363605 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c5111f5e-ac14-4b18-9883-95ca443bffaf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5aa6bca790>]}
[0m12:09:25.364345 [info ] [MainThread]: Registered adapter: duckdb=1.6.2
[0m12:09:25.392130 [debug] [MainThread]: checksum: 7b9fab86a08e9e96a48a825af743c566d95b877e068b8c6d0dbafbf714447189, vars: {}, profile: , target: , version: 1.6.18
[0m12:09:25.438907 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:09:25.439546 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:09:25.441711 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.vg_casestudy.main
[0m12:09:25.451481 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c5111f5e-ac14-4b18-9883-95ca443bffaf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5aa6be4590>]}
[0m12:09:25.536467 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c5111f5e-ac14-4b18-9883-95ca443bffaf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5aa6eb3b90>]}
[0m12:09:25.537047 [info ] [MainThread]: Found 17 models, 1 analysis, 4 seeds, 113 tests, 5 sources, 0 exposures, 0 metrics, 632 macros, 0 groups, 0 semantic models
[0m12:09:25.538050 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c5111f5e-ac14-4b18-9883-95ca443bffaf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5aa874f210>]}
[0m12:09:25.541351 [info ] [MainThread]: 
[0m12:09:25.542300 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m12:09:25.545274 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_casestudy_staging'
[0m12:09:25.559772 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_staging"
[0m12:09:25.560456 [debug] [ThreadPool]: On list_casestudy_staging: BEGIN
[0m12:09:25.560843 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:09:25.578497 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:09:25.578993 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_staging"
[0m12:09:25.579323 [debug] [ThreadPool]: On list_casestudy_staging: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_staging"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'staging'
    and table_catalog = 'casestudy'
  
[0m12:09:25.593294 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:09:25.594905 [debug] [ThreadPool]: On list_casestudy_staging: ROLLBACK
[0m12:09:25.595650 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_staging'
[0m12:09:25.595953 [debug] [ThreadPool]: On list_casestudy_staging: Close
[0m12:09:25.600451 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy_staging, now list_casestudy_reporting)
[0m12:09:25.602848 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_reporting"
[0m12:09:25.603241 [debug] [ThreadPool]: On list_casestudy_reporting: BEGIN
[0m12:09:25.603557 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:09:25.618171 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:09:25.618660 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_reporting"
[0m12:09:25.619005 [debug] [ThreadPool]: On list_casestudy_reporting: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_reporting"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'reporting'
    and table_catalog = 'casestudy'
  
[0m12:09:25.629442 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:09:25.630844 [debug] [ThreadPool]: On list_casestudy_reporting: ROLLBACK
[0m12:09:25.631399 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_reporting'
[0m12:09:25.631701 [debug] [ThreadPool]: On list_casestudy_reporting: Close
[0m12:09:25.636421 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy_reporting, now list_casestudy_marts)
[0m12:09:25.639067 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_marts"
[0m12:09:25.640436 [debug] [ThreadPool]: On list_casestudy_marts: BEGIN
[0m12:09:25.641018 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:09:25.652447 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:09:25.652870 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_marts"
[0m12:09:25.653190 [debug] [ThreadPool]: On list_casestudy_marts: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_marts"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'marts'
    and table_catalog = 'casestudy'
  
[0m12:09:25.668074 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:09:25.670304 [debug] [ThreadPool]: On list_casestudy_marts: ROLLBACK
[0m12:09:25.673432 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_marts'
[0m12:09:25.674141 [debug] [ThreadPool]: On list_casestudy_marts: Close
[0m12:09:25.679098 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy_marts, now list_casestudy_raw)
[0m12:09:25.682780 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_raw"
[0m12:09:25.684279 [debug] [ThreadPool]: On list_casestudy_raw: BEGIN
[0m12:09:25.684711 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:09:25.704146 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:09:25.704598 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_raw"
[0m12:09:25.704961 [debug] [ThreadPool]: On list_casestudy_raw: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_raw"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'raw'
    and table_catalog = 'casestudy'
  
[0m12:09:25.718672 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:09:25.720829 [debug] [ThreadPool]: On list_casestudy_raw: ROLLBACK
[0m12:09:25.722618 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_raw'
[0m12:09:25.723870 [debug] [ThreadPool]: On list_casestudy_raw: Close
[0m12:09:25.727339 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy_raw, now list_casestudy_intermediate)
[0m12:09:25.729928 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_intermediate"
[0m12:09:25.731705 [debug] [ThreadPool]: On list_casestudy_intermediate: BEGIN
[0m12:09:25.732098 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:09:25.747645 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:09:25.748123 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_intermediate"
[0m12:09:25.748448 [debug] [ThreadPool]: On list_casestudy_intermediate: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_intermediate"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'intermediate'
    and table_catalog = 'casestudy'
  
[0m12:09:25.760753 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:09:25.762448 [debug] [ThreadPool]: On list_casestudy_intermediate: ROLLBACK
[0m12:09:25.763068 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_intermediate'
[0m12:09:25.763529 [debug] [ThreadPool]: On list_casestudy_intermediate: Close
[0m12:09:25.768241 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c5111f5e-ac14-4b18-9883-95ca443bffaf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5aa3537890>]}
[0m12:09:25.768858 [debug] [MainThread]: Using duckdb connection "master"
[0m12:09:25.769200 [debug] [MainThread]: On master: BEGIN
[0m12:09:25.769503 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:09:25.785966 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m12:09:25.786435 [debug] [MainThread]: On master: COMMIT
[0m12:09:25.786776 [debug] [MainThread]: Using duckdb connection "master"
[0m12:09:25.787052 [debug] [MainThread]: On master: COMMIT
[0m12:09:25.787968 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m12:09:25.788561 [debug] [MainThread]: On master: Close
[0m12:09:25.792446 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:09:25.793001 [info ] [MainThread]: 
[0m12:09:25.795446 [debug] [Thread-1 (]: Began running node test.vg_casestudy.not_null_reporting__high_lvl_branch_loan_kpis_branch_id.1ad6d682e7
[0m12:09:25.795964 [info ] [Thread-1 (]: 1 of 1 START test not_null_reporting__high_lvl_branch_loan_kpis_branch_id ...... [RUN]
[0m12:09:25.796868 [debug] [Thread-1 (]: Acquiring new duckdb connection 'test.vg_casestudy.not_null_reporting__high_lvl_branch_loan_kpis_branch_id.1ad6d682e7'
[0m12:09:25.797291 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.not_null_reporting__high_lvl_branch_loan_kpis_branch_id.1ad6d682e7
[0m12:09:25.820578 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.not_null_reporting__high_lvl_branch_loan_kpis_branch_id.1ad6d682e7"
[0m12:09:25.821451 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_reporting__high_lvl_branch_loan_kpis_branch_id.1ad6d682e7 (compile): 12:09:25.797606 => 12:09:25.821167
[0m12:09:25.822371 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.not_null_reporting__high_lvl_branch_loan_kpis_branch_id.1ad6d682e7
[0m12:09:25.837447 [debug] [Thread-1 (]: Writing runtime sql for node "test.vg_casestudy.not_null_reporting__high_lvl_branch_loan_kpis_branch_id.1ad6d682e7"
[0m12:09:25.838606 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.not_null_reporting__high_lvl_branch_loan_kpis_branch_id.1ad6d682e7"
[0m12:09:25.839382 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_reporting__high_lvl_branch_loan_kpis_branch_id.1ad6d682e7: BEGIN
[0m12:09:25.840047 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:09:25.857451 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m12:09:25.858113 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.not_null_reporting__high_lvl_branch_loan_kpis_branch_id.1ad6d682e7"
[0m12:09:25.858529 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_reporting__high_lvl_branch_loan_kpis_branch_id.1ad6d682e7: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "test.vg_casestudy.not_null_reporting__high_lvl_branch_loan_kpis_branch_id.1ad6d682e7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select branch_id
from "casestudy"."reporting"."reporting__high_lvl_branch_loan_kpis"
where branch_id is null



      
    ) dbt_internal_test
[0m12:09:25.873985 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m12:09:25.877439 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_reporting__high_lvl_branch_loan_kpis_branch_id.1ad6d682e7 (execute): 12:09:25.823220 => 12:09:25.877194
[0m12:09:25.877870 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_reporting__high_lvl_branch_loan_kpis_branch_id.1ad6d682e7: ROLLBACK
[0m12:09:25.878351 [debug] [Thread-1 (]: Failed to rollback 'test.vg_casestudy.not_null_reporting__high_lvl_branch_loan_kpis_branch_id.1ad6d682e7'
[0m12:09:25.878686 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_reporting__high_lvl_branch_loan_kpis_branch_id.1ad6d682e7: Close
[0m12:09:25.882819 [info ] [Thread-1 (]: 1 of 1 PASS not_null_reporting__high_lvl_branch_loan_kpis_branch_id ............ [[32mPASS[0m in 0.09s]
[0m12:09:25.883496 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.not_null_reporting__high_lvl_branch_loan_kpis_branch_id.1ad6d682e7
[0m12:09:25.885316 [debug] [MainThread]: Using duckdb connection "master"
[0m12:09:25.885727 [debug] [MainThread]: On master: BEGIN
[0m12:09:25.886044 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:09:25.901586 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m12:09:25.902117 [debug] [MainThread]: On master: COMMIT
[0m12:09:25.902518 [debug] [MainThread]: Using duckdb connection "master"
[0m12:09:25.902846 [debug] [MainThread]: On master: COMMIT
[0m12:09:25.903444 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m12:09:25.903754 [debug] [MainThread]: On master: Close
[0m12:09:25.907879 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:09:25.908506 [debug] [MainThread]: Connection 'list_casestudy_intermediate' was properly closed.
[0m12:09:25.908785 [debug] [MainThread]: Connection 'test.vg_casestudy.not_null_reporting__high_lvl_branch_loan_kpis_branch_id.1ad6d682e7' was properly closed.
[0m12:09:25.909099 [info ] [MainThread]: 
[0m12:09:25.909445 [info ] [MainThread]: Finished running 1 test in 0 hours 0 minutes and 0.37 seconds (0.37s).
[0m12:09:25.910015 [debug] [MainThread]: Command end result
[0m12:09:25.932445 [info ] [MainThread]: 
[0m12:09:25.932940 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:09:25.933272 [info ] [MainThread]: 
[0m12:09:25.933595 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:09:25.934087 [debug] [MainThread]: Command `dbt test` succeeded at 12:09:25.933991 after 0.69 seconds
[0m12:09:25.934437 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5aab887510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5aab8862d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5aa71a5690>]}
[0m12:09:25.934795 [debug] [MainThread]: Flushing usage events
[0m12:21:43.898166 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f194fbb7510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f194fbb7850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f194fec7b10>]}


============================== 12:21:43.904249 | e6ab486d-b3f5-4faa-b457-d8339ff8bf8d ==============================
[0m12:21:43.904249 [info ] [MainThread]: Running with dbt=1.6.18
[0m12:21:43.904857 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/workspaces/vg_case_study_tim/transformation', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/workspaces/vg_case_study_tim/transformation/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run --select reporting__high_lvl_branch_loan_kpis --full-refresh', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:21:44.104375 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e6ab486d-b3f5-4faa-b457-d8339ff8bf8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f194f85e490>]}
[0m12:21:44.118682 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e6ab486d-b3f5-4faa-b457-d8339ff8bf8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f194fe982d0>]}
[0m12:21:44.120143 [info ] [MainThread]: Registered adapter: duckdb=1.6.2
[0m12:21:44.149091 [debug] [MainThread]: checksum: 7b9fab86a08e9e96a48a825af743c566d95b877e068b8c6d0dbafbf714447189, vars: {}, profile: , target: , version: 1.6.18
[0m12:21:44.248812 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m12:21:44.249860 [debug] [MainThread]: Partial parsing: updated file: vg_casestudy://models/reporting/reporting__high_lvl_branch_loan_kpis.yml
[0m12:21:44.250260 [debug] [MainThread]: Partial parsing: updated file: vg_casestudy://models/reporting/reporting__high_lvl_branch_loan_kpis.sql
[0m12:21:44.393213 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.vg_casestudy.main
[0m12:21:44.400899 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e6ab486d-b3f5-4faa-b457-d8339ff8bf8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f194fcf8ed0>]}
[0m12:21:44.436566 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e6ab486d-b3f5-4faa-b457-d8339ff8bf8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f194a473e50>]}
[0m12:21:44.437180 [info ] [MainThread]: Found 17 models, 1 analysis, 4 seeds, 113 tests, 5 sources, 0 exposures, 0 metrics, 632 macros, 0 groups, 0 semantic models
[0m12:21:44.437657 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e6ab486d-b3f5-4faa-b457-d8339ff8bf8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f194b72e890>]}
[0m12:21:44.440247 [info ] [MainThread]: 
[0m12:21:44.441017 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m12:21:44.442300 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_casestudy'
[0m12:21:44.456044 [debug] [ThreadPool]: Using duckdb connection "list_casestudy"
[0m12:21:44.456526 [debug] [ThreadPool]: On list_casestudy: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"casestudy"'
    
  
  
[0m12:21:44.456867 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:21:44.592781 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:21:44.594377 [debug] [ThreadPool]: On list_casestudy: Close
[0m12:21:44.599281 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy, now create_casestudy_reporting)
[0m12:21:44.600203 [debug] [ThreadPool]: Creating schema "database: "casestudy"
schema: "reporting"
"
[0m12:21:44.604659 [debug] [ThreadPool]: Using duckdb connection "create_casestudy_reporting"
[0m12:21:44.605013 [debug] [ThreadPool]: On create_casestudy_reporting: BEGIN
[0m12:21:44.605286 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:21:44.617430 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:21:44.617842 [debug] [ThreadPool]: Using duckdb connection "create_casestudy_reporting"
[0m12:21:44.618127 [debug] [ThreadPool]: On create_casestudy_reporting: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "create_casestudy_reporting"} */
create schema if not exists "casestudy"."reporting"
[0m12:21:44.618776 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:21:44.619626 [debug] [ThreadPool]: On create_casestudy_reporting: COMMIT
[0m12:21:44.619888 [debug] [ThreadPool]: Using duckdb connection "create_casestudy_reporting"
[0m12:21:44.620162 [debug] [ThreadPool]: On create_casestudy_reporting: COMMIT
[0m12:21:44.620628 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:21:44.620902 [debug] [ThreadPool]: On create_casestudy_reporting: Close
[0m12:21:44.626553 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_casestudy_reporting, now list_casestudy_intermediate)
[0m12:21:44.631478 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_intermediate"
[0m12:21:44.631888 [debug] [ThreadPool]: On list_casestudy_intermediate: BEGIN
[0m12:21:44.632212 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:21:44.644904 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:21:44.645308 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_intermediate"
[0m12:21:44.645604 [debug] [ThreadPool]: On list_casestudy_intermediate: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_intermediate"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'intermediate'
    and table_catalog = 'casestudy'
  
[0m12:21:44.660342 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:21:44.662406 [debug] [ThreadPool]: On list_casestudy_intermediate: ROLLBACK
[0m12:21:44.663661 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_intermediate'
[0m12:21:44.664063 [debug] [ThreadPool]: On list_casestudy_intermediate: Close
[0m12:21:44.667472 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy_intermediate, now list_casestudy_reporting)
[0m12:21:44.671574 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_reporting"
[0m12:21:44.672066 [debug] [ThreadPool]: On list_casestudy_reporting: BEGIN
[0m12:21:44.672402 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:21:44.685766 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:21:44.686221 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_reporting"
[0m12:21:44.686640 [debug] [ThreadPool]: On list_casestudy_reporting: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_reporting"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'reporting'
    and table_catalog = 'casestudy'
  
[0m12:21:44.696282 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:21:44.697850 [debug] [ThreadPool]: On list_casestudy_reporting: ROLLBACK
[0m12:21:44.698353 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_reporting'
[0m12:21:44.698653 [debug] [ThreadPool]: On list_casestudy_reporting: Close
[0m12:21:44.701791 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy_reporting, now list_casestudy_raw)
[0m12:21:44.704641 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_raw"
[0m12:21:44.705382 [debug] [ThreadPool]: On list_casestudy_raw: BEGIN
[0m12:21:44.705700 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:21:44.718703 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:21:44.719215 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_raw"
[0m12:21:44.719659 [debug] [ThreadPool]: On list_casestudy_raw: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_raw"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'raw'
    and table_catalog = 'casestudy'
  
[0m12:21:44.730120 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:21:44.731694 [debug] [ThreadPool]: On list_casestudy_raw: ROLLBACK
[0m12:21:44.732241 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_raw'
[0m12:21:44.732536 [debug] [ThreadPool]: On list_casestudy_raw: Close
[0m12:21:44.736027 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy_raw, now list_casestudy_staging)
[0m12:21:44.740199 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_staging"
[0m12:21:44.740703 [debug] [ThreadPool]: On list_casestudy_staging: BEGIN
[0m12:21:44.741010 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:21:44.754272 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:21:44.754688 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_staging"
[0m12:21:44.755036 [debug] [ThreadPool]: On list_casestudy_staging: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_staging"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'staging'
    and table_catalog = 'casestudy'
  
[0m12:21:44.763393 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:21:44.764769 [debug] [ThreadPool]: On list_casestudy_staging: ROLLBACK
[0m12:21:44.765236 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_staging'
[0m12:21:44.765493 [debug] [ThreadPool]: On list_casestudy_staging: Close
[0m12:21:44.768603 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy_staging, now list_casestudy_marts)
[0m12:21:44.770717 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_marts"
[0m12:21:44.771069 [debug] [ThreadPool]: On list_casestudy_marts: BEGIN
[0m12:21:44.771382 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:21:44.782163 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:21:44.782533 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_marts"
[0m12:21:44.782840 [debug] [ThreadPool]: On list_casestudy_marts: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_marts"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'marts'
    and table_catalog = 'casestudy'
  
[0m12:21:44.791123 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:21:44.792357 [debug] [ThreadPool]: On list_casestudy_marts: ROLLBACK
[0m12:21:44.792793 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_marts'
[0m12:21:44.793054 [debug] [ThreadPool]: On list_casestudy_marts: Close
[0m12:21:44.796549 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e6ab486d-b3f5-4faa-b457-d8339ff8bf8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f194b999990>]}
[0m12:21:44.797042 [debug] [MainThread]: Using duckdb connection "master"
[0m12:21:44.797322 [debug] [MainThread]: On master: BEGIN
[0m12:21:44.797603 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:21:44.811704 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m12:21:44.812121 [debug] [MainThread]: On master: COMMIT
[0m12:21:44.812415 [debug] [MainThread]: Using duckdb connection "master"
[0m12:21:44.812701 [debug] [MainThread]: On master: COMMIT
[0m12:21:44.813427 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m12:21:44.813758 [debug] [MainThread]: On master: Close
[0m12:21:44.816254 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:21:44.816809 [info ] [MainThread]: 
[0m12:21:44.822889 [debug] [Thread-1 (]: Began running node model.vg_casestudy.reporting__high_lvl_branch_loan_kpis
[0m12:21:44.823478 [info ] [Thread-1 (]: 1 of 1 START sql view model reporting.reporting__high_lvl_branch_loan_kpis ..... [RUN]
[0m12:21:44.824308 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.vg_casestudy.reporting__high_lvl_branch_loan_kpis'
[0m12:21:44.824679 [debug] [Thread-1 (]: Began compiling node model.vg_casestudy.reporting__high_lvl_branch_loan_kpis
[0m12:21:44.836440 [debug] [Thread-1 (]: Writing injected SQL for node "model.vg_casestudy.reporting__high_lvl_branch_loan_kpis"
[0m12:21:44.837317 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.reporting__high_lvl_branch_loan_kpis (compile): 12:21:44.824960 => 12:21:44.837082
[0m12:21:44.837709 [debug] [Thread-1 (]: Began executing node model.vg_casestudy.reporting__high_lvl_branch_loan_kpis
[0m12:21:44.869607 [debug] [Thread-1 (]: Writing runtime sql for node "model.vg_casestudy.reporting__high_lvl_branch_loan_kpis"
[0m12:21:44.870281 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.reporting__high_lvl_branch_loan_kpis"
[0m12:21:44.870709 [debug] [Thread-1 (]: On model.vg_casestudy.reporting__high_lvl_branch_loan_kpis: BEGIN
[0m12:21:44.871017 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:21:44.888025 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m12:21:44.888492 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.reporting__high_lvl_branch_loan_kpis"
[0m12:21:44.888918 [debug] [Thread-1 (]: On model.vg_casestudy.reporting__high_lvl_branch_loan_kpis: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.reporting__high_lvl_branch_loan_kpis"} */

  
  create view "casestudy"."reporting"."reporting__high_lvl_branch_loan_kpis__dbt_tmp" as (
    with loans as (
    select *
    from "casestudy"."marts"."marts__loans_enriched"
),

aggregated as (
    select 
        branch_id,
        branch_name,

        -- loan count by status
        count(loan_id) as count_of_loans,
        count(case when loan_status = 'approved' then loan_id end) as loans_approved,
        count(case when loan_status = 'rejected' then loan_id end) as loans_rejected,
        count(case when loan_status = 'closed' then loan_id end) as loans_closed,

        -- loan count by type
        count(case when loan_status = 'personal' then loan_id end) as loans_personal,
        count(case when loan_status = 'mortgage' then loan_id end) as loans_mortgage,
        count(case when loan_status = 'auto' then loan_id end) as loans_auto,

        --customer segmentation
        count(distinct customer_id) as unique_customers,
        count(case when age < 30 then loan_id end) as loans_under_30,
        count(case when age between 30 and 50 then loan_id end) as loans_30_to_50,
        count(case when age > 50 then loan_id end) as loans_over_50,

        -- approval rate
        count(case when loan_status = 'approved' then loan_id end)::float
            / nullif(count(loan_id), 0) as approval_rate,
        count(case when loan_status = 'rejected' then loan_id end)::float
            / nullif(count(loan_id), 0) as rejection_rate,
        count(case when loan_status = 'closed' then loan_id end)::float
            / nullif(count(loan_id), 0) as closed_rate,

        -- loan kpis
        sum(loan_amount) as total_loan_amount,
        sum(loan_amount)::float / nullif(count(loan_id), 0) as avg_loan_amount,
        avg(interest_rate) as avg_interest_rate,
        avg(loan_term)  as avg_loan_term_months,
        count(case when loan_term > 36 then loan_id end)::float / count(loan_id) as long_term_loan_share_more_than_36,
        count(case when loan_term < 24 then loan_id end)::float / count(loan_id) as short_term_loan_share_less_than_24,
        min(case when loans.loan_status = 'approved' then approval_rejection_date end) as earliest_approval_date,
        max(case when loans.loan_status = 'approved' then approval_rejection_date end) as latest_approval_date

    from loans
    group by branch_id,branch_name
)

select *
from aggregated
  );

[0m12:21:44.892802 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m12:21:44.901096 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.reporting__high_lvl_branch_loan_kpis"
[0m12:21:44.901599 [debug] [Thread-1 (]: On model.vg_casestudy.reporting__high_lvl_branch_loan_kpis: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.reporting__high_lvl_branch_loan_kpis"} */
alter view "casestudy"."reporting"."reporting__high_lvl_branch_loan_kpis" rename to "reporting__high_lvl_branch_loan_kpis__dbt_backup"
[0m12:21:44.902534 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m12:21:44.905555 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.reporting__high_lvl_branch_loan_kpis"
[0m12:21:44.905916 [debug] [Thread-1 (]: On model.vg_casestudy.reporting__high_lvl_branch_loan_kpis: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.reporting__high_lvl_branch_loan_kpis"} */
alter view "casestudy"."reporting"."reporting__high_lvl_branch_loan_kpis__dbt_tmp" rename to "reporting__high_lvl_branch_loan_kpis"
[0m12:21:44.906688 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m12:21:44.923273 [debug] [Thread-1 (]: On model.vg_casestudy.reporting__high_lvl_branch_loan_kpis: COMMIT
[0m12:21:44.923781 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.reporting__high_lvl_branch_loan_kpis"
[0m12:21:44.924126 [debug] [Thread-1 (]: On model.vg_casestudy.reporting__high_lvl_branch_loan_kpis: COMMIT
[0m12:21:44.930106 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m12:21:44.935167 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.reporting__high_lvl_branch_loan_kpis"
[0m12:21:44.935548 [debug] [Thread-1 (]: On model.vg_casestudy.reporting__high_lvl_branch_loan_kpis: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.reporting__high_lvl_branch_loan_kpis"} */
drop view if exists "casestudy"."reporting"."reporting__high_lvl_branch_loan_kpis__dbt_backup" cascade
[0m12:21:44.940561 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m12:21:44.941921 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.reporting__high_lvl_branch_loan_kpis (execute): 12:21:44.837972 => 12:21:44.941774
[0m12:21:44.942292 [debug] [Thread-1 (]: On model.vg_casestudy.reporting__high_lvl_branch_loan_kpis: Close
[0m12:21:44.972968 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e6ab486d-b3f5-4faa-b457-d8339ff8bf8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f194a5073d0>]}
[0m12:21:44.973693 [info ] [Thread-1 (]: 1 of 1 OK created sql view model reporting.reporting__high_lvl_branch_loan_kpis  [[32mOK[0m in 0.15s]
[0m12:21:44.974286 [debug] [Thread-1 (]: Finished running node model.vg_casestudy.reporting__high_lvl_branch_loan_kpis
[0m12:21:44.976475 [debug] [MainThread]: Using duckdb connection "master"
[0m12:21:44.976816 [debug] [MainThread]: On master: BEGIN
[0m12:21:44.977100 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:21:44.991058 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m12:21:44.991520 [debug] [MainThread]: On master: COMMIT
[0m12:21:44.991848 [debug] [MainThread]: Using duckdb connection "master"
[0m12:21:44.992123 [debug] [MainThread]: On master: COMMIT
[0m12:21:44.992797 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m12:21:44.993143 [debug] [MainThread]: On master: Close
[0m12:21:44.995624 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:21:44.995998 [debug] [MainThread]: Connection 'list_casestudy_marts' was properly closed.
[0m12:21:44.996302 [debug] [MainThread]: Connection 'model.vg_casestudy.reporting__high_lvl_branch_loan_kpis' was properly closed.
[0m12:21:44.996716 [info ] [MainThread]: 
[0m12:21:44.997126 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.56 seconds (0.56s).
[0m12:21:44.997883 [debug] [MainThread]: Command end result
[0m12:21:45.019819 [info ] [MainThread]: 
[0m12:21:45.020297 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:21:45.020618 [info ] [MainThread]: 
[0m12:21:45.020939 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:21:45.021401 [debug] [MainThread]: Command `dbt run` succeeded at 12:21:45.021309 after 1.14 seconds
[0m12:21:45.021760 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1950553e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f19546724d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1954673690>]}
[0m12:21:45.022088 [debug] [MainThread]: Flushing usage events
[0m12:21:53.653188 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f30ccae0310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f30ccab7b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f30cc952c50>]}


============================== 12:21:53.656259 | cdf6ecfc-6c3a-4152-a977-383d9d54646f ==============================
[0m12:21:53.656259 [info ] [MainThread]: Running with dbt=1.6.18
[0m12:21:53.656893 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/workspaces/vg_case_study_tim/transformation', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/workspaces/vg_case_study_tim/transformation/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt test --select reporting__high_lvl_branch_loan_kpis', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:21:53.765935 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cdf6ecfc-6c3a-4152-a977-383d9d54646f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f30cc652c10>]}
[0m12:21:53.780884 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cdf6ecfc-6c3a-4152-a977-383d9d54646f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f30cc633c50>]}
[0m12:21:53.781642 [info ] [MainThread]: Registered adapter: duckdb=1.6.2
[0m12:21:53.806705 [debug] [MainThread]: checksum: 7b9fab86a08e9e96a48a825af743c566d95b877e068b8c6d0dbafbf714447189, vars: {}, profile: , target: , version: 1.6.18
[0m12:21:53.852204 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:21:53.852650 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:21:53.854280 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.vg_casestudy.main
[0m12:21:53.862905 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cdf6ecfc-6c3a-4152-a977-383d9d54646f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f30c865f850>]}
[0m12:21:53.939032 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cdf6ecfc-6c3a-4152-a977-383d9d54646f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f30cc63da50>]}
[0m12:21:53.939621 [info ] [MainThread]: Found 17 models, 1 analysis, 4 seeds, 113 tests, 5 sources, 0 exposures, 0 metrics, 632 macros, 0 groups, 0 semantic models
[0m12:21:53.940048 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cdf6ecfc-6c3a-4152-a977-383d9d54646f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f30cce13210>]}
[0m12:21:53.942603 [info ] [MainThread]: 
[0m12:21:53.943459 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m12:21:53.945897 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_casestudy_raw'
[0m12:21:53.957785 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_raw"
[0m12:21:53.958423 [debug] [ThreadPool]: On list_casestudy_raw: BEGIN
[0m12:21:53.958774 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:21:53.973787 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:21:53.974227 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_raw"
[0m12:21:53.974542 [debug] [ThreadPool]: On list_casestudy_raw: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_raw"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'raw'
    and table_catalog = 'casestudy'
  
[0m12:21:53.985676 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:21:53.987248 [debug] [ThreadPool]: On list_casestudy_raw: ROLLBACK
[0m12:21:53.987978 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_raw'
[0m12:21:53.988262 [debug] [ThreadPool]: On list_casestudy_raw: Close
[0m12:21:53.993322 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy_raw, now list_casestudy_staging)
[0m12:21:53.998194 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_staging"
[0m12:21:53.998917 [debug] [ThreadPool]: On list_casestudy_staging: BEGIN
[0m12:21:53.999224 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:21:54.011166 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:21:54.011597 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_staging"
[0m12:21:54.011932 [debug] [ThreadPool]: On list_casestudy_staging: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_staging"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'staging'
    and table_catalog = 'casestudy'
  
[0m12:21:54.022794 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:21:54.024304 [debug] [ThreadPool]: On list_casestudy_staging: ROLLBACK
[0m12:21:54.024824 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_staging'
[0m12:21:54.025112 [debug] [ThreadPool]: On list_casestudy_staging: Close
[0m12:21:54.028822 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy_staging, now list_casestudy_reporting)
[0m12:21:54.032743 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_reporting"
[0m12:21:54.033308 [debug] [ThreadPool]: On list_casestudy_reporting: BEGIN
[0m12:21:54.033621 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:21:54.044415 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:21:54.044811 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_reporting"
[0m12:21:54.045096 [debug] [ThreadPool]: On list_casestudy_reporting: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_reporting"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'reporting'
    and table_catalog = 'casestudy'
  
[0m12:21:54.054214 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:21:54.055530 [debug] [ThreadPool]: On list_casestudy_reporting: ROLLBACK
[0m12:21:54.056023 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_reporting'
[0m12:21:54.056285 [debug] [ThreadPool]: On list_casestudy_reporting: Close
[0m12:21:54.060060 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy_reporting, now list_casestudy_marts)
[0m12:21:54.062352 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_marts"
[0m12:21:54.062693 [debug] [ThreadPool]: On list_casestudy_marts: BEGIN
[0m12:21:54.063023 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:21:54.074814 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:21:54.075214 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_marts"
[0m12:21:54.075514 [debug] [ThreadPool]: On list_casestudy_marts: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_marts"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'marts'
    and table_catalog = 'casestudy'
  
[0m12:21:54.084130 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:21:54.085484 [debug] [ThreadPool]: On list_casestudy_marts: ROLLBACK
[0m12:21:54.086005 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_marts'
[0m12:21:54.086301 [debug] [ThreadPool]: On list_casestudy_marts: Close
[0m12:21:54.089609 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy_marts, now list_casestudy_intermediate)
[0m12:21:54.092697 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_intermediate"
[0m12:21:54.093066 [debug] [ThreadPool]: On list_casestudy_intermediate: BEGIN
[0m12:21:54.093401 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:21:54.105573 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:21:54.106031 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_intermediate"
[0m12:21:54.106335 [debug] [ThreadPool]: On list_casestudy_intermediate: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_intermediate"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'intermediate'
    and table_catalog = 'casestudy'
  
[0m12:21:54.114755 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:21:54.116139 [debug] [ThreadPool]: On list_casestudy_intermediate: ROLLBACK
[0m12:21:54.116654 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_intermediate'
[0m12:21:54.116935 [debug] [ThreadPool]: On list_casestudy_intermediate: Close
[0m12:21:54.120963 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cdf6ecfc-6c3a-4152-a977-383d9d54646f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f30ccae0ad0>]}
[0m12:21:54.121460 [debug] [MainThread]: Using duckdb connection "master"
[0m12:21:54.121740 [debug] [MainThread]: On master: BEGIN
[0m12:21:54.122009 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:21:54.134622 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m12:21:54.135046 [debug] [MainThread]: On master: COMMIT
[0m12:21:54.135341 [debug] [MainThread]: Using duckdb connection "master"
[0m12:21:54.135606 [debug] [MainThread]: On master: COMMIT
[0m12:21:54.136179 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m12:21:54.136581 [debug] [MainThread]: On master: Close
[0m12:21:54.138992 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:21:54.139410 [info ] [MainThread]: 
[0m12:21:54.141991 [debug] [Thread-1 (]: Began running node test.vg_casestudy.not_null_reporting__high_lvl_branch_loan_kpis_branch_id.1ad6d682e7
[0m12:21:54.142359 [info ] [Thread-1 (]: 1 of 1 START test not_null_reporting__high_lvl_branch_loan_kpis_branch_id ...... [RUN]
[0m12:21:54.143130 [debug] [Thread-1 (]: Acquiring new duckdb connection 'test.vg_casestudy.not_null_reporting__high_lvl_branch_loan_kpis_branch_id.1ad6d682e7'
[0m12:21:54.143430 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.not_null_reporting__high_lvl_branch_loan_kpis_branch_id.1ad6d682e7
[0m12:21:54.160952 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.not_null_reporting__high_lvl_branch_loan_kpis_branch_id.1ad6d682e7"
[0m12:21:54.161734 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_reporting__high_lvl_branch_loan_kpis_branch_id.1ad6d682e7 (compile): 12:21:54.143673 => 12:21:54.161473
[0m12:21:54.162129 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.not_null_reporting__high_lvl_branch_loan_kpis_branch_id.1ad6d682e7
[0m12:21:54.175050 [debug] [Thread-1 (]: Writing runtime sql for node "test.vg_casestudy.not_null_reporting__high_lvl_branch_loan_kpis_branch_id.1ad6d682e7"
[0m12:21:54.175697 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.not_null_reporting__high_lvl_branch_loan_kpis_branch_id.1ad6d682e7"
[0m12:21:54.176134 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_reporting__high_lvl_branch_loan_kpis_branch_id.1ad6d682e7: BEGIN
[0m12:21:54.176486 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:21:54.190892 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m12:21:54.191329 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.not_null_reporting__high_lvl_branch_loan_kpis_branch_id.1ad6d682e7"
[0m12:21:54.191666 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_reporting__high_lvl_branch_loan_kpis_branch_id.1ad6d682e7: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "test.vg_casestudy.not_null_reporting__high_lvl_branch_loan_kpis_branch_id.1ad6d682e7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select branch_id
from "casestudy"."reporting"."reporting__high_lvl_branch_loan_kpis"
where branch_id is null



      
    ) dbt_internal_test
[0m12:21:54.211397 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m12:21:54.215148 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_reporting__high_lvl_branch_loan_kpis_branch_id.1ad6d682e7 (execute): 12:21:54.162366 => 12:21:54.214804
[0m12:21:54.215656 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_reporting__high_lvl_branch_loan_kpis_branch_id.1ad6d682e7: ROLLBACK
[0m12:21:54.216285 [debug] [Thread-1 (]: Failed to rollback 'test.vg_casestudy.not_null_reporting__high_lvl_branch_loan_kpis_branch_id.1ad6d682e7'
[0m12:21:54.216811 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_reporting__high_lvl_branch_loan_kpis_branch_id.1ad6d682e7: Close
[0m12:21:54.219737 [info ] [Thread-1 (]: 1 of 1 PASS not_null_reporting__high_lvl_branch_loan_kpis_branch_id ............ [[32mPASS[0m in 0.08s]
[0m12:21:54.220372 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.not_null_reporting__high_lvl_branch_loan_kpis_branch_id.1ad6d682e7
[0m12:21:54.222040 [debug] [MainThread]: Using duckdb connection "master"
[0m12:21:54.222379 [debug] [MainThread]: On master: BEGIN
[0m12:21:54.222653 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:21:54.236828 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m12:21:54.237550 [debug] [MainThread]: On master: COMMIT
[0m12:21:54.237875 [debug] [MainThread]: Using duckdb connection "master"
[0m12:21:54.238224 [debug] [MainThread]: On master: COMMIT
[0m12:21:54.238900 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m12:21:54.239296 [debug] [MainThread]: On master: Close
[0m12:21:54.242043 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:21:54.242437 [debug] [MainThread]: Connection 'list_casestudy_intermediate' was properly closed.
[0m12:21:54.242707 [debug] [MainThread]: Connection 'test.vg_casestudy.not_null_reporting__high_lvl_branch_loan_kpis_branch_id.1ad6d682e7' was properly closed.
[0m12:21:54.243080 [info ] [MainThread]: 
[0m12:21:54.243506 [info ] [MainThread]: Finished running 1 test in 0 hours 0 minutes and 0.30 seconds (0.30s).
[0m12:21:54.244102 [debug] [MainThread]: Command end result
[0m12:21:54.267323 [info ] [MainThread]: 
[0m12:21:54.267820 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:21:54.268178 [info ] [MainThread]: 
[0m12:21:54.268497 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:21:54.268965 [debug] [MainThread]: Command `dbt test` succeeded at 12:21:54.268869 after 0.62 seconds
[0m12:21:54.269339 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f30d14734d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f30d1472290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f30c844a710>]}
[0m12:21:54.269734 [debug] [MainThread]: Flushing usage events
[0m12:43:24.157090 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcbecb1f3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcbecb1c1d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcbee2e8c90>]}


============================== 12:43:24.162043 | 2a865db2-e02d-473f-99b5-57ec14fcfc19 ==============================
[0m12:43:24.162043 [info ] [MainThread]: Running with dbt=1.6.18
[0m12:43:24.162600 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/workspaces/vg_case_study_tim/transformation/logs', 'fail_fast': 'False', 'profiles_dir': '/workspaces/vg_case_study_tim/transformation', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run --select reporting__high_lvl_branch_loan_kpis --full-refresh', 'send_anonymous_usage_stats': 'True'}
[0m12:43:24.372025 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2a865db2-e02d-473f-99b5-57ec14fcfc19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcbecb1e750>]}
[0m12:43:24.389445 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2a865db2-e02d-473f-99b5-57ec14fcfc19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcbecab3c50>]}
[0m12:43:24.391028 [info ] [MainThread]: Registered adapter: duckdb=1.6.2
[0m12:43:24.426266 [debug] [MainThread]: checksum: 7b9fab86a08e9e96a48a825af743c566d95b877e068b8c6d0dbafbf714447189, vars: {}, profile: , target: , version: 1.6.18
[0m12:43:24.534681 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 1 files changed.
[0m12:43:24.535529 [debug] [MainThread]: Partial parsing: added file: vg_casestudy://models/reporting/reporting__branch_loan_type_kpis.yml
[0m12:43:24.535939 [debug] [MainThread]: Partial parsing: added file: vg_casestudy://models/reporting/reporting__branch_loan_type_kpis.sql
[0m12:43:24.536336 [debug] [MainThread]: Partial parsing: updated file: vg_casestudy://models/reporting/reporting__high_lvl_branch_loan_kpis.sql
[0m12:43:24.680986 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.vg_casestudy.main
[0m12:43:24.688292 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2a865db2-e02d-473f-99b5-57ec14fcfc19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcbec362710>]}
[0m12:43:24.725015 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2a865db2-e02d-473f-99b5-57ec14fcfc19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcbec3fcc50>]}
[0m12:43:24.725569 [info ] [MainThread]: Found 18 models, 1 analysis, 4 seeds, 113 tests, 5 sources, 0 exposures, 0 metrics, 632 macros, 0 groups, 0 semantic models
[0m12:43:24.725967 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2a865db2-e02d-473f-99b5-57ec14fcfc19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcbe8232990>]}
[0m12:43:24.728517 [info ] [MainThread]: 
[0m12:43:24.729289 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m12:43:24.730511 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_casestudy'
[0m12:43:24.744065 [debug] [ThreadPool]: Using duckdb connection "list_casestudy"
[0m12:43:24.744534 [debug] [ThreadPool]: On list_casestudy: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"casestudy"'
    
  
  
[0m12:43:24.744867 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:43:24.878252 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:43:24.879891 [debug] [ThreadPool]: On list_casestudy: Close
[0m12:43:24.885895 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy, now create_casestudy_reporting)
[0m12:43:24.886723 [debug] [ThreadPool]: Creating schema "database: "casestudy"
schema: "reporting"
"
[0m12:43:24.891341 [debug] [ThreadPool]: Using duckdb connection "create_casestudy_reporting"
[0m12:43:24.891776 [debug] [ThreadPool]: On create_casestudy_reporting: BEGIN
[0m12:43:24.892135 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:43:24.904574 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:43:24.904985 [debug] [ThreadPool]: Using duckdb connection "create_casestudy_reporting"
[0m12:43:24.905306 [debug] [ThreadPool]: On create_casestudy_reporting: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "create_casestudy_reporting"} */
create schema if not exists "casestudy"."reporting"
[0m12:43:24.905901 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:43:24.906752 [debug] [ThreadPool]: On create_casestudy_reporting: COMMIT
[0m12:43:24.907066 [debug] [ThreadPool]: Using duckdb connection "create_casestudy_reporting"
[0m12:43:24.907394 [debug] [ThreadPool]: On create_casestudy_reporting: COMMIT
[0m12:43:24.907905 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:43:24.908177 [debug] [ThreadPool]: On create_casestudy_reporting: Close
[0m12:43:24.912577 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_casestudy_reporting, now list_casestudy_marts)
[0m12:43:24.917820 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_marts"
[0m12:43:24.918197 [debug] [ThreadPool]: On list_casestudy_marts: BEGIN
[0m12:43:24.918481 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:43:24.929816 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:43:24.930290 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_marts"
[0m12:43:24.930587 [debug] [ThreadPool]: On list_casestudy_marts: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_marts"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'marts'
    and table_catalog = 'casestudy'
  
[0m12:43:24.944715 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:43:24.946332 [debug] [ThreadPool]: On list_casestudy_marts: ROLLBACK
[0m12:43:24.947809 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_marts'
[0m12:43:24.948139 [debug] [ThreadPool]: On list_casestudy_marts: Close
[0m12:43:24.952961 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy_marts, now list_casestudy_staging)
[0m12:43:24.955074 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_staging"
[0m12:43:24.955418 [debug] [ThreadPool]: On list_casestudy_staging: BEGIN
[0m12:43:24.955742 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:43:24.966718 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:43:24.967111 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_staging"
[0m12:43:24.967491 [debug] [ThreadPool]: On list_casestudy_staging: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_staging"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'staging'
    and table_catalog = 'casestudy'
  
[0m12:43:24.975562 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:43:24.976845 [debug] [ThreadPool]: On list_casestudy_staging: ROLLBACK
[0m12:43:24.977324 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_staging'
[0m12:43:24.977708 [debug] [ThreadPool]: On list_casestudy_staging: Close
[0m12:43:24.980875 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy_staging, now list_casestudy_intermediate)
[0m12:43:24.983322 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_intermediate"
[0m12:43:24.984716 [debug] [ThreadPool]: On list_casestudy_intermediate: BEGIN
[0m12:43:24.985179 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:43:24.996598 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:43:24.996995 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_intermediate"
[0m12:43:24.997355 [debug] [ThreadPool]: On list_casestudy_intermediate: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_intermediate"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'intermediate'
    and table_catalog = 'casestudy'
  
[0m12:43:25.005468 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:43:25.006717 [debug] [ThreadPool]: On list_casestudy_intermediate: ROLLBACK
[0m12:43:25.007180 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_intermediate'
[0m12:43:25.007468 [debug] [ThreadPool]: On list_casestudy_intermediate: Close
[0m12:43:25.010343 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy_intermediate, now list_casestudy_reporting)
[0m12:43:25.013542 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_reporting"
[0m12:43:25.013836 [debug] [ThreadPool]: On list_casestudy_reporting: BEGIN
[0m12:43:25.014110 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:43:25.024845 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:43:25.025207 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_reporting"
[0m12:43:25.025500 [debug] [ThreadPool]: On list_casestudy_reporting: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_reporting"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'reporting'
    and table_catalog = 'casestudy'
  
[0m12:43:25.034153 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:43:25.035529 [debug] [ThreadPool]: On list_casestudy_reporting: ROLLBACK
[0m12:43:25.035990 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_reporting'
[0m12:43:25.036262 [debug] [ThreadPool]: On list_casestudy_reporting: Close
[0m12:43:25.039219 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy_reporting, now list_casestudy_raw)
[0m12:43:25.041301 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_raw"
[0m12:43:25.042130 [debug] [ThreadPool]: On list_casestudy_raw: BEGIN
[0m12:43:25.042577 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:43:25.053531 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:43:25.053930 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_raw"
[0m12:43:25.054268 [debug] [ThreadPool]: On list_casestudy_raw: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_raw"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'raw'
    and table_catalog = 'casestudy'
  
[0m12:43:25.062886 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:43:25.064267 [debug] [ThreadPool]: On list_casestudy_raw: ROLLBACK
[0m12:43:25.064724 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_raw'
[0m12:43:25.064997 [debug] [ThreadPool]: On list_casestudy_raw: Close
[0m12:43:25.069078 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2a865db2-e02d-473f-99b5-57ec14fcfc19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcbecab3e90>]}
[0m12:43:25.069550 [debug] [MainThread]: Using duckdb connection "master"
[0m12:43:25.069837 [debug] [MainThread]: On master: BEGIN
[0m12:43:25.070208 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:43:25.083934 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m12:43:25.084361 [debug] [MainThread]: On master: COMMIT
[0m12:43:25.084658 [debug] [MainThread]: Using duckdb connection "master"
[0m12:43:25.084937 [debug] [MainThread]: On master: COMMIT
[0m12:43:25.085421 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m12:43:25.085697 [debug] [MainThread]: On master: Close
[0m12:43:25.088473 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:43:25.088967 [info ] [MainThread]: 
[0m12:43:25.095018 [debug] [Thread-1 (]: Began running node model.vg_casestudy.reporting__high_lvl_branch_loan_kpis
[0m12:43:25.095640 [info ] [Thread-1 (]: 1 of 1 START sql view model reporting.reporting__high_lvl_branch_loan_kpis ..... [RUN]
[0m12:43:25.096639 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.vg_casestudy.reporting__high_lvl_branch_loan_kpis'
[0m12:43:25.097064 [debug] [Thread-1 (]: Began compiling node model.vg_casestudy.reporting__high_lvl_branch_loan_kpis
[0m12:43:25.107368 [debug] [Thread-1 (]: Writing injected SQL for node "model.vg_casestudy.reporting__high_lvl_branch_loan_kpis"
[0m12:43:25.109158 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.reporting__high_lvl_branch_loan_kpis (compile): 12:43:25.097374 => 12:43:25.108778
[0m12:43:25.109602 [debug] [Thread-1 (]: Began executing node model.vg_casestudy.reporting__high_lvl_branch_loan_kpis
[0m12:43:25.142304 [debug] [Thread-1 (]: Writing runtime sql for node "model.vg_casestudy.reporting__high_lvl_branch_loan_kpis"
[0m12:43:25.143223 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.reporting__high_lvl_branch_loan_kpis"
[0m12:43:25.143624 [debug] [Thread-1 (]: On model.vg_casestudy.reporting__high_lvl_branch_loan_kpis: BEGIN
[0m12:43:25.143971 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:43:25.158654 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m12:43:25.159160 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.reporting__high_lvl_branch_loan_kpis"
[0m12:43:25.159632 [debug] [Thread-1 (]: On model.vg_casestudy.reporting__high_lvl_branch_loan_kpis: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.reporting__high_lvl_branch_loan_kpis"} */

  
  create view "casestudy"."reporting"."reporting__high_lvl_branch_loan_kpis__dbt_tmp" as (
    with loans as (
    select *
    from "casestudy"."marts"."marts__loans_enriched"
),

aggregated as (
    select 
        branch_id,
        branch_name,

        -- loan count by status
        count(loan_id) as count_of_loans,
        count(case when loan_status = 'approved' then loan_id end) as loans_approved,
        count(case when loan_status = 'rejected' then loan_id end) as loans_rejected,
        count(case when loan_status = 'closed' then loan_id end) as loans_closed,

        -- loan count by type
        count(case when loan_type = 'personal' then loan_id end) as loans_personal,
        count(case when loan_type = 'mortgage' then loan_id end) as loans_mortgage,
        count(case when loan_type = 'auto' then loan_id end) as loans_auto,

        --customer segmentation
        count(distinct customer_id) as unique_customers,
        count(case when age < 30 then loan_id end) as loans_under_30,
        count(case when age between 30 and 50 then loan_id end) as loans_30_to_50,
        count(case when age > 50 then loan_id end) as loans_over_50,

        -- approval rate
        count(case when loan_status = 'approved' then loan_id end)::float
            / nullif(count(loan_id), 0) as approval_rate,
        count(case when loan_status = 'rejected' then loan_id end)::float
            / nullif(count(loan_id), 0) as rejection_rate,
        count(case when loan_status = 'closed' then loan_id end)::float
            / nullif(count(loan_id), 0) as closed_rate,

        -- loan kpis
        sum(loan_amount) as total_loan_amount,
        sum(loan_amount)::float / nullif(count(loan_id), 0) as avg_loan_amount,
        avg(interest_rate) as avg_interest_rate,
        avg(loan_term)  as avg_loan_term_months,
        count(case when loan_term > 36 then loan_id end)::float / count(loan_id) as long_term_loan_share_more_than_36,
        count(case when loan_term < 24 then loan_id end)::float / count(loan_id) as short_term_loan_share_less_than_24,
        min(case when loans.loan_status = 'approved' then approval_rejection_date end) as earliest_approval_date,
        max(case when loans.loan_status = 'approved' then approval_rejection_date end) as latest_approval_date

    from loans
    group by branch_id,branch_name
)

select *
from aggregated
  );

[0m12:43:25.164698 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m12:43:25.171505 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.reporting__high_lvl_branch_loan_kpis"
[0m12:43:25.171980 [debug] [Thread-1 (]: On model.vg_casestudy.reporting__high_lvl_branch_loan_kpis: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.reporting__high_lvl_branch_loan_kpis"} */
alter view "casestudy"."reporting"."reporting__high_lvl_branch_loan_kpis" rename to "reporting__high_lvl_branch_loan_kpis__dbt_backup"
[0m12:43:25.174025 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m12:43:25.177041 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.reporting__high_lvl_branch_loan_kpis"
[0m12:43:25.177459 [debug] [Thread-1 (]: On model.vg_casestudy.reporting__high_lvl_branch_loan_kpis: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.reporting__high_lvl_branch_loan_kpis"} */
alter view "casestudy"."reporting"."reporting__high_lvl_branch_loan_kpis__dbt_tmp" rename to "reporting__high_lvl_branch_loan_kpis"
[0m12:43:25.178239 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m12:43:25.192966 [debug] [Thread-1 (]: On model.vg_casestudy.reporting__high_lvl_branch_loan_kpis: COMMIT
[0m12:43:25.193396 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.reporting__high_lvl_branch_loan_kpis"
[0m12:43:25.193732 [debug] [Thread-1 (]: On model.vg_casestudy.reporting__high_lvl_branch_loan_kpis: COMMIT
[0m12:43:25.213694 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m12:43:25.218641 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.reporting__high_lvl_branch_loan_kpis"
[0m12:43:25.218989 [debug] [Thread-1 (]: On model.vg_casestudy.reporting__high_lvl_branch_loan_kpis: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.reporting__high_lvl_branch_loan_kpis"} */
drop view if exists "casestudy"."reporting"."reporting__high_lvl_branch_loan_kpis__dbt_backup" cascade
[0m12:43:25.225245 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m12:43:25.226711 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.reporting__high_lvl_branch_loan_kpis (execute): 12:43:25.109865 => 12:43:25.226538
[0m12:43:25.227034 [debug] [Thread-1 (]: On model.vg_casestudy.reporting__high_lvl_branch_loan_kpis: Close
[0m12:43:25.258427 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2a865db2-e02d-473f-99b5-57ec14fcfc19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcbe8cf3c90>]}
[0m12:43:25.259242 [info ] [Thread-1 (]: 1 of 1 OK created sql view model reporting.reporting__high_lvl_branch_loan_kpis  [[32mOK[0m in 0.16s]
[0m12:43:25.259849 [debug] [Thread-1 (]: Finished running node model.vg_casestudy.reporting__high_lvl_branch_loan_kpis
[0m12:43:25.261669 [debug] [MainThread]: Using duckdb connection "master"
[0m12:43:25.262004 [debug] [MainThread]: On master: BEGIN
[0m12:43:25.262274 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:43:25.276966 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m12:43:25.277494 [debug] [MainThread]: On master: COMMIT
[0m12:43:25.277849 [debug] [MainThread]: Using duckdb connection "master"
[0m12:43:25.278199 [debug] [MainThread]: On master: COMMIT
[0m12:43:25.278889 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m12:43:25.279222 [debug] [MainThread]: On master: Close
[0m12:43:25.281757 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:43:25.282123 [debug] [MainThread]: Connection 'list_casestudy_raw' was properly closed.
[0m12:43:25.282407 [debug] [MainThread]: Connection 'model.vg_casestudy.reporting__high_lvl_branch_loan_kpis' was properly closed.
[0m12:43:25.282712 [info ] [MainThread]: 
[0m12:43:25.283050 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.55 seconds (0.55s).
[0m12:43:25.283652 [debug] [MainThread]: Command end result
[0m12:43:25.304635 [info ] [MainThread]: 
[0m12:43:25.305586 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:43:25.306089 [info ] [MainThread]: 
[0m12:43:25.306495 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:43:25.307105 [debug] [MainThread]: Command `dbt run` succeeded at 12:43:25.306973 after 1.16 seconds
[0m12:43:25.307570 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcbecae8050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcbf11764d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcbec69e2d0>]}
[0m12:43:25.307932 [debug] [MainThread]: Flushing usage events
[0m12:43:33.120599 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f92058095d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9206636450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9206635b90>]}


============================== 12:43:33.123898 | 0721e637-7e96-4d9f-bb8a-2de0a045a2c8 ==============================
[0m12:43:33.123898 [info ] [MainThread]: Running with dbt=1.6.18
[0m12:43:33.124451 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/workspaces/vg_case_study_tim/transformation', 'version_check': 'True', 'debug': 'False', 'log_path': '/workspaces/vg_case_study_tim/transformation/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt test --select reporting__high_lvl_branch_loan_kpis', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:43:33.224871 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0721e637-7e96-4d9f-bb8a-2de0a045a2c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f92054e9690>]}
[0m12:43:33.240070 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0721e637-7e96-4d9f-bb8a-2de0a045a2c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f92050ac290>]}
[0m12:43:33.241011 [info ] [MainThread]: Registered adapter: duckdb=1.6.2
[0m12:43:33.266375 [debug] [MainThread]: checksum: 7b9fab86a08e9e96a48a825af743c566d95b877e068b8c6d0dbafbf714447189, vars: {}, profile: , target: , version: 1.6.18
[0m12:43:33.314640 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:43:33.315081 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:43:33.316858 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.vg_casestudy.main
[0m12:43:33.326366 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0721e637-7e96-4d9f-bb8a-2de0a045a2c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f92057e8e10>]}
[0m12:43:33.404459 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0721e637-7e96-4d9f-bb8a-2de0a045a2c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9201138450>]}
[0m12:43:33.405063 [info ] [MainThread]: Found 18 models, 1 analysis, 4 seeds, 113 tests, 5 sources, 0 exposures, 0 metrics, 632 macros, 0 groups, 0 semantic models
[0m12:43:33.405501 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0721e637-7e96-4d9f-bb8a-2de0a045a2c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9200ea6a50>]}
[0m12:43:33.408701 [info ] [MainThread]: 
[0m12:43:33.409606 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m12:43:33.411762 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_casestudy_marts'
[0m12:43:33.423772 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_marts"
[0m12:43:33.424380 [debug] [ThreadPool]: On list_casestudy_marts: BEGIN
[0m12:43:33.424693 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:43:33.442715 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:43:33.443172 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_marts"
[0m12:43:33.443502 [debug] [ThreadPool]: On list_casestudy_marts: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_marts"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'marts'
    and table_catalog = 'casestudy'
  
[0m12:43:33.455375 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:43:33.457741 [debug] [ThreadPool]: On list_casestudy_marts: ROLLBACK
[0m12:43:33.458609 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_marts'
[0m12:43:33.458999 [debug] [ThreadPool]: On list_casestudy_marts: Close
[0m12:43:33.463626 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy_marts, now list_casestudy_staging)
[0m12:43:33.466678 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_staging"
[0m12:43:33.467027 [debug] [ThreadPool]: On list_casestudy_staging: BEGIN
[0m12:43:33.467346 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:43:33.480059 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:43:33.480499 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_staging"
[0m12:43:33.480802 [debug] [ThreadPool]: On list_casestudy_staging: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_staging"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'staging'
    and table_catalog = 'casestudy'
  
[0m12:43:33.490614 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:43:33.492167 [debug] [ThreadPool]: On list_casestudy_staging: ROLLBACK
[0m12:43:33.492661 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_staging'
[0m12:43:33.492957 [debug] [ThreadPool]: On list_casestudy_staging: Close
[0m12:43:33.497269 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy_staging, now list_casestudy_reporting)
[0m12:43:33.500845 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_reporting"
[0m12:43:33.501254 [debug] [ThreadPool]: On list_casestudy_reporting: BEGIN
[0m12:43:33.501546 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:43:33.513790 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:43:33.514213 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_reporting"
[0m12:43:33.514507 [debug] [ThreadPool]: On list_casestudy_reporting: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_reporting"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'reporting'
    and table_catalog = 'casestudy'
  
[0m12:43:33.523613 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:43:33.525094 [debug] [ThreadPool]: On list_casestudy_reporting: ROLLBACK
[0m12:43:33.525842 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_reporting'
[0m12:43:33.526139 [debug] [ThreadPool]: On list_casestudy_reporting: Close
[0m12:43:33.529232 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy_reporting, now list_casestudy_raw)
[0m12:43:33.531519 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_raw"
[0m12:43:33.531859 [debug] [ThreadPool]: On list_casestudy_raw: BEGIN
[0m12:43:33.532181 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:43:33.544159 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:43:33.544569 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_raw"
[0m12:43:33.544887 [debug] [ThreadPool]: On list_casestudy_raw: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_raw"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'raw'
    and table_catalog = 'casestudy'
  
[0m12:43:33.553162 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:43:33.554628 [debug] [ThreadPool]: On list_casestudy_raw: ROLLBACK
[0m12:43:33.555319 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_raw'
[0m12:43:33.555701 [debug] [ThreadPool]: On list_casestudy_raw: Close
[0m12:43:33.558841 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy_raw, now list_casestudy_intermediate)
[0m12:43:33.561016 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_intermediate"
[0m12:43:33.561356 [debug] [ThreadPool]: On list_casestudy_intermediate: BEGIN
[0m12:43:33.561689 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:43:33.572849 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:43:33.573455 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_intermediate"
[0m12:43:33.573787 [debug] [ThreadPool]: On list_casestudy_intermediate: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_intermediate"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'intermediate'
    and table_catalog = 'casestudy'
  
[0m12:43:33.582195 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:43:33.583513 [debug] [ThreadPool]: On list_casestudy_intermediate: ROLLBACK
[0m12:43:33.583976 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_intermediate'
[0m12:43:33.584241 [debug] [ThreadPool]: On list_casestudy_intermediate: Close
[0m12:43:33.588631 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0721e637-7e96-4d9f-bb8a-2de0a045a2c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f920504dc10>]}
[0m12:43:33.589368 [debug] [MainThread]: Using duckdb connection "master"
[0m12:43:33.589787 [debug] [MainThread]: On master: BEGIN
[0m12:43:33.590060 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:43:33.602947 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m12:43:33.603494 [debug] [MainThread]: On master: COMMIT
[0m12:43:33.603889 [debug] [MainThread]: Using duckdb connection "master"
[0m12:43:33.604230 [debug] [MainThread]: On master: COMMIT
[0m12:43:33.605063 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m12:43:33.605511 [debug] [MainThread]: On master: Close
[0m12:43:33.608529 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:43:33.608960 [info ] [MainThread]: 
[0m12:43:33.611748 [debug] [Thread-1 (]: Began running node test.vg_casestudy.not_null_reporting__high_lvl_branch_loan_kpis_branch_id.1ad6d682e7
[0m12:43:33.612206 [info ] [Thread-1 (]: 1 of 1 START test not_null_reporting__high_lvl_branch_loan_kpis_branch_id ...... [RUN]
[0m12:43:33.612988 [debug] [Thread-1 (]: Acquiring new duckdb connection 'test.vg_casestudy.not_null_reporting__high_lvl_branch_loan_kpis_branch_id.1ad6d682e7'
[0m12:43:33.613306 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.not_null_reporting__high_lvl_branch_loan_kpis_branch_id.1ad6d682e7
[0m12:43:33.631056 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.not_null_reporting__high_lvl_branch_loan_kpis_branch_id.1ad6d682e7"
[0m12:43:33.631846 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_reporting__high_lvl_branch_loan_kpis_branch_id.1ad6d682e7 (compile): 12:43:33.613528 => 12:43:33.631601
[0m12:43:33.632226 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.not_null_reporting__high_lvl_branch_loan_kpis_branch_id.1ad6d682e7
[0m12:43:33.645194 [debug] [Thread-1 (]: Writing runtime sql for node "test.vg_casestudy.not_null_reporting__high_lvl_branch_loan_kpis_branch_id.1ad6d682e7"
[0m12:43:33.645881 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.not_null_reporting__high_lvl_branch_loan_kpis_branch_id.1ad6d682e7"
[0m12:43:33.646260 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_reporting__high_lvl_branch_loan_kpis_branch_id.1ad6d682e7: BEGIN
[0m12:43:33.646564 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:43:33.660043 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m12:43:33.660606 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.not_null_reporting__high_lvl_branch_loan_kpis_branch_id.1ad6d682e7"
[0m12:43:33.660997 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_reporting__high_lvl_branch_loan_kpis_branch_id.1ad6d682e7: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "test.vg_casestudy.not_null_reporting__high_lvl_branch_loan_kpis_branch_id.1ad6d682e7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select branch_id
from "casestudy"."reporting"."reporting__high_lvl_branch_loan_kpis"
where branch_id is null



      
    ) dbt_internal_test
[0m12:43:33.678110 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m12:43:33.681347 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_reporting__high_lvl_branch_loan_kpis_branch_id.1ad6d682e7 (execute): 12:43:33.632464 => 12:43:33.681106
[0m12:43:33.681781 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_reporting__high_lvl_branch_loan_kpis_branch_id.1ad6d682e7: ROLLBACK
[0m12:43:33.682302 [debug] [Thread-1 (]: Failed to rollback 'test.vg_casestudy.not_null_reporting__high_lvl_branch_loan_kpis_branch_id.1ad6d682e7'
[0m12:43:33.682638 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_reporting__high_lvl_branch_loan_kpis_branch_id.1ad6d682e7: Close
[0m12:43:33.685526 [info ] [Thread-1 (]: 1 of 1 PASS not_null_reporting__high_lvl_branch_loan_kpis_branch_id ............ [[32mPASS[0m in 0.07s]
[0m12:43:33.686146 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.not_null_reporting__high_lvl_branch_loan_kpis_branch_id.1ad6d682e7
[0m12:43:33.688216 [debug] [MainThread]: Using duckdb connection "master"
[0m12:43:33.688658 [debug] [MainThread]: On master: BEGIN
[0m12:43:33.689018 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:43:33.701949 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m12:43:33.702427 [debug] [MainThread]: On master: COMMIT
[0m12:43:33.702757 [debug] [MainThread]: Using duckdb connection "master"
[0m12:43:33.703246 [debug] [MainThread]: On master: COMMIT
[0m12:43:33.704068 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m12:43:33.704526 [debug] [MainThread]: On master: Close
[0m12:43:33.707256 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:43:33.707693 [debug] [MainThread]: Connection 'list_casestudy_intermediate' was properly closed.
[0m12:43:33.708008 [debug] [MainThread]: Connection 'test.vg_casestudy.not_null_reporting__high_lvl_branch_loan_kpis_branch_id.1ad6d682e7' was properly closed.
[0m12:43:33.708360 [info ] [MainThread]: 
[0m12:43:33.708775 [info ] [MainThread]: Finished running 1 test in 0 hours 0 minutes and 0.30 seconds (0.30s).
[0m12:43:33.709430 [debug] [MainThread]: Command end result
[0m12:43:33.733374 [info ] [MainThread]: 
[0m12:43:33.733870 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:43:33.734272 [info ] [MainThread]: 
[0m12:43:33.734634 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:43:33.735100 [debug] [MainThread]: Command `dbt test` succeeded at 12:43:33.735005 after 0.62 seconds
[0m12:43:33.735438 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9209cdecd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9209cf0e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9209e67550>]}
[0m12:43:33.735786 [debug] [MainThread]: Flushing usage events
[0m12:52:41.174409 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84a68c5890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84a69dfc90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84a68c5950>]}


============================== 12:52:41.179671 | f3539673-6f3a-4e20-a2f7-9b7fc97abb8a ==============================
[0m12:52:41.179671 [info ] [MainThread]: Running with dbt=1.6.18
[0m12:52:41.180236 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/workspaces/vg_case_study_tim/transformation', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/workspaces/vg_case_study_tim/transformation/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --select reporting__branch_loan_type_kpis --full-refresh', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:52:41.374889 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f3539673-6f3a-4e20-a2f7-9b7fc97abb8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84a64ae850>]}
[0m12:52:41.389346 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f3539673-6f3a-4e20-a2f7-9b7fc97abb8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84a679e410>]}
[0m12:52:41.390991 [info ] [MainThread]: Registered adapter: duckdb=1.6.2
[0m12:52:41.418049 [debug] [MainThread]: checksum: 7b9fab86a08e9e96a48a825af743c566d95b877e068b8c6d0dbafbf714447189, vars: {}, profile: , target: , version: 1.6.18
[0m12:52:41.521836 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m12:52:41.522779 [debug] [MainThread]: Partial parsing: updated file: vg_casestudy://models/reporting/reporting__branch_loan_type_kpis.yml
[0m12:52:41.523222 [debug] [MainThread]: Partial parsing: updated file: vg_casestudy://models/reporting/reporting__branch_loan_type_kpis.sql
[0m12:52:41.624889 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found two schema.yml entries for the same resource named reporting__high_lvl_branch_loan_kpis. Resources and their associated columns may only be described a single time. To fix this, remove the resource entry for reporting__high_lvl_branch_loan_kpis in one of these files:
   - models/reporting/reporting__branch_loan_type_kpis.yml
  models/reporting/reporting__high_lvl_branch_loan_kpis.yml
[0m12:52:41.625522 [debug] [MainThread]: Command `dbt run` failed at 12:52:41.625407 after 0.46 seconds
[0m12:52:41.625906 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84a6793e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84a6469150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84a257d450>]}
[0m12:52:41.626300 [debug] [MainThread]: Flushing usage events
[0m12:54:03.286321 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6859b31c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6859e21e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f685c549cd0>]}


============================== 12:54:03.291750 | fb9afdb5-fad2-4cf4-a734-e8d5ad200810 ==============================
[0m12:54:03.291750 [info ] [MainThread]: Running with dbt=1.6.18
[0m12:54:03.292385 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/workspaces/vg_case_study_tim/transformation', 'debug': 'False', 'warn_error': 'None', 'log_path': '/workspaces/vg_case_study_tim/transformation/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select reporting__branch_loan_type_kpis --full-refresh', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:54:03.479230 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fb9afdb5-fad2-4cf4-a734-e8d5ad200810', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6859e22850>]}
[0m12:54:03.494328 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fb9afdb5-fad2-4cf4-a734-e8d5ad200810', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6859e22850>]}
[0m12:54:03.495927 [info ] [MainThread]: Registered adapter: duckdb=1.6.2
[0m12:54:03.523547 [debug] [MainThread]: checksum: 7b9fab86a08e9e96a48a825af743c566d95b877e068b8c6d0dbafbf714447189, vars: {}, profile: , target: , version: 1.6.18
[0m12:54:03.623551 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m12:54:03.624588 [debug] [MainThread]: Partial parsing: updated file: vg_casestudy://models/reporting/reporting__branch_loan_type_kpis.yml
[0m12:54:03.625067 [debug] [MainThread]: Partial parsing: updated file: vg_casestudy://models/reporting/reporting__branch_loan_type_kpis.sql
[0m12:54:03.767483 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.vg_casestudy.main
[0m12:54:03.775218 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fb9afdb5-fad2-4cf4-a734-e8d5ad200810', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6859c1f710>]}
[0m12:54:03.810198 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fb9afdb5-fad2-4cf4-a734-e8d5ad200810', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f685442be10>]}
[0m12:54:03.810796 [info ] [MainThread]: Found 18 models, 1 analysis, 4 seeds, 114 tests, 5 sources, 0 exposures, 0 metrics, 632 macros, 0 groups, 0 semantic models
[0m12:54:03.811176 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fb9afdb5-fad2-4cf4-a734-e8d5ad200810', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f685582b850>]}
[0m12:54:03.813735 [info ] [MainThread]: 
[0m12:54:03.814505 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m12:54:03.816429 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_casestudy'
[0m12:54:03.829964 [debug] [ThreadPool]: Using duckdb connection "list_casestudy"
[0m12:54:03.830506 [debug] [ThreadPool]: On list_casestudy: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"casestudy"'
    
  
  
[0m12:54:03.830924 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:54:03.972546 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:54:03.974007 [debug] [ThreadPool]: On list_casestudy: Close
[0m12:54:03.978300 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy, now create_casestudy_reporting)
[0m12:54:03.979098 [debug] [ThreadPool]: Creating schema "database: "casestudy"
schema: "reporting"
"
[0m12:54:03.983464 [debug] [ThreadPool]: Using duckdb connection "create_casestudy_reporting"
[0m12:54:03.983830 [debug] [ThreadPool]: On create_casestudy_reporting: BEGIN
[0m12:54:03.984124 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:54:03.995962 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:54:03.996347 [debug] [ThreadPool]: Using duckdb connection "create_casestudy_reporting"
[0m12:54:03.996639 [debug] [ThreadPool]: On create_casestudy_reporting: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "create_casestudy_reporting"} */
create schema if not exists "casestudy"."reporting"
[0m12:54:03.997458 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:54:03.998322 [debug] [ThreadPool]: On create_casestudy_reporting: COMMIT
[0m12:54:03.998594 [debug] [ThreadPool]: Using duckdb connection "create_casestudy_reporting"
[0m12:54:03.998851 [debug] [ThreadPool]: On create_casestudy_reporting: COMMIT
[0m12:54:03.999359 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:54:03.999634 [debug] [ThreadPool]: On create_casestudy_reporting: Close
[0m12:54:04.004579 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_casestudy_reporting, now list_casestudy_staging)
[0m12:54:04.009838 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_staging"
[0m12:54:04.010198 [debug] [ThreadPool]: On list_casestudy_staging: BEGIN
[0m12:54:04.010499 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:54:04.024155 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:54:04.024654 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_staging"
[0m12:54:04.025006 [debug] [ThreadPool]: On list_casestudy_staging: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_staging"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'staging'
    and table_catalog = 'casestudy'
  
[0m12:54:04.040584 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:54:04.042171 [debug] [ThreadPool]: On list_casestudy_staging: ROLLBACK
[0m12:54:04.043873 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_staging'
[0m12:54:04.044175 [debug] [ThreadPool]: On list_casestudy_staging: Close
[0m12:54:04.048547 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy_staging, now list_casestudy_raw)
[0m12:54:04.050724 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_raw"
[0m12:54:04.051066 [debug] [ThreadPool]: On list_casestudy_raw: BEGIN
[0m12:54:04.051379 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:54:04.062546 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:54:04.062949 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_raw"
[0m12:54:04.063247 [debug] [ThreadPool]: On list_casestudy_raw: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_raw"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'raw'
    and table_catalog = 'casestudy'
  
[0m12:54:04.071575 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:54:04.072960 [debug] [ThreadPool]: On list_casestudy_raw: ROLLBACK
[0m12:54:04.073429 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_raw'
[0m12:54:04.073688 [debug] [ThreadPool]: On list_casestudy_raw: Close
[0m12:54:04.076646 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy_raw, now list_casestudy_intermediate)
[0m12:54:04.078812 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_intermediate"
[0m12:54:04.079149 [debug] [ThreadPool]: On list_casestudy_intermediate: BEGIN
[0m12:54:04.079488 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:54:04.090850 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:54:04.091250 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_intermediate"
[0m12:54:04.091568 [debug] [ThreadPool]: On list_casestudy_intermediate: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_intermediate"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'intermediate'
    and table_catalog = 'casestudy'
  
[0m12:54:04.099693 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:54:04.100995 [debug] [ThreadPool]: On list_casestudy_intermediate: ROLLBACK
[0m12:54:04.101442 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_intermediate'
[0m12:54:04.101697 [debug] [ThreadPool]: On list_casestudy_intermediate: Close
[0m12:54:04.104653 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy_intermediate, now list_casestudy_reporting)
[0m12:54:04.107913 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_reporting"
[0m12:54:04.108291 [debug] [ThreadPool]: On list_casestudy_reporting: BEGIN
[0m12:54:04.108556 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:54:04.119494 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:54:04.119884 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_reporting"
[0m12:54:04.120178 [debug] [ThreadPool]: On list_casestudy_reporting: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_reporting"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'reporting'
    and table_catalog = 'casestudy'
  
[0m12:54:04.128335 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:54:04.129536 [debug] [ThreadPool]: On list_casestudy_reporting: ROLLBACK
[0m12:54:04.129983 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_reporting'
[0m12:54:04.130248 [debug] [ThreadPool]: On list_casestudy_reporting: Close
[0m12:54:04.133073 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy_reporting, now list_casestudy_marts)
[0m12:54:04.136510 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_marts"
[0m12:54:04.136929 [debug] [ThreadPool]: On list_casestudy_marts: BEGIN
[0m12:54:04.137242 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:54:04.148128 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:54:04.148505 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_marts"
[0m12:54:04.148795 [debug] [ThreadPool]: On list_casestudy_marts: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_marts"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'marts'
    and table_catalog = 'casestudy'
  
[0m12:54:04.157293 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:54:04.158598 [debug] [ThreadPool]: On list_casestudy_marts: ROLLBACK
[0m12:54:04.159097 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_marts'
[0m12:54:04.159372 [debug] [ThreadPool]: On list_casestudy_marts: Close
[0m12:54:04.162889 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fb9afdb5-fad2-4cf4-a734-e8d5ad200810', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6859c09910>]}
[0m12:54:04.163362 [debug] [MainThread]: Using duckdb connection "master"
[0m12:54:04.163634 [debug] [MainThread]: On master: BEGIN
[0m12:54:04.163905 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:54:04.177192 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m12:54:04.177606 [debug] [MainThread]: On master: COMMIT
[0m12:54:04.177879 [debug] [MainThread]: Using duckdb connection "master"
[0m12:54:04.178145 [debug] [MainThread]: On master: COMMIT
[0m12:54:04.178780 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m12:54:04.179092 [debug] [MainThread]: On master: Close
[0m12:54:04.181503 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:54:04.182164 [info ] [MainThread]: 
[0m12:54:04.188163 [debug] [Thread-1 (]: Began running node model.vg_casestudy.reporting__branch_loan_type_kpis
[0m12:54:04.188750 [info ] [Thread-1 (]: 1 of 1 START sql view model reporting.reporting__branch_loan_type_kpis ......... [RUN]
[0m12:54:04.189730 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.vg_casestudy.reporting__branch_loan_type_kpis'
[0m12:54:04.190146 [debug] [Thread-1 (]: Began compiling node model.vg_casestudy.reporting__branch_loan_type_kpis
[0m12:54:04.200951 [debug] [Thread-1 (]: Writing injected SQL for node "model.vg_casestudy.reporting__branch_loan_type_kpis"
[0m12:54:04.201857 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.reporting__branch_loan_type_kpis (compile): 12:54:04.190457 => 12:54:04.201594
[0m12:54:04.202309 [debug] [Thread-1 (]: Began executing node model.vg_casestudy.reporting__branch_loan_type_kpis
[0m12:54:04.234834 [debug] [Thread-1 (]: Writing runtime sql for node "model.vg_casestudy.reporting__branch_loan_type_kpis"
[0m12:54:04.235623 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.reporting__branch_loan_type_kpis"
[0m12:54:04.235997 [debug] [Thread-1 (]: On model.vg_casestudy.reporting__branch_loan_type_kpis: BEGIN
[0m12:54:04.236300 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:54:04.250108 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m12:54:04.250603 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.reporting__branch_loan_type_kpis"
[0m12:54:04.251027 [debug] [Thread-1 (]: On model.vg_casestudy.reporting__branch_loan_type_kpis: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.reporting__branch_loan_type_kpis"} */

  
  create view "casestudy"."reporting"."reporting__branch_loan_type_kpis__dbt_tmp" as (
    with loans as (
    select *
    from "casestudy"."marts"."marts__loans_enriched"
),

aggregated as (
    select 
        branch_id,
        branch_name,
        loan_type,

        -- loan count by status
        count(loan_id) as count_of_loans,
        count(case when loan_status = 'approved' then loan_id end) as loans_approved,
        count(case when loan_status = 'rejected' then loan_id end) as loans_rejected,
        count(case when loan_status = 'closed' then loan_id end) as loans_closed,

        --customer segmentation
        count(distinct customer_id) as unique_customers,
        count(case when age < 30 then loan_id end) as loans_under_30,
        count(case when age between 30 and 50 then loan_id end) as loans_30_to_50,
        count(case when age > 50 then loan_id end) as loans_over_50,

        -- approval rate
        count(case when loan_status = 'approved' then loan_id end)::float
            / nullif(count(loan_id), 0) as approval_rate,
        count(case when loan_status = 'rejected' then loan_id end)::float
            / nullif(count(loan_id), 0) as rejection_rate,
        count(case when loan_status = 'closed' then loan_id end)::float
            / nullif(count(loan_id), 0) as closed_rate,

        -- loan kpis
        sum(loan_amount) as total_loan_amount,
        sum(loan_amount)::float / nullif(count(loan_id), 0) as avg_loan_amount,
        avg(interest_rate) as avg_interest_rate,
        avg(loan_term)  as avg_loan_term_months,
        count(case when loan_term > 36 then loan_id end)::float / count(loan_id) as long_term_loan_share_more_than_36,
        count(case when loan_term < 24 then loan_id end)::float / count(loan_id) as short_term_loan_share_less_than_24,
        min(case when loans.loan_status = 'approved' then approval_rejection_date end) as earliest_approval_date,
        max(case when loans.loan_status = 'approved' then approval_rejection_date end) as latest_approval_date

    from loans
    group by branch_id,branch_name, loan_type
)

select *
from aggregated
  );

[0m12:54:04.256274 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m12:54:04.263311 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.reporting__branch_loan_type_kpis"
[0m12:54:04.263833 [debug] [Thread-1 (]: On model.vg_casestudy.reporting__branch_loan_type_kpis: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.reporting__branch_loan_type_kpis"} */
alter view "casestudy"."reporting"."reporting__branch_loan_type_kpis__dbt_tmp" rename to "reporting__branch_loan_type_kpis"
[0m12:54:04.264821 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m12:54:04.277751 [debug] [Thread-1 (]: On model.vg_casestudy.reporting__branch_loan_type_kpis: COMMIT
[0m12:54:04.278141 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.reporting__branch_loan_type_kpis"
[0m12:54:04.278461 [debug] [Thread-1 (]: On model.vg_casestudy.reporting__branch_loan_type_kpis: COMMIT
[0m12:54:04.285340 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m12:54:04.290772 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.reporting__branch_loan_type_kpis"
[0m12:54:04.291183 [debug] [Thread-1 (]: On model.vg_casestudy.reporting__branch_loan_type_kpis: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.reporting__branch_loan_type_kpis"} */
drop view if exists "casestudy"."reporting"."reporting__branch_loan_type_kpis__dbt_backup" cascade
[0m12:54:04.292061 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m12:54:04.293475 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.reporting__branch_loan_type_kpis (execute): 12:54:04.202607 => 12:54:04.293322
[0m12:54:04.293836 [debug] [Thread-1 (]: On model.vg_casestudy.reporting__branch_loan_type_kpis: Close
[0m12:54:04.324434 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fb9afdb5-fad2-4cf4-a734-e8d5ad200810', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6855953450>]}
[0m12:54:04.325216 [info ] [Thread-1 (]: 1 of 1 OK created sql view model reporting.reporting__branch_loan_type_kpis .... [[32mOK[0m in 0.14s]
[0m12:54:04.325804 [debug] [Thread-1 (]: Finished running node model.vg_casestudy.reporting__branch_loan_type_kpis
[0m12:54:04.327526 [debug] [MainThread]: Using duckdb connection "master"
[0m12:54:04.327849 [debug] [MainThread]: On master: BEGIN
[0m12:54:04.328127 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:54:04.341498 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m12:54:04.342165 [debug] [MainThread]: On master: COMMIT
[0m12:54:04.342645 [debug] [MainThread]: Using duckdb connection "master"
[0m12:54:04.343117 [debug] [MainThread]: On master: COMMIT
[0m12:54:04.344284 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m12:54:04.344779 [debug] [MainThread]: On master: Close
[0m12:54:04.347612 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:54:04.348076 [debug] [MainThread]: Connection 'list_casestudy_marts' was properly closed.
[0m12:54:04.348352 [debug] [MainThread]: Connection 'model.vg_casestudy.reporting__branch_loan_type_kpis' was properly closed.
[0m12:54:04.348674 [info ] [MainThread]: 
[0m12:54:04.349014 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.53 seconds (0.53s).
[0m12:54:04.349584 [debug] [MainThread]: Command end result
[0m12:54:04.371089 [info ] [MainThread]: 
[0m12:54:04.371569 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:54:04.371896 [info ] [MainThread]: 
[0m12:54:04.372613 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:54:04.373307 [debug] [MainThread]: Command `dbt run` succeeded at 12:54:04.373200 after 1.10 seconds
[0m12:54:04.373667 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6859cf4bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6859c905d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f685be2ea50>]}
[0m12:54:04.374041 [debug] [MainThread]: Flushing usage events
[0m12:54:16.396416 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4008f39790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4009237d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4009232a50>]}


============================== 12:54:16.399592 | bdb12c67-0175-4046-a371-4901be1227d1 ==============================
[0m12:54:16.399592 [info ] [MainThread]: Running with dbt=1.6.18
[0m12:54:16.400240 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/workspaces/vg_case_study_tim/transformation', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/workspaces/vg_case_study_tim/transformation/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt test --select reporting__branch_loan_type_kpis', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:54:16.518642 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bdb12c67-0175-4046-a371-4901be1227d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f40054f66d0>]}
[0m12:54:16.535731 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bdb12c67-0175-4046-a371-4901be1227d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f40097c04d0>]}
[0m12:54:16.536710 [info ] [MainThread]: Registered adapter: duckdb=1.6.2
[0m12:54:16.579433 [debug] [MainThread]: checksum: 7b9fab86a08e9e96a48a825af743c566d95b877e068b8c6d0dbafbf714447189, vars: {}, profile: , target: , version: 1.6.18
[0m12:54:16.680614 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:54:16.681316 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:54:16.683728 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.vg_casestudy.main
[0m12:54:16.705227 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bdb12c67-0175-4046-a371-4901be1227d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4008f257d0>]}
[0m12:54:16.855305 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bdb12c67-0175-4046-a371-4901be1227d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4008c6e210>]}
[0m12:54:16.856141 [info ] [MainThread]: Found 18 models, 1 analysis, 4 seeds, 114 tests, 5 sources, 0 exposures, 0 metrics, 632 macros, 0 groups, 0 semantic models
[0m12:54:16.856818 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bdb12c67-0175-4046-a371-4901be1227d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f400487ec10>]}
[0m12:54:16.861053 [info ] [MainThread]: 
[0m12:54:16.862135 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m12:54:16.866029 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_casestudy_marts'
[0m12:54:16.881254 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_marts"
[0m12:54:16.882024 [debug] [ThreadPool]: On list_casestudy_marts: BEGIN
[0m12:54:16.882488 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:54:16.908147 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:54:16.908836 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_marts"
[0m12:54:16.909321 [debug] [ThreadPool]: On list_casestudy_marts: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_marts"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'marts'
    and table_catalog = 'casestudy'
  
[0m12:54:16.928220 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:54:16.929938 [debug] [ThreadPool]: On list_casestudy_marts: ROLLBACK
[0m12:54:16.930771 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_marts'
[0m12:54:16.931189 [debug] [ThreadPool]: On list_casestudy_marts: Close
[0m12:54:16.936321 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy_marts, now list_casestudy_staging)
[0m12:54:16.940940 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_staging"
[0m12:54:16.941703 [debug] [ThreadPool]: On list_casestudy_staging: BEGIN
[0m12:54:16.942151 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:54:16.959692 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:54:16.960165 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_staging"
[0m12:54:16.960481 [debug] [ThreadPool]: On list_casestudy_staging: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_staging"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'staging'
    and table_catalog = 'casestudy'
  
[0m12:54:16.972181 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:54:16.975353 [debug] [ThreadPool]: On list_casestudy_staging: ROLLBACK
[0m12:54:16.976083 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_staging'
[0m12:54:16.976493 [debug] [ThreadPool]: On list_casestudy_staging: Close
[0m12:54:16.979899 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy_staging, now list_casestudy_intermediate)
[0m12:54:16.983569 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_intermediate"
[0m12:54:16.983983 [debug] [ThreadPool]: On list_casestudy_intermediate: BEGIN
[0m12:54:16.984266 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:54:16.997893 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:54:16.998368 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_intermediate"
[0m12:54:16.998782 [debug] [ThreadPool]: On list_casestudy_intermediate: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_intermediate"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'intermediate'
    and table_catalog = 'casestudy'
  
[0m12:54:17.010171 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:54:17.012330 [debug] [ThreadPool]: On list_casestudy_intermediate: ROLLBACK
[0m12:54:17.013075 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_intermediate'
[0m12:54:17.013402 [debug] [ThreadPool]: On list_casestudy_intermediate: Close
[0m12:54:17.016800 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy_intermediate, now list_casestudy_reporting)
[0m12:54:17.020682 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_reporting"
[0m12:54:17.021095 [debug] [ThreadPool]: On list_casestudy_reporting: BEGIN
[0m12:54:17.021389 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:54:17.036290 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:54:17.036782 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_reporting"
[0m12:54:17.037160 [debug] [ThreadPool]: On list_casestudy_reporting: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_reporting"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'reporting'
    and table_catalog = 'casestudy'
  
[0m12:54:17.051014 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:54:17.052676 [debug] [ThreadPool]: On list_casestudy_reporting: ROLLBACK
[0m12:54:17.053471 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_reporting'
[0m12:54:17.053982 [debug] [ThreadPool]: On list_casestudy_reporting: Close
[0m12:54:17.058248 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy_reporting, now list_casestudy_raw)
[0m12:54:17.061588 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_raw"
[0m12:54:17.062160 [debug] [ThreadPool]: On list_casestudy_raw: BEGIN
[0m12:54:17.062521 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:54:17.077019 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:54:17.077482 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_raw"
[0m12:54:17.077855 [debug] [ThreadPool]: On list_casestudy_raw: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_raw"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'raw'
    and table_catalog = 'casestudy'
  
[0m12:54:17.088048 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:54:17.090324 [debug] [ThreadPool]: On list_casestudy_raw: ROLLBACK
[0m12:54:17.091350 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_raw'
[0m12:54:17.092034 [debug] [ThreadPool]: On list_casestudy_raw: Close
[0m12:54:17.096710 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bdb12c67-0175-4046-a371-4901be1227d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4008c72050>]}
[0m12:54:17.097279 [debug] [MainThread]: Using duckdb connection "master"
[0m12:54:17.097608 [debug] [MainThread]: On master: BEGIN
[0m12:54:17.097887 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:54:17.113716 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m12:54:17.114444 [debug] [MainThread]: On master: COMMIT
[0m12:54:17.115001 [debug] [MainThread]: Using duckdb connection "master"
[0m12:54:17.115478 [debug] [MainThread]: On master: COMMIT
[0m12:54:17.116388 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m12:54:17.116839 [debug] [MainThread]: On master: Close
[0m12:54:17.120294 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:54:17.121028 [info ] [MainThread]: 
[0m12:54:17.123769 [debug] [Thread-1 (]: Began running node test.vg_casestudy.not_null_reporting__branch_loan_type_kpis_branch_id.202f7b1035
[0m12:54:17.124769 [info ] [Thread-1 (]: 1 of 1 START test not_null_reporting__branch_loan_type_kpis_branch_id .......... [RUN]
[0m12:54:17.126123 [debug] [Thread-1 (]: Acquiring new duckdb connection 'test.vg_casestudy.not_null_reporting__branch_loan_type_kpis_branch_id.202f7b1035'
[0m12:54:17.126840 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.not_null_reporting__branch_loan_type_kpis_branch_id.202f7b1035
[0m12:54:17.148522 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.not_null_reporting__branch_loan_type_kpis_branch_id.202f7b1035"
[0m12:54:17.152308 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_reporting__branch_loan_type_kpis_branch_id.202f7b1035 (compile): 12:54:17.127271 => 12:54:17.151999
[0m12:54:17.152792 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.not_null_reporting__branch_loan_type_kpis_branch_id.202f7b1035
[0m12:54:17.168945 [debug] [Thread-1 (]: Writing runtime sql for node "test.vg_casestudy.not_null_reporting__branch_loan_type_kpis_branch_id.202f7b1035"
[0m12:54:17.170457 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.not_null_reporting__branch_loan_type_kpis_branch_id.202f7b1035"
[0m12:54:17.170965 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_reporting__branch_loan_type_kpis_branch_id.202f7b1035: BEGIN
[0m12:54:17.171328 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:54:17.188113 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m12:54:17.188879 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.not_null_reporting__branch_loan_type_kpis_branch_id.202f7b1035"
[0m12:54:17.189551 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_reporting__branch_loan_type_kpis_branch_id.202f7b1035: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "test.vg_casestudy.not_null_reporting__branch_loan_type_kpis_branch_id.202f7b1035"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select branch_id
from "casestudy"."reporting"."reporting__branch_loan_type_kpis"
where branch_id is null



      
    ) dbt_internal_test
[0m12:54:17.208103 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m12:54:17.211718 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_reporting__branch_loan_type_kpis_branch_id.202f7b1035 (execute): 12:54:17.153142 => 12:54:17.211454
[0m12:54:17.212229 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_reporting__branch_loan_type_kpis_branch_id.202f7b1035: ROLLBACK
[0m12:54:17.212788 [debug] [Thread-1 (]: Failed to rollback 'test.vg_casestudy.not_null_reporting__branch_loan_type_kpis_branch_id.202f7b1035'
[0m12:54:17.213203 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_reporting__branch_loan_type_kpis_branch_id.202f7b1035: Close
[0m12:54:17.217261 [info ] [Thread-1 (]: 1 of 1 PASS not_null_reporting__branch_loan_type_kpis_branch_id ................ [[32mPASS[0m in 0.09s]
[0m12:54:17.218367 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.not_null_reporting__branch_loan_type_kpis_branch_id.202f7b1035
[0m12:54:17.220439 [debug] [MainThread]: Using duckdb connection "master"
[0m12:54:17.220840 [debug] [MainThread]: On master: BEGIN
[0m12:54:17.221135 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:54:17.246455 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m12:54:17.249187 [debug] [MainThread]: On master: COMMIT
[0m12:54:17.249764 [debug] [MainThread]: Using duckdb connection "master"
[0m12:54:17.250133 [debug] [MainThread]: On master: COMMIT
[0m12:54:17.251179 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m12:54:17.251622 [debug] [MainThread]: On master: Close
[0m12:54:17.256689 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:54:17.257480 [debug] [MainThread]: Connection 'list_casestudy_raw' was properly closed.
[0m12:54:17.257994 [debug] [MainThread]: Connection 'test.vg_casestudy.not_null_reporting__branch_loan_type_kpis_branch_id.202f7b1035' was properly closed.
[0m12:54:17.258495 [info ] [MainThread]: 
[0m12:54:17.259018 [info ] [MainThread]: Finished running 1 test in 0 hours 0 minutes and 0.40 seconds (0.40s).
[0m12:54:17.259668 [debug] [MainThread]: Command end result
[0m12:54:17.286045 [info ] [MainThread]: 
[0m12:54:17.286581 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:54:17.286949 [info ] [MainThread]: 
[0m12:54:17.287336 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:54:17.287901 [debug] [MainThread]: Command `dbt test` succeeded at 12:54:17.287785 after 0.90 seconds
[0m12:54:17.288341 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f400d83be50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4009385190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4005522290>]}
[0m12:54:17.288727 [debug] [MainThread]: Flushing usage events
[0m13:46:12.819496 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d80d07610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d80db7650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d816d09d0>]}


============================== 13:46:12.826625 | a23cc4b7-b7b8-4aaa-a1bd-db47a357cf06 ==============================
[0m13:46:12.826625 [info ] [MainThread]: Running with dbt=1.6.18
[0m13:46:12.827968 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/workspaces/vg_case_study_tim/transformation/logs', 'profiles_dir': '/workspaces/vg_case_study_tim/transformation', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt debug', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:46:12.829125 [info ] [MainThread]: dbt version: 1.6.18
[0m13:46:12.829845 [info ] [MainThread]: python version: 3.11.6
[0m13:46:12.830377 [info ] [MainThread]: python path: /usr/local/bin/python
[0m13:46:12.831041 [info ] [MainThread]: os info: Linux-5.15.153.1-microsoft-standard-WSL2-x86_64-with-glibc2.31
[0m13:46:13.038596 [info ] [MainThread]: Using profiles dir at /workspaces/vg_case_study_tim/transformation
[0m13:46:13.039337 [info ] [MainThread]: Using profiles.yml file at /workspaces/vg_case_study_tim/transformation/profiles.yml
[0m13:46:13.039826 [info ] [MainThread]: Using dbt_project.yml file at /workspaces/vg_case_study_tim/transformation/dbt_project.yml
[0m13:46:13.041332 [info ] [MainThread]: adapter type: duckdb
[0m13:46:13.042046 [info ] [MainThread]: adapter version: 1.6.2
[0m13:46:13.097698 [info ] [MainThread]: Configuration:
[0m13:46:13.098416 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m13:46:13.099130 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m13:46:13.099894 [info ] [MainThread]: Required dependencies:
[0m13:46:13.100497 [debug] [MainThread]: Executing "git --help"
[0m13:46:13.103114 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m13:46:13.103762 [debug] [MainThread]: STDERR: "b''"
[0m13:46:13.104307 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m13:46:13.104960 [info ] [MainThread]: Connection:
[0m13:46:13.105531 [info ] [MainThread]:   database: casestudy
[0m13:46:13.106133 [info ] [MainThread]:   schema: main
[0m13:46:13.106972 [info ] [MainThread]:   path: casestudy.duckdb
[0m13:46:13.107661 [info ] [MainThread]:   config_options: None
[0m13:46:13.108948 [info ] [MainThread]:   extensions: ['icu']
[0m13:46:13.109724 [info ] [MainThread]:   settings: None
[0m13:46:13.110607 [info ] [MainThread]:   external_root: .
[0m13:46:13.111631 [info ] [MainThread]:   use_credential_provider: None
[0m13:46:13.112535 [info ] [MainThread]:   attach: None
[0m13:46:13.114147 [info ] [MainThread]:   filesystems: None
[0m13:46:13.115129 [info ] [MainThread]:   remote: None
[0m13:46:13.115804 [info ] [MainThread]:   plugins: None
[0m13:46:13.116439 [info ] [MainThread]:   disable_transactions: False
[0m13:46:13.117607 [info ] [MainThread]: Registered adapter: duckdb=1.6.2
[0m13:46:13.118776 [debug] [MainThread]: Acquiring new duckdb connection 'debug'
[0m13:46:13.119327 [debug] [MainThread]: Using duckdb connection "debug"
[0m13:46:13.119771 [debug] [MainThread]: On debug: select 1 as id
[0m13:46:13.120273 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:46:13.298910 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m13:46:13.300848 [debug] [MainThread]: On debug: Close
[0m13:46:13.308897 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m13:46:13.309854 [info ] [MainThread]: [32mAll checks passed![0m
[0m13:46:13.310755 [debug] [MainThread]: Command `dbt debug` succeeded at 13:46:13.310531 after 0.51 seconds
[0m13:46:13.311270 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m13:46:13.311792 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d80f6d450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d80b50b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d816d0890>]}
[0m13:46:13.312419 [debug] [MainThread]: Flushing usage events
[0m13:54:19.762792 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff1b6eded0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff1974db50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff19427f50>]}


============================== 13:54:19.770336 | 9ae1e32b-309a-43a2-a074-6fb0421ea9d9 ==============================
[0m13:54:19.770336 [info ] [MainThread]: Running with dbt=1.6.18
[0m13:54:19.771743 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/workspaces/vg_case_study_tim/transformation', 'log_path': '/workspaces/vg_case_study_tim/transformation/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt docs generate', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:54:20.165386 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9ae1e32b-309a-43a2-a074-6fb0421ea9d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff19452350>]}
[0m13:54:20.211349 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9ae1e32b-309a-43a2-a074-6fb0421ea9d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff1989d410>]}
[0m13:54:20.213965 [info ] [MainThread]: Registered adapter: duckdb=1.6.2
[0m13:54:20.300414 [debug] [MainThread]: checksum: 7b9fab86a08e9e96a48a825af743c566d95b877e068b8c6d0dbafbf714447189, vars: {}, profile: , target: , version: 1.6.18
[0m13:54:20.554994 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:54:20.555876 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:54:20.559201 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.vg_casestudy.main
[0m13:54:20.580772 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9ae1e32b-309a-43a2-a074-6fb0421ea9d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff19751610>]}
[0m13:54:20.689898 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9ae1e32b-309a-43a2-a074-6fb0421ea9d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff1b01b4d0>]}
[0m13:54:20.690793 [info ] [MainThread]: Found 18 models, 1 analysis, 4 seeds, 114 tests, 5 sources, 0 exposures, 0 metrics, 632 macros, 0 groups, 0 semantic models
[0m13:54:20.691563 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9ae1e32b-309a-43a2-a074-6fb0421ea9d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff1ce92290>]}
[0m13:54:20.705563 [info ] [MainThread]: 
[0m13:54:20.707585 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m13:54:20.712242 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_casestudy_staging'
[0m13:54:20.750995 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_staging"
[0m13:54:20.751842 [debug] [ThreadPool]: On list_casestudy_staging: BEGIN
[0m13:54:20.752568 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:54:20.949124 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:54:20.950162 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_staging"
[0m13:54:20.951006 [debug] [ThreadPool]: On list_casestudy_staging: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_staging"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'staging'
    and table_catalog = 'casestudy'
  
[0m13:54:20.991519 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:54:20.996203 [debug] [ThreadPool]: On list_casestudy_staging: ROLLBACK
[0m13:54:20.999911 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_staging'
[0m13:54:21.000849 [debug] [ThreadPool]: On list_casestudy_staging: Close
[0m13:54:21.009094 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy_staging, now list_casestudy_intermediate)
[0m13:54:21.018417 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_intermediate"
[0m13:54:21.019435 [debug] [ThreadPool]: On list_casestudy_intermediate: BEGIN
[0m13:54:21.020164 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:54:21.054085 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:54:21.056418 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_intermediate"
[0m13:54:21.058906 [debug] [ThreadPool]: On list_casestudy_intermediate: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_intermediate"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'intermediate'
    and table_catalog = 'casestudy'
  
[0m13:54:21.114783 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:54:21.119313 [debug] [ThreadPool]: On list_casestudy_intermediate: ROLLBACK
[0m13:54:21.120752 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_intermediate'
[0m13:54:21.121778 [debug] [ThreadPool]: On list_casestudy_intermediate: Close
[0m13:54:21.128736 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy_intermediate, now list_casestudy_marts)
[0m13:54:21.136562 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_marts"
[0m13:54:21.137366 [debug] [ThreadPool]: On list_casestudy_marts: BEGIN
[0m13:54:21.137943 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:54:21.165930 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:54:21.166794 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_marts"
[0m13:54:21.167435 [debug] [ThreadPool]: On list_casestudy_marts: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_marts"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'marts'
    and table_catalog = 'casestudy'
  
[0m13:54:21.189414 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:54:21.193065 [debug] [ThreadPool]: On list_casestudy_marts: ROLLBACK
[0m13:54:21.194654 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_marts'
[0m13:54:21.195765 [debug] [ThreadPool]: On list_casestudy_marts: Close
[0m13:54:21.203851 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy_marts, now list_casestudy_reporting)
[0m13:54:21.214126 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_reporting"
[0m13:54:21.215177 [debug] [ThreadPool]: On list_casestudy_reporting: BEGIN
[0m13:54:21.215872 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:54:21.252110 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:54:21.252956 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_reporting"
[0m13:54:21.253665 [debug] [ThreadPool]: On list_casestudy_reporting: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_reporting"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'reporting'
    and table_catalog = 'casestudy'
  
[0m13:54:21.289020 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:54:21.296013 [debug] [ThreadPool]: On list_casestudy_reporting: ROLLBACK
[0m13:54:21.297537 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_reporting'
[0m13:54:21.298576 [debug] [ThreadPool]: On list_casestudy_reporting: Close
[0m13:54:21.314777 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy_reporting, now list_casestudy_raw)
[0m13:54:21.321805 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_raw"
[0m13:54:21.322965 [debug] [ThreadPool]: On list_casestudy_raw: BEGIN
[0m13:54:21.323803 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:54:21.375459 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:54:21.378638 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_raw"
[0m13:54:21.380070 [debug] [ThreadPool]: On list_casestudy_raw: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_raw"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'raw'
    and table_catalog = 'casestudy'
  
[0m13:54:21.417033 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:54:21.420089 [debug] [ThreadPool]: On list_casestudy_raw: ROLLBACK
[0m13:54:21.421208 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_raw'
[0m13:54:21.422102 [debug] [ThreadPool]: On list_casestudy_raw: Close
[0m13:54:21.432798 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9ae1e32b-309a-43a2-a074-6fb0421ea9d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff14e1f750>]}
[0m13:54:21.434496 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:54:21.435384 [info ] [MainThread]: 
[0m13:54:21.444440 [debug] [Thread-1 (]: Began running node model.vg_casestudy.stg_raw_staging__accounts
[0m13:54:21.446608 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_casestudy_raw, now model.vg_casestudy.stg_raw_staging__accounts)
[0m13:54:21.447704 [debug] [Thread-1 (]: Began compiling node model.vg_casestudy.stg_raw_staging__accounts
[0m13:54:21.480236 [debug] [Thread-1 (]: Writing injected SQL for node "model.vg_casestudy.stg_raw_staging__accounts"
[0m13:54:21.482406 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.stg_raw_staging__accounts (compile): 13:54:21.448427 => 13:54:21.481692
[0m13:54:21.483255 [debug] [Thread-1 (]: Began executing node model.vg_casestudy.stg_raw_staging__accounts
[0m13:54:21.484602 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.stg_raw_staging__accounts (execute): 13:54:21.483728 => 13:54:21.483750
[0m13:54:21.487055 [debug] [Thread-1 (]: Finished running node model.vg_casestudy.stg_raw_staging__accounts
[0m13:54:21.488174 [debug] [Thread-1 (]: Began running node model.vg_casestudy.stg_raw_staging__customers
[0m13:54:21.490346 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.vg_casestudy.stg_raw_staging__accounts, now model.vg_casestudy.stg_raw_staging__customers)
[0m13:54:21.492452 [debug] [Thread-1 (]: Began compiling node model.vg_casestudy.stg_raw_staging__customers
[0m13:54:21.505204 [debug] [Thread-1 (]: Writing injected SQL for node "model.vg_casestudy.stg_raw_staging__customers"
[0m13:54:21.507079 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.stg_raw_staging__customers (compile): 13:54:21.493464 => 13:54:21.506480
[0m13:54:21.508155 [debug] [Thread-1 (]: Began executing node model.vg_casestudy.stg_raw_staging__customers
[0m13:54:21.509422 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.stg_raw_staging__customers (execute): 13:54:21.508910 => 13:54:21.508943
[0m13:54:21.512952 [debug] [Thread-1 (]: Finished running node model.vg_casestudy.stg_raw_staging__customers
[0m13:54:21.514764 [debug] [Thread-1 (]: Began running node model.vg_casestudy.stg_raw_staging__fx_rates
[0m13:54:21.517076 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.vg_casestudy.stg_raw_staging__customers, now model.vg_casestudy.stg_raw_staging__fx_rates)
[0m13:54:21.518402 [debug] [Thread-1 (]: Began compiling node model.vg_casestudy.stg_raw_staging__fx_rates
[0m13:54:21.530473 [debug] [Thread-1 (]: Writing injected SQL for node "model.vg_casestudy.stg_raw_staging__fx_rates"
[0m13:54:21.532508 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.stg_raw_staging__fx_rates (compile): 13:54:21.519051 => 13:54:21.531776
[0m13:54:21.533827 [debug] [Thread-1 (]: Began executing node model.vg_casestudy.stg_raw_staging__fx_rates
[0m13:54:21.534936 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.stg_raw_staging__fx_rates (execute): 13:54:21.534593 => 13:54:21.534619
[0m13:54:21.536700 [debug] [Thread-1 (]: Finished running node model.vg_casestudy.stg_raw_staging__fx_rates
[0m13:54:21.537658 [debug] [Thread-1 (]: Began running node model.vg_casestudy.stg_raw_staging__loans
[0m13:54:21.539307 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.vg_casestudy.stg_raw_staging__fx_rates, now model.vg_casestudy.stg_raw_staging__loans)
[0m13:54:21.540515 [debug] [Thread-1 (]: Began compiling node model.vg_casestudy.stg_raw_staging__loans
[0m13:54:21.550508 [debug] [Thread-1 (]: Writing injected SQL for node "model.vg_casestudy.stg_raw_staging__loans"
[0m13:54:21.552016 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.stg_raw_staging__loans (compile): 13:54:21.541166 => 13:54:21.551567
[0m13:54:21.553056 [debug] [Thread-1 (]: Began executing node model.vg_casestudy.stg_raw_staging__loans
[0m13:54:21.554325 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.stg_raw_staging__loans (execute): 13:54:21.553839 => 13:54:21.553872
[0m13:54:21.556475 [debug] [Thread-1 (]: Finished running node model.vg_casestudy.stg_raw_staging__loans
[0m13:54:21.557313 [debug] [Thread-1 (]: Began running node model.vg_casestudy.stg_raw_staging__transactions
[0m13:54:21.559285 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.vg_casestudy.stg_raw_staging__loans, now model.vg_casestudy.stg_raw_staging__transactions)
[0m13:54:21.562803 [debug] [Thread-1 (]: Began compiling node model.vg_casestudy.stg_raw_staging__transactions
[0m13:54:21.570582 [debug] [Thread-1 (]: Writing injected SQL for node "model.vg_casestudy.stg_raw_staging__transactions"
[0m13:54:21.571945 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.stg_raw_staging__transactions (compile): 13:54:21.563416 => 13:54:21.571509
[0m13:54:21.572654 [debug] [Thread-1 (]: Began executing node model.vg_casestudy.stg_raw_staging__transactions
[0m13:54:21.573449 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.stg_raw_staging__transactions (execute): 13:54:21.573109 => 13:54:21.573130
[0m13:54:21.575154 [debug] [Thread-1 (]: Finished running node model.vg_casestudy.stg_raw_staging__transactions
[0m13:54:21.576087 [debug] [Thread-1 (]: Began running node seed.vg_casestudy.branch_names
[0m13:54:21.579561 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.vg_casestudy.stg_raw_staging__transactions, now seed.vg_casestudy.branch_names)
[0m13:54:21.580604 [debug] [Thread-1 (]: Began compiling node seed.vg_casestudy.branch_names
[0m13:54:21.584986 [debug] [Thread-1 (]: Timing info for seed.vg_casestudy.branch_names (compile): 13:54:21.581109 => 13:54:21.584589
[0m13:54:21.585866 [debug] [Thread-1 (]: Began executing node seed.vg_casestudy.branch_names
[0m13:54:21.586644 [debug] [Thread-1 (]: Timing info for seed.vg_casestudy.branch_names (execute): 13:54:21.586344 => 13:54:21.586358
[0m13:54:21.588209 [debug] [Thread-1 (]: Finished running node seed.vg_casestudy.branch_names
[0m13:54:21.588932 [debug] [Thread-1 (]: Began running node seed.vg_casestudy.currencies
[0m13:54:21.590644 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.vg_casestudy.branch_names, now seed.vg_casestudy.currencies)
[0m13:54:21.591300 [debug] [Thread-1 (]: Began compiling node seed.vg_casestudy.currencies
[0m13:54:21.596105 [debug] [Thread-1 (]: Timing info for seed.vg_casestudy.currencies (compile): 13:54:21.591699 => 13:54:21.595428
[0m13:54:21.596804 [debug] [Thread-1 (]: Began executing node seed.vg_casestudy.currencies
[0m13:54:21.597537 [debug] [Thread-1 (]: Timing info for seed.vg_casestudy.currencies (execute): 13:54:21.597240 => 13:54:21.597255
[0m13:54:21.598881 [debug] [Thread-1 (]: Finished running node seed.vg_casestudy.currencies
[0m13:54:21.599743 [debug] [Thread-1 (]: Began running node seed.vg_casestudy.dbt_project_evaluator_exceptions
[0m13:54:21.601187 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.vg_casestudy.currencies, now seed.vg_casestudy.dbt_project_evaluator_exceptions)
[0m13:54:21.602255 [debug] [Thread-1 (]: Began compiling node seed.vg_casestudy.dbt_project_evaluator_exceptions
[0m13:54:21.606036 [debug] [Thread-1 (]: Timing info for seed.vg_casestudy.dbt_project_evaluator_exceptions (compile): 13:54:21.602910 => 13:54:21.605698
[0m13:54:21.606667 [debug] [Thread-1 (]: Began executing node seed.vg_casestudy.dbt_project_evaluator_exceptions
[0m13:54:21.607350 [debug] [Thread-1 (]: Timing info for seed.vg_casestudy.dbt_project_evaluator_exceptions (execute): 13:54:21.607074 => 13:54:21.607096
[0m13:54:21.608744 [debug] [Thread-1 (]: Finished running node seed.vg_casestudy.dbt_project_evaluator_exceptions
[0m13:54:21.609816 [debug] [Thread-1 (]: Began running node seed.vg_casestudy.fx_rates_full_history
[0m13:54:21.612078 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.vg_casestudy.dbt_project_evaluator_exceptions, now seed.vg_casestudy.fx_rates_full_history)
[0m13:54:21.613110 [debug] [Thread-1 (]: Began compiling node seed.vg_casestudy.fx_rates_full_history
[0m13:54:21.617099 [debug] [Thread-1 (]: Timing info for seed.vg_casestudy.fx_rates_full_history (compile): 13:54:21.613570 => 13:54:21.616711
[0m13:54:21.617836 [debug] [Thread-1 (]: Began executing node seed.vg_casestudy.fx_rates_full_history
[0m13:54:21.618642 [debug] [Thread-1 (]: Timing info for seed.vg_casestudy.fx_rates_full_history (execute): 13:54:21.618249 => 13:54:21.618260
[0m13:54:21.620009 [debug] [Thread-1 (]: Finished running node seed.vg_casestudy.fx_rates_full_history
[0m13:54:21.620643 [debug] [Thread-1 (]: Began running node model.vg_casestudy.stg_staging_intermediate__accounts
[0m13:54:21.622130 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.vg_casestudy.fx_rates_full_history, now model.vg_casestudy.stg_staging_intermediate__accounts)
[0m13:54:21.622824 [debug] [Thread-1 (]: Began compiling node model.vg_casestudy.stg_staging_intermediate__accounts
[0m13:54:21.629129 [debug] [Thread-1 (]: Writing injected SQL for node "model.vg_casestudy.stg_staging_intermediate__accounts"
[0m13:54:21.630404 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.stg_staging_intermediate__accounts (compile): 13:54:21.623246 => 13:54:21.630044
[0m13:54:21.631005 [debug] [Thread-1 (]: Began executing node model.vg_casestudy.stg_staging_intermediate__accounts
[0m13:54:21.631791 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.stg_staging_intermediate__accounts (execute): 13:54:21.631497 => 13:54:21.631509
[0m13:54:21.633205 [debug] [Thread-1 (]: Finished running node model.vg_casestudy.stg_staging_intermediate__accounts
[0m13:54:21.633939 [debug] [Thread-1 (]: Began running node test.vg_casestudy.accepted_values_stg_raw_staging__accounts_account_type__savings__current.8db4e271bb
[0m13:54:21.635378 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.vg_casestudy.stg_staging_intermediate__accounts, now test.vg_casestudy.accepted_values_stg_raw_staging__accounts_account_type__savings__current.8db4e271bb)
[0m13:54:21.635972 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.accepted_values_stg_raw_staging__accounts_account_type__savings__current.8db4e271bb
[0m13:54:21.661624 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.accepted_values_stg_raw_staging__accounts_account_type__savings__current.8db4e271bb"
[0m13:54:21.663774 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.accepted_values_stg_raw_staging__accounts_account_type__savings__current.8db4e271bb (compile): 13:54:21.636378 => 13:54:21.663384
[0m13:54:21.664423 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.accepted_values_stg_raw_staging__accounts_account_type__savings__current.8db4e271bb
[0m13:54:21.665137 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.accepted_values_stg_raw_staging__accounts_account_type__savings__current.8db4e271bb (execute): 13:54:21.664820 => 13:54:21.664832
[0m13:54:21.666595 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.accepted_values_stg_raw_staging__accounts_account_type__savings__current.8db4e271bb
[0m13:54:21.667428 [debug] [Thread-1 (]: Began running node test.vg_casestudy.date_is_past_stg_raw_staging__accounts_account_opening_date.b05801e56a
[0m13:54:21.668750 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.accepted_values_stg_raw_staging__accounts_account_type__savings__current.8db4e271bb, now test.vg_casestudy.date_is_past_stg_raw_staging__accounts_account_opening_date.b05801e56a)
[0m13:54:21.669606 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.date_is_past_stg_raw_staging__accounts_account_opening_date.b05801e56a
[0m13:54:21.678818 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.date_is_past_stg_raw_staging__accounts_account_opening_date.b05801e56a"
[0m13:54:21.680239 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.date_is_past_stg_raw_staging__accounts_account_opening_date.b05801e56a (compile): 13:54:21.670041 => 13:54:21.679905
[0m13:54:21.680819 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.date_is_past_stg_raw_staging__accounts_account_opening_date.b05801e56a
[0m13:54:21.681644 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.date_is_past_stg_raw_staging__accounts_account_opening_date.b05801e56a (execute): 13:54:21.681335 => 13:54:21.681349
[0m13:54:21.683101 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.date_is_past_stg_raw_staging__accounts_account_opening_date.b05801e56a
[0m13:54:21.683809 [debug] [Thread-1 (]: Began running node test.vg_casestudy.not_null_stg_raw_staging__accounts_account_id.c6fceee87c
[0m13:54:21.684936 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.date_is_past_stg_raw_staging__accounts_account_opening_date.b05801e56a, now test.vg_casestudy.not_null_stg_raw_staging__accounts_account_id.c6fceee87c)
[0m13:54:21.685471 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.not_null_stg_raw_staging__accounts_account_id.c6fceee87c
[0m13:54:21.701432 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.not_null_stg_raw_staging__accounts_account_id.c6fceee87c"
[0m13:54:21.702951 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_stg_raw_staging__accounts_account_id.c6fceee87c (compile): 13:54:21.685841 => 13:54:21.702434
[0m13:54:21.703780 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.not_null_stg_raw_staging__accounts_account_id.c6fceee87c
[0m13:54:21.704549 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_stg_raw_staging__accounts_account_id.c6fceee87c (execute): 13:54:21.704266 => 13:54:21.704279
[0m13:54:21.706314 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.not_null_stg_raw_staging__accounts_account_id.c6fceee87c
[0m13:54:21.707752 [debug] [Thread-1 (]: Began running node test.vg_casestudy.not_null_stg_raw_staging__accounts_account_type.298c80ded4
[0m13:54:21.710019 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.not_null_stg_raw_staging__accounts_account_id.c6fceee87c, now test.vg_casestudy.not_null_stg_raw_staging__accounts_account_type.298c80ded4)
[0m13:54:21.711112 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.not_null_stg_raw_staging__accounts_account_type.298c80ded4
[0m13:54:21.718359 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.not_null_stg_raw_staging__accounts_account_type.298c80ded4"
[0m13:54:21.719531 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_stg_raw_staging__accounts_account_type.298c80ded4 (compile): 13:54:21.712009 => 13:54:21.719046
[0m13:54:21.720127 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.not_null_stg_raw_staging__accounts_account_type.298c80ded4
[0m13:54:21.720755 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_stg_raw_staging__accounts_account_type.298c80ded4 (execute): 13:54:21.720484 => 13:54:21.720496
[0m13:54:21.722232 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.not_null_stg_raw_staging__accounts_account_type.298c80ded4
[0m13:54:21.723027 [debug] [Thread-1 (]: Began running node test.vg_casestudy.not_null_stg_raw_staging__accounts_customer_id.99ecced993
[0m13:54:21.724290 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.not_null_stg_raw_staging__accounts_account_type.298c80ded4, now test.vg_casestudy.not_null_stg_raw_staging__accounts_customer_id.99ecced993)
[0m13:54:21.724844 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.not_null_stg_raw_staging__accounts_customer_id.99ecced993
[0m13:54:21.733420 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.not_null_stg_raw_staging__accounts_customer_id.99ecced993"
[0m13:54:21.734528 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_stg_raw_staging__accounts_customer_id.99ecced993 (compile): 13:54:21.725176 => 13:54:21.734139
[0m13:54:21.735124 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.not_null_stg_raw_staging__accounts_customer_id.99ecced993
[0m13:54:21.735824 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_stg_raw_staging__accounts_customer_id.99ecced993 (execute): 13:54:21.735569 => 13:54:21.735582
[0m13:54:21.737060 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.not_null_stg_raw_staging__accounts_customer_id.99ecced993
[0m13:54:21.737811 [debug] [Thread-1 (]: Began running node test.vg_casestudy.unique_stg_raw_staging__accounts_account_id.cfe13a9c67
[0m13:54:21.738788 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.not_null_stg_raw_staging__accounts_customer_id.99ecced993, now test.vg_casestudy.unique_stg_raw_staging__accounts_account_id.cfe13a9c67)
[0m13:54:21.739397 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.unique_stg_raw_staging__accounts_account_id.cfe13a9c67
[0m13:54:21.752888 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.unique_stg_raw_staging__accounts_account_id.cfe13a9c67"
[0m13:54:21.754396 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.unique_stg_raw_staging__accounts_account_id.cfe13a9c67 (compile): 13:54:21.739848 => 13:54:21.753944
[0m13:54:21.755123 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.unique_stg_raw_staging__accounts_account_id.cfe13a9c67
[0m13:54:21.756003 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.unique_stg_raw_staging__accounts_account_id.cfe13a9c67 (execute): 13:54:21.755702 => 13:54:21.755714
[0m13:54:21.757511 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.unique_stg_raw_staging__accounts_account_id.cfe13a9c67
[0m13:54:21.758187 [debug] [Thread-1 (]: Began running node model.vg_casestudy.stg_staging_intermediate__customers
[0m13:54:21.759818 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.unique_stg_raw_staging__accounts_account_id.cfe13a9c67, now model.vg_casestudy.stg_staging_intermediate__customers)
[0m13:54:21.761103 [debug] [Thread-1 (]: Began compiling node model.vg_casestudy.stg_staging_intermediate__customers
[0m13:54:21.766557 [debug] [Thread-1 (]: Writing injected SQL for node "model.vg_casestudy.stg_staging_intermediate__customers"
[0m13:54:21.767702 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.stg_staging_intermediate__customers (compile): 13:54:21.761927 => 13:54:21.767325
[0m13:54:21.768355 [debug] [Thread-1 (]: Began executing node model.vg_casestudy.stg_staging_intermediate__customers
[0m13:54:21.769086 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.stg_staging_intermediate__customers (execute): 13:54:21.768823 => 13:54:21.768837
[0m13:54:21.770529 [debug] [Thread-1 (]: Finished running node model.vg_casestudy.stg_staging_intermediate__customers
[0m13:54:21.771365 [debug] [Thread-1 (]: Began running node test.vg_casestudy.not_null_stg_raw_staging__customers_age.402d2aacc9
[0m13:54:21.772417 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.vg_casestudy.stg_staging_intermediate__customers, now test.vg_casestudy.not_null_stg_raw_staging__customers_age.402d2aacc9)
[0m13:54:21.773182 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.not_null_stg_raw_staging__customers_age.402d2aacc9
[0m13:54:21.781610 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.not_null_stg_raw_staging__customers_age.402d2aacc9"
[0m13:54:21.782914 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_stg_raw_staging__customers_age.402d2aacc9 (compile): 13:54:21.773594 => 13:54:21.782451
[0m13:54:21.783659 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.not_null_stg_raw_staging__customers_age.402d2aacc9
[0m13:54:21.784480 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_stg_raw_staging__customers_age.402d2aacc9 (execute): 13:54:21.784154 => 13:54:21.784167
[0m13:54:21.786010 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.not_null_stg_raw_staging__customers_age.402d2aacc9
[0m13:54:21.786871 [debug] [Thread-1 (]: Began running node test.vg_casestudy.not_null_stg_raw_staging__customers_branch_id.96cc924db7
[0m13:54:21.788281 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.not_null_stg_raw_staging__customers_age.402d2aacc9, now test.vg_casestudy.not_null_stg_raw_staging__customers_branch_id.96cc924db7)
[0m13:54:21.788865 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.not_null_stg_raw_staging__customers_branch_id.96cc924db7
[0m13:54:21.800726 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.not_null_stg_raw_staging__customers_branch_id.96cc924db7"
[0m13:54:21.802106 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_stg_raw_staging__customers_branch_id.96cc924db7 (compile): 13:54:21.789335 => 13:54:21.801621
[0m13:54:21.802772 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.not_null_stg_raw_staging__customers_branch_id.96cc924db7
[0m13:54:21.803412 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_stg_raw_staging__customers_branch_id.96cc924db7 (execute): 13:54:21.803171 => 13:54:21.803183
[0m13:54:21.804749 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.not_null_stg_raw_staging__customers_branch_id.96cc924db7
[0m13:54:21.805376 [debug] [Thread-1 (]: Began running node test.vg_casestudy.not_null_stg_raw_staging__customers_customer_id.d27d30a04a
[0m13:54:21.806630 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.not_null_stg_raw_staging__customers_branch_id.96cc924db7, now test.vg_casestudy.not_null_stg_raw_staging__customers_customer_id.d27d30a04a)
[0m13:54:21.807369 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.not_null_stg_raw_staging__customers_customer_id.d27d30a04a
[0m13:54:21.818016 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.not_null_stg_raw_staging__customers_customer_id.d27d30a04a"
[0m13:54:21.819072 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_stg_raw_staging__customers_customer_id.d27d30a04a (compile): 13:54:21.807870 => 13:54:21.818745
[0m13:54:21.819738 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.not_null_stg_raw_staging__customers_customer_id.d27d30a04a
[0m13:54:21.820349 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_stg_raw_staging__customers_customer_id.d27d30a04a (execute): 13:54:21.820106 => 13:54:21.820118
[0m13:54:21.821662 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.not_null_stg_raw_staging__customers_customer_id.d27d30a04a
[0m13:54:21.822278 [debug] [Thread-1 (]: Began running node test.vg_casestudy.numeric_range_stg_raw_staging__customers_age__200__18.2b9231d3a8
[0m13:54:21.823299 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.not_null_stg_raw_staging__customers_customer_id.d27d30a04a, now test.vg_casestudy.numeric_range_stg_raw_staging__customers_age__200__18.2b9231d3a8)
[0m13:54:21.824313 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.numeric_range_stg_raw_staging__customers_age__200__18.2b9231d3a8
[0m13:54:21.837933 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.numeric_range_stg_raw_staging__customers_age__200__18.2b9231d3a8"
[0m13:54:21.839024 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.numeric_range_stg_raw_staging__customers_age__200__18.2b9231d3a8 (compile): 13:54:21.824981 => 13:54:21.838710
[0m13:54:21.839862 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.numeric_range_stg_raw_staging__customers_age__200__18.2b9231d3a8
[0m13:54:21.840720 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.numeric_range_stg_raw_staging__customers_age__200__18.2b9231d3a8 (execute): 13:54:21.840428 => 13:54:21.840441
[0m13:54:21.842431 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.numeric_range_stg_raw_staging__customers_age__200__18.2b9231d3a8
[0m13:54:21.843657 [debug] [Thread-1 (]: Began running node test.vg_casestudy.relationships_stg_raw_staging__accounts_customer_id__customer_id__ref_stg_raw_staging__customers_.87454c2c4c
[0m13:54:21.845454 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.numeric_range_stg_raw_staging__customers_age__200__18.2b9231d3a8, now test.vg_casestudy.relationships_stg_raw_staging__accounts_customer_id__customer_id__ref_stg_raw_staging__customers_.87454c2c4c)
[0m13:54:21.846308 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.relationships_stg_raw_staging__accounts_customer_id__customer_id__ref_stg_raw_staging__customers_.87454c2c4c
[0m13:54:21.862873 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.relationships_stg_raw_staging__accounts_customer_id__customer_id__ref_stg_raw_staging__customers_.87454c2c4c"
[0m13:54:21.864173 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.relationships_stg_raw_staging__accounts_customer_id__customer_id__ref_stg_raw_staging__customers_.87454c2c4c (compile): 13:54:21.846721 => 13:54:21.863618
[0m13:54:21.865024 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.relationships_stg_raw_staging__accounts_customer_id__customer_id__ref_stg_raw_staging__customers_.87454c2c4c
[0m13:54:21.865976 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.relationships_stg_raw_staging__accounts_customer_id__customer_id__ref_stg_raw_staging__customers_.87454c2c4c (execute): 13:54:21.865658 => 13:54:21.865673
[0m13:54:21.867479 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.relationships_stg_raw_staging__accounts_customer_id__customer_id__ref_stg_raw_staging__customers_.87454c2c4c
[0m13:54:21.868338 [debug] [Thread-1 (]: Began running node test.vg_casestudy.unique_stg_raw_staging__customers_customer_id.8cd8e9afb0
[0m13:54:21.869584 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.relationships_stg_raw_staging__accounts_customer_id__customer_id__ref_stg_raw_staging__customers_.87454c2c4c, now test.vg_casestudy.unique_stg_raw_staging__customers_customer_id.8cd8e9afb0)
[0m13:54:21.870802 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.unique_stg_raw_staging__customers_customer_id.8cd8e9afb0
[0m13:54:21.879124 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.unique_stg_raw_staging__customers_customer_id.8cd8e9afb0"
[0m13:54:21.880647 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.unique_stg_raw_staging__customers_customer_id.8cd8e9afb0 (compile): 13:54:21.871495 => 13:54:21.880229
[0m13:54:21.881612 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.unique_stg_raw_staging__customers_customer_id.8cd8e9afb0
[0m13:54:21.882543 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.unique_stg_raw_staging__customers_customer_id.8cd8e9afb0 (execute): 13:54:21.882207 => 13:54:21.882227
[0m13:54:21.884077 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.unique_stg_raw_staging__customers_customer_id.8cd8e9afb0
[0m13:54:21.884795 [debug] [Thread-1 (]: Began running node model.vg_casestudy.stg_staging_intermediate__fx_rates
[0m13:54:21.886276 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.unique_stg_raw_staging__customers_customer_id.8cd8e9afb0, now model.vg_casestudy.stg_staging_intermediate__fx_rates)
[0m13:54:21.887293 [debug] [Thread-1 (]: Began compiling node model.vg_casestudy.stg_staging_intermediate__fx_rates
[0m13:54:21.892046 [debug] [Thread-1 (]: Writing injected SQL for node "model.vg_casestudy.stg_staging_intermediate__fx_rates"
[0m13:54:21.893616 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.stg_staging_intermediate__fx_rates (compile): 13:54:21.887769 => 13:54:21.893082
[0m13:54:21.894604 [debug] [Thread-1 (]: Began executing node model.vg_casestudy.stg_staging_intermediate__fx_rates
[0m13:54:21.895324 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.stg_staging_intermediate__fx_rates (execute): 13:54:21.895065 => 13:54:21.895078
[0m13:54:21.896891 [debug] [Thread-1 (]: Finished running node model.vg_casestudy.stg_staging_intermediate__fx_rates
[0m13:54:21.897551 [debug] [Thread-1 (]: Began running node test.vg_casestudy.date_is_past_stg_raw_staging__fx_rates_fx_rate_date.7b2c6986f5
[0m13:54:21.898471 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.vg_casestudy.stg_staging_intermediate__fx_rates, now test.vg_casestudy.date_is_past_stg_raw_staging__fx_rates_fx_rate_date.7b2c6986f5)
[0m13:54:21.899652 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.date_is_past_stg_raw_staging__fx_rates_fx_rate_date.7b2c6986f5
[0m13:54:21.906869 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.date_is_past_stg_raw_staging__fx_rates_fx_rate_date.7b2c6986f5"
[0m13:54:21.908062 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.date_is_past_stg_raw_staging__fx_rates_fx_rate_date.7b2c6986f5 (compile): 13:54:21.900142 => 13:54:21.907748
[0m13:54:21.908610 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.date_is_past_stg_raw_staging__fx_rates_fx_rate_date.7b2c6986f5
[0m13:54:21.909569 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.date_is_past_stg_raw_staging__fx_rates_fx_rate_date.7b2c6986f5 (execute): 13:54:21.909122 => 13:54:21.909140
[0m13:54:21.911807 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.date_is_past_stg_raw_staging__fx_rates_fx_rate_date.7b2c6986f5
[0m13:54:21.912534 [debug] [Thread-1 (]: Began running node test.vg_casestudy.not_null_stg_raw_staging__fx_rates_currency_iso_code.6d09bdebaf
[0m13:54:21.913674 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.date_is_past_stg_raw_staging__fx_rates_fx_rate_date.7b2c6986f5, now test.vg_casestudy.not_null_stg_raw_staging__fx_rates_currency_iso_code.6d09bdebaf)
[0m13:54:21.914447 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.not_null_stg_raw_staging__fx_rates_currency_iso_code.6d09bdebaf
[0m13:54:21.922045 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.not_null_stg_raw_staging__fx_rates_currency_iso_code.6d09bdebaf"
[0m13:54:21.923668 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_stg_raw_staging__fx_rates_currency_iso_code.6d09bdebaf (compile): 13:54:21.914895 => 13:54:21.923204
[0m13:54:21.924283 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.not_null_stg_raw_staging__fx_rates_currency_iso_code.6d09bdebaf
[0m13:54:21.925030 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_stg_raw_staging__fx_rates_currency_iso_code.6d09bdebaf (execute): 13:54:21.924750 => 13:54:21.924764
[0m13:54:21.926874 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.not_null_stg_raw_staging__fx_rates_currency_iso_code.6d09bdebaf
[0m13:54:21.928029 [debug] [Thread-1 (]: Began running node test.vg_casestudy.not_null_stg_raw_staging__fx_rates_fx_rate.1c32f22fac
[0m13:54:21.929507 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.not_null_stg_raw_staging__fx_rates_currency_iso_code.6d09bdebaf, now test.vg_casestudy.not_null_stg_raw_staging__fx_rates_fx_rate.1c32f22fac)
[0m13:54:21.930112 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.not_null_stg_raw_staging__fx_rates_fx_rate.1c32f22fac
[0m13:54:21.938448 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.not_null_stg_raw_staging__fx_rates_fx_rate.1c32f22fac"
[0m13:54:21.939717 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_stg_raw_staging__fx_rates_fx_rate.1c32f22fac (compile): 13:54:21.930481 => 13:54:21.939312
[0m13:54:21.940504 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.not_null_stg_raw_staging__fx_rates_fx_rate.1c32f22fac
[0m13:54:21.941316 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_stg_raw_staging__fx_rates_fx_rate.1c32f22fac (execute): 13:54:21.940972 => 13:54:21.940988
[0m13:54:21.943444 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.not_null_stg_raw_staging__fx_rates_fx_rate.1c32f22fac
[0m13:54:21.944910 [debug] [Thread-1 (]: Began running node test.vg_casestudy.not_null_stg_raw_staging__fx_rates_has_date_parsing_error.2f51154c3b
[0m13:54:21.946611 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.not_null_stg_raw_staging__fx_rates_fx_rate.1c32f22fac, now test.vg_casestudy.not_null_stg_raw_staging__fx_rates_has_date_parsing_error.2f51154c3b)
[0m13:54:21.947383 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.not_null_stg_raw_staging__fx_rates_has_date_parsing_error.2f51154c3b
[0m13:54:21.954623 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.not_null_stg_raw_staging__fx_rates_has_date_parsing_error.2f51154c3b"
[0m13:54:21.955695 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_stg_raw_staging__fx_rates_has_date_parsing_error.2f51154c3b (compile): 13:54:21.947934 => 13:54:21.955336
[0m13:54:21.956297 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.not_null_stg_raw_staging__fx_rates_has_date_parsing_error.2f51154c3b
[0m13:54:21.957098 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_stg_raw_staging__fx_rates_has_date_parsing_error.2f51154c3b (execute): 13:54:21.956819 => 13:54:21.956832
[0m13:54:21.958719 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.not_null_stg_raw_staging__fx_rates_has_date_parsing_error.2f51154c3b
[0m13:54:21.959768 [debug] [Thread-1 (]: Began running node test.vg_casestudy.numeric_range_stg_raw_staging__fx_rates_fx_rate__0.ccd53e1d91
[0m13:54:21.963114 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.not_null_stg_raw_staging__fx_rates_has_date_parsing_error.2f51154c3b, now test.vg_casestudy.numeric_range_stg_raw_staging__fx_rates_fx_rate__0.ccd53e1d91)
[0m13:54:21.965253 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.numeric_range_stg_raw_staging__fx_rates_fx_rate__0.ccd53e1d91
[0m13:54:21.978131 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.numeric_range_stg_raw_staging__fx_rates_fx_rate__0.ccd53e1d91"
[0m13:54:21.979549 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.numeric_range_stg_raw_staging__fx_rates_fx_rate__0.ccd53e1d91 (compile): 13:54:21.968537 => 13:54:21.979175
[0m13:54:21.980311 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.numeric_range_stg_raw_staging__fx_rates_fx_rate__0.ccd53e1d91
[0m13:54:21.980948 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.numeric_range_stg_raw_staging__fx_rates_fx_rate__0.ccd53e1d91 (execute): 13:54:21.980693 => 13:54:21.980705
[0m13:54:21.982484 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.numeric_range_stg_raw_staging__fx_rates_fx_rate__0.ccd53e1d91
[0m13:54:21.983319 [debug] [Thread-1 (]: Began running node test.vg_casestudy.unique_stg_raw_staging__fx_rates_currency_iso_code.b1e6b26758
[0m13:54:21.984595 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.numeric_range_stg_raw_staging__fx_rates_fx_rate__0.ccd53e1d91, now test.vg_casestudy.unique_stg_raw_staging__fx_rates_currency_iso_code.b1e6b26758)
[0m13:54:21.985141 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.unique_stg_raw_staging__fx_rates_currency_iso_code.b1e6b26758
[0m13:54:21.992076 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.unique_stg_raw_staging__fx_rates_currency_iso_code.b1e6b26758"
[0m13:54:21.993668 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.unique_stg_raw_staging__fx_rates_currency_iso_code.b1e6b26758 (compile): 13:54:21.985704 => 13:54:21.993060
[0m13:54:21.994793 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.unique_stg_raw_staging__fx_rates_currency_iso_code.b1e6b26758
[0m13:54:21.995725 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.unique_stg_raw_staging__fx_rates_currency_iso_code.b1e6b26758 (execute): 13:54:21.995347 => 13:54:21.995361
[0m13:54:21.997169 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.unique_stg_raw_staging__fx_rates_currency_iso_code.b1e6b26758
[0m13:54:21.997858 [debug] [Thread-1 (]: Began running node model.vg_casestudy.stg_staging_intermediate__loans
[0m13:54:21.998999 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.unique_stg_raw_staging__fx_rates_currency_iso_code.b1e6b26758, now model.vg_casestudy.stg_staging_intermediate__loans)
[0m13:54:21.999713 [debug] [Thread-1 (]: Began compiling node model.vg_casestudy.stg_staging_intermediate__loans
[0m13:54:22.004421 [debug] [Thread-1 (]: Writing injected SQL for node "model.vg_casestudy.stg_staging_intermediate__loans"
[0m13:54:22.005487 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.stg_staging_intermediate__loans (compile): 13:54:22.000092 => 13:54:22.005137
[0m13:54:22.006047 [debug] [Thread-1 (]: Began executing node model.vg_casestudy.stg_staging_intermediate__loans
[0m13:54:22.006644 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.stg_staging_intermediate__loans (execute): 13:54:22.006406 => 13:54:22.006418
[0m13:54:22.007924 [debug] [Thread-1 (]: Finished running node model.vg_casestudy.stg_staging_intermediate__loans
[0m13:54:22.008571 [debug] [Thread-1 (]: Began running node test.vg_casestudy.accepted_values_stg_raw_staging__loans_loan_status__approved__rejected__closed.667473d6c1
[0m13:54:22.011505 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.vg_casestudy.stg_staging_intermediate__loans, now test.vg_casestudy.accepted_values_stg_raw_staging__loans_loan_status__approved__rejected__closed.667473d6c1)
[0m13:54:22.012526 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.accepted_values_stg_raw_staging__loans_loan_status__approved__rejected__closed.667473d6c1
[0m13:54:22.022452 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.accepted_values_stg_raw_staging__loans_loan_status__approved__rejected__closed.667473d6c1"
[0m13:54:22.023971 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.accepted_values_stg_raw_staging__loans_loan_status__approved__rejected__closed.667473d6c1 (compile): 13:54:22.013147 => 13:54:22.023285
[0m13:54:22.024753 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.accepted_values_stg_raw_staging__loans_loan_status__approved__rejected__closed.667473d6c1
[0m13:54:22.027844 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.accepted_values_stg_raw_staging__loans_loan_status__approved__rejected__closed.667473d6c1 (execute): 13:54:22.025151 => 13:54:22.025163
[0m13:54:22.030017 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.accepted_values_stg_raw_staging__loans_loan_status__approved__rejected__closed.667473d6c1
[0m13:54:22.031010 [debug] [Thread-1 (]: Began running node test.vg_casestudy.accepted_values_stg_raw_staging__loans_loan_term__12__24__36__48__60.88d346fe3c
[0m13:54:22.032393 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.accepted_values_stg_raw_staging__loans_loan_status__approved__rejected__closed.667473d6c1, now test.vg_casestudy.accepted_values_stg_raw_staging__loans_loan_term__12__24__36__48__60.88d346fe3c)
[0m13:54:22.033296 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.accepted_values_stg_raw_staging__loans_loan_term__12__24__36__48__60.88d346fe3c
[0m13:54:22.045492 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.accepted_values_stg_raw_staging__loans_loan_term__12__24__36__48__60.88d346fe3c"
[0m13:54:22.047055 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.accepted_values_stg_raw_staging__loans_loan_term__12__24__36__48__60.88d346fe3c (compile): 13:54:22.033921 => 13:54:22.046607
[0m13:54:22.047955 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.accepted_values_stg_raw_staging__loans_loan_term__12__24__36__48__60.88d346fe3c
[0m13:54:22.048900 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.accepted_values_stg_raw_staging__loans_loan_term__12__24__36__48__60.88d346fe3c (execute): 13:54:22.048552 => 13:54:22.048568
[0m13:54:22.050365 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.accepted_values_stg_raw_staging__loans_loan_term__12__24__36__48__60.88d346fe3c
[0m13:54:22.051090 [debug] [Thread-1 (]: Began running node test.vg_casestudy.accepted_values_stg_raw_staging__loans_loan_type__personal__mortgage__auto.f98f448e68
[0m13:54:22.052426 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.accepted_values_stg_raw_staging__loans_loan_term__12__24__36__48__60.88d346fe3c, now test.vg_casestudy.accepted_values_stg_raw_staging__loans_loan_type__personal__mortgage__auto.f98f448e68)
[0m13:54:22.053245 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.accepted_values_stg_raw_staging__loans_loan_type__personal__mortgage__auto.f98f448e68
[0m13:54:22.065122 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.accepted_values_stg_raw_staging__loans_loan_type__personal__mortgage__auto.f98f448e68"
[0m13:54:22.066510 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.accepted_values_stg_raw_staging__loans_loan_type__personal__mortgage__auto.f98f448e68 (compile): 13:54:22.053734 => 13:54:22.066028
[0m13:54:22.067312 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.accepted_values_stg_raw_staging__loans_loan_type__personal__mortgage__auto.f98f448e68
[0m13:54:22.068250 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.accepted_values_stg_raw_staging__loans_loan_type__personal__mortgage__auto.f98f448e68 (execute): 13:54:22.067881 => 13:54:22.067900
[0m13:54:22.070167 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.accepted_values_stg_raw_staging__loans_loan_type__personal__mortgage__auto.f98f448e68
[0m13:54:22.071268 [debug] [Thread-1 (]: Began running node test.vg_casestudy.date_is_past_stg_raw_staging__loans_approval_rejection_date.92db02c0aa
[0m13:54:22.072635 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.accepted_values_stg_raw_staging__loans_loan_type__personal__mortgage__auto.f98f448e68, now test.vg_casestudy.date_is_past_stg_raw_staging__loans_approval_rejection_date.92db02c0aa)
[0m13:54:22.073444 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.date_is_past_stg_raw_staging__loans_approval_rejection_date.92db02c0aa
[0m13:54:22.083192 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.date_is_past_stg_raw_staging__loans_approval_rejection_date.92db02c0aa"
[0m13:54:22.084281 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.date_is_past_stg_raw_staging__loans_approval_rejection_date.92db02c0aa (compile): 13:54:22.074073 => 13:54:22.083948
[0m13:54:22.084867 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.date_is_past_stg_raw_staging__loans_approval_rejection_date.92db02c0aa
[0m13:54:22.085591 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.date_is_past_stg_raw_staging__loans_approval_rejection_date.92db02c0aa (execute): 13:54:22.085305 => 13:54:22.085317
[0m13:54:22.087205 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.date_is_past_stg_raw_staging__loans_approval_rejection_date.92db02c0aa
[0m13:54:22.088350 [debug] [Thread-1 (]: Began running node test.vg_casestudy.not_null_stg_raw_staging__loans_approval_rejection_date.6c82d62e88
[0m13:54:22.089665 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.date_is_past_stg_raw_staging__loans_approval_rejection_date.92db02c0aa, now test.vg_casestudy.not_null_stg_raw_staging__loans_approval_rejection_date.6c82d62e88)
[0m13:54:22.090363 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.not_null_stg_raw_staging__loans_approval_rejection_date.6c82d62e88
[0m13:54:22.098492 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.not_null_stg_raw_staging__loans_approval_rejection_date.6c82d62e88"
[0m13:54:22.099552 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_stg_raw_staging__loans_approval_rejection_date.6c82d62e88 (compile): 13:54:22.090756 => 13:54:22.099206
[0m13:54:22.100129 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.not_null_stg_raw_staging__loans_approval_rejection_date.6c82d62e88
[0m13:54:22.100735 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_stg_raw_staging__loans_approval_rejection_date.6c82d62e88 (execute): 13:54:22.100499 => 13:54:22.100510
[0m13:54:22.102569 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.not_null_stg_raw_staging__loans_approval_rejection_date.6c82d62e88
[0m13:54:22.103501 [debug] [Thread-1 (]: Began running node test.vg_casestudy.not_null_stg_raw_staging__loans_interest_rate.af6bbce27a
[0m13:54:22.104723 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.not_null_stg_raw_staging__loans_approval_rejection_date.6c82d62e88, now test.vg_casestudy.not_null_stg_raw_staging__loans_interest_rate.af6bbce27a)
[0m13:54:22.105429 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.not_null_stg_raw_staging__loans_interest_rate.af6bbce27a
[0m13:54:22.114112 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.not_null_stg_raw_staging__loans_interest_rate.af6bbce27a"
[0m13:54:22.115169 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_stg_raw_staging__loans_interest_rate.af6bbce27a (compile): 13:54:22.105939 => 13:54:22.114822
[0m13:54:22.115726 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.not_null_stg_raw_staging__loans_interest_rate.af6bbce27a
[0m13:54:22.116345 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_stg_raw_staging__loans_interest_rate.af6bbce27a (execute): 13:54:22.116094 => 13:54:22.116106
[0m13:54:22.117716 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.not_null_stg_raw_staging__loans_interest_rate.af6bbce27a
[0m13:54:22.118440 [debug] [Thread-1 (]: Began running node test.vg_casestudy.not_null_stg_raw_staging__loans_loan_amount.9143c49752
[0m13:54:22.119593 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.not_null_stg_raw_staging__loans_interest_rate.af6bbce27a, now test.vg_casestudy.not_null_stg_raw_staging__loans_loan_amount.9143c49752)
[0m13:54:22.120169 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.not_null_stg_raw_staging__loans_loan_amount.9143c49752
[0m13:54:22.132092 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.not_null_stg_raw_staging__loans_loan_amount.9143c49752"
[0m13:54:22.133475 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_stg_raw_staging__loans_loan_amount.9143c49752 (compile): 13:54:22.120554 => 13:54:22.133031
[0m13:54:22.134075 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.not_null_stg_raw_staging__loans_loan_amount.9143c49752
[0m13:54:22.134702 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_stg_raw_staging__loans_loan_amount.9143c49752 (execute): 13:54:22.134448 => 13:54:22.134460
[0m13:54:22.136021 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.not_null_stg_raw_staging__loans_loan_amount.9143c49752
[0m13:54:22.136634 [debug] [Thread-1 (]: Began running node test.vg_casestudy.not_null_stg_raw_staging__loans_loan_id.2434a0af3b
[0m13:54:22.138078 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.not_null_stg_raw_staging__loans_loan_amount.9143c49752, now test.vg_casestudy.not_null_stg_raw_staging__loans_loan_id.2434a0af3b)
[0m13:54:22.138759 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.not_null_stg_raw_staging__loans_loan_id.2434a0af3b
[0m13:54:22.147298 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.not_null_stg_raw_staging__loans_loan_id.2434a0af3b"
[0m13:54:22.148727 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_stg_raw_staging__loans_loan_id.2434a0af3b (compile): 13:54:22.139131 => 13:54:22.148289
[0m13:54:22.149472 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.not_null_stg_raw_staging__loans_loan_id.2434a0af3b
[0m13:54:22.150252 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_stg_raw_staging__loans_loan_id.2434a0af3b (execute): 13:54:22.149941 => 13:54:22.149956
[0m13:54:22.151840 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.not_null_stg_raw_staging__loans_loan_id.2434a0af3b
[0m13:54:22.152734 [debug] [Thread-1 (]: Began running node test.vg_casestudy.not_null_stg_raw_staging__loans_loan_status.f4d3276dbd
[0m13:54:22.153895 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.not_null_stg_raw_staging__loans_loan_id.2434a0af3b, now test.vg_casestudy.not_null_stg_raw_staging__loans_loan_status.f4d3276dbd)
[0m13:54:22.154600 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.not_null_stg_raw_staging__loans_loan_status.f4d3276dbd
[0m13:54:22.163390 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.not_null_stg_raw_staging__loans_loan_status.f4d3276dbd"
[0m13:54:22.164854 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_stg_raw_staging__loans_loan_status.f4d3276dbd (compile): 13:54:22.154995 => 13:54:22.164372
[0m13:54:22.165625 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.not_null_stg_raw_staging__loans_loan_status.f4d3276dbd
[0m13:54:22.166342 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_stg_raw_staging__loans_loan_status.f4d3276dbd (execute): 13:54:22.166062 => 13:54:22.166076
[0m13:54:22.167790 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.not_null_stg_raw_staging__loans_loan_status.f4d3276dbd
[0m13:54:22.168428 [debug] [Thread-1 (]: Began running node test.vg_casestudy.not_null_stg_raw_staging__loans_loan_term.53fc5904d6
[0m13:54:22.169788 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.not_null_stg_raw_staging__loans_loan_status.f4d3276dbd, now test.vg_casestudy.not_null_stg_raw_staging__loans_loan_term.53fc5904d6)
[0m13:54:22.170385 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.not_null_stg_raw_staging__loans_loan_term.53fc5904d6
[0m13:54:22.180302 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.not_null_stg_raw_staging__loans_loan_term.53fc5904d6"
[0m13:54:22.181830 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_stg_raw_staging__loans_loan_term.53fc5904d6 (compile): 13:54:22.170770 => 13:54:22.181347
[0m13:54:22.182720 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.not_null_stg_raw_staging__loans_loan_term.53fc5904d6
[0m13:54:22.183682 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_stg_raw_staging__loans_loan_term.53fc5904d6 (execute): 13:54:22.183228 => 13:54:22.183245
[0m13:54:22.185075 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.not_null_stg_raw_staging__loans_loan_term.53fc5904d6
[0m13:54:22.185920 [debug] [Thread-1 (]: Began running node test.vg_casestudy.not_null_stg_raw_staging__loans_loan_type.a3d87b38a0
[0m13:54:22.187069 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.not_null_stg_raw_staging__loans_loan_term.53fc5904d6, now test.vg_casestudy.not_null_stg_raw_staging__loans_loan_type.a3d87b38a0)
[0m13:54:22.187996 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.not_null_stg_raw_staging__loans_loan_type.a3d87b38a0
[0m13:54:22.196416 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.not_null_stg_raw_staging__loans_loan_type.a3d87b38a0"
[0m13:54:22.197696 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_stg_raw_staging__loans_loan_type.a3d87b38a0 (compile): 13:54:22.188430 => 13:54:22.197210
[0m13:54:22.198358 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.not_null_stg_raw_staging__loans_loan_type.a3d87b38a0
[0m13:54:22.199040 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_stg_raw_staging__loans_loan_type.a3d87b38a0 (execute): 13:54:22.198732 => 13:54:22.198744
[0m13:54:22.200427 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.not_null_stg_raw_staging__loans_loan_type.a3d87b38a0
[0m13:54:22.201095 [debug] [Thread-1 (]: Began running node test.vg_casestudy.numeric_range_stg_raw_staging__loans_interest_rate__0.c62529af67
[0m13:54:22.202344 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.not_null_stg_raw_staging__loans_loan_type.a3d87b38a0, now test.vg_casestudy.numeric_range_stg_raw_staging__loans_interest_rate__0.c62529af67)
[0m13:54:22.203142 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.numeric_range_stg_raw_staging__loans_interest_rate__0.c62529af67
[0m13:54:22.210527 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.numeric_range_stg_raw_staging__loans_interest_rate__0.c62529af67"
[0m13:54:22.212095 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.numeric_range_stg_raw_staging__loans_interest_rate__0.c62529af67 (compile): 13:54:22.203522 => 13:54:22.211590
[0m13:54:22.212779 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.numeric_range_stg_raw_staging__loans_interest_rate__0.c62529af67
[0m13:54:22.213426 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.numeric_range_stg_raw_staging__loans_interest_rate__0.c62529af67 (execute): 13:54:22.213173 => 13:54:22.213185
[0m13:54:22.214783 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.numeric_range_stg_raw_staging__loans_interest_rate__0.c62529af67
[0m13:54:22.215426 [debug] [Thread-1 (]: Began running node test.vg_casestudy.numeric_range_stg_raw_staging__loans_loan_amount__0.d8b44433a4
[0m13:54:22.216656 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.numeric_range_stg_raw_staging__loans_interest_rate__0.c62529af67, now test.vg_casestudy.numeric_range_stg_raw_staging__loans_loan_amount__0.d8b44433a4)
[0m13:54:22.217277 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.numeric_range_stg_raw_staging__loans_loan_amount__0.d8b44433a4
[0m13:54:22.224109 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.numeric_range_stg_raw_staging__loans_loan_amount__0.d8b44433a4"
[0m13:54:22.225444 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.numeric_range_stg_raw_staging__loans_loan_amount__0.d8b44433a4 (compile): 13:54:22.217685 => 13:54:22.224971
[0m13:54:22.226421 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.numeric_range_stg_raw_staging__loans_loan_amount__0.d8b44433a4
[0m13:54:22.227727 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.numeric_range_stg_raw_staging__loans_loan_amount__0.d8b44433a4 (execute): 13:54:22.227093 => 13:54:22.227114
[0m13:54:22.230013 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.numeric_range_stg_raw_staging__loans_loan_amount__0.d8b44433a4
[0m13:54:22.230853 [debug] [Thread-1 (]: Began running node test.vg_casestudy.unique_stg_raw_staging__loans_loan_id.fdf57e988a
[0m13:54:22.232566 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.numeric_range_stg_raw_staging__loans_loan_amount__0.d8b44433a4, now test.vg_casestudy.unique_stg_raw_staging__loans_loan_id.fdf57e988a)
[0m13:54:22.233196 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.unique_stg_raw_staging__loans_loan_id.fdf57e988a
[0m13:54:22.240155 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.unique_stg_raw_staging__loans_loan_id.fdf57e988a"
[0m13:54:22.241361 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.unique_stg_raw_staging__loans_loan_id.fdf57e988a (compile): 13:54:22.233635 => 13:54:22.240848
[0m13:54:22.242153 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.unique_stg_raw_staging__loans_loan_id.fdf57e988a
[0m13:54:22.244032 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.unique_stg_raw_staging__loans_loan_id.fdf57e988a (execute): 13:54:22.243264 => 13:54:22.243298
[0m13:54:22.246449 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.unique_stg_raw_staging__loans_loan_id.fdf57e988a
[0m13:54:22.247587 [debug] [Thread-1 (]: Began running node model.vg_casestudy.stg_staging_intermediate__transactions
[0m13:54:22.249037 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.unique_stg_raw_staging__loans_loan_id.fdf57e988a, now model.vg_casestudy.stg_staging_intermediate__transactions)
[0m13:54:22.249734 [debug] [Thread-1 (]: Began compiling node model.vg_casestudy.stg_staging_intermediate__transactions
[0m13:54:22.254815 [debug] [Thread-1 (]: Writing injected SQL for node "model.vg_casestudy.stg_staging_intermediate__transactions"
[0m13:54:22.256239 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.stg_staging_intermediate__transactions (compile): 13:54:22.250120 => 13:54:22.255897
[0m13:54:22.256838 [debug] [Thread-1 (]: Began executing node model.vg_casestudy.stg_staging_intermediate__transactions
[0m13:54:22.257581 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.stg_staging_intermediate__transactions (execute): 13:54:22.257301 => 13:54:22.257314
[0m13:54:22.259325 [debug] [Thread-1 (]: Finished running node model.vg_casestudy.stg_staging_intermediate__transactions
[0m13:54:22.260988 [debug] [Thread-1 (]: Began running node test.vg_casestudy.accepted_values_stg_raw_staging__transactions_transaction_type__transfer__deposit__withdrawal.9d791cc0ee
[0m13:54:22.262888 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.vg_casestudy.stg_staging_intermediate__transactions, now test.vg_casestudy.accepted_values_stg_raw_staging__transactions_transaction_type__transfer__deposit__withdrawal.9d791cc0ee)
[0m13:54:22.263785 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.accepted_values_stg_raw_staging__transactions_transaction_type__transfer__deposit__withdrawal.9d791cc0ee
[0m13:54:22.280479 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.accepted_values_stg_raw_staging__transactions_transaction_type__transfer__deposit__withdrawal.9d791cc0ee"
[0m13:54:22.282545 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.accepted_values_stg_raw_staging__transactions_transaction_type__transfer__deposit__withdrawal.9d791cc0ee (compile): 13:54:22.264248 => 13:54:22.281952
[0m13:54:22.283342 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.accepted_values_stg_raw_staging__transactions_transaction_type__transfer__deposit__withdrawal.9d791cc0ee
[0m13:54:22.284139 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.accepted_values_stg_raw_staging__transactions_transaction_type__transfer__deposit__withdrawal.9d791cc0ee (execute): 13:54:22.283780 => 13:54:22.283795
[0m13:54:22.286876 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.accepted_values_stg_raw_staging__transactions_transaction_type__transfer__deposit__withdrawal.9d791cc0ee
[0m13:54:22.287917 [debug] [Thread-1 (]: Began running node test.vg_casestudy.not_null_stg_raw_staging__transactions_account_id.52f5c093d5
[0m13:54:22.289385 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.accepted_values_stg_raw_staging__transactions_transaction_type__transfer__deposit__withdrawal.9d791cc0ee, now test.vg_casestudy.not_null_stg_raw_staging__transactions_account_id.52f5c093d5)
[0m13:54:22.290190 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.not_null_stg_raw_staging__transactions_account_id.52f5c093d5
[0m13:54:22.298707 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.not_null_stg_raw_staging__transactions_account_id.52f5c093d5"
[0m13:54:22.299900 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_stg_raw_staging__transactions_account_id.52f5c093d5 (compile): 13:54:22.290720 => 13:54:22.299513
[0m13:54:22.300558 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.not_null_stg_raw_staging__transactions_account_id.52f5c093d5
[0m13:54:22.301530 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_stg_raw_staging__transactions_account_id.52f5c093d5 (execute): 13:54:22.301012 => 13:54:22.301025
[0m13:54:22.303608 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.not_null_stg_raw_staging__transactions_account_id.52f5c093d5
[0m13:54:22.304712 [debug] [Thread-1 (]: Began running node test.vg_casestudy.not_null_stg_raw_staging__transactions_transaction_id.ebc02c3793
[0m13:54:22.306077 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.not_null_stg_raw_staging__transactions_account_id.52f5c093d5, now test.vg_casestudy.not_null_stg_raw_staging__transactions_transaction_id.ebc02c3793)
[0m13:54:22.306716 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.not_null_stg_raw_staging__transactions_transaction_id.ebc02c3793
[0m13:54:22.314842 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.not_null_stg_raw_staging__transactions_transaction_id.ebc02c3793"
[0m13:54:22.316392 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_stg_raw_staging__transactions_transaction_id.ebc02c3793 (compile): 13:54:22.307107 => 13:54:22.315942
[0m13:54:22.316996 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.not_null_stg_raw_staging__transactions_transaction_id.ebc02c3793
[0m13:54:22.317637 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_stg_raw_staging__transactions_transaction_id.ebc02c3793 (execute): 13:54:22.317391 => 13:54:22.317403
[0m13:54:22.318902 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.not_null_stg_raw_staging__transactions_transaction_id.ebc02c3793
[0m13:54:22.319671 [debug] [Thread-1 (]: Began running node test.vg_casestudy.not_null_stg_raw_staging__transactions_transaction_type.29e6a629e0
[0m13:54:22.320818 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.not_null_stg_raw_staging__transactions_transaction_id.ebc02c3793, now test.vg_casestudy.not_null_stg_raw_staging__transactions_transaction_type.29e6a629e0)
[0m13:54:22.321626 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.not_null_stg_raw_staging__transactions_transaction_type.29e6a629e0
[0m13:54:22.331283 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.not_null_stg_raw_staging__transactions_transaction_type.29e6a629e0"
[0m13:54:22.332749 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_stg_raw_staging__transactions_transaction_type.29e6a629e0 (compile): 13:54:22.322149 => 13:54:22.332260
[0m13:54:22.333404 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.not_null_stg_raw_staging__transactions_transaction_type.29e6a629e0
[0m13:54:22.334358 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_stg_raw_staging__transactions_transaction_type.29e6a629e0 (execute): 13:54:22.333994 => 13:54:22.334008
[0m13:54:22.336302 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.not_null_stg_raw_staging__transactions_transaction_type.29e6a629e0
[0m13:54:22.337288 [debug] [Thread-1 (]: Began running node test.vg_casestudy.relationships_stg_raw_staging__transactions_account_id__account_id__ref_stg_raw_staging__accounts_.e5e3cbe1a6
[0m13:54:22.338726 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.not_null_stg_raw_staging__transactions_transaction_type.29e6a629e0, now test.vg_casestudy.relationships_stg_raw_staging__transactions_account_id__account_id__ref_stg_raw_staging__accounts_.e5e3cbe1a6)
[0m13:54:22.339588 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.relationships_stg_raw_staging__transactions_account_id__account_id__ref_stg_raw_staging__accounts_.e5e3cbe1a6
[0m13:54:22.352000 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.relationships_stg_raw_staging__transactions_account_id__account_id__ref_stg_raw_staging__accounts_.e5e3cbe1a6"
[0m13:54:22.353501 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.relationships_stg_raw_staging__transactions_account_id__account_id__ref_stg_raw_staging__accounts_.e5e3cbe1a6 (compile): 13:54:22.340085 => 13:54:22.353026
[0m13:54:22.354315 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.relationships_stg_raw_staging__transactions_account_id__account_id__ref_stg_raw_staging__accounts_.e5e3cbe1a6
[0m13:54:22.355151 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.relationships_stg_raw_staging__transactions_account_id__account_id__ref_stg_raw_staging__accounts_.e5e3cbe1a6 (execute): 13:54:22.354798 => 13:54:22.354813
[0m13:54:22.356768 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.relationships_stg_raw_staging__transactions_account_id__account_id__ref_stg_raw_staging__accounts_.e5e3cbe1a6
[0m13:54:22.357764 [debug] [Thread-1 (]: Began running node test.vg_casestudy.unique_stg_raw_staging__transactions_transaction_id.e0f95cb9bb
[0m13:54:22.359284 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.relationships_stg_raw_staging__transactions_account_id__account_id__ref_stg_raw_staging__accounts_.e5e3cbe1a6, now test.vg_casestudy.unique_stg_raw_staging__transactions_transaction_id.e0f95cb9bb)
[0m13:54:22.360284 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.unique_stg_raw_staging__transactions_transaction_id.e0f95cb9bb
[0m13:54:22.370499 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.unique_stg_raw_staging__transactions_transaction_id.e0f95cb9bb"
[0m13:54:22.371983 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.unique_stg_raw_staging__transactions_transaction_id.e0f95cb9bb (compile): 13:54:22.360864 => 13:54:22.371554
[0m13:54:22.372630 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.unique_stg_raw_staging__transactions_transaction_id.e0f95cb9bb
[0m13:54:22.373556 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.unique_stg_raw_staging__transactions_transaction_id.e0f95cb9bb (execute): 13:54:22.373205 => 13:54:22.373218
[0m13:54:22.374939 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.unique_stg_raw_staging__transactions_transaction_id.e0f95cb9bb
[0m13:54:22.376001 [debug] [Thread-1 (]: Began running node model.vg_casestudy.intermediate__branch_names
[0m13:54:22.378716 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.unique_stg_raw_staging__transactions_transaction_id.e0f95cb9bb, now model.vg_casestudy.intermediate__branch_names)
[0m13:54:22.379856 [debug] [Thread-1 (]: Began compiling node model.vg_casestudy.intermediate__branch_names
[0m13:54:22.386610 [debug] [Thread-1 (]: Writing injected SQL for node "model.vg_casestudy.intermediate__branch_names"
[0m13:54:22.388266 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.intermediate__branch_names (compile): 13:54:22.380551 => 13:54:22.387778
[0m13:54:22.388896 [debug] [Thread-1 (]: Began executing node model.vg_casestudy.intermediate__branch_names
[0m13:54:22.389600 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.intermediate__branch_names (execute): 13:54:22.389309 => 13:54:22.389322
[0m13:54:22.391285 [debug] [Thread-1 (]: Finished running node model.vg_casestudy.intermediate__branch_names
[0m13:54:22.392156 [debug] [Thread-1 (]: Began running node test.vg_casestudy.not_null_branch_names_branch_id.c1ec52996d
[0m13:54:22.396195 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.vg_casestudy.intermediate__branch_names, now test.vg_casestudy.not_null_branch_names_branch_id.c1ec52996d)
[0m13:54:22.397760 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.not_null_branch_names_branch_id.c1ec52996d
[0m13:54:22.406131 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.not_null_branch_names_branch_id.c1ec52996d"
[0m13:54:22.407599 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_branch_names_branch_id.c1ec52996d (compile): 13:54:22.398409 => 13:54:22.407171
[0m13:54:22.408287 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.not_null_branch_names_branch_id.c1ec52996d
[0m13:54:22.409320 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_branch_names_branch_id.c1ec52996d (execute): 13:54:22.408749 => 13:54:22.408761
[0m13:54:22.413771 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.not_null_branch_names_branch_id.c1ec52996d
[0m13:54:22.414898 [debug] [Thread-1 (]: Began running node test.vg_casestudy.not_null_branch_names_branch_name.886056654c
[0m13:54:22.416207 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.not_null_branch_names_branch_id.c1ec52996d, now test.vg_casestudy.not_null_branch_names_branch_name.886056654c)
[0m13:54:22.417125 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.not_null_branch_names_branch_name.886056654c
[0m13:54:22.424324 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.not_null_branch_names_branch_name.886056654c"
[0m13:54:22.425453 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_branch_names_branch_name.886056654c (compile): 13:54:22.417607 => 13:54:22.425070
[0m13:54:22.426197 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.not_null_branch_names_branch_name.886056654c
[0m13:54:22.427340 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_branch_names_branch_name.886056654c (execute): 13:54:22.426846 => 13:54:22.426867
[0m13:54:22.429169 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.not_null_branch_names_branch_name.886056654c
[0m13:54:22.429935 [debug] [Thread-1 (]: Began running node test.vg_casestudy.unique_branch_names_branch_id.483a257391
[0m13:54:22.430953 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.not_null_branch_names_branch_name.886056654c, now test.vg_casestudy.unique_branch_names_branch_id.483a257391)
[0m13:54:22.431871 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.unique_branch_names_branch_id.483a257391
[0m13:54:22.442848 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.unique_branch_names_branch_id.483a257391"
[0m13:54:22.444704 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.unique_branch_names_branch_id.483a257391 (compile): 13:54:22.432340 => 13:54:22.444086
[0m13:54:22.445601 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.unique_branch_names_branch_id.483a257391
[0m13:54:22.446843 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.unique_branch_names_branch_id.483a257391 (execute): 13:54:22.446446 => 13:54:22.446462
[0m13:54:22.449286 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.unique_branch_names_branch_id.483a257391
[0m13:54:22.450297 [debug] [Thread-1 (]: Began running node model.vg_casestudy.stg_staging_intermediate__currencies
[0m13:54:22.451669 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.unique_branch_names_branch_id.483a257391, now model.vg_casestudy.stg_staging_intermediate__currencies)
[0m13:54:22.452281 [debug] [Thread-1 (]: Began compiling node model.vg_casestudy.stg_staging_intermediate__currencies
[0m13:54:22.457437 [debug] [Thread-1 (]: Writing injected SQL for node "model.vg_casestudy.stg_staging_intermediate__currencies"
[0m13:54:22.458554 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.stg_staging_intermediate__currencies (compile): 13:54:22.452702 => 13:54:22.458188
[0m13:54:22.459171 [debug] [Thread-1 (]: Began executing node model.vg_casestudy.stg_staging_intermediate__currencies
[0m13:54:22.460227 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.stg_staging_intermediate__currencies (execute): 13:54:22.459844 => 13:54:22.459865
[0m13:54:22.462225 [debug] [Thread-1 (]: Finished running node model.vg_casestudy.stg_staging_intermediate__currencies
[0m13:54:22.463385 [debug] [Thread-1 (]: Began running node model.vg_casestudy.intermediate__fx_rates_filled
[0m13:54:22.465555 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.vg_casestudy.stg_staging_intermediate__currencies, now model.vg_casestudy.intermediate__fx_rates_filled)
[0m13:54:22.466660 [debug] [Thread-1 (]: Began compiling node model.vg_casestudy.intermediate__fx_rates_filled
[0m13:54:22.515396 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.intermediate__fx_rates_filled"
[0m13:54:22.516421 [debug] [Thread-1 (]: On model.vg_casestudy.intermediate__fx_rates_filled: BEGIN
[0m13:54:22.517227 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:54:22.552954 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:54:22.553827 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.intermediate__fx_rates_filled"
[0m13:54:22.554547 [debug] [Thread-1 (]: On model.vg_casestudy.intermediate__fx_rates_filled: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.intermediate__fx_rates_filled"} */


        select 
        ((date('2025-03-11'))::date - (date('2024-12-31'))::date)
    
[0m13:54:22.557539 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:54:22.582908 [debug] [Thread-1 (]: Writing injected SQL for node "model.vg_casestudy.intermediate__fx_rates_filled"
[0m13:54:22.584178 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.intermediate__fx_rates_filled (compile): 13:54:22.467427 => 13:54:22.583766
[0m13:54:22.584844 [debug] [Thread-1 (]: Began executing node model.vg_casestudy.intermediate__fx_rates_filled
[0m13:54:22.585556 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.intermediate__fx_rates_filled (execute): 13:54:22.585239 => 13:54:22.585252
[0m13:54:22.586093 [debug] [Thread-1 (]: On model.vg_casestudy.intermediate__fx_rates_filled: ROLLBACK
[0m13:54:22.586831 [debug] [Thread-1 (]: Failed to rollback 'model.vg_casestudy.intermediate__fx_rates_filled'
[0m13:54:22.587473 [debug] [Thread-1 (]: On model.vg_casestudy.intermediate__fx_rates_filled: Close
[0m13:54:22.592538 [debug] [Thread-1 (]: Finished running node model.vg_casestudy.intermediate__fx_rates_filled
[0m13:54:22.594147 [debug] [Thread-1 (]: Began running node test.vg_casestudy.not_null_fx_rates_full_history_currency_iso_code.e845428370
[0m13:54:22.596431 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.vg_casestudy.intermediate__fx_rates_filled, now test.vg_casestudy.not_null_fx_rates_full_history_currency_iso_code.e845428370)
[0m13:54:22.597243 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.not_null_fx_rates_full_history_currency_iso_code.e845428370
[0m13:54:22.606180 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.not_null_fx_rates_full_history_currency_iso_code.e845428370"
[0m13:54:22.607682 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_fx_rates_full_history_currency_iso_code.e845428370 (compile): 13:54:22.598059 => 13:54:22.607140
[0m13:54:22.608315 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.not_null_fx_rates_full_history_currency_iso_code.e845428370
[0m13:54:22.608945 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_fx_rates_full_history_currency_iso_code.e845428370 (execute): 13:54:22.608691 => 13:54:22.608703
[0m13:54:22.611151 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.not_null_fx_rates_full_history_currency_iso_code.e845428370
[0m13:54:22.612279 [debug] [Thread-1 (]: Began running node test.vg_casestudy.not_null_fx_rates_full_history_fx_rate.cdb4ee04e4
[0m13:54:22.613699 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.not_null_fx_rates_full_history_currency_iso_code.e845428370, now test.vg_casestudy.not_null_fx_rates_full_history_fx_rate.cdb4ee04e4)
[0m13:54:22.614273 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.not_null_fx_rates_full_history_fx_rate.cdb4ee04e4
[0m13:54:22.621455 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.not_null_fx_rates_full_history_fx_rate.cdb4ee04e4"
[0m13:54:22.622499 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_fx_rates_full_history_fx_rate.cdb4ee04e4 (compile): 13:54:22.614641 => 13:54:22.622185
[0m13:54:22.623296 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.not_null_fx_rates_full_history_fx_rate.cdb4ee04e4
[0m13:54:22.624180 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_fx_rates_full_history_fx_rate.cdb4ee04e4 (execute): 13:54:22.623879 => 13:54:22.623893
[0m13:54:22.626595 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.not_null_fx_rates_full_history_fx_rate.cdb4ee04e4
[0m13:54:22.628785 [debug] [Thread-1 (]: Began running node test.vg_casestudy.not_null_fx_rates_full_history_fx_rate_date.2fa88715f4
[0m13:54:22.630696 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.not_null_fx_rates_full_history_fx_rate.cdb4ee04e4, now test.vg_casestudy.not_null_fx_rates_full_history_fx_rate_date.2fa88715f4)
[0m13:54:22.631506 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.not_null_fx_rates_full_history_fx_rate_date.2fa88715f4
[0m13:54:22.639251 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.not_null_fx_rates_full_history_fx_rate_date.2fa88715f4"
[0m13:54:22.640534 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_fx_rates_full_history_fx_rate_date.2fa88715f4 (compile): 13:54:22.631925 => 13:54:22.640184
[0m13:54:22.641301 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.not_null_fx_rates_full_history_fx_rate_date.2fa88715f4
[0m13:54:22.642835 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_fx_rates_full_history_fx_rate_date.2fa88715f4 (execute): 13:54:22.641879 => 13:54:22.641896
[0m13:54:22.645045 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.not_null_fx_rates_full_history_fx_rate_date.2fa88715f4
[0m13:54:22.645834 [debug] [Thread-1 (]: Began running node test.vg_casestudy.date_is_past_stg_staging_intermediate__accounts_account_opening_date.f0a9449f31
[0m13:54:22.647080 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.not_null_fx_rates_full_history_fx_rate_date.2fa88715f4, now test.vg_casestudy.date_is_past_stg_staging_intermediate__accounts_account_opening_date.f0a9449f31)
[0m13:54:22.647782 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.date_is_past_stg_staging_intermediate__accounts_account_opening_date.f0a9449f31
[0m13:54:22.655694 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.date_is_past_stg_staging_intermediate__accounts_account_opening_date.f0a9449f31"
[0m13:54:22.657089 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.date_is_past_stg_staging_intermediate__accounts_account_opening_date.f0a9449f31 (compile): 13:54:22.648236 => 13:54:22.656548
[0m13:54:22.657763 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.date_is_past_stg_staging_intermediate__accounts_account_opening_date.f0a9449f31
[0m13:54:22.658517 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.date_is_past_stg_staging_intermediate__accounts_account_opening_date.f0a9449f31 (execute): 13:54:22.658223 => 13:54:22.658236
[0m13:54:22.660837 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.date_is_past_stg_staging_intermediate__accounts_account_opening_date.f0a9449f31
[0m13:54:22.662414 [debug] [Thread-1 (]: Began running node test.vg_casestudy.not_null_stg_staging_intermediate__accounts_account_id.ce9f8bf6f5
[0m13:54:22.663671 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.date_is_past_stg_staging_intermediate__accounts_account_opening_date.f0a9449f31, now test.vg_casestudy.not_null_stg_staging_intermediate__accounts_account_id.ce9f8bf6f5)
[0m13:54:22.664529 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.not_null_stg_staging_intermediate__accounts_account_id.ce9f8bf6f5
[0m13:54:22.672780 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.not_null_stg_staging_intermediate__accounts_account_id.ce9f8bf6f5"
[0m13:54:22.673927 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_stg_staging_intermediate__accounts_account_id.ce9f8bf6f5 (compile): 13:54:22.664965 => 13:54:22.673521
[0m13:54:22.674611 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.not_null_stg_staging_intermediate__accounts_account_id.ce9f8bf6f5
[0m13:54:22.675297 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_stg_staging_intermediate__accounts_account_id.ce9f8bf6f5 (execute): 13:54:22.675045 => 13:54:22.675057
[0m13:54:22.677015 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.not_null_stg_staging_intermediate__accounts_account_id.ce9f8bf6f5
[0m13:54:22.678076 [debug] [Thread-1 (]: Began running node test.vg_casestudy.not_null_stg_staging_intermediate__accounts_account_opening_date.14abf76bb5
[0m13:54:22.679565 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.not_null_stg_staging_intermediate__accounts_account_id.ce9f8bf6f5, now test.vg_casestudy.not_null_stg_staging_intermediate__accounts_account_opening_date.14abf76bb5)
[0m13:54:22.680263 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.not_null_stg_staging_intermediate__accounts_account_opening_date.14abf76bb5
[0m13:54:22.691930 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.not_null_stg_staging_intermediate__accounts_account_opening_date.14abf76bb5"
[0m13:54:22.693934 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_stg_staging_intermediate__accounts_account_opening_date.14abf76bb5 (compile): 13:54:22.680667 => 13:54:22.693025
[0m13:54:22.694971 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.not_null_stg_staging_intermediate__accounts_account_opening_date.14abf76bb5
[0m13:54:22.695942 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_stg_staging_intermediate__accounts_account_opening_date.14abf76bb5 (execute): 13:54:22.695508 => 13:54:22.695525
[0m13:54:22.697387 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.not_null_stg_staging_intermediate__accounts_account_opening_date.14abf76bb5
[0m13:54:22.698082 [debug] [Thread-1 (]: Began running node test.vg_casestudy.not_null_stg_staging_intermediate__accounts_customer_id.2a8ddb333d
[0m13:54:22.699234 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.not_null_stg_staging_intermediate__accounts_account_opening_date.14abf76bb5, now test.vg_casestudy.not_null_stg_staging_intermediate__accounts_customer_id.2a8ddb333d)
[0m13:54:22.699907 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.not_null_stg_staging_intermediate__accounts_customer_id.2a8ddb333d
[0m13:54:22.708378 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.not_null_stg_staging_intermediate__accounts_customer_id.2a8ddb333d"
[0m13:54:22.712165 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_stg_staging_intermediate__accounts_customer_id.2a8ddb333d (compile): 13:54:22.700303 => 13:54:22.711369
[0m13:54:22.713139 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.not_null_stg_staging_intermediate__accounts_customer_id.2a8ddb333d
[0m13:54:22.713833 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_stg_staging_intermediate__accounts_customer_id.2a8ddb333d (execute): 13:54:22.713557 => 13:54:22.713570
[0m13:54:22.715344 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.not_null_stg_staging_intermediate__accounts_customer_id.2a8ddb333d
[0m13:54:22.716197 [debug] [Thread-1 (]: Began running node test.vg_casestudy.unique_stg_staging_intermediate__accounts_account_id.b2f9fdea72
[0m13:54:22.717363 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.not_null_stg_staging_intermediate__accounts_customer_id.2a8ddb333d, now test.vg_casestudy.unique_stg_staging_intermediate__accounts_account_id.b2f9fdea72)
[0m13:54:22.718022 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.unique_stg_staging_intermediate__accounts_account_id.b2f9fdea72
[0m13:54:22.726607 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.unique_stg_staging_intermediate__accounts_account_id.b2f9fdea72"
[0m13:54:22.728885 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.unique_stg_staging_intermediate__accounts_account_id.b2f9fdea72 (compile): 13:54:22.718459 => 13:54:22.728309
[0m13:54:22.729630 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.unique_stg_staging_intermediate__accounts_account_id.b2f9fdea72
[0m13:54:22.730357 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.unique_stg_staging_intermediate__accounts_account_id.b2f9fdea72 (execute): 13:54:22.730092 => 13:54:22.730104
[0m13:54:22.731768 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.unique_stg_staging_intermediate__accounts_account_id.b2f9fdea72
[0m13:54:22.732514 [debug] [Thread-1 (]: Began running node test.vg_casestudy.not_null_stg_staging_intermediate__customers_branch_id.de895a293b
[0m13:54:22.733911 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.unique_stg_staging_intermediate__accounts_account_id.b2f9fdea72, now test.vg_casestudy.not_null_stg_staging_intermediate__customers_branch_id.de895a293b)
[0m13:54:22.734586 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.not_null_stg_staging_intermediate__customers_branch_id.de895a293b
[0m13:54:22.742114 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.not_null_stg_staging_intermediate__customers_branch_id.de895a293b"
[0m13:54:22.744251 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_stg_staging_intermediate__customers_branch_id.de895a293b (compile): 13:54:22.735302 => 13:54:22.743278
[0m13:54:22.745349 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.not_null_stg_staging_intermediate__customers_branch_id.de895a293b
[0m13:54:22.746576 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_stg_staging_intermediate__customers_branch_id.de895a293b (execute): 13:54:22.746061 => 13:54:22.746081
[0m13:54:22.748582 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.not_null_stg_staging_intermediate__customers_branch_id.de895a293b
[0m13:54:22.749436 [debug] [Thread-1 (]: Began running node test.vg_casestudy.not_null_stg_staging_intermediate__customers_customer_id.10f4ae76d7
[0m13:54:22.750858 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.not_null_stg_staging_intermediate__customers_branch_id.de895a293b, now test.vg_casestudy.not_null_stg_staging_intermediate__customers_customer_id.10f4ae76d7)
[0m13:54:22.751697 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.not_null_stg_staging_intermediate__customers_customer_id.10f4ae76d7
[0m13:54:22.760023 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.not_null_stg_staging_intermediate__customers_customer_id.10f4ae76d7"
[0m13:54:22.761778 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_stg_staging_intermediate__customers_customer_id.10f4ae76d7 (compile): 13:54:22.752265 => 13:54:22.761264
[0m13:54:22.762486 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.not_null_stg_staging_intermediate__customers_customer_id.10f4ae76d7
[0m13:54:22.763256 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_stg_staging_intermediate__customers_customer_id.10f4ae76d7 (execute): 13:54:22.762942 => 13:54:22.762955
[0m13:54:22.764759 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.not_null_stg_staging_intermediate__customers_customer_id.10f4ae76d7
[0m13:54:22.765422 [debug] [Thread-1 (]: Began running node test.vg_casestudy.relationships_stg_staging_intermediate__accounts_customer_id__customer_id__ref_stg_staging_intermediate__customers_.d3a09ede96
[0m13:54:22.766900 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.not_null_stg_staging_intermediate__customers_customer_id.10f4ae76d7, now test.vg_casestudy.relationships_stg_staging_intermediate__accounts_customer_id__customer_id__ref_stg_staging_intermediate__customers_.d3a09ede96)
[0m13:54:22.767972 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.relationships_stg_staging_intermediate__accounts_customer_id__customer_id__ref_stg_staging_intermediate__customers_.d3a09ede96
[0m13:54:22.776974 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.relationships_stg_staging_intermediate__accounts_customer_id__customer_id__ref_stg_staging_intermediate__customers_.d3a09ede96"
[0m13:54:22.778893 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.relationships_stg_staging_intermediate__accounts_customer_id__customer_id__ref_stg_staging_intermediate__customers_.d3a09ede96 (compile): 13:54:22.768422 => 13:54:22.778306
[0m13:54:22.779896 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.relationships_stg_staging_intermediate__accounts_customer_id__customer_id__ref_stg_staging_intermediate__customers_.d3a09ede96
[0m13:54:22.780926 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.relationships_stg_staging_intermediate__accounts_customer_id__customer_id__ref_stg_staging_intermediate__customers_.d3a09ede96 (execute): 13:54:22.780556 => 13:54:22.780571
[0m13:54:22.783335 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.relationships_stg_staging_intermediate__accounts_customer_id__customer_id__ref_stg_staging_intermediate__customers_.d3a09ede96
[0m13:54:22.784459 [debug] [Thread-1 (]: Began running node test.vg_casestudy.unique_stg_staging_intermediate__customers_customer_id.5bded562dd
[0m13:54:22.786281 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.relationships_stg_staging_intermediate__accounts_customer_id__customer_id__ref_stg_staging_intermediate__customers_.d3a09ede96, now test.vg_casestudy.unique_stg_staging_intermediate__customers_customer_id.5bded562dd)
[0m13:54:22.787479 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.unique_stg_staging_intermediate__customers_customer_id.5bded562dd
[0m13:54:22.799317 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.unique_stg_staging_intermediate__customers_customer_id.5bded562dd"
[0m13:54:22.801112 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.unique_stg_staging_intermediate__customers_customer_id.5bded562dd (compile): 13:54:22.788181 => 13:54:22.800560
[0m13:54:22.802196 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.unique_stg_staging_intermediate__customers_customer_id.5bded562dd
[0m13:54:22.803628 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.unique_stg_staging_intermediate__customers_customer_id.5bded562dd (execute): 13:54:22.803051 => 13:54:22.803075
[0m13:54:22.805921 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.unique_stg_staging_intermediate__customers_customer_id.5bded562dd
[0m13:54:22.807028 [debug] [Thread-1 (]: Began running node test.vg_casestudy.date_is_past_stg_staging_intermediate__fx_rates_fx_rate_date.6dd6ccf2e2
[0m13:54:22.811691 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.unique_stg_staging_intermediate__customers_customer_id.5bded562dd, now test.vg_casestudy.date_is_past_stg_staging_intermediate__fx_rates_fx_rate_date.6dd6ccf2e2)
[0m13:54:22.815517 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.date_is_past_stg_staging_intermediate__fx_rates_fx_rate_date.6dd6ccf2e2
[0m13:54:22.825721 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.date_is_past_stg_staging_intermediate__fx_rates_fx_rate_date.6dd6ccf2e2"
[0m13:54:22.830450 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.date_is_past_stg_staging_intermediate__fx_rates_fx_rate_date.6dd6ccf2e2 (compile): 13:54:22.816693 => 13:54:22.829470
[0m13:54:22.831320 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.date_is_past_stg_staging_intermediate__fx_rates_fx_rate_date.6dd6ccf2e2
[0m13:54:22.832461 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.date_is_past_stg_staging_intermediate__fx_rates_fx_rate_date.6dd6ccf2e2 (execute): 13:54:22.831981 => 13:54:22.831999
[0m13:54:22.834475 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.date_is_past_stg_staging_intermediate__fx_rates_fx_rate_date.6dd6ccf2e2
[0m13:54:22.835333 [debug] [Thread-1 (]: Began running node test.vg_casestudy.not_null_stg_staging_intermediate__fx_rates_currency_iso_code.95d2907ece
[0m13:54:22.836723 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.date_is_past_stg_staging_intermediate__fx_rates_fx_rate_date.6dd6ccf2e2, now test.vg_casestudy.not_null_stg_staging_intermediate__fx_rates_currency_iso_code.95d2907ece)
[0m13:54:22.837939 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.not_null_stg_staging_intermediate__fx_rates_currency_iso_code.95d2907ece
[0m13:54:22.849037 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.not_null_stg_staging_intermediate__fx_rates_currency_iso_code.95d2907ece"
[0m13:54:22.850602 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_stg_staging_intermediate__fx_rates_currency_iso_code.95d2907ece (compile): 13:54:22.838543 => 13:54:22.850008
[0m13:54:22.851708 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.not_null_stg_staging_intermediate__fx_rates_currency_iso_code.95d2907ece
[0m13:54:22.852649 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_stg_staging_intermediate__fx_rates_currency_iso_code.95d2907ece (execute): 13:54:22.852216 => 13:54:22.852231
[0m13:54:22.854473 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.not_null_stg_staging_intermediate__fx_rates_currency_iso_code.95d2907ece
[0m13:54:22.855421 [debug] [Thread-1 (]: Began running node test.vg_casestudy.not_null_stg_staging_intermediate__fx_rates_fx_rate.bec8509027
[0m13:54:22.858127 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.not_null_stg_staging_intermediate__fx_rates_currency_iso_code.95d2907ece, now test.vg_casestudy.not_null_stg_staging_intermediate__fx_rates_fx_rate.bec8509027)
[0m13:54:22.859400 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.not_null_stg_staging_intermediate__fx_rates_fx_rate.bec8509027
[0m13:54:22.878244 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.not_null_stg_staging_intermediate__fx_rates_fx_rate.bec8509027"
[0m13:54:22.880372 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_stg_staging_intermediate__fx_rates_fx_rate.bec8509027 (compile): 13:54:22.860334 => 13:54:22.879457
[0m13:54:22.881214 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.not_null_stg_staging_intermediate__fx_rates_fx_rate.bec8509027
[0m13:54:22.882323 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_stg_staging_intermediate__fx_rates_fx_rate.bec8509027 (execute): 13:54:22.881820 => 13:54:22.881846
[0m13:54:22.884267 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.not_null_stg_staging_intermediate__fx_rates_fx_rate.bec8509027
[0m13:54:22.885123 [debug] [Thread-1 (]: Began running node test.vg_casestudy.not_null_stg_staging_intermediate__fx_rates_fx_rate_date.0f5280bc57
[0m13:54:22.886595 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.not_null_stg_staging_intermediate__fx_rates_fx_rate.bec8509027, now test.vg_casestudy.not_null_stg_staging_intermediate__fx_rates_fx_rate_date.0f5280bc57)
[0m13:54:22.887292 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.not_null_stg_staging_intermediate__fx_rates_fx_rate_date.0f5280bc57
[0m13:54:22.898712 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.not_null_stg_staging_intermediate__fx_rates_fx_rate_date.0f5280bc57"
[0m13:54:22.900249 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_stg_staging_intermediate__fx_rates_fx_rate_date.0f5280bc57 (compile): 13:54:22.887982 => 13:54:22.899635
[0m13:54:22.901201 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.not_null_stg_staging_intermediate__fx_rates_fx_rate_date.0f5280bc57
[0m13:54:22.902305 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_stg_staging_intermediate__fx_rates_fx_rate_date.0f5280bc57 (execute): 13:54:22.901885 => 13:54:22.901908
[0m13:54:22.904298 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.not_null_stg_staging_intermediate__fx_rates_fx_rate_date.0f5280bc57
[0m13:54:22.905288 [debug] [Thread-1 (]: Began running node test.vg_casestudy.numeric_range_stg_staging_intermediate__fx_rates_fx_rate__0.2d4a929b3f
[0m13:54:22.907366 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.not_null_stg_staging_intermediate__fx_rates_fx_rate_date.0f5280bc57, now test.vg_casestudy.numeric_range_stg_staging_intermediate__fx_rates_fx_rate__0.2d4a929b3f)
[0m13:54:22.908219 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.numeric_range_stg_staging_intermediate__fx_rates_fx_rate__0.2d4a929b3f
[0m13:54:22.917724 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.numeric_range_stg_staging_intermediate__fx_rates_fx_rate__0.2d4a929b3f"
[0m13:54:22.918994 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.numeric_range_stg_staging_intermediate__fx_rates_fx_rate__0.2d4a929b3f (compile): 13:54:22.908715 => 13:54:22.918550
[0m13:54:22.919893 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.numeric_range_stg_staging_intermediate__fx_rates_fx_rate__0.2d4a929b3f
[0m13:54:22.920694 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.numeric_range_stg_staging_intermediate__fx_rates_fx_rate__0.2d4a929b3f (execute): 13:54:22.920380 => 13:54:22.920393
[0m13:54:22.923045 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.numeric_range_stg_staging_intermediate__fx_rates_fx_rate__0.2d4a929b3f
[0m13:54:22.924272 [debug] [Thread-1 (]: Began running node test.vg_casestudy.unique_stg_staging_intermediate__fx_rates_currency_iso_code.a28e4eee53
[0m13:54:22.926215 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.numeric_range_stg_staging_intermediate__fx_rates_fx_rate__0.2d4a929b3f, now test.vg_casestudy.unique_stg_staging_intermediate__fx_rates_currency_iso_code.a28e4eee53)
[0m13:54:22.927458 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.unique_stg_staging_intermediate__fx_rates_currency_iso_code.a28e4eee53
[0m13:54:22.936689 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.unique_stg_staging_intermediate__fx_rates_currency_iso_code.a28e4eee53"
[0m13:54:22.939194 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.unique_stg_staging_intermediate__fx_rates_currency_iso_code.a28e4eee53 (compile): 13:54:22.928322 => 13:54:22.938546
[0m13:54:22.940246 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.unique_stg_staging_intermediate__fx_rates_currency_iso_code.a28e4eee53
[0m13:54:22.941069 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.unique_stg_staging_intermediate__fx_rates_currency_iso_code.a28e4eee53 (execute): 13:54:22.940744 => 13:54:22.940758
[0m13:54:22.943802 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.unique_stg_staging_intermediate__fx_rates_currency_iso_code.a28e4eee53
[0m13:54:22.946029 [debug] [Thread-1 (]: Began running node analysis.vg_casestudy.sample_loan_data
[0m13:54:22.947563 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.unique_stg_staging_intermediate__fx_rates_currency_iso_code.a28e4eee53, now analysis.vg_casestudy.sample_loan_data)
[0m13:54:22.948333 [debug] [Thread-1 (]: Began compiling node analysis.vg_casestudy.sample_loan_data
[0m13:54:22.954488 [debug] [Thread-1 (]: Writing injected SQL for node "analysis.vg_casestudy.sample_loan_data"
[0m13:54:22.956079 [debug] [Thread-1 (]: Timing info for analysis.vg_casestudy.sample_loan_data (compile): 13:54:22.948840 => 13:54:22.955664
[0m13:54:22.956861 [debug] [Thread-1 (]: Began executing node analysis.vg_casestudy.sample_loan_data
[0m13:54:22.957951 [debug] [Thread-1 (]: Timing info for analysis.vg_casestudy.sample_loan_data (execute): 13:54:22.957558 => 13:54:22.957578
[0m13:54:22.966256 [debug] [Thread-1 (]: Finished running node analysis.vg_casestudy.sample_loan_data
[0m13:54:22.967892 [debug] [Thread-1 (]: Began running node test.vg_casestudy.accepted_values_stg_staging_intermediate__loans_loan_status__approved__rejected__closed.3143a4d227
[0m13:54:22.969990 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly analysis.vg_casestudy.sample_loan_data, now test.vg_casestudy.accepted_values_stg_staging_intermediate__loans_loan_status__approved__rejected__closed.3143a4d227)
[0m13:54:22.971298 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.accepted_values_stg_staging_intermediate__loans_loan_status__approved__rejected__closed.3143a4d227
[0m13:54:22.981580 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.accepted_values_stg_staging_intermediate__loans_loan_status__approved__rejected__closed.3143a4d227"
[0m13:54:22.982972 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.accepted_values_stg_staging_intermediate__loans_loan_status__approved__rejected__closed.3143a4d227 (compile): 13:54:22.972155 => 13:54:22.982460
[0m13:54:22.984017 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.accepted_values_stg_staging_intermediate__loans_loan_status__approved__rejected__closed.3143a4d227
[0m13:54:22.985060 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.accepted_values_stg_staging_intermediate__loans_loan_status__approved__rejected__closed.3143a4d227 (execute): 13:54:22.984653 => 13:54:22.984668
[0m13:54:22.986894 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.accepted_values_stg_staging_intermediate__loans_loan_status__approved__rejected__closed.3143a4d227
[0m13:54:22.987986 [debug] [Thread-1 (]: Began running node test.vg_casestudy.accepted_values_stg_staging_intermediate__loans_loan_term__12__24__36__48__60.5ea4cabc39
[0m13:54:22.990086 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.accepted_values_stg_staging_intermediate__loans_loan_status__approved__rejected__closed.3143a4d227, now test.vg_casestudy.accepted_values_stg_staging_intermediate__loans_loan_term__12__24__36__48__60.5ea4cabc39)
[0m13:54:22.991217 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.accepted_values_stg_staging_intermediate__loans_loan_term__12__24__36__48__60.5ea4cabc39
[0m13:54:23.002981 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.accepted_values_stg_staging_intermediate__loans_loan_term__12__24__36__48__60.5ea4cabc39"
[0m13:54:23.004746 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.accepted_values_stg_staging_intermediate__loans_loan_term__12__24__36__48__60.5ea4cabc39 (compile): 13:54:22.992107 => 13:54:23.004285
[0m13:54:23.005489 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.accepted_values_stg_staging_intermediate__loans_loan_term__12__24__36__48__60.5ea4cabc39
[0m13:54:23.006504 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.accepted_values_stg_staging_intermediate__loans_loan_term__12__24__36__48__60.5ea4cabc39 (execute): 13:54:23.006132 => 13:54:23.006147
[0m13:54:23.008689 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.accepted_values_stg_staging_intermediate__loans_loan_term__12__24__36__48__60.5ea4cabc39
[0m13:54:23.010804 [debug] [Thread-1 (]: Began running node test.vg_casestudy.date_is_past_stg_staging_intermediate__loans_approval_rejection_date.61c247afe7
[0m13:54:23.013488 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.accepted_values_stg_staging_intermediate__loans_loan_term__12__24__36__48__60.5ea4cabc39, now test.vg_casestudy.date_is_past_stg_staging_intermediate__loans_approval_rejection_date.61c247afe7)
[0m13:54:23.014506 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.date_is_past_stg_staging_intermediate__loans_approval_rejection_date.61c247afe7
[0m13:54:23.024898 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.date_is_past_stg_staging_intermediate__loans_approval_rejection_date.61c247afe7"
[0m13:54:23.027344 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.date_is_past_stg_staging_intermediate__loans_approval_rejection_date.61c247afe7 (compile): 13:54:23.015079 => 13:54:23.026225
[0m13:54:23.028464 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.date_is_past_stg_staging_intermediate__loans_approval_rejection_date.61c247afe7
[0m13:54:23.030414 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.date_is_past_stg_staging_intermediate__loans_approval_rejection_date.61c247afe7 (execute): 13:54:23.029866 => 13:54:23.029888
[0m13:54:23.032889 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.date_is_past_stg_staging_intermediate__loans_approval_rejection_date.61c247afe7
[0m13:54:23.034115 [debug] [Thread-1 (]: Began running node test.vg_casestudy.not_null_stg_staging_intermediate__loans_approval_rejection_date.28f5951b2f
[0m13:54:23.035675 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.date_is_past_stg_staging_intermediate__loans_approval_rejection_date.61c247afe7, now test.vg_casestudy.not_null_stg_staging_intermediate__loans_approval_rejection_date.28f5951b2f)
[0m13:54:23.036745 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.not_null_stg_staging_intermediate__loans_approval_rejection_date.28f5951b2f
[0m13:54:23.047850 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.not_null_stg_staging_intermediate__loans_approval_rejection_date.28f5951b2f"
[0m13:54:23.049068 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_stg_staging_intermediate__loans_approval_rejection_date.28f5951b2f (compile): 13:54:23.037575 => 13:54:23.048665
[0m13:54:23.049828 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.not_null_stg_staging_intermediate__loans_approval_rejection_date.28f5951b2f
[0m13:54:23.050637 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_stg_staging_intermediate__loans_approval_rejection_date.28f5951b2f (execute): 13:54:23.050333 => 13:54:23.050347
[0m13:54:23.052324 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.not_null_stg_staging_intermediate__loans_approval_rejection_date.28f5951b2f
[0m13:54:23.053156 [debug] [Thread-1 (]: Began running node test.vg_casestudy.not_null_stg_staging_intermediate__loans_interest_rate.290100bb78
[0m13:54:23.054629 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.not_null_stg_staging_intermediate__loans_approval_rejection_date.28f5951b2f, now test.vg_casestudy.not_null_stg_staging_intermediate__loans_interest_rate.290100bb78)
[0m13:54:23.055359 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.not_null_stg_staging_intermediate__loans_interest_rate.290100bb78
[0m13:54:23.067779 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.not_null_stg_staging_intermediate__loans_interest_rate.290100bb78"
[0m13:54:23.069471 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_stg_staging_intermediate__loans_interest_rate.290100bb78 (compile): 13:54:23.055898 => 13:54:23.068899
[0m13:54:23.070549 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.not_null_stg_staging_intermediate__loans_interest_rate.290100bb78
[0m13:54:23.071904 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_stg_staging_intermediate__loans_interest_rate.290100bb78 (execute): 13:54:23.071177 => 13:54:23.071196
[0m13:54:23.074639 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.not_null_stg_staging_intermediate__loans_interest_rate.290100bb78
[0m13:54:23.075848 [debug] [Thread-1 (]: Began running node test.vg_casestudy.not_null_stg_staging_intermediate__loans_loan_amount.3aa0f79ca3
[0m13:54:23.077323 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.not_null_stg_staging_intermediate__loans_interest_rate.290100bb78, now test.vg_casestudy.not_null_stg_staging_intermediate__loans_loan_amount.3aa0f79ca3)
[0m13:54:23.077974 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.not_null_stg_staging_intermediate__loans_loan_amount.3aa0f79ca3
[0m13:54:23.087221 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.not_null_stg_staging_intermediate__loans_loan_amount.3aa0f79ca3"
[0m13:54:23.088649 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_stg_staging_intermediate__loans_loan_amount.3aa0f79ca3 (compile): 13:54:23.078405 => 13:54:23.088206
[0m13:54:23.089435 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.not_null_stg_staging_intermediate__loans_loan_amount.3aa0f79ca3
[0m13:54:23.091258 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_stg_staging_intermediate__loans_loan_amount.3aa0f79ca3 (execute): 13:54:23.089964 => 13:54:23.089980
[0m13:54:23.093321 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.not_null_stg_staging_intermediate__loans_loan_amount.3aa0f79ca3
[0m13:54:23.094291 [debug] [Thread-1 (]: Began running node test.vg_casestudy.not_null_stg_staging_intermediate__loans_loan_id.bbf464e57e
[0m13:54:23.096069 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.not_null_stg_staging_intermediate__loans_loan_amount.3aa0f79ca3, now test.vg_casestudy.not_null_stg_staging_intermediate__loans_loan_id.bbf464e57e)
[0m13:54:23.096990 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.not_null_stg_staging_intermediate__loans_loan_id.bbf464e57e
[0m13:54:23.106440 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.not_null_stg_staging_intermediate__loans_loan_id.bbf464e57e"
[0m13:54:23.108295 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_stg_staging_intermediate__loans_loan_id.bbf464e57e (compile): 13:54:23.097688 => 13:54:23.107696
[0m13:54:23.109226 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.not_null_stg_staging_intermediate__loans_loan_id.bbf464e57e
[0m13:54:23.110142 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_stg_staging_intermediate__loans_loan_id.bbf464e57e (execute): 13:54:23.109766 => 13:54:23.109791
[0m13:54:23.111987 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.not_null_stg_staging_intermediate__loans_loan_id.bbf464e57e
[0m13:54:23.112904 [debug] [Thread-1 (]: Began running node test.vg_casestudy.not_null_stg_staging_intermediate__loans_loan_status.6519e56cae
[0m13:54:23.114321 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.not_null_stg_staging_intermediate__loans_loan_id.bbf464e57e, now test.vg_casestudy.not_null_stg_staging_intermediate__loans_loan_status.6519e56cae)
[0m13:54:23.114986 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.not_null_stg_staging_intermediate__loans_loan_status.6519e56cae
[0m13:54:23.123522 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.not_null_stg_staging_intermediate__loans_loan_status.6519e56cae"
[0m13:54:23.124699 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_stg_staging_intermediate__loans_loan_status.6519e56cae (compile): 13:54:23.115516 => 13:54:23.124306
[0m13:54:23.125395 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.not_null_stg_staging_intermediate__loans_loan_status.6519e56cae
[0m13:54:23.126396 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_stg_staging_intermediate__loans_loan_status.6519e56cae (execute): 13:54:23.125893 => 13:54:23.125912
[0m13:54:23.128076 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.not_null_stg_staging_intermediate__loans_loan_status.6519e56cae
[0m13:54:23.129136 [debug] [Thread-1 (]: Began running node test.vg_casestudy.not_null_stg_staging_intermediate__loans_loan_term.c98571f396
[0m13:54:23.130802 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.not_null_stg_staging_intermediate__loans_loan_status.6519e56cae, now test.vg_casestudy.not_null_stg_staging_intermediate__loans_loan_term.c98571f396)
[0m13:54:23.131589 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.not_null_stg_staging_intermediate__loans_loan_term.c98571f396
[0m13:54:23.141204 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.not_null_stg_staging_intermediate__loans_loan_term.c98571f396"
[0m13:54:23.142480 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_stg_staging_intermediate__loans_loan_term.c98571f396 (compile): 13:54:23.132192 => 13:54:23.141999
[0m13:54:23.143256 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.not_null_stg_staging_intermediate__loans_loan_term.c98571f396
[0m13:54:23.144347 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_stg_staging_intermediate__loans_loan_term.c98571f396 (execute): 13:54:23.143846 => 13:54:23.143867
[0m13:54:23.146574 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.not_null_stg_staging_intermediate__loans_loan_term.c98571f396
[0m13:54:23.147773 [debug] [Thread-1 (]: Began running node test.vg_casestudy.numeric_range_stg_staging_intermediate__loans_interest_rate__0.049a21d6b9
[0m13:54:23.149344 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.not_null_stg_staging_intermediate__loans_loan_term.c98571f396, now test.vg_casestudy.numeric_range_stg_staging_intermediate__loans_interest_rate__0.049a21d6b9)
[0m13:54:23.150163 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.numeric_range_stg_staging_intermediate__loans_interest_rate__0.049a21d6b9
[0m13:54:23.157803 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.numeric_range_stg_staging_intermediate__loans_interest_rate__0.049a21d6b9"
[0m13:54:23.159038 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.numeric_range_stg_staging_intermediate__loans_interest_rate__0.049a21d6b9 (compile): 13:54:23.150575 => 13:54:23.158615
[0m13:54:23.159890 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.numeric_range_stg_staging_intermediate__loans_interest_rate__0.049a21d6b9
[0m13:54:23.160603 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.numeric_range_stg_staging_intermediate__loans_interest_rate__0.049a21d6b9 (execute): 13:54:23.160307 => 13:54:23.160319
[0m13:54:23.162165 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.numeric_range_stg_staging_intermediate__loans_interest_rate__0.049a21d6b9
[0m13:54:23.162954 [debug] [Thread-1 (]: Began running node test.vg_casestudy.numeric_range_stg_staging_intermediate__loans_loan_amount__0.68f9ee0c26
[0m13:54:23.164285 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.numeric_range_stg_staging_intermediate__loans_interest_rate__0.049a21d6b9, now test.vg_casestudy.numeric_range_stg_staging_intermediate__loans_loan_amount__0.68f9ee0c26)
[0m13:54:23.164894 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.numeric_range_stg_staging_intermediate__loans_loan_amount__0.68f9ee0c26
[0m13:54:23.173583 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.numeric_range_stg_staging_intermediate__loans_loan_amount__0.68f9ee0c26"
[0m13:54:23.174911 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.numeric_range_stg_staging_intermediate__loans_loan_amount__0.68f9ee0c26 (compile): 13:54:23.165376 => 13:54:23.174506
[0m13:54:23.175636 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.numeric_range_stg_staging_intermediate__loans_loan_amount__0.68f9ee0c26
[0m13:54:23.176476 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.numeric_range_stg_staging_intermediate__loans_loan_amount__0.68f9ee0c26 (execute): 13:54:23.176111 => 13:54:23.176127
[0m13:54:23.178093 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.numeric_range_stg_staging_intermediate__loans_loan_amount__0.68f9ee0c26
[0m13:54:23.179098 [debug] [Thread-1 (]: Began running node test.vg_casestudy.unique_stg_staging_intermediate__loans_loan_id.7800e8cbcc
[0m13:54:23.180444 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.numeric_range_stg_staging_intermediate__loans_loan_amount__0.68f9ee0c26, now test.vg_casestudy.unique_stg_staging_intermediate__loans_loan_id.7800e8cbcc)
[0m13:54:23.181381 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.unique_stg_staging_intermediate__loans_loan_id.7800e8cbcc
[0m13:54:23.189671 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.unique_stg_staging_intermediate__loans_loan_id.7800e8cbcc"
[0m13:54:23.190918 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.unique_stg_staging_intermediate__loans_loan_id.7800e8cbcc (compile): 13:54:23.181876 => 13:54:23.190527
[0m13:54:23.191668 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.unique_stg_staging_intermediate__loans_loan_id.7800e8cbcc
[0m13:54:23.192408 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.unique_stg_staging_intermediate__loans_loan_id.7800e8cbcc (execute): 13:54:23.192080 => 13:54:23.192097
[0m13:54:23.193957 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.unique_stg_staging_intermediate__loans_loan_id.7800e8cbcc
[0m13:54:23.194707 [debug] [Thread-1 (]: Began running node test.vg_casestudy.accepted_values_stg_staging_intermediate__transactions_transaction_currency__AUD__BGN__CHF__CZK__DKK__GBP__HUF__ISK__JPY__NOK__PLN__RON__SEK__TRY.93638c3051
[0m13:54:23.195925 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.unique_stg_staging_intermediate__loans_loan_id.7800e8cbcc, now test.vg_casestudy.accepted_values_stg_staging_intermediate__transactions_transaction_currency__AUD__BGN__CHF__CZK__DKK__GBP__HUF__ISK__JPY__NOK__PLN__RON__SEK__TRY.93638c3051)
[0m13:54:23.196541 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.accepted_values_stg_staging_intermediate__transactions_transaction_currency__AUD__BGN__CHF__CZK__DKK__GBP__HUF__ISK__JPY__NOK__PLN__RON__SEK__TRY.93638c3051
[0m13:54:23.216272 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.accepted_values_stg_staging_intermediate__transactions_transaction_currency__AUD__BGN__CHF__CZK__DKK__GBP__HUF__ISK__JPY__NOK__PLN__RON__SEK__TRY.93638c3051"
[0m13:54:23.217492 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.accepted_values_stg_staging_intermediate__transactions_transaction_currency__AUD__BGN__CHF__CZK__DKK__GBP__HUF__ISK__JPY__NOK__PLN__RON__SEK__TRY.93638c3051 (compile): 13:54:23.196938 => 13:54:23.217130
[0m13:54:23.218099 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.accepted_values_stg_staging_intermediate__transactions_transaction_currency__AUD__BGN__CHF__CZK__DKK__GBP__HUF__ISK__JPY__NOK__PLN__RON__SEK__TRY.93638c3051
[0m13:54:23.218756 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.accepted_values_stg_staging_intermediate__transactions_transaction_currency__AUD__BGN__CHF__CZK__DKK__GBP__HUF__ISK__JPY__NOK__PLN__RON__SEK__TRY.93638c3051 (execute): 13:54:23.218489 => 13:54:23.218501
[0m13:54:23.220175 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.accepted_values_stg_staging_intermediate__transactions_transaction_currency__AUD__BGN__CHF__CZK__DKK__GBP__HUF__ISK__JPY__NOK__PLN__RON__SEK__TRY.93638c3051
[0m13:54:23.220790 [debug] [Thread-1 (]: Began running node test.vg_casestudy.not_null_stg_staging_intermediate__transactions_transaction_amount.8dc65a17fe
[0m13:54:23.222132 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.accepted_values_stg_staging_intermediate__transactions_transaction_currency__AUD__BGN__CHF__CZK__DKK__GBP__HUF__ISK__JPY__NOK__PLN__RON__SEK__TRY.93638c3051, now test.vg_casestudy.not_null_stg_staging_intermediate__transactions_transaction_amount.8dc65a17fe)
[0m13:54:23.222766 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.not_null_stg_staging_intermediate__transactions_transaction_amount.8dc65a17fe
[0m13:54:23.234342 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.not_null_stg_staging_intermediate__transactions_transaction_amount.8dc65a17fe"
[0m13:54:23.235440 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_stg_staging_intermediate__transactions_transaction_amount.8dc65a17fe (compile): 13:54:23.223136 => 13:54:23.235065
[0m13:54:23.236025 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.not_null_stg_staging_intermediate__transactions_transaction_amount.8dc65a17fe
[0m13:54:23.236651 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_stg_staging_intermediate__transactions_transaction_amount.8dc65a17fe (execute): 13:54:23.236390 => 13:54:23.236402
[0m13:54:23.238396 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.not_null_stg_staging_intermediate__transactions_transaction_amount.8dc65a17fe
[0m13:54:23.239503 [debug] [Thread-1 (]: Began running node test.vg_casestudy.not_null_stg_staging_intermediate__transactions_transaction_currency.fd19959743
[0m13:54:23.240619 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.not_null_stg_staging_intermediate__transactions_transaction_amount.8dc65a17fe, now test.vg_casestudy.not_null_stg_staging_intermediate__transactions_transaction_currency.fd19959743)
[0m13:54:23.241487 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.not_null_stg_staging_intermediate__transactions_transaction_currency.fd19959743
[0m13:54:23.249615 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.not_null_stg_staging_intermediate__transactions_transaction_currency.fd19959743"
[0m13:54:23.250756 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_stg_staging_intermediate__transactions_transaction_currency.fd19959743 (compile): 13:54:23.241980 => 13:54:23.250368
[0m13:54:23.251485 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.not_null_stg_staging_intermediate__transactions_transaction_currency.fd19959743
[0m13:54:23.252125 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_stg_staging_intermediate__transactions_transaction_currency.fd19959743 (execute): 13:54:23.251865 => 13:54:23.251877
[0m13:54:23.253443 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.not_null_stg_staging_intermediate__transactions_transaction_currency.fd19959743
[0m13:54:23.254085 [debug] [Thread-1 (]: Began running node test.vg_casestudy.not_null_stg_staging_intermediate__transactions_transaction_id.cb7402fe02
[0m13:54:23.255068 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.not_null_stg_staging_intermediate__transactions_transaction_currency.fd19959743, now test.vg_casestudy.not_null_stg_staging_intermediate__transactions_transaction_id.cb7402fe02)
[0m13:54:23.255881 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.not_null_stg_staging_intermediate__transactions_transaction_id.cb7402fe02
[0m13:54:23.263351 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.not_null_stg_staging_intermediate__transactions_transaction_id.cb7402fe02"
[0m13:54:23.264613 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_stg_staging_intermediate__transactions_transaction_id.cb7402fe02 (compile): 13:54:23.256326 => 13:54:23.264233
[0m13:54:23.265223 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.not_null_stg_staging_intermediate__transactions_transaction_id.cb7402fe02
[0m13:54:23.266149 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_stg_staging_intermediate__transactions_transaction_id.cb7402fe02 (execute): 13:54:23.265827 => 13:54:23.265843
[0m13:54:23.267591 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.not_null_stg_staging_intermediate__transactions_transaction_id.cb7402fe02
[0m13:54:23.268483 [debug] [Thread-1 (]: Began running node test.vg_casestudy.numeric_range_stg_staging_intermediate__transactions_transaction_amount__0.789e7a4361
[0m13:54:23.269947 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.not_null_stg_staging_intermediate__transactions_transaction_id.cb7402fe02, now test.vg_casestudy.numeric_range_stg_staging_intermediate__transactions_transaction_amount__0.789e7a4361)
[0m13:54:23.270769 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.numeric_range_stg_staging_intermediate__transactions_transaction_amount__0.789e7a4361
[0m13:54:23.278276 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.numeric_range_stg_staging_intermediate__transactions_transaction_amount__0.789e7a4361"
[0m13:54:23.279442 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.numeric_range_stg_staging_intermediate__transactions_transaction_amount__0.789e7a4361 (compile): 13:54:23.271188 => 13:54:23.279043
[0m13:54:23.280158 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.numeric_range_stg_staging_intermediate__transactions_transaction_amount__0.789e7a4361
[0m13:54:23.280796 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.numeric_range_stg_staging_intermediate__transactions_transaction_amount__0.789e7a4361 (execute): 13:54:23.280547 => 13:54:23.280558
[0m13:54:23.282255 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.numeric_range_stg_staging_intermediate__transactions_transaction_amount__0.789e7a4361
[0m13:54:23.283149 [debug] [Thread-1 (]: Began running node test.vg_casestudy.unique_stg_staging_intermediate__transactions_transaction_id.dbfd7b9b66
[0m13:54:23.284684 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.numeric_range_stg_staging_intermediate__transactions_transaction_amount__0.789e7a4361, now test.vg_casestudy.unique_stg_staging_intermediate__transactions_transaction_id.dbfd7b9b66)
[0m13:54:23.285561 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.unique_stg_staging_intermediate__transactions_transaction_id.dbfd7b9b66
[0m13:54:23.294019 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.unique_stg_staging_intermediate__transactions_transaction_id.dbfd7b9b66"
[0m13:54:23.295223 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.unique_stg_staging_intermediate__transactions_transaction_id.dbfd7b9b66 (compile): 13:54:23.286198 => 13:54:23.294867
[0m13:54:23.296327 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.unique_stg_staging_intermediate__transactions_transaction_id.dbfd7b9b66
[0m13:54:23.297580 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.unique_stg_staging_intermediate__transactions_transaction_id.dbfd7b9b66 (execute): 13:54:23.296939 => 13:54:23.296992
[0m13:54:23.299368 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.unique_stg_staging_intermediate__transactions_transaction_id.dbfd7b9b66
[0m13:54:23.300302 [debug] [Thread-1 (]: Began running node model.vg_casestudy.marts__customers_enriched
[0m13:54:23.302363 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.unique_stg_staging_intermediate__transactions_transaction_id.dbfd7b9b66, now model.vg_casestudy.marts__customers_enriched)
[0m13:54:23.303327 [debug] [Thread-1 (]: Began compiling node model.vg_casestudy.marts__customers_enriched
[0m13:54:23.310775 [debug] [Thread-1 (]: Writing injected SQL for node "model.vg_casestudy.marts__customers_enriched"
[0m13:54:23.312445 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.marts__customers_enriched (compile): 13:54:23.304000 => 13:54:23.311963
[0m13:54:23.313168 [debug] [Thread-1 (]: Began executing node model.vg_casestudy.marts__customers_enriched
[0m13:54:23.313822 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.marts__customers_enriched (execute): 13:54:23.313531 => 13:54:23.313543
[0m13:54:23.315141 [debug] [Thread-1 (]: Finished running node model.vg_casestudy.marts__customers_enriched
[0m13:54:23.315784 [debug] [Thread-1 (]: Began running node test.vg_casestudy.not_null_intermediate__branch_names_branch_id.7edecde87c
[0m13:54:23.317456 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.vg_casestudy.marts__customers_enriched, now test.vg_casestudy.not_null_intermediate__branch_names_branch_id.7edecde87c)
[0m13:54:23.318254 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.not_null_intermediate__branch_names_branch_id.7edecde87c
[0m13:54:23.329168 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.not_null_intermediate__branch_names_branch_id.7edecde87c"
[0m13:54:23.330459 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_intermediate__branch_names_branch_id.7edecde87c (compile): 13:54:23.318672 => 13:54:23.330037
[0m13:54:23.331168 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.not_null_intermediate__branch_names_branch_id.7edecde87c
[0m13:54:23.331991 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_intermediate__branch_names_branch_id.7edecde87c (execute): 13:54:23.331679 => 13:54:23.331697
[0m13:54:23.333722 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.not_null_intermediate__branch_names_branch_id.7edecde87c
[0m13:54:23.334543 [debug] [Thread-1 (]: Began running node test.vg_casestudy.not_null_intermediate__branch_names_branch_name.f5e9aa109d
[0m13:54:23.336051 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.not_null_intermediate__branch_names_branch_id.7edecde87c, now test.vg_casestudy.not_null_intermediate__branch_names_branch_name.f5e9aa109d)
[0m13:54:23.336693 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.not_null_intermediate__branch_names_branch_name.f5e9aa109d
[0m13:54:23.346459 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.not_null_intermediate__branch_names_branch_name.f5e9aa109d"
[0m13:54:23.347923 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_intermediate__branch_names_branch_name.f5e9aa109d (compile): 13:54:23.337144 => 13:54:23.347499
[0m13:54:23.348573 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.not_null_intermediate__branch_names_branch_name.f5e9aa109d
[0m13:54:23.349232 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_intermediate__branch_names_branch_name.f5e9aa109d (execute): 13:54:23.348938 => 13:54:23.348951
[0m13:54:23.350784 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.not_null_intermediate__branch_names_branch_name.f5e9aa109d
[0m13:54:23.351791 [debug] [Thread-1 (]: Began running node test.vg_casestudy.unique_intermediate__branch_names_branch_id.f3fd1c7d86
[0m13:54:23.353321 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.not_null_intermediate__branch_names_branch_name.f5e9aa109d, now test.vg_casestudy.unique_intermediate__branch_names_branch_id.f3fd1c7d86)
[0m13:54:23.354220 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.unique_intermediate__branch_names_branch_id.f3fd1c7d86
[0m13:54:23.363539 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.unique_intermediate__branch_names_branch_id.f3fd1c7d86"
[0m13:54:23.364672 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.unique_intermediate__branch_names_branch_id.f3fd1c7d86 (compile): 13:54:23.354890 => 13:54:23.364334
[0m13:54:23.365442 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.unique_intermediate__branch_names_branch_id.f3fd1c7d86
[0m13:54:23.366308 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.unique_intermediate__branch_names_branch_id.f3fd1c7d86 (execute): 13:54:23.365976 => 13:54:23.365989
[0m13:54:23.367821 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.unique_intermediate__branch_names_branch_id.f3fd1c7d86
[0m13:54:23.368522 [debug] [Thread-1 (]: Began running node test.vg_casestudy.not_null_stg_staging_intermediate__currencies_currency_iso_code.f7ebb4618b
[0m13:54:23.369882 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.unique_intermediate__branch_names_branch_id.f3fd1c7d86, now test.vg_casestudy.not_null_stg_staging_intermediate__currencies_currency_iso_code.f7ebb4618b)
[0m13:54:23.370697 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.not_null_stg_staging_intermediate__currencies_currency_iso_code.f7ebb4618b
[0m13:54:23.381254 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.not_null_stg_staging_intermediate__currencies_currency_iso_code.f7ebb4618b"
[0m13:54:23.382653 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_stg_staging_intermediate__currencies_currency_iso_code.f7ebb4618b (compile): 13:54:23.371333 => 13:54:23.382140
[0m13:54:23.383391 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.not_null_stg_staging_intermediate__currencies_currency_iso_code.f7ebb4618b
[0m13:54:23.384316 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_stg_staging_intermediate__currencies_currency_iso_code.f7ebb4618b (execute): 13:54:23.383920 => 13:54:23.383933
[0m13:54:23.386338 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.not_null_stg_staging_intermediate__currencies_currency_iso_code.f7ebb4618b
[0m13:54:23.387354 [debug] [Thread-1 (]: Began running node test.vg_casestudy.unique_stg_staging_intermediate__currencies_currency_iso_code.4396247af3
[0m13:54:23.388895 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.not_null_stg_staging_intermediate__currencies_currency_iso_code.f7ebb4618b, now test.vg_casestudy.unique_stg_staging_intermediate__currencies_currency_iso_code.4396247af3)
[0m13:54:23.389683 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.unique_stg_staging_intermediate__currencies_currency_iso_code.4396247af3
[0m13:54:23.399115 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.unique_stg_staging_intermediate__currencies_currency_iso_code.4396247af3"
[0m13:54:23.400468 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.unique_stg_staging_intermediate__currencies_currency_iso_code.4396247af3 (compile): 13:54:23.390113 => 13:54:23.400036
[0m13:54:23.401157 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.unique_stg_staging_intermediate__currencies_currency_iso_code.4396247af3
[0m13:54:23.402053 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.unique_stg_staging_intermediate__currencies_currency_iso_code.4396247af3 (execute): 13:54:23.401662 => 13:54:23.401679
[0m13:54:23.404071 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.unique_stg_staging_intermediate__currencies_currency_iso_code.4396247af3
[0m13:54:23.404858 [debug] [Thread-1 (]: Began running node model.vg_casestudy.marts__transactions_with_euro
[0m13:54:23.406419 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.unique_stg_staging_intermediate__currencies_currency_iso_code.4396247af3, now model.vg_casestudy.marts__transactions_with_euro)
[0m13:54:23.407259 [debug] [Thread-1 (]: Began compiling node model.vg_casestudy.marts__transactions_with_euro
[0m13:54:23.413525 [debug] [Thread-1 (]: Writing injected SQL for node "model.vg_casestudy.marts__transactions_with_euro"
[0m13:54:23.414955 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.marts__transactions_with_euro (compile): 13:54:23.407800 => 13:54:23.414545
[0m13:54:23.415721 [debug] [Thread-1 (]: Began executing node model.vg_casestudy.marts__transactions_with_euro
[0m13:54:23.416444 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.marts__transactions_with_euro (execute): 13:54:23.416152 => 13:54:23.416165
[0m13:54:23.418661 [debug] [Thread-1 (]: Finished running node model.vg_casestudy.marts__transactions_with_euro
[0m13:54:23.419639 [debug] [Thread-1 (]: Began running node test.vg_casestudy.not_null_intermediate__fx_rates_filled_currency_iso_code.1f6a8ce5a9
[0m13:54:23.420984 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.vg_casestudy.marts__transactions_with_euro, now test.vg_casestudy.not_null_intermediate__fx_rates_filled_currency_iso_code.1f6a8ce5a9)
[0m13:54:23.422217 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.not_null_intermediate__fx_rates_filled_currency_iso_code.1f6a8ce5a9
[0m13:54:23.430961 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.not_null_intermediate__fx_rates_filled_currency_iso_code.1f6a8ce5a9"
[0m13:54:23.432276 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_intermediate__fx_rates_filled_currency_iso_code.1f6a8ce5a9 (compile): 13:54:23.422811 => 13:54:23.431844
[0m13:54:23.433153 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.not_null_intermediate__fx_rates_filled_currency_iso_code.1f6a8ce5a9
[0m13:54:23.434462 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_intermediate__fx_rates_filled_currency_iso_code.1f6a8ce5a9 (execute): 13:54:23.433771 => 13:54:23.433788
[0m13:54:23.436344 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.not_null_intermediate__fx_rates_filled_currency_iso_code.1f6a8ce5a9
[0m13:54:23.437087 [debug] [Thread-1 (]: Began running node test.vg_casestudy.not_null_intermediate__fx_rates_filled_fx_rate.f3c3b417b4
[0m13:54:23.438436 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.not_null_intermediate__fx_rates_filled_currency_iso_code.1f6a8ce5a9, now test.vg_casestudy.not_null_intermediate__fx_rates_filled_fx_rate.f3c3b417b4)
[0m13:54:23.439304 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.not_null_intermediate__fx_rates_filled_fx_rate.f3c3b417b4
[0m13:54:23.448959 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.not_null_intermediate__fx_rates_filled_fx_rate.f3c3b417b4"
[0m13:54:23.450600 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_intermediate__fx_rates_filled_fx_rate.f3c3b417b4 (compile): 13:54:23.439953 => 13:54:23.450154
[0m13:54:23.451310 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.not_null_intermediate__fx_rates_filled_fx_rate.f3c3b417b4
[0m13:54:23.452090 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_intermediate__fx_rates_filled_fx_rate.f3c3b417b4 (execute): 13:54:23.451792 => 13:54:23.451805
[0m13:54:23.453669 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.not_null_intermediate__fx_rates_filled_fx_rate.f3c3b417b4
[0m13:54:23.454410 [debug] [Thread-1 (]: Began running node test.vg_casestudy.not_null_intermediate__fx_rates_filled_fx_rate_date.c67f41ac31
[0m13:54:23.455728 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.not_null_intermediate__fx_rates_filled_fx_rate.f3c3b417b4, now test.vg_casestudy.not_null_intermediate__fx_rates_filled_fx_rate_date.c67f41ac31)
[0m13:54:23.456444 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.not_null_intermediate__fx_rates_filled_fx_rate_date.c67f41ac31
[0m13:54:23.465187 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.not_null_intermediate__fx_rates_filled_fx_rate_date.c67f41ac31"
[0m13:54:23.466746 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_intermediate__fx_rates_filled_fx_rate_date.c67f41ac31 (compile): 13:54:23.456889 => 13:54:23.466260
[0m13:54:23.467737 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.not_null_intermediate__fx_rates_filled_fx_rate_date.c67f41ac31
[0m13:54:23.468739 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_intermediate__fx_rates_filled_fx_rate_date.c67f41ac31 (execute): 13:54:23.468354 => 13:54:23.468368
[0m13:54:23.470794 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.not_null_intermediate__fx_rates_filled_fx_rate_date.c67f41ac31
[0m13:54:23.472223 [debug] [Thread-1 (]: Began running node test.vg_casestudy.numeric_range_intermediate__fx_rates_filled_fx_rate__0.9f1d0149fd
[0m13:54:23.473997 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.not_null_intermediate__fx_rates_filled_fx_rate_date.c67f41ac31, now test.vg_casestudy.numeric_range_intermediate__fx_rates_filled_fx_rate__0.9f1d0149fd)
[0m13:54:23.474610 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.numeric_range_intermediate__fx_rates_filled_fx_rate__0.9f1d0149fd
[0m13:54:23.482802 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.numeric_range_intermediate__fx_rates_filled_fx_rate__0.9f1d0149fd"
[0m13:54:23.484259 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.numeric_range_intermediate__fx_rates_filled_fx_rate__0.9f1d0149fd (compile): 13:54:23.475016 => 13:54:23.483700
[0m13:54:23.484954 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.numeric_range_intermediate__fx_rates_filled_fx_rate__0.9f1d0149fd
[0m13:54:23.485631 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.numeric_range_intermediate__fx_rates_filled_fx_rate__0.9f1d0149fd (execute): 13:54:23.485362 => 13:54:23.485374
[0m13:54:23.487232 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.numeric_range_intermediate__fx_rates_filled_fx_rate__0.9f1d0149fd
[0m13:54:23.488124 [debug] [Thread-1 (]: Began running node model.vg_casestudy.marts__loans_enriched
[0m13:54:23.489466 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.numeric_range_intermediate__fx_rates_filled_fx_rate__0.9f1d0149fd, now model.vg_casestudy.marts__loans_enriched)
[0m13:54:23.490020 [debug] [Thread-1 (]: Began compiling node model.vg_casestudy.marts__loans_enriched
[0m13:54:23.495873 [debug] [Thread-1 (]: Writing injected SQL for node "model.vg_casestudy.marts__loans_enriched"
[0m13:54:23.497109 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.marts__loans_enriched (compile): 13:54:23.490427 => 13:54:23.496727
[0m13:54:23.497756 [debug] [Thread-1 (]: Began executing node model.vg_casestudy.marts__loans_enriched
[0m13:54:23.498394 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.marts__loans_enriched (execute): 13:54:23.498149 => 13:54:23.498161
[0m13:54:23.499781 [debug] [Thread-1 (]: Finished running node model.vg_casestudy.marts__loans_enriched
[0m13:54:23.500435 [debug] [Thread-1 (]: Began running node test.vg_casestudy.not_null_marts__customers_enriched_customer_id.9f6b6e0d1d
[0m13:54:23.501858 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.vg_casestudy.marts__loans_enriched, now test.vg_casestudy.not_null_marts__customers_enriched_customer_id.9f6b6e0d1d)
[0m13:54:23.503222 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.not_null_marts__customers_enriched_customer_id.9f6b6e0d1d
[0m13:54:23.514177 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.not_null_marts__customers_enriched_customer_id.9f6b6e0d1d"
[0m13:54:23.515336 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_marts__customers_enriched_customer_id.9f6b6e0d1d (compile): 13:54:23.503700 => 13:54:23.515018
[0m13:54:23.516009 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.not_null_marts__customers_enriched_customer_id.9f6b6e0d1d
[0m13:54:23.516886 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_marts__customers_enriched_customer_id.9f6b6e0d1d (execute): 13:54:23.516434 => 13:54:23.516449
[0m13:54:23.518406 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.not_null_marts__customers_enriched_customer_id.9f6b6e0d1d
[0m13:54:23.519206 [debug] [Thread-1 (]: Began running node test.vg_casestudy.not_null_marts__customers_enriched_has_account.138534d95d
[0m13:54:23.520521 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.not_null_marts__customers_enriched_customer_id.9f6b6e0d1d, now test.vg_casestudy.not_null_marts__customers_enriched_has_account.138534d95d)
[0m13:54:23.521323 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.not_null_marts__customers_enriched_has_account.138534d95d
[0m13:54:23.530775 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.not_null_marts__customers_enriched_has_account.138534d95d"
[0m13:54:23.532858 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_marts__customers_enriched_has_account.138534d95d (compile): 13:54:23.521927 => 13:54:23.532193
[0m13:54:23.534008 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.not_null_marts__customers_enriched_has_account.138534d95d
[0m13:54:23.535629 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_marts__customers_enriched_has_account.138534d95d (execute): 13:54:23.535095 => 13:54:23.535130
[0m13:54:23.537824 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.not_null_marts__customers_enriched_has_account.138534d95d
[0m13:54:23.538951 [debug] [Thread-1 (]: Began running node test.vg_casestudy.unique_marts__customers_enriched_customer_id.357be759c5
[0m13:54:23.540912 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.not_null_marts__customers_enriched_has_account.138534d95d, now test.vg_casestudy.unique_marts__customers_enriched_customer_id.357be759c5)
[0m13:54:23.542068 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.unique_marts__customers_enriched_customer_id.357be759c5
[0m13:54:23.550829 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.unique_marts__customers_enriched_customer_id.357be759c5"
[0m13:54:23.553090 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.unique_marts__customers_enriched_customer_id.357be759c5 (compile): 13:54:23.542748 => 13:54:23.552014
[0m13:54:23.554061 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.unique_marts__customers_enriched_customer_id.357be759c5
[0m13:54:23.555360 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.unique_marts__customers_enriched_customer_id.357be759c5 (execute): 13:54:23.554526 => 13:54:23.554544
[0m13:54:23.557368 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.unique_marts__customers_enriched_customer_id.357be759c5
[0m13:54:23.558664 [debug] [Thread-1 (]: Began running node test.vg_casestudy.not_null_marts__transactions_with_euro_account_id.4f3997d532
[0m13:54:23.560337 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.unique_marts__customers_enriched_customer_id.357be759c5, now test.vg_casestudy.not_null_marts__transactions_with_euro_account_id.4f3997d532)
[0m13:54:23.561422 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.not_null_marts__transactions_with_euro_account_id.4f3997d532
[0m13:54:23.570571 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.not_null_marts__transactions_with_euro_account_id.4f3997d532"
[0m13:54:23.572154 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_marts__transactions_with_euro_account_id.4f3997d532 (compile): 13:54:23.561904 => 13:54:23.571690
[0m13:54:23.572995 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.not_null_marts__transactions_with_euro_account_id.4f3997d532
[0m13:54:23.573991 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_marts__transactions_with_euro_account_id.4f3997d532 (execute): 13:54:23.573554 => 13:54:23.573571
[0m13:54:23.575579 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.not_null_marts__transactions_with_euro_account_id.4f3997d532
[0m13:54:23.576350 [debug] [Thread-1 (]: Began running node test.vg_casestudy.not_null_marts__transactions_with_euro_transaction_amount.69049a90b0
[0m13:54:23.577803 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.not_null_marts__transactions_with_euro_account_id.4f3997d532, now test.vg_casestudy.not_null_marts__transactions_with_euro_transaction_amount.69049a90b0)
[0m13:54:23.578526 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.not_null_marts__transactions_with_euro_transaction_amount.69049a90b0
[0m13:54:23.588112 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.not_null_marts__transactions_with_euro_transaction_amount.69049a90b0"
[0m13:54:23.589653 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_marts__transactions_with_euro_transaction_amount.69049a90b0 (compile): 13:54:23.578994 => 13:54:23.589100
[0m13:54:23.590701 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.not_null_marts__transactions_with_euro_transaction_amount.69049a90b0
[0m13:54:23.591967 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_marts__transactions_with_euro_transaction_amount.69049a90b0 (execute): 13:54:23.591378 => 13:54:23.591398
[0m13:54:23.593985 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.not_null_marts__transactions_with_euro_transaction_amount.69049a90b0
[0m13:54:23.595052 [debug] [Thread-1 (]: Began running node test.vg_casestudy.not_null_marts__transactions_with_euro_transaction_amount_euro.97d050c1ee
[0m13:54:23.596543 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.not_null_marts__transactions_with_euro_transaction_amount.69049a90b0, now test.vg_casestudy.not_null_marts__transactions_with_euro_transaction_amount_euro.97d050c1ee)
[0m13:54:23.597579 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.not_null_marts__transactions_with_euro_transaction_amount_euro.97d050c1ee
[0m13:54:23.608575 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.not_null_marts__transactions_with_euro_transaction_amount_euro.97d050c1ee"
[0m13:54:23.610024 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_marts__transactions_with_euro_transaction_amount_euro.97d050c1ee (compile): 13:54:23.598222 => 13:54:23.609490
[0m13:54:23.610731 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.not_null_marts__transactions_with_euro_transaction_amount_euro.97d050c1ee
[0m13:54:23.611737 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_marts__transactions_with_euro_transaction_amount_euro.97d050c1ee (execute): 13:54:23.611209 => 13:54:23.611345
[0m13:54:23.613977 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.not_null_marts__transactions_with_euro_transaction_amount_euro.97d050c1ee
[0m13:54:23.615368 [debug] [Thread-1 (]: Began running node test.vg_casestudy.not_null_marts__transactions_with_euro_transaction_date.721c98ce00
[0m13:54:23.617923 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.not_null_marts__transactions_with_euro_transaction_amount_euro.97d050c1ee, now test.vg_casestudy.not_null_marts__transactions_with_euro_transaction_date.721c98ce00)
[0m13:54:23.618689 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.not_null_marts__transactions_with_euro_transaction_date.721c98ce00
[0m13:54:23.626494 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.not_null_marts__transactions_with_euro_transaction_date.721c98ce00"
[0m13:54:23.627943 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_marts__transactions_with_euro_transaction_date.721c98ce00 (compile): 13:54:23.619166 => 13:54:23.627491
[0m13:54:23.628569 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.not_null_marts__transactions_with_euro_transaction_date.721c98ce00
[0m13:54:23.629210 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_marts__transactions_with_euro_transaction_date.721c98ce00 (execute): 13:54:23.628933 => 13:54:23.628944
[0m13:54:23.630749 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.not_null_marts__transactions_with_euro_transaction_date.721c98ce00
[0m13:54:23.631599 [debug] [Thread-1 (]: Began running node test.vg_casestudy.not_null_marts__transactions_with_euro_transaction_id.6e046ff102
[0m13:54:23.633265 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.not_null_marts__transactions_with_euro_transaction_date.721c98ce00, now test.vg_casestudy.not_null_marts__transactions_with_euro_transaction_id.6e046ff102)
[0m13:54:23.633970 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.not_null_marts__transactions_with_euro_transaction_id.6e046ff102
[0m13:54:23.643136 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.not_null_marts__transactions_with_euro_transaction_id.6e046ff102"
[0m13:54:23.644952 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_marts__transactions_with_euro_transaction_id.6e046ff102 (compile): 13:54:23.634363 => 13:54:23.644455
[0m13:54:23.645633 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.not_null_marts__transactions_with_euro_transaction_id.6e046ff102
[0m13:54:23.646991 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_marts__transactions_with_euro_transaction_id.6e046ff102 (execute): 13:54:23.646483 => 13:54:23.646507
[0m13:54:23.649380 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.not_null_marts__transactions_with_euro_transaction_id.6e046ff102
[0m13:54:23.650561 [debug] [Thread-1 (]: Began running node test.vg_casestudy.numeric_range_marts__transactions_with_euro_transaction_amount__0.05fc32c05a
[0m13:54:23.651830 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.not_null_marts__transactions_with_euro_transaction_id.6e046ff102, now test.vg_casestudy.numeric_range_marts__transactions_with_euro_transaction_amount__0.05fc32c05a)
[0m13:54:23.653021 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.numeric_range_marts__transactions_with_euro_transaction_amount__0.05fc32c05a
[0m13:54:23.661375 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.numeric_range_marts__transactions_with_euro_transaction_amount__0.05fc32c05a"
[0m13:54:23.663009 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.numeric_range_marts__transactions_with_euro_transaction_amount__0.05fc32c05a (compile): 13:54:23.653693 => 13:54:23.662205
[0m13:54:23.664162 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.numeric_range_marts__transactions_with_euro_transaction_amount__0.05fc32c05a
[0m13:54:23.665178 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.numeric_range_marts__transactions_with_euro_transaction_amount__0.05fc32c05a (execute): 13:54:23.664766 => 13:54:23.664781
[0m13:54:23.666981 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.numeric_range_marts__transactions_with_euro_transaction_amount__0.05fc32c05a
[0m13:54:23.667880 [debug] [Thread-1 (]: Began running node test.vg_casestudy.numeric_range_marts__transactions_with_euro_transaction_amount_euro__0.f1f40b7198
[0m13:54:23.669363 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.numeric_range_marts__transactions_with_euro_transaction_amount__0.05fc32c05a, now test.vg_casestudy.numeric_range_marts__transactions_with_euro_transaction_amount_euro__0.f1f40b7198)
[0m13:54:23.670025 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.numeric_range_marts__transactions_with_euro_transaction_amount_euro__0.f1f40b7198
[0m13:54:23.681203 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.numeric_range_marts__transactions_with_euro_transaction_amount_euro__0.f1f40b7198"
[0m13:54:23.682690 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.numeric_range_marts__transactions_with_euro_transaction_amount_euro__0.f1f40b7198 (compile): 13:54:23.670428 => 13:54:23.682167
[0m13:54:23.683315 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.numeric_range_marts__transactions_with_euro_transaction_amount_euro__0.f1f40b7198
[0m13:54:23.684027 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.numeric_range_marts__transactions_with_euro_transaction_amount_euro__0.f1f40b7198 (execute): 13:54:23.683736 => 13:54:23.683748
[0m13:54:23.685349 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.numeric_range_marts__transactions_with_euro_transaction_amount_euro__0.f1f40b7198
[0m13:54:23.686000 [debug] [Thread-1 (]: Began running node test.vg_casestudy.unique_marts__transactions_with_euro_transaction_id.f76d81c454
[0m13:54:23.687124 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.numeric_range_marts__transactions_with_euro_transaction_amount_euro__0.f1f40b7198, now test.vg_casestudy.unique_marts__transactions_with_euro_transaction_id.f76d81c454)
[0m13:54:23.687928 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.unique_marts__transactions_with_euro_transaction_id.f76d81c454
[0m13:54:23.695438 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.unique_marts__transactions_with_euro_transaction_id.f76d81c454"
[0m13:54:23.697225 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.unique_marts__transactions_with_euro_transaction_id.f76d81c454 (compile): 13:54:23.688397 => 13:54:23.696660
[0m13:54:23.698464 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.unique_marts__transactions_with_euro_transaction_id.f76d81c454
[0m13:54:23.699487 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.unique_marts__transactions_with_euro_transaction_id.f76d81c454 (execute): 13:54:23.699141 => 13:54:23.699160
[0m13:54:23.700943 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.unique_marts__transactions_with_euro_transaction_id.f76d81c454
[0m13:54:23.701740 [debug] [Thread-1 (]: Began running node model.vg_casestudy.reporting__branch_loan_type_kpis
[0m13:54:23.703011 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.unique_marts__transactions_with_euro_transaction_id.f76d81c454, now model.vg_casestudy.reporting__branch_loan_type_kpis)
[0m13:54:23.703556 [debug] [Thread-1 (]: Began compiling node model.vg_casestudy.reporting__branch_loan_type_kpis
[0m13:54:23.709218 [debug] [Thread-1 (]: Writing injected SQL for node "model.vg_casestudy.reporting__branch_loan_type_kpis"
[0m13:54:23.710848 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.reporting__branch_loan_type_kpis (compile): 13:54:23.704040 => 13:54:23.710282
[0m13:54:23.711686 [debug] [Thread-1 (]: Began executing node model.vg_casestudy.reporting__branch_loan_type_kpis
[0m13:54:23.712459 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.reporting__branch_loan_type_kpis (execute): 13:54:23.712174 => 13:54:23.712188
[0m13:54:23.713846 [debug] [Thread-1 (]: Finished running node model.vg_casestudy.reporting__branch_loan_type_kpis
[0m13:54:23.714477 [debug] [Thread-1 (]: Began running node model.vg_casestudy.reporting__high_lvl_branch_loan_kpis
[0m13:54:23.715641 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.vg_casestudy.reporting__branch_loan_type_kpis, now model.vg_casestudy.reporting__high_lvl_branch_loan_kpis)
[0m13:54:23.716411 [debug] [Thread-1 (]: Began compiling node model.vg_casestudy.reporting__high_lvl_branch_loan_kpis
[0m13:54:23.722071 [debug] [Thread-1 (]: Writing injected SQL for node "model.vg_casestudy.reporting__high_lvl_branch_loan_kpis"
[0m13:54:23.723414 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.reporting__high_lvl_branch_loan_kpis (compile): 13:54:23.716841 => 13:54:23.722995
[0m13:54:23.724175 [debug] [Thread-1 (]: Began executing node model.vg_casestudy.reporting__high_lvl_branch_loan_kpis
[0m13:54:23.725353 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.reporting__high_lvl_branch_loan_kpis (execute): 13:54:23.724976 => 13:54:23.724988
[0m13:54:23.726961 [debug] [Thread-1 (]: Finished running node model.vg_casestudy.reporting__high_lvl_branch_loan_kpis
[0m13:54:23.727802 [debug] [Thread-1 (]: Began running node test.vg_casestudy.accepted_values_marts__loans_enriched_loan_term__12__24__36__48__60.21f8e81786
[0m13:54:23.729280 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.vg_casestudy.reporting__high_lvl_branch_loan_kpis, now test.vg_casestudy.accepted_values_marts__loans_enriched_loan_term__12__24__36__48__60.21f8e81786)
[0m13:54:23.730211 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.accepted_values_marts__loans_enriched_loan_term__12__24__36__48__60.21f8e81786
[0m13:54:23.737501 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.accepted_values_marts__loans_enriched_loan_term__12__24__36__48__60.21f8e81786"
[0m13:54:23.738613 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.accepted_values_marts__loans_enriched_loan_term__12__24__36__48__60.21f8e81786 (compile): 13:54:23.730699 => 13:54:23.738243
[0m13:54:23.739208 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.accepted_values_marts__loans_enriched_loan_term__12__24__36__48__60.21f8e81786
[0m13:54:23.740294 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.accepted_values_marts__loans_enriched_loan_term__12__24__36__48__60.21f8e81786 (execute): 13:54:23.739923 => 13:54:23.739943
[0m13:54:23.742122 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.accepted_values_marts__loans_enriched_loan_term__12__24__36__48__60.21f8e81786
[0m13:54:23.743177 [debug] [Thread-1 (]: Began running node test.vg_casestudy.date_is_past_marts__loans_enriched_approval_rejection_date.a81ce407f3
[0m13:54:23.744585 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.accepted_values_marts__loans_enriched_loan_term__12__24__36__48__60.21f8e81786, now test.vg_casestudy.date_is_past_marts__loans_enriched_approval_rejection_date.a81ce407f3)
[0m13:54:23.745237 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.date_is_past_marts__loans_enriched_approval_rejection_date.a81ce407f3
[0m13:54:23.751909 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.date_is_past_marts__loans_enriched_approval_rejection_date.a81ce407f3"
[0m13:54:23.753032 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.date_is_past_marts__loans_enriched_approval_rejection_date.a81ce407f3 (compile): 13:54:23.745651 => 13:54:23.752698
[0m13:54:23.753767 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.date_is_past_marts__loans_enriched_approval_rejection_date.a81ce407f3
[0m13:54:23.754515 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.date_is_past_marts__loans_enriched_approval_rejection_date.a81ce407f3 (execute): 13:54:23.754241 => 13:54:23.754253
[0m13:54:23.756105 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.date_is_past_marts__loans_enriched_approval_rejection_date.a81ce407f3
[0m13:54:23.757020 [debug] [Thread-1 (]: Began running node test.vg_casestudy.not_null_marts__loans_enriched_approval_rejection_date.02c905742e
[0m13:54:23.758369 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.date_is_past_marts__loans_enriched_approval_rejection_date.a81ce407f3, now test.vg_casestudy.not_null_marts__loans_enriched_approval_rejection_date.02c905742e)
[0m13:54:23.758977 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.not_null_marts__loans_enriched_approval_rejection_date.02c905742e
[0m13:54:23.767068 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.not_null_marts__loans_enriched_approval_rejection_date.02c905742e"
[0m13:54:23.768160 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_marts__loans_enriched_approval_rejection_date.02c905742e (compile): 13:54:23.759632 => 13:54:23.767827
[0m13:54:23.768723 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.not_null_marts__loans_enriched_approval_rejection_date.02c905742e
[0m13:54:23.769517 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_marts__loans_enriched_approval_rejection_date.02c905742e (execute): 13:54:23.769131 => 13:54:23.769142
[0m13:54:23.770961 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.not_null_marts__loans_enriched_approval_rejection_date.02c905742e
[0m13:54:23.771953 [debug] [Thread-1 (]: Began running node test.vg_casestudy.not_null_marts__loans_enriched_customer_id.00cac09a92
[0m13:54:23.773573 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.not_null_marts__loans_enriched_approval_rejection_date.02c905742e, now test.vg_casestudy.not_null_marts__loans_enriched_customer_id.00cac09a92)
[0m13:54:23.774292 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.not_null_marts__loans_enriched_customer_id.00cac09a92
[0m13:54:23.781246 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.not_null_marts__loans_enriched_customer_id.00cac09a92"
[0m13:54:23.782352 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_marts__loans_enriched_customer_id.00cac09a92 (compile): 13:54:23.774703 => 13:54:23.781995
[0m13:54:23.783203 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.not_null_marts__loans_enriched_customer_id.00cac09a92
[0m13:54:23.784037 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_marts__loans_enriched_customer_id.00cac09a92 (execute): 13:54:23.783713 => 13:54:23.783730
[0m13:54:23.785520 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.not_null_marts__loans_enriched_customer_id.00cac09a92
[0m13:54:23.786230 [debug] [Thread-1 (]: Began running node test.vg_casestudy.not_null_marts__loans_enriched_has_account.210268f1d2
[0m13:54:23.788203 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.not_null_marts__loans_enriched_customer_id.00cac09a92, now test.vg_casestudy.not_null_marts__loans_enriched_has_account.210268f1d2)
[0m13:54:23.789248 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.not_null_marts__loans_enriched_has_account.210268f1d2
[0m13:54:23.797603 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.not_null_marts__loans_enriched_has_account.210268f1d2"
[0m13:54:23.798820 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_marts__loans_enriched_has_account.210268f1d2 (compile): 13:54:23.789974 => 13:54:23.798333
[0m13:54:23.799556 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.not_null_marts__loans_enriched_has_account.210268f1d2
[0m13:54:23.800328 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_marts__loans_enriched_has_account.210268f1d2 (execute): 13:54:23.800044 => 13:54:23.800058
[0m13:54:23.801864 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.not_null_marts__loans_enriched_has_account.210268f1d2
[0m13:54:23.802812 [debug] [Thread-1 (]: Began running node test.vg_casestudy.not_null_marts__loans_enriched_interest_rate.d5d58de544
[0m13:54:23.804160 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.not_null_marts__loans_enriched_has_account.210268f1d2, now test.vg_casestudy.not_null_marts__loans_enriched_interest_rate.d5d58de544)
[0m13:54:23.804743 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.not_null_marts__loans_enriched_interest_rate.d5d58de544
[0m13:54:23.815312 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.not_null_marts__loans_enriched_interest_rate.d5d58de544"
[0m13:54:23.816534 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_marts__loans_enriched_interest_rate.d5d58de544 (compile): 13:54:23.805122 => 13:54:23.816124
[0m13:54:23.817250 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.not_null_marts__loans_enriched_interest_rate.d5d58de544
[0m13:54:23.818186 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_marts__loans_enriched_interest_rate.d5d58de544 (execute): 13:54:23.817856 => 13:54:23.817874
[0m13:54:23.819536 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.not_null_marts__loans_enriched_interest_rate.d5d58de544
[0m13:54:23.820415 [debug] [Thread-1 (]: Began running node test.vg_casestudy.not_null_marts__loans_enriched_loan_amount.7ac237f98a
[0m13:54:23.821593 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.not_null_marts__loans_enriched_interest_rate.d5d58de544, now test.vg_casestudy.not_null_marts__loans_enriched_loan_amount.7ac237f98a)
[0m13:54:23.822412 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.not_null_marts__loans_enriched_loan_amount.7ac237f98a
[0m13:54:23.830503 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.not_null_marts__loans_enriched_loan_amount.7ac237f98a"
[0m13:54:23.831889 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_marts__loans_enriched_loan_amount.7ac237f98a (compile): 13:54:23.822901 => 13:54:23.831342
[0m13:54:23.832754 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.not_null_marts__loans_enriched_loan_amount.7ac237f98a
[0m13:54:23.833537 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_marts__loans_enriched_loan_amount.7ac237f98a (execute): 13:54:23.833227 => 13:54:23.833240
[0m13:54:23.835233 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.not_null_marts__loans_enriched_loan_amount.7ac237f98a
[0m13:54:23.836216 [debug] [Thread-1 (]: Began running node test.vg_casestudy.not_null_marts__loans_enriched_loan_id.b4ebbacf31
[0m13:54:23.837616 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.not_null_marts__loans_enriched_loan_amount.7ac237f98a, now test.vg_casestudy.not_null_marts__loans_enriched_loan_id.b4ebbacf31)
[0m13:54:23.838444 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.not_null_marts__loans_enriched_loan_id.b4ebbacf31
[0m13:54:23.846616 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.not_null_marts__loans_enriched_loan_id.b4ebbacf31"
[0m13:54:23.848211 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_marts__loans_enriched_loan_id.b4ebbacf31 (compile): 13:54:23.839012 => 13:54:23.847389
[0m13:54:23.849030 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.not_null_marts__loans_enriched_loan_id.b4ebbacf31
[0m13:54:23.850109 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_marts__loans_enriched_loan_id.b4ebbacf31 (execute): 13:54:23.849677 => 13:54:23.849697
[0m13:54:23.851831 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.not_null_marts__loans_enriched_loan_id.b4ebbacf31
[0m13:54:23.852550 [debug] [Thread-1 (]: Began running node test.vg_casestudy.not_null_marts__loans_enriched_loan_status.4490ac67ad
[0m13:54:23.854024 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.not_null_marts__loans_enriched_loan_id.b4ebbacf31, now test.vg_casestudy.not_null_marts__loans_enriched_loan_status.4490ac67ad)
[0m13:54:23.854730 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.not_null_marts__loans_enriched_loan_status.4490ac67ad
[0m13:54:23.862967 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.not_null_marts__loans_enriched_loan_status.4490ac67ad"
[0m13:54:23.864404 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_marts__loans_enriched_loan_status.4490ac67ad (compile): 13:54:23.855116 => 13:54:23.863995
[0m13:54:23.865013 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.not_null_marts__loans_enriched_loan_status.4490ac67ad
[0m13:54:23.865823 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_marts__loans_enriched_loan_status.4490ac67ad (execute): 13:54:23.865501 => 13:54:23.865514
[0m13:54:23.867622 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.not_null_marts__loans_enriched_loan_status.4490ac67ad
[0m13:54:23.868544 [debug] [Thread-1 (]: Began running node test.vg_casestudy.not_null_marts__loans_enriched_loan_term.ed68e0638e
[0m13:54:23.869955 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.not_null_marts__loans_enriched_loan_status.4490ac67ad, now test.vg_casestudy.not_null_marts__loans_enriched_loan_term.ed68e0638e)
[0m13:54:23.870612 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.not_null_marts__loans_enriched_loan_term.ed68e0638e
[0m13:54:23.878423 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.not_null_marts__loans_enriched_loan_term.ed68e0638e"
[0m13:54:23.879770 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_marts__loans_enriched_loan_term.ed68e0638e (compile): 13:54:23.871052 => 13:54:23.879189
[0m13:54:23.880633 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.not_null_marts__loans_enriched_loan_term.ed68e0638e
[0m13:54:23.881788 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_marts__loans_enriched_loan_term.ed68e0638e (execute): 13:54:23.881343 => 13:54:23.881365
[0m13:54:23.883776 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.not_null_marts__loans_enriched_loan_term.ed68e0638e
[0m13:54:23.884781 [debug] [Thread-1 (]: Began running node test.vg_casestudy.not_null_marts__loans_enriched_loan_type.9ad7e6410e
[0m13:54:23.885972 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.not_null_marts__loans_enriched_loan_term.ed68e0638e, now test.vg_casestudy.not_null_marts__loans_enriched_loan_type.9ad7e6410e)
[0m13:54:23.886542 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.not_null_marts__loans_enriched_loan_type.9ad7e6410e
[0m13:54:23.894160 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.not_null_marts__loans_enriched_loan_type.9ad7e6410e"
[0m13:54:23.895702 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_marts__loans_enriched_loan_type.9ad7e6410e (compile): 13:54:23.886918 => 13:54:23.895126
[0m13:54:23.896431 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.not_null_marts__loans_enriched_loan_type.9ad7e6410e
[0m13:54:23.897084 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_marts__loans_enriched_loan_type.9ad7e6410e (execute): 13:54:23.896813 => 13:54:23.896825
[0m13:54:23.898419 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.not_null_marts__loans_enriched_loan_type.9ad7e6410e
[0m13:54:23.899191 [debug] [Thread-1 (]: Began running node test.vg_casestudy.numeric_range_marts__loans_enriched_interest_rate__0.a85a00acdc
[0m13:54:23.900922 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.not_null_marts__loans_enriched_loan_type.9ad7e6410e, now test.vg_casestudy.numeric_range_marts__loans_enriched_interest_rate__0.a85a00acdc)
[0m13:54:23.901891 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.numeric_range_marts__loans_enriched_interest_rate__0.a85a00acdc
[0m13:54:23.911953 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.numeric_range_marts__loans_enriched_interest_rate__0.a85a00acdc"
[0m13:54:23.913251 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.numeric_range_marts__loans_enriched_interest_rate__0.a85a00acdc (compile): 13:54:23.902585 => 13:54:23.912806
[0m13:54:23.913964 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.numeric_range_marts__loans_enriched_interest_rate__0.a85a00acdc
[0m13:54:23.914680 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.numeric_range_marts__loans_enriched_interest_rate__0.a85a00acdc (execute): 13:54:23.914412 => 13:54:23.914424
[0m13:54:23.916055 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.numeric_range_marts__loans_enriched_interest_rate__0.a85a00acdc
[0m13:54:23.916715 [debug] [Thread-1 (]: Began running node test.vg_casestudy.numeric_range_marts__loans_enriched_loan_amount__0.fae897c4b6
[0m13:54:23.917925 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.numeric_range_marts__loans_enriched_interest_rate__0.a85a00acdc, now test.vg_casestudy.numeric_range_marts__loans_enriched_loan_amount__0.fae897c4b6)
[0m13:54:23.918499 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.numeric_range_marts__loans_enriched_loan_amount__0.fae897c4b6
[0m13:54:23.925810 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.numeric_range_marts__loans_enriched_loan_amount__0.fae897c4b6"
[0m13:54:23.927964 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.numeric_range_marts__loans_enriched_loan_amount__0.fae897c4b6 (compile): 13:54:23.918872 => 13:54:23.926783
[0m13:54:23.928808 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.numeric_range_marts__loans_enriched_loan_amount__0.fae897c4b6
[0m13:54:23.930014 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.numeric_range_marts__loans_enriched_loan_amount__0.fae897c4b6 (execute): 13:54:23.929262 => 13:54:23.929280
[0m13:54:23.931817 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.numeric_range_marts__loans_enriched_loan_amount__0.fae897c4b6
[0m13:54:23.932899 [debug] [Thread-1 (]: Began running node test.vg_casestudy.unique_marts__loans_enriched_customer_id.6bdf2f639d
[0m13:54:23.934477 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.numeric_range_marts__loans_enriched_loan_amount__0.fae897c4b6, now test.vg_casestudy.unique_marts__loans_enriched_customer_id.6bdf2f639d)
[0m13:54:23.935298 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.unique_marts__loans_enriched_customer_id.6bdf2f639d
[0m13:54:23.942981 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.unique_marts__loans_enriched_customer_id.6bdf2f639d"
[0m13:54:23.944301 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.unique_marts__loans_enriched_customer_id.6bdf2f639d (compile): 13:54:23.935881 => 13:54:23.943828
[0m13:54:23.945220 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.unique_marts__loans_enriched_customer_id.6bdf2f639d
[0m13:54:23.946550 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.unique_marts__loans_enriched_customer_id.6bdf2f639d (execute): 13:54:23.946047 => 13:54:23.946067
[0m13:54:23.948683 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.unique_marts__loans_enriched_customer_id.6bdf2f639d
[0m13:54:23.949433 [debug] [Thread-1 (]: Began running node test.vg_casestudy.unique_marts__loans_enriched_loan_id.8812d67526
[0m13:54:23.950778 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.unique_marts__loans_enriched_customer_id.6bdf2f639d, now test.vg_casestudy.unique_marts__loans_enriched_loan_id.8812d67526)
[0m13:54:23.951389 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.unique_marts__loans_enriched_loan_id.8812d67526
[0m13:54:23.959819 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.unique_marts__loans_enriched_loan_id.8812d67526"
[0m13:54:23.960972 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.unique_marts__loans_enriched_loan_id.8812d67526 (compile): 13:54:23.951988 => 13:54:23.960612
[0m13:54:23.962175 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.unique_marts__loans_enriched_loan_id.8812d67526
[0m13:54:23.963322 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.unique_marts__loans_enriched_loan_id.8812d67526 (execute): 13:54:23.962857 => 13:54:23.962876
[0m13:54:23.965720 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.unique_marts__loans_enriched_loan_id.8812d67526
[0m13:54:23.968277 [debug] [Thread-1 (]: Began running node test.vg_casestudy.not_null_reporting__branch_loan_type_kpis_branch_id.202f7b1035
[0m13:54:23.976078 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.unique_marts__loans_enriched_loan_id.8812d67526, now test.vg_casestudy.not_null_reporting__branch_loan_type_kpis_branch_id.202f7b1035)
[0m13:54:23.976939 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.not_null_reporting__branch_loan_type_kpis_branch_id.202f7b1035
[0m13:54:23.984512 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.not_null_reporting__branch_loan_type_kpis_branch_id.202f7b1035"
[0m13:54:23.986225 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_reporting__branch_loan_type_kpis_branch_id.202f7b1035 (compile): 13:54:23.977437 => 13:54:23.985586
[0m13:54:23.987060 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.not_null_reporting__branch_loan_type_kpis_branch_id.202f7b1035
[0m13:54:23.988311 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_reporting__branch_loan_type_kpis_branch_id.202f7b1035 (execute): 13:54:23.987703 => 13:54:23.987723
[0m13:54:23.990017 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.not_null_reporting__branch_loan_type_kpis_branch_id.202f7b1035
[0m13:54:23.990810 [debug] [Thread-1 (]: Began running node test.vg_casestudy.not_null_reporting__high_lvl_branch_loan_kpis_branch_id.1ad6d682e7
[0m13:54:23.992260 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.vg_casestudy.not_null_reporting__branch_loan_type_kpis_branch_id.202f7b1035, now test.vg_casestudy.not_null_reporting__high_lvl_branch_loan_kpis_branch_id.1ad6d682e7)
[0m13:54:23.993115 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.not_null_reporting__high_lvl_branch_loan_kpis_branch_id.1ad6d682e7
[0m13:54:24.000713 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.not_null_reporting__high_lvl_branch_loan_kpis_branch_id.1ad6d682e7"
[0m13:54:24.002141 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_reporting__high_lvl_branch_loan_kpis_branch_id.1ad6d682e7 (compile): 13:54:23.993713 => 13:54:24.001615
[0m13:54:24.003018 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.not_null_reporting__high_lvl_branch_loan_kpis_branch_id.1ad6d682e7
[0m13:54:24.004297 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_reporting__high_lvl_branch_loan_kpis_branch_id.1ad6d682e7 (execute): 13:54:24.003560 => 13:54:24.003577
[0m13:54:24.006334 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.not_null_reporting__high_lvl_branch_loan_kpis_branch_id.1ad6d682e7
[0m13:54:24.008793 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:54:24.009722 [debug] [MainThread]: Connection 'test.vg_casestudy.not_null_reporting__high_lvl_branch_loan_kpis_branch_id.1ad6d682e7' was properly closed.
[0m13:54:24.036084 [debug] [MainThread]: Command end result
[0m13:54:24.130462 [debug] [MainThread]: Acquiring new duckdb connection 'generate_catalog'
[0m13:54:24.138656 [info ] [MainThread]: Building catalog
[0m13:54:24.148745 [debug] [ThreadPool]: Acquiring new duckdb connection 'casestudy.information_schema'
[0m13:54:24.179859 [debug] [ThreadPool]: Using duckdb connection "casestudy.information_schema"
[0m13:54:24.185325 [debug] [ThreadPool]: On casestudy.information_schema: BEGIN
[0m13:54:24.186396 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:54:24.239273 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:54:24.240215 [debug] [ThreadPool]: Using duckdb connection "casestudy.information_schema"
[0m13:54:24.240880 [debug] [ThreadPool]: On casestudy.information_schema: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "casestudy.information_schema"} */
select
        'casestudy' as table_database,
        t.table_schema,
        t.table_name,
        t.table_type,
        '' as table_comment,
        c.column_name,
        c.ordinal_position as column_index,
        c.data_type column_type,
        '' as column_comment,
        '' as table_owner
    FROM information_schema.tables t JOIN information_schema.columns c ON t.table_schema = c.table_schema AND t.table_name = c.table_name
    WHERE (upper(t.table_schema) = upper('marts') or upper(t.table_schema) = upper('staging') or upper(t.table_schema) = upper('raw') or upper(t.table_schema) = upper('intermediate') or upper(t.table_schema) = upper('reporting'))
    AND t.table_type IN ('BASE TABLE', 'VIEW')
    ORDER BY
        t.table_schema,
        t.table_name,
        c.ordinal_position
[0m13:54:24.288230 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:54:24.316654 [debug] [ThreadPool]: On casestudy.information_schema: ROLLBACK
[0m13:54:24.318603 [debug] [ThreadPool]: Failed to rollback 'casestudy.information_schema'
[0m13:54:24.319364 [debug] [ThreadPool]: On casestudy.information_schema: Close
[0m13:54:24.423527 [info ] [MainThread]: Catalog written to /workspaces/vg_case_study_tim/transformation/target/catalog.json
[0m13:54:24.426708 [debug] [MainThread]: Command `dbt docs generate` succeeded at 13:54:24.426288 after 4.69 seconds
[0m13:54:24.427701 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m13:54:24.428775 [debug] [MainThread]: Connection 'casestudy.information_schema' was properly closed.
[0m13:54:24.429744 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff1bc5b2d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff1de22250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff14f172d0>]}
[0m13:54:24.430836 [debug] [MainThread]: Flushing usage events
[0m13:54:44.160642 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1e624f810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1e63fb5d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1e66ec150>]}


============================== 13:54:44.165931 | 18743601-4d2b-4b68-929b-f7b97d9d4dd3 ==============================
[0m13:54:44.165931 [info ] [MainThread]: Running with dbt=1.6.18
[0m13:54:44.167178 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/workspaces/vg_case_study_tim/transformation', 'log_path': '/workspaces/vg_case_study_tim/transformation/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt docs serve', 'send_anonymous_usage_stats': 'True'}
[0m13:54:44.391300 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '18743601-4d2b-4b68-929b-f7b97d9d4dd3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1e64eefd0>]}
[0m13:54:44.420242 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '18743601-4d2b-4b68-929b-f7b97d9d4dd3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1e71c70d0>]}
[0m15:18:07.050267 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe5cdcbd6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe5cdcdacd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe5cdb66b10>]}


============================== 15:18:07.056604 | e33094fa-73c4-4394-8d59-f5a3bede873d ==============================
[0m15:18:07.056604 [info ] [MainThread]: Running with dbt=1.6.18
[0m15:18:07.057162 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/workspaces/vg_case_study_tim/transformation', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/workspaces/vg_case_study_tim/transformation/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt debug', 'send_anonymous_usage_stats': 'True'}
[0m15:18:07.057531 [info ] [MainThread]: dbt version: 1.6.18
[0m15:18:07.057871 [info ] [MainThread]: python version: 3.11.6
[0m15:18:07.058211 [info ] [MainThread]: python path: /usr/local/bin/python
[0m15:18:07.058518 [info ] [MainThread]: os info: Linux-5.15.153.1-microsoft-standard-WSL2-x86_64-with-glibc2.31
[0m15:18:07.200193 [info ] [MainThread]: Using profiles dir at /workspaces/vg_case_study_tim/transformation
[0m15:18:07.200684 [info ] [MainThread]: Using profiles.yml file at /workspaces/vg_case_study_tim/transformation/profiles.yml
[0m15:18:07.201017 [info ] [MainThread]: Using dbt_project.yml file at /workspaces/vg_case_study_tim/transformation/dbt_project.yml
[0m15:18:07.201994 [info ] [MainThread]: adapter type: duckdb
[0m15:18:07.202347 [info ] [MainThread]: adapter version: 1.6.2
[0m15:18:07.234722 [info ] [MainThread]: Configuration:
[0m15:18:07.235225 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m15:18:07.235538 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m15:18:07.235819 [info ] [MainThread]: Required dependencies:
[0m15:18:07.236117 [debug] [MainThread]: Executing "git --help"
[0m15:18:07.237712 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m15:18:07.238165 [debug] [MainThread]: STDERR: "b''"
[0m15:18:07.238456 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m15:18:07.238758 [info ] [MainThread]: Connection:
[0m15:18:07.239050 [info ] [MainThread]:   database: casestudy
[0m15:18:07.239338 [info ] [MainThread]:   schema: main
[0m15:18:07.239607 [info ] [MainThread]:   path: casestudy.duckdb
[0m15:18:07.239875 [info ] [MainThread]:   config_options: None
[0m15:18:07.240140 [info ] [MainThread]:   extensions: ['icu']
[0m15:18:07.240404 [info ] [MainThread]:   settings: None
[0m15:18:07.240667 [info ] [MainThread]:   external_root: .
[0m15:18:07.240934 [info ] [MainThread]:   use_credential_provider: None
[0m15:18:07.241197 [info ] [MainThread]:   attach: None
[0m15:18:07.241478 [info ] [MainThread]:   filesystems: None
[0m15:18:07.241744 [info ] [MainThread]:   remote: None
[0m15:18:07.242057 [info ] [MainThread]:   plugins: None
[0m15:18:07.242374 [info ] [MainThread]:   disable_transactions: False
[0m15:18:07.242869 [info ] [MainThread]: Registered adapter: duckdb=1.6.2
[0m15:18:07.243489 [debug] [MainThread]: Acquiring new duckdb connection 'debug'
[0m15:18:07.243824 [debug] [MainThread]: Using duckdb connection "debug"
[0m15:18:07.244105 [debug] [MainThread]: On debug: select 1 as id
[0m15:18:07.244551 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:18:07.337529 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m15:18:07.338007 [info ] [MainThread]: [31m1 check failed:[0m
[0m15:18:07.338336 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Runtime Error
  IO Error: Could not set lock on file "/workspaces/vg_case_study_tim/transformation/casestudy.duckdb": Conflicting lock is held in /root/.duckdb/cli/1.3.2/duckdb (PID 5606). See also https://duckdb.org/docs/stable/connect/concurrency

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m15:18:07.338833 [debug] [MainThread]: Command `dbt debug` failed at 15:18:07.338715 after 0.30 seconds
[0m15:18:07.339145 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m15:18:07.339448 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe5ceb03650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe5cd6df390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe5cdc951d0>]}
[0m15:18:07.339793 [debug] [MainThread]: Flushing usage events
[0m15:19:03.396861 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73277f5b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7329345f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7327827f10>]}


============================== 15:19:03.400330 | bfa5cc27-60f7-43b9-89f2-1b469fe7a55a ==============================
[0m15:19:03.400330 [info ] [MainThread]: Running with dbt=1.6.18
[0m15:19:03.400918 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/workspaces/vg_case_study_tim/transformation', 'log_path': '/workspaces/vg_case_study_tim/transformation/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt debug', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:19:03.401317 [info ] [MainThread]: dbt version: 1.6.18
[0m15:19:03.401684 [info ] [MainThread]: python version: 3.11.6
[0m15:19:03.402041 [info ] [MainThread]: python path: /usr/local/bin/python
[0m15:19:03.402443 [info ] [MainThread]: os info: Linux-5.15.153.1-microsoft-standard-WSL2-x86_64-with-glibc2.31
[0m15:19:03.470724 [info ] [MainThread]: Using profiles dir at /workspaces/vg_case_study_tim/transformation
[0m15:19:03.471233 [info ] [MainThread]: Using profiles.yml file at /workspaces/vg_case_study_tim/transformation/profiles.yml
[0m15:19:03.471558 [info ] [MainThread]: Using dbt_project.yml file at /workspaces/vg_case_study_tim/transformation/dbt_project.yml
[0m15:19:03.472047 [info ] [MainThread]: adapter type: duckdb
[0m15:19:03.472443 [info ] [MainThread]: adapter version: 1.6.2
[0m15:19:03.505991 [info ] [MainThread]: Configuration:
[0m15:19:03.506479 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m15:19:03.506792 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m15:19:03.507091 [info ] [MainThread]: Required dependencies:
[0m15:19:03.507400 [debug] [MainThread]: Executing "git --help"
[0m15:19:03.508891 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m15:19:03.509290 [debug] [MainThread]: STDERR: "b''"
[0m15:19:03.509594 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m15:19:03.509942 [info ] [MainThread]: Connection:
[0m15:19:03.510293 [info ] [MainThread]:   database: casestudy
[0m15:19:03.510583 [info ] [MainThread]:   schema: main
[0m15:19:03.510855 [info ] [MainThread]:   path: casestudy.duckdb
[0m15:19:03.511125 [info ] [MainThread]:   config_options: None
[0m15:19:03.511390 [info ] [MainThread]:   extensions: ['icu']
[0m15:19:03.511653 [info ] [MainThread]:   settings: None
[0m15:19:03.511928 [info ] [MainThread]:   external_root: .
[0m15:19:03.512193 [info ] [MainThread]:   use_credential_provider: None
[0m15:19:03.512506 [info ] [MainThread]:   attach: None
[0m15:19:03.512776 [info ] [MainThread]:   filesystems: None
[0m15:19:03.513040 [info ] [MainThread]:   remote: None
[0m15:19:03.513358 [info ] [MainThread]:   plugins: None
[0m15:19:03.513666 [info ] [MainThread]:   disable_transactions: False
[0m15:19:03.514154 [info ] [MainThread]: Registered adapter: duckdb=1.6.2
[0m15:19:03.514954 [debug] [MainThread]: Acquiring new duckdb connection 'debug'
[0m15:19:03.515416 [debug] [MainThread]: Using duckdb connection "debug"
[0m15:19:03.515769 [debug] [MainThread]: On debug: select 1 as id
[0m15:19:03.516096 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:19:03.589238 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m15:19:03.590308 [debug] [MainThread]: On debug: Close
[0m15:19:03.593940 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m15:19:03.594407 [info ] [MainThread]: [32mAll checks passed![0m
[0m15:19:03.594978 [debug] [MainThread]: Command `dbt debug` succeeded at 15:19:03.594824 after 0.21 seconds
[0m15:19:03.595300 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m15:19:03.595655 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73277d4b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73279c8390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73279f51d0>]}
[0m15:19:03.596097 [debug] [MainThread]: Flushing usage events
[0m16:18:21.638342 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3cd14624d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3cd1333350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3cd0fce190>]}


============================== 16:18:21.644413 | 1029bf04-cc08-4d4e-81bc-cd890861dbdb ==============================
[0m16:18:21.644413 [info ] [MainThread]: Running with dbt=1.6.18
[0m16:18:21.645049 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/workspaces/vg_case_study_tim/transformation/logs', 'version_check': 'True', 'profiles_dir': '/workspaces/vg_case_study_tim/transformation', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt debug', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:18:21.645464 [info ] [MainThread]: dbt version: 1.6.18
[0m16:18:21.645847 [info ] [MainThread]: python version: 3.11.6
[0m16:18:21.646181 [info ] [MainThread]: python path: /usr/local/bin/python
[0m16:18:21.646482 [info ] [MainThread]: os info: Linux-5.15.153.1-microsoft-standard-WSL2-x86_64-with-glibc2.31
[0m16:18:21.784500 [info ] [MainThread]: Using profiles dir at /workspaces/vg_case_study_tim/transformation
[0m16:18:21.785034 [info ] [MainThread]: Using profiles.yml file at /workspaces/vg_case_study_tim/transformation/profiles.yml
[0m16:18:21.785379 [info ] [MainThread]: Using dbt_project.yml file at /workspaces/vg_case_study_tim/transformation/dbt_project.yml
[0m16:18:21.786626 [info ] [MainThread]: adapter type: duckdb
[0m16:18:21.787048 [info ] [MainThread]: adapter version: 1.6.2
[0m16:18:21.819845 [info ] [MainThread]: Configuration:
[0m16:18:21.820351 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m16:18:21.820775 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m16:18:21.821121 [info ] [MainThread]: Required dependencies:
[0m16:18:21.821454 [debug] [MainThread]: Executing "git --help"
[0m16:18:21.823261 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m16:18:21.823691 [debug] [MainThread]: STDERR: "b''"
[0m16:18:21.823977 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m16:18:21.824309 [info ] [MainThread]: Connection:
[0m16:18:21.824602 [info ] [MainThread]:   database: casestudy
[0m16:18:21.824889 [info ] [MainThread]:   schema: main
[0m16:18:21.825157 [info ] [MainThread]:   path: casestudy.duckdb
[0m16:18:21.825425 [info ] [MainThread]:   config_options: None
[0m16:18:21.825693 [info ] [MainThread]:   extensions: ['icu']
[0m16:18:21.825958 [info ] [MainThread]:   settings: None
[0m16:18:21.826220 [info ] [MainThread]:   external_root: .
[0m16:18:21.826510 [info ] [MainThread]:   use_credential_provider: None
[0m16:18:21.826834 [info ] [MainThread]:   attach: None
[0m16:18:21.827224 [info ] [MainThread]:   filesystems: None
[0m16:18:21.827604 [info ] [MainThread]:   remote: None
[0m16:18:21.827932 [info ] [MainThread]:   plugins: None
[0m16:18:21.828253 [info ] [MainThread]:   disable_transactions: False
[0m16:18:21.828605 [info ] [MainThread]: Registered adapter: duckdb=1.6.2
[0m16:18:21.829138 [debug] [MainThread]: Acquiring new duckdb connection 'debug'
[0m16:18:21.829456 [debug] [MainThread]: Using duckdb connection "debug"
[0m16:18:21.829723 [debug] [MainThread]: On debug: select 1 as id
[0m16:18:21.829972 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:18:21.962301 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:18:21.963508 [debug] [MainThread]: On debug: Close
[0m16:18:21.966536 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m16:18:21.967157 [info ] [MainThread]: [32mAll checks passed![0m
[0m16:18:21.967859 [debug] [MainThread]: Command `dbt debug` succeeded at 16:18:21.967673 after 0.34 seconds
[0m16:18:21.968246 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m16:18:21.968647 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3cd1174510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3cd1174610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3cd5ae3410>]}
[0m16:18:21.969013 [debug] [MainThread]: Flushing usage events
[0m16:19:05.506882 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6440811950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6440a95550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f64406204d0>]}


============================== 16:19:05.510020 | b98f1ed5-6c3d-4fb1-ada2-c90348408073 ==============================
[0m16:19:05.510020 [info ] [MainThread]: Running with dbt=1.6.18
[0m16:19:05.510619 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/workspaces/vg_case_study_tim/transformation/logs', 'profiles_dir': '/workspaces/vg_case_study_tim/transformation', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select reporting__hihg_lvl_branch_transactions_kpis', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:19:05.647290 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b98f1ed5-6c3d-4fb1-ada2-c90348408073', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f644077b310>]}
[0m16:19:05.661958 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b98f1ed5-6c3d-4fb1-ada2-c90348408073', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f64407a51d0>]}
[0m16:19:05.662671 [info ] [MainThread]: Registered adapter: duckdb=1.6.2
[0m16:19:05.692863 [debug] [MainThread]: checksum: 7b9fab86a08e9e96a48a825af743c566d95b877e068b8c6d0dbafbf714447189, vars: {}, profile: , target: , version: 1.6.18
[0m16:19:05.790947 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 0 files changed.
[0m16:19:05.791808 [debug] [MainThread]: Partial parsing: added file: vg_casestudy://models/reporting/reporting__high_lvl_branch_transactions_kpis.sql
[0m16:19:05.792295 [debug] [MainThread]: Partial parsing: added file: vg_casestudy://models/reporting/reporting__high_lvl_branch_transactions_kpis.yml
[0m16:19:05.901732 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'reporting__branch_transaction_kpis' in the 'models' section of file 'models/reporting/reporting__high_lvl_branch_transactions_kpis.yml'
[0m16:19:05.924662 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.vg_casestudy.not_null_reporting__branch_transaction_kpis_branch_id.548206ad5a' (models/reporting/reporting__high_lvl_branch_transactions_kpis.yml) depends on a node named 'reporting__branch_transaction_kpis' in package '' which was not found
[0m16:19:05.945177 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.vg_casestudy.main
[0m16:19:05.955267 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b98f1ed5-6c3d-4fb1-ada2-c90348408073', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f64407a5c10>]}
[0m16:19:05.994938 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b98f1ed5-6c3d-4fb1-ada2-c90348408073', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f643c53e1d0>]}
[0m16:19:05.995508 [info ] [MainThread]: Found 19 models, 1 analysis, 4 seeds, 114 tests, 5 sources, 0 exposures, 0 metrics, 632 macros, 0 groups, 0 semantic models
[0m16:19:05.995917 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b98f1ed5-6c3d-4fb1-ada2-c90348408073', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6440516b10>]}
[0m16:19:05.997450 [warn ] [MainThread]: The selection criterion 'reporting__hihg_lvl_branch_transactions_kpis' does not match any nodes
[0m16:19:05.999155 [info ] [MainThread]: 
[0m16:19:05.999527 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m16:19:05.999989 [debug] [MainThread]: Command end result
[0m16:19:06.018847 [debug] [MainThread]: Command `dbt run` succeeded at 16:19:06.018653 after 0.52 seconds
[0m16:19:06.019310 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6440655dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f643c56d450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f64450d7fd0>]}
[0m16:19:06.019704 [debug] [MainThread]: Flushing usage events
[0m16:19:37.746583 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0ab2e8e150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0ab2b03390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0ab53e1c10>]}


============================== 16:19:37.749236 | c7815efb-89b3-4c7c-b146-9ad64d29de64 ==============================
[0m16:19:37.749236 [info ] [MainThread]: Running with dbt=1.6.18
[0m16:19:37.749845 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/workspaces/vg_case_study_tim/transformation/logs', 'version_check': 'True', 'profiles_dir': '/workspaces/vg_case_study_tim/transformation', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --select reporting__high_lvl_branch_transactions_kpis', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m16:19:37.844570 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c7815efb-89b3-4c7c-b146-9ad64d29de64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0ab2b4ff90>]}
[0m16:19:37.858535 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c7815efb-89b3-4c7c-b146-9ad64d29de64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0ab2a2b6d0>]}
[0m16:19:37.859239 [info ] [MainThread]: Registered adapter: duckdb=1.6.2
[0m16:19:37.883442 [debug] [MainThread]: checksum: 7b9fab86a08e9e96a48a825af743c566d95b877e068b8c6d0dbafbf714447189, vars: {}, profile: , target: , version: 1.6.18
[0m16:19:37.931085 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:19:37.931483 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:19:37.933053 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.vg_casestudy.main
[0m16:19:37.942974 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c7815efb-89b3-4c7c-b146-9ad64d29de64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0ab27646d0>]}
[0m16:19:38.021079 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c7815efb-89b3-4c7c-b146-9ad64d29de64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0ab26e4e90>]}
[0m16:19:38.021641 [info ] [MainThread]: Found 19 models, 1 analysis, 4 seeds, 114 tests, 5 sources, 0 exposures, 0 metrics, 632 macros, 0 groups, 0 semantic models
[0m16:19:38.022126 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c7815efb-89b3-4c7c-b146-9ad64d29de64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0ab2a2b950>]}
[0m16:19:38.024987 [info ] [MainThread]: 
[0m16:19:38.025807 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m16:19:38.027911 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_casestudy'
[0m16:19:38.042051 [debug] [ThreadPool]: Using duckdb connection "list_casestudy"
[0m16:19:38.042539 [debug] [ThreadPool]: On list_casestudy: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"casestudy"'
    
  
  
[0m16:19:38.042852 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:19:38.064331 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:19:38.065690 [debug] [ThreadPool]: On list_casestudy: Close
[0m16:19:38.071372 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy, now create_casestudy_reporting)
[0m16:19:38.072279 [debug] [ThreadPool]: Creating schema "database: "casestudy"
schema: "reporting"
"
[0m16:19:38.078233 [debug] [ThreadPool]: Using duckdb connection "create_casestudy_reporting"
[0m16:19:38.078691 [debug] [ThreadPool]: On create_casestudy_reporting: BEGIN
[0m16:19:38.078987 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:19:38.091814 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:19:38.092262 [debug] [ThreadPool]: Using duckdb connection "create_casestudy_reporting"
[0m16:19:38.092567 [debug] [ThreadPool]: On create_casestudy_reporting: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "create_casestudy_reporting"} */
create schema if not exists "casestudy"."reporting"
[0m16:19:38.093173 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:19:38.094099 [debug] [ThreadPool]: On create_casestudy_reporting: COMMIT
[0m16:19:38.094421 [debug] [ThreadPool]: Using duckdb connection "create_casestudy_reporting"
[0m16:19:38.094687 [debug] [ThreadPool]: On create_casestudy_reporting: COMMIT
[0m16:19:38.095202 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:19:38.095504 [debug] [ThreadPool]: On create_casestudy_reporting: Close
[0m16:19:38.101874 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_casestudy_reporting, now list_casestudy_reporting)
[0m16:19:38.107222 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_reporting"
[0m16:19:38.107611 [debug] [ThreadPool]: On list_casestudy_reporting: BEGIN
[0m16:19:38.107911 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:19:38.119090 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:19:38.119543 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_reporting"
[0m16:19:38.119921 [debug] [ThreadPool]: On list_casestudy_reporting: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_reporting"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'reporting'
    and table_catalog = 'casestudy'
  
[0m16:19:38.136215 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:19:38.137766 [debug] [ThreadPool]: On list_casestudy_reporting: ROLLBACK
[0m16:19:38.140155 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_reporting'
[0m16:19:38.140481 [debug] [ThreadPool]: On list_casestudy_reporting: Close
[0m16:19:38.145460 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy_reporting, now list_casestudy_intermediate)
[0m16:19:38.147669 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_intermediate"
[0m16:19:38.148084 [debug] [ThreadPool]: On list_casestudy_intermediate: BEGIN
[0m16:19:38.148386 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:19:38.160229 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:19:38.160632 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_intermediate"
[0m16:19:38.160952 [debug] [ThreadPool]: On list_casestudy_intermediate: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_intermediate"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'intermediate'
    and table_catalog = 'casestudy'
  
[0m16:19:38.169273 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:19:38.171098 [debug] [ThreadPool]: On list_casestudy_intermediate: ROLLBACK
[0m16:19:38.171601 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_intermediate'
[0m16:19:38.171883 [debug] [ThreadPool]: On list_casestudy_intermediate: Close
[0m16:19:38.174752 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy_intermediate, now list_casestudy_staging)
[0m16:19:38.176971 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_staging"
[0m16:19:38.177323 [debug] [ThreadPool]: On list_casestudy_staging: BEGIN
[0m16:19:38.178834 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:19:38.190634 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:19:38.191049 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_staging"
[0m16:19:38.191363 [debug] [ThreadPool]: On list_casestudy_staging: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_staging"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'staging'
    and table_catalog = 'casestudy'
  
[0m16:19:38.199530 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:19:38.201144 [debug] [ThreadPool]: On list_casestudy_staging: ROLLBACK
[0m16:19:38.201792 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_staging'
[0m16:19:38.202176 [debug] [ThreadPool]: On list_casestudy_staging: Close
[0m16:19:38.205634 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy_staging, now list_casestudy_marts)
[0m16:19:38.208028 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_marts"
[0m16:19:38.209276 [debug] [ThreadPool]: On list_casestudy_marts: BEGIN
[0m16:19:38.209568 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:19:38.220752 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:19:38.221308 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_marts"
[0m16:19:38.221759 [debug] [ThreadPool]: On list_casestudy_marts: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_marts"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'marts'
    and table_catalog = 'casestudy'
  
[0m16:19:38.229949 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:19:38.231177 [debug] [ThreadPool]: On list_casestudy_marts: ROLLBACK
[0m16:19:38.231648 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_marts'
[0m16:19:38.231904 [debug] [ThreadPool]: On list_casestudy_marts: Close
[0m16:19:38.234793 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy_marts, now list_casestudy_raw)
[0m16:19:38.237845 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_raw"
[0m16:19:38.238249 [debug] [ThreadPool]: On list_casestudy_raw: BEGIN
[0m16:19:38.238545 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:19:38.249488 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:19:38.249962 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_raw"
[0m16:19:38.250267 [debug] [ThreadPool]: On list_casestudy_raw: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_raw"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'raw'
    and table_catalog = 'casestudy'
  
[0m16:19:38.260920 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:19:38.262337 [debug] [ThreadPool]: On list_casestudy_raw: ROLLBACK
[0m16:19:38.262831 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_raw'
[0m16:19:38.263127 [debug] [ThreadPool]: On list_casestudy_raw: Close
[0m16:19:38.267234 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c7815efb-89b3-4c7c-b146-9ad64d29de64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0aae681710>]}
[0m16:19:38.267793 [debug] [MainThread]: Using duckdb connection "master"
[0m16:19:38.268202 [debug] [MainThread]: On master: BEGIN
[0m16:19:38.268463 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:19:38.281875 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:19:38.282393 [debug] [MainThread]: On master: COMMIT
[0m16:19:38.282707 [debug] [MainThread]: Using duckdb connection "master"
[0m16:19:38.282967 [debug] [MainThread]: On master: COMMIT
[0m16:19:38.283595 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:19:38.283890 [debug] [MainThread]: On master: Close
[0m16:19:38.286508 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:19:38.286986 [info ] [MainThread]: 
[0m16:19:38.292705 [debug] [Thread-1 (]: Began running node model.vg_casestudy.reporting__high_lvl_branch_transactions_kpis
[0m16:19:38.293283 [info ] [Thread-1 (]: 1 of 1 START sql table model reporting.reporting__high_lvl_branch_transactions_kpis  [RUN]
[0m16:19:38.294094 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.vg_casestudy.reporting__high_lvl_branch_transactions_kpis'
[0m16:19:38.294467 [debug] [Thread-1 (]: Began compiling node model.vg_casestudy.reporting__high_lvl_branch_transactions_kpis
[0m16:19:38.305521 [debug] [Thread-1 (]: Writing injected SQL for node "model.vg_casestudy.reporting__high_lvl_branch_transactions_kpis"
[0m16:19:38.306928 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.reporting__high_lvl_branch_transactions_kpis (compile): 16:19:38.294711 => 16:19:38.306658
[0m16:19:38.307414 [debug] [Thread-1 (]: Began executing node model.vg_casestudy.reporting__high_lvl_branch_transactions_kpis
[0m16:19:38.342280 [debug] [Thread-1 (]: Writing runtime sql for node "model.vg_casestudy.reporting__high_lvl_branch_transactions_kpis"
[0m16:19:38.343153 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.reporting__high_lvl_branch_transactions_kpis"
[0m16:19:38.343578 [debug] [Thread-1 (]: On model.vg_casestudy.reporting__high_lvl_branch_transactions_kpis: BEGIN
[0m16:19:38.343882 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:19:38.363228 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:19:38.363701 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.reporting__high_lvl_branch_transactions_kpis"
[0m16:19:38.364111 [debug] [Thread-1 (]: On model.vg_casestudy.reporting__high_lvl_branch_transactions_kpis: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.reporting__high_lvl_branch_transactions_kpis"} */

  
    
    

    create  table
      "casestudy"."reporting"."reporting__high_lvl_branch_transactions_kpis__dbt_tmp"
  
    as (
      with transactions as (
    select *
    from "casestudy"."marts"."marts__transactions_with_euro"
)

customers as (
    select *
    from "casestudy"."marts"."marts__customers_enriched"
),

joined as (
    select 
        transactions.*,
        customers.*

    from transactions 
    left join customers 
    on transactions.account_id = customers.account_id
),

aggregated as(
    select 
        branch_id,
        branch_name,
        transaction_date,

        --transaction volume
        count(transaction_id) as count_transactions,
        count(case when transaction_type = 'deposit' then transaction_id end) as count_deposits,
        count(case when transaction_type = 'withdrawal' then transaction_id end) as count_withdrawals,
        count(case when transaction_type = 'transfer' then transaction_id end) as count_transfers,

        --customer segmentation
        count(distinct customer_id) as unique_customers,
        count(case when age < 30 then transaction_id end) as transactions_under_30,
        count(case when age between 30 and 50 then transaction_id end) as transactions_30_to_50,
        count(case when age > 50 then transaction_id end) as transactions_over_50,
        count(case when age < 30 then transaction_id end)::float / count(transaction_id) as share_customers_under_30,
        count(case when age between 30 and 50 then transaction_id end)::float / count(transaction_id) as share_customers_30_to_50,
        count(case when age > 50 then transaction_id end)::float / count(transaction_id) as share_customers_over_50,

        --transaction kpis
        sum(transaction_amount_euro) as total_transaction_amount_euro,
        avg(transaction_amount_euro) as avg_transaction_amount_euro,
        count(distinct transaction_currency) as num_transaction_currencies,
        count(case when has_account is true then transaction_id end) as transactions_with_account,
        count(case when has_account is false then transaction_id end) as transactions_without_account

    from joined
    group by branch_id, branch_name, transaction_date
)

select * 
from aggregated
    );
  
  
[0m16:19:38.376980 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.reporting__high_lvl_branch_transactions_kpis (execute): 16:19:38.307693 => 16:19:38.376693
[0m16:19:38.377431 [debug] [Thread-1 (]: On model.vg_casestudy.reporting__high_lvl_branch_transactions_kpis: ROLLBACK
[0m16:19:38.385690 [debug] [Thread-1 (]: Failed to rollback 'model.vg_casestudy.reporting__high_lvl_branch_transactions_kpis'
[0m16:19:38.386100 [debug] [Thread-1 (]: On model.vg_casestudy.reporting__high_lvl_branch_transactions_kpis: Close
[0m16:19:38.391135 [debug] [Thread-1 (]: Runtime Error in model reporting__high_lvl_branch_transactions_kpis (models/reporting/reporting__high_lvl_branch_transactions_kpis.sql)
  Parser Error: syntax error at or near "customers"
[0m16:19:38.391674 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c7815efb-89b3-4c7c-b146-9ad64d29de64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0ab27a07d0>]}
[0m16:19:38.392269 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model reporting.reporting__high_lvl_branch_transactions_kpis  [[31mERROR[0m in 0.10s]
[0m16:19:38.392833 [debug] [Thread-1 (]: Finished running node model.vg_casestudy.reporting__high_lvl_branch_transactions_kpis
[0m16:19:38.394943 [debug] [MainThread]: Using duckdb connection "master"
[0m16:19:38.395308 [debug] [MainThread]: On master: BEGIN
[0m16:19:38.395601 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:19:38.408665 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:19:38.409262 [debug] [MainThread]: On master: COMMIT
[0m16:19:38.409580 [debug] [MainThread]: Using duckdb connection "master"
[0m16:19:38.409943 [debug] [MainThread]: On master: COMMIT
[0m16:19:38.410721 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:19:38.411178 [debug] [MainThread]: On master: Close
[0m16:19:38.414196 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:19:38.414578 [debug] [MainThread]: Connection 'list_casestudy_raw' was properly closed.
[0m16:19:38.414884 [debug] [MainThread]: Connection 'model.vg_casestudy.reporting__high_lvl_branch_transactions_kpis' was properly closed.
[0m16:19:38.415288 [info ] [MainThread]: 
[0m16:19:38.415660 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.39 seconds (0.39s).
[0m16:19:38.416304 [debug] [MainThread]: Command end result
[0m16:19:38.438449 [info ] [MainThread]: 
[0m16:19:38.438978 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m16:19:38.439318 [info ] [MainThread]: 
[0m16:19:38.439722 [error] [MainThread]:   Runtime Error in model reporting__high_lvl_branch_transactions_kpis (models/reporting/reporting__high_lvl_branch_transactions_kpis.sql)
  Parser Error: syntax error at or near "customers"
[0m16:19:38.440126 [info ] [MainThread]: 
[0m16:19:38.440466 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m16:19:38.440954 [debug] [MainThread]: Command `dbt run` failed at 16:19:38.440851 after 0.70 seconds
[0m16:19:38.441337 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0ab45b2150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0ab2d3bb10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0ab5055590>]}
[0m16:19:38.441804 [debug] [MainThread]: Flushing usage events
[0m16:20:10.053683 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd77150e850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd76d607a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd76da44d50>]}


============================== 16:20:10.056450 | 11a6c1dd-6775-426a-8b90-812db5bffe0c ==============================
[0m16:20:10.056450 [info ] [MainThread]: Running with dbt=1.6.18
[0m16:20:10.056991 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/workspaces/vg_case_study_tim/transformation', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/workspaces/vg_case_study_tim/transformation/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run --select reporting__high_lvl_branch_transactions_kpis', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:20:10.164895 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '11a6c1dd-6775-426a-8b90-812db5bffe0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd76da5c290>]}
[0m16:20:10.178979 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '11a6c1dd-6775-426a-8b90-812db5bffe0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd76d860c50>]}
[0m16:20:10.179649 [info ] [MainThread]: Registered adapter: duckdb=1.6.2
[0m16:20:10.204823 [debug] [MainThread]: checksum: 7b9fab86a08e9e96a48a825af743c566d95b877e068b8c6d0dbafbf714447189, vars: {}, profile: , target: , version: 1.6.18
[0m16:20:10.258486 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:20:10.259497 [debug] [MainThread]: Partial parsing: updated file: vg_casestudy://models/reporting/reporting__high_lvl_branch_transactions_kpis.sql
[0m16:20:10.356273 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.vg_casestudy.main
[0m16:20:10.364262 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '11a6c1dd-6775-426a-8b90-812db5bffe0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd76d71c150>]}
[0m16:20:10.403085 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '11a6c1dd-6775-426a-8b90-812db5bffe0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd7692a1550>]}
[0m16:20:10.403741 [info ] [MainThread]: Found 19 models, 1 analysis, 4 seeds, 114 tests, 5 sources, 0 exposures, 0 metrics, 632 macros, 0 groups, 0 semantic models
[0m16:20:10.404182 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '11a6c1dd-6775-426a-8b90-812db5bffe0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd76d9002d0>]}
[0m16:20:10.407168 [info ] [MainThread]: 
[0m16:20:10.408066 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m16:20:10.410141 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_casestudy'
[0m16:20:10.426363 [debug] [ThreadPool]: Using duckdb connection "list_casestudy"
[0m16:20:10.426827 [debug] [ThreadPool]: On list_casestudy: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"casestudy"'
    
  
  
[0m16:20:10.427163 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:20:10.453286 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:20:10.455236 [debug] [ThreadPool]: On list_casestudy: Close
[0m16:20:10.461203 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy, now create_casestudy_reporting)
[0m16:20:10.461966 [debug] [ThreadPool]: Creating schema "database: "casestudy"
schema: "reporting"
"
[0m16:20:10.466005 [debug] [ThreadPool]: Using duckdb connection "create_casestudy_reporting"
[0m16:20:10.466324 [debug] [ThreadPool]: On create_casestudy_reporting: BEGIN
[0m16:20:10.466633 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:20:10.480246 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:20:10.480687 [debug] [ThreadPool]: Using duckdb connection "create_casestudy_reporting"
[0m16:20:10.480982 [debug] [ThreadPool]: On create_casestudy_reporting: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "create_casestudy_reporting"} */
create schema if not exists "casestudy"."reporting"
[0m16:20:10.481680 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:20:10.482591 [debug] [ThreadPool]: On create_casestudy_reporting: COMMIT
[0m16:20:10.482901 [debug] [ThreadPool]: Using duckdb connection "create_casestudy_reporting"
[0m16:20:10.483172 [debug] [ThreadPool]: On create_casestudy_reporting: COMMIT
[0m16:20:10.483703 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:20:10.484009 [debug] [ThreadPool]: On create_casestudy_reporting: Close
[0m16:20:10.489379 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_casestudy_reporting, now list_casestudy_marts)
[0m16:20:10.495080 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_marts"
[0m16:20:10.495452 [debug] [ThreadPool]: On list_casestudy_marts: BEGIN
[0m16:20:10.495743 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:20:10.508721 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:20:10.509128 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_marts"
[0m16:20:10.509422 [debug] [ThreadPool]: On list_casestudy_marts: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_marts"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'marts'
    and table_catalog = 'casestudy'
  
[0m16:20:10.518857 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:20:10.520353 [debug] [ThreadPool]: On list_casestudy_marts: ROLLBACK
[0m16:20:10.521327 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_marts'
[0m16:20:10.521705 [debug] [ThreadPool]: On list_casestudy_marts: Close
[0m16:20:10.524976 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy_marts, now list_casestudy_staging)
[0m16:20:10.527201 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_staging"
[0m16:20:10.527546 [debug] [ThreadPool]: On list_casestudy_staging: BEGIN
[0m16:20:10.527895 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:20:10.539035 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:20:10.539456 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_staging"
[0m16:20:10.539745 [debug] [ThreadPool]: On list_casestudy_staging: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_staging"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'staging'
    and table_catalog = 'casestudy'
  
[0m16:20:10.547983 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:20:10.549325 [debug] [ThreadPool]: On list_casestudy_staging: ROLLBACK
[0m16:20:10.549811 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_staging'
[0m16:20:10.550070 [debug] [ThreadPool]: On list_casestudy_staging: Close
[0m16:20:10.553088 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy_staging, now list_casestudy_reporting)
[0m16:20:10.556306 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_reporting"
[0m16:20:10.556646 [debug] [ThreadPool]: On list_casestudy_reporting: BEGIN
[0m16:20:10.556935 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:20:10.567878 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:20:10.568266 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_reporting"
[0m16:20:10.568635 [debug] [ThreadPool]: On list_casestudy_reporting: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_reporting"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'reporting'
    and table_catalog = 'casestudy'
  
[0m16:20:10.577329 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:20:10.579000 [debug] [ThreadPool]: On list_casestudy_reporting: ROLLBACK
[0m16:20:10.579591 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_reporting'
[0m16:20:10.579892 [debug] [ThreadPool]: On list_casestudy_reporting: Close
[0m16:20:10.582934 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy_reporting, now list_casestudy_intermediate)
[0m16:20:10.585421 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_intermediate"
[0m16:20:10.586315 [debug] [ThreadPool]: On list_casestudy_intermediate: BEGIN
[0m16:20:10.586634 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:20:10.599494 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:20:10.600024 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_intermediate"
[0m16:20:10.600338 [debug] [ThreadPool]: On list_casestudy_intermediate: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_intermediate"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'intermediate'
    and table_catalog = 'casestudy'
  
[0m16:20:10.611065 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:20:10.612723 [debug] [ThreadPool]: On list_casestudy_intermediate: ROLLBACK
[0m16:20:10.613254 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_intermediate'
[0m16:20:10.613577 [debug] [ThreadPool]: On list_casestudy_intermediate: Close
[0m16:20:10.617121 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy_intermediate, now list_casestudy_raw)
[0m16:20:10.620036 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_raw"
[0m16:20:10.620612 [debug] [ThreadPool]: On list_casestudy_raw: BEGIN
[0m16:20:10.622806 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:20:10.637625 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:20:10.638153 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_raw"
[0m16:20:10.638505 [debug] [ThreadPool]: On list_casestudy_raw: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_raw"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'raw'
    and table_catalog = 'casestudy'
  
[0m16:20:10.647609 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:20:10.649088 [debug] [ThreadPool]: On list_casestudy_raw: ROLLBACK
[0m16:20:10.649591 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_raw'
[0m16:20:10.649849 [debug] [ThreadPool]: On list_casestudy_raw: Close
[0m16:20:10.653937 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '11a6c1dd-6775-426a-8b90-812db5bffe0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd76929bb10>]}
[0m16:20:10.654413 [debug] [MainThread]: Using duckdb connection "master"
[0m16:20:10.654692 [debug] [MainThread]: On master: BEGIN
[0m16:20:10.654978 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:20:10.668135 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:20:10.668552 [debug] [MainThread]: On master: COMMIT
[0m16:20:10.668820 [debug] [MainThread]: Using duckdb connection "master"
[0m16:20:10.669085 [debug] [MainThread]: On master: COMMIT
[0m16:20:10.669587 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:20:10.669871 [debug] [MainThread]: On master: Close
[0m16:20:10.672430 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:20:10.672885 [info ] [MainThread]: 
[0m16:20:10.675577 [debug] [Thread-1 (]: Began running node model.vg_casestudy.reporting__high_lvl_branch_transactions_kpis
[0m16:20:10.676124 [info ] [Thread-1 (]: 1 of 1 START sql table model reporting.reporting__high_lvl_branch_transactions_kpis  [RUN]
[0m16:20:10.676864 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.vg_casestudy.reporting__high_lvl_branch_transactions_kpis'
[0m16:20:10.677225 [debug] [Thread-1 (]: Began compiling node model.vg_casestudy.reporting__high_lvl_branch_transactions_kpis
[0m16:20:10.685924 [debug] [Thread-1 (]: Writing injected SQL for node "model.vg_casestudy.reporting__high_lvl_branch_transactions_kpis"
[0m16:20:10.686718 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.reporting__high_lvl_branch_transactions_kpis (compile): 16:20:10.677452 => 16:20:10.686460
[0m16:20:10.687278 [debug] [Thread-1 (]: Began executing node model.vg_casestudy.reporting__high_lvl_branch_transactions_kpis
[0m16:20:10.719438 [debug] [Thread-1 (]: Writing runtime sql for node "model.vg_casestudy.reporting__high_lvl_branch_transactions_kpis"
[0m16:20:10.720199 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.reporting__high_lvl_branch_transactions_kpis"
[0m16:20:10.720595 [debug] [Thread-1 (]: On model.vg_casestudy.reporting__high_lvl_branch_transactions_kpis: BEGIN
[0m16:20:10.720918 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:20:10.732926 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:20:10.733707 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.reporting__high_lvl_branch_transactions_kpis"
[0m16:20:10.734335 [debug] [Thread-1 (]: On model.vg_casestudy.reporting__high_lvl_branch_transactions_kpis: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.reporting__high_lvl_branch_transactions_kpis"} */

  
    
    

    create  table
      "casestudy"."reporting"."reporting__high_lvl_branch_transactions_kpis__dbt_tmp"
  
    as (
      with transactions as (
    select *
    from "casestudy"."marts"."marts__transactions_with_euro"
),

customers as (
    select *
    from "casestudy"."marts"."marts__customers_enriched"
),

joined as (
    select 
        transactions.*,
        customers.*

    from transactions 
    left join customers 
    on transactions.account_id = customers.account_id
),

aggregated as(
    select 
        branch_id,
        branch_name,
        transaction_date,

        --transaction volume
        count(transaction_id) as count_transactions,
        count(case when transaction_type = 'deposit' then transaction_id end) as count_deposits,
        count(case when transaction_type = 'withdrawal' then transaction_id end) as count_withdrawals,
        count(case when transaction_type = 'transfer' then transaction_id end) as count_transfers,

        --customer segmentation
        count(distinct customer_id) as unique_customers,
        count(case when age < 30 then transaction_id end) as transactions_under_30,
        count(case when age between 30 and 50 then transaction_id end) as transactions_30_to_50,
        count(case when age > 50 then transaction_id end) as transactions_over_50,
        count(case when age < 30 then transaction_id end)::float / count(transaction_id) as share_customers_under_30,
        count(case when age between 30 and 50 then transaction_id end)::float / count(transaction_id) as share_customers_30_to_50,
        count(case when age > 50 then transaction_id end)::float / count(transaction_id) as share_customers_over_50,

        --transaction kpis
        sum(transaction_amount_euro) as total_transaction_amount_euro,
        avg(transaction_amount_euro) as avg_transaction_amount_euro,
        count(distinct transaction_currency) as num_transaction_currencies,
        count(case when has_account is true then transaction_id end) as transactions_with_account,
        count(case when has_account is false then transaction_id end) as transactions_without_account

    from joined
    group by branch_id, branch_name, transaction_date
)

select * 
from aggregated
    );
  
  
[0m16:20:10.811333 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:20:10.818898 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.reporting__high_lvl_branch_transactions_kpis"
[0m16:20:10.819349 [debug] [Thread-1 (]: On model.vg_casestudy.reporting__high_lvl_branch_transactions_kpis: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.reporting__high_lvl_branch_transactions_kpis"} */
alter table "casestudy"."reporting"."reporting__high_lvl_branch_transactions_kpis__dbt_tmp" rename to "reporting__high_lvl_branch_transactions_kpis"
[0m16:20:10.820440 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:20:10.836521 [debug] [Thread-1 (]: On model.vg_casestudy.reporting__high_lvl_branch_transactions_kpis: COMMIT
[0m16:20:10.836945 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.reporting__high_lvl_branch_transactions_kpis"
[0m16:20:10.837280 [debug] [Thread-1 (]: On model.vg_casestudy.reporting__high_lvl_branch_transactions_kpis: COMMIT
[0m16:20:10.849398 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:20:10.854526 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.reporting__high_lvl_branch_transactions_kpis"
[0m16:20:10.855133 [debug] [Thread-1 (]: On model.vg_casestudy.reporting__high_lvl_branch_transactions_kpis: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.reporting__high_lvl_branch_transactions_kpis"} */
drop table if exists "casestudy"."reporting"."reporting__high_lvl_branch_transactions_kpis__dbt_backup" cascade
[0m16:20:10.856059 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:20:10.857573 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.reporting__high_lvl_branch_transactions_kpis (execute): 16:20:10.687563 => 16:20:10.857380
[0m16:20:10.857970 [debug] [Thread-1 (]: On model.vg_casestudy.reporting__high_lvl_branch_transactions_kpis: Close
[0m16:20:10.900834 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '11a6c1dd-6775-426a-8b90-812db5bffe0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd76da5cd10>]}
[0m16:20:10.901549 [info ] [Thread-1 (]: 1 of 1 OK created sql table model reporting.reporting__high_lvl_branch_transactions_kpis  [[32mOK[0m in 0.22s]
[0m16:20:10.902195 [debug] [Thread-1 (]: Finished running node model.vg_casestudy.reporting__high_lvl_branch_transactions_kpis
[0m16:20:10.903950 [debug] [MainThread]: Using duckdb connection "master"
[0m16:20:10.904302 [debug] [MainThread]: On master: BEGIN
[0m16:20:10.904579 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:20:10.918865 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:20:10.919334 [debug] [MainThread]: On master: COMMIT
[0m16:20:10.919651 [debug] [MainThread]: Using duckdb connection "master"
[0m16:20:10.919935 [debug] [MainThread]: On master: COMMIT
[0m16:20:10.920591 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:20:10.921019 [debug] [MainThread]: On master: Close
[0m16:20:10.924381 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:20:10.924853 [debug] [MainThread]: Connection 'list_casestudy_raw' was properly closed.
[0m16:20:10.925149 [debug] [MainThread]: Connection 'model.vg_casestudy.reporting__high_lvl_branch_transactions_kpis' was properly closed.
[0m16:20:10.925496 [info ] [MainThread]: 
[0m16:20:10.925847 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.52 seconds (0.52s).
[0m16:20:10.926443 [debug] [MainThread]: Command end result
[0m16:20:10.949393 [info ] [MainThread]: 
[0m16:20:10.950026 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:20:10.950404 [info ] [MainThread]: 
[0m16:20:10.950729 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m16:20:10.951211 [debug] [MainThread]: Command `dbt run` succeeded at 16:20:10.951115 after 0.91 seconds
[0m16:20:10.951582 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd76d46dd50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd76d46a010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd76d91c350>]}
[0m16:20:10.951919 [debug] [MainThread]: Flushing usage events
[0m16:20:32.474618 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3b8a41bad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3b8a3e6d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3b8a3e7f10>]}


============================== 16:20:32.477159 | e83585f4-fe91-442b-8a67-da9158adeabe ==============================
[0m16:20:32.477159 [info ] [MainThread]: Running with dbt=1.6.18
[0m16:20:32.477782 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/workspaces/vg_case_study_tim/transformation', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/workspaces/vg_case_study_tim/transformation/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt test --select reporting__high_lvl_branch_transactions_kpis', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:20:32.574393 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e83585f4-fe91-442b-8a67-da9158adeabe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3b89c4de50>]}
[0m16:20:32.589853 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e83585f4-fe91-442b-8a67-da9158adeabe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3b89c4b9d0>]}
[0m16:20:32.590651 [info ] [MainThread]: Registered adapter: duckdb=1.6.2
[0m16:20:32.616724 [debug] [MainThread]: checksum: 7b9fab86a08e9e96a48a825af743c566d95b877e068b8c6d0dbafbf714447189, vars: {}, profile: , target: , version: 1.6.18
[0m16:20:32.666603 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:20:32.667064 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:20:32.668761 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.vg_casestudy.main
[0m16:20:32.678107 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e83585f4-fe91-442b-8a67-da9158adeabe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3b89e19c10>]}
[0m16:20:32.758786 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e83585f4-fe91-442b-8a67-da9158adeabe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3b89cc3790>]}
[0m16:20:32.759369 [info ] [MainThread]: Found 19 models, 1 analysis, 4 seeds, 114 tests, 5 sources, 0 exposures, 0 metrics, 632 macros, 0 groups, 0 semantic models
[0m16:20:32.759793 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e83585f4-fe91-442b-8a67-da9158adeabe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3b89dfffd0>]}
[0m16:20:32.762455 [info ] [MainThread]: 
[0m16:20:32.762855 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m16:20:32.763329 [debug] [MainThread]: Command end result
[0m16:20:32.783594 [debug] [MainThread]: Command `dbt test` succeeded at 16:20:32.783423 after 0.32 seconds
[0m16:20:32.784061 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3b8ea66d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3b8ea66190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3b8ea67350>]}
[0m16:20:32.784442 [debug] [MainThread]: Flushing usage events
[0m16:21:14.179905 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1393eebad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f139420fe50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1393eeaf10>]}


============================== 16:21:14.186961 | cf0ca375-ddea-4d9f-adf2-968de633d32f ==============================
[0m16:21:14.186961 [info ] [MainThread]: Running with dbt=1.6.18
[0m16:21:14.187576 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/workspaces/vg_case_study_tim/transformation', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/workspaces/vg_case_study_tim/transformation/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt test --select reporting__high_lvl_branch_transactions_kpis', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:21:14.385039 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cf0ca375-ddea-4d9f-adf2-968de633d32f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1393dfb810>]}
[0m16:21:14.399714 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cf0ca375-ddea-4d9f-adf2-968de633d32f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f13950abdd0>]}
[0m16:21:14.401191 [info ] [MainThread]: Registered adapter: duckdb=1.6.2
[0m16:21:14.429081 [debug] [MainThread]: checksum: 7b9fab86a08e9e96a48a825af743c566d95b877e068b8c6d0dbafbf714447189, vars: {}, profile: , target: , version: 1.6.18
[0m16:21:14.540623 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:21:14.541581 [debug] [MainThread]: Partial parsing: updated file: vg_casestudy://models/reporting/reporting__high_lvl_branch_transactions_kpis.yml
[0m16:21:14.659703 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.vg_casestudy.main
[0m16:21:14.667938 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cf0ca375-ddea-4d9f-adf2-968de633d32f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1393aba090>]}
[0m16:21:14.705114 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cf0ca375-ddea-4d9f-adf2-968de633d32f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1393b16f10>]}
[0m16:21:14.705638 [info ] [MainThread]: Found 19 models, 1 analysis, 4 seeds, 115 tests, 5 sources, 0 exposures, 0 metrics, 632 macros, 0 groups, 0 semantic models
[0m16:21:14.706359 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cf0ca375-ddea-4d9f-adf2-968de633d32f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f13950abb90>]}
[0m16:21:14.709531 [info ] [MainThread]: 
[0m16:21:14.710386 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m16:21:14.712454 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_casestudy_raw'
[0m16:21:14.725736 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_raw"
[0m16:21:14.726462 [debug] [ThreadPool]: On list_casestudy_raw: BEGIN
[0m16:21:14.726813 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:21:14.856652 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:21:14.857258 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_raw"
[0m16:21:14.857633 [debug] [ThreadPool]: On list_casestudy_raw: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_raw"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'raw'
    and table_catalog = 'casestudy'
  
[0m16:21:14.877372 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:21:14.879372 [debug] [ThreadPool]: On list_casestudy_raw: ROLLBACK
[0m16:21:14.880749 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_raw'
[0m16:21:14.881088 [debug] [ThreadPool]: On list_casestudy_raw: Close
[0m16:21:14.885734 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy_raw, now list_casestudy_reporting)
[0m16:21:14.889490 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_reporting"
[0m16:21:14.889857 [debug] [ThreadPool]: On list_casestudy_reporting: BEGIN
[0m16:21:14.890134 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:21:14.904942 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:21:14.905379 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_reporting"
[0m16:21:14.905677 [debug] [ThreadPool]: On list_casestudy_reporting: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_reporting"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'reporting'
    and table_catalog = 'casestudy'
  
[0m16:21:14.916458 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:21:14.917916 [debug] [ThreadPool]: On list_casestudy_reporting: ROLLBACK
[0m16:21:14.918426 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_reporting'
[0m16:21:14.918720 [debug] [ThreadPool]: On list_casestudy_reporting: Close
[0m16:21:14.922631 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy_reporting, now list_casestudy_intermediate)
[0m16:21:14.925738 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_intermediate"
[0m16:21:14.926111 [debug] [ThreadPool]: On list_casestudy_intermediate: BEGIN
[0m16:21:14.926383 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:21:14.939379 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:21:14.939823 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_intermediate"
[0m16:21:14.940153 [debug] [ThreadPool]: On list_casestudy_intermediate: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_intermediate"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'intermediate'
    and table_catalog = 'casestudy'
  
[0m16:21:14.950511 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:21:14.952002 [debug] [ThreadPool]: On list_casestudy_intermediate: ROLLBACK
[0m16:21:14.952517 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_intermediate'
[0m16:21:14.952812 [debug] [ThreadPool]: On list_casestudy_intermediate: Close
[0m16:21:14.956007 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy_intermediate, now list_casestudy_marts)
[0m16:21:14.959745 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_marts"
[0m16:21:14.960175 [debug] [ThreadPool]: On list_casestudy_marts: BEGIN
[0m16:21:14.960470 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:21:14.973125 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:21:14.973758 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_marts"
[0m16:21:14.974120 [debug] [ThreadPool]: On list_casestudy_marts: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_marts"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'marts'
    and table_catalog = 'casestudy'
  
[0m16:21:14.984064 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:21:14.985474 [debug] [ThreadPool]: On list_casestudy_marts: ROLLBACK
[0m16:21:14.985995 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_marts'
[0m16:21:14.986283 [debug] [ThreadPool]: On list_casestudy_marts: Close
[0m16:21:14.989390 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy_marts, now list_casestudy_staging)
[0m16:21:14.992400 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_staging"
[0m16:21:14.992768 [debug] [ThreadPool]: On list_casestudy_staging: BEGIN
[0m16:21:14.993043 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:21:15.005772 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:21:15.006204 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_staging"
[0m16:21:15.006492 [debug] [ThreadPool]: On list_casestudy_staging: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_staging"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'staging'
    and table_catalog = 'casestudy'
  
[0m16:21:15.016052 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:21:15.017384 [debug] [ThreadPool]: On list_casestudy_staging: ROLLBACK
[0m16:21:15.017856 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_staging'
[0m16:21:15.018121 [debug] [ThreadPool]: On list_casestudy_staging: Close
[0m16:21:15.022542 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cf0ca375-ddea-4d9f-adf2-968de633d32f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f138f7033d0>]}
[0m16:21:15.023022 [debug] [MainThread]: Using duckdb connection "master"
[0m16:21:15.023300 [debug] [MainThread]: On master: BEGIN
[0m16:21:15.023642 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:21:15.036793 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:21:15.037214 [debug] [MainThread]: On master: COMMIT
[0m16:21:15.037522 [debug] [MainThread]: Using duckdb connection "master"
[0m16:21:15.037792 [debug] [MainThread]: On master: COMMIT
[0m16:21:15.038285 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:21:15.038576 [debug] [MainThread]: On master: Close
[0m16:21:15.041411 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:21:15.042095 [info ] [MainThread]: 
[0m16:21:15.046050 [debug] [Thread-1 (]: Began running node test.vg_casestudy.not_null_reporting__high_lvl_branch_transactions_kpis_branch_id.36e8270fb4
[0m16:21:15.046496 [info ] [Thread-1 (]: 1 of 1 START test not_null_reporting__high_lvl_branch_transactions_kpis_branch_id  [RUN]
[0m16:21:15.047365 [debug] [Thread-1 (]: Acquiring new duckdb connection 'test.vg_casestudy.not_null_reporting__high_lvl_branch_transactions_kpis_branch_id.36e8270fb4'
[0m16:21:15.047693 [debug] [Thread-1 (]: Began compiling node test.vg_casestudy.not_null_reporting__high_lvl_branch_transactions_kpis_branch_id.36e8270fb4
[0m16:21:15.066658 [debug] [Thread-1 (]: Writing injected SQL for node "test.vg_casestudy.not_null_reporting__high_lvl_branch_transactions_kpis_branch_id.36e8270fb4"
[0m16:21:15.068749 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_reporting__high_lvl_branch_transactions_kpis_branch_id.36e8270fb4 (compile): 16:21:15.047923 => 16:21:15.068480
[0m16:21:15.069169 [debug] [Thread-1 (]: Began executing node test.vg_casestudy.not_null_reporting__high_lvl_branch_transactions_kpis_branch_id.36e8270fb4
[0m16:21:15.082272 [debug] [Thread-1 (]: Writing runtime sql for node "test.vg_casestudy.not_null_reporting__high_lvl_branch_transactions_kpis_branch_id.36e8270fb4"
[0m16:21:15.083981 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.not_null_reporting__high_lvl_branch_transactions_kpis_branch_id.36e8270fb4"
[0m16:21:15.084416 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_reporting__high_lvl_branch_transactions_kpis_branch_id.36e8270fb4: BEGIN
[0m16:21:15.084728 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:21:15.099895 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:21:15.100358 [debug] [Thread-1 (]: Using duckdb connection "test.vg_casestudy.not_null_reporting__high_lvl_branch_transactions_kpis_branch_id.36e8270fb4"
[0m16:21:15.100731 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_reporting__high_lvl_branch_transactions_kpis_branch_id.36e8270fb4: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "test.vg_casestudy.not_null_reporting__high_lvl_branch_transactions_kpis_branch_id.36e8270fb4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select branch_id
from "casestudy"."reporting"."reporting__high_lvl_branch_transactions_kpis"
where branch_id is null



      
    ) dbt_internal_test
[0m16:21:15.112958 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:21:15.116276 [debug] [Thread-1 (]: Timing info for test.vg_casestudy.not_null_reporting__high_lvl_branch_transactions_kpis_branch_id.36e8270fb4 (execute): 16:21:15.069421 => 16:21:15.116030
[0m16:21:15.116721 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_reporting__high_lvl_branch_transactions_kpis_branch_id.36e8270fb4: ROLLBACK
[0m16:21:15.117237 [debug] [Thread-1 (]: Failed to rollback 'test.vg_casestudy.not_null_reporting__high_lvl_branch_transactions_kpis_branch_id.36e8270fb4'
[0m16:21:15.117579 [debug] [Thread-1 (]: On test.vg_casestudy.not_null_reporting__high_lvl_branch_transactions_kpis_branch_id.36e8270fb4: Close
[0m16:21:15.120872 [error] [Thread-1 (]: 1 of 1 FAIL 24 not_null_reporting__high_lvl_branch_transactions_kpis_branch_id . [[31mFAIL 24[0m in 0.07s]
[0m16:21:15.121563 [debug] [Thread-1 (]: Finished running node test.vg_casestudy.not_null_reporting__high_lvl_branch_transactions_kpis_branch_id.36e8270fb4
[0m16:21:15.123240 [debug] [MainThread]: Using duckdb connection "master"
[0m16:21:15.123633 [debug] [MainThread]: On master: BEGIN
[0m16:21:15.123909 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:21:15.140452 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:21:15.140966 [debug] [MainThread]: On master: COMMIT
[0m16:21:15.141385 [debug] [MainThread]: Using duckdb connection "master"
[0m16:21:15.141705 [debug] [MainThread]: On master: COMMIT
[0m16:21:15.142434 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:21:15.142861 [debug] [MainThread]: On master: Close
[0m16:21:15.145594 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:21:15.145971 [debug] [MainThread]: Connection 'list_casestudy_staging' was properly closed.
[0m16:21:15.146241 [debug] [MainThread]: Connection 'test.vg_casestudy.not_null_reporting__high_lvl_branch_transactions_kpis_branch_id.36e8270fb4' was properly closed.
[0m16:21:15.146563 [info ] [MainThread]: 
[0m16:21:15.146903 [info ] [MainThread]: Finished running 1 test in 0 hours 0 minutes and 0.44 seconds (0.44s).
[0m16:21:15.147512 [debug] [MainThread]: Command end result
[0m16:21:15.168691 [info ] [MainThread]: 
[0m16:21:15.169175 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m16:21:15.169496 [info ] [MainThread]: 
[0m16:21:15.169803 [error] [MainThread]: [31mFailure in test not_null_reporting__high_lvl_branch_transactions_kpis_branch_id (models/reporting/reporting__high_lvl_branch_transactions_kpis.yml)[0m
[0m16:21:15.170158 [error] [MainThread]:   Got 24 results, configured to fail if != 0
[0m16:21:15.170457 [info ] [MainThread]: 
[0m16:21:15.170735 [info ] [MainThread]:   compiled Code at target/compiled/vg_casestudy/models/reporting/reporting__high_lvl_branch_transactions_kpis.yml/not_null_reporting__high_lvl_branch_transactions_kpis_branch_id.sql
[0m16:21:15.171023 [info ] [MainThread]: 
[0m16:21:15.171325 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m16:21:15.171772 [debug] [MainThread]: Command `dbt test` failed at 16:21:15.171683 after 1.00 seconds
[0m16:21:15.172112 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1393dfb890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f13987695d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f138f8db6d0>]}
[0m16:21:15.172474 [debug] [MainThread]: Flushing usage events
[0m16:31:07.193057 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf15eed390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf15db9c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf164b0f10>]}


============================== 16:31:07.197512 | 157d7129-5f6b-4977-b68b-c0194948deaf ==============================
[0m16:31:07.197512 [info ] [MainThread]: Running with dbt=1.6.18
[0m16:31:07.198105 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/workspaces/vg_case_study_tim/transformation', 'log_path': '/workspaces/vg_case_study_tim/transformation/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test --select reporting__high_lvl_branch_transactions_kpis', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:31:07.398790 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '157d7129-5f6b-4977-b68b-c0194948deaf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf15dba110>]}
[0m16:31:07.414461 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '157d7129-5f6b-4977-b68b-c0194948deaf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf15f5dc50>]}
[0m16:31:07.415990 [info ] [MainThread]: Registered adapter: duckdb=1.6.2
[0m16:31:07.444027 [debug] [MainThread]: checksum: 7b9fab86a08e9e96a48a825af743c566d95b877e068b8c6d0dbafbf714447189, vars: {}, profile: , target: , version: 1.6.18
[0m16:31:07.546632 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:31:07.547736 [debug] [MainThread]: Partial parsing: updated file: vg_casestudy://models/reporting/reporting__high_lvl_branch_transactions_kpis.yml
[0m16:31:07.673438 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.vg_casestudy.main
[0m16:31:07.682276 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '157d7129-5f6b-4977-b68b-c0194948deaf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf15eeea90>]}
[0m16:31:07.718404 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '157d7129-5f6b-4977-b68b-c0194948deaf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf119b2e50>]}
[0m16:31:07.718978 [info ] [MainThread]: Found 19 models, 1 analysis, 4 seeds, 114 tests, 5 sources, 0 exposures, 0 metrics, 632 macros, 0 groups, 0 semantic models
[0m16:31:07.719373 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '157d7129-5f6b-4977-b68b-c0194948deaf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf15eec210>]}
[0m16:31:07.721885 [info ] [MainThread]: 
[0m16:31:07.722254 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m16:31:07.722833 [debug] [MainThread]: Command end result
[0m16:31:07.741706 [debug] [MainThread]: Command `dbt test` succeeded at 16:31:07.741523 after 0.56 seconds
[0m16:31:07.742235 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf15f5da10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf1a823fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf164b0f10>]}
[0m16:31:07.742652 [debug] [MainThread]: Flushing usage events
[0m16:48:45.499951 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b32d8cc90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b330b58d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b3307d050>]}


============================== 16:48:45.504387 | dfaecb3b-6531-4046-b62d-af44dff37213 ==============================
[0m16:48:45.504387 [info ] [MainThread]: Running with dbt=1.6.18
[0m16:48:45.505018 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/workspaces/vg_case_study_tim/transformation/logs', 'version_check': 'True', 'profiles_dir': '/workspaces/vg_case_study_tim/transformation', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select reporting__branch_transaction_currenncy_kpis', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:48:45.704134 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dfaecb3b-6531-4046-b62d-af44dff37213', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b32c47850>]}
[0m16:48:45.719205 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'dfaecb3b-6531-4046-b62d-af44dff37213', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b330a5d50>]}
[0m16:48:45.720610 [info ] [MainThread]: Registered adapter: duckdb=1.6.2
[0m16:48:45.748077 [debug] [MainThread]: checksum: 7b9fab86a08e9e96a48a825af743c566d95b877e068b8c6d0dbafbf714447189, vars: {}, profile: , target: , version: 1.6.18
[0m16:48:45.854096 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 0 files changed.
[0m16:48:45.854937 [debug] [MainThread]: Partial parsing: added file: vg_casestudy://models/reporting/reporting__branch_transaction_currenncy_kpis.sql
[0m16:48:45.855479 [debug] [MainThread]: Partial parsing: added file: vg_casestudy://models/reporting/reporting__branch_transaction_currenncy_kpis.yml
[0m16:48:45.981758 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.vg_casestudy.main
[0m16:48:45.990753 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dfaecb3b-6531-4046-b62d-af44dff37213', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b2e97b610>]}
[0m16:48:46.026247 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dfaecb3b-6531-4046-b62d-af44dff37213', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b2e74cdd0>]}
[0m16:48:46.026784 [info ] [MainThread]: Found 20 models, 1 analysis, 4 seeds, 114 tests, 5 sources, 0 exposures, 0 metrics, 632 macros, 0 groups, 0 semantic models
[0m16:48:46.027386 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dfaecb3b-6531-4046-b62d-af44dff37213', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b2ebff290>]}
[0m16:48:46.030773 [info ] [MainThread]: 
[0m16:48:46.031733 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m16:48:46.033108 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_casestudy'
[0m16:48:46.045586 [debug] [ThreadPool]: Using duckdb connection "list_casestudy"
[0m16:48:46.046071 [debug] [ThreadPool]: On list_casestudy: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"casestudy"'
    
  
  
[0m16:48:46.046393 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:48:46.185682 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:48:46.187297 [debug] [ThreadPool]: On list_casestudy: Close
[0m16:48:46.193819 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy, now create_casestudy_reporting)
[0m16:48:46.194740 [debug] [ThreadPool]: Creating schema "database: "casestudy"
schema: "reporting"
"
[0m16:48:46.199743 [debug] [ThreadPool]: Using duckdb connection "create_casestudy_reporting"
[0m16:48:46.200257 [debug] [ThreadPool]: On create_casestudy_reporting: BEGIN
[0m16:48:46.200593 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:48:46.213134 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:48:46.213604 [debug] [ThreadPool]: Using duckdb connection "create_casestudy_reporting"
[0m16:48:46.213898 [debug] [ThreadPool]: On create_casestudy_reporting: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "create_casestudy_reporting"} */
create schema if not exists "casestudy"."reporting"
[0m16:48:46.214494 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:48:46.215481 [debug] [ThreadPool]: On create_casestudy_reporting: COMMIT
[0m16:48:46.215802 [debug] [ThreadPool]: Using duckdb connection "create_casestudy_reporting"
[0m16:48:46.216076 [debug] [ThreadPool]: On create_casestudy_reporting: COMMIT
[0m16:48:46.216648 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:48:46.217268 [debug] [ThreadPool]: On create_casestudy_reporting: Close
[0m16:48:46.224077 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_casestudy_reporting, now list_casestudy_reporting)
[0m16:48:46.230006 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_reporting"
[0m16:48:46.230430 [debug] [ThreadPool]: On list_casestudy_reporting: BEGIN
[0m16:48:46.230737 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:48:46.243866 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:48:46.244313 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_reporting"
[0m16:48:46.244630 [debug] [ThreadPool]: On list_casestudy_reporting: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_reporting"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'reporting'
    and table_catalog = 'casestudy'
  
[0m16:48:46.261346 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:48:46.262803 [debug] [ThreadPool]: On list_casestudy_reporting: ROLLBACK
[0m16:48:46.264139 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_reporting'
[0m16:48:46.264431 [debug] [ThreadPool]: On list_casestudy_reporting: Close
[0m16:48:46.268533 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy_reporting, now list_casestudy_raw)
[0m16:48:46.271514 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_raw"
[0m16:48:46.271844 [debug] [ThreadPool]: On list_casestudy_raw: BEGIN
[0m16:48:46.272115 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:48:46.284807 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:48:46.285259 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_raw"
[0m16:48:46.285796 [debug] [ThreadPool]: On list_casestudy_raw: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_raw"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'raw'
    and table_catalog = 'casestudy'
  
[0m16:48:46.296540 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:48:46.298163 [debug] [ThreadPool]: On list_casestudy_raw: ROLLBACK
[0m16:48:46.298753 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_raw'
[0m16:48:46.299059 [debug] [ThreadPool]: On list_casestudy_raw: Close
[0m16:48:46.302406 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy_raw, now list_casestudy_intermediate)
[0m16:48:46.306902 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_intermediate"
[0m16:48:46.307370 [debug] [ThreadPool]: On list_casestudy_intermediate: BEGIN
[0m16:48:46.307688 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:48:46.320297 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:48:46.320726 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_intermediate"
[0m16:48:46.321031 [debug] [ThreadPool]: On list_casestudy_intermediate: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_intermediate"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'intermediate'
    and table_catalog = 'casestudy'
  
[0m16:48:46.330675 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:48:46.332109 [debug] [ThreadPool]: On list_casestudy_intermediate: ROLLBACK
[0m16:48:46.332640 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_intermediate'
[0m16:48:46.332941 [debug] [ThreadPool]: On list_casestudy_intermediate: Close
[0m16:48:46.336101 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy_intermediate, now list_casestudy_marts)
[0m16:48:46.338523 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_marts"
[0m16:48:46.338923 [debug] [ThreadPool]: On list_casestudy_marts: BEGIN
[0m16:48:46.339243 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:48:46.352428 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:48:46.352884 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_marts"
[0m16:48:46.353200 [debug] [ThreadPool]: On list_casestudy_marts: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_marts"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'marts'
    and table_catalog = 'casestudy'
  
[0m16:48:46.362968 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:48:46.364392 [debug] [ThreadPool]: On list_casestudy_marts: ROLLBACK
[0m16:48:46.364881 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_marts'
[0m16:48:46.365199 [debug] [ThreadPool]: On list_casestudy_marts: Close
[0m16:48:46.368397 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy_marts, now list_casestudy_staging)
[0m16:48:46.370716 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_staging"
[0m16:48:46.371624 [debug] [ThreadPool]: On list_casestudy_staging: BEGIN
[0m16:48:46.371918 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:48:46.384028 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:48:46.384455 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_staging"
[0m16:48:46.384773 [debug] [ThreadPool]: On list_casestudy_staging: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_staging"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'staging'
    and table_catalog = 'casestudy'
  
[0m16:48:46.394999 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:48:46.396421 [debug] [ThreadPool]: On list_casestudy_staging: ROLLBACK
[0m16:48:46.396888 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_staging'
[0m16:48:46.397175 [debug] [ThreadPool]: On list_casestudy_staging: Close
[0m16:48:46.401190 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dfaecb3b-6531-4046-b62d-af44dff37213', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b32b10190>]}
[0m16:48:46.401702 [debug] [MainThread]: Using duckdb connection "master"
[0m16:48:46.402016 [debug] [MainThread]: On master: BEGIN
[0m16:48:46.402289 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:48:46.418515 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:48:46.418952 [debug] [MainThread]: On master: COMMIT
[0m16:48:46.419245 [debug] [MainThread]: Using duckdb connection "master"
[0m16:48:46.419524 [debug] [MainThread]: On master: COMMIT
[0m16:48:46.420030 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:48:46.420384 [debug] [MainThread]: On master: Close
[0m16:48:46.422990 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:48:46.423475 [info ] [MainThread]: 
[0m16:48:46.427295 [debug] [Thread-1 (]: Began running node model.vg_casestudy.reporting__branch_transaction_currenncy_kpis
[0m16:48:46.427784 [info ] [Thread-1 (]: 1 of 1 START sql view model reporting.reporting__branch_transaction_currenncy_kpis  [RUN]
[0m16:48:46.429460 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.vg_casestudy.reporting__branch_transaction_currenncy_kpis'
[0m16:48:46.430060 [debug] [Thread-1 (]: Began compiling node model.vg_casestudy.reporting__branch_transaction_currenncy_kpis
[0m16:48:46.441402 [debug] [Thread-1 (]: Writing injected SQL for node "model.vg_casestudy.reporting__branch_transaction_currenncy_kpis"
[0m16:48:46.443211 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.reporting__branch_transaction_currenncy_kpis (compile): 16:48:46.430364 => 16:48:46.442761
[0m16:48:46.443892 [debug] [Thread-1 (]: Began executing node model.vg_casestudy.reporting__branch_transaction_currenncy_kpis
[0m16:48:46.476315 [debug] [Thread-1 (]: Writing runtime sql for node "model.vg_casestudy.reporting__branch_transaction_currenncy_kpis"
[0m16:48:46.477088 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.reporting__branch_transaction_currenncy_kpis"
[0m16:48:46.477493 [debug] [Thread-1 (]: On model.vg_casestudy.reporting__branch_transaction_currenncy_kpis: BEGIN
[0m16:48:46.477796 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:48:46.494171 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:48:46.494642 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.reporting__branch_transaction_currenncy_kpis"
[0m16:48:46.495038 [debug] [Thread-1 (]: On model.vg_casestudy.reporting__branch_transaction_currenncy_kpis: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.reporting__branch_transaction_currenncy_kpis"} */

  
  create view "casestudy"."reporting"."reporting__branch_transaction_currenncy_kpis__dbt_tmp" as (
    with transactions as (
    select *
    from "casestudy"."marts"."marts__transactions_with_euro"
),

customers as (
    select *
    from "casestudy"."marts"."marts__customers_enriched"
),

joined as (
    select 
        transactions.*,
        customers.*
    from transactions 
    left join customers 
    on transactions.account_id = customers.account_id
),

aggregated as(
    select 
        branch_id,
        branch_name,
        transaction_date,
        transaction_currency,

        --transaction volume
        count(transaction_id) as count_transactions,
        count(case when transaction_type = 'deposit' then transaction_id end) as count_deposits,
        count(case when transaction_type = 'withdrawal' then transaction_id end) as count_withdrawals,
        count(case when transaction_type = 'transfer' then transaction_id end) as count_transfers,

        --customer segmentation
        count(distinct customer_id) as unique_customers,
        count(case when age < 30 then transaction_id end) as transactions_under_30,
        count(case when age between 30 and 50 then transaction_id end) as transactions_30_to_50,
        count(case when age > 50 then transaction_id end) as transactions_over_50,
        count(case when age < 30 then transaction_id end)::float / count(transaction_id) as share_customers_under_30,
        count(case when age between 30 and 50 then transaction_id end)::float / count(transaction_id) as share_customers_30_to_50,
        count(case when age > 50 then transaction_id end)::float / count(transaction_id) as share_customers_over_50,

        --transaction kpis
        sum(transaction_amount_euro) as total_transaction_amount_euro,
        avg(transaction_amount_euro) as avg_transaction_amount_euro,
        count(case when has_account is true then transaction_id end) as transactions_with_account,
        count(case when has_account is false then transaction_id end) as transactions_without_account

    from joined
    group by branch_id, branch_name, transaction_date, transaction_currency
)

select * 
from aggregated
  );

[0m16:48:46.498336 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:48:46.504635 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.reporting__branch_transaction_currenncy_kpis"
[0m16:48:46.505078 [debug] [Thread-1 (]: On model.vg_casestudy.reporting__branch_transaction_currenncy_kpis: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.reporting__branch_transaction_currenncy_kpis"} */
alter view "casestudy"."reporting"."reporting__branch_transaction_currenncy_kpis__dbt_tmp" rename to "reporting__branch_transaction_currenncy_kpis"
[0m16:48:46.506013 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:48:46.518822 [debug] [Thread-1 (]: On model.vg_casestudy.reporting__branch_transaction_currenncy_kpis: COMMIT
[0m16:48:46.519258 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.reporting__branch_transaction_currenncy_kpis"
[0m16:48:46.519575 [debug] [Thread-1 (]: On model.vg_casestudy.reporting__branch_transaction_currenncy_kpis: COMMIT
[0m16:48:46.525004 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:48:46.529853 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.reporting__branch_transaction_currenncy_kpis"
[0m16:48:46.530220 [debug] [Thread-1 (]: On model.vg_casestudy.reporting__branch_transaction_currenncy_kpis: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.reporting__branch_transaction_currenncy_kpis"} */
drop view if exists "casestudy"."reporting"."reporting__branch_transaction_currenncy_kpis__dbt_backup" cascade
[0m16:48:46.530989 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:48:46.532219 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.reporting__branch_transaction_currenncy_kpis (execute): 16:48:46.444285 => 16:48:46.532072
[0m16:48:46.532558 [debug] [Thread-1 (]: On model.vg_casestudy.reporting__branch_transaction_currenncy_kpis: Close
[0m16:48:46.566259 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dfaecb3b-6531-4046-b62d-af44dff37213', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b2e93d390>]}
[0m16:48:46.566982 [info ] [Thread-1 (]: 1 of 1 OK created sql view model reporting.reporting__branch_transaction_currenncy_kpis  [[32mOK[0m in 0.14s]
[0m16:48:46.567577 [debug] [Thread-1 (]: Finished running node model.vg_casestudy.reporting__branch_transaction_currenncy_kpis
[0m16:48:46.569511 [debug] [MainThread]: Using duckdb connection "master"
[0m16:48:46.569847 [debug] [MainThread]: On master: BEGIN
[0m16:48:46.570149 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:48:46.586766 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:48:46.587327 [debug] [MainThread]: On master: COMMIT
[0m16:48:46.587660 [debug] [MainThread]: Using duckdb connection "master"
[0m16:48:46.587936 [debug] [MainThread]: On master: COMMIT
[0m16:48:46.588530 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:48:46.588868 [debug] [MainThread]: On master: Close
[0m16:48:46.591707 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:48:46.592069 [debug] [MainThread]: Connection 'list_casestudy_staging' was properly closed.
[0m16:48:46.592336 [debug] [MainThread]: Connection 'model.vg_casestudy.reporting__branch_transaction_currenncy_kpis' was properly closed.
[0m16:48:46.592650 [info ] [MainThread]: 
[0m16:48:46.592992 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.56 seconds (0.56s).
[0m16:48:46.593583 [debug] [MainThread]: Command end result
[0m16:48:46.615322 [info ] [MainThread]: 
[0m16:48:46.615822 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:48:46.616182 [info ] [MainThread]: 
[0m16:48:46.616517 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m16:48:46.617052 [debug] [MainThread]: Command `dbt run` succeeded at 16:48:46.616941 after 1.13 seconds
[0m16:48:46.617543 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b330c8550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b37736250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b2e814d90>]}
[0m16:48:46.617984 [debug] [MainThread]: Flushing usage events
[0m16:48:59.143103 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc10c005290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc10cfb1a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc10be02ad0>]}


============================== 16:48:59.145655 | a6aba224-21f8-4735-9431-0016bcfefefe ==============================
[0m16:48:59.145655 [info ] [MainThread]: Running with dbt=1.6.18
[0m16:48:59.146202 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/workspaces/vg_case_study_tim/transformation/logs', 'version_check': 'True', 'profiles_dir': '/workspaces/vg_case_study_tim/transformation', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test --select reporting__branch_transaction_currenncy_kpis', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:48:59.239976 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a6aba224-21f8-4735-9431-0016bcfefefe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc108485810>]}
[0m16:48:59.253815 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a6aba224-21f8-4735-9431-0016bcfefefe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc10c166510>]}
[0m16:48:59.254550 [info ] [MainThread]: Registered adapter: duckdb=1.6.2
[0m16:48:59.280568 [debug] [MainThread]: checksum: 7b9fab86a08e9e96a48a825af743c566d95b877e068b8c6d0dbafbf714447189, vars: {}, profile: , target: , version: 1.6.18
[0m16:48:59.332971 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:48:59.333476 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:48:59.335366 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.vg_casestudy.main
[0m16:48:59.343124 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a6aba224-21f8-4735-9431-0016bcfefefe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc10c179910>]}
[0m16:48:59.422655 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a6aba224-21f8-4735-9431-0016bcfefefe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc10bbb0110>]}
[0m16:48:59.423218 [info ] [MainThread]: Found 20 models, 1 analysis, 4 seeds, 114 tests, 5 sources, 0 exposures, 0 metrics, 632 macros, 0 groups, 0 semantic models
[0m16:48:59.423613 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a6aba224-21f8-4735-9431-0016bcfefefe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1079aa650>]}
[0m16:48:59.426264 [info ] [MainThread]: 
[0m16:48:59.426639 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m16:48:59.427111 [debug] [MainThread]: Command end result
[0m16:48:59.446073 [debug] [MainThread]: Command `dbt test` succeeded at 16:48:59.445905 after 0.31 seconds
[0m16:48:59.446501 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc10be01d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc10bec3950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc11080a250>]}
[0m16:48:59.446899 [debug] [MainThread]: Flushing usage events
[0m10:03:52.529697 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc2a2d923d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc2a2f40390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc2a335b190>]}


============================== 10:03:52.536722 | e9f7a557-d29d-4256-8075-b99e030682d5 ==============================
[0m10:03:52.536722 [info ] [MainThread]: Running with dbt=1.6.18
[0m10:03:52.537700 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/workspaces/vg_case_study_tim/transformation/logs', 'profiles_dir': '/workspaces/vg_case_study_tim/transformation', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt debug', 'send_anonymous_usage_stats': 'True'}
[0m10:03:52.538691 [info ] [MainThread]: dbt version: 1.6.18
[0m10:03:52.539124 [info ] [MainThread]: python version: 3.11.6
[0m10:03:52.539580 [info ] [MainThread]: python path: /usr/local/bin/python
[0m10:03:52.539926 [info ] [MainThread]: os info: Linux-5.15.153.1-microsoft-standard-WSL2-x86_64-with-glibc2.31
[0m10:03:52.690491 [info ] [MainThread]: Using profiles dir at /workspaces/vg_case_study_tim/transformation
[0m10:03:52.691051 [info ] [MainThread]: Using profiles.yml file at /workspaces/vg_case_study_tim/transformation/profiles.yml
[0m10:03:52.691393 [info ] [MainThread]: Using dbt_project.yml file at /workspaces/vg_case_study_tim/transformation/dbt_project.yml
[0m10:03:52.692687 [info ] [MainThread]: adapter type: duckdb
[0m10:03:52.693027 [info ] [MainThread]: adapter version: 1.6.2
[0m10:03:52.729544 [info ] [MainThread]: Configuration:
[0m10:03:52.730062 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m10:03:52.730454 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m10:03:52.730786 [info ] [MainThread]: Required dependencies:
[0m10:03:52.731105 [debug] [MainThread]: Executing "git --help"
[0m10:03:52.733132 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m10:03:52.734417 [debug] [MainThread]: STDERR: "b''"
[0m10:03:52.735336 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m10:03:52.735983 [info ] [MainThread]: Connection:
[0m10:03:52.736520 [info ] [MainThread]:   database: casestudy
[0m10:03:52.736940 [info ] [MainThread]:   schema: main
[0m10:03:52.737301 [info ] [MainThread]:   path: casestudy.duckdb
[0m10:03:52.737652 [info ] [MainThread]:   config_options: None
[0m10:03:52.737958 [info ] [MainThread]:   extensions: ['icu']
[0m10:03:52.738297 [info ] [MainThread]:   settings: None
[0m10:03:52.738675 [info ] [MainThread]:   external_root: .
[0m10:03:52.739031 [info ] [MainThread]:   use_credential_provider: None
[0m10:03:52.739406 [info ] [MainThread]:   attach: None
[0m10:03:52.739714 [info ] [MainThread]:   filesystems: None
[0m10:03:52.739985 [info ] [MainThread]:   remote: None
[0m10:03:52.740284 [info ] [MainThread]:   plugins: None
[0m10:03:52.740566 [info ] [MainThread]:   disable_transactions: False
[0m10:03:52.740903 [info ] [MainThread]: Registered adapter: duckdb=1.6.2
[0m10:03:52.741611 [debug] [MainThread]: Acquiring new duckdb connection 'debug'
[0m10:03:52.742013 [debug] [MainThread]: Using duckdb connection "debug"
[0m10:03:52.742418 [debug] [MainThread]: On debug: select 1 as id
[0m10:03:52.742816 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:03:52.906398 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m10:03:52.907425 [debug] [MainThread]: On debug: Close
[0m10:03:52.910755 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m10:03:52.911208 [info ] [MainThread]: [32mAll checks passed![0m
[0m10:03:52.911689 [debug] [MainThread]: Command `dbt debug` succeeded at 10:03:52.911590 after 0.39 seconds
[0m10:03:52.912014 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m10:03:52.912329 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc2a7943d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc2a2d7d710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc2a32a9410>]}
[0m10:03:52.912690 [debug] [MainThread]: Flushing usage events
[0m10:11:30.431805 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00c38ca610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00c3bfdf50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00c3bfdf10>]}


============================== 10:11:30.439585 | 481b13e3-81fb-4cad-916f-a30cb2d3bc9a ==============================
[0m10:11:30.439585 [info ] [MainThread]: Running with dbt=1.6.18
[0m10:11:30.440281 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/workspaces/vg_case_study_tim/transformation/logs', 'profiles_dir': '/workspaces/vg_case_study_tim/transformation', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --select reporting__branch_transaction_currency_kpis', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m10:11:30.679232 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '481b13e3-81fb-4cad-916f-a30cb2d3bc9a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00c36359d0>]}
[0m10:11:30.694761 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '481b13e3-81fb-4cad-916f-a30cb2d3bc9a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00c3d77a50>]}
[0m10:11:30.696304 [info ] [MainThread]: Registered adapter: duckdb=1.6.2
[0m10:11:30.729567 [debug] [MainThread]: checksum: 7b9fab86a08e9e96a48a825af743c566d95b877e068b8c6d0dbafbf714447189, vars: {}, profile: , target: , version: 1.6.18
[0m10:11:30.850460 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 4 files changed.
[0m10:11:30.851505 [debug] [MainThread]: Partial parsing: updated file: vg_casestudy://models/reporting/reporting__branch_transaction_currenncy_kpis.yml
[0m10:11:30.852129 [debug] [MainThread]: Partial parsing: updated file: vg_casestudy://models/reporting/reporting__high_lvl_branch_transactions_kpis.yml
[0m10:11:30.852504 [debug] [MainThread]: Partial parsing: updated file: vg_casestudy://models/reporting/reporting__high_lvl_branch_transactions_kpis.sql
[0m10:11:30.852813 [debug] [MainThread]: Partial parsing: updated file: vg_casestudy://models/reporting/reporting__branch_transaction_currenncy_kpis.sql
[0m10:11:31.006780 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.vg_casestudy.main
[0m10:11:31.016720 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '481b13e3-81fb-4cad-916f-a30cb2d3bc9a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00bf66e610>]}
[0m10:11:31.059941 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '481b13e3-81fb-4cad-916f-a30cb2d3bc9a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00c3653810>]}
[0m10:11:31.060806 [info ] [MainThread]: Found 20 models, 1 analysis, 4 seeds, 114 tests, 5 sources, 0 exposures, 0 metrics, 632 macros, 0 groups, 0 semantic models
[0m10:11:31.061482 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '481b13e3-81fb-4cad-916f-a30cb2d3bc9a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00bf686e90>]}
[0m10:11:31.063584 [warn ] [MainThread]: The selection criterion 'reporting__branch_transaction_currency_kpis' does not match any nodes
[0m10:11:31.065446 [info ] [MainThread]: 
[0m10:11:31.065851 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m10:11:31.066411 [debug] [MainThread]: Command end result
[0m10:11:31.092016 [debug] [MainThread]: Command `dbt run` succeeded at 10:11:31.091852 after 0.67 seconds
[0m10:11:31.092696 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00c3c2af50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00c5461490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00c8352610>]}
[0m10:11:31.093254 [debug] [MainThread]: Flushing usage events
[0m10:12:33.999648 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc44f57bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc44f65dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc474f9690>]}


============================== 10:12:34.005004 | 5dd6fc00-1cf1-4c87-a5ae-ed30fc7a8f2e ==============================
[0m10:12:34.005004 [info ] [MainThread]: Running with dbt=1.6.18
[0m10:12:34.005643 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/workspaces/vg_case_study_tim/transformation', 'version_check': 'True', 'debug': 'False', 'log_path': '/workspaces/vg_case_study_tim/transformation/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --select reporting__high_lvl_branch_transactions', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:12:34.226407 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5dd6fc00-1cf1-4c87-a5ae-ed30fc7a8f2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc4121f510>]}
[0m10:12:34.241284 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5dd6fc00-1cf1-4c87-a5ae-ed30fc7a8f2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc44987890>]}
[0m10:12:34.243051 [info ] [MainThread]: Registered adapter: duckdb=1.6.2
[0m10:12:34.273595 [debug] [MainThread]: checksum: 7b9fab86a08e9e96a48a825af743c566d95b877e068b8c6d0dbafbf714447189, vars: {}, profile: , target: , version: 1.6.18
[0m10:12:34.392670 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:12:34.393183 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:12:34.394978 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.vg_casestudy.main
[0m10:12:34.405345 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5dd6fc00-1cf1-4c87-a5ae-ed30fc7a8f2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc452dc110>]}
[0m10:12:34.493145 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5dd6fc00-1cf1-4c87-a5ae-ed30fc7a8f2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc44c034d0>]}
[0m10:12:34.493756 [info ] [MainThread]: Found 20 models, 1 analysis, 4 seeds, 114 tests, 5 sources, 0 exposures, 0 metrics, 632 macros, 0 groups, 0 semantic models
[0m10:12:34.494149 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5dd6fc00-1cf1-4c87-a5ae-ed30fc7a8f2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc40563e90>]}
[0m10:12:34.495574 [warn ] [MainThread]: The selection criterion 'reporting__high_lvl_branch_transactions' does not match any nodes
[0m10:12:34.497434 [info ] [MainThread]: 
[0m10:12:34.497923 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m10:12:34.498562 [debug] [MainThread]: Command end result
[0m10:12:34.522001 [debug] [MainThread]: Command `dbt run` succeeded at 10:12:34.521832 after 0.53 seconds
[0m10:12:34.522464 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc4677c210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc45d98890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc4495ad10>]}
[0m10:12:34.522888 [debug] [MainThread]: Flushing usage events
[0m10:13:44.126661 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f633ce2f810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f633f829610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f633cf65a90>]}


============================== 10:13:44.129478 | 2177430e-338f-4450-a4b7-28eb32bda0b0 ==============================
[0m10:13:44.129478 [info ] [MainThread]: Running with dbt=1.6.18
[0m10:13:44.130044 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/workspaces/vg_case_study_tim/transformation', 'debug': 'False', 'warn_error': 'None', 'log_path': '/workspaces/vg_case_study_tim/transformation/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --select reporting__high_lvl_branch_transactions_kpis', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m10:13:44.249923 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2177430e-338f-4450-a4b7-28eb32bda0b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f633ce43610>]}
[0m10:13:44.272706 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2177430e-338f-4450-a4b7-28eb32bda0b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f633d56cf10>]}
[0m10:13:44.273987 [info ] [MainThread]: Registered adapter: duckdb=1.6.2
[0m10:13:44.310660 [debug] [MainThread]: checksum: 7b9fab86a08e9e96a48a825af743c566d95b877e068b8c6d0dbafbf714447189, vars: {}, profile: , target: , version: 1.6.18
[0m10:13:44.383057 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:13:44.384534 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:13:44.387347 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.vg_casestudy.main
[0m10:13:44.398150 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2177430e-338f-4450-a4b7-28eb32bda0b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f633ccbf410>]}
[0m10:13:44.502023 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2177430e-338f-4450-a4b7-28eb32bda0b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f633ccb41d0>]}
[0m10:13:44.502947 [info ] [MainThread]: Found 20 models, 1 analysis, 4 seeds, 114 tests, 5 sources, 0 exposures, 0 metrics, 632 macros, 0 groups, 0 semantic models
[0m10:13:44.503627 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2177430e-338f-4450-a4b7-28eb32bda0b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f633cf850d0>]}
[0m10:13:44.507873 [info ] [MainThread]: 
[0m10:13:44.509124 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m10:13:44.510604 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_casestudy'
[0m10:13:44.526745 [debug] [ThreadPool]: Using duckdb connection "list_casestudy"
[0m10:13:44.527382 [debug] [ThreadPool]: On list_casestudy: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"casestudy"'
    
  
  
[0m10:13:44.527944 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:13:44.685541 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:13:44.687888 [debug] [ThreadPool]: On list_casestudy: Close
[0m10:13:44.696049 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy, now create_casestudy_reporting)
[0m10:13:44.697093 [debug] [ThreadPool]: Creating schema "database: "casestudy"
schema: "reporting"
"
[0m10:13:44.704146 [debug] [ThreadPool]: Using duckdb connection "create_casestudy_reporting"
[0m10:13:44.704794 [debug] [ThreadPool]: On create_casestudy_reporting: BEGIN
[0m10:13:44.705305 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:13:44.725102 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:13:44.725566 [debug] [ThreadPool]: Using duckdb connection "create_casestudy_reporting"
[0m10:13:44.725915 [debug] [ThreadPool]: On create_casestudy_reporting: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "create_casestudy_reporting"} */
create schema if not exists "casestudy"."reporting"
[0m10:13:44.727041 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:13:44.728773 [debug] [ThreadPool]: On create_casestudy_reporting: COMMIT
[0m10:13:44.729846 [debug] [ThreadPool]: Using duckdb connection "create_casestudy_reporting"
[0m10:13:44.730634 [debug] [ThreadPool]: On create_casestudy_reporting: COMMIT
[0m10:13:44.731783 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:13:44.732370 [debug] [ThreadPool]: On create_casestudy_reporting: Close
[0m10:13:44.741172 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_casestudy_reporting, now list_casestudy_staging)
[0m10:13:44.748736 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_staging"
[0m10:13:44.749949 [debug] [ThreadPool]: On list_casestudy_staging: BEGIN
[0m10:13:44.750904 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:13:44.770448 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:13:44.771141 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_staging"
[0m10:13:44.771686 [debug] [ThreadPool]: On list_casestudy_staging: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_staging"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'staging'
    and table_catalog = 'casestudy'
  
[0m10:13:44.799056 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:13:44.801690 [debug] [ThreadPool]: On list_casestudy_staging: ROLLBACK
[0m10:13:44.804086 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_staging'
[0m10:13:44.806533 [debug] [ThreadPool]: On list_casestudy_staging: Close
[0m10:13:44.813160 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy_staging, now list_casestudy_raw)
[0m10:13:44.825684 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_raw"
[0m10:13:44.826284 [debug] [ThreadPool]: On list_casestudy_raw: BEGIN
[0m10:13:44.826738 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:13:44.846992 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:13:44.847600 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_raw"
[0m10:13:44.848159 [debug] [ThreadPool]: On list_casestudy_raw: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_raw"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'raw'
    and table_catalog = 'casestudy'
  
[0m10:13:44.862124 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:13:44.863711 [debug] [ThreadPool]: On list_casestudy_raw: ROLLBACK
[0m10:13:44.864200 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_raw'
[0m10:13:44.864484 [debug] [ThreadPool]: On list_casestudy_raw: Close
[0m10:13:44.868800 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy_raw, now list_casestudy_reporting)
[0m10:13:44.872727 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_reporting"
[0m10:13:44.873162 [debug] [ThreadPool]: On list_casestudy_reporting: BEGIN
[0m10:13:44.873441 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:13:44.888776 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:13:44.889235 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_reporting"
[0m10:13:44.889561 [debug] [ThreadPool]: On list_casestudy_reporting: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_reporting"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'reporting'
    and table_catalog = 'casestudy'
  
[0m10:13:44.900686 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:13:44.902592 [debug] [ThreadPool]: On list_casestudy_reporting: ROLLBACK
[0m10:13:44.903203 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_reporting'
[0m10:13:44.903538 [debug] [ThreadPool]: On list_casestudy_reporting: Close
[0m10:13:44.907502 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy_reporting, now list_casestudy_marts)
[0m10:13:44.910892 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_marts"
[0m10:13:44.911336 [debug] [ThreadPool]: On list_casestudy_marts: BEGIN
[0m10:13:44.911652 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:13:44.928393 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:13:44.928867 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_marts"
[0m10:13:44.929187 [debug] [ThreadPool]: On list_casestudy_marts: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_marts"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'marts'
    and table_catalog = 'casestudy'
  
[0m10:13:44.940338 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:13:44.941943 [debug] [ThreadPool]: On list_casestudy_marts: ROLLBACK
[0m10:13:44.942514 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_marts'
[0m10:13:44.942999 [debug] [ThreadPool]: On list_casestudy_marts: Close
[0m10:13:44.946731 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy_marts, now list_casestudy_intermediate)
[0m10:13:44.952248 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_intermediate"
[0m10:13:44.952846 [debug] [ThreadPool]: On list_casestudy_intermediate: BEGIN
[0m10:13:44.953150 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:13:44.968861 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:13:44.969512 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_intermediate"
[0m10:13:44.969986 [debug] [ThreadPool]: On list_casestudy_intermediate: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_intermediate"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'intermediate'
    and table_catalog = 'casestudy'
  
[0m10:13:44.981370 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:13:44.983157 [debug] [ThreadPool]: On list_casestudy_intermediate: ROLLBACK
[0m10:13:44.983981 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_intermediate'
[0m10:13:44.984432 [debug] [ThreadPool]: On list_casestudy_intermediate: Close
[0m10:13:44.989992 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2177430e-338f-4450-a4b7-28eb32bda0b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f633dc1f310>]}
[0m10:13:44.990636 [debug] [MainThread]: Using duckdb connection "master"
[0m10:13:44.990963 [debug] [MainThread]: On master: BEGIN
[0m10:13:44.991226 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:13:45.009671 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m10:13:45.010156 [debug] [MainThread]: On master: COMMIT
[0m10:13:45.010452 [debug] [MainThread]: Using duckdb connection "master"
[0m10:13:45.010758 [debug] [MainThread]: On master: COMMIT
[0m10:13:45.011369 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m10:13:45.011740 [debug] [MainThread]: On master: Close
[0m10:13:45.014422 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:13:45.014887 [info ] [MainThread]: 
[0m10:13:45.019470 [debug] [Thread-1 (]: Began running node model.vg_casestudy.reporting__high_lvl_branch_transactions_kpis
[0m10:13:45.020283 [info ] [Thread-1 (]: 1 of 1 START sql view model reporting.reporting__high_lvl_branch_transactions_kpis  [RUN]
[0m10:13:45.021673 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.vg_casestudy.reporting__high_lvl_branch_transactions_kpis'
[0m10:13:45.022322 [debug] [Thread-1 (]: Began compiling node model.vg_casestudy.reporting__high_lvl_branch_transactions_kpis
[0m10:13:45.032484 [debug] [Thread-1 (]: Writing injected SQL for node "model.vg_casestudy.reporting__high_lvl_branch_transactions_kpis"
[0m10:13:45.036216 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.reporting__high_lvl_branch_transactions_kpis (compile): 10:13:45.022745 => 10:13:45.034925
[0m10:13:45.037833 [debug] [Thread-1 (]: Began executing node model.vg_casestudy.reporting__high_lvl_branch_transactions_kpis
[0m10:13:45.081474 [debug] [Thread-1 (]: Writing runtime sql for node "model.vg_casestudy.reporting__high_lvl_branch_transactions_kpis"
[0m10:13:45.082660 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.reporting__high_lvl_branch_transactions_kpis"
[0m10:13:45.083388 [debug] [Thread-1 (]: On model.vg_casestudy.reporting__high_lvl_branch_transactions_kpis: BEGIN
[0m10:13:45.083993 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:13:45.103060 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m10:13:45.103602 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.reporting__high_lvl_branch_transactions_kpis"
[0m10:13:45.104077 [debug] [Thread-1 (]: On model.vg_casestudy.reporting__high_lvl_branch_transactions_kpis: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.reporting__high_lvl_branch_transactions_kpis"} */

  
  create view "casestudy"."reporting"."reporting__high_lvl_branch_transactions_kpis__dbt_tmp" as (
    with transactions as (
    select *
    from "casestudy"."marts"."marts__transactions_with_euro"
),

customers as (
    select *
    from "casestudy"."marts"."marts__customers_enriched"
),

joined as (
    select 
        transactions.*,
        customers.*

    from transactions 
    left join customers 
    on transactions.account_id = customers.account_id
),

aggregated as(
    select 
        branch_id,
        branch_name,
        transaction_date,

        --transaction volume
        count(transaction_id) as count_transactions,
        count(case when transaction_type = 'deposit' then transaction_id end) as count_deposits,
        count(case when transaction_type = 'withdrawal' then transaction_id end) as count_withdrawals,
        count(case when transaction_type = 'transfer' then transaction_id end) as count_transfers,
        count(case when transaction_type = 'deposit' then transaction_id end)::float / count(transaction_id) as share_deposits,
        count(case when transaction_type = 'withdrawal' then transaction_id end)::float / count(transaction_id) as share_withdrawals,
        count(case when transaction_type = 'transfer' then transaction_id end)::float / count(transaction_id) as share_transfers,

        --customer segmentation
        count(distinct customer_id) as unique_customers,
        count(case when age < 30 then transaction_id end) as transactions_under_30,
        count(case when age between 30 and 50 then transaction_id end) as transactions_30_to_50,
        count(case when age > 50 then transaction_id end) as transactions_over_50,
        count(case when age < 30 then transaction_id end)::float / count(transaction_id) as share_customers_under_30,
        count(case when age between 30 and 50 then transaction_id end)::float / count(transaction_id) as share_customers_30_to_50,
        count(case when age > 50 then transaction_id end)::float / count(transaction_id) as share_customers_over_50,

        --transaction kpis
        sum(transaction_amount_euro) as total_transaction_amount_euro,
        avg(transaction_amount_euro) as avg_transaction_amount_euro,
        count(distinct transaction_currency) as num_transaction_currencies,
        count(case when has_account is true then transaction_id end) as transactions_with_account,
        count(case when branch_id is null then transaction_id end) as transactions_without_account

    from joined
    group by branch_id, branch_name, transaction_date
)

select * 
from aggregated
  );

[0m10:13:45.107639 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m10:13:45.114433 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.reporting__high_lvl_branch_transactions_kpis"
[0m10:13:45.114885 [debug] [Thread-1 (]: On model.vg_casestudy.reporting__high_lvl_branch_transactions_kpis: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.reporting__high_lvl_branch_transactions_kpis"} */
alter table "casestudy"."reporting"."reporting__high_lvl_branch_transactions_kpis" rename to "reporting__high_lvl_branch_transactions_kpis__dbt_backup"
[0m10:13:45.115857 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m10:13:45.119394 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.reporting__high_lvl_branch_transactions_kpis"
[0m10:13:45.119853 [debug] [Thread-1 (]: On model.vg_casestudy.reporting__high_lvl_branch_transactions_kpis: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.reporting__high_lvl_branch_transactions_kpis"} */
alter view "casestudy"."reporting"."reporting__high_lvl_branch_transactions_kpis__dbt_tmp" rename to "reporting__high_lvl_branch_transactions_kpis"
[0m10:13:45.120960 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m10:13:45.137807 [debug] [Thread-1 (]: On model.vg_casestudy.reporting__high_lvl_branch_transactions_kpis: COMMIT
[0m10:13:45.138316 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.reporting__high_lvl_branch_transactions_kpis"
[0m10:13:45.138702 [debug] [Thread-1 (]: On model.vg_casestudy.reporting__high_lvl_branch_transactions_kpis: COMMIT
[0m10:13:45.142967 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m10:13:45.148734 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.reporting__high_lvl_branch_transactions_kpis"
[0m10:13:45.149209 [debug] [Thread-1 (]: On model.vg_casestudy.reporting__high_lvl_branch_transactions_kpis: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.reporting__high_lvl_branch_transactions_kpis"} */
drop table if exists "casestudy"."reporting"."reporting__high_lvl_branch_transactions_kpis__dbt_backup" cascade
[0m10:13:45.154248 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m10:13:45.155918 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.reporting__high_lvl_branch_transactions_kpis (execute): 10:13:45.038717 => 10:13:45.155740
[0m10:13:45.156346 [debug] [Thread-1 (]: On model.vg_casestudy.reporting__high_lvl_branch_transactions_kpis: Close
[0m10:13:45.182854 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2177430e-338f-4450-a4b7-28eb32bda0b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f633895e650>]}
[0m10:13:45.183623 [info ] [Thread-1 (]: 1 of 1 OK created sql view model reporting.reporting__high_lvl_branch_transactions_kpis  [[32mOK[0m in 0.16s]
[0m10:13:45.184318 [debug] [Thread-1 (]: Finished running node model.vg_casestudy.reporting__high_lvl_branch_transactions_kpis
[0m10:13:45.186290 [debug] [MainThread]: Using duckdb connection "master"
[0m10:13:45.186738 [debug] [MainThread]: On master: BEGIN
[0m10:13:45.187083 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:13:45.203824 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m10:13:45.204512 [debug] [MainThread]: On master: COMMIT
[0m10:13:45.204879 [debug] [MainThread]: Using duckdb connection "master"
[0m10:13:45.205228 [debug] [MainThread]: On master: COMMIT
[0m10:13:45.205950 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m10:13:45.206285 [debug] [MainThread]: On master: Close
[0m10:13:45.208942 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:13:45.209334 [debug] [MainThread]: Connection 'list_casestudy_intermediate' was properly closed.
[0m10:13:45.209621 [debug] [MainThread]: Connection 'model.vg_casestudy.reporting__high_lvl_branch_transactions_kpis' was properly closed.
[0m10:13:45.210458 [info ] [MainThread]: 
[0m10:13:45.210873 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.70 seconds (0.70s).
[0m10:13:45.211470 [debug] [MainThread]: Command end result
[0m10:13:45.241553 [info ] [MainThread]: 
[0m10:13:45.242405 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:13:45.243126 [info ] [MainThread]: 
[0m10:13:45.243615 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m10:13:45.244149 [debug] [MainThread]: Command `dbt run` succeeded at 10:13:45.244047 after 1.13 seconds
[0m10:13:45.244518 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f633eb478d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6341946250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6341947410>]}
[0m10:13:45.244863 [debug] [MainThread]: Flushing usage events
[0m10:14:07.422947 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3191484d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f319119ff10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f319119d810>]}


============================== 10:14:07.430008 | c7b5b218-a4e2-4f81-b50b-b6b67d0044d7 ==============================
[0m10:14:07.430008 [info ] [MainThread]: Running with dbt=1.6.18
[0m10:14:07.431280 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/workspaces/vg_case_study_tim/transformation/logs', 'fail_fast': 'False', 'profiles_dir': '/workspaces/vg_case_study_tim/transformation', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --select reporting__branch_transaction_currenncy_kpis', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:14:07.695884 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c7b5b218-a4e2-4f81-b50b-b6b67d0044d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f319179f6d0>]}
[0m10:14:07.729500 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c7b5b218-a4e2-4f81-b50b-b6b67d0044d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f319179cb50>]}
[0m10:14:07.730841 [info ] [MainThread]: Registered adapter: duckdb=1.6.2
[0m10:14:07.798485 [debug] [MainThread]: checksum: 7b9fab86a08e9e96a48a825af743c566d95b877e068b8c6d0dbafbf714447189, vars: {}, profile: , target: , version: 1.6.18
[0m10:14:07.898256 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:14:07.898941 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:14:07.901451 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.vg_casestudy.main
[0m10:14:07.917146 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c7b5b218-a4e2-4f81-b50b-b6b67d0044d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f31912fc4d0>]}
[0m10:14:08.045838 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c7b5b218-a4e2-4f81-b50b-b6b67d0044d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f31917b8b90>]}
[0m10:14:08.046744 [info ] [MainThread]: Found 20 models, 1 analysis, 4 seeds, 114 tests, 5 sources, 0 exposures, 0 metrics, 632 macros, 0 groups, 0 semantic models
[0m10:14:08.047588 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c7b5b218-a4e2-4f81-b50b-b6b67d0044d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f319404e1d0>]}
[0m10:14:08.053612 [info ] [MainThread]: 
[0m10:14:08.057105 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m10:14:08.059433 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_casestudy'
[0m10:14:08.085797 [debug] [ThreadPool]: Using duckdb connection "list_casestudy"
[0m10:14:08.087906 [debug] [ThreadPool]: On list_casestudy: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"casestudy"'
    
  
  
[0m10:14:08.088646 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:14:08.122071 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:14:08.129740 [debug] [ThreadPool]: On list_casestudy: Close
[0m10:14:08.141484 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy, now create_casestudy_reporting)
[0m10:14:08.143264 [debug] [ThreadPool]: Creating schema "database: "casestudy"
schema: "reporting"
"
[0m10:14:08.150570 [debug] [ThreadPool]: Using duckdb connection "create_casestudy_reporting"
[0m10:14:08.151133 [debug] [ThreadPool]: On create_casestudy_reporting: BEGIN
[0m10:14:08.151549 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:14:08.177969 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:14:08.178659 [debug] [ThreadPool]: Using duckdb connection "create_casestudy_reporting"
[0m10:14:08.179109 [debug] [ThreadPool]: On create_casestudy_reporting: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "create_casestudy_reporting"} */
create schema if not exists "casestudy"."reporting"
[0m10:14:08.180164 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:14:08.181557 [debug] [ThreadPool]: On create_casestudy_reporting: COMMIT
[0m10:14:08.182080 [debug] [ThreadPool]: Using duckdb connection "create_casestudy_reporting"
[0m10:14:08.182602 [debug] [ThreadPool]: On create_casestudy_reporting: COMMIT
[0m10:14:08.183540 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:14:08.184025 [debug] [ThreadPool]: On create_casestudy_reporting: Close
[0m10:14:08.192638 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_casestudy_reporting, now list_casestudy_raw)
[0m10:14:08.201315 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_raw"
[0m10:14:08.201888 [debug] [ThreadPool]: On list_casestudy_raw: BEGIN
[0m10:14:08.202629 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:14:08.223055 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:14:08.223927 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_raw"
[0m10:14:08.224952 [debug] [ThreadPool]: On list_casestudy_raw: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_raw"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'raw'
    and table_catalog = 'casestudy'
  
[0m10:14:08.246193 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:14:08.248557 [debug] [ThreadPool]: On list_casestudy_raw: ROLLBACK
[0m10:14:08.249657 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_raw'
[0m10:14:08.250123 [debug] [ThreadPool]: On list_casestudy_raw: Close
[0m10:14:08.255249 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy_raw, now list_casestudy_intermediate)
[0m10:14:08.261034 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_intermediate"
[0m10:14:08.261617 [debug] [ThreadPool]: On list_casestudy_intermediate: BEGIN
[0m10:14:08.262017 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:14:08.281973 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:14:08.282753 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_intermediate"
[0m10:14:08.283213 [debug] [ThreadPool]: On list_casestudy_intermediate: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_intermediate"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'intermediate'
    and table_catalog = 'casestudy'
  
[0m10:14:08.305114 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:14:08.308074 [debug] [ThreadPool]: On list_casestudy_intermediate: ROLLBACK
[0m10:14:08.309244 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_intermediate'
[0m10:14:08.309843 [debug] [ThreadPool]: On list_casestudy_intermediate: Close
[0m10:14:08.314866 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy_intermediate, now list_casestudy_staging)
[0m10:14:08.321014 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_staging"
[0m10:14:08.321949 [debug] [ThreadPool]: On list_casestudy_staging: BEGIN
[0m10:14:08.322660 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:14:08.348773 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:14:08.349467 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_staging"
[0m10:14:08.349968 [debug] [ThreadPool]: On list_casestudy_staging: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_staging"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'staging'
    and table_catalog = 'casestudy'
  
[0m10:14:08.379277 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:14:08.381792 [debug] [ThreadPool]: On list_casestudy_staging: ROLLBACK
[0m10:14:08.382740 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_staging'
[0m10:14:08.383299 [debug] [ThreadPool]: On list_casestudy_staging: Close
[0m10:14:08.391084 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy_staging, now list_casestudy_marts)
[0m10:14:08.398607 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_marts"
[0m10:14:08.399322 [debug] [ThreadPool]: On list_casestudy_marts: BEGIN
[0m10:14:08.399834 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:14:08.428616 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:14:08.429304 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_marts"
[0m10:14:08.429890 [debug] [ThreadPool]: On list_casestudy_marts: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_marts"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'marts'
    and table_catalog = 'casestudy'
  
[0m10:14:08.453716 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:14:08.457068 [debug] [ThreadPool]: On list_casestudy_marts: ROLLBACK
[0m10:14:08.458659 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_marts'
[0m10:14:08.459519 [debug] [ThreadPool]: On list_casestudy_marts: Close
[0m10:14:08.464664 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy_marts, now list_casestudy_reporting)
[0m10:14:08.474988 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_reporting"
[0m10:14:08.475672 [debug] [ThreadPool]: On list_casestudy_reporting: BEGIN
[0m10:14:08.476198 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:14:08.498577 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:14:08.499239 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_reporting"
[0m10:14:08.499756 [debug] [ThreadPool]: On list_casestudy_reporting: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_reporting"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'reporting'
    and table_catalog = 'casestudy'
  
[0m10:14:08.518321 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:14:08.522563 [debug] [ThreadPool]: On list_casestudy_reporting: ROLLBACK
[0m10:14:08.523755 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_reporting'
[0m10:14:08.524479 [debug] [ThreadPool]: On list_casestudy_reporting: Close
[0m10:14:08.531285 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c7b5b218-a4e2-4f81-b50b-b6b67d0044d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f318cff4450>]}
[0m10:14:08.532040 [debug] [MainThread]: Using duckdb connection "master"
[0m10:14:08.532635 [debug] [MainThread]: On master: BEGIN
[0m10:14:08.533119 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:14:08.566265 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m10:14:08.567033 [debug] [MainThread]: On master: COMMIT
[0m10:14:08.567571 [debug] [MainThread]: Using duckdb connection "master"
[0m10:14:08.568099 [debug] [MainThread]: On master: COMMIT
[0m10:14:08.569408 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m10:14:08.570384 [debug] [MainThread]: On master: Close
[0m10:14:08.575458 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:14:08.576509 [info ] [MainThread]: 
[0m10:14:08.580795 [debug] [Thread-1 (]: Began running node model.vg_casestudy.reporting__branch_transaction_currenncy_kpis
[0m10:14:08.582069 [info ] [Thread-1 (]: 1 of 1 START sql view model reporting.reporting__branch_transaction_currenncy_kpis  [RUN]
[0m10:14:08.584059 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.vg_casestudy.reporting__branch_transaction_currenncy_kpis'
[0m10:14:08.584915 [debug] [Thread-1 (]: Began compiling node model.vg_casestudy.reporting__branch_transaction_currenncy_kpis
[0m10:14:08.609328 [debug] [Thread-1 (]: Writing injected SQL for node "model.vg_casestudy.reporting__branch_transaction_currenncy_kpis"
[0m10:14:08.611151 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.reporting__branch_transaction_currenncy_kpis (compile): 10:14:08.589736 => 10:14:08.610573
[0m10:14:08.611999 [debug] [Thread-1 (]: Began executing node model.vg_casestudy.reporting__branch_transaction_currenncy_kpis
[0m10:14:08.688503 [debug] [Thread-1 (]: Writing runtime sql for node "model.vg_casestudy.reporting__branch_transaction_currenncy_kpis"
[0m10:14:08.689981 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.reporting__branch_transaction_currenncy_kpis"
[0m10:14:08.690838 [debug] [Thread-1 (]: On model.vg_casestudy.reporting__branch_transaction_currenncy_kpis: BEGIN
[0m10:14:08.691573 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:14:08.720725 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m10:14:08.721747 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.reporting__branch_transaction_currenncy_kpis"
[0m10:14:08.722889 [debug] [Thread-1 (]: On model.vg_casestudy.reporting__branch_transaction_currenncy_kpis: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.reporting__branch_transaction_currenncy_kpis"} */

  
  create view "casestudy"."reporting"."reporting__branch_transaction_currenncy_kpis__dbt_tmp" as (
    with transactions as (
    select *
    from "casestudy"."marts"."marts__transactions_with_euro"
),

customers as (
    select *
    from "casestudy"."marts"."marts__customers_enriched"
),

joined as (
    select 
        transactions.*,
        customers.*
    from transactions 
    left join customers 
    on transactions.account_id = customers.account_id
),

aggregated as(
    select 
        branch_id,
        branch_name,
        transaction_date,
        transaction_currency,

        --transaction volume
        count(transaction_id) as count_transactions,
        count(case when transaction_type = 'deposit' then transaction_id end) as count_deposits,
        count(case when transaction_type = 'withdrawal' then transaction_id end) as count_withdrawals,
        count(case when transaction_type = 'transfer' then transaction_id end) as count_transfers,
        count(case when transaction_type = 'deposit' then transaction_id end)::float / count(transaction_id) as share_deposits,
        count(case when transaction_type = 'withdrawal' then transaction_id end)::float / count(transaction_id) as share_withdrawals,
        count(case when transaction_type = 'transfer' then transaction_id end)::float / count(transaction_id) as share_transfers,

        --customer segmentation
        count(distinct customer_id) as unique_customers,
        count(case when age < 30 then transaction_id end) as transactions_under_30,
        count(case when age between 30 and 50 then transaction_id end) as transactions_30_to_50,
        count(case when age > 50 then transaction_id end) as transactions_over_50,
        count(case when age < 30 then transaction_id end)::float / count(transaction_id) as share_customers_under_30,
        count(case when age between 30 and 50 then transaction_id end)::float / count(transaction_id) as share_customers_30_to_50,
        count(case when age > 50 then transaction_id end)::float / count(transaction_id) as share_customers_over_50,

        --transaction kpis
        sum(transaction_amount_euro) as total_transaction_amount_euro,
        avg(transaction_amount_euro) as avg_transaction_amount_euro,
        count(case when has_account is true then transaction_id end) as transactions_with_account,
        count(case when branch_id is null then transaction_id end) as transactions_without_account

    from joined
    group by branch_id, branch_name, transaction_date, transaction_currency
)

select * 
from aggregated
  );

[0m10:14:08.728684 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m10:14:08.740434 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.reporting__branch_transaction_currenncy_kpis"
[0m10:14:08.741199 [debug] [Thread-1 (]: On model.vg_casestudy.reporting__branch_transaction_currenncy_kpis: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.reporting__branch_transaction_currenncy_kpis"} */
alter view "casestudy"."reporting"."reporting__branch_transaction_currenncy_kpis" rename to "reporting__branch_transaction_currenncy_kpis__dbt_backup"
[0m10:14:08.743229 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m10:14:08.748710 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.reporting__branch_transaction_currenncy_kpis"
[0m10:14:08.749525 [debug] [Thread-1 (]: On model.vg_casestudy.reporting__branch_transaction_currenncy_kpis: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.reporting__branch_transaction_currenncy_kpis"} */
alter view "casestudy"."reporting"."reporting__branch_transaction_currenncy_kpis__dbt_tmp" rename to "reporting__branch_transaction_currenncy_kpis"
[0m10:14:08.751360 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m10:14:08.786099 [debug] [Thread-1 (]: On model.vg_casestudy.reporting__branch_transaction_currenncy_kpis: COMMIT
[0m10:14:08.787227 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.reporting__branch_transaction_currenncy_kpis"
[0m10:14:08.788093 [debug] [Thread-1 (]: On model.vg_casestudy.reporting__branch_transaction_currenncy_kpis: COMMIT
[0m10:14:08.795248 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m10:14:08.804217 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.reporting__branch_transaction_currenncy_kpis"
[0m10:14:08.805218 [debug] [Thread-1 (]: On model.vg_casestudy.reporting__branch_transaction_currenncy_kpis: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.reporting__branch_transaction_currenncy_kpis"} */
drop view if exists "casestudy"."reporting"."reporting__branch_transaction_currenncy_kpis__dbt_backup" cascade
[0m10:14:08.809989 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m10:14:08.812263 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.reporting__branch_transaction_currenncy_kpis (execute): 10:14:08.612438 => 10:14:08.812012
[0m10:14:08.812941 [debug] [Thread-1 (]: On model.vg_casestudy.reporting__branch_transaction_currenncy_kpis: Close
[0m10:14:08.855381 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c7b5b218-a4e2-4f81-b50b-b6b67d0044d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f31910792d0>]}
[0m10:14:08.856797 [info ] [Thread-1 (]: 1 of 1 OK created sql view model reporting.reporting__branch_transaction_currenncy_kpis  [[32mOK[0m in 0.27s]
[0m10:14:08.858064 [debug] [Thread-1 (]: Finished running node model.vg_casestudy.reporting__branch_transaction_currenncy_kpis
[0m10:14:08.861486 [debug] [MainThread]: Using duckdb connection "master"
[0m10:14:08.862069 [debug] [MainThread]: On master: BEGIN
[0m10:14:08.862557 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:14:08.889383 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m10:14:08.890265 [debug] [MainThread]: On master: COMMIT
[0m10:14:08.890788 [debug] [MainThread]: Using duckdb connection "master"
[0m10:14:08.891270 [debug] [MainThread]: On master: COMMIT
[0m10:14:08.892753 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m10:14:08.893653 [debug] [MainThread]: On master: Close
[0m10:14:08.897528 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:14:08.898053 [debug] [MainThread]: Connection 'list_casestudy_reporting' was properly closed.
[0m10:14:08.898588 [debug] [MainThread]: Connection 'model.vg_casestudy.reporting__branch_transaction_currenncy_kpis' was properly closed.
[0m10:14:08.899118 [info ] [MainThread]: 
[0m10:14:08.899649 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.84 seconds (0.84s).
[0m10:14:08.900538 [debug] [MainThread]: Command end result
[0m10:14:08.943173 [info ] [MainThread]: 
[0m10:14:08.943935 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:14:08.944486 [info ] [MainThread]: 
[0m10:14:08.945116 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m10:14:08.945989 [debug] [MainThread]: Command `dbt run` succeeded at 10:14:08.945818 after 1.54 seconds
[0m10:14:08.946554 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3195e06dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3195e06190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3195d67f50>]}
[0m10:14:08.947104 [debug] [MainThread]: Flushing usage events
[0m10:15:14.190052 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b0a2a0d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b0b573850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b0a73fc50>]}


============================== 10:15:14.192942 | 9a572880-7e10-4d18-bcf2-362ca5bba0b9 ==============================
[0m10:15:14.192942 [info ] [MainThread]: Running with dbt=1.6.18
[0m10:15:14.193526 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/workspaces/vg_case_study_tim/transformation/logs', 'fail_fast': 'False', 'profiles_dir': '/workspaces/vg_case_study_tim/transformation', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt test --select reporting__branch_transaction_currenncy_kpis', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:15:14.299303 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9a572880-7e10-4d18-bcf2-362ca5bba0b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b0a439a50>]}
[0m10:15:14.314926 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9a572880-7e10-4d18-bcf2-362ca5bba0b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b0a73ed50>]}
[0m10:15:14.315701 [info ] [MainThread]: Registered adapter: duckdb=1.6.2
[0m10:15:14.344536 [debug] [MainThread]: checksum: 7b9fab86a08e9e96a48a825af743c566d95b877e068b8c6d0dbafbf714447189, vars: {}, profile: , target: , version: 1.6.18
[0m10:15:14.399414 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:15:14.399868 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:15:14.401548 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.vg_casestudy.main
[0m10:15:14.410976 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9a572880-7e10-4d18-bcf2-362ca5bba0b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b05e89350>]}
[0m10:15:14.497883 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9a572880-7e10-4d18-bcf2-362ca5bba0b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b0a0445d0>]}
[0m10:15:14.498571 [info ] [MainThread]: Found 20 models, 1 analysis, 4 seeds, 114 tests, 5 sources, 0 exposures, 0 metrics, 632 macros, 0 groups, 0 semantic models
[0m10:15:14.499001 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9a572880-7e10-4d18-bcf2-362ca5bba0b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b0a438150>]}
[0m10:15:14.501578 [info ] [MainThread]: 
[0m10:15:14.501934 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m10:15:14.502456 [debug] [MainThread]: Command end result
[0m10:15:14.525452 [debug] [MainThread]: Command `dbt test` succeeded at 10:15:14.525271 after 0.34 seconds
[0m10:15:14.525917 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b0b0e6f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b0bf1fa90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b0a7198d0>]}
[0m10:15:14.526300 [debug] [MainThread]: Flushing usage events
[0m10:15:44.754274 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f014fae58d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f014fde4350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f014fde4390>]}


============================== 10:15:44.760268 | 8df753f2-7180-411f-9f0a-9b1ac1af50d4 ==============================
[0m10:15:44.760268 [info ] [MainThread]: Running with dbt=1.6.18
[0m10:15:44.761264 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/workspaces/vg_case_study_tim/transformation', 'log_path': '/workspaces/vg_case_study_tim/transformation/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test --select reporting__branch_transaction_currenncy_kpis', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:15:44.928646 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8df753f2-7180-411f-9f0a-9b1ac1af50d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f014f85a810>]}
[0m10:15:44.945427 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8df753f2-7180-411f-9f0a-9b1ac1af50d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f014ff41350>]}
[0m10:15:44.946243 [info ] [MainThread]: Registered adapter: duckdb=1.6.2
[0m10:15:44.979232 [debug] [MainThread]: checksum: 7b9fab86a08e9e96a48a825af743c566d95b877e068b8c6d0dbafbf714447189, vars: {}, profile: , target: , version: 1.6.18
[0m10:15:45.037133 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:15:45.037574 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:15:45.039393 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.vg_casestudy.main
[0m10:15:45.051274 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8df753f2-7180-411f-9f0a-9b1ac1af50d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f014ff411d0>]}
[0m10:15:45.140683 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8df753f2-7180-411f-9f0a-9b1ac1af50d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f014fad8d50>]}
[0m10:15:45.141363 [info ] [MainThread]: Found 20 models, 1 analysis, 4 seeds, 114 tests, 5 sources, 0 exposures, 0 metrics, 632 macros, 0 groups, 0 semantic models
[0m10:15:45.141862 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8df753f2-7180-411f-9f0a-9b1ac1af50d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f014c1563d0>]}
[0m10:15:45.144750 [info ] [MainThread]: 
[0m10:15:45.145180 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m10:15:45.145672 [debug] [MainThread]: Command end result
[0m10:15:45.168133 [debug] [MainThread]: Command `dbt test` succeeded at 10:15:45.167959 after 0.43 seconds
[0m10:15:45.168566 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f01544c7450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f01544c6310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f01544c74d0>]}
[0m10:15:45.168946 [debug] [MainThread]: Flushing usage events
[0m10:15:57.770442 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00cc9448d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00cc3b7d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00cc3906d0>]}


============================== 10:15:57.773646 | 38234d85-36bd-4b7c-a0fc-7619d7bd401f ==============================
[0m10:15:57.773646 [info ] [MainThread]: Running with dbt=1.6.18
[0m10:15:57.775079 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/workspaces/vg_case_study_tim/transformation', 'version_check': 'True', 'debug': 'False', 'log_path': '/workspaces/vg_case_study_tim/transformation/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt test --select reporting__high_lvl_branch_transactions_kpis', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m10:15:57.898517 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '38234d85-36bd-4b7c-a0fc-7619d7bd401f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00cbcb2290>]}
[0m10:15:57.915736 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '38234d85-36bd-4b7c-a0fc-7619d7bd401f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00cbc1f9d0>]}
[0m10:15:57.916499 [info ] [MainThread]: Registered adapter: duckdb=1.6.2
[0m10:15:57.945069 [debug] [MainThread]: checksum: 7b9fab86a08e9e96a48a825af743c566d95b877e068b8c6d0dbafbf714447189, vars: {}, profile: , target: , version: 1.6.18
[0m10:15:58.001641 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:15:58.002121 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:15:58.004148 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.vg_casestudy.main
[0m10:15:58.013438 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '38234d85-36bd-4b7c-a0fc-7619d7bd401f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00cbc1fed0>]}
[0m10:15:58.105941 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '38234d85-36bd-4b7c-a0fc-7619d7bd401f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00cbbe8410>]}
[0m10:15:58.106494 [info ] [MainThread]: Found 20 models, 1 analysis, 4 seeds, 114 tests, 5 sources, 0 exposures, 0 metrics, 632 macros, 0 groups, 0 semantic models
[0m10:15:58.106896 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '38234d85-36bd-4b7c-a0fc-7619d7bd401f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00cc3b5850>]}
[0m10:15:58.109902 [info ] [MainThread]: 
[0m10:15:58.110498 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m10:15:58.111114 [debug] [MainThread]: Command end result
[0m10:15:58.134455 [debug] [MainThread]: Command `dbt test` succeeded at 10:15:58.134264 after 0.37 seconds
[0m10:15:58.134893 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00cbdc5d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00cbc92990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00cbdc9a10>]}
[0m10:15:58.135271 [debug] [MainThread]: Flushing usage events
[0m12:44:26.724871 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe38c2cf450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe38c0d7b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe38c09b150>]}


============================== 12:44:26.731429 | c3aff1b3-35eb-4591-a898-b68e3f7e84df ==============================
[0m12:44:26.731429 [info ] [MainThread]: Running with dbt=1.6.18
[0m12:44:26.732147 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/workspaces/vg_case_study_tim/transformation/logs', 'profiles_dir': '/workspaces/vg_case_study_tim/transformation', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt debug', 'send_anonymous_usage_stats': 'True'}
[0m12:44:26.732552 [info ] [MainThread]: dbt version: 1.6.18
[0m12:44:26.732926 [info ] [MainThread]: python version: 3.11.6
[0m12:44:26.733312 [info ] [MainThread]: python path: /usr/local/bin/python
[0m12:44:26.733631 [info ] [MainThread]: os info: Linux-5.15.153.1-microsoft-standard-WSL2-x86_64-with-glibc2.31
[0m12:44:26.886367 [info ] [MainThread]: Using profiles dir at /workspaces/vg_case_study_tim/transformation
[0m12:44:26.886907 [info ] [MainThread]: Using profiles.yml file at /workspaces/vg_case_study_tim/transformation/profiles.yml
[0m12:44:26.887334 [info ] [MainThread]: Using dbt_project.yml file at /workspaces/vg_case_study_tim/transformation/dbt_project.yml
[0m12:44:26.888751 [info ] [MainThread]: adapter type: duckdb
[0m12:44:26.889267 [info ] [MainThread]: adapter version: 1.6.2
[0m12:44:26.924327 [info ] [MainThread]: Configuration:
[0m12:44:26.924800 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m12:44:26.925124 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m12:44:26.925425 [info ] [MainThread]: Required dependencies:
[0m12:44:26.925762 [debug] [MainThread]: Executing "git --help"
[0m12:44:26.927803 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m12:44:26.928430 [debug] [MainThread]: STDERR: "b''"
[0m12:44:26.928789 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m12:44:26.929247 [info ] [MainThread]: Connection:
[0m12:44:26.929661 [info ] [MainThread]:   database: casestudy
[0m12:44:26.930149 [info ] [MainThread]:   schema: main
[0m12:44:26.930558 [info ] [MainThread]:   path: casestudy.duckdb
[0m12:44:26.930893 [info ] [MainThread]:   config_options: None
[0m12:44:26.931227 [info ] [MainThread]:   extensions: ['icu']
[0m12:44:26.931520 [info ] [MainThread]:   settings: None
[0m12:44:26.931844 [info ] [MainThread]:   external_root: .
[0m12:44:26.932167 [info ] [MainThread]:   use_credential_provider: None
[0m12:44:26.932504 [info ] [MainThread]:   attach: None
[0m12:44:26.932849 [info ] [MainThread]:   filesystems: None
[0m12:44:26.933252 [info ] [MainThread]:   remote: None
[0m12:44:26.933610 [info ] [MainThread]:   plugins: None
[0m12:44:26.934033 [info ] [MainThread]:   disable_transactions: False
[0m12:44:26.934488 [info ] [MainThread]: Registered adapter: duckdb=1.6.2
[0m12:44:26.935320 [debug] [MainThread]: Acquiring new duckdb connection 'debug'
[0m12:44:26.935706 [debug] [MainThread]: Using duckdb connection "debug"
[0m12:44:26.936010 [debug] [MainThread]: On debug: select 1 as id
[0m12:44:26.936298 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:44:27.107637 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m12:44:27.108755 [debug] [MainThread]: On debug: Close
[0m12:44:27.112777 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m12:44:27.113306 [info ] [MainThread]: [32mAll checks passed![0m
[0m12:44:27.113818 [debug] [MainThread]: Command `dbt debug` succeeded at 12:44:27.113716 after 0.40 seconds
[0m12:44:27.114118 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m12:44:27.114505 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe38d271750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe390ab6cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe38d25d810>]}
[0m12:44:27.114982 [debug] [MainThread]: Flushing usage events
[0m12:52:04.948065 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f769fa30790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f769fc57d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f769fe8c9d0>]}


============================== 12:52:04.953703 | a188c242-59b5-4c19-a24d-035ba96b64a2 ==============================
[0m12:52:04.953703 [info ] [MainThread]: Running with dbt=1.6.18
[0m12:52:04.954731 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/workspaces/vg_case_study_tim/transformation', 'log_path': '/workspaces/vg_case_study_tim/transformation/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select reporting__high_lvl_branch_transactions_kpis', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:52:05.219615 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a188c242-59b5-4c19-a24d-035ba96b64a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f769f75b850>]}
[0m12:52:05.234623 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a188c242-59b5-4c19-a24d-035ba96b64a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f769f7204d0>]}
[0m12:52:05.236283 [info ] [MainThread]: Registered adapter: duckdb=1.6.2
[0m12:52:05.266605 [debug] [MainThread]: checksum: 7b9fab86a08e9e96a48a825af743c566d95b877e068b8c6d0dbafbf714447189, vars: {}, profile: , target: , version: 1.6.18
[0m12:52:05.378377 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m12:52:05.379531 [debug] [MainThread]: Partial parsing: updated file: vg_casestudy://models/reporting/reporting__high_lvl_branch_transactions_kpis.sql
[0m12:52:05.380073 [debug] [MainThread]: Partial parsing: updated file: vg_casestudy://models/reporting/reporting__branch_transaction_currenncy_kpis.sql
[0m12:52:05.523977 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.vg_casestudy.main
[0m12:52:05.532630 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a188c242-59b5-4c19-a24d-035ba96b64a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f769f756550>]}
[0m12:52:05.575723 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a188c242-59b5-4c19-a24d-035ba96b64a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f769b4f4110>]}
[0m12:52:05.576336 [info ] [MainThread]: Found 20 models, 1 analysis, 4 seeds, 114 tests, 5 sources, 0 exposures, 0 metrics, 632 macros, 0 groups, 0 semantic models
[0m12:52:05.576736 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a188c242-59b5-4c19-a24d-035ba96b64a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f769b6695d0>]}
[0m12:52:05.579517 [info ] [MainThread]: 
[0m12:52:05.580317 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m12:52:05.581583 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_casestudy'
[0m12:52:05.597414 [debug] [ThreadPool]: Using duckdb connection "list_casestudy"
[0m12:52:05.598045 [debug] [ThreadPool]: On list_casestudy: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"casestudy"'
    
  
  
[0m12:52:05.598547 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:52:05.745030 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:52:05.746506 [debug] [ThreadPool]: On list_casestudy: Close
[0m12:52:05.752544 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy, now create_casestudy_reporting)
[0m12:52:05.753538 [debug] [ThreadPool]: Creating schema "database: "casestudy"
schema: "reporting"
"
[0m12:52:05.758356 [debug] [ThreadPool]: Using duckdb connection "create_casestudy_reporting"
[0m12:52:05.758785 [debug] [ThreadPool]: On create_casestudy_reporting: BEGIN
[0m12:52:05.759082 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:52:05.777577 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:52:05.778052 [debug] [ThreadPool]: Using duckdb connection "create_casestudy_reporting"
[0m12:52:05.778378 [debug] [ThreadPool]: On create_casestudy_reporting: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "create_casestudy_reporting"} */
create schema if not exists "casestudy"."reporting"
[0m12:52:05.779017 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:52:05.779932 [debug] [ThreadPool]: On create_casestudy_reporting: COMMIT
[0m12:52:05.780343 [debug] [ThreadPool]: Using duckdb connection "create_casestudy_reporting"
[0m12:52:05.780633 [debug] [ThreadPool]: On create_casestudy_reporting: COMMIT
[0m12:52:05.781245 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:52:05.781574 [debug] [ThreadPool]: On create_casestudy_reporting: Close
[0m12:52:05.787076 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_casestudy_reporting, now list_casestudy_raw)
[0m12:52:05.793770 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_raw"
[0m12:52:05.794193 [debug] [ThreadPool]: On list_casestudy_raw: BEGIN
[0m12:52:05.794485 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:52:05.807233 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:52:05.807695 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_raw"
[0m12:52:05.808018 [debug] [ThreadPool]: On list_casestudy_raw: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_raw"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'raw'
    and table_catalog = 'casestudy'
  
[0m12:52:05.824280 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:52:05.826022 [debug] [ThreadPool]: On list_casestudy_raw: ROLLBACK
[0m12:52:05.827648 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_raw'
[0m12:52:05.827978 [debug] [ThreadPool]: On list_casestudy_raw: Close
[0m12:52:05.832383 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy_raw, now list_casestudy_reporting)
[0m12:52:05.835308 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_reporting"
[0m12:52:05.835710 [debug] [ThreadPool]: On list_casestudy_reporting: BEGIN
[0m12:52:05.837549 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:52:05.848889 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:52:05.849314 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_reporting"
[0m12:52:05.849618 [debug] [ThreadPool]: On list_casestudy_reporting: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_reporting"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'reporting'
    and table_catalog = 'casestudy'
  
[0m12:52:05.859942 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:52:05.861532 [debug] [ThreadPool]: On list_casestudy_reporting: ROLLBACK
[0m12:52:05.862029 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_reporting'
[0m12:52:05.862303 [debug] [ThreadPool]: On list_casestudy_reporting: Close
[0m12:52:05.865439 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy_reporting, now list_casestudy_marts)
[0m12:52:05.867922 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_marts"
[0m12:52:05.869170 [debug] [ThreadPool]: On list_casestudy_marts: BEGIN
[0m12:52:05.869609 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:52:05.882241 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:52:05.882643 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_marts"
[0m12:52:05.882962 [debug] [ThreadPool]: On list_casestudy_marts: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_marts"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'marts'
    and table_catalog = 'casestudy'
  
[0m12:52:05.893263 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:52:05.894648 [debug] [ThreadPool]: On list_casestudy_marts: ROLLBACK
[0m12:52:05.895173 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_marts'
[0m12:52:05.895447 [debug] [ThreadPool]: On list_casestudy_marts: Close
[0m12:52:05.898406 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy_marts, now list_casestudy_staging)
[0m12:52:05.901303 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_staging"
[0m12:52:05.901697 [debug] [ThreadPool]: On list_casestudy_staging: BEGIN
[0m12:52:05.902018 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:52:05.914619 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:52:05.915063 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_staging"
[0m12:52:05.915367 [debug] [ThreadPool]: On list_casestudy_staging: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_staging"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'staging'
    and table_catalog = 'casestudy'
  
[0m12:52:05.926091 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:52:05.927692 [debug] [ThreadPool]: On list_casestudy_staging: ROLLBACK
[0m12:52:05.928176 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_staging'
[0m12:52:05.928483 [debug] [ThreadPool]: On list_casestudy_staging: Close
[0m12:52:05.931555 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy_staging, now list_casestudy_intermediate)
[0m12:52:05.934721 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_intermediate"
[0m12:52:05.935076 [debug] [ThreadPool]: On list_casestudy_intermediate: BEGIN
[0m12:52:05.935348 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:52:05.948924 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:52:05.949395 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_intermediate"
[0m12:52:05.949716 [debug] [ThreadPool]: On list_casestudy_intermediate: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_intermediate"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'intermediate'
    and table_catalog = 'casestudy'
  
[0m12:52:05.959632 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:52:05.961123 [debug] [ThreadPool]: On list_casestudy_intermediate: ROLLBACK
[0m12:52:05.961770 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_intermediate'
[0m12:52:05.962082 [debug] [ThreadPool]: On list_casestudy_intermediate: Close
[0m12:52:05.966434 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a188c242-59b5-4c19-a24d-035ba96b64a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f769b672b90>]}
[0m12:52:05.966958 [debug] [MainThread]: Using duckdb connection "master"
[0m12:52:05.967266 [debug] [MainThread]: On master: BEGIN
[0m12:52:05.967555 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:52:05.982146 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m12:52:05.982562 [debug] [MainThread]: On master: COMMIT
[0m12:52:05.982871 [debug] [MainThread]: Using duckdb connection "master"
[0m12:52:05.983148 [debug] [MainThread]: On master: COMMIT
[0m12:52:05.983797 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m12:52:05.984140 [debug] [MainThread]: On master: Close
[0m12:52:05.987175 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:52:05.987701 [info ] [MainThread]: 
[0m12:52:05.992082 [debug] [Thread-1 (]: Began running node model.vg_casestudy.reporting__high_lvl_branch_transactions_kpis
[0m12:52:05.992760 [info ] [Thread-1 (]: 1 of 1 START sql view model reporting.reporting__high_lvl_branch_transactions_kpis  [RUN]
[0m12:52:05.993895 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.vg_casestudy.reporting__high_lvl_branch_transactions_kpis'
[0m12:52:05.994411 [debug] [Thread-1 (]: Began compiling node model.vg_casestudy.reporting__high_lvl_branch_transactions_kpis
[0m12:52:06.004875 [debug] [Thread-1 (]: Writing injected SQL for node "model.vg_casestudy.reporting__high_lvl_branch_transactions_kpis"
[0m12:52:06.006286 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.reporting__high_lvl_branch_transactions_kpis (compile): 12:52:05.994675 => 12:52:06.005873
[0m12:52:06.006974 [debug] [Thread-1 (]: Began executing node model.vg_casestudy.reporting__high_lvl_branch_transactions_kpis
[0m12:52:06.041810 [debug] [Thread-1 (]: Writing runtime sql for node "model.vg_casestudy.reporting__high_lvl_branch_transactions_kpis"
[0m12:52:06.043064 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.reporting__high_lvl_branch_transactions_kpis"
[0m12:52:06.043559 [debug] [Thread-1 (]: On model.vg_casestudy.reporting__high_lvl_branch_transactions_kpis: BEGIN
[0m12:52:06.043890 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:52:06.065034 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m12:52:06.065535 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.reporting__high_lvl_branch_transactions_kpis"
[0m12:52:06.065971 [debug] [Thread-1 (]: On model.vg_casestudy.reporting__high_lvl_branch_transactions_kpis: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.reporting__high_lvl_branch_transactions_kpis"} */

  
  create view "casestudy"."reporting"."reporting__high_lvl_branch_transactions_kpis__dbt_tmp" as (
    with transactions as (
    select *
    from "casestudy"."marts"."marts__transactions_with_euro"
),

customers as (
    select *
    from "casestudy"."marts"."marts__customers_enriched"
),

joined as (
    select 
        transactions.*,
        customers.*

    from transactions 
    left join customers 
    on transactions.account_id = customers.customer_id
),

aggregated as(
    select 
        branch_id,
        branch_name,
        transaction_date,

        --transaction volume
        count(transaction_id) as count_transactions,
        count(case when transaction_type = 'deposit' then transaction_id end) as count_deposits,
        count(case when transaction_type = 'withdrawal' then transaction_id end) as count_withdrawals,
        count(case when transaction_type = 'transfer' then transaction_id end) as count_transfers,
        count(case when transaction_type = 'deposit' then transaction_id end)::float / count(transaction_id) as share_deposits,
        count(case when transaction_type = 'withdrawal' then transaction_id end)::float / count(transaction_id) as share_withdrawals,
        count(case when transaction_type = 'transfer' then transaction_id end)::float / count(transaction_id) as share_transfers,

        --customer segmentation
        count(distinct customer_id) as unique_customers,
        count(case when age < 30 then transaction_id end) as transactions_under_30,
        count(case when age between 30 and 50 then transaction_id end) as transactions_30_to_50,
        count(case when age > 50 then transaction_id end) as transactions_over_50,
        count(case when age < 30 then transaction_id end)::float / count(transaction_id) as share_customers_under_30,
        count(case when age between 30 and 50 then transaction_id end)::float / count(transaction_id) as share_customers_30_to_50,
        count(case when age > 50 then transaction_id end)::float / count(transaction_id) as share_customers_over_50,

        --transaction kpis
        sum(transaction_amount_euro) as total_transaction_amount_euro,
        avg(transaction_amount_euro) as avg_transaction_amount_euro,
        count(distinct transaction_currency) as num_transaction_currencies,
        count(case when has_account is true then transaction_id end) as transactions_with_account,
        count(case when as_account is false then transaction_id end) as transactions_without_account

    from joined
    group by branch_id, branch_name, transaction_date
)

select * 
from aggregated
  );

[0m12:52:06.088024 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.reporting__high_lvl_branch_transactions_kpis (execute): 12:52:06.007461 => 12:52:06.087634
[0m12:52:06.088548 [debug] [Thread-1 (]: On model.vg_casestudy.reporting__high_lvl_branch_transactions_kpis: ROLLBACK
[0m12:52:06.099948 [debug] [Thread-1 (]: Failed to rollback 'model.vg_casestudy.reporting__high_lvl_branch_transactions_kpis'
[0m12:52:06.100483 [debug] [Thread-1 (]: On model.vg_casestudy.reporting__high_lvl_branch_transactions_kpis: Close
[0m12:52:06.105163 [debug] [Thread-1 (]: Runtime Error in model reporting__high_lvl_branch_transactions_kpis (models/reporting/reporting__high_lvl_branch_transactions_kpis.sql)
  Binder Error: Referenced column "as_account" not found in FROM clause!
  Candidate bindings: "has_account", "account_id", "transaction_currency", "account_type", "account_id_1"
  
  LINE 54:         count(case when as_account is false then transaction_id end) as transaction...
                                   ^
[0m12:52:06.105812 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a188c242-59b5-4c19-a24d-035ba96b64a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f769b7994d0>]}
[0m12:52:06.106495 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model reporting.reporting__high_lvl_branch_transactions_kpis  [[31mERROR[0m in 0.11s]
[0m12:52:06.107134 [debug] [Thread-1 (]: Finished running node model.vg_casestudy.reporting__high_lvl_branch_transactions_kpis
[0m12:52:06.109950 [debug] [MainThread]: Using duckdb connection "master"
[0m12:52:06.110369 [debug] [MainThread]: On master: BEGIN
[0m12:52:06.110668 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:52:06.129274 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m12:52:06.129716 [debug] [MainThread]: On master: COMMIT
[0m12:52:06.130081 [debug] [MainThread]: Using duckdb connection "master"
[0m12:52:06.130351 [debug] [MainThread]: On master: COMMIT
[0m12:52:06.130945 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m12:52:06.131248 [debug] [MainThread]: On master: Close
[0m12:52:06.133919 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:52:06.134310 [debug] [MainThread]: Connection 'list_casestudy_intermediate' was properly closed.
[0m12:52:06.134581 [debug] [MainThread]: Connection 'model.vg_casestudy.reporting__high_lvl_branch_transactions_kpis' was properly closed.
[0m12:52:06.135342 [info ] [MainThread]: 
[0m12:52:06.135750 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.55 seconds (0.55s).
[0m12:52:06.136649 [debug] [MainThread]: Command end result
[0m12:52:06.162682 [info ] [MainThread]: 
[0m12:52:06.163191 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m12:52:06.163546 [info ] [MainThread]: 
[0m12:52:06.163899 [error] [MainThread]:   Runtime Error in model reporting__high_lvl_branch_transactions_kpis (models/reporting/reporting__high_lvl_branch_transactions_kpis.sql)
  Binder Error: Referenced column "as_account" not found in FROM clause!
  Candidate bindings: "has_account", "account_id", "transaction_currency", "account_type", "account_id_1"
  
  LINE 54:         count(case when as_account is false then transaction_id end) as transaction...
                                   ^
[0m12:52:06.164209 [info ] [MainThread]: 
[0m12:52:06.164513 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m12:52:06.164964 [debug] [MainThread]: Command `dbt run` failed at 12:52:06.164870 after 1.23 seconds
[0m12:52:06.165326 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f769ffc4250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f769f87bf90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f769f87bfd0>]}
[0m12:52:06.165686 [debug] [MainThread]: Flushing usage events
[0m12:52:41.290231 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f72f71e8d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f72f739f1d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f72f71d6bd0>]}


============================== 12:52:41.293801 | f630aaec-2420-4127-9d88-72b1c7fb7e20 ==============================
[0m12:52:41.293801 [info ] [MainThread]: Running with dbt=1.6.18
[0m12:52:41.294384 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/workspaces/vg_case_study_tim/transformation/logs', 'profiles_dir': '/workspaces/vg_case_study_tim/transformation', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --select reporting__high_lvl_branch_transactions_kpis', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:52:41.420631 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f630aaec-2420-4127-9d88-72b1c7fb7e20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f72f2f0ee10>]}
[0m12:52:41.439172 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f630aaec-2420-4127-9d88-72b1c7fb7e20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f72f727da90>]}
[0m12:52:41.440477 [info ] [MainThread]: Registered adapter: duckdb=1.6.2
[0m12:52:41.470673 [debug] [MainThread]: checksum: 7b9fab86a08e9e96a48a825af743c566d95b877e068b8c6d0dbafbf714447189, vars: {}, profile: , target: , version: 1.6.18
[0m12:52:41.529346 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m12:52:41.530225 [debug] [MainThread]: Partial parsing: updated file: vg_casestudy://models/reporting/reporting__high_lvl_branch_transactions_kpis.sql
[0m12:52:41.530695 [debug] [MainThread]: Partial parsing: updated file: vg_casestudy://models/reporting/reporting__branch_transaction_currenncy_kpis.sql
[0m12:52:41.669919 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.vg_casestudy.main
[0m12:52:41.679566 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f630aaec-2420-4127-9d88-72b1c7fb7e20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f72f2c400d0>]}
[0m12:52:41.720683 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f630aaec-2420-4127-9d88-72b1c7fb7e20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f72f2bc6f90>]}
[0m12:52:41.721255 [info ] [MainThread]: Found 20 models, 1 analysis, 4 seeds, 114 tests, 5 sources, 0 exposures, 0 metrics, 632 macros, 0 groups, 0 semantic models
[0m12:52:41.721860 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f630aaec-2420-4127-9d88-72b1c7fb7e20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f72f2b71a90>]}
[0m12:52:41.726302 [info ] [MainThread]: 
[0m12:52:41.727263 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m12:52:41.728588 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_casestudy'
[0m12:52:41.742893 [debug] [ThreadPool]: Using duckdb connection "list_casestudy"
[0m12:52:41.743457 [debug] [ThreadPool]: On list_casestudy: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"casestudy"'
    
  
  
[0m12:52:41.743981 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:52:41.765889 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:52:41.767257 [debug] [ThreadPool]: On list_casestudy: Close
[0m12:52:41.772221 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy, now create_casestudy_reporting)
[0m12:52:41.773098 [debug] [ThreadPool]: Creating schema "database: "casestudy"
schema: "reporting"
"
[0m12:52:41.777654 [debug] [ThreadPool]: Using duckdb connection "create_casestudy_reporting"
[0m12:52:41.778050 [debug] [ThreadPool]: On create_casestudy_reporting: BEGIN
[0m12:52:41.778334 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:52:41.792408 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:52:41.793145 [debug] [ThreadPool]: Using duckdb connection "create_casestudy_reporting"
[0m12:52:41.793586 [debug] [ThreadPool]: On create_casestudy_reporting: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "create_casestudy_reporting"} */
create schema if not exists "casestudy"."reporting"
[0m12:52:41.794328 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:52:41.795258 [debug] [ThreadPool]: On create_casestudy_reporting: COMMIT
[0m12:52:41.795602 [debug] [ThreadPool]: Using duckdb connection "create_casestudy_reporting"
[0m12:52:41.795874 [debug] [ThreadPool]: On create_casestudy_reporting: COMMIT
[0m12:52:41.796685 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:52:41.797001 [debug] [ThreadPool]: On create_casestudy_reporting: Close
[0m12:52:41.802985 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_casestudy_reporting, now list_casestudy_intermediate)
[0m12:52:41.809797 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_intermediate"
[0m12:52:41.810319 [debug] [ThreadPool]: On list_casestudy_intermediate: BEGIN
[0m12:52:41.810626 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:52:41.822160 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:52:41.822817 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_intermediate"
[0m12:52:41.823334 [debug] [ThreadPool]: On list_casestudy_intermediate: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_intermediate"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'intermediate'
    and table_catalog = 'casestudy'
  
[0m12:52:41.834578 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:52:41.836239 [debug] [ThreadPool]: On list_casestudy_intermediate: ROLLBACK
[0m12:52:41.836901 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_intermediate'
[0m12:52:41.837181 [debug] [ThreadPool]: On list_casestudy_intermediate: Close
[0m12:52:41.840813 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy_intermediate, now list_casestudy_reporting)
[0m12:52:41.844909 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_reporting"
[0m12:52:41.845292 [debug] [ThreadPool]: On list_casestudy_reporting: BEGIN
[0m12:52:41.845563 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:52:41.858043 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:52:41.858482 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_reporting"
[0m12:52:41.858861 [debug] [ThreadPool]: On list_casestudy_reporting: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_reporting"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'reporting'
    and table_catalog = 'casestudy'
  
[0m12:52:41.869269 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:52:41.870608 [debug] [ThreadPool]: On list_casestudy_reporting: ROLLBACK
[0m12:52:41.871112 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_reporting'
[0m12:52:41.871379 [debug] [ThreadPool]: On list_casestudy_reporting: Close
[0m12:52:41.874794 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy_reporting, now list_casestudy_raw)
[0m12:52:41.877155 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_raw"
[0m12:52:41.877552 [debug] [ThreadPool]: On list_casestudy_raw: BEGIN
[0m12:52:41.877878 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:52:41.890742 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:52:41.891427 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_raw"
[0m12:52:41.891920 [debug] [ThreadPool]: On list_casestudy_raw: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_raw"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'raw'
    and table_catalog = 'casestudy'
  
[0m12:52:41.901162 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:52:41.902715 [debug] [ThreadPool]: On list_casestudy_raw: ROLLBACK
[0m12:52:41.903276 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_raw'
[0m12:52:41.903630 [debug] [ThreadPool]: On list_casestudy_raw: Close
[0m12:52:41.907471 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy_raw, now list_casestudy_marts)
[0m12:52:41.911878 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_marts"
[0m12:52:41.912345 [debug] [ThreadPool]: On list_casestudy_marts: BEGIN
[0m12:52:41.912687 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:52:41.927975 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:52:41.928489 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_marts"
[0m12:52:41.928878 [debug] [ThreadPool]: On list_casestudy_marts: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_marts"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'marts'
    and table_catalog = 'casestudy'
  
[0m12:52:41.939379 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:52:41.941423 [debug] [ThreadPool]: On list_casestudy_marts: ROLLBACK
[0m12:52:41.942322 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_marts'
[0m12:52:41.942860 [debug] [ThreadPool]: On list_casestudy_marts: Close
[0m12:52:41.946723 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy_marts, now list_casestudy_staging)
[0m12:52:41.949734 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_staging"
[0m12:52:41.950100 [debug] [ThreadPool]: On list_casestudy_staging: BEGIN
[0m12:52:41.950367 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:52:41.962679 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:52:41.963103 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_staging"
[0m12:52:41.963468 [debug] [ThreadPool]: On list_casestudy_staging: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_staging"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'staging'
    and table_catalog = 'casestudy'
  
[0m12:52:41.973325 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:52:41.975035 [debug] [ThreadPool]: On list_casestudy_staging: ROLLBACK
[0m12:52:41.975570 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_staging'
[0m12:52:41.975907 [debug] [ThreadPool]: On list_casestudy_staging: Close
[0m12:52:41.980423 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f630aaec-2420-4127-9d88-72b1c7fb7e20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f72f781ef90>]}
[0m12:52:41.980922 [debug] [MainThread]: Using duckdb connection "master"
[0m12:52:41.981222 [debug] [MainThread]: On master: BEGIN
[0m12:52:41.981484 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:52:41.999667 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m12:52:42.000090 [debug] [MainThread]: On master: COMMIT
[0m12:52:42.000393 [debug] [MainThread]: Using duckdb connection "master"
[0m12:52:42.000656 [debug] [MainThread]: On master: COMMIT
[0m12:52:42.001156 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m12:52:42.001454 [debug] [MainThread]: On master: Close
[0m12:52:42.004044 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:52:42.004480 [info ] [MainThread]: 
[0m12:52:42.008354 [debug] [Thread-1 (]: Began running node model.vg_casestudy.reporting__high_lvl_branch_transactions_kpis
[0m12:52:42.008941 [info ] [Thread-1 (]: 1 of 1 START sql view model reporting.reporting__high_lvl_branch_transactions_kpis  [RUN]
[0m12:52:42.009913 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.vg_casestudy.reporting__high_lvl_branch_transactions_kpis'
[0m12:52:42.010322 [debug] [Thread-1 (]: Began compiling node model.vg_casestudy.reporting__high_lvl_branch_transactions_kpis
[0m12:52:42.021330 [debug] [Thread-1 (]: Writing injected SQL for node "model.vg_casestudy.reporting__high_lvl_branch_transactions_kpis"
[0m12:52:42.023695 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.reporting__high_lvl_branch_transactions_kpis (compile): 12:52:42.010549 => 12:52:42.023093
[0m12:52:42.024551 [debug] [Thread-1 (]: Began executing node model.vg_casestudy.reporting__high_lvl_branch_transactions_kpis
[0m12:52:42.056578 [debug] [Thread-1 (]: Writing runtime sql for node "model.vg_casestudy.reporting__high_lvl_branch_transactions_kpis"
[0m12:52:42.057908 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.reporting__high_lvl_branch_transactions_kpis"
[0m12:52:42.058360 [debug] [Thread-1 (]: On model.vg_casestudy.reporting__high_lvl_branch_transactions_kpis: BEGIN
[0m12:52:42.058696 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:52:42.073772 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m12:52:42.074354 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.reporting__high_lvl_branch_transactions_kpis"
[0m12:52:42.074830 [debug] [Thread-1 (]: On model.vg_casestudy.reporting__high_lvl_branch_transactions_kpis: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.reporting__high_lvl_branch_transactions_kpis"} */

  
  create view "casestudy"."reporting"."reporting__high_lvl_branch_transactions_kpis__dbt_tmp" as (
    with transactions as (
    select *
    from "casestudy"."marts"."marts__transactions_with_euro"
),

customers as (
    select *
    from "casestudy"."marts"."marts__customers_enriched"
),

joined as (
    select 
        transactions.*,
        customers.*

    from transactions 
    left join customers 
    on transactions.account_id = customers.customer_id
),

aggregated as(
    select 
        branch_id,
        branch_name,
        transaction_date,

        --transaction volume
        count(transaction_id) as count_transactions,
        count(case when transaction_type = 'deposit' then transaction_id end) as count_deposits,
        count(case when transaction_type = 'withdrawal' then transaction_id end) as count_withdrawals,
        count(case when transaction_type = 'transfer' then transaction_id end) as count_transfers,
        count(case when transaction_type = 'deposit' then transaction_id end)::float / count(transaction_id) as share_deposits,
        count(case when transaction_type = 'withdrawal' then transaction_id end)::float / count(transaction_id) as share_withdrawals,
        count(case when transaction_type = 'transfer' then transaction_id end)::float / count(transaction_id) as share_transfers,

        --customer segmentation
        count(distinct customer_id) as unique_customers,
        count(case when age < 30 then transaction_id end) as transactions_under_30,
        count(case when age between 30 and 50 then transaction_id end) as transactions_30_to_50,
        count(case when age > 50 then transaction_id end) as transactions_over_50,
        count(case when age < 30 then transaction_id end)::float / count(transaction_id) as share_customers_under_30,
        count(case when age between 30 and 50 then transaction_id end)::float / count(transaction_id) as share_customers_30_to_50,
        count(case when age > 50 then transaction_id end)::float / count(transaction_id) as share_customers_over_50,

        --transaction kpis
        sum(transaction_amount_euro) as total_transaction_amount_euro,
        avg(transaction_amount_euro) as avg_transaction_amount_euro,
        count(distinct transaction_currency) as num_transaction_currencies,
        count(case when has_account is true then transaction_id end) as transactions_with_account,
        count(case when has_account is false then transaction_id end) as transactions_without_account

    from joined
    group by branch_id, branch_name, transaction_date
)

select * 
from aggregated
  );

[0m12:52:42.077512 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m12:52:42.086142 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.reporting__high_lvl_branch_transactions_kpis"
[0m12:52:42.086659 [debug] [Thread-1 (]: On model.vg_casestudy.reporting__high_lvl_branch_transactions_kpis: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.reporting__high_lvl_branch_transactions_kpis"} */
alter view "casestudy"."reporting"."reporting__high_lvl_branch_transactions_kpis" rename to "reporting__high_lvl_branch_transactions_kpis__dbt_backup"
[0m12:52:42.087699 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m12:52:42.091619 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.reporting__high_lvl_branch_transactions_kpis"
[0m12:52:42.092095 [debug] [Thread-1 (]: On model.vg_casestudy.reporting__high_lvl_branch_transactions_kpis: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.reporting__high_lvl_branch_transactions_kpis"} */
alter view "casestudy"."reporting"."reporting__high_lvl_branch_transactions_kpis__dbt_tmp" rename to "reporting__high_lvl_branch_transactions_kpis"
[0m12:52:42.093140 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m12:52:42.109261 [debug] [Thread-1 (]: On model.vg_casestudy.reporting__high_lvl_branch_transactions_kpis: COMMIT
[0m12:52:42.109755 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.reporting__high_lvl_branch_transactions_kpis"
[0m12:52:42.110335 [debug] [Thread-1 (]: On model.vg_casestudy.reporting__high_lvl_branch_transactions_kpis: COMMIT
[0m12:52:42.116335 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m12:52:42.121708 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.reporting__high_lvl_branch_transactions_kpis"
[0m12:52:42.122231 [debug] [Thread-1 (]: On model.vg_casestudy.reporting__high_lvl_branch_transactions_kpis: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.reporting__high_lvl_branch_transactions_kpis"} */
drop view if exists "casestudy"."reporting"."reporting__high_lvl_branch_transactions_kpis__dbt_backup" cascade
[0m12:52:42.126258 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m12:52:42.127842 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.reporting__high_lvl_branch_transactions_kpis (execute): 12:52:42.024958 => 12:52:42.127664
[0m12:52:42.128216 [debug] [Thread-1 (]: On model.vg_casestudy.reporting__high_lvl_branch_transactions_kpis: Close
[0m12:52:42.159459 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f630aaec-2420-4127-9d88-72b1c7fb7e20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f72fba61790>]}
[0m12:52:42.160231 [info ] [Thread-1 (]: 1 of 1 OK created sql view model reporting.reporting__high_lvl_branch_transactions_kpis  [[32mOK[0m in 0.15s]
[0m12:52:42.160842 [debug] [Thread-1 (]: Finished running node model.vg_casestudy.reporting__high_lvl_branch_transactions_kpis
[0m12:52:42.162637 [debug] [MainThread]: Using duckdb connection "master"
[0m12:52:42.163006 [debug] [MainThread]: On master: BEGIN
[0m12:52:42.163283 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:52:42.182025 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m12:52:42.182464 [debug] [MainThread]: On master: COMMIT
[0m12:52:42.182786 [debug] [MainThread]: Using duckdb connection "master"
[0m12:52:42.183057 [debug] [MainThread]: On master: COMMIT
[0m12:52:42.183664 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m12:52:42.183996 [debug] [MainThread]: On master: Close
[0m12:52:42.186753 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:52:42.187282 [debug] [MainThread]: Connection 'list_casestudy_staging' was properly closed.
[0m12:52:42.187730 [debug] [MainThread]: Connection 'model.vg_casestudy.reporting__high_lvl_branch_transactions_kpis' was properly closed.
[0m12:52:42.188362 [info ] [MainThread]: 
[0m12:52:42.189111 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.46 seconds (0.46s).
[0m12:52:42.190360 [debug] [MainThread]: Command end result
[0m12:52:42.212722 [info ] [MainThread]: 
[0m12:52:42.213285 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:52:42.213621 [info ] [MainThread]: 
[0m12:52:42.213946 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:52:42.214441 [debug] [MainThread]: Command `dbt run` succeeded at 12:52:42.214344 after 0.93 seconds
[0m12:52:42.214798 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f72f73aa790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f72f6f2b4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f72f6f83dd0>]}
[0m12:52:42.215130 [debug] [MainThread]: Flushing usage events
[0m12:53:01.318587 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3da3a70c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3da3c2fd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3da3d8df10>]}


============================== 12:53:01.321114 | c89560f2-f0d0-4a44-9f35-73727ea01649 ==============================
[0m12:53:01.321114 [info ] [MainThread]: Running with dbt=1.6.18
[0m12:53:01.321665 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/workspaces/vg_case_study_tim/transformation', 'debug': 'False', 'version_check': 'True', 'log_path': '/workspaces/vg_case_study_tim/transformation/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select reporting__branch_transaction_currenncy_kpis', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:53:01.426886 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c89560f2-f0d0-4a44-9f35-73727ea01649', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3da3a476d0>]}
[0m12:53:01.442534 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c89560f2-f0d0-4a44-9f35-73727ea01649', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3da3a474d0>]}
[0m12:53:01.443310 [info ] [MainThread]: Registered adapter: duckdb=1.6.2
[0m12:53:01.471578 [debug] [MainThread]: checksum: 7b9fab86a08e9e96a48a825af743c566d95b877e068b8c6d0dbafbf714447189, vars: {}, profile: , target: , version: 1.6.18
[0m12:53:01.524305 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:53:01.525011 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:53:01.527021 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.vg_casestudy.main
[0m12:53:01.535413 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c89560f2-f0d0-4a44-9f35-73727ea01649', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3da391f590>]}
[0m12:53:01.619621 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c89560f2-f0d0-4a44-9f35-73727ea01649', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3da3789a90>]}
[0m12:53:01.620180 [info ] [MainThread]: Found 20 models, 1 analysis, 4 seeds, 114 tests, 5 sources, 0 exposures, 0 metrics, 632 macros, 0 groups, 0 semantic models
[0m12:53:01.620602 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c89560f2-f0d0-4a44-9f35-73727ea01649', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3da3d8fb50>]}
[0m12:53:01.623572 [info ] [MainThread]: 
[0m12:53:01.624560 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m12:53:01.626085 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_casestudy'
[0m12:53:01.642559 [debug] [ThreadPool]: Using duckdb connection "list_casestudy"
[0m12:53:01.643219 [debug] [ThreadPool]: On list_casestudy: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"casestudy"'
    
  
  
[0m12:53:01.643603 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:53:01.664040 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:53:01.666282 [debug] [ThreadPool]: On list_casestudy: Close
[0m12:53:01.671563 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy, now create_casestudy_reporting)
[0m12:53:01.672842 [debug] [ThreadPool]: Creating schema "database: "casestudy"
schema: "reporting"
"
[0m12:53:01.678400 [debug] [ThreadPool]: Using duckdb connection "create_casestudy_reporting"
[0m12:53:01.678853 [debug] [ThreadPool]: On create_casestudy_reporting: BEGIN
[0m12:53:01.679144 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:53:01.692458 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:53:01.693336 [debug] [ThreadPool]: Using duckdb connection "create_casestudy_reporting"
[0m12:53:01.693722 [debug] [ThreadPool]: On create_casestudy_reporting: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "create_casestudy_reporting"} */
create schema if not exists "casestudy"."reporting"
[0m12:53:01.694650 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:53:01.695620 [debug] [ThreadPool]: On create_casestudy_reporting: COMMIT
[0m12:53:01.695945 [debug] [ThreadPool]: Using duckdb connection "create_casestudy_reporting"
[0m12:53:01.696253 [debug] [ThreadPool]: On create_casestudy_reporting: COMMIT
[0m12:53:01.696820 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:53:01.697121 [debug] [ThreadPool]: On create_casestudy_reporting: Close
[0m12:53:01.702945 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_casestudy_reporting, now list_casestudy_marts)
[0m12:53:01.709550 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_marts"
[0m12:53:01.710030 [debug] [ThreadPool]: On list_casestudy_marts: BEGIN
[0m12:53:01.710343 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:53:01.723710 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:53:01.724331 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_marts"
[0m12:53:01.724698 [debug] [ThreadPool]: On list_casestudy_marts: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_marts"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'marts'
    and table_catalog = 'casestudy'
  
[0m12:53:01.736269 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:53:01.738276 [debug] [ThreadPool]: On list_casestudy_marts: ROLLBACK
[0m12:53:01.739244 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_marts'
[0m12:53:01.739743 [debug] [ThreadPool]: On list_casestudy_marts: Close
[0m12:53:01.743119 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy_marts, now list_casestudy_raw)
[0m12:53:01.746035 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_raw"
[0m12:53:01.746416 [debug] [ThreadPool]: On list_casestudy_raw: BEGIN
[0m12:53:01.746708 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:53:01.759554 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:53:01.759995 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_raw"
[0m12:53:01.760316 [debug] [ThreadPool]: On list_casestudy_raw: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_raw"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'raw'
    and table_catalog = 'casestudy'
  
[0m12:53:01.769233 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:53:01.770667 [debug] [ThreadPool]: On list_casestudy_raw: ROLLBACK
[0m12:53:01.771150 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_raw'
[0m12:53:01.771418 [debug] [ThreadPool]: On list_casestudy_raw: Close
[0m12:53:01.774774 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy_raw, now list_casestudy_staging)
[0m12:53:01.778444 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_staging"
[0m12:53:01.778912 [debug] [ThreadPool]: On list_casestudy_staging: BEGIN
[0m12:53:01.779242 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:53:01.791851 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:53:01.792286 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_staging"
[0m12:53:01.792611 [debug] [ThreadPool]: On list_casestudy_staging: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_staging"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'staging'
    and table_catalog = 'casestudy'
  
[0m12:53:01.802466 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:53:01.803847 [debug] [ThreadPool]: On list_casestudy_staging: ROLLBACK
[0m12:53:01.804374 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_staging'
[0m12:53:01.804703 [debug] [ThreadPool]: On list_casestudy_staging: Close
[0m12:53:01.808324 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy_staging, now list_casestudy_intermediate)
[0m12:53:01.811646 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_intermediate"
[0m12:53:01.812028 [debug] [ThreadPool]: On list_casestudy_intermediate: BEGIN
[0m12:53:01.812379 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:53:01.824542 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:53:01.824971 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_intermediate"
[0m12:53:01.825269 [debug] [ThreadPool]: On list_casestudy_intermediate: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_intermediate"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'intermediate'
    and table_catalog = 'casestudy'
  
[0m12:53:01.834654 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:53:01.836202 [debug] [ThreadPool]: On list_casestudy_intermediate: ROLLBACK
[0m12:53:01.836715 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_intermediate'
[0m12:53:01.836984 [debug] [ThreadPool]: On list_casestudy_intermediate: Close
[0m12:53:01.840571 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy_intermediate, now list_casestudy_reporting)
[0m12:53:01.844591 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_reporting"
[0m12:53:01.845058 [debug] [ThreadPool]: On list_casestudy_reporting: BEGIN
[0m12:53:01.845368 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:53:01.857367 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:53:01.857911 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_reporting"
[0m12:53:01.858259 [debug] [ThreadPool]: On list_casestudy_reporting: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_reporting"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'reporting'
    and table_catalog = 'casestudy'
  
[0m12:53:01.868487 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:53:01.869810 [debug] [ThreadPool]: On list_casestudy_reporting: ROLLBACK
[0m12:53:01.870302 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_reporting'
[0m12:53:01.870569 [debug] [ThreadPool]: On list_casestudy_reporting: Close
[0m12:53:01.874882 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c89560f2-f0d0-4a44-9f35-73727ea01649', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d9f5f7d10>]}
[0m12:53:01.875514 [debug] [MainThread]: Using duckdb connection "master"
[0m12:53:01.875854 [debug] [MainThread]: On master: BEGIN
[0m12:53:01.876140 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:53:01.894798 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m12:53:01.895279 [debug] [MainThread]: On master: COMMIT
[0m12:53:01.895595 [debug] [MainThread]: Using duckdb connection "master"
[0m12:53:01.895862 [debug] [MainThread]: On master: COMMIT
[0m12:53:01.896540 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m12:53:01.896935 [debug] [MainThread]: On master: Close
[0m12:53:01.899624 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:53:01.900100 [info ] [MainThread]: 
[0m12:53:01.902712 [debug] [Thread-1 (]: Began running node model.vg_casestudy.reporting__branch_transaction_currenncy_kpis
[0m12:53:01.903177 [info ] [Thread-1 (]: 1 of 1 START sql view model reporting.reporting__branch_transaction_currenncy_kpis  [RUN]
[0m12:53:01.903928 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.vg_casestudy.reporting__branch_transaction_currenncy_kpis'
[0m12:53:01.904247 [debug] [Thread-1 (]: Began compiling node model.vg_casestudy.reporting__branch_transaction_currenncy_kpis
[0m12:53:01.914025 [debug] [Thread-1 (]: Writing injected SQL for node "model.vg_casestudy.reporting__branch_transaction_currenncy_kpis"
[0m12:53:01.914870 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.reporting__branch_transaction_currenncy_kpis (compile): 12:53:01.904486 => 12:53:01.914624
[0m12:53:01.915334 [debug] [Thread-1 (]: Began executing node model.vg_casestudy.reporting__branch_transaction_currenncy_kpis
[0m12:53:01.952390 [debug] [Thread-1 (]: Writing runtime sql for node "model.vg_casestudy.reporting__branch_transaction_currenncy_kpis"
[0m12:53:01.953201 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.reporting__branch_transaction_currenncy_kpis"
[0m12:53:01.953644 [debug] [Thread-1 (]: On model.vg_casestudy.reporting__branch_transaction_currenncy_kpis: BEGIN
[0m12:53:01.953962 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:53:01.966900 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m12:53:01.967414 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.reporting__branch_transaction_currenncy_kpis"
[0m12:53:01.967966 [debug] [Thread-1 (]: On model.vg_casestudy.reporting__branch_transaction_currenncy_kpis: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.reporting__branch_transaction_currenncy_kpis"} */

  
  create view "casestudy"."reporting"."reporting__branch_transaction_currenncy_kpis__dbt_tmp" as (
    with transactions as (
    select *
    from "casestudy"."marts"."marts__transactions_with_euro"
),

customers as (
    select *
    from "casestudy"."marts"."marts__customers_enriched"
),

joined as (
    select 
        transactions.*,
        customers.*
    from transactions 
    left join customers 
    on transactions.account_id = customers.customer_id
),

aggregated as(
    select 
        branch_id,
        branch_name,
        transaction_date,
        transaction_currency,

        --transaction volume
        count(transaction_id) as count_transactions,
        count(case when transaction_type = 'deposit' then transaction_id end) as count_deposits,
        count(case when transaction_type = 'withdrawal' then transaction_id end) as count_withdrawals,
        count(case when transaction_type = 'transfer' then transaction_id end) as count_transfers,
        count(case when transaction_type = 'deposit' then transaction_id end)::float / count(transaction_id) as share_deposits,
        count(case when transaction_type = 'withdrawal' then transaction_id end)::float / count(transaction_id) as share_withdrawals,
        count(case when transaction_type = 'transfer' then transaction_id end)::float / count(transaction_id) as share_transfers,

        --customer segmentation
        count(distinct customer_id) as unique_customers,
        count(case when age < 30 then transaction_id end) as transactions_under_30,
        count(case when age between 30 and 50 then transaction_id end) as transactions_30_to_50,
        count(case when age > 50 then transaction_id end) as transactions_over_50,
        count(case when age < 30 then transaction_id end)::float / count(transaction_id) as share_customers_under_30,
        count(case when age between 30 and 50 then transaction_id end)::float / count(transaction_id) as share_customers_30_to_50,
        count(case when age > 50 then transaction_id end)::float / count(transaction_id) as share_customers_over_50,

        --transaction kpis
        sum(transaction_amount_euro) as total_transaction_amount_euro,
        avg(transaction_amount_euro) as avg_transaction_amount_euro,
        count(case when has_account is true then transaction_id end) as transactions_with_account,
        count(case when has_account is false then transaction_id end) as transactions_without_account

    from joined
    group by branch_id, branch_name, transaction_date, transaction_currency
)

select * 
from aggregated
  );

[0m12:53:01.970855 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m12:53:01.978120 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.reporting__branch_transaction_currenncy_kpis"
[0m12:53:01.978639 [debug] [Thread-1 (]: On model.vg_casestudy.reporting__branch_transaction_currenncy_kpis: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.reporting__branch_transaction_currenncy_kpis"} */
alter view "casestudy"."reporting"."reporting__branch_transaction_currenncy_kpis" rename to "reporting__branch_transaction_currenncy_kpis__dbt_backup"
[0m12:53:01.980487 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m12:53:01.983623 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.reporting__branch_transaction_currenncy_kpis"
[0m12:53:01.983999 [debug] [Thread-1 (]: On model.vg_casestudy.reporting__branch_transaction_currenncy_kpis: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.reporting__branch_transaction_currenncy_kpis"} */
alter view "casestudy"."reporting"."reporting__branch_transaction_currenncy_kpis__dbt_tmp" rename to "reporting__branch_transaction_currenncy_kpis"
[0m12:53:01.984791 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m12:53:02.000669 [debug] [Thread-1 (]: On model.vg_casestudy.reporting__branch_transaction_currenncy_kpis: COMMIT
[0m12:53:02.001153 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.reporting__branch_transaction_currenncy_kpis"
[0m12:53:02.001487 [debug] [Thread-1 (]: On model.vg_casestudy.reporting__branch_transaction_currenncy_kpis: COMMIT
[0m12:53:02.007640 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m12:53:02.013195 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.reporting__branch_transaction_currenncy_kpis"
[0m12:53:02.013705 [debug] [Thread-1 (]: On model.vg_casestudy.reporting__branch_transaction_currenncy_kpis: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.reporting__branch_transaction_currenncy_kpis"} */
drop view if exists "casestudy"."reporting"."reporting__branch_transaction_currenncy_kpis__dbt_backup" cascade
[0m12:53:02.018711 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m12:53:02.020260 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.reporting__branch_transaction_currenncy_kpis (execute): 12:53:01.915575 => 12:53:02.020075
[0m12:53:02.020625 [debug] [Thread-1 (]: On model.vg_casestudy.reporting__branch_transaction_currenncy_kpis: Close
[0m12:53:02.046585 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c89560f2-f0d0-4a44-9f35-73727ea01649', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d9f417850>]}
[0m12:53:02.047320 [info ] [Thread-1 (]: 1 of 1 OK created sql view model reporting.reporting__branch_transaction_currenncy_kpis  [[32mOK[0m in 0.14s]
[0m12:53:02.047987 [debug] [Thread-1 (]: Finished running node model.vg_casestudy.reporting__branch_transaction_currenncy_kpis
[0m12:53:02.050110 [debug] [MainThread]: Using duckdb connection "master"
[0m12:53:02.050437 [debug] [MainThread]: On master: BEGIN
[0m12:53:02.050720 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:53:02.066413 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m12:53:02.066879 [debug] [MainThread]: On master: COMMIT
[0m12:53:02.067202 [debug] [MainThread]: Using duckdb connection "master"
[0m12:53:02.067549 [debug] [MainThread]: On master: COMMIT
[0m12:53:02.068357 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m12:53:02.068706 [debug] [MainThread]: On master: Close
[0m12:53:02.071311 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:53:02.071694 [debug] [MainThread]: Connection 'list_casestudy_reporting' was properly closed.
[0m12:53:02.071987 [debug] [MainThread]: Connection 'model.vg_casestudy.reporting__branch_transaction_currenncy_kpis' was properly closed.
[0m12:53:02.072376 [info ] [MainThread]: 
[0m12:53:02.072891 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.45 seconds (0.45s).
[0m12:53:02.073879 [debug] [MainThread]: Command end result
[0m12:53:02.101927 [info ] [MainThread]: 
[0m12:53:02.102548 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:53:02.102973 [info ] [MainThread]: 
[0m12:53:02.103368 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:53:02.103909 [debug] [MainThread]: Command `dbt run` succeeded at 12:53:02.103803 after 0.79 seconds
[0m12:53:02.104228 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3da3c07210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3da8357d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3da83f6dd0>]}
[0m12:53:02.104583 [debug] [MainThread]: Flushing usage events
[0m13:10:23.745903 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1cb427a090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1cb4147210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1cb42499d0>]}


============================== 13:10:23.751746 | 09895738-ae5c-463a-867f-86a644b3b5c4 ==============================
[0m13:10:23.751746 [info ] [MainThread]: Running with dbt=1.6.18
[0m13:10:23.752385 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/workspaces/vg_case_study_tim/transformation/logs', 'profiles_dir': '/workspaces/vg_case_study_tim/transformation', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select reporting__high_lvl_branch_transactions_kpis', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m13:10:23.931126 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '09895738-ae5c-463a-867f-86a644b3b5c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1cb0851510>]}
[0m13:10:23.945652 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '09895738-ae5c-463a-867f-86a644b3b5c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1cb0897050>]}
[0m13:10:23.947335 [info ] [MainThread]: Registered adapter: duckdb=1.6.2
[0m13:10:23.980518 [debug] [MainThread]: checksum: 7b9fab86a08e9e96a48a825af743c566d95b877e068b8c6d0dbafbf714447189, vars: {}, profile: , target: , version: 1.6.18
[0m13:10:24.093762 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m13:10:24.094918 [debug] [MainThread]: Partial parsing: updated file: vg_casestudy://models/reporting/reporting__high_lvl_branch_transactions_kpis.yml
[0m13:10:24.095545 [debug] [MainThread]: Partial parsing: updated file: vg_casestudy://models/reporting/reporting__high_lvl_branch_transactions_kpis.sql
[0m13:10:24.224039 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.vg_casestudy.main
[0m13:10:24.244202 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '09895738-ae5c-463a-867f-86a644b3b5c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1cb46cd4d0>]}
[0m13:10:24.301029 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '09895738-ae5c-463a-867f-86a644b3b5c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1cafd40550>]}
[0m13:10:24.301728 [info ] [MainThread]: Found 20 models, 1 analysis, 4 seeds, 114 tests, 5 sources, 0 exposures, 0 metrics, 632 macros, 0 groups, 0 semantic models
[0m13:10:24.302154 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '09895738-ae5c-463a-867f-86a644b3b5c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1cafd5d1d0>]}
[0m13:10:24.304922 [info ] [MainThread]: 
[0m13:10:24.305726 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m13:10:24.306915 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_casestudy'
[0m13:10:24.322329 [debug] [ThreadPool]: Using duckdb connection "list_casestudy"
[0m13:10:24.322790 [debug] [ThreadPool]: On list_casestudy: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"casestudy"'
    
  
  
[0m13:10:24.323111 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:10:24.465649 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:10:24.467562 [debug] [ThreadPool]: On list_casestudy: Close
[0m13:10:24.472533 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy, now create_casestudy_reporting)
[0m13:10:24.473342 [debug] [ThreadPool]: Creating schema "database: "casestudy"
schema: "reporting"
"
[0m13:10:24.477744 [debug] [ThreadPool]: Using duckdb connection "create_casestudy_reporting"
[0m13:10:24.478133 [debug] [ThreadPool]: On create_casestudy_reporting: BEGIN
[0m13:10:24.478405 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:10:24.490618 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:10:24.491028 [debug] [ThreadPool]: Using duckdb connection "create_casestudy_reporting"
[0m13:10:24.491318 [debug] [ThreadPool]: On create_casestudy_reporting: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "create_casestudy_reporting"} */
create schema if not exists "casestudy"."reporting"
[0m13:10:24.491972 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:10:24.492900 [debug] [ThreadPool]: On create_casestudy_reporting: COMMIT
[0m13:10:24.493181 [debug] [ThreadPool]: Using duckdb connection "create_casestudy_reporting"
[0m13:10:24.493449 [debug] [ThreadPool]: On create_casestudy_reporting: COMMIT
[0m13:10:24.493999 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:10:24.494275 [debug] [ThreadPool]: On create_casestudy_reporting: Close
[0m13:10:24.499200 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_casestudy_reporting, now list_casestudy_staging)
[0m13:10:24.505821 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_staging"
[0m13:10:24.506226 [debug] [ThreadPool]: On list_casestudy_staging: BEGIN
[0m13:10:24.506531 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:10:24.520480 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:10:24.520948 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_staging"
[0m13:10:24.521243 [debug] [ThreadPool]: On list_casestudy_staging: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_staging"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'staging'
    and table_catalog = 'casestudy'
  
[0m13:10:24.537783 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:10:24.539495 [debug] [ThreadPool]: On list_casestudy_staging: ROLLBACK
[0m13:10:24.540941 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_staging'
[0m13:10:24.541250 [debug] [ThreadPool]: On list_casestudy_staging: Close
[0m13:10:24.545676 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy_staging, now list_casestudy_marts)
[0m13:10:24.548140 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_marts"
[0m13:10:24.549944 [debug] [ThreadPool]: On list_casestudy_marts: BEGIN
[0m13:10:24.550256 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:10:24.561930 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:10:24.562354 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_marts"
[0m13:10:24.562645 [debug] [ThreadPool]: On list_casestudy_marts: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_marts"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'marts'
    and table_catalog = 'casestudy'
  
[0m13:10:24.572917 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:10:24.574383 [debug] [ThreadPool]: On list_casestudy_marts: ROLLBACK
[0m13:10:24.574890 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_marts'
[0m13:10:24.575162 [debug] [ThreadPool]: On list_casestudy_marts: Close
[0m13:10:24.578258 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy_marts, now list_casestudy_reporting)
[0m13:10:24.580647 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_reporting"
[0m13:10:24.581665 [debug] [ThreadPool]: On list_casestudy_reporting: BEGIN
[0m13:10:24.582009 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:10:24.595218 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:10:24.595649 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_reporting"
[0m13:10:24.595944 [debug] [ThreadPool]: On list_casestudy_reporting: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_reporting"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'reporting'
    and table_catalog = 'casestudy'
  
[0m13:10:24.605633 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:10:24.607214 [debug] [ThreadPool]: On list_casestudy_reporting: ROLLBACK
[0m13:10:24.607748 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_reporting'
[0m13:10:24.608107 [debug] [ThreadPool]: On list_casestudy_reporting: Close
[0m13:10:24.611191 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy_reporting, now list_casestudy_intermediate)
[0m13:10:24.613408 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_intermediate"
[0m13:10:24.613752 [debug] [ThreadPool]: On list_casestudy_intermediate: BEGIN
[0m13:10:24.614146 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:10:24.627431 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:10:24.627877 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_intermediate"
[0m13:10:24.628169 [debug] [ThreadPool]: On list_casestudy_intermediate: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_intermediate"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'intermediate'
    and table_catalog = 'casestudy'
  
[0m13:10:24.638590 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:10:24.640176 [debug] [ThreadPool]: On list_casestudy_intermediate: ROLLBACK
[0m13:10:24.640750 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_intermediate'
[0m13:10:24.641055 [debug] [ThreadPool]: On list_casestudy_intermediate: Close
[0m13:10:24.644105 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy_intermediate, now list_casestudy_raw)
[0m13:10:24.647286 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_raw"
[0m13:10:24.647674 [debug] [ThreadPool]: On list_casestudy_raw: BEGIN
[0m13:10:24.647980 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:10:24.660045 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:10:24.660511 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_raw"
[0m13:10:24.660862 [debug] [ThreadPool]: On list_casestudy_raw: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_raw"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'raw'
    and table_catalog = 'casestudy'
  
[0m13:10:24.670578 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:10:24.672066 [debug] [ThreadPool]: On list_casestudy_raw: ROLLBACK
[0m13:10:24.672672 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_raw'
[0m13:10:24.672964 [debug] [ThreadPool]: On list_casestudy_raw: Close
[0m13:10:24.677390 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '09895738-ae5c-463a-867f-86a644b3b5c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1cafd281d0>]}
[0m13:10:24.677874 [debug] [MainThread]: Using duckdb connection "master"
[0m13:10:24.678173 [debug] [MainThread]: On master: BEGIN
[0m13:10:24.678437 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:10:24.691414 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m13:10:24.691837 [debug] [MainThread]: On master: COMMIT
[0m13:10:24.692124 [debug] [MainThread]: Using duckdb connection "master"
[0m13:10:24.692379 [debug] [MainThread]: On master: COMMIT
[0m13:10:24.692895 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m13:10:24.693207 [debug] [MainThread]: On master: Close
[0m13:10:24.695675 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:10:24.696094 [info ] [MainThread]: 
[0m13:10:24.699926 [debug] [Thread-1 (]: Began running node model.vg_casestudy.reporting__high_lvl_branch_transactions_kpis
[0m13:10:24.700643 [info ] [Thread-1 (]: 1 of 1 START sql view model reporting.reporting__high_lvl_branch_transactions_kpis  [RUN]
[0m13:10:24.702373 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.vg_casestudy.reporting__high_lvl_branch_transactions_kpis'
[0m13:10:24.702797 [debug] [Thread-1 (]: Began compiling node model.vg_casestudy.reporting__high_lvl_branch_transactions_kpis
[0m13:10:24.712722 [debug] [Thread-1 (]: Writing injected SQL for node "model.vg_casestudy.reporting__high_lvl_branch_transactions_kpis"
[0m13:10:24.713784 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.reporting__high_lvl_branch_transactions_kpis (compile): 13:10:24.703049 => 13:10:24.713264
[0m13:10:24.717148 [debug] [Thread-1 (]: Began executing node model.vg_casestudy.reporting__high_lvl_branch_transactions_kpis
[0m13:10:24.753319 [debug] [Thread-1 (]: Writing runtime sql for node "model.vg_casestudy.reporting__high_lvl_branch_transactions_kpis"
[0m13:10:24.754040 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.reporting__high_lvl_branch_transactions_kpis"
[0m13:10:24.754476 [debug] [Thread-1 (]: On model.vg_casestudy.reporting__high_lvl_branch_transactions_kpis: BEGIN
[0m13:10:24.754791 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:10:24.769807 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:10:24.770300 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.reporting__high_lvl_branch_transactions_kpis"
[0m13:10:24.770822 [debug] [Thread-1 (]: On model.vg_casestudy.reporting__high_lvl_branch_transactions_kpis: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.reporting__high_lvl_branch_transactions_kpis"} */

  
  create view "casestudy"."reporting"."reporting__high_lvl_branch_transactions_kpis__dbt_tmp" as (
    with transactions as (
    select *
    from "casestudy"."marts"."marts__transactions_with_euro"
),

customers as (
    select *
    from "casestudy"."marts"."marts__customers_enriched"
),

joined as (
    select 
        transactions.*,
        customers.*

    from transactions 
    left join customers 
    on transactions.account_id = customers.customer_id
),

aggregated as(
    select 
        branch_id,
        branch_name,
        transaction_date,

        --transaction volume
        count(transaction_id) as count_transactions,
        count(case when transaction_type = 'deposit' then transaction_id end) as count_deposits,
        count(case when transaction_type = 'withdrawal' then transaction_id end) as count_withdrawals,
        count(case when transaction_type = 'transfer' then transaction_id end) as count_transfers,
        count(case when transaction_type = 'deposit' then transaction_id end)::float / count(transaction_id) as share_deposits,
        count(case when transaction_type = 'withdrawal' then transaction_id end)::float / count(transaction_id) as share_withdrawals,
        count(case when transaction_type = 'transfer' then transaction_id end)::float / count(transaction_id) as share_transfers,

        --customer segmentation
        count(distinct customer_id) as unique_customers,
        count(case when age < 30 then transaction_id end) as transactions_under_30,
        count(case when age between 30 and 50 then transaction_id end) as transactions_30_to_50,
        count(case when age > 50 then transaction_id end) as transactions_over_50,
        count(case when age < 30 then transaction_id end)::float / count(transaction_id) as share_customers_under_30,
        count(case when age between 30 and 50 then transaction_id end)::float / count(transaction_id) as share_customers_30_to_50,
        count(case when age > 50 then transaction_id end)::float / count(transaction_id) as share_customers_over_50,

        --transaction kpis
        sum(transaction_amount_euro) as total_transaction_amount_euro,
        avg(transaction_amount_euro) as avg_transaction_amount_euro,
        count(distinct transaction_currency) as num_transaction_currencies,
        count(case when has_account is true then transaction_id end) as transactions_with_account,
        count(case when has_account is false then transaction_id end) as transactions_without_account,
        sum(case when has_account is false then transaction_amount_euro else 0 end) as transaction_amount_euro_without_account

    from joined
    group by branch_id, branch_name, transaction_date
)

select * 
from aggregated
  );

[0m13:10:24.776632 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:10:24.787465 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.reporting__high_lvl_branch_transactions_kpis"
[0m13:10:24.787960 [debug] [Thread-1 (]: On model.vg_casestudy.reporting__high_lvl_branch_transactions_kpis: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.reporting__high_lvl_branch_transactions_kpis"} */
alter view "casestudy"."reporting"."reporting__high_lvl_branch_transactions_kpis" rename to "reporting__high_lvl_branch_transactions_kpis__dbt_backup"
[0m13:10:24.790092 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:10:24.793466 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.reporting__high_lvl_branch_transactions_kpis"
[0m13:10:24.793895 [debug] [Thread-1 (]: On model.vg_casestudy.reporting__high_lvl_branch_transactions_kpis: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.reporting__high_lvl_branch_transactions_kpis"} */
alter view "casestudy"."reporting"."reporting__high_lvl_branch_transactions_kpis__dbt_tmp" rename to "reporting__high_lvl_branch_transactions_kpis"
[0m13:10:24.794810 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:10:24.811389 [debug] [Thread-1 (]: On model.vg_casestudy.reporting__high_lvl_branch_transactions_kpis: COMMIT
[0m13:10:24.811841 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.reporting__high_lvl_branch_transactions_kpis"
[0m13:10:24.812170 [debug] [Thread-1 (]: On model.vg_casestudy.reporting__high_lvl_branch_transactions_kpis: COMMIT
[0m13:10:24.817664 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:10:24.823238 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.reporting__high_lvl_branch_transactions_kpis"
[0m13:10:24.823702 [debug] [Thread-1 (]: On model.vg_casestudy.reporting__high_lvl_branch_transactions_kpis: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.reporting__high_lvl_branch_transactions_kpis"} */
drop view if exists "casestudy"."reporting"."reporting__high_lvl_branch_transactions_kpis__dbt_backup" cascade
[0m13:10:24.828827 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:10:24.830354 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.reporting__high_lvl_branch_transactions_kpis (execute): 13:10:24.717797 => 13:10:24.830153
[0m13:10:24.830813 [debug] [Thread-1 (]: On model.vg_casestudy.reporting__high_lvl_branch_transactions_kpis: Close
[0m13:10:24.862224 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '09895738-ae5c-463a-867f-86a644b3b5c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1cafe6dc50>]}
[0m13:10:24.862990 [info ] [Thread-1 (]: 1 of 1 OK created sql view model reporting.reporting__high_lvl_branch_transactions_kpis  [[32mOK[0m in 0.16s]
[0m13:10:24.863589 [debug] [Thread-1 (]: Finished running node model.vg_casestudy.reporting__high_lvl_branch_transactions_kpis
[0m13:10:24.865686 [debug] [MainThread]: Using duckdb connection "master"
[0m13:10:24.866147 [debug] [MainThread]: On master: BEGIN
[0m13:10:24.866450 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:10:24.880642 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m13:10:24.881389 [debug] [MainThread]: On master: COMMIT
[0m13:10:24.881963 [debug] [MainThread]: Using duckdb connection "master"
[0m13:10:24.882402 [debug] [MainThread]: On master: COMMIT
[0m13:10:24.883436 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m13:10:24.883886 [debug] [MainThread]: On master: Close
[0m13:10:24.887038 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:10:24.887498 [debug] [MainThread]: Connection 'list_casestudy_raw' was properly closed.
[0m13:10:24.887817 [debug] [MainThread]: Connection 'model.vg_casestudy.reporting__high_lvl_branch_transactions_kpis' was properly closed.
[0m13:10:24.888231 [info ] [MainThread]: 
[0m13:10:24.888725 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.58 seconds (0.58s).
[0m13:10:24.889705 [debug] [MainThread]: Command end result
[0m13:10:24.912524 [info ] [MainThread]: 
[0m13:10:24.913064 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:10:24.913396 [info ] [MainThread]: 
[0m13:10:24.913719 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m13:10:24.914278 [debug] [MainThread]: Command `dbt run` succeeded at 13:10:24.914141 after 1.18 seconds
[0m13:10:24.914709 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1cb3f89f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1cb45a14d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1cb3f8dbd0>]}
[0m13:10:24.915127 [debug] [MainThread]: Flushing usage events
[0m14:00:06.831727 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52ca455650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52caa1dc10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52caa50550>]}


============================== 14:00:06.838515 | aebdc655-b867-4faf-b9ef-45d1b12a6d28 ==============================
[0m14:00:06.838515 [info ] [MainThread]: Running with dbt=1.6.18
[0m14:00:06.839355 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/workspaces/vg_case_study_tim/transformation', 'log_path': '/workspaces/vg_case_study_tim/transformation/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt debug', 'send_anonymous_usage_stats': 'True'}
[0m14:00:06.839945 [info ] [MainThread]: dbt version: 1.6.18
[0m14:00:06.840499 [info ] [MainThread]: python version: 3.11.6
[0m14:00:06.841085 [info ] [MainThread]: python path: /usr/local/bin/python
[0m14:00:06.841570 [info ] [MainThread]: os info: Linux-5.15.153.1-microsoft-standard-WSL2-x86_64-with-glibc2.31
[0m14:00:07.010193 [info ] [MainThread]: Using profiles dir at /workspaces/vg_case_study_tim/transformation
[0m14:00:07.010798 [info ] [MainThread]: Using profiles.yml file at /workspaces/vg_case_study_tim/transformation/profiles.yml
[0m14:00:07.011139 [info ] [MainThread]: Using dbt_project.yml file at /workspaces/vg_case_study_tim/transformation/dbt_project.yml
[0m14:00:07.012286 [info ] [MainThread]: adapter type: duckdb
[0m14:00:07.012668 [info ] [MainThread]: adapter version: 1.6.2
[0m14:00:07.049311 [info ] [MainThread]: Configuration:
[0m14:00:07.050209 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m14:00:07.050915 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m14:00:07.051565 [info ] [MainThread]: Required dependencies:
[0m14:00:07.052144 [debug] [MainThread]: Executing "git --help"
[0m14:00:07.054462 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m14:00:07.054993 [debug] [MainThread]: STDERR: "b''"
[0m14:00:07.055348 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m14:00:07.055731 [info ] [MainThread]: Connection:
[0m14:00:07.056163 [info ] [MainThread]:   database: casestudy
[0m14:00:07.056493 [info ] [MainThread]:   schema: main
[0m14:00:07.056814 [info ] [MainThread]:   path: casestudy.duckdb
[0m14:00:07.057227 [info ] [MainThread]:   config_options: None
[0m14:00:07.057615 [info ] [MainThread]:   extensions: ['icu']
[0m14:00:07.058001 [info ] [MainThread]:   settings: None
[0m14:00:07.058415 [info ] [MainThread]:   external_root: .
[0m14:00:07.058848 [info ] [MainThread]:   use_credential_provider: None
[0m14:00:07.059234 [info ] [MainThread]:   attach: None
[0m14:00:07.059526 [info ] [MainThread]:   filesystems: None
[0m14:00:07.059800 [info ] [MainThread]:   remote: None
[0m14:00:07.060081 [info ] [MainThread]:   plugins: None
[0m14:00:07.060340 [info ] [MainThread]:   disable_transactions: False
[0m14:00:07.060675 [info ] [MainThread]: Registered adapter: duckdb=1.6.2
[0m14:00:07.061321 [debug] [MainThread]: Acquiring new duckdb connection 'debug'
[0m14:00:07.061622 [debug] [MainThread]: Using duckdb connection "debug"
[0m14:00:07.061879 [debug] [MainThread]: On debug: select 1 as id
[0m14:00:07.062153 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:00:07.232270 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:00:07.233580 [debug] [MainThread]: On debug: Close
[0m14:00:07.236599 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m14:00:07.237117 [info ] [MainThread]: [32mAll checks passed![0m
[0m14:00:07.237660 [debug] [MainThread]: Command `dbt debug` succeeded at 14:00:07.237550 after 0.42 seconds
[0m14:00:07.238075 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m14:00:07.238467 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52ca8b7cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52ca58f1d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52ca442210>]}
[0m14:00:07.238922 [debug] [MainThread]: Flushing usage events
[0m14:15:36.782504 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5da4518910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5da5975710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5da49c5450>]}


============================== 14:15:36.788234 | dc0b8778-01b1-4d38-b875-ddd2c7c022e6 ==============================
[0m14:15:36.788234 [info ] [MainThread]: Running with dbt=1.6.18
[0m14:15:36.788966 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/workspaces/vg_case_study_tim/transformation/logs', 'profiles_dir': '/workspaces/vg_case_study_tim/transformation', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --select reporting__high_lvl_customer_kpis', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:15:37.005442 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dc0b8778-01b1-4d38-b875-ddd2c7c022e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5da5975990>]}
[0m14:15:37.020976 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'dc0b8778-01b1-4d38-b875-ddd2c7c022e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5da456f9d0>]}
[0m14:15:37.022839 [info ] [MainThread]: Registered adapter: duckdb=1.6.2
[0m14:15:37.052931 [debug] [MainThread]: checksum: 7b9fab86a08e9e96a48a825af743c566d95b877e068b8c6d0dbafbf714447189, vars: {}, profile: , target: , version: 1.6.18
[0m14:15:37.173060 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 0 files changed.
[0m14:15:37.173999 [debug] [MainThread]: Partial parsing: added file: vg_casestudy://models/reporting/reporting__high_lvl_customer_kpis.yml
[0m14:15:37.174408 [debug] [MainThread]: Partial parsing: added file: vg_casestudy://models/reporting/reporting__high_lvl_customer_kpis.sql
[0m14:15:37.308847 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.vg_casestudy.main
[0m14:15:37.318164 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dc0b8778-01b1-4d38-b875-ddd2c7c022e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5da456db90>]}
[0m14:15:37.359946 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dc0b8778-01b1-4d38-b875-ddd2c7c022e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5da4557ad0>]}
[0m14:15:37.360577 [info ] [MainThread]: Found 21 models, 1 analysis, 4 seeds, 114 tests, 5 sources, 0 exposures, 0 metrics, 632 macros, 0 groups, 0 semantic models
[0m14:15:37.361034 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dc0b8778-01b1-4d38-b875-ddd2c7c022e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5da4818950>]}
[0m14:15:37.364441 [info ] [MainThread]: 
[0m14:15:37.365326 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:15:37.366552 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_casestudy'
[0m14:15:37.380876 [debug] [ThreadPool]: Using duckdb connection "list_casestudy"
[0m14:15:37.381330 [debug] [ThreadPool]: On list_casestudy: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"casestudy"'
    
  
  
[0m14:15:37.381627 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:15:37.534103 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:15:37.535743 [debug] [ThreadPool]: On list_casestudy: Close
[0m14:15:37.541002 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy, now create_casestudy_reporting)
[0m14:15:37.541790 [debug] [ThreadPool]: Creating schema "database: "casestudy"
schema: "reporting"
"
[0m14:15:37.547302 [debug] [ThreadPool]: Using duckdb connection "create_casestudy_reporting"
[0m14:15:37.547772 [debug] [ThreadPool]: On create_casestudy_reporting: BEGIN
[0m14:15:37.548076 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:15:37.561229 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:15:37.561651 [debug] [ThreadPool]: Using duckdb connection "create_casestudy_reporting"
[0m14:15:37.561942 [debug] [ThreadPool]: On create_casestudy_reporting: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "create_casestudy_reporting"} */
create schema if not exists "casestudy"."reporting"
[0m14:15:37.562671 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:15:37.563540 [debug] [ThreadPool]: On create_casestudy_reporting: COMMIT
[0m14:15:37.563820 [debug] [ThreadPool]: Using duckdb connection "create_casestudy_reporting"
[0m14:15:37.564102 [debug] [ThreadPool]: On create_casestudy_reporting: COMMIT
[0m14:15:37.564585 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:15:37.564854 [debug] [ThreadPool]: On create_casestudy_reporting: Close
[0m14:15:37.570269 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_casestudy_reporting, now list_casestudy_intermediate)
[0m14:15:37.576298 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_intermediate"
[0m14:15:37.576726 [debug] [ThreadPool]: On list_casestudy_intermediate: BEGIN
[0m14:15:37.577035 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:15:37.589567 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:15:37.590094 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_intermediate"
[0m14:15:37.590419 [debug] [ThreadPool]: On list_casestudy_intermediate: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_intermediate"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'intermediate'
    and table_catalog = 'casestudy'
  
[0m14:15:37.607269 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:15:37.609541 [debug] [ThreadPool]: On list_casestudy_intermediate: ROLLBACK
[0m14:15:37.611231 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_intermediate'
[0m14:15:37.611543 [debug] [ThreadPool]: On list_casestudy_intermediate: Close
[0m14:15:37.614913 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy_intermediate, now list_casestudy_raw)
[0m14:15:37.617194 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_raw"
[0m14:15:37.619175 [debug] [ThreadPool]: On list_casestudy_raw: BEGIN
[0m14:15:37.619621 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:15:37.632457 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:15:37.632851 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_raw"
[0m14:15:37.633175 [debug] [ThreadPool]: On list_casestudy_raw: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_raw"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'raw'
    and table_catalog = 'casestudy'
  
[0m14:15:37.644122 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:15:37.645603 [debug] [ThreadPool]: On list_casestudy_raw: ROLLBACK
[0m14:15:37.646096 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_raw'
[0m14:15:37.646370 [debug] [ThreadPool]: On list_casestudy_raw: Close
[0m14:15:37.649927 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy_raw, now list_casestudy_staging)
[0m14:15:37.652464 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_staging"
[0m14:15:37.654642 [debug] [ThreadPool]: On list_casestudy_staging: BEGIN
[0m14:15:37.655011 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:15:37.666804 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:15:37.667223 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_staging"
[0m14:15:37.667537 [debug] [ThreadPool]: On list_casestudy_staging: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_staging"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'staging'
    and table_catalog = 'casestudy'
  
[0m14:15:37.678598 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:15:37.680111 [debug] [ThreadPool]: On list_casestudy_staging: ROLLBACK
[0m14:15:37.680588 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_staging'
[0m14:15:37.680868 [debug] [ThreadPool]: On list_casestudy_staging: Close
[0m14:15:37.684450 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy_staging, now list_casestudy_marts)
[0m14:15:37.687810 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_marts"
[0m14:15:37.689665 [debug] [ThreadPool]: On list_casestudy_marts: BEGIN
[0m14:15:37.690142 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:15:37.703143 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:15:37.703574 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_marts"
[0m14:15:37.703925 [debug] [ThreadPool]: On list_casestudy_marts: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_marts"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'marts'
    and table_catalog = 'casestudy'
  
[0m14:15:37.713321 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:15:37.714645 [debug] [ThreadPool]: On list_casestudy_marts: ROLLBACK
[0m14:15:37.715195 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_marts'
[0m14:15:37.715545 [debug] [ThreadPool]: On list_casestudy_marts: Close
[0m14:15:37.719013 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy_marts, now list_casestudy_reporting)
[0m14:15:37.722433 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_reporting"
[0m14:15:37.722864 [debug] [ThreadPool]: On list_casestudy_reporting: BEGIN
[0m14:15:37.723145 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:15:37.735363 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:15:37.736026 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_reporting"
[0m14:15:37.736502 [debug] [ThreadPool]: On list_casestudy_reporting: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_reporting"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'reporting'
    and table_catalog = 'casestudy'
  
[0m14:15:37.746456 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:15:37.748209 [debug] [ThreadPool]: On list_casestudy_reporting: ROLLBACK
[0m14:15:37.748720 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_reporting'
[0m14:15:37.749014 [debug] [ThreadPool]: On list_casestudy_reporting: Close
[0m14:15:37.752879 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dc0b8778-01b1-4d38-b875-ddd2c7c022e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5da05ff310>]}
[0m14:15:37.753460 [debug] [MainThread]: Using duckdb connection "master"
[0m14:15:37.753766 [debug] [MainThread]: On master: BEGIN
[0m14:15:37.754054 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:15:37.769051 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:15:37.769530 [debug] [MainThread]: On master: COMMIT
[0m14:15:37.769971 [debug] [MainThread]: Using duckdb connection "master"
[0m14:15:37.770322 [debug] [MainThread]: On master: COMMIT
[0m14:15:37.771145 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:15:37.771764 [debug] [MainThread]: On master: Close
[0m14:15:37.774798 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:15:37.775256 [info ] [MainThread]: 
[0m14:15:37.779650 [debug] [Thread-1 (]: Began running node model.vg_casestudy.reporting__high_lvl_customer_kpis
[0m14:15:37.780298 [info ] [Thread-1 (]: 1 of 1 START sql view model reporting.reporting__high_lvl_customer_kpis ........ [RUN]
[0m14:15:37.781119 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.vg_casestudy.reporting__high_lvl_customer_kpis'
[0m14:15:37.781462 [debug] [Thread-1 (]: Began compiling node model.vg_casestudy.reporting__high_lvl_customer_kpis
[0m14:15:37.790261 [debug] [Thread-1 (]: Writing injected SQL for node "model.vg_casestudy.reporting__high_lvl_customer_kpis"
[0m14:15:37.792912 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.reporting__high_lvl_customer_kpis (compile): 14:15:37.781695 => 14:15:37.792037
[0m14:15:37.793571 [debug] [Thread-1 (]: Began executing node model.vg_casestudy.reporting__high_lvl_customer_kpis
[0m14:15:37.829904 [debug] [Thread-1 (]: Writing runtime sql for node "model.vg_casestudy.reporting__high_lvl_customer_kpis"
[0m14:15:37.830712 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.reporting__high_lvl_customer_kpis"
[0m14:15:37.831081 [debug] [Thread-1 (]: On model.vg_casestudy.reporting__high_lvl_customer_kpis: BEGIN
[0m14:15:37.831369 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:15:37.848863 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:15:37.849442 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.reporting__high_lvl_customer_kpis"
[0m14:15:37.850037 [debug] [Thread-1 (]: On model.vg_casestudy.reporting__high_lvl_customer_kpis: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.reporting__high_lvl_customer_kpis"} */

  
  create view "casestudy"."reporting"."reporting__high_lvl_customer_kpis__dbt_tmp" as (
    with customers as (
    select *
    from "casestudy"."marts"."marts__customers_enriched"
),

aggregated as (
    select
        branch_id,
        branch_name,
        count(distinct customer_id) as unique_customers,
        count(distinct case when has_account is false then customer_id) as customers_without_account,

        count(case when account_type = 'current' then customer_id) as customers_with_account_type_current,
        count(case when account_type = 'savings' then customer_id) as customers_with_account_type_savings,
        count(case when account_type = 'current' then account_id end)::float / nullif(count(account_id), 0) as share_current_accounts,
        count(case when account_type = 'savings' then account_id end)::float / nullif(count(account_id), 0) as share_savings_accounts,

        avg(age) as avg_customer_age,
        min(age) as min_customer_age,
        max(age) as max_customer_age,
        count(distinct case when age < 30 then customer_id end) as customers_under_30,
        count(distinct case when age between 30 and 50 then customer_id end) as customers_30_to_50,
        count(distinct case when age > 50 then customer_id end) as customers_over_50,
        count(distinct case when age < 30 then customer_id end)::float / count(distinct customer_id) as share_customers_under_30,
        count(distinct case when age between 30 and 50 then customer_id end)::float / count(distinct customer_id) as share_customers_30_to_50,
        count(distinct case when age > 50 then customer_id end)::float / count(distinct customer_id) as share_customers_over_50,

    from customers
    group by branch_id, branch_name
)

select *
from aggregated
  );

[0m14:15:37.862687 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.reporting__high_lvl_customer_kpis (execute): 14:15:37.793853 => 14:15:37.862387
[0m14:15:37.863156 [debug] [Thread-1 (]: On model.vg_casestudy.reporting__high_lvl_customer_kpis: ROLLBACK
[0m14:15:37.871793 [debug] [Thread-1 (]: Failed to rollback 'model.vg_casestudy.reporting__high_lvl_customer_kpis'
[0m14:15:37.872300 [debug] [Thread-1 (]: On model.vg_casestudy.reporting__high_lvl_customer_kpis: Close
[0m14:15:37.876592 [debug] [Thread-1 (]: Runtime Error in model reporting__high_lvl_customer_kpis (models/reporting/reporting__high_lvl_customer_kpis.sql)
  Parser Error: syntax error at or near ")"
[0m14:15:37.877187 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dc0b8778-01b1-4d38-b875-ddd2c7c022e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d9ef4e310>]}
[0m14:15:37.877814 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model reporting.reporting__high_lvl_customer_kpis  [[31mERROR[0m in 0.10s]
[0m14:15:37.878481 [debug] [Thread-1 (]: Finished running node model.vg_casestudy.reporting__high_lvl_customer_kpis
[0m14:15:37.880698 [debug] [MainThread]: Using duckdb connection "master"
[0m14:15:37.881047 [debug] [MainThread]: On master: BEGIN
[0m14:15:37.881319 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:15:37.899542 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:15:37.900014 [debug] [MainThread]: On master: COMMIT
[0m14:15:37.900302 [debug] [MainThread]: Using duckdb connection "master"
[0m14:15:37.900556 [debug] [MainThread]: On master: COMMIT
[0m14:15:37.901042 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:15:37.901380 [debug] [MainThread]: On master: Close
[0m14:15:37.905095 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:15:37.905570 [debug] [MainThread]: Connection 'list_casestudy_reporting' was properly closed.
[0m14:15:37.905899 [debug] [MainThread]: Connection 'model.vg_casestudy.reporting__high_lvl_customer_kpis' was properly closed.
[0m14:15:37.906357 [info ] [MainThread]: 
[0m14:15:37.906831 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.54 seconds (0.54s).
[0m14:15:37.907753 [debug] [MainThread]: Command end result
[0m14:15:37.934759 [info ] [MainThread]: 
[0m14:15:37.935415 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:15:37.936132 [info ] [MainThread]: 
[0m14:15:37.936889 [error] [MainThread]:   Runtime Error in model reporting__high_lvl_customer_kpis (models/reporting/reporting__high_lvl_customer_kpis.sql)
  Parser Error: syntax error at or near ")"
[0m14:15:37.937701 [info ] [MainThread]: 
[0m14:15:37.938448 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m14:15:37.939144 [debug] [MainThread]: Command `dbt run` failed at 14:15:37.939029 after 1.17 seconds
[0m14:15:37.939560 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5da4c71390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5da487e490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5da0334c10>]}
[0m14:15:37.940028 [debug] [MainThread]: Flushing usage events
[0m14:15:52.820066 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f347b029cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f347c8565d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f347c8affd0>]}


============================== 14:15:52.823987 | 3ff9a185-d82b-4bc2-bb01-9bd7a2c62fb9 ==============================
[0m14:15:52.823987 [info ] [MainThread]: Running with dbt=1.6.18
[0m14:15:52.824551 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/workspaces/vg_case_study_tim/transformation', 'debug': 'False', 'version_check': 'True', 'log_path': '/workspaces/vg_case_study_tim/transformation/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --select reporting__high_lvl_customer_kpis', 'send_anonymous_usage_stats': 'True'}
[0m14:15:52.945323 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3ff9a185-d82b-4bc2-bb01-9bd7a2c62fb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f347b336a90>]}
[0m14:15:52.961202 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3ff9a185-d82b-4bc2-bb01-9bd7a2c62fb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3476d74c90>]}
[0m14:15:52.962062 [info ] [MainThread]: Registered adapter: duckdb=1.6.2
[0m14:15:52.991243 [debug] [MainThread]: checksum: 7b9fab86a08e9e96a48a825af743c566d95b877e068b8c6d0dbafbf714447189, vars: {}, profile: , target: , version: 1.6.18
[0m14:15:53.048370 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:15:53.049334 [debug] [MainThread]: Partial parsing: updated file: vg_casestudy://models/reporting/reporting__high_lvl_customer_kpis.sql
[0m14:15:53.177541 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.vg_casestudy.main
[0m14:15:53.186702 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3ff9a185-d82b-4bc2-bb01-9bd7a2c62fb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f347ad50890>]}
[0m14:15:53.228651 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3ff9a185-d82b-4bc2-bb01-9bd7a2c62fb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3476c51c90>]}
[0m14:15:53.229495 [info ] [MainThread]: Found 21 models, 1 analysis, 4 seeds, 114 tests, 5 sources, 0 exposures, 0 metrics, 632 macros, 0 groups, 0 semantic models
[0m14:15:53.229988 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3ff9a185-d82b-4bc2-bb01-9bd7a2c62fb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3476d01ad0>]}
[0m14:15:53.232686 [info ] [MainThread]: 
[0m14:15:53.233463 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:15:53.234702 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_casestudy'
[0m14:15:53.248432 [debug] [ThreadPool]: Using duckdb connection "list_casestudy"
[0m14:15:53.248905 [debug] [ThreadPool]: On list_casestudy: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"casestudy"'
    
  
  
[0m14:15:53.249338 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:15:53.269445 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:15:53.271909 [debug] [ThreadPool]: On list_casestudy: Close
[0m14:15:53.278224 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy, now create_casestudy_reporting)
[0m14:15:53.279059 [debug] [ThreadPool]: Creating schema "database: "casestudy"
schema: "reporting"
"
[0m14:15:53.283072 [debug] [ThreadPool]: Using duckdb connection "create_casestudy_reporting"
[0m14:15:53.283388 [debug] [ThreadPool]: On create_casestudy_reporting: BEGIN
[0m14:15:53.283674 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:15:53.297731 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:15:53.298201 [debug] [ThreadPool]: Using duckdb connection "create_casestudy_reporting"
[0m14:15:53.298507 [debug] [ThreadPool]: On create_casestudy_reporting: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "create_casestudy_reporting"} */
create schema if not exists "casestudy"."reporting"
[0m14:15:53.299269 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:15:53.300268 [debug] [ThreadPool]: On create_casestudy_reporting: COMMIT
[0m14:15:53.300577 [debug] [ThreadPool]: Using duckdb connection "create_casestudy_reporting"
[0m14:15:53.300842 [debug] [ThreadPool]: On create_casestudy_reporting: COMMIT
[0m14:15:53.301452 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:15:53.301788 [debug] [ThreadPool]: On create_casestudy_reporting: Close
[0m14:15:53.307753 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_casestudy_reporting, now list_casestudy_reporting)
[0m14:15:53.313112 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_reporting"
[0m14:15:53.313759 [debug] [ThreadPool]: On list_casestudy_reporting: BEGIN
[0m14:15:53.314059 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:15:53.326349 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:15:53.326795 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_reporting"
[0m14:15:53.327109 [debug] [ThreadPool]: On list_casestudy_reporting: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_reporting"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'reporting'
    and table_catalog = 'casestudy'
  
[0m14:15:53.336707 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:15:53.338711 [debug] [ThreadPool]: On list_casestudy_reporting: ROLLBACK
[0m14:15:53.339737 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_reporting'
[0m14:15:53.340101 [debug] [ThreadPool]: On list_casestudy_reporting: Close
[0m14:15:53.343644 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy_reporting, now list_casestudy_raw)
[0m14:15:53.345911 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_raw"
[0m14:15:53.346277 [debug] [ThreadPool]: On list_casestudy_raw: BEGIN
[0m14:15:53.346590 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:15:53.359528 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:15:53.359947 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_raw"
[0m14:15:53.360230 [debug] [ThreadPool]: On list_casestudy_raw: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_raw"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'raw'
    and table_catalog = 'casestudy'
  
[0m14:15:53.368708 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:15:53.370578 [debug] [ThreadPool]: On list_casestudy_raw: ROLLBACK
[0m14:15:53.371199 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_raw'
[0m14:15:53.371552 [debug] [ThreadPool]: On list_casestudy_raw: Close
[0m14:15:53.374882 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy_raw, now list_casestudy_intermediate)
[0m14:15:53.378048 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_intermediate"
[0m14:15:53.378481 [debug] [ThreadPool]: On list_casestudy_intermediate: BEGIN
[0m14:15:53.378800 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:15:53.394325 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:15:53.394748 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_intermediate"
[0m14:15:53.395075 [debug] [ThreadPool]: On list_casestudy_intermediate: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_intermediate"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'intermediate'
    and table_catalog = 'casestudy'
  
[0m14:15:53.404311 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:15:53.405880 [debug] [ThreadPool]: On list_casestudy_intermediate: ROLLBACK
[0m14:15:53.406421 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_intermediate'
[0m14:15:53.406722 [debug] [ThreadPool]: On list_casestudy_intermediate: Close
[0m14:15:53.410109 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy_intermediate, now list_casestudy_staging)
[0m14:15:53.412353 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_staging"
[0m14:15:53.412686 [debug] [ThreadPool]: On list_casestudy_staging: BEGIN
[0m14:15:53.413019 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:15:53.425076 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:15:53.425499 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_staging"
[0m14:15:53.425809 [debug] [ThreadPool]: On list_casestudy_staging: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_staging"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'staging'
    and table_catalog = 'casestudy'
  
[0m14:15:53.434992 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:15:53.436484 [debug] [ThreadPool]: On list_casestudy_staging: ROLLBACK
[0m14:15:53.437045 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_staging'
[0m14:15:53.437371 [debug] [ThreadPool]: On list_casestudy_staging: Close
[0m14:15:53.441050 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy_staging, now list_casestudy_marts)
[0m14:15:53.443343 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_marts"
[0m14:15:53.443724 [debug] [ThreadPool]: On list_casestudy_marts: BEGIN
[0m14:15:53.444036 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:15:53.457653 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:15:53.458094 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_marts"
[0m14:15:53.458750 [debug] [ThreadPool]: On list_casestudy_marts: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_marts"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'marts'
    and table_catalog = 'casestudy'
  
[0m14:15:53.472085 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:15:53.474324 [debug] [ThreadPool]: On list_casestudy_marts: ROLLBACK
[0m14:15:53.475492 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_marts'
[0m14:15:53.476141 [debug] [ThreadPool]: On list_casestudy_marts: Close
[0m14:15:53.481034 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3ff9a185-d82b-4bc2-bb01-9bd7a2c62fb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3476a2c310>]}
[0m14:15:53.481661 [debug] [MainThread]: Using duckdb connection "master"
[0m14:15:53.482029 [debug] [MainThread]: On master: BEGIN
[0m14:15:53.482331 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:15:53.501027 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:15:53.501475 [debug] [MainThread]: On master: COMMIT
[0m14:15:53.501771 [debug] [MainThread]: Using duckdb connection "master"
[0m14:15:53.502036 [debug] [MainThread]: On master: COMMIT
[0m14:15:53.502774 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:15:53.503383 [debug] [MainThread]: On master: Close
[0m14:15:53.507029 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:15:53.507718 [info ] [MainThread]: 
[0m14:15:53.510681 [debug] [Thread-1 (]: Began running node model.vg_casestudy.reporting__high_lvl_customer_kpis
[0m14:15:53.511493 [info ] [Thread-1 (]: 1 of 1 START sql view model reporting.reporting__high_lvl_customer_kpis ........ [RUN]
[0m14:15:53.512748 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.vg_casestudy.reporting__high_lvl_customer_kpis'
[0m14:15:53.513434 [debug] [Thread-1 (]: Began compiling node model.vg_casestudy.reporting__high_lvl_customer_kpis
[0m14:15:53.527903 [debug] [Thread-1 (]: Writing injected SQL for node "model.vg_casestudy.reporting__high_lvl_customer_kpis"
[0m14:15:53.529330 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.reporting__high_lvl_customer_kpis (compile): 14:15:53.513801 => 14:15:53.528833
[0m14:15:53.529851 [debug] [Thread-1 (]: Began executing node model.vg_casestudy.reporting__high_lvl_customer_kpis
[0m14:15:53.574457 [debug] [Thread-1 (]: Writing runtime sql for node "model.vg_casestudy.reporting__high_lvl_customer_kpis"
[0m14:15:53.575767 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.reporting__high_lvl_customer_kpis"
[0m14:15:53.576475 [debug] [Thread-1 (]: On model.vg_casestudy.reporting__high_lvl_customer_kpis: BEGIN
[0m14:15:53.577050 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:15:53.608099 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:15:53.608863 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.reporting__high_lvl_customer_kpis"
[0m14:15:53.609353 [debug] [Thread-1 (]: On model.vg_casestudy.reporting__high_lvl_customer_kpis: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.reporting__high_lvl_customer_kpis"} */

  
  create view "casestudy"."reporting"."reporting__high_lvl_customer_kpis__dbt_tmp" as (
    with customers as (
    select *
    from "casestudy"."marts"."marts__customers_enriched"
),

aggregated as (
    select
        branch_id,
        branch_name,
        count(distinct customer_id) as unique_customers,
        count(distinct case when has_account is false then customer_id) as customers_without_account,

        count(case when account_type = 'current' then customer_id) as customers_with_account_type_current,
        count(case when account_type = 'savings' then customer_id) as customers_with_account_type_savings,
        count(case when account_type = 'current' then account_id end)::float / nullif(count(account_id), 0) as share_current_accounts,
        count(case when account_type = 'savings' then account_id end)::float / nullif(count(account_id), 0) as share_savings_accounts,

        avg(age) as avg_customer_age,
        min(age) as min_customer_age,
        max(age) as max_customer_age,
        count(distinct case when age < 30 then customer_id end) as customers_under_30,
        count(distinct case when age between 30 and 50 then customer_id end) as customers_30_to_50,
        count(distinct case when age > 50 then customer_id end) as customers_over_50,
        count(distinct case when age < 30 then customer_id end)::float / count(distinct customer_id) as share_customers_under_30,
        count(distinct case when age between 30 and 50 then customer_id end)::float / count(distinct customer_id) as share_customers_30_to_50,
        count(distinct case when age > 50 then customer_id end)::float / count(distinct customer_id) as share_customers_over_50

    from customers
    group by branch_id, branch_name
)

select *
from aggregated
  );

[0m14:15:53.610361 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.reporting__high_lvl_customer_kpis (execute): 14:15:53.530210 => 14:15:53.610168
[0m14:15:53.610727 [debug] [Thread-1 (]: On model.vg_casestudy.reporting__high_lvl_customer_kpis: ROLLBACK
[0m14:15:53.613709 [debug] [Thread-1 (]: Failed to rollback 'model.vg_casestudy.reporting__high_lvl_customer_kpis'
[0m14:15:53.614063 [debug] [Thread-1 (]: On model.vg_casestudy.reporting__high_lvl_customer_kpis: Close
[0m14:15:53.618136 [debug] [Thread-1 (]: Runtime Error in model reporting__high_lvl_customer_kpis (models/reporting/reporting__high_lvl_customer_kpis.sql)
  Parser Error: syntax error at or near ")"
[0m14:15:53.618711 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3ff9a185-d82b-4bc2-bb01-9bd7a2c62fb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3475a5e750>]}
[0m14:15:53.619437 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model reporting.reporting__high_lvl_customer_kpis  [[31mERROR[0m in 0.11s]
[0m14:15:53.620096 [debug] [Thread-1 (]: Finished running node model.vg_casestudy.reporting__high_lvl_customer_kpis
[0m14:15:53.622557 [debug] [MainThread]: Using duckdb connection "master"
[0m14:15:53.623023 [debug] [MainThread]: On master: BEGIN
[0m14:15:53.623330 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:15:53.639226 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:15:53.639738 [debug] [MainThread]: On master: COMMIT
[0m14:15:53.640103 [debug] [MainThread]: Using duckdb connection "master"
[0m14:15:53.640424 [debug] [MainThread]: On master: COMMIT
[0m14:15:53.641071 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:15:53.641385 [debug] [MainThread]: On master: Close
[0m14:15:53.644214 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:15:53.644587 [debug] [MainThread]: Connection 'list_casestudy_marts' was properly closed.
[0m14:15:53.644889 [debug] [MainThread]: Connection 'model.vg_casestudy.reporting__high_lvl_customer_kpis' was properly closed.
[0m14:15:53.645199 [info ] [MainThread]: 
[0m14:15:53.645576 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.41 seconds (0.41s).
[0m14:15:53.646173 [debug] [MainThread]: Command end result
[0m14:15:53.672458 [info ] [MainThread]: 
[0m14:15:53.673240 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:15:53.675273 [info ] [MainThread]: 
[0m14:15:53.676558 [error] [MainThread]:   Runtime Error in model reporting__high_lvl_customer_kpis (models/reporting/reporting__high_lvl_customer_kpis.sql)
  Parser Error: syntax error at or near ")"
[0m14:15:53.677803 [info ] [MainThread]: 
[0m14:15:53.678283 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m14:15:53.678860 [debug] [MainThread]: Command `dbt run` failed at 14:15:53.678746 after 0.87 seconds
[0m14:15:53.679285 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3476bb89d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f347afff310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f347aef1890>]}
[0m14:15:53.679640 [debug] [MainThread]: Flushing usage events
[0m14:19:14.089222 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc5fb537810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc5fbaebe10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc5fbb56c50>]}


============================== 14:19:14.094777 | f24e8e09-6f18-489d-9aac-584082ce216e ==============================
[0m14:19:14.094777 [info ] [MainThread]: Running with dbt=1.6.18
[0m14:19:14.095387 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/workspaces/vg_case_study_tim/transformation', 'log_path': '/workspaces/vg_case_study_tim/transformation/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select reporting__high_lvl_customer_kpis', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:19:14.309514 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f24e8e09-6f18-489d-9aac-584082ce216e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc5fbb47d50>]}
[0m14:19:14.323895 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f24e8e09-6f18-489d-9aac-584082ce216e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc5fbb1c890>]}
[0m14:19:14.325668 [info ] [MainThread]: Registered adapter: duckdb=1.6.2
[0m14:19:14.356221 [debug] [MainThread]: checksum: 7b9fab86a08e9e96a48a825af743c566d95b877e068b8c6d0dbafbf714447189, vars: {}, profile: , target: , version: 1.6.18
[0m14:19:14.473969 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:19:14.474879 [debug] [MainThread]: Partial parsing: updated file: vg_casestudy://models/reporting/reporting__high_lvl_customer_kpis.sql
[0m14:19:14.602378 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.vg_casestudy.main
[0m14:19:14.612364 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f24e8e09-6f18-489d-9aac-584082ce216e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc5f7500450>]}
[0m14:19:14.653118 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f24e8e09-6f18-489d-9aac-584082ce216e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc5f734c710>]}
[0m14:19:14.653709 [info ] [MainThread]: Found 21 models, 1 analysis, 4 seeds, 114 tests, 5 sources, 0 exposures, 0 metrics, 632 macros, 0 groups, 0 semantic models
[0m14:19:14.654122 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f24e8e09-6f18-489d-9aac-584082ce216e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc5fb55af10>]}
[0m14:19:14.656914 [info ] [MainThread]: 
[0m14:19:14.657745 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:19:14.658893 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_casestudy'
[0m14:19:14.672522 [debug] [ThreadPool]: Using duckdb connection "list_casestudy"
[0m14:19:14.672944 [debug] [ThreadPool]: On list_casestudy: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"casestudy"'
    
  
  
[0m14:19:14.673286 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:19:14.812181 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:19:14.813858 [debug] [ThreadPool]: On list_casestudy: Close
[0m14:19:14.817904 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy, now create_casestudy_reporting)
[0m14:19:14.818993 [debug] [ThreadPool]: Creating schema "database: "casestudy"
schema: "reporting"
"
[0m14:19:14.824089 [debug] [ThreadPool]: Using duckdb connection "create_casestudy_reporting"
[0m14:19:14.824491 [debug] [ThreadPool]: On create_casestudy_reporting: BEGIN
[0m14:19:14.824774 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:19:14.837948 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:19:14.838392 [debug] [ThreadPool]: Using duckdb connection "create_casestudy_reporting"
[0m14:19:14.838686 [debug] [ThreadPool]: On create_casestudy_reporting: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "create_casestudy_reporting"} */
create schema if not exists "casestudy"."reporting"
[0m14:19:14.839682 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:19:14.840682 [debug] [ThreadPool]: On create_casestudy_reporting: COMMIT
[0m14:19:14.840971 [debug] [ThreadPool]: Using duckdb connection "create_casestudy_reporting"
[0m14:19:14.841223 [debug] [ThreadPool]: On create_casestudy_reporting: COMMIT
[0m14:19:14.841771 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:19:14.842059 [debug] [ThreadPool]: On create_casestudy_reporting: Close
[0m14:19:14.847329 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_casestudy_reporting, now list_casestudy_raw)
[0m14:19:14.853698 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_raw"
[0m14:19:14.854199 [debug] [ThreadPool]: On list_casestudy_raw: BEGIN
[0m14:19:14.854658 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:19:14.866843 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:19:14.867287 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_raw"
[0m14:19:14.867620 [debug] [ThreadPool]: On list_casestudy_raw: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_raw"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'raw'
    and table_catalog = 'casestudy'
  
[0m14:19:14.883323 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:19:14.885839 [debug] [ThreadPool]: On list_casestudy_raw: ROLLBACK
[0m14:19:14.887537 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_raw'
[0m14:19:14.887911 [debug] [ThreadPool]: On list_casestudy_raw: Close
[0m14:19:14.892665 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy_raw, now list_casestudy_reporting)
[0m14:19:14.894871 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_reporting"
[0m14:19:14.895223 [debug] [ThreadPool]: On list_casestudy_reporting: BEGIN
[0m14:19:14.895563 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:19:14.908521 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:19:14.908947 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_reporting"
[0m14:19:14.909244 [debug] [ThreadPool]: On list_casestudy_reporting: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_reporting"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'reporting'
    and table_catalog = 'casestudy'
  
[0m14:19:14.920237 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:19:14.921641 [debug] [ThreadPool]: On list_casestudy_reporting: ROLLBACK
[0m14:19:14.922170 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_reporting'
[0m14:19:14.922509 [debug] [ThreadPool]: On list_casestudy_reporting: Close
[0m14:19:14.925758 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy_reporting, now list_casestudy_marts)
[0m14:19:14.929557 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_marts"
[0m14:19:14.930067 [debug] [ThreadPool]: On list_casestudy_marts: BEGIN
[0m14:19:14.930523 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:19:14.942924 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:19:14.943357 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_marts"
[0m14:19:14.943670 [debug] [ThreadPool]: On list_casestudy_marts: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_marts"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'marts'
    and table_catalog = 'casestudy'
  
[0m14:19:14.953582 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:19:14.954924 [debug] [ThreadPool]: On list_casestudy_marts: ROLLBACK
[0m14:19:14.955422 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_marts'
[0m14:19:14.955680 [debug] [ThreadPool]: On list_casestudy_marts: Close
[0m14:19:14.958689 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy_marts, now list_casestudy_intermediate)
[0m14:19:14.961952 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_intermediate"
[0m14:19:14.962462 [debug] [ThreadPool]: On list_casestudy_intermediate: BEGIN
[0m14:19:14.962854 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:19:14.980076 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:19:14.980608 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_intermediate"
[0m14:19:14.980918 [debug] [ThreadPool]: On list_casestudy_intermediate: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_intermediate"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'intermediate'
    and table_catalog = 'casestudy'
  
[0m14:19:14.990137 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:19:14.991798 [debug] [ThreadPool]: On list_casestudy_intermediate: ROLLBACK
[0m14:19:14.992400 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_intermediate'
[0m14:19:14.992670 [debug] [ThreadPool]: On list_casestudy_intermediate: Close
[0m14:19:14.995900 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy_intermediate, now list_casestudy_staging)
[0m14:19:14.998750 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_staging"
[0m14:19:15.000666 [debug] [ThreadPool]: On list_casestudy_staging: BEGIN
[0m14:19:15.001000 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:19:15.012615 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:19:15.013073 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_staging"
[0m14:19:15.013399 [debug] [ThreadPool]: On list_casestudy_staging: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_staging"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'staging'
    and table_catalog = 'casestudy'
  
[0m14:19:15.022717 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:19:15.024473 [debug] [ThreadPool]: On list_casestudy_staging: ROLLBACK
[0m14:19:15.025012 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_staging'
[0m14:19:15.025330 [debug] [ThreadPool]: On list_casestudy_staging: Close
[0m14:19:15.029317 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f24e8e09-6f18-489d-9aac-584082ce216e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc5f7099f10>]}
[0m14:19:15.029795 [debug] [MainThread]: Using duckdb connection "master"
[0m14:19:15.030157 [debug] [MainThread]: On master: BEGIN
[0m14:19:15.030482 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:19:15.046260 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:19:15.046706 [debug] [MainThread]: On master: COMMIT
[0m14:19:15.047104 [debug] [MainThread]: Using duckdb connection "master"
[0m14:19:15.047537 [debug] [MainThread]: On master: COMMIT
[0m14:19:15.048381 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:19:15.048885 [debug] [MainThread]: On master: Close
[0m14:19:15.051829 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:19:15.052340 [info ] [MainThread]: 
[0m14:19:15.058159 [debug] [Thread-1 (]: Began running node model.vg_casestudy.reporting__high_lvl_customer_kpis
[0m14:19:15.058724 [info ] [Thread-1 (]: 1 of 1 START sql view model reporting.reporting__high_lvl_customer_kpis ........ [RUN]
[0m14:19:15.059586 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.vg_casestudy.reporting__high_lvl_customer_kpis'
[0m14:19:15.060013 [debug] [Thread-1 (]: Began compiling node model.vg_casestudy.reporting__high_lvl_customer_kpis
[0m14:19:15.071200 [debug] [Thread-1 (]: Writing injected SQL for node "model.vg_casestudy.reporting__high_lvl_customer_kpis"
[0m14:19:15.072562 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.reporting__high_lvl_customer_kpis (compile): 14:19:15.060306 => 14:19:15.072125
[0m14:19:15.073112 [debug] [Thread-1 (]: Began executing node model.vg_casestudy.reporting__high_lvl_customer_kpis
[0m14:19:15.108169 [debug] [Thread-1 (]: Writing runtime sql for node "model.vg_casestudy.reporting__high_lvl_customer_kpis"
[0m14:19:15.108866 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.reporting__high_lvl_customer_kpis"
[0m14:19:15.109265 [debug] [Thread-1 (]: On model.vg_casestudy.reporting__high_lvl_customer_kpis: BEGIN
[0m14:19:15.109565 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:19:15.125933 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:19:15.126414 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.reporting__high_lvl_customer_kpis"
[0m14:19:15.126806 [debug] [Thread-1 (]: On model.vg_casestudy.reporting__high_lvl_customer_kpis: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.reporting__high_lvl_customer_kpis"} */

  
  create view "casestudy"."reporting"."reporting__high_lvl_customer_kpis__dbt_tmp" as (
    with customers as (
    select *
    from "casestudy"."marts"."marts__customers_enriched"
),

aggregated as (
    select
        branch_id,
        branch_name,
        count(distinct customer_id) as unique_customers,
        count(distinct case when has_account is false then customer_id end) as customers_without_account,

        count(case when account_type = 'current' then customer_id end) as customers_with_account_type_current,
        count(case when account_type = 'savings' then customer_id end) as customers_with_account_type_savings,
        count(case when account_type = 'current' then account_id end)::float / nullif(count(account_id), 0) as share_current_accounts,
        count(case when account_type = 'savings' then account_id end)::float / nullif(count(account_id), 0) as share_savings_accounts,

        avg(age) as avg_customer_age,
        min(age) as min_customer_age,
        max(age) as max_customer_age,
        count(distinct case when age < 30 then customer_id end) as customers_under_30,
        count(distinct case when age between 30 and 50 then customer_id end) as customers_30_to_50,
        count(distinct case when age > 50 then customer_id end) as customers_over_50,
        count(distinct case when age < 30 then customer_id end)::float / count(distinct customer_id) as share_customers_under_30,
        count(distinct case when age between 30 and 50 then customer_id end)::float / count(distinct customer_id) as share_customers_30_to_50,
        count(distinct case when age > 50 then customer_id end)::float / count(distinct customer_id) as share_customers_over_50

    from customers
    group by branch_id, branch_name
)

select *
from aggregated
  );

[0m14:19:15.130774 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:19:15.138161 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.reporting__high_lvl_customer_kpis"
[0m14:19:15.138637 [debug] [Thread-1 (]: On model.vg_casestudy.reporting__high_lvl_customer_kpis: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.reporting__high_lvl_customer_kpis"} */
alter view "casestudy"."reporting"."reporting__high_lvl_customer_kpis__dbt_tmp" rename to "reporting__high_lvl_customer_kpis"
[0m14:19:15.139752 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:19:15.153935 [debug] [Thread-1 (]: On model.vg_casestudy.reporting__high_lvl_customer_kpis: COMMIT
[0m14:19:15.154427 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.reporting__high_lvl_customer_kpis"
[0m14:19:15.154815 [debug] [Thread-1 (]: On model.vg_casestudy.reporting__high_lvl_customer_kpis: COMMIT
[0m14:19:15.160376 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:19:15.166016 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.reporting__high_lvl_customer_kpis"
[0m14:19:15.166501 [debug] [Thread-1 (]: On model.vg_casestudy.reporting__high_lvl_customer_kpis: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.reporting__high_lvl_customer_kpis"} */
drop view if exists "casestudy"."reporting"."reporting__high_lvl_customer_kpis__dbt_backup" cascade
[0m14:19:15.167355 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:19:15.168782 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.reporting__high_lvl_customer_kpis (execute): 14:19:15.073474 => 14:19:15.168631
[0m14:19:15.169143 [debug] [Thread-1 (]: On model.vg_casestudy.reporting__high_lvl_customer_kpis: Close
[0m14:19:15.198688 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f24e8e09-6f18-489d-9aac-584082ce216e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc5f7321950>]}
[0m14:19:15.199483 [info ] [Thread-1 (]: 1 of 1 OK created sql view model reporting.reporting__high_lvl_customer_kpis ... [[32mOK[0m in 0.14s]
[0m14:19:15.200184 [debug] [Thread-1 (]: Finished running node model.vg_casestudy.reporting__high_lvl_customer_kpis
[0m14:19:15.202236 [debug] [MainThread]: Using duckdb connection "master"
[0m14:19:15.202611 [debug] [MainThread]: On master: BEGIN
[0m14:19:15.202890 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:19:15.218217 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:19:15.218935 [debug] [MainThread]: On master: COMMIT
[0m14:19:15.219543 [debug] [MainThread]: Using duckdb connection "master"
[0m14:19:15.219900 [debug] [MainThread]: On master: COMMIT
[0m14:19:15.220971 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:19:15.221499 [debug] [MainThread]: On master: Close
[0m14:19:15.224700 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:19:15.225113 [debug] [MainThread]: Connection 'list_casestudy_staging' was properly closed.
[0m14:19:15.225394 [debug] [MainThread]: Connection 'model.vg_casestudy.reporting__high_lvl_customer_kpis' was properly closed.
[0m14:19:15.225730 [info ] [MainThread]: 
[0m14:19:15.226083 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.57 seconds (0.57s).
[0m14:19:15.226674 [debug] [MainThread]: Command end result
[0m14:19:15.250217 [info ] [MainThread]: 
[0m14:19:15.250743 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:19:15.251162 [info ] [MainThread]: 
[0m14:19:15.251558 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m14:19:15.252109 [debug] [MainThread]: Command `dbt run` succeeded at 14:19:15.252007 after 1.18 seconds
[0m14:19:15.252480 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc600060bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6001d6250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6001d7390>]}
[0m14:19:15.253012 [debug] [MainThread]: Flushing usage events
[0m14:19:29.791756 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f15a9923a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f15a9930250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f15a993ccd0>]}


============================== 14:19:29.794178 | f55f7a26-08e6-4a1e-8b83-8753cc2a70dd ==============================
[0m14:19:29.794178 [info ] [MainThread]: Running with dbt=1.6.18
[0m14:19:29.794769 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/workspaces/vg_case_study_tim/transformation/logs', 'debug': 'False', 'profiles_dir': '/workspaces/vg_case_study_tim/transformation', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt test --select reporting__high_lvl_customer_kpis', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:19:29.897761 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f55f7a26-08e6-4a1e-8b83-8753cc2a70dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f15a9c576d0>]}
[0m14:19:29.913308 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f55f7a26-08e6-4a1e-8b83-8753cc2a70dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f15a9923910>]}
[0m14:19:29.914098 [info ] [MainThread]: Registered adapter: duckdb=1.6.2
[0m14:19:29.946541 [debug] [MainThread]: checksum: 7b9fab86a08e9e96a48a825af743c566d95b877e068b8c6d0dbafbf714447189, vars: {}, profile: , target: , version: 1.6.18
[0m14:19:30.005989 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:19:30.006475 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:19:30.008153 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.vg_casestudy.main
[0m14:19:30.019890 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f55f7a26-08e6-4a1e-8b83-8753cc2a70dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f15a96517d0>]}
[0m14:19:30.117792 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f55f7a26-08e6-4a1e-8b83-8753cc2a70dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f15a96a29d0>]}
[0m14:19:30.118385 [info ] [MainThread]: Found 21 models, 1 analysis, 4 seeds, 114 tests, 5 sources, 0 exposures, 0 metrics, 632 macros, 0 groups, 0 semantic models
[0m14:19:30.118817 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f55f7a26-08e6-4a1e-8b83-8753cc2a70dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f15a9d02a90>]}
[0m14:19:30.121722 [info ] [MainThread]: 
[0m14:19:30.122148 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m14:19:30.122619 [debug] [MainThread]: Command end result
[0m14:19:30.146555 [debug] [MainThread]: Command `dbt test` succeeded at 14:19:30.146387 after 0.36 seconds
[0m14:19:30.146980 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f15a97f5f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f15a97f4a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f15a9671cd0>]}
[0m14:19:30.147383 [debug] [MainThread]: Flushing usage events
[0m14:56:38.605749 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff7c8850510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff7c83fc950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff7c83ebb10>]}


============================== 14:56:38.611420 | b6c7861e-fc33-48cc-aba9-0250ef9dbc8d ==============================
[0m14:56:38.611420 [info ] [MainThread]: Running with dbt=1.6.18
[0m14:56:38.612066 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/workspaces/vg_case_study_tim/transformation', 'log_path': '/workspaces/vg_case_study_tim/transformation/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --select reporting__high_lvl_customer_kpis', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:56:38.789341 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b6c7861e-fc33-48cc-aba9-0250ef9dbc8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff7c80a7bd0>]}
[0m14:56:38.804400 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b6c7861e-fc33-48cc-aba9-0250ef9dbc8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff7c86f7d90>]}
[0m14:56:38.806218 [info ] [MainThread]: Registered adapter: duckdb=1.6.2
[0m14:56:38.837535 [debug] [MainThread]: checksum: 7b9fab86a08e9e96a48a825af743c566d95b877e068b8c6d0dbafbf714447189, vars: {}, profile: , target: , version: 1.6.18
[0m14:56:38.954112 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 6 files changed.
[0m14:56:38.955159 [debug] [MainThread]: Partial parsing: updated file: vg_casestudy://models/reporting/reporting__high_lvl_customer_kpis.yml
[0m14:56:38.955758 [debug] [MainThread]: Partial parsing: updated file: vg_casestudy://models/reporting/reporting__high_lvl_branch_transactions_kpis.yml
[0m14:56:38.956303 [debug] [MainThread]: Partial parsing: updated file: vg_casestudy://models/reporting/reporting__branch_transaction_currenncy_kpis.yml
[0m14:56:38.956624 [debug] [MainThread]: Partial parsing: updated file: vg_casestudy://models/reporting/reporting__high_lvl_branch_transactions_kpis.sql
[0m14:56:38.956921 [debug] [MainThread]: Partial parsing: updated file: vg_casestudy://models/reporting/reporting__branch_transaction_currenncy_kpis.sql
[0m14:56:38.957229 [debug] [MainThread]: Partial parsing: updated file: vg_casestudy://models/reporting/reporting__high_lvl_customer_kpis.sql
[0m14:56:39.106092 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.vg_casestudy.main
[0m14:56:39.116583 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b6c7861e-fc33-48cc-aba9-0250ef9dbc8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff7c3f18e10>]}
[0m14:56:39.161945 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b6c7861e-fc33-48cc-aba9-0250ef9dbc8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff7c9236710>]}
[0m14:56:39.162576 [info ] [MainThread]: Found 21 models, 1 analysis, 4 seeds, 114 tests, 5 sources, 0 exposures, 0 metrics, 632 macros, 0 groups, 0 semantic models
[0m14:56:39.163045 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b6c7861e-fc33-48cc-aba9-0250ef9dbc8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff7c8282590>]}
[0m14:56:39.166332 [info ] [MainThread]: 
[0m14:56:39.167196 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:56:39.168420 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_casestudy'
[0m14:56:39.184670 [debug] [ThreadPool]: Using duckdb connection "list_casestudy"
[0m14:56:39.185152 [debug] [ThreadPool]: On list_casestudy: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"casestudy"'
    
  
  
[0m14:56:39.185492 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:56:39.332137 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:56:39.334032 [debug] [ThreadPool]: On list_casestudy: Close
[0m14:56:39.339116 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy, now create_casestudy_reporting)
[0m14:56:39.339913 [debug] [ThreadPool]: Creating schema "database: "casestudy"
schema: "reporting"
"
[0m14:56:39.344788 [debug] [ThreadPool]: Using duckdb connection "create_casestudy_reporting"
[0m14:56:39.345237 [debug] [ThreadPool]: On create_casestudy_reporting: BEGIN
[0m14:56:39.345598 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:56:39.357710 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:56:39.358433 [debug] [ThreadPool]: Using duckdb connection "create_casestudy_reporting"
[0m14:56:39.358904 [debug] [ThreadPool]: On create_casestudy_reporting: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "create_casestudy_reporting"} */
create schema if not exists "casestudy"."reporting"
[0m14:56:39.359779 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:56:39.361022 [debug] [ThreadPool]: On create_casestudy_reporting: COMMIT
[0m14:56:39.361478 [debug] [ThreadPool]: Using duckdb connection "create_casestudy_reporting"
[0m14:56:39.361869 [debug] [ThreadPool]: On create_casestudy_reporting: COMMIT
[0m14:56:39.362783 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:56:39.363179 [debug] [ThreadPool]: On create_casestudy_reporting: Close
[0m14:56:39.370294 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_casestudy_reporting, now list_casestudy_marts)
[0m14:56:39.375809 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_marts"
[0m14:56:39.376539 [debug] [ThreadPool]: On list_casestudy_marts: BEGIN
[0m14:56:39.376818 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:56:39.390028 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:56:39.390447 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_marts"
[0m14:56:39.390926 [debug] [ThreadPool]: On list_casestudy_marts: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_marts"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'marts'
    and table_catalog = 'casestudy'
  
[0m14:56:39.408788 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:56:39.411191 [debug] [ThreadPool]: On list_casestudy_marts: ROLLBACK
[0m14:56:39.412697 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_marts'
[0m14:56:39.413177 [debug] [ThreadPool]: On list_casestudy_marts: Close
[0m14:56:39.416266 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy_marts, now list_casestudy_raw)
[0m14:56:39.419060 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_raw"
[0m14:56:39.419368 [debug] [ThreadPool]: On list_casestudy_raw: BEGIN
[0m14:56:39.419651 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:56:39.432903 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:56:39.433320 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_raw"
[0m14:56:39.433639 [debug] [ThreadPool]: On list_casestudy_raw: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_raw"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'raw'
    and table_catalog = 'casestudy'
  
[0m14:56:39.442758 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:56:39.444351 [debug] [ThreadPool]: On list_casestudy_raw: ROLLBACK
[0m14:56:39.445019 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_raw'
[0m14:56:39.445372 [debug] [ThreadPool]: On list_casestudy_raw: Close
[0m14:56:39.448667 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy_raw, now list_casestudy_intermediate)
[0m14:56:39.452072 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_intermediate"
[0m14:56:39.452396 [debug] [ThreadPool]: On list_casestudy_intermediate: BEGIN
[0m14:56:39.452666 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:56:39.464795 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:56:39.465279 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_intermediate"
[0m14:56:39.465573 [debug] [ThreadPool]: On list_casestudy_intermediate: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_intermediate"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'intermediate'
    and table_catalog = 'casestudy'
  
[0m14:56:39.474356 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:56:39.476122 [debug] [ThreadPool]: On list_casestudy_intermediate: ROLLBACK
[0m14:56:39.476684 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_intermediate'
[0m14:56:39.476986 [debug] [ThreadPool]: On list_casestudy_intermediate: Close
[0m14:56:39.480291 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy_intermediate, now list_casestudy_staging)
[0m14:56:39.482546 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_staging"
[0m14:56:39.482896 [debug] [ThreadPool]: On list_casestudy_staging: BEGIN
[0m14:56:39.483203 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:56:39.496361 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:56:39.496793 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_staging"
[0m14:56:39.497119 [debug] [ThreadPool]: On list_casestudy_staging: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_staging"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'staging'
    and table_catalog = 'casestudy'
  
[0m14:56:39.506265 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:56:39.507984 [debug] [ThreadPool]: On list_casestudy_staging: ROLLBACK
[0m14:56:39.508847 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_staging'
[0m14:56:39.509319 [debug] [ThreadPool]: On list_casestudy_staging: Close
[0m14:56:39.512901 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy_staging, now list_casestudy_reporting)
[0m14:56:39.515082 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_reporting"
[0m14:56:39.515433 [debug] [ThreadPool]: On list_casestudy_reporting: BEGIN
[0m14:56:39.516632 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:56:39.528872 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:56:39.529286 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_reporting"
[0m14:56:39.529602 [debug] [ThreadPool]: On list_casestudy_reporting: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_reporting"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'reporting'
    and table_catalog = 'casestudy'
  
[0m14:56:39.538615 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:56:39.540527 [debug] [ThreadPool]: On list_casestudy_reporting: ROLLBACK
[0m14:56:39.541255 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_reporting'
[0m14:56:39.541595 [debug] [ThreadPool]: On list_casestudy_reporting: Close
[0m14:56:39.545801 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b6c7861e-fc33-48cc-aba9-0250ef9dbc8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff7c8875bd0>]}
[0m14:56:39.546334 [debug] [MainThread]: Using duckdb connection "master"
[0m14:56:39.546648 [debug] [MainThread]: On master: BEGIN
[0m14:56:39.546936 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:56:39.561329 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:56:39.561789 [debug] [MainThread]: On master: COMMIT
[0m14:56:39.562100 [debug] [MainThread]: Using duckdb connection "master"
[0m14:56:39.562370 [debug] [MainThread]: On master: COMMIT
[0m14:56:39.562909 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:56:39.563238 [debug] [MainThread]: On master: Close
[0m14:56:39.566029 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:56:39.566493 [info ] [MainThread]: 
[0m14:56:39.572384 [debug] [Thread-1 (]: Began running node model.vg_casestudy.reporting__high_lvl_customer_kpis
[0m14:56:39.572943 [info ] [Thread-1 (]: 1 of 1 START sql view model reporting.reporting__high_lvl_customer_kpis ........ [RUN]
[0m14:56:39.573739 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.vg_casestudy.reporting__high_lvl_customer_kpis'
[0m14:56:39.574246 [debug] [Thread-1 (]: Began compiling node model.vg_casestudy.reporting__high_lvl_customer_kpis
[0m14:56:39.585600 [debug] [Thread-1 (]: Writing injected SQL for node "model.vg_casestudy.reporting__high_lvl_customer_kpis"
[0m14:56:39.587204 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.reporting__high_lvl_customer_kpis (compile): 14:56:39.574611 => 14:56:39.586665
[0m14:56:39.587971 [debug] [Thread-1 (]: Began executing node model.vg_casestudy.reporting__high_lvl_customer_kpis
[0m14:56:39.625187 [debug] [Thread-1 (]: Writing runtime sql for node "model.vg_casestudy.reporting__high_lvl_customer_kpis"
[0m14:56:39.626505 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.reporting__high_lvl_customer_kpis"
[0m14:56:39.627147 [debug] [Thread-1 (]: On model.vg_casestudy.reporting__high_lvl_customer_kpis: BEGIN
[0m14:56:39.627534 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:56:39.643874 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:56:39.644625 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.reporting__high_lvl_customer_kpis"
[0m14:56:39.645221 [debug] [Thread-1 (]: On model.vg_casestudy.reporting__high_lvl_customer_kpis: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.reporting__high_lvl_customer_kpis"} */

  
  create view "casestudy"."reporting"."reporting__high_lvl_customer_kpis__dbt_tmp" as (
    with customers as (
    select *
    from "casestudy"."marts"."marts__customers_enriched"
),

aggregated as (
    select
        branch_id,
        branch_name,
        count(distinct customer_id) as unique_customers,
        count(distinct case when has_account is false then customer_id end) as customers_without_account,

        count(case when account_type = 'current' then customer_id end) as customers_with_account_type_current,
        count(case when account_type = 'savings' then customer_id end) as customers_with_account_type_savings,
        count(case when account_type = 'current' then account_id end)::float / nullif(count(account_id), 0) as share_current_accounts,
        count(case when account_type = 'savings' then account_id end)::float / nullif(count(account_id), 0) as share_savings_accounts,

        avg(age) as avg_customer_age,
        min(age) as min_customer_age,
        max(age) as max_customer_age,
        count(distinct case when age < 30 then customer_id end) as customers_under_30,
        count(distinct case when age between 30 and 50 then customer_id end) as customers_30_to_50,
        count(distinct case when age > 50 then customer_id end) as customers_over_50,
        count(distinct case when age < 30 then customer_id end)::float / count(distinct customer_id) as share_customers_under_30,
        count(distinct case when age between 30 and 50 then customer_id end)::float / count(distinct customer_id) as share_customers_30_to_50,
        count(distinct case when age > 50 then customer_id end)::float / count(distinct customer_id) as share_customers_over_50,
        avg(case when account_opening_date is not null then date_diff('day', account_opening_date, current_date)::float / 365  as avg_account_age_years,
        avg(case when account_opening_date is not null then account_opening_date) as avg_account_opening_date


    from customers
    group by branch_id, branch_name
)

select *
from aggregated
  );

[0m14:56:39.656893 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.reporting__high_lvl_customer_kpis (execute): 14:56:39.588503 => 14:56:39.656611
[0m14:56:39.657444 [debug] [Thread-1 (]: On model.vg_casestudy.reporting__high_lvl_customer_kpis: ROLLBACK
[0m14:56:39.665781 [debug] [Thread-1 (]: Failed to rollback 'model.vg_casestudy.reporting__high_lvl_customer_kpis'
[0m14:56:39.666261 [debug] [Thread-1 (]: On model.vg_casestudy.reporting__high_lvl_customer_kpis: Close
[0m14:56:39.670538 [debug] [Thread-1 (]: Runtime Error in model reporting__high_lvl_customer_kpis (models/reporting/reporting__high_lvl_customer_kpis.sql)
  Parser Error: syntax error at or near "as"
[0m14:56:39.671087 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b6c7861e-fc33-48cc-aba9-0250ef9dbc8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff7c80c3810>]}
[0m14:56:39.671675 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model reporting.reporting__high_lvl_customer_kpis  [[31mERROR[0m in 0.10s]
[0m14:56:39.672243 [debug] [Thread-1 (]: Finished running node model.vg_casestudy.reporting__high_lvl_customer_kpis
[0m14:56:39.674719 [debug] [MainThread]: Using duckdb connection "master"
[0m14:56:39.675309 [debug] [MainThread]: On master: BEGIN
[0m14:56:39.675686 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:56:39.691060 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:56:39.691690 [debug] [MainThread]: On master: COMMIT
[0m14:56:39.692086 [debug] [MainThread]: Using duckdb connection "master"
[0m14:56:39.692508 [debug] [MainThread]: On master: COMMIT
[0m14:56:39.693594 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:56:39.694189 [debug] [MainThread]: On master: Close
[0m14:56:39.697750 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:56:39.698252 [debug] [MainThread]: Connection 'list_casestudy_reporting' was properly closed.
[0m14:56:39.698572 [debug] [MainThread]: Connection 'model.vg_casestudy.reporting__high_lvl_customer_kpis' was properly closed.
[0m14:56:39.699046 [info ] [MainThread]: 
[0m14:56:39.699750 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.53 seconds (0.53s).
[0m14:56:39.700685 [debug] [MainThread]: Command end result
[0m14:56:39.726754 [info ] [MainThread]: 
[0m14:56:39.727510 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:56:39.728116 [info ] [MainThread]: 
[0m14:56:39.728664 [error] [MainThread]:   Runtime Error in model reporting__high_lvl_customer_kpis (models/reporting/reporting__high_lvl_customer_kpis.sql)
  Parser Error: syntax error at or near "as"
[0m14:56:39.729202 [info ] [MainThread]: 
[0m14:56:39.729716 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m14:56:39.730414 [debug] [MainThread]: Command `dbt run` failed at 14:56:39.730271 after 1.13 seconds
[0m14:56:39.730947 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff7c8266dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff7c8266310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff7c8867750>]}
[0m14:56:39.731495 [debug] [MainThread]: Flushing usage events
[0m14:57:02.466909 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f272ba0f810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f272d4c4a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f272ba0fb10>]}


============================== 14:57:02.469535 | 0b3bfd03-6766-4925-b7a0-ea621ac5f178 ==============================
[0m14:57:02.469535 [info ] [MainThread]: Running with dbt=1.6.18
[0m14:57:02.470149 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/workspaces/vg_case_study_tim/transformation/logs', 'profiles_dir': '/workspaces/vg_case_study_tim/transformation', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --select reporting__high_lvl_customer_kpis', 'send_anonymous_usage_stats': 'True'}
[0m14:57:02.574820 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0b3bfd03-6766-4925-b7a0-ea621ac5f178', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f272b6d3d10>]}
[0m14:57:02.590249 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0b3bfd03-6766-4925-b7a0-ea621ac5f178', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f272b6f14d0>]}
[0m14:57:02.591070 [info ] [MainThread]: Registered adapter: duckdb=1.6.2
[0m14:57:02.620663 [debug] [MainThread]: checksum: 7b9fab86a08e9e96a48a825af743c566d95b877e068b8c6d0dbafbf714447189, vars: {}, profile: , target: , version: 1.6.18
[0m14:57:02.673420 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:57:02.674371 [debug] [MainThread]: Partial parsing: updated file: vg_casestudy://models/reporting/reporting__high_lvl_customer_kpis.sql
[0m14:57:02.801578 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.vg_casestudy.main
[0m14:57:02.810156 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0b3bfd03-6766-4925-b7a0-ea621ac5f178', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2727545ad0>]}
[0m14:57:02.847937 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0b3bfd03-6766-4925-b7a0-ea621ac5f178', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f27273b7610>]}
[0m14:57:02.848543 [info ] [MainThread]: Found 21 models, 1 analysis, 4 seeds, 114 tests, 5 sources, 0 exposures, 0 metrics, 632 macros, 0 groups, 0 semantic models
[0m14:57:02.848958 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0b3bfd03-6766-4925-b7a0-ea621ac5f178', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f272b6b7fd0>]}
[0m14:57:02.851692 [info ] [MainThread]: 
[0m14:57:02.852509 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:57:02.853677 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_casestudy'
[0m14:57:02.868765 [debug] [ThreadPool]: Using duckdb connection "list_casestudy"
[0m14:57:02.869327 [debug] [ThreadPool]: On list_casestudy: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"casestudy"'
    
  
  
[0m14:57:02.869694 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:57:02.886814 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:57:02.888220 [debug] [ThreadPool]: On list_casestudy: Close
[0m14:57:02.894889 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy, now create_casestudy_reporting)
[0m14:57:02.896242 [debug] [ThreadPool]: Creating schema "database: "casestudy"
schema: "reporting"
"
[0m14:57:02.901080 [debug] [ThreadPool]: Using duckdb connection "create_casestudy_reporting"
[0m14:57:02.901484 [debug] [ThreadPool]: On create_casestudy_reporting: BEGIN
[0m14:57:02.901779 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:57:02.915703 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:57:02.916168 [debug] [ThreadPool]: Using duckdb connection "create_casestudy_reporting"
[0m14:57:02.916469 [debug] [ThreadPool]: On create_casestudy_reporting: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "create_casestudy_reporting"} */
create schema if not exists "casestudy"."reporting"
[0m14:57:02.917156 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:57:02.918179 [debug] [ThreadPool]: On create_casestudy_reporting: COMMIT
[0m14:57:02.918494 [debug] [ThreadPool]: Using duckdb connection "create_casestudy_reporting"
[0m14:57:02.918767 [debug] [ThreadPool]: On create_casestudy_reporting: COMMIT
[0m14:57:02.919413 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:57:02.919754 [debug] [ThreadPool]: On create_casestudy_reporting: Close
[0m14:57:02.925766 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_casestudy_reporting, now list_casestudy_reporting)
[0m14:57:02.932066 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_reporting"
[0m14:57:02.932492 [debug] [ThreadPool]: On list_casestudy_reporting: BEGIN
[0m14:57:02.932794 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:57:02.944701 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:57:02.945178 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_reporting"
[0m14:57:02.945512 [debug] [ThreadPool]: On list_casestudy_reporting: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_reporting"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'reporting'
    and table_catalog = 'casestudy'
  
[0m14:57:02.955855 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:57:02.957472 [debug] [ThreadPool]: On list_casestudy_reporting: ROLLBACK
[0m14:57:02.958197 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_reporting'
[0m14:57:02.958477 [debug] [ThreadPool]: On list_casestudy_reporting: Close
[0m14:57:02.962157 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy_reporting, now list_casestudy_intermediate)
[0m14:57:02.966166 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_intermediate"
[0m14:57:02.966615 [debug] [ThreadPool]: On list_casestudy_intermediate: BEGIN
[0m14:57:02.966954 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:57:02.979885 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:57:02.980341 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_intermediate"
[0m14:57:02.980663 [debug] [ThreadPool]: On list_casestudy_intermediate: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_intermediate"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'intermediate'
    and table_catalog = 'casestudy'
  
[0m14:57:02.990437 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:57:02.991902 [debug] [ThreadPool]: On list_casestudy_intermediate: ROLLBACK
[0m14:57:02.992486 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_intermediate'
[0m14:57:02.992806 [debug] [ThreadPool]: On list_casestudy_intermediate: Close
[0m14:57:02.997167 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy_intermediate, now list_casestudy_raw)
[0m14:57:03.001467 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_raw"
[0m14:57:03.001874 [debug] [ThreadPool]: On list_casestudy_raw: BEGIN
[0m14:57:03.002174 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:57:03.015004 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:57:03.015411 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_raw"
[0m14:57:03.015832 [debug] [ThreadPool]: On list_casestudy_raw: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_raw"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'raw'
    and table_catalog = 'casestudy'
  
[0m14:57:03.024720 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:57:03.026329 [debug] [ThreadPool]: On list_casestudy_raw: ROLLBACK
[0m14:57:03.026877 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_raw'
[0m14:57:03.027225 [debug] [ThreadPool]: On list_casestudy_raw: Close
[0m14:57:03.030555 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy_raw, now list_casestudy_staging)
[0m14:57:03.033605 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_staging"
[0m14:57:03.035738 [debug] [ThreadPool]: On list_casestudy_staging: BEGIN
[0m14:57:03.036140 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:57:03.048653 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:57:03.049100 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_staging"
[0m14:57:03.049426 [debug] [ThreadPool]: On list_casestudy_staging: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_staging"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'staging'
    and table_catalog = 'casestudy'
  
[0m14:57:03.058062 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:57:03.059605 [debug] [ThreadPool]: On list_casestudy_staging: ROLLBACK
[0m14:57:03.060172 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_staging'
[0m14:57:03.060477 [debug] [ThreadPool]: On list_casestudy_staging: Close
[0m14:57:03.064261 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy_staging, now list_casestudy_marts)
[0m14:57:03.066613 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_marts"
[0m14:57:03.066998 [debug] [ThreadPool]: On list_casestudy_marts: BEGIN
[0m14:57:03.067384 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:57:03.080436 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:57:03.080892 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_marts"
[0m14:57:03.081222 [debug] [ThreadPool]: On list_casestudy_marts: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_marts"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'marts'
    and table_catalog = 'casestudy'
  
[0m14:57:03.090127 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:57:03.091420 [debug] [ThreadPool]: On list_casestudy_marts: ROLLBACK
[0m14:57:03.091880 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_marts'
[0m14:57:03.092274 [debug] [ThreadPool]: On list_casestudy_marts: Close
[0m14:57:03.097226 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0b3bfd03-6766-4925-b7a0-ea621ac5f178', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f272743a7d0>]}
[0m14:57:03.097867 [debug] [MainThread]: Using duckdb connection "master"
[0m14:57:03.098151 [debug] [MainThread]: On master: BEGIN
[0m14:57:03.098420 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:57:03.118704 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:57:03.119172 [debug] [MainThread]: On master: COMMIT
[0m14:57:03.119487 [debug] [MainThread]: Using duckdb connection "master"
[0m14:57:03.119768 [debug] [MainThread]: On master: COMMIT
[0m14:57:03.120374 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:57:03.120709 [debug] [MainThread]: On master: Close
[0m14:57:03.123549 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:57:03.124161 [info ] [MainThread]: 
[0m14:57:03.127079 [debug] [Thread-1 (]: Began running node model.vg_casestudy.reporting__high_lvl_customer_kpis
[0m14:57:03.127793 [info ] [Thread-1 (]: 1 of 1 START sql view model reporting.reporting__high_lvl_customer_kpis ........ [RUN]
[0m14:57:03.128802 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.vg_casestudy.reporting__high_lvl_customer_kpis'
[0m14:57:03.129189 [debug] [Thread-1 (]: Began compiling node model.vg_casestudy.reporting__high_lvl_customer_kpis
[0m14:57:03.138071 [debug] [Thread-1 (]: Writing injected SQL for node "model.vg_casestudy.reporting__high_lvl_customer_kpis"
[0m14:57:03.139373 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.reporting__high_lvl_customer_kpis (compile): 14:57:03.129450 => 14:57:03.138660
[0m14:57:03.140498 [debug] [Thread-1 (]: Began executing node model.vg_casestudy.reporting__high_lvl_customer_kpis
[0m14:57:03.175440 [debug] [Thread-1 (]: Writing runtime sql for node "model.vg_casestudy.reporting__high_lvl_customer_kpis"
[0m14:57:03.176516 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.reporting__high_lvl_customer_kpis"
[0m14:57:03.177187 [debug] [Thread-1 (]: On model.vg_casestudy.reporting__high_lvl_customer_kpis: BEGIN
[0m14:57:03.177604 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:57:03.195556 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:57:03.196119 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.reporting__high_lvl_customer_kpis"
[0m14:57:03.196568 [debug] [Thread-1 (]: On model.vg_casestudy.reporting__high_lvl_customer_kpis: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.reporting__high_lvl_customer_kpis"} */

  
  create view "casestudy"."reporting"."reporting__high_lvl_customer_kpis__dbt_tmp" as (
    with customers as (
    select *
    from "casestudy"."marts"."marts__customers_enriched"
),

aggregated as (
    select
        branch_id,
        branch_name,
        count(distinct customer_id) as unique_customers,
        count(distinct case when has_account is false then customer_id end) as customers_without_account,

        count(case when account_type = 'current' then customer_id end) as customers_with_account_type_current,
        count(case when account_type = 'savings' then customer_id end) as customers_with_account_type_savings,
        count(case when account_type = 'current' then account_id end)::float / nullif(count(account_id), 0) as share_current_accounts,
        count(case when account_type = 'savings' then account_id end)::float / nullif(count(account_id), 0) as share_savings_accounts,

        avg(age) as avg_customer_age,
        min(age) as min_customer_age,
        max(age) as max_customer_age,
        count(distinct case when age < 30 then customer_id end) as customers_under_30,
        count(distinct case when age between 30 and 50 then customer_id end) as customers_30_to_50,
        count(distinct case when age > 50 then customer_id end) as customers_over_50,
        count(distinct case when age < 30 then customer_id end)::float / count(distinct customer_id) as share_customers_under_30,
        count(distinct case when age between 30 and 50 then customer_id end)::float / count(distinct customer_id) as share_customers_30_to_50,
        count(distinct case when age > 50 then customer_id end)::float / count(distinct customer_id) as share_customers_over_50,
        avg(case when account_opening_date is not null then date_diff('day', account_opening_date, current_date)::float / 365 end) as avg_account_age_years,
        avg(case when account_opening_date is not null then account_opening_date end) as avg_account_opening_date


    from customers
    group by branch_id, branch_name
)

select *
from aggregated
  );

[0m14:57:03.202570 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:57:03.209235 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.reporting__high_lvl_customer_kpis"
[0m14:57:03.209742 [debug] [Thread-1 (]: On model.vg_casestudy.reporting__high_lvl_customer_kpis: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.reporting__high_lvl_customer_kpis"} */
alter view "casestudy"."reporting"."reporting__high_lvl_customer_kpis" rename to "reporting__high_lvl_customer_kpis__dbt_backup"
[0m14:57:03.210967 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:57:03.214216 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.reporting__high_lvl_customer_kpis"
[0m14:57:03.214681 [debug] [Thread-1 (]: On model.vg_casestudy.reporting__high_lvl_customer_kpis: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.reporting__high_lvl_customer_kpis"} */
alter view "casestudy"."reporting"."reporting__high_lvl_customer_kpis__dbt_tmp" rename to "reporting__high_lvl_customer_kpis"
[0m14:57:03.215761 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:57:03.236085 [debug] [Thread-1 (]: On model.vg_casestudy.reporting__high_lvl_customer_kpis: COMMIT
[0m14:57:03.236578 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.reporting__high_lvl_customer_kpis"
[0m14:57:03.236907 [debug] [Thread-1 (]: On model.vg_casestudy.reporting__high_lvl_customer_kpis: COMMIT
[0m14:57:03.243508 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:57:03.249423 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.reporting__high_lvl_customer_kpis"
[0m14:57:03.249906 [debug] [Thread-1 (]: On model.vg_casestudy.reporting__high_lvl_customer_kpis: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.reporting__high_lvl_customer_kpis"} */
drop view if exists "casestudy"."reporting"."reporting__high_lvl_customer_kpis__dbt_backup" cascade
[0m14:57:03.253595 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:57:03.255106 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.reporting__high_lvl_customer_kpis (execute): 14:57:03.140964 => 14:57:03.254943
[0m14:57:03.255490 [debug] [Thread-1 (]: On model.vg_casestudy.reporting__high_lvl_customer_kpis: Close
[0m14:57:03.294750 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b3bfd03-6766-4925-b7a0-ea621ac5f178', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f27272e9950>]}
[0m14:57:03.295542 [info ] [Thread-1 (]: 1 of 1 OK created sql view model reporting.reporting__high_lvl_customer_kpis ... [[32mOK[0m in 0.17s]
[0m14:57:03.296166 [debug] [Thread-1 (]: Finished running node model.vg_casestudy.reporting__high_lvl_customer_kpis
[0m14:57:03.298383 [debug] [MainThread]: Using duckdb connection "master"
[0m14:57:03.298803 [debug] [MainThread]: On master: BEGIN
[0m14:57:03.299106 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:57:03.314258 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:57:03.315202 [debug] [MainThread]: On master: COMMIT
[0m14:57:03.316539 [debug] [MainThread]: Using duckdb connection "master"
[0m14:57:03.317240 [debug] [MainThread]: On master: COMMIT
[0m14:57:03.318793 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:57:03.319553 [debug] [MainThread]: On master: Close
[0m14:57:03.322681 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:57:03.323218 [debug] [MainThread]: Connection 'list_casestudy_marts' was properly closed.
[0m14:57:03.323558 [debug] [MainThread]: Connection 'model.vg_casestudy.reporting__high_lvl_customer_kpis' was properly closed.
[0m14:57:03.323943 [info ] [MainThread]: 
[0m14:57:03.324323 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.47 seconds (0.47s).
[0m14:57:03.324981 [debug] [MainThread]: Command end result
[0m14:57:03.350438 [info ] [MainThread]: 
[0m14:57:03.351214 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:57:03.351595 [info ] [MainThread]: 
[0m14:57:03.351995 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m14:57:03.352578 [debug] [MainThread]: Command `dbt run` succeeded at 14:57:03.352453 after 0.89 seconds
[0m14:57:03.352947 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f272b6abbd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f27302c2590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f272d1be990>]}
[0m14:57:03.353363 [debug] [MainThread]: Flushing usage events
[0m14:57:18.806538 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c62790490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c6263f2d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c6259bc50>]}


============================== 14:57:18.809150 | 910a96de-9f4d-4481-8945-9f69dda63dc1 ==============================
[0m14:57:18.809150 [info ] [MainThread]: Running with dbt=1.6.18
[0m14:57:18.809973 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/workspaces/vg_case_study_tim/transformation/logs', 'profiles_dir': '/workspaces/vg_case_study_tim/transformation', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt test --select reporting__high_lvl_customer_kpis', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:57:18.910742 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '910a96de-9f4d-4481-8945-9f69dda63dc1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c5eace4d0>]}
[0m14:57:18.924932 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '910a96de-9f4d-4481-8945-9f69dda63dc1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c627a6590>]}
[0m14:57:18.925717 [info ] [MainThread]: Registered adapter: duckdb=1.6.2
[0m14:57:18.952373 [debug] [MainThread]: checksum: 7b9fab86a08e9e96a48a825af743c566d95b877e068b8c6d0dbafbf714447189, vars: {}, profile: , target: , version: 1.6.18
[0m14:57:19.011597 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:57:19.012069 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:57:19.013906 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.vg_casestudy.main
[0m14:57:19.022547 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '910a96de-9f4d-4481-8945-9f69dda63dc1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c62367a90>]}
[0m14:57:19.108352 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '910a96de-9f4d-4481-8945-9f69dda63dc1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c5de38450>]}
[0m14:57:19.109030 [info ] [MainThread]: Found 21 models, 1 analysis, 4 seeds, 114 tests, 5 sources, 0 exposures, 0 metrics, 632 macros, 0 groups, 0 semantic models
[0m14:57:19.109526 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '910a96de-9f4d-4481-8945-9f69dda63dc1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c5dda2d50>]}
[0m14:57:19.112890 [info ] [MainThread]: 
[0m14:57:19.113632 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m14:57:19.114415 [debug] [MainThread]: Command end result
[0m14:57:19.138206 [debug] [MainThread]: Command `dbt test` succeeded at 14:57:19.138027 after 0.34 seconds
[0m14:57:19.138603 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c66e77450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c66e76310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c66e774d0>]}
[0m14:57:19.138991 [debug] [MainThread]: Flushing usage events
[0m15:08:27.475594 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0aec0fa810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0aec0c7790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0aebfa03d0>]}


============================== 15:08:27.480516 | a2710eac-6ded-4f38-bffd-d87bd46e4676 ==============================
[0m15:08:27.480516 [info ] [MainThread]: Running with dbt=1.6.18
[0m15:08:27.481242 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/workspaces/vg_case_study_tim/transformation/logs', 'version_check': 'True', 'profiles_dir': '/workspaces/vg_case_study_tim/transformation', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select reporting__high_lvl_customer_kpis', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:08:27.654701 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a2710eac-6ded-4f38-bffd-d87bd46e4676', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0ae7b66910>]}
[0m15:08:27.669320 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a2710eac-6ded-4f38-bffd-d87bd46e4676', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0aebb3c650>]}
[0m15:08:27.670896 [info ] [MainThread]: Registered adapter: duckdb=1.6.2
[0m15:08:27.704405 [debug] [MainThread]: checksum: 7b9fab86a08e9e96a48a825af743c566d95b877e068b8c6d0dbafbf714447189, vars: {}, profile: , target: , version: 1.6.18
[0m15:08:27.825297 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:08:27.826265 [debug] [MainThread]: Partial parsing: updated file: vg_casestudy://models/reporting/reporting__high_lvl_customer_kpis.sql
[0m15:08:27.958461 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.vg_casestudy.main
[0m15:08:27.969843 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a2710eac-6ded-4f38-bffd-d87bd46e4676', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0aec0c7090>]}
[0m15:08:28.010597 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a2710eac-6ded-4f38-bffd-d87bd46e4676', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0aebb28e10>]}
[0m15:08:28.011152 [info ] [MainThread]: Found 21 models, 1 analysis, 4 seeds, 114 tests, 5 sources, 0 exposures, 0 metrics, 632 macros, 0 groups, 0 semantic models
[0m15:08:28.011567 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a2710eac-6ded-4f38-bffd-d87bd46e4676', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0ae7b62e10>]}
[0m15:08:28.014917 [info ] [MainThread]: 
[0m15:08:28.015963 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m15:08:28.017555 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_casestudy'
[0m15:08:28.033850 [debug] [ThreadPool]: Using duckdb connection "list_casestudy"
[0m15:08:28.034365 [debug] [ThreadPool]: On list_casestudy: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"casestudy"'
    
  
  
[0m15:08:28.034721 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:08:28.182758 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:08:28.185291 [debug] [ThreadPool]: On list_casestudy: Close
[0m15:08:28.190524 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy, now create_casestudy_reporting)
[0m15:08:28.191316 [debug] [ThreadPool]: Creating schema "database: "casestudy"
schema: "reporting"
"
[0m15:08:28.196103 [debug] [ThreadPool]: Using duckdb connection "create_casestudy_reporting"
[0m15:08:28.196599 [debug] [ThreadPool]: On create_casestudy_reporting: BEGIN
[0m15:08:28.197471 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:08:28.212625 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:08:28.213072 [debug] [ThreadPool]: Using duckdb connection "create_casestudy_reporting"
[0m15:08:28.213611 [debug] [ThreadPool]: On create_casestudy_reporting: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "create_casestudy_reporting"} */
create schema if not exists "casestudy"."reporting"
[0m15:08:28.216021 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:08:28.217417 [debug] [ThreadPool]: On create_casestudy_reporting: COMMIT
[0m15:08:28.217874 [debug] [ThreadPool]: Using duckdb connection "create_casestudy_reporting"
[0m15:08:28.218239 [debug] [ThreadPool]: On create_casestudy_reporting: COMMIT
[0m15:08:28.218937 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:08:28.219336 [debug] [ThreadPool]: On create_casestudy_reporting: Close
[0m15:08:28.224316 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_casestudy_reporting, now list_casestudy_staging)
[0m15:08:28.231009 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_staging"
[0m15:08:28.231680 [debug] [ThreadPool]: On list_casestudy_staging: BEGIN
[0m15:08:28.232254 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:08:28.248752 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:08:28.249392 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_staging"
[0m15:08:28.249800 [debug] [ThreadPool]: On list_casestudy_staging: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_staging"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'staging'
    and table_catalog = 'casestudy'
  
[0m15:08:28.268428 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:08:28.270408 [debug] [ThreadPool]: On list_casestudy_staging: ROLLBACK
[0m15:08:28.271935 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_staging'
[0m15:08:28.272373 [debug] [ThreadPool]: On list_casestudy_staging: Close
[0m15:08:28.276098 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy_staging, now list_casestudy_raw)
[0m15:08:28.281225 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_raw"
[0m15:08:28.281908 [debug] [ThreadPool]: On list_casestudy_raw: BEGIN
[0m15:08:28.282672 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:08:28.297035 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:08:28.298070 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_raw"
[0m15:08:28.298485 [debug] [ThreadPool]: On list_casestudy_raw: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_raw"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'raw'
    and table_catalog = 'casestudy'
  
[0m15:08:28.311089 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:08:28.312733 [debug] [ThreadPool]: On list_casestudy_raw: ROLLBACK
[0m15:08:28.313570 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_raw'
[0m15:08:28.314371 [debug] [ThreadPool]: On list_casestudy_raw: Close
[0m15:08:28.318396 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy_raw, now list_casestudy_reporting)
[0m15:08:28.322985 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_reporting"
[0m15:08:28.323454 [debug] [ThreadPool]: On list_casestudy_reporting: BEGIN
[0m15:08:28.323829 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:08:28.338801 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:08:28.339239 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_reporting"
[0m15:08:28.339558 [debug] [ThreadPool]: On list_casestudy_reporting: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_reporting"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'reporting'
    and table_catalog = 'casestudy'
  
[0m15:08:28.352516 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:08:28.355169 [debug] [ThreadPool]: On list_casestudy_reporting: ROLLBACK
[0m15:08:28.356088 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_reporting'
[0m15:08:28.356727 [debug] [ThreadPool]: On list_casestudy_reporting: Close
[0m15:08:28.360603 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy_reporting, now list_casestudy_intermediate)
[0m15:08:28.363087 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_intermediate"
[0m15:08:28.364761 [debug] [ThreadPool]: On list_casestudy_intermediate: BEGIN
[0m15:08:28.365325 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:08:28.378473 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:08:28.378914 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_intermediate"
[0m15:08:28.379217 [debug] [ThreadPool]: On list_casestudy_intermediate: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_intermediate"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'intermediate'
    and table_catalog = 'casestudy'
  
[0m15:08:28.392383 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:08:28.401032 [debug] [ThreadPool]: On list_casestudy_intermediate: ROLLBACK
[0m15:08:28.402105 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_intermediate'
[0m15:08:28.402517 [debug] [ThreadPool]: On list_casestudy_intermediate: Close
[0m15:08:28.407087 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy_intermediate, now list_casestudy_marts)
[0m15:08:28.412081 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_marts"
[0m15:08:28.412691 [debug] [ThreadPool]: On list_casestudy_marts: BEGIN
[0m15:08:28.413081 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:08:28.432417 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:08:28.433090 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_marts"
[0m15:08:28.433568 [debug] [ThreadPool]: On list_casestudy_marts: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_marts"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'marts'
    and table_catalog = 'casestudy'
  
[0m15:08:28.444152 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:08:28.445698 [debug] [ThreadPool]: On list_casestudy_marts: ROLLBACK
[0m15:08:28.446270 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_marts'
[0m15:08:28.446613 [debug] [ThreadPool]: On list_casestudy_marts: Close
[0m15:08:28.451012 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a2710eac-6ded-4f38-bffd-d87bd46e4676', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0aebe30510>]}
[0m15:08:28.451893 [debug] [MainThread]: Using duckdb connection "master"
[0m15:08:28.452425 [debug] [MainThread]: On master: BEGIN
[0m15:08:28.452934 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:08:28.468417 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m15:08:28.468883 [debug] [MainThread]: On master: COMMIT
[0m15:08:28.469190 [debug] [MainThread]: Using duckdb connection "master"
[0m15:08:28.469456 [debug] [MainThread]: On master: COMMIT
[0m15:08:28.470066 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m15:08:28.470432 [debug] [MainThread]: On master: Close
[0m15:08:28.474048 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:08:28.474559 [info ] [MainThread]: 
[0m15:08:28.477920 [debug] [Thread-1 (]: Began running node model.vg_casestudy.reporting__high_lvl_customer_kpis
[0m15:08:28.478484 [info ] [Thread-1 (]: 1 of 1 START sql view model reporting.reporting__high_lvl_customer_kpis ........ [RUN]
[0m15:08:28.479306 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.vg_casestudy.reporting__high_lvl_customer_kpis'
[0m15:08:28.479682 [debug] [Thread-1 (]: Began compiling node model.vg_casestudy.reporting__high_lvl_customer_kpis
[0m15:08:28.490630 [debug] [Thread-1 (]: Writing injected SQL for node "model.vg_casestudy.reporting__high_lvl_customer_kpis"
[0m15:08:28.491608 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.reporting__high_lvl_customer_kpis (compile): 15:08:28.479920 => 15:08:28.491327
[0m15:08:28.492126 [debug] [Thread-1 (]: Began executing node model.vg_casestudy.reporting__high_lvl_customer_kpis
[0m15:08:28.532181 [debug] [Thread-1 (]: Writing runtime sql for node "model.vg_casestudy.reporting__high_lvl_customer_kpis"
[0m15:08:28.533200 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.reporting__high_lvl_customer_kpis"
[0m15:08:28.533664 [debug] [Thread-1 (]: On model.vg_casestudy.reporting__high_lvl_customer_kpis: BEGIN
[0m15:08:28.533989 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:08:28.551957 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:08:28.552820 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.reporting__high_lvl_customer_kpis"
[0m15:08:28.553621 [debug] [Thread-1 (]: On model.vg_casestudy.reporting__high_lvl_customer_kpis: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.reporting__high_lvl_customer_kpis"} */

  
  create view "casestudy"."reporting"."reporting__high_lvl_customer_kpis__dbt_tmp" as (
    with customers as (
    select *
    from "casestudy"."marts"."marts__customers_enriched"
),

aggregated as (
    select
        branch_id,
        branch_name,
        count(distinct customer_id) as unique_customers,
        count(distinct case when has_account is false then customer_id end) as customers_without_account,

        count(case when account_type = 'current' then customer_id end) as customers_with_account_type_current,
        count(case when account_type = 'savings' then customer_id end) as customers_with_account_type_savings,
        count(case when account_type = 'current' then account_id end)::float / nullif(count(account_id), 0) as share_current_accounts,
        count(case when account_type = 'savings' then account_id end)::float / nullif(count(account_id), 0) as share_savings_accounts,

        avg(age) as avg_customer_age,
        min(age) as min_customer_age,
        max(age) as max_customer_age,
        count(distinct case when age < 30 then customer_id end) as customers_under_30,
        count(distinct case when age between 30 and 50 then customer_id end) as customers_30_to_50,
        count(distinct case when age > 50 then customer_id end) as customers_over_50,
        count(distinct case when age < 30 then customer_id end)::float / count(distinct customer_id) as share_customers_under_30,
        count(distinct case when age between 30 and 50 then customer_id end)::float / count(distinct customer_id) as share_customers_30_to_50,
        count(distinct case when age > 50 then customer_id end)::float / count(distinct customer_id) as share_customers_over_50,
        avg(case when account_opening_date is not null then date_diff('day', account_opening_date, current_date)::float / 365 end) as avg_account_age_years,
        avg(case when account_opening_date is not null then account_opening_date end)::date as avg_account_opening_date


    from customers
    group by branch_id, branch_name
)

select *
from aggregated
  );

[0m15:08:28.560253 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:08:28.569032 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.reporting__high_lvl_customer_kpis"
[0m15:08:28.569805 [debug] [Thread-1 (]: On model.vg_casestudy.reporting__high_lvl_customer_kpis: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.reporting__high_lvl_customer_kpis"} */
alter view "casestudy"."reporting"."reporting__high_lvl_customer_kpis" rename to "reporting__high_lvl_customer_kpis__dbt_backup"
[0m15:08:28.571957 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:08:28.575404 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.reporting__high_lvl_customer_kpis"
[0m15:08:28.575870 [debug] [Thread-1 (]: On model.vg_casestudy.reporting__high_lvl_customer_kpis: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.reporting__high_lvl_customer_kpis"} */
alter view "casestudy"."reporting"."reporting__high_lvl_customer_kpis__dbt_tmp" rename to "reporting__high_lvl_customer_kpis"
[0m15:08:28.577015 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:08:28.597109 [debug] [Thread-1 (]: On model.vg_casestudy.reporting__high_lvl_customer_kpis: COMMIT
[0m15:08:28.597793 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.reporting__high_lvl_customer_kpis"
[0m15:08:28.598246 [debug] [Thread-1 (]: On model.vg_casestudy.reporting__high_lvl_customer_kpis: COMMIT
[0m15:08:28.602698 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:08:28.608261 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.reporting__high_lvl_customer_kpis"
[0m15:08:28.608716 [debug] [Thread-1 (]: On model.vg_casestudy.reporting__high_lvl_customer_kpis: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.reporting__high_lvl_customer_kpis"} */
drop view if exists "casestudy"."reporting"."reporting__high_lvl_customer_kpis__dbt_backup" cascade
[0m15:08:28.612328 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:08:28.615186 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.reporting__high_lvl_customer_kpis (execute): 15:08:28.492389 => 15:08:28.614862
[0m15:08:28.615882 [debug] [Thread-1 (]: On model.vg_casestudy.reporting__high_lvl_customer_kpis: Close
[0m15:08:28.649201 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a2710eac-6ded-4f38-bffd-d87bd46e4676', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0ae7b47ad0>]}
[0m15:08:28.650139 [info ] [Thread-1 (]: 1 of 1 OK created sql view model reporting.reporting__high_lvl_customer_kpis ... [[32mOK[0m in 0.17s]
[0m15:08:28.650801 [debug] [Thread-1 (]: Finished running node model.vg_casestudy.reporting__high_lvl_customer_kpis
[0m15:08:28.652677 [debug] [MainThread]: Using duckdb connection "master"
[0m15:08:28.653056 [debug] [MainThread]: On master: BEGIN
[0m15:08:28.653340 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:08:28.669188 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m15:08:28.669739 [debug] [MainThread]: On master: COMMIT
[0m15:08:28.670055 [debug] [MainThread]: Using duckdb connection "master"
[0m15:08:28.670332 [debug] [MainThread]: On master: COMMIT
[0m15:08:28.671277 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m15:08:28.671959 [debug] [MainThread]: On master: Close
[0m15:08:28.676304 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:08:28.676952 [debug] [MainThread]: Connection 'list_casestudy_marts' was properly closed.
[0m15:08:28.677475 [debug] [MainThread]: Connection 'model.vg_casestudy.reporting__high_lvl_customer_kpis' was properly closed.
[0m15:08:28.677919 [info ] [MainThread]: 
[0m15:08:28.678299 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.66 seconds (0.66s).
[0m15:08:28.679155 [debug] [MainThread]: Command end result
[0m15:08:28.706955 [info ] [MainThread]: 
[0m15:08:28.707589 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:08:28.708019 [info ] [MainThread]: 
[0m15:08:28.708563 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:08:28.709212 [debug] [MainThread]: Command `dbt run` succeeded at 15:08:28.709049 after 1.24 seconds
[0m15:08:28.709784 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0aebe2e9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0af0700050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0aebc8e190>]}
[0m15:08:28.710194 [debug] [MainThread]: Flushing usage events
[0m15:08:51.316365 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f87281d56d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f87281bf810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f872aa66190>]}


============================== 15:08:51.320373 | 44e776f4-3e69-4f84-9d92-feaa51150a15 ==============================
[0m15:08:51.320373 [info ] [MainThread]: Running with dbt=1.6.18
[0m15:08:51.321077 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/workspaces/vg_case_study_tim/transformation', 'debug': 'False', 'version_check': 'True', 'log_path': '/workspaces/vg_case_study_tim/transformation/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run --select reporting__high_lvl_branch_transactions_kpis', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m15:08:51.428481 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '44e776f4-3e69-4f84-9d92-feaa51150a15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8727de37d0>]}
[0m15:08:51.444804 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '44e776f4-3e69-4f84-9d92-feaa51150a15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8729d64d50>]}
[0m15:08:51.445625 [info ] [MainThread]: Registered adapter: duckdb=1.6.2
[0m15:08:51.475194 [debug] [MainThread]: checksum: 7b9fab86a08e9e96a48a825af743c566d95b877e068b8c6d0dbafbf714447189, vars: {}, profile: , target: , version: 1.6.18
[0m15:08:51.529186 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:08:51.529651 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:08:51.532455 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.vg_casestudy.main
[0m15:08:51.542399 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '44e776f4-3e69-4f84-9d92-feaa51150a15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8723c3ff90>]}
[0m15:08:51.634582 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '44e776f4-3e69-4f84-9d92-feaa51150a15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8723bf5550>]}
[0m15:08:51.635490 [info ] [MainThread]: Found 21 models, 1 analysis, 4 seeds, 114 tests, 5 sources, 0 exposures, 0 metrics, 632 macros, 0 groups, 0 semantic models
[0m15:08:51.636304 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '44e776f4-3e69-4f84-9d92-feaa51150a15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f87284ddb90>]}
[0m15:08:51.640457 [info ] [MainThread]: 
[0m15:08:51.641479 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m15:08:51.643875 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_casestudy'
[0m15:08:51.660631 [debug] [ThreadPool]: Using duckdb connection "list_casestudy"
[0m15:08:51.661118 [debug] [ThreadPool]: On list_casestudy: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"casestudy"'
    
  
  
[0m15:08:51.661444 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:08:51.679865 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:08:51.682589 [debug] [ThreadPool]: On list_casestudy: Close
[0m15:08:51.690011 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy, now create_casestudy_reporting)
[0m15:08:51.690897 [debug] [ThreadPool]: Creating schema "database: "casestudy"
schema: "reporting"
"
[0m15:08:51.695768 [debug] [ThreadPool]: Using duckdb connection "create_casestudy_reporting"
[0m15:08:51.696205 [debug] [ThreadPool]: On create_casestudy_reporting: BEGIN
[0m15:08:51.696506 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:08:51.711341 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:08:51.711930 [debug] [ThreadPool]: Using duckdb connection "create_casestudy_reporting"
[0m15:08:51.712283 [debug] [ThreadPool]: On create_casestudy_reporting: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "create_casestudy_reporting"} */
create schema if not exists "casestudy"."reporting"
[0m15:08:51.713033 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:08:51.714139 [debug] [ThreadPool]: On create_casestudy_reporting: COMMIT
[0m15:08:51.714682 [debug] [ThreadPool]: Using duckdb connection "create_casestudy_reporting"
[0m15:08:51.715257 [debug] [ThreadPool]: On create_casestudy_reporting: COMMIT
[0m15:08:51.716424 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:08:51.716997 [debug] [ThreadPool]: On create_casestudy_reporting: Close
[0m15:08:51.724872 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_casestudy_reporting, now list_casestudy_raw)
[0m15:08:51.734001 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_raw"
[0m15:08:51.735147 [debug] [ThreadPool]: On list_casestudy_raw: BEGIN
[0m15:08:51.736401 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:08:51.752542 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:08:51.753268 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_raw"
[0m15:08:51.753789 [debug] [ThreadPool]: On list_casestudy_raw: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_raw"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'raw'
    and table_catalog = 'casestudy'
  
[0m15:08:51.766918 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:08:51.769517 [debug] [ThreadPool]: On list_casestudy_raw: ROLLBACK
[0m15:08:51.770488 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_raw'
[0m15:08:51.770902 [debug] [ThreadPool]: On list_casestudy_raw: Close
[0m15:08:51.774693 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy_raw, now list_casestudy_intermediate)
[0m15:08:51.778496 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_intermediate"
[0m15:08:51.778916 [debug] [ThreadPool]: On list_casestudy_intermediate: BEGIN
[0m15:08:51.779201 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:08:51.792662 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:08:51.793094 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_intermediate"
[0m15:08:51.793448 [debug] [ThreadPool]: On list_casestudy_intermediate: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_intermediate"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'intermediate'
    and table_catalog = 'casestudy'
  
[0m15:08:51.804851 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:08:51.806327 [debug] [ThreadPool]: On list_casestudy_intermediate: ROLLBACK
[0m15:08:51.806856 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_intermediate'
[0m15:08:51.807423 [debug] [ThreadPool]: On list_casestudy_intermediate: Close
[0m15:08:51.811636 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy_intermediate, now list_casestudy_staging)
[0m15:08:51.815385 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_staging"
[0m15:08:51.816226 [debug] [ThreadPool]: On list_casestudy_staging: BEGIN
[0m15:08:51.816584 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:08:51.829408 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:08:51.829849 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_staging"
[0m15:08:51.830176 [debug] [ThreadPool]: On list_casestudy_staging: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_staging"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'staging'
    and table_catalog = 'casestudy'
  
[0m15:08:51.842642 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:08:51.844500 [debug] [ThreadPool]: On list_casestudy_staging: ROLLBACK
[0m15:08:51.845056 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_staging'
[0m15:08:51.845376 [debug] [ThreadPool]: On list_casestudy_staging: Close
[0m15:08:51.850040 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy_staging, now list_casestudy_reporting)
[0m15:08:51.854766 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_reporting"
[0m15:08:51.855258 [debug] [ThreadPool]: On list_casestudy_reporting: BEGIN
[0m15:08:51.855671 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:08:51.869744 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:08:51.870203 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_reporting"
[0m15:08:51.870601 [debug] [ThreadPool]: On list_casestudy_reporting: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_reporting"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'reporting'
    and table_catalog = 'casestudy'
  
[0m15:08:51.881611 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:08:51.884461 [debug] [ThreadPool]: On list_casestudy_reporting: ROLLBACK
[0m15:08:51.885600 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_reporting'
[0m15:08:51.886344 [debug] [ThreadPool]: On list_casestudy_reporting: Close
[0m15:08:51.890968 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy_reporting, now list_casestudy_marts)
[0m15:08:51.894968 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_marts"
[0m15:08:51.896194 [debug] [ThreadPool]: On list_casestudy_marts: BEGIN
[0m15:08:51.896568 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:08:51.916128 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:08:51.916902 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_marts"
[0m15:08:51.917484 [debug] [ThreadPool]: On list_casestudy_marts: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_marts"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'marts'
    and table_catalog = 'casestudy'
  
[0m15:08:51.928723 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:08:51.930161 [debug] [ThreadPool]: On list_casestudy_marts: ROLLBACK
[0m15:08:51.930713 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_marts'
[0m15:08:51.931014 [debug] [ThreadPool]: On list_casestudy_marts: Close
[0m15:08:51.937832 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '44e776f4-3e69-4f84-9d92-feaa51150a15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f872bbe2690>]}
[0m15:08:51.938440 [debug] [MainThread]: Using duckdb connection "master"
[0m15:08:51.938787 [debug] [MainThread]: On master: BEGIN
[0m15:08:51.939061 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:08:51.956713 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m15:08:51.957181 [debug] [MainThread]: On master: COMMIT
[0m15:08:51.957514 [debug] [MainThread]: Using duckdb connection "master"
[0m15:08:51.957785 [debug] [MainThread]: On master: COMMIT
[0m15:08:51.958478 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m15:08:51.958840 [debug] [MainThread]: On master: Close
[0m15:08:51.962032 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:08:51.963002 [info ] [MainThread]: 
[0m15:08:51.966561 [debug] [Thread-1 (]: Began running node model.vg_casestudy.reporting__high_lvl_branch_transactions_kpis
[0m15:08:51.967533 [info ] [Thread-1 (]: 1 of 1 START sql view model reporting.reporting__high_lvl_branch_transactions_kpis  [RUN]
[0m15:08:51.968942 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.vg_casestudy.reporting__high_lvl_branch_transactions_kpis'
[0m15:08:51.969687 [debug] [Thread-1 (]: Began compiling node model.vg_casestudy.reporting__high_lvl_branch_transactions_kpis
[0m15:08:51.980453 [debug] [Thread-1 (]: Writing injected SQL for node "model.vg_casestudy.reporting__high_lvl_branch_transactions_kpis"
[0m15:08:51.981621 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.reporting__high_lvl_branch_transactions_kpis (compile): 15:08:51.970192 => 15:08:51.981175
[0m15:08:51.982379 [debug] [Thread-1 (]: Began executing node model.vg_casestudy.reporting__high_lvl_branch_transactions_kpis
[0m15:08:52.024137 [debug] [Thread-1 (]: Writing runtime sql for node "model.vg_casestudy.reporting__high_lvl_branch_transactions_kpis"
[0m15:08:52.025401 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.reporting__high_lvl_branch_transactions_kpis"
[0m15:08:52.026027 [debug] [Thread-1 (]: On model.vg_casestudy.reporting__high_lvl_branch_transactions_kpis: BEGIN
[0m15:08:52.026503 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:08:52.045161 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:08:52.045683 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.reporting__high_lvl_branch_transactions_kpis"
[0m15:08:52.046196 [debug] [Thread-1 (]: On model.vg_casestudy.reporting__high_lvl_branch_transactions_kpis: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.reporting__high_lvl_branch_transactions_kpis"} */

  
  create view "casestudy"."reporting"."reporting__high_lvl_branch_transactions_kpis__dbt_tmp" as (
    with transactions as (
    select *
    from "casestudy"."marts"."marts__transactions_with_euro"
),

customers as (
    select *
    from "casestudy"."marts"."marts__customers_enriched"
),

joined as (
    select 
        transactions.*,
        customers.*

    from transactions 
    left join customers 
    on transactions.account_id = customers.customer_id
),

aggregated as(
    select 
        branch_id,
        branch_name,
        transaction_date,

        --transaction volume
        count(transaction_id) as count_transactions,
        count(case when transaction_type = 'deposit' then transaction_id end) as count_deposits,
        count(case when transaction_type = 'withdrawal' then transaction_id end) as count_withdrawals,
        count(case when transaction_type = 'transfer' then transaction_id end) as count_transfers,
        count(case when transaction_type = 'deposit' then transaction_id end)::float / count(transaction_id) as share_deposits,
        count(case when transaction_type = 'withdrawal' then transaction_id end)::float / count(transaction_id) as share_withdrawals,
        count(case when transaction_type = 'transfer' then transaction_id end)::float / count(transaction_id) as share_transfers,

        --customer segmentation
        count(case when age < 30 then transaction_id end) as transactions_under_30,
        count(case when age between 30 and 50 then transaction_id end) as transactions_30_to_50,
        count(case when age > 50 then transaction_id end) as transactions_over_50,
        count(case when age < 30 then transaction_id end)::float / count(transaction_id) as share_customers_under_30,
        count(case when age between 30 and 50 then transaction_id end)::float / count(transaction_id) as share_customers_30_to_50,
        count(case when age > 50 then transaction_id end)::float / count(transaction_id) as share_customers_over_50,

        --transaction kpis
        sum(transaction_amount_euro) as total_transaction_amount_euro,
        avg(transaction_amount_euro) as avg_transaction_amount_euro,
        count(distinct transaction_currency) as num_transaction_currencies,
        count(case when has_account is true then transaction_id end) as transactions_with_account,
        count(case when has_account is false then transaction_id end) as transactions_without_account,
        sum(case when has_account is false then transaction_amount_euro else 0 end) as transaction_amount_euro_without_account

    from joined
    group by branch_id, branch_name, transaction_date
)

select * 
from aggregated
  );

[0m15:08:52.052136 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:08:52.059841 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.reporting__high_lvl_branch_transactions_kpis"
[0m15:08:52.060387 [debug] [Thread-1 (]: On model.vg_casestudy.reporting__high_lvl_branch_transactions_kpis: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.reporting__high_lvl_branch_transactions_kpis"} */
alter view "casestudy"."reporting"."reporting__high_lvl_branch_transactions_kpis" rename to "reporting__high_lvl_branch_transactions_kpis__dbt_backup"
[0m15:08:52.061503 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:08:52.065225 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.reporting__high_lvl_branch_transactions_kpis"
[0m15:08:52.065987 [debug] [Thread-1 (]: On model.vg_casestudy.reporting__high_lvl_branch_transactions_kpis: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.reporting__high_lvl_branch_transactions_kpis"} */
alter view "casestudy"."reporting"."reporting__high_lvl_branch_transactions_kpis__dbt_tmp" rename to "reporting__high_lvl_branch_transactions_kpis"
[0m15:08:52.067695 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:08:52.087840 [debug] [Thread-1 (]: On model.vg_casestudy.reporting__high_lvl_branch_transactions_kpis: COMMIT
[0m15:08:52.088690 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.reporting__high_lvl_branch_transactions_kpis"
[0m15:08:52.089248 [debug] [Thread-1 (]: On model.vg_casestudy.reporting__high_lvl_branch_transactions_kpis: COMMIT
[0m15:08:52.093417 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:08:52.100633 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.reporting__high_lvl_branch_transactions_kpis"
[0m15:08:52.101441 [debug] [Thread-1 (]: On model.vg_casestudy.reporting__high_lvl_branch_transactions_kpis: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.reporting__high_lvl_branch_transactions_kpis"} */
drop view if exists "casestudy"."reporting"."reporting__high_lvl_branch_transactions_kpis__dbt_backup" cascade
[0m15:08:52.105282 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:08:52.107092 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.reporting__high_lvl_branch_transactions_kpis (execute): 15:08:51.982925 => 15:08:52.106894
[0m15:08:52.107520 [debug] [Thread-1 (]: On model.vg_casestudy.reporting__high_lvl_branch_transactions_kpis: Close
[0m15:08:52.138064 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '44e776f4-3e69-4f84-9d92-feaa51150a15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8723b68410>]}
[0m15:08:52.138937 [info ] [Thread-1 (]: 1 of 1 OK created sql view model reporting.reporting__high_lvl_branch_transactions_kpis  [[32mOK[0m in 0.17s]
[0m15:08:52.139638 [debug] [Thread-1 (]: Finished running node model.vg_casestudy.reporting__high_lvl_branch_transactions_kpis
[0m15:08:52.141535 [debug] [MainThread]: Using duckdb connection "master"
[0m15:08:52.141979 [debug] [MainThread]: On master: BEGIN
[0m15:08:52.142297 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:08:52.159198 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m15:08:52.159707 [debug] [MainThread]: On master: COMMIT
[0m15:08:52.160048 [debug] [MainThread]: Using duckdb connection "master"
[0m15:08:52.160330 [debug] [MainThread]: On master: COMMIT
[0m15:08:52.161145 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m15:08:52.161670 [debug] [MainThread]: On master: Close
[0m15:08:52.164539 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:08:52.165112 [debug] [MainThread]: Connection 'list_casestudy_marts' was properly closed.
[0m15:08:52.165589 [debug] [MainThread]: Connection 'model.vg_casestudy.reporting__high_lvl_branch_transactions_kpis' was properly closed.
[0m15:08:52.166263 [info ] [MainThread]: 
[0m15:08:52.167085 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.53 seconds (0.53s).
[0m15:08:52.168079 [debug] [MainThread]: Command end result
[0m15:08:52.231046 [info ] [MainThread]: 
[0m15:08:52.231960 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:08:52.232678 [info ] [MainThread]: 
[0m15:08:52.233579 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:08:52.234376 [debug] [MainThread]: Command `dbt run` succeeded at 15:08:52.234248 after 0.93 seconds
[0m15:08:52.235105 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f87280acf90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f872cada550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8723a85910>]}
[0m15:08:52.236175 [debug] [MainThread]: Flushing usage events
[0m15:09:05.864483 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff938d12590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9345c00d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff934702f50>]}


============================== 15:09:05.869153 | bbb05bd5-5dc1-45c0-b782-9ce7a5325622 ==============================
[0m15:09:05.869153 [info ] [MainThread]: Running with dbt=1.6.18
[0m15:09:05.870127 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/workspaces/vg_case_study_tim/transformation/logs', 'profiles_dir': '/workspaces/vg_case_study_tim/transformation', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --select reporting__branch_transaction_currenncy_kpis', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:09:06.010268 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bbb05bd5-5dc1-45c0-b782-9ce7a5325622', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff934268e90>]}
[0m15:09:06.028750 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bbb05bd5-5dc1-45c0-b782-9ce7a5325622', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9343df090>]}
[0m15:09:06.029631 [info ] [MainThread]: Registered adapter: duckdb=1.6.2
[0m15:09:06.058483 [debug] [MainThread]: checksum: 7b9fab86a08e9e96a48a825af743c566d95b877e068b8c6d0dbafbf714447189, vars: {}, profile: , target: , version: 1.6.18
[0m15:09:06.125182 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:09:06.125642 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:09:06.127652 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.vg_casestudy.main
[0m15:09:06.139671 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bbb05bd5-5dc1-45c0-b782-9ce7a5325622', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff92fd1b210>]}
[0m15:09:06.241445 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bbb05bd5-5dc1-45c0-b782-9ce7a5325622', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff934701610>]}
[0m15:09:06.242163 [info ] [MainThread]: Found 21 models, 1 analysis, 4 seeds, 114 tests, 5 sources, 0 exposures, 0 metrics, 632 macros, 0 groups, 0 semantic models
[0m15:09:06.242608 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bbb05bd5-5dc1-45c0-b782-9ce7a5325622', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff92fcbb350>]}
[0m15:09:06.245616 [info ] [MainThread]: 
[0m15:09:06.246558 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m15:09:06.247918 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_casestudy'
[0m15:09:06.263657 [debug] [ThreadPool]: Using duckdb connection "list_casestudy"
[0m15:09:06.264123 [debug] [ThreadPool]: On list_casestudy: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"casestudy"'
    
  
  
[0m15:09:06.264435 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:09:06.294292 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:09:06.295897 [debug] [ThreadPool]: On list_casestudy: Close
[0m15:09:06.300624 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy, now create_casestudy_reporting)
[0m15:09:06.302055 [debug] [ThreadPool]: Creating schema "database: "casestudy"
schema: "reporting"
"
[0m15:09:06.308040 [debug] [ThreadPool]: Using duckdb connection "create_casestudy_reporting"
[0m15:09:06.308522 [debug] [ThreadPool]: On create_casestudy_reporting: BEGIN
[0m15:09:06.308862 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:09:06.323606 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:09:06.324096 [debug] [ThreadPool]: Using duckdb connection "create_casestudy_reporting"
[0m15:09:06.324437 [debug] [ThreadPool]: On create_casestudy_reporting: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "create_casestudy_reporting"} */
create schema if not exists "casestudy"."reporting"
[0m15:09:06.325298 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:09:06.326336 [debug] [ThreadPool]: On create_casestudy_reporting: COMMIT
[0m15:09:06.326696 [debug] [ThreadPool]: Using duckdb connection "create_casestudy_reporting"
[0m15:09:06.327006 [debug] [ThreadPool]: On create_casestudy_reporting: COMMIT
[0m15:09:06.328547 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:09:06.328961 [debug] [ThreadPool]: On create_casestudy_reporting: Close
[0m15:09:06.335336 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_casestudy_reporting, now list_casestudy_staging)
[0m15:09:06.341741 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_staging"
[0m15:09:06.342210 [debug] [ThreadPool]: On list_casestudy_staging: BEGIN
[0m15:09:06.342496 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:09:06.357114 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:09:06.357596 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_staging"
[0m15:09:06.357973 [debug] [ThreadPool]: On list_casestudy_staging: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_staging"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'staging'
    and table_catalog = 'casestudy'
  
[0m15:09:06.371607 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:09:06.373355 [debug] [ThreadPool]: On list_casestudy_staging: ROLLBACK
[0m15:09:06.374105 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_staging'
[0m15:09:06.374425 [debug] [ThreadPool]: On list_casestudy_staging: Close
[0m15:09:06.377910 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy_staging, now list_casestudy_raw)
[0m15:09:06.381918 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_raw"
[0m15:09:06.382320 [debug] [ThreadPool]: On list_casestudy_raw: BEGIN
[0m15:09:06.382772 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:09:06.397147 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:09:06.397879 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_raw"
[0m15:09:06.398179 [debug] [ThreadPool]: On list_casestudy_raw: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_raw"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'raw'
    and table_catalog = 'casestudy'
  
[0m15:09:06.410994 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:09:06.412669 [debug] [ThreadPool]: On list_casestudy_raw: ROLLBACK
[0m15:09:06.413308 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_raw'
[0m15:09:06.413662 [debug] [ThreadPool]: On list_casestudy_raw: Close
[0m15:09:06.417301 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy_raw, now list_casestudy_reporting)
[0m15:09:06.421422 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_reporting"
[0m15:09:06.422055 [debug] [ThreadPool]: On list_casestudy_reporting: BEGIN
[0m15:09:06.422482 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:09:06.435906 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:09:06.436375 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_reporting"
[0m15:09:06.436682 [debug] [ThreadPool]: On list_casestudy_reporting: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_reporting"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'reporting'
    and table_catalog = 'casestudy'
  
[0m15:09:06.446603 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:09:06.448124 [debug] [ThreadPool]: On list_casestudy_reporting: ROLLBACK
[0m15:09:06.448658 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_reporting'
[0m15:09:06.448951 [debug] [ThreadPool]: On list_casestudy_reporting: Close
[0m15:09:06.453475 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy_reporting, now list_casestudy_intermediate)
[0m15:09:06.457112 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_intermediate"
[0m15:09:06.457566 [debug] [ThreadPool]: On list_casestudy_intermediate: BEGIN
[0m15:09:06.457934 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:09:06.472059 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:09:06.472722 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_intermediate"
[0m15:09:06.473088 [debug] [ThreadPool]: On list_casestudy_intermediate: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_intermediate"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'intermediate'
    and table_catalog = 'casestudy'
  
[0m15:09:06.482990 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:09:06.484966 [debug] [ThreadPool]: On list_casestudy_intermediate: ROLLBACK
[0m15:09:06.485857 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_intermediate'
[0m15:09:06.486355 [debug] [ThreadPool]: On list_casestudy_intermediate: Close
[0m15:09:06.490958 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_casestudy_intermediate, now list_casestudy_marts)
[0m15:09:06.495125 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_marts"
[0m15:09:06.495633 [debug] [ThreadPool]: On list_casestudy_marts: BEGIN
[0m15:09:06.497322 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:09:06.512136 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:09:06.512578 [debug] [ThreadPool]: Using duckdb connection "list_casestudy_marts"
[0m15:09:06.512881 [debug] [ThreadPool]: On list_casestudy_marts: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "connection_name": "list_casestudy_marts"} */
select
      'casestudy' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'marts'
    and table_catalog = 'casestudy'
  
[0m15:09:06.524484 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:09:06.525939 [debug] [ThreadPool]: On list_casestudy_marts: ROLLBACK
[0m15:09:06.526446 [debug] [ThreadPool]: Failed to rollback 'list_casestudy_marts'
[0m15:09:06.526797 [debug] [ThreadPool]: On list_casestudy_marts: Close
[0m15:09:06.531112 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bbb05bd5-5dc1-45c0-b782-9ce7a5325622', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff934851a90>]}
[0m15:09:06.531741 [debug] [MainThread]: Using duckdb connection "master"
[0m15:09:06.532061 [debug] [MainThread]: On master: BEGIN
[0m15:09:06.532329 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:09:06.547077 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m15:09:06.547531 [debug] [MainThread]: On master: COMMIT
[0m15:09:06.547852 [debug] [MainThread]: Using duckdb connection "master"
[0m15:09:06.548138 [debug] [MainThread]: On master: COMMIT
[0m15:09:06.548965 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m15:09:06.549783 [debug] [MainThread]: On master: Close
[0m15:09:06.553640 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:09:06.554247 [info ] [MainThread]: 
[0m15:09:06.556808 [debug] [Thread-1 (]: Began running node model.vg_casestudy.reporting__branch_transaction_currenncy_kpis
[0m15:09:06.557387 [info ] [Thread-1 (]: 1 of 1 START sql view model reporting.reporting__branch_transaction_currenncy_kpis  [RUN]
[0m15:09:06.558326 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.vg_casestudy.reporting__branch_transaction_currenncy_kpis'
[0m15:09:06.558753 [debug] [Thread-1 (]: Began compiling node model.vg_casestudy.reporting__branch_transaction_currenncy_kpis
[0m15:09:06.570184 [debug] [Thread-1 (]: Writing injected SQL for node "model.vg_casestudy.reporting__branch_transaction_currenncy_kpis"
[0m15:09:06.571237 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.reporting__branch_transaction_currenncy_kpis (compile): 15:09:06.558988 => 15:09:06.570924
[0m15:09:06.571757 [debug] [Thread-1 (]: Began executing node model.vg_casestudy.reporting__branch_transaction_currenncy_kpis
[0m15:09:06.609321 [debug] [Thread-1 (]: Writing runtime sql for node "model.vg_casestudy.reporting__branch_transaction_currenncy_kpis"
[0m15:09:06.610261 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.reporting__branch_transaction_currenncy_kpis"
[0m15:09:06.610815 [debug] [Thread-1 (]: On model.vg_casestudy.reporting__branch_transaction_currenncy_kpis: BEGIN
[0m15:09:06.611275 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:09:06.627883 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:09:06.628427 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.reporting__branch_transaction_currenncy_kpis"
[0m15:09:06.628867 [debug] [Thread-1 (]: On model.vg_casestudy.reporting__branch_transaction_currenncy_kpis: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.reporting__branch_transaction_currenncy_kpis"} */

  
  create view "casestudy"."reporting"."reporting__branch_transaction_currenncy_kpis__dbt_tmp" as (
    with transactions as (
    select *
    from "casestudy"."marts"."marts__transactions_with_euro"
),

customers as (
    select *
    from "casestudy"."marts"."marts__customers_enriched"
),

joined as (
    select 
        transactions.*,
        customers.*
    from transactions 
    left join customers 
    on transactions.account_id = customers.customer_id
),

aggregated as(
    select 
        branch_id,
        branch_name,
        transaction_date,
        transaction_currency,

        --transaction volume
        count(transaction_id) as count_transactions,
        count(case when transaction_type = 'deposit' then transaction_id end) as count_deposits,
        count(case when transaction_type = 'withdrawal' then transaction_id end) as count_withdrawals,
        count(case when transaction_type = 'transfer' then transaction_id end) as count_transfers,
        count(case when transaction_type = 'deposit' then transaction_id end)::float / count(transaction_id) as share_deposits,
        count(case when transaction_type = 'withdrawal' then transaction_id end)::float / count(transaction_id) as share_withdrawals,
        count(case when transaction_type = 'transfer' then transaction_id end)::float / count(transaction_id) as share_transfers,

        --customer segmentation
        count(case when age < 30 then transaction_id end) as transactions_under_30,
        count(case when age between 30 and 50 then transaction_id end) as transactions_30_to_50,
        count(case when age > 50 then transaction_id end) as transactions_over_50,
        count(case when age < 30 then transaction_id end)::float / count(transaction_id) as share_customers_under_30,
        count(case when age between 30 and 50 then transaction_id end)::float / count(transaction_id) as share_customers_30_to_50,
        count(case when age > 50 then transaction_id end)::float / count(transaction_id) as share_customers_over_50,

        --transaction kpis
        sum(transaction_amount_euro) as total_transaction_amount_euro,
        avg(transaction_amount_euro) as avg_transaction_amount_euro,
        count(case when has_account is true then transaction_id end) as transactions_with_account,
        count(case when has_account is false then transaction_id end) as transactions_without_account

    from joined
    group by branch_id, branch_name, transaction_date, transaction_currency
)

select * 
from aggregated
  );

[0m15:09:06.631204 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:09:06.638654 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.reporting__branch_transaction_currenncy_kpis"
[0m15:09:06.639169 [debug] [Thread-1 (]: On model.vg_casestudy.reporting__branch_transaction_currenncy_kpis: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.reporting__branch_transaction_currenncy_kpis"} */
alter view "casestudy"."reporting"."reporting__branch_transaction_currenncy_kpis" rename to "reporting__branch_transaction_currenncy_kpis__dbt_backup"
[0m15:09:06.640270 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:09:06.643758 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.reporting__branch_transaction_currenncy_kpis"
[0m15:09:06.644177 [debug] [Thread-1 (]: On model.vg_casestudy.reporting__branch_transaction_currenncy_kpis: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.reporting__branch_transaction_currenncy_kpis"} */
alter view "casestudy"."reporting"."reporting__branch_transaction_currenncy_kpis__dbt_tmp" rename to "reporting__branch_transaction_currenncy_kpis"
[0m15:09:06.645207 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:09:06.663096 [debug] [Thread-1 (]: On model.vg_casestudy.reporting__branch_transaction_currenncy_kpis: COMMIT
[0m15:09:06.663585 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.reporting__branch_transaction_currenncy_kpis"
[0m15:09:06.663952 [debug] [Thread-1 (]: On model.vg_casestudy.reporting__branch_transaction_currenncy_kpis: COMMIT
[0m15:09:06.669066 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:09:06.675022 [debug] [Thread-1 (]: Using duckdb connection "model.vg_casestudy.reporting__branch_transaction_currenncy_kpis"
[0m15:09:06.675499 [debug] [Thread-1 (]: On model.vg_casestudy.reporting__branch_transaction_currenncy_kpis: /* {"app": "dbt", "dbt_version": "1.6.18", "profile_name": "default", "target_name": "dev", "node_id": "model.vg_casestudy.reporting__branch_transaction_currenncy_kpis"} */
drop view if exists "casestudy"."reporting"."reporting__branch_transaction_currenncy_kpis__dbt_backup" cascade
[0m15:09:06.678622 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:09:06.680153 [debug] [Thread-1 (]: Timing info for model.vg_casestudy.reporting__branch_transaction_currenncy_kpis (execute): 15:09:06.572037 => 15:09:06.679956
[0m15:09:06.680543 [debug] [Thread-1 (]: On model.vg_casestudy.reporting__branch_transaction_currenncy_kpis: Close
[0m15:09:06.708469 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bbb05bd5-5dc1-45c0-b782-9ce7a5325622', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff934148890>]}
[0m15:09:06.709199 [info ] [Thread-1 (]: 1 of 1 OK created sql view model reporting.reporting__branch_transaction_currenncy_kpis  [[32mOK[0m in 0.15s]
[0m15:09:06.709827 [debug] [Thread-1 (]: Finished running node model.vg_casestudy.reporting__branch_transaction_currenncy_kpis
[0m15:09:06.711790 [debug] [MainThread]: Using duckdb connection "master"
[0m15:09:06.712139 [debug] [MainThread]: On master: BEGIN
[0m15:09:06.712412 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:09:06.730447 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m15:09:06.730929 [debug] [MainThread]: On master: COMMIT
[0m15:09:06.731268 [debug] [MainThread]: Using duckdb connection "master"
[0m15:09:06.731589 [debug] [MainThread]: On master: COMMIT
[0m15:09:06.732168 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m15:09:06.732496 [debug] [MainThread]: On master: Close
[0m15:09:06.736486 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:09:06.736935 [debug] [MainThread]: Connection 'list_casestudy_marts' was properly closed.
[0m15:09:06.737276 [debug] [MainThread]: Connection 'model.vg_casestudy.reporting__branch_transaction_currenncy_kpis' was properly closed.
[0m15:09:06.737718 [info ] [MainThread]: 
[0m15:09:06.738079 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.49 seconds (0.49s).
[0m15:09:06.738660 [debug] [MainThread]: Command end result
[0m15:09:06.763329 [info ] [MainThread]: 
[0m15:09:06.763946 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:09:06.764347 [info ] [MainThread]: 
[0m15:09:06.764756 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:09:06.765262 [debug] [MainThread]: Command `dbt run` succeeded at 15:09:06.765164 after 0.92 seconds
[0m15:09:06.765622 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff92fc56350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff93440d490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9352d7a10>]}
[0m15:09:06.765966 [debug] [MainThread]: Flushing usage events
